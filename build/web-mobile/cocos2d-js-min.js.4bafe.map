{"version":3,"sources":["Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/gulp/browserify_prelude.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/actions/CCAction.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/actions/CCActionCatmullRom.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/actions/CCActionEase.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/actions/CCActionInstant.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/actions/CCActionInterval.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/actions/CCActionManager.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/actions/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/actions/tween.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/animation/animation-animator.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/animation/animation-clip.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/animation/animation-curves.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/animation/animation-manager.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/animation/animation-state.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/animation/bezier.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/animation/easing.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/animation/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/animation/motion-path-helper.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/animation/playable.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/animation/types.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/audio/CCAudio.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/audio/CCAudioEngine.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/CCDebug.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/CCDirector.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/CCGame.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/CCNode.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/CCPrivateNode.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/CCScene.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/CCScheduler.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCAsset.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCAudioClip.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCBitmapFont.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCBufferAsset.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCFont.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCJsonAsset.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCLabelAtlas.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCPrefab.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCRawAsset.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCSceneAsset.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCScripts.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCSpriteAtlas.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCSpriteFrame.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCTTFFont.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCTextAsset.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/CCTexture2D.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/material/CCEffectAsset.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/material/CCMaterial.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/material/effect-base.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/material/effect-parser.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/material/effect-variant.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/material/effect.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/material/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/material/material-pool.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/material/material-variant.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/assets/material/utils.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/camera/CCCamera.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/component-scheduler.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCAnimation.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCAudioSource.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCBlockInputEvents.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCButton.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCCanvas.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCComponent.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCComponentEventHandler.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCLabel.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCLayout.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCMask.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCMotionStreak.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCRenderComponent.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCScrollView.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCSprite.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/CCViewGroup.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/components/missing-script.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/event-manager/CCEvent.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/event-manager/CCEventListener.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/event-manager/CCEventManager.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/event-manager/CCTouch.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/event-manager/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/event/event-listeners.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/event/event-target.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/event/event.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/event/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/event/system-event.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/graphics/graphics.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/graphics/helper.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/graphics/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/graphics/types.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/CCLoader.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/asset-loader.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/asset-table.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/audio-downloader.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/auto-release-utils.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/binary-downloader.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/downloader.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/font-loader.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/loader.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/loading-items.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/md5-pipe.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/pack-downloader.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/pipeline.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/subpackage-pipe.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/text-downloader.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/unpackers.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/utils.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/load-pipeline/uuid-loader.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/node-activator.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCAssetLibrary.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCClass.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCClassDecorator.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCEnum.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCInputExtension.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCInputManager.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCMacro.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCObject.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCSAXParser.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCScreen.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCSys.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCView.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/CCVisibleRect.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/attribute.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/callbacks-invoker.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/compiler.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/deserialize.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/id-generater.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/instantiate-jit.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/instantiate.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/js.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/preprocess-class.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/requiring-frame.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/url.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/platform/utils.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/predefine.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/assembler-2d.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/assembler-pool.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/assembler.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/canvas/Device.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/canvas/Texture2D.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/render-flow.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/utils/label/bmfont.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/utils/label/label-frame.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/utils/label/letter-font.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/utils/label/ttf.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/utils/utils.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/graphics/earcut.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/graphics/impl.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/graphics/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/label/2d/bmfont.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/label/2d/letter.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/label/2d/ttf.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/label/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/mask-assembler.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/motion-streak.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/sprite/2d/bar-filled.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/sprite/2d/mesh.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/sprite/2d/radial-filled.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/sprite/2d/simple.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/sprite/2d/sliced.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/sprite/2d/tiled.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/assemblers/sprite/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/flex-buffer.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/mesh-buffer.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/model-batcher.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/quad-buffer.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/render-data.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/spine-buffer.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/renderer/webgl/vertex-format.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/CCPath.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/affine-transform.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/base-node.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/binary-search.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/blend-func.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/decode-uuid.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/find.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/gray-sprite-state.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/misc.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/mutable-forward-iterator.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/pool.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/prefab-helper.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/profiler/CCProfiler.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/profiler/counter.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/profiler/perf-counter.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/text-utils.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/texture-util.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/trans-pool/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/trans-pool/mem-pool.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/trans-pool/node-mem-pool.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/trans-pool/node-unit.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/utils/trans-pool/unit-base.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/color.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/index.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/mat3.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/mat4.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/quat.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/rect.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/size.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/trs.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/utils.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/value-type.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/vec2.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/vec3.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/core/value-types/vec4.ts","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/deprecated.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/particle/CCParticleAsset.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/build/mappings/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/core/base-renderer.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/core/input-assembler.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/core/pass.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/core/program-lib.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/core/technique.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/core/view.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/enums.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/device.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/enums.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/frame-buffer.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/index-buffer.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/misc.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/program.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/render-buffer.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/state.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/texture-2d.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/texture-cube.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/texture.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/vertex-buffer.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/gfx/vertex-format.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/memop/circular-pool.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/memop/fixed-array.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/memop/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/memop/linked-array.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/memop/pool.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/memop/recycle-pool.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/memop/timsort.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/memop/typed-array-pool.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/murmurhash2_gc.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/renderers/forward-renderer.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/scene/camera.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/scene/model.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/scene/scene.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/renderer/types.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/cocos2d/tilemap/CCTiledMapAsset.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/extends.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/index.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/polyfill/array-buffer.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/polyfill/array.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/polyfill/misc.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/polyfill/number.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/polyfill/object.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/polyfill/string.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/polyfill/typescript.js","Applications/CocosCreator/Creator/2.3.2/CocosCreator.app/Contents/Resources/engine/predefine.js"],"names":["modules","cache","entry","newRequire","name","jumped","module","moduleData","exports","x","i","length","1","require","misc","cc","Action","Class","ctor","this","originalTarget","target","tag","TAG_INVALID","clone","action","isDone","startWithTarget","stop","step","dt","logID","update","getTarget","setTarget","getOriginalTarget","setOriginalTarget","getTag","setTag","retain","release","FiniteTimeAction","extends","_duration","getDuration","_timesForRepeat","setDuration","duration","reverse","Speed","speed","_speed","_innerAction","initWithAction","getSpeed","setSpeed","errorID","prototype","call","setInnerAction","getInnerAction","Follow","followedNode","rect","_followedNode","_boundarySet","_boundaryFullyCovered","_halfScreenSize","_fullScreenSize","leftBoundary","rightBoundary","topBoundary","bottomBoundary","_worldRect","initWithTarget","locRect","Rect","y","width","height","isBoundarySet","setBoudarySet","value","winSize","v2","mul","targetWorldPos","convertToWorldSpaceAR","Vec2","ZERO","followedWorldPos","delta","sub","tempPos","parent","convertToNodeSpaceAR","add","setPosition","clampf","activeInHierarchy","follow","cardinalSplineAt","p0","p1","p2","p3","tension","t","t2","t3","s","b1","b2","b3","b4","getControlPointAt","controlPoints","pos","Math","min","max","reverseControlPoints","newArray","push","cloneControlPoints","CardinalSplineTo","ActionInterval","points","_points","_deltaT","_tension","_previousPosition","_accumulatedDiff","undefined","initWithDuration","setPoints","p","lt","_computeEaseTime","ps","locDT","tempX","tempY","newPos","macro","ENABLE_STACKABLE_ACTIONS","locAccDiff","updatePosition","reversePoints","cardinalSplineTo","getPoints","CardinalSplineBy","_startPosition","current","copyConfig","slice","reverseArray","pop","unshift","cardinalSplineBy","posX","posY","a","CatmullRomTo","catmullRomTo","CatmullRomBy","catmullRomBy","easeIn","rate","_rate","easing","pow","easeOut","easeInOut","_easeExponentialInObj","_easeExponentialOutObj","easeExponentialIn","easeExponentialOut","_easeExponentialInOutObj","easeExponentialInOut","_easeSineInObj","cos","PI","_easeSineOutObj","easeSineIn","sin","easeSineOut","_easeSineInOutObj","easeSineInOut","_easeElasticInObj","_easeElasticOutObj","easeElasticIn","period","_period","easeElasticOut","_bounceTime","time1","easeElasticInOut","newT","locPeriod","_easeBounceInObj","_easeBounceOutObj","easeBounceIn","easeBounceOut","_easeBounceInOutObj","easeBounceInOut","_easeBackInObj","_easeBackOutObj","easeBackIn","easeBackOut","_easeBackInOutObj","easeBackInOut","easeBezierAction","b","c","d","_easeQuadraticActionIn","time","easeQuadraticActionIn","_easeQuadraticActionOut","easeQuadraticActionOut","_easeQuadraticActionInOut","easeQuadraticActionInOut","_easeQuarticActionIn","easeQuarticActionIn","_easeQuarticActionOut","easeQuarticActionOut","_easeQuarticActionInOut","easeQuarticActionInOut","_easeQuinticActionIn","easeQuinticActionIn","_easeQuinticActionOut","easeQuinticActionOut","_easeQuinticActionInOut","easeQuinticActionInOut","_easeCircleActionIn","sqrt","easeCircleActionIn","_easeCircleActionOut","easeCircleActionOut","_easeCircleActionInOut","easeCircleActionInOut","_easeCubicActionIn","easeCubicActionIn","_easeCubicActionOut","easeCubicActionOut","_easeCubicActionInOut","easeCubicActionInOut","ActionInstant","Show","_renderComps","getComponentsInChildren","RenderComponent","enabled","Hide","show","hide","ToggleVisibility","render","toggleVisibility","RemoveSelf","isNeedCleanUp","_isNeedCleanUp","init","removeFromParent","removeSelf","FlipX","flip","_flippedX","initWithFlipX","scaleX","abs","flipX","FlipY","_flippedY","initWithFlipY","scaleY","flipY","Place","_x","_y","initWithPosition","place","CallFunc","selector","selectorTarget","data","_selectorTarget","_function","_data","initWithFunction","execute","getTargetCallback","setTargetCallback","sel","callFunc","bezierAt","MAX_VALUE","_elapsed","_firstTick","_easeList","_repeatForever","_repeatMethod","_speedMethod","getElapsed","FLT_EPSILON","_cloneDecoration","_reverseEaseList","easeObj","arguments","locList","n","setAmplitudeRate","amp","getAmplitudeRate","repeat","times","round","isNaN","repeatForever","actionInterval","Sequence","tempArray","_actions","_split","_last","_reversed","paramArray","Array","last","action1","prev","_actionOneTwo","initWithTwoActions","actionOne","actionTwo","durationOne","durationTwo","new_t","actionFound","found","locSplit","locActions","locLast","sequence","result","Repeat","_times","_total","_nextDt","_actionInstant","locInnerAction","locDuration","locTimes","locNextDt","RepeatForever","Spawn","_one","_two","action2","ret","d1","d2","delayTime","spawn","pSpawn","RotateTo","dstAngle","_startAngle","_dstAngle","_angle","startAngle","angle","ROTATE_ACTION_CCW","rotateTo","RotateBy","deltaAngle","_deltaAngle","rotateBy","MoveBy","deltaPos","deltaY","_positionDelta","position","locPosX","locPosY","locStartPosition","targetX","targetY","locPreviousPosition","moveBy","MoveTo","_endPosition","moveTo","SkewTo","sx","sy","_skewX","_skewY","_startSkewX","_startSkewY","_endSkewX","_endSkewY","_deltaX","_deltaY","skewX","skewY","skewTo","SkewBy","deltaSkewX","deltaSkewY","skewBy","JumpBy","jumps","_delta","_height","_jumps","frac","jumpBy","JumpTo","jumpTo","BezierBy","_config","newConfigs","selConf","locConfig","xb","xc","xd","yb","yc","yd","x0","y0","x1","y1","x2","y2","r","bezierBy","BezierTo","_toConfig","locStartPos","locToConfig","bezierTo","ScaleTo","_scaleX","_scaleY","_startScaleX","_startScaleY","_endScaleX","_endScaleY","scaleTo","ScaleBy","scaleBy","Blink","blinks","_originalState","m","opacity","blink","FadeTo","_toOpacity","_fromOpacity","fromOpacity","fadeTo","FadeIn","_reverseAction","FadeOut","fadeIn","fadeOut","TintTo","red","green","blue","_to","color","_from","Color","g","locTo","locFrom","tintTo","TintBy","deltaRed","deltaGreen","deltaBlue","_deltaR","_deltaG","_deltaB","_fromR","_fromG","_fromB","tintBy","DelayTime","ReverseTime","_other","reverseTime","TargetedAction","_action","_forcedTarget","getForcedTarget","setForcedTarget","forcedTarget","targetedAction","js","HashElement","actions","actionIndex","currentAction","paused","lock","ActionManager","_hashTargets","createMap","_arrayTargets","_currentTarget","director","_scheduler","enableForTarget","constructor","_elementPool","_searchElementByTarget","arr","k","_getElement","element","_putElement","addAction","_id","removeAllActions","locTargets","removeAllActionsFromTarget","forceDelete","_deleteHashElement","removeAction","splice","removeActionByTag","assertID","limit","_removeActionAtIndex","getActionByTag","getNumberOfRunningActionsInTarget","pauseTarget","resumeTarget","pauseAllRunningActions","idsWithActions","resumeTargets","targetsToResume","pauseTargets","targetsToPause","purgeSharedManager","getScheduler","unscheduleUpdate","index","targets","l","locCurrTarget","elt","TweenAction","props","opts","_opts","Object","create","_props","progress","easingName","warnID","relative","lerp","prop","warn","_originProps","start","end","easingTime","SetAction","Tween","_finalAction","_target","then","other","_union","getActionManager","tween","union","tmp_args","wrapAction","arg","apply","to","by","set","delay","parallel","previousAsInputActions","keys","key","_loop","_i","args","_i2","_loop2","Playable","EventAnimCurve","EventInfo","WrapModeMask","binarySearch","binarySearchEpsilon","AnimationAnimator","animation","_anims","array","MutableForwardIterator","extend","initClipData","root","state","clip","wrapMode","frameRate","sample","Loop","repeatCount","Infinity","curves","createCurves","events","curve","eventData","ratio","frame","eventInfo","ratios","func","params","playState","startTime","curveLoaded","animator","play","setTime","stopStatesExcept","iterator","anim","stopState","addAnimation","indexOf","_setEventTarget","removeAnimation","fastRemoveAt","pauseState","pause","resumeState","resume","isPaused","setStateTime","onStop","onPause","onResume","_reloadClip","WrapMode","DynamicAnimCurve","quickFindIndex","sampleMotionPaths","AnimationClip","Asset","properties","default","type","Float","get","Normal","curveData","visible","statics","createWithSpriteFrames","spriteFrames","isArray","frames","comps","cc.Sprite","spriteFrame","onLoad","Number","parseFloat","parseInt","createPropCurve","propPath","keyframes","motionPaths","isMotionPathProp","Node","keyframe","motionPath","curveValue","values","curveTypes","types","Linear","Bezier","currRatioDif","lastRatioDif","canOptimize","_l","_findFrameIndex","firstValue","_lerp","_lerpNumber","Quat","_lerpQuat","Vec3","_lerpVector","_lerpObject","createTargetCurves","propsData","compsData","compName","comp","getComponent","compData","_propPath","_curve","childrenCurveDatas","paths","namePath","find","childCurveDatas","bezierByTime","WrappedInfo","computeRatioByType","AnimCurve","onTimeChangedManually","floorIndex","_cachedIndex","from","out","quat","v3","frameCount","shoudRefind","cachedIndex","_fromRatio","_toRatio","fromVal","fromRatio","toRatio","ratioBetweenFrames","toVal","_wrappedInfo","_lastWrappedInfo","_ignoreIndex","NaN","_wrapIterations","iterations","currentWrappedInfo","getWrappedInfo","direction","currentIndex","frameIndex","_fireEvent","currentIterations","lastWrappedInfo","lastIterations","lastIndex","lastDirection","interationsChanged","PingPong","getAnimationManager","pushDelayEvent","isValid","components","_components","event","funcName","j","component","info","AnimationManager","_delayEvents","_isPlaying","_isPaused","destruct","Types","AnimationState","_currentFramePlayed","_delay","_delayTime","_process","process","_clip","_name","_lastframeEventOn","emit","proto","lastInfo","stopped","simpleProcess","len","_lastIterations","_emit","on","callback","once","self","off","hasEventListener","onPlay","_needRevers","needRevers","Reverse","tempRatio","tempTime","shouldWrap","_wrapMode","ShouldWrap","obsolete","getset","_repeatCount","bezier","C1","C2","C3","C4","t1","acos","tau","crt","v","cardano","u1","x3","pa","pb","pa3","pb3","pc3","rd","a3","q","q2","discriminant","mp3","phi","sd","percent","p1y","constant","linear","quadIn","quadOut","quadInOut","cubicIn","cubicOut","cubicInOut","quartIn","quartOut","quartInOut","quintIn","quintOut","quintInOut","sineIn","sineOut","sineInOut","expoIn","expoOut","expoInOut","circIn","circOut","circInOut","elasticIn","asin","elasticOut","elasticInOut","backIn","backOut","backInOut","bounceIn","bounceOut","bounceInOut","smooth","fade","_makeOutIn","fnIn","fnOut","quadOutIn","cubicOutIn","quartOutIn","quintOutIn","sineOutIn","expoOutIn","circOutIn","backOutIn","bounceOutIn","Curve","beziers","progresses","computeBeziers","startCtrlPoint","endCtrlPoint","checkMotionPath","controls","fps","createControlPoints","in","map","motionPathValid","_motionPath","newValues","newTypes","newRatios","startRatioOffset","newType","finalProgress","betweenRatio","nextValue","results","l2","normal","getLength","normalize","bezierIndex","getPointAt","newRatio","addNewDatas","startPoint","endPoint","u","getUtoTmapping","getPoint","lengths","getLengths","divisions","__arcLengthDivisions","cacheArcLengths","vector","sum","mag","distance","targetArcLength","arcLengths","il","comparison","low","high","floor","lengthBefore","debug","_stepOnce","virtual","onError","getError","Enum","Default","LoopReverse","PingPongReverse","TIME_CONSTANT","EventTarget","sys","LoadMode","touchBinded","touchPlayList","Audio","src","_src","_element","id","_volume","_nextTime","_state","State","INITIALZING","_onended","STOPPED","bind","ERROR","PLAYING","PAUSED","_bindEnded","elem","HTMLAudioElement","addEventListener","onended","_unbindEnded","removeEventListener","_onLoaded","_createElement","setVolume","setLoop","setCurrentTime","getState","_nativeAsset","document","createElement","WebAudioElement","_touchToPlay","loadMode","DOM_AUDIO","instance","offset","audio","touchEventName","window","game","canvas","item","destroy","currentTime","error","loop","getLoop","num","volume","getVolume","err","getCurrentTime","_forceUpdatingState","defineProperty","loaded","loader","load","url","nativeUrl","skips","audioNativeAsset","enumerable","configurable","browserType","BROWSER_TYPE_EDGE","BROWSER_TYPE_BAIDU","BROWSER_TYPE_UC","buffer","_audio","_context","__audioSupport","context","_buffer","_gainObj","_startTime","_currentSource","playedLength","_currentTimer","_endCallback","endTime","clearTimeout","setTimeout","BROWSER_TYPE_SAFARI","isMobile","bool","gain","setTargetAtTime","e","os","OS_IOS","AudioClip","_instanceId","_id2audio","_url2id","_audioPool","recycleAudio","_finishCallback","includes","getAudioFromPath","path","list","audioEngine","_maxAudioInstance","oldId","shift","getAudioFromId","handleVolume","AudioState","_maxWebAudioSize","_loadByUrl","audioID","isLoop","sec","setFinishCallback","_pauseIDCache","pauseAll","resumeAll","stopAll","setMaxAudioInstance","getMaxAudioInstance","uncache","filePath","uncacheAll","getProfile","profileName","preload","setMaxWebAudioSize","kb","_breakCache","_break","_restore","_music","_effect","pauseCache","playMusic","music","stopMusic","pauseMusic","resumeMusic","getMusicVolume","setMusicVolume","isMusicPlaying","playEffect","setEffectsVolume","musicId","getEffectsVolume","pauseEffect","pauseAllEffects","effect","resumeEffect","resumeAllEffects","pauseIDCache","stopEffect","stopAllEffects","logList","utils","ERROR_MAP_URL","log","assert","console","getTypedFormatter","msg","argsArray","shiftArguments","join","_throw","callInNextTick","logFormatter","warnFormatter","errorFormatter","assertFormatter","cond","DebugMode","NONE","INFO","WARN","INFO_FOR_WEB_PAGE","WARN_FOR_WEB_PAGE","ERROR_FOR_WEB_PAGE","_resetDebugSetting","mode","logToWebPage","logDiv","setAttribute","logDivStyle","style","zIndex","top","left","logListStyle","backgroundColor","borderBottom","borderTopWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderLeftStyle","borderRightStyle","padding","margin","appendChild","parentNode","scrollTop","scrollHeight","formatStr","Error","isDisplayStats","profiler","isShowingStats","setDisplayStats","displayStats","renderType","RENDER_TYPE_CANVAS","showStats","hideStats","config","showFPS","AutoReleaseUtils","ComponentScheduler","NodeActivator","Obj","renderer","eventManager","Scheduler","Director","_paused","_purgeDirectorInNextLoop","_winSizeInPoints","_loadingScene","_scene","_totalFrames","_lastUpdate","_deltaTime","_maxParticleDeltaTime","_compScheduler","_nodeActivator","_actionManager","EVENT_SHOW","performance","now","EVENT_ENGINE_INITED","size","scheduleUpdate","PRIORITY_SYSTEM","sharedInit","setEnabled","_animationManager","CollisionManager","_collisionManager","PhysicsManager","_physicsManager","Physics3DManager","_physics3DManager","_widgetManager","calculateDeltaTime","convertToGL","uiPoint","container","view","box","getBoundingClientRect","pageXOffset","clientLeft","pageYOffset","clientTop","_devicePixelRatio","_isRotated","_viewportRect","convertToUI","glPoint","getWinSize","getWinSizeInPixels","purgeCachedData","releaseAll","purgeDirector","unscheduleAll","reset","clear","AssetLibrary","resetBuiltins","runSceneImmediate","scene","onBeforeLoadScene","onLaunched","Scene","_load","persistNodeList","_persistRootNodes","node","existNode","getChildByUuid","uuid","getSiblingIndex","_destroyImmediate","insertChild","oldScene","autoReleaseAssets","dependAssets","autoRelease","_deferredDestroy","EVENT_BEFORE_SCENE_LAUNCH","_activate","EVENT_AFTER_SCENE_LAUNCH","runScene","EVENT_AFTER_UPDATE","_getSceneUuid","scenes","_sceneInfos","endsWith","startsWith","loadScene","sceneName","_onUnloaded","EVENT_BEFORE_SCENE_LOADING","_loadSceneByUuid","preloadScene","onProgress","onLoaded","asset","message","onUnloaded","dontRunScene","loadAsset","sceneAsset","timeEnd","SceneAsset","_uuid","setDepthTest","Camera","main","depth","setClearColor","clearColor","getRunningScene","getScene","getAnimationInterval","getFrameRate","setAnimationInterval","setFrameRate","getDeltaTime","getTotalTime","getTotalFrames","setScheduler","scheduler","setActionManager","actionManager","getCollisionManager","getPhysicsManager","getPhysics3DManager","startAnimation","stopAnimation","_resetDeltaTime","mainLoop","EVENT_BEFORE_UPDATE","startPhase","updatePhase","lateUpdatePhase","clearup","EVENT_BEFORE_DRAW","EVENT_AFTER_DRAW","frameUpdateListeners","__fastOn","__fastOff","addon","EVENT_PROJECTION_CHANGED","EVENT_BEFORE_VISIT","EVENT_AFTER_VISIT","PROJECTION_2D","PROJECTION_3D","PROJECTION_CUSTOM","PROJECTION_DEFAULT","EVENT_BEFORE_PHYSICS","EVENT_AFTER_PHYSICS","dynamicAtlasManager","EVENT_HIDE","EVENT_RESTART","EVENT_GAME_INITED","EVENT_RENDERER_INITED","RENDER_TYPE_WEBGL","RENDER_TYPE_OPENGL","_configLoaded","_isCloning","_prepared","_rendererInitialized","_renderContext","_intervalId","_lastTime","_frameTime","onStart","cancelAnimFrame","_setAnimFrame","_runMainLoop","restart","removePersistRootNode","_loadBuiltins","close","_initEngine","_initRenderer","_initEvents","_loadPreviewScript","cb","_prepareFinished","_this","ENGINE_VERSION","eventTargetOn","eventTargetOnce","prepare","_this2","jsList","JSON","stringify","run","_initConfig","addPersistRootNode","isNode","_persistNode","isPersistRootNode","requestAnimFrame","_stTime","_ctTime","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","cancelAnimationFrame","cancelRequestAnimationFrame","msCancelRequestAnimationFrame","mozCancelRequestAnimationFrame","oCancelRequestAnimationFrame","webkitCancelRequestAnimationFrame","msCancelAnimationFrame","mozCancelAnimationFrame","webkitCancelAnimationFrame","oCancelAnimationFrame","currTime","timeToCall","_callback","skip","debugMode","exposeClassName","renderMode","registerSystemEvent","collisionMatrix","groupList","_determineRenderType","userRenderMode","supportRender","capabilities","localCanvas","localContainer","el","HTMLElement","querySelector","tagName","insertBefore","clientWidth","clientHeight","body","documentElement","className","addClass","stencil","antialias","ENABLE_WEBGL_ANTIALIAS","alpha","ENABLE_TRANSPARENT_CANVAS","initWebGL","device","_gl","CLEANUP_IMAGE_CACHE","initCanvas","_ctx","oncontextmenu","_isContextMenuEnable","hiddenPropName","win","internal","inputManager","hidden","mozHidden","msHidden","webkitHidden","onHidden","onShown","arg0","arg1","arg2","arg3","arg4","changeList","navigator","userAgent","onfocus","_valueTypes","BaseNode","PrefabHelper","nodeMemPool","NodeMemPool","AffineTrans","RenderFlow","Destroying","Flags","ONE_DEGREE","ActionManagerExist","emptyFunc","_gwpVec3","_gwpQuat","_tpVec3a","_tpVec3b","_tpQuata","_tpQuatb","_swpVec3","_gwsVec3","_swsVec3","_gwrtVec3a","_gwrtVec3b","_gwrtQuata","_gwrtQuatb","_laVec3","_laQuat","_htVec3a","_htVec3b","_gwrQuat","_swrQuat","_mat4_temp","mat4","_vec3_temp","_cachedArray","BuiltinGroupIndex","DEBUG","LocalDirtyFlag","POSITION","SCALE","ROTATION","SKEW","TRS","RS","TRSS","PHYSICS_POSITION","PHYSICS_SCALE","PHYSICS_ROTATION","PHYSICS_TRS","PHYSICS_RS","ALL_POSITION","ALL_SCALE","ALL_ROTATION","ALL_TRS","ALL","EventType","TOUCH_START","TOUCH_MOVE","TOUCH_END","TOUCH_CANCEL","MOUSE_DOWN","MOUSE_MOVE","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_UP","MOUSE_WHEEL","POSITION_CHANGED","ROTATION_CHANGED","SCALE_CHANGED","SIZE_CHANGED","ANCHOR_CHANGED","COLOR_CHANGED","CHILD_ADDED","CHILD_REMOVED","CHILD_REORDER","GROUP_CHANGED","SIBLING_ORDER_CHANGED","_touchEvents","_mouseEvents","_skewNeedWarn","_skewWarn","nodePath","_currentHovered","_touchStartHandler","touch","getLocation","owner","_hitTest","bubbles","dispatchEvent","_touchMoveHandler","_touchEndHandler","_touchCancelHandler","_mouseDownHandler","_mouseMoveHandler","_previousIn","_mouseListener","stopPropagation","_mouseUpHandler","_mouseWheelHandler","_searchComponentsInParent","curr","_parent","next","_checkListeners","_objFlags","_bubblingListeners","_capturingListeners","_doDispatchEvent","_getCapturingTargets","eventPhase","currentTarget","_propagationStopped","_propagationImmediateStopped","_getBubblingTargets","_getActualGroupIndex","groupIndex","_updateCullingMask","_cullingMask","_children","updateLocalMatrix3D","_localMatDirty","_matrix","tm","Trs","toMat4","_trs","skx","tan","sky","_worldMatDirty","updateLocalMatrix2D","dirtyFlag","trs","rotation","_eulerAngles","z","hasSkew","rotationRadians","_a","_b","_c","_d","calculWorldMatrix3D","_updateLocalMatrix","parentMat","_worldMatrix","Mat4","copy","calculWorldMatrix2D","_mulMat","mulMat2D","am","bm","outm","aa","ab","ac","ad","atx","aty","ba","bb","bc","bd","btx","bty","mulMat3D","NodeDefines","_opacity","_color","WHITE","_contentSize","Size","_anchorPoint","_position","_scale","_zIndex","Integer","_localZOrder","serializable","_is3DNode","_groupIndex","formerlySerializedAs","group","setLocalDirty","_eventMask","_renderFlag","FLAG_WORLD_TRANSFORM","fromAngleZ","rotationX","fromEulerNumber","rotationY","eulerAngles","toEuler","fromEuler","FLAG_TRANSFORM","setRotation","scale","setScale","scaleZ","FLAG_OPACITY_COLOR","range","equals","FLAG_COLOR","anchorX","anchorPoint","anchorY","MAX_ZINDEX","MIN_ZINDEX","_onSiblingIndexChanged","is3DNode","_update3DFunction","_reorderChildDirty","_widget","_renderComponent","_touchListener","_initDataFromPool","_childArrivalOrder","_LocalDirtyFlag","obj","_delaySort","_onPreDestroy","_onPreDestroyBase","removeListeners","mask","_backDataIntoPool","sortAllChildren","_onPostActivated","active","_checkListenerMask","_onHierarchyChanged","oldParent","_updateOrderOfArrival","_onHierarchyChangedBase","_nodesOrderDirty","_activeInHierarchy","_calculWorldMatrix","_on3DNodeChanged","_spaceInfo","spaceInfo","localMat","identity","worldMat","_toEuler","_fromEuler","_upgrade_1x_to_2x","desTrs","subarray","_onBatchCreated","prefabInfo","_prefab","sync","syncWithPrefab","children","FLAG_CHILDREN","_onBatchRestored","manager","Mask","_checknSetupSysEvent","newAdded","forDispatch","EventListener","TOUCH_ONE_BY_ONE","swallowTouches","onTouchBegan","onTouchMoved","onTouchEnded","onTouchCancelled","addListener","MOUSE","onMouseDown","onMouseMove","onMouseUp","onMouseScroll","schedule","useCapture","_onDispatch","listeners","__eventTargets","touchEvent","mouseEvent","_offDispatch","removeListener","fastRemove","removeAll","targetOff","has","arg5","pauseSystemEvents","recursive","resumeSystemEvents","point","listener","w","h","cameraPt","testPt","camera","findCamera","getScreenToWorldPoint","_updateWorldMatrix","invert","transformMat4","hit","temp","_enabled","runAction","_suppressDeprecation","pauseAllActions","resumeAllActions","stopAllActions","stopAction","stopActionByTag","getNumberOfRunningActions","getPosition","toPosition","newPosOrX","getScale","toScale","getRotation","toRotation","getContentSize","setContentSize","locContentSize","CC_EDITOR","getAnchorPoint","setAnchorPoint","locAnchorPoint","_invTransformPoint","ltrs","conjugate","transformQuat","inverseSafe","getWorldPosition","setWorldPosition","fromPosition","getWorldRotation","setWorldRotation","val","fromRotation","getWorldScale","setWorldScale","div","fromScale","getWorldRT","opos","orot","fromRT","lookAt","up","fromViewUp","flag","setWorldDirty","getLocalMatrix","getWorldMatrix","worldPoint","nodePoint","convertToNodeSpace","convertToWorldSpace","getNodeToParentTransform","contentSize","transform","fromMat4","getNodeToParentTransformAR","getNodeToWorldTransform","getNodeToWorldTransformAR","getParentToNodeTransform","getWorldToNodeTransform","convertTouchToNodeSpace","convertTouchToNodeSpaceAR","getBoundingBox","getBoundingBoxToWorld","_getBoundingBoxTo","locChildren","child","childRect","arrivalOrder","addChild","cleanup","_setDirtyForNode","_len","_restoreProperties","onRestore","_p","HideInHierarchy","PrivateNode","_originPos","localPosition","_posDirty","override","showInEditor","editorOnly","sendEvent","_super","setParent","getParent","Boolean","_inited","_active","_instantiate","activateNode","idGenerater","ListEntry","priority","markedForDeletion","_listEntries","put","HashUpdateEntry","_hashUpdateEntries","HashTimerEntry","timers","timerIndex","currentTimer","currentTimerSalvaged","_t","_hashTimerEntries","CallbackTimer","_lock","_runForever","_useDelay","_timesExecuted","_repeat","_interval","initWithCallback","seconds","REPEAT_FOREVER","getInterval","setInterval","interval","trigger","cancel","getCallback","unschedule","_timers","timer","_timeScale","_updatesNegList","_updates0List","_updatesPosList","_hashForUpdates","_hashForTimers","_currentTargetSalvaged","_updateHashLocked","_arrayForTimers","_removeHashElement","_removeUpdateFromHash","targetId","listEntry","_priorityIn","ppList","listElement","_appendIn","__instanceId","getNewId","setTimeScale","timeScale","getTimeScale","tmp","hashElement","li","unscheduleAllForTarget","unscheduleAllWithMinPriority","minPriority","temp_length","isScheduled","pauseAllTargets","pauseAllTargetsWithMinPriority","idsWithSelectors","locArrayForTimers","elementUpdate","isTargetPaused","PRIORITY_NON_SYSTEM","RawAsset","_native","charCodeAt","base","getLibUrlNoExt","_$nativeAsset","deserialize","preventDeferredLoadDependents","preventPreloadNativeObject","toString","serialize","createNode","_setRawAsset","filename","inLibrary","WEB_AUDIO","mixins","getItem","complete","_owner","content","downloadUrl","FontLetterDefinition","offsetX","offsetY","textureID","valid","xAdvance","FontAtlas","texture","_letterDefinitions","_texture","addLetterDefinitions","letter","letterDefinition","cloneLetterDefinition","copyLetterDefinitions","mixin","getTexture","getLetter","getLetterDefinitionForChar","_char","hasOwnProperty","BitmapFont","Font","fntDataStr","SpriteFrame","fontSize","_fntConfig","_fontDefDictionary","fntConfig","fontDict","fontDefDictionary","fontDef","xOffset","yOffset","BufferAsset","bin","JsonAsset","json","LabelAtlas","OptimizationPolicy","AUTO","SINGLE_INSTANCE","MULTI_INSTANCE","Prefab","_createFunction","_instantiatedTimes","optimizationPolicy","asyncLoadAssets","readonly","OptimizationPolicyThreshold","compileCreateFunction","jit","compile","_doInstantiate","rootToRedirect","_synced","CCObject","writable","isChildClassOf","Texture2D","ParticleAsset","Script","_Script","JavaScript","_JavaScript","CoffeeScript","_CoffeeScript","TypeScript","_TypeScript","SpriteAtlas","_spriteFrames","getSpriteFrame","sf","getSpriteFrames","textureUtil","temp_uvs","_textureSetter","_refreshTexture","_textureFilename","insetTop","_capInsets","_calculateSlicedUV","insetBottom","insetLeft","insetRight","rotated","originalSize","_rect","uv","_original","_offset","_originalSize","_rotated","_flipX","_flipY","vertices","uvSliced","setTexture","textureLoaded","onTextureLoaded","ensureLoadTexture","isRotated","setRotated","bRotated","_calculateUV","isFlipX","isFlipY","setFlipX","setFlipY","getRect","setRect","getOriginalSize","setOriginalSize","_textureLoadedCallback","_checkRect","setOffset","getOffset","offsets","textureOrTextureFile","_loadTexture","loadImage","postLoadTexture","maxX","maxY","_flipXY","uvs","tempVal","_tempVal","atlasWidth","atlasHeight","leftWidth","rightWidth","centerWidth","topHeight","bottomHeight","centerHeight","row","rowD","col","colD","_row","_rowD","_col","_colD","_setDynamicAtlasFrame","_resetDynamicAtlasFrame","texw","texh","_r","_tempVal2","nu","nv","_serialize","_deserialize","handle","capInsets","textureUuid","copyWithZone","initWithTexture","TTFFont","_fontFamily","String","TextAsset","text","_gfx","_interopRequireDefault","CUSTOM_PIXEL_FORMAT","PixelFormat","RGB565","TEXTURE_FMT_R5_G6_B5","RGB5A1","TEXTURE_FMT_R5_G5_B5_A1","RGBA4444","TEXTURE_FMT_R4_G4_B4_A4","RGB888","TEXTURE_FMT_RGB8","RGBA8888","TEXTURE_FMT_RGBA8","RGBA32F","TEXTURE_FMT_RGBA32F","A8","TEXTURE_FMT_A8","I8","TEXTURE_FMT_L8","AI8","TEXTURE_FMT_L8_A8","RGB_PVRTC_2BPPV1","TEXTURE_FMT_RGB_PVRTC_2BPPV1","RGBA_PVRTC_2BPPV1","TEXTURE_FMT_RGBA_PVRTC_2BPPV1","RGB_A_PVRTC_2BPPV1","RGB_PVRTC_4BPPV1","TEXTURE_FMT_RGB_PVRTC_4BPPV1","RGBA_PVRTC_4BPPV1","TEXTURE_FMT_RGBA_PVRTC_4BPPV1","RGB_A_PVRTC_4BPPV1","RGB_ETC1","TEXTURE_FMT_RGB_ETC1","RGBA_ETC1","RGB_ETC2","TEXTURE_FMT_RGB_ETC2","RGBA_ETC2","TEXTURE_FMT_RGBA_ETC2","REPEAT","CLAMP_TO_EDGE","MIRRORED_REPEAT","Filter","LINEAR","NEAREST","FilterIndex","9728","9729","_images","_sharedOpts","minFilter","magFilter","wrapS","wrapT","format","genMipmaps","images","image","premultiplyAlpha","_getSharedOptions","_image","_compressed","initWithData","_format","initWithElement","_premultiplyAlpha","_minFilter","_magFilter","_mipFilter","_wrapS","_wrapT","_genMipmaps","_packable","packable","_FilterIndex","extnames","_hashDirty","_hash","getImpl","getId","options","updateImg","mipFilter","HTMLCanvasElement","handleLoadedTexture","pixelFormat","pixelsWidth","pixelsHeight","_getGFXPixelFormat","_checkPackable","getHtmlElementObj","deleteAtlasTexture","getPixelFormat","hasPremultipliedAlpha","HTMLImageElement","_clearImage","description","releaseTexture","setWrapMode","setFilters","setPremultiplyAlpha","premultiply","dynamicAtlas","_isCompressed","maxFrameSize","_getHash","Atlas","DEFAULT_HASH","_getOpts","anisotropy","_anisotropy","_resetUnderlyingMipmaps","mipmapSources","CC_TEST","fields","split","extIdStr","extIds","defaultExt","bestExt","bestIndex","bestFormat","SupportTextureFormats","SUPPORT_TEXTURE_FORMATS","extFormat","tmpExt","tmpFormat","ext","webp","customEnv","removeItem","_CCAsset","_effectParser","EffectAsset","techniques","shaders","lib","_forward","_programLib","define","_initEffect","parseEffect","freeze","getInstantiatedEffect","getEffect","Texture","gfx","BUILTIN_NAME","SPRITE","GRAY_SPRITE","UNLIT","Material","_manualHash","_dirty","_defines","_effectAsset","_techniqueIndex","_techniqueData","effectName","effectAsset","techniqueIndex","switchTechnique","getBuiltinMaterial","getBuiltin","createWithBuiltin","material","setProperty","passIdx","directly","toUpperCase","def","getDefine","getProperty","force","setCullMode","cullMode","CULL_BACK","setDepth","depthTest","depthWrite","depthFunc","DS_FUNC_LESS","setBlend","blendEq","blendSrc","blendDst","blendAlphaEq","blendSrcAlpha","blendDstAlpha","blendColor","BLEND_FUNC_ADD","BLEND_SRC_ALPHA","BLEND_ONE_MINUS_SRC_ALPHA","setStencilEnabled","stencilTest","STENCIL_INHERIT","setStencil","stencilFunc","stencilRef","stencilMask","stencilFailOp","stencilZFailOp","stencilZPassOp","stencilWriteMask","DS_FUNC_ALWAYS","STENCIL_OP_KEEP","updateHash","hash","getHash","passDatas","passData","defines","_pass","EffectBase","_technique","_createPassProp","pass","_properties","uniform","Float32Array","_setPassProperty","success","passes","setStencilFront","setStencilBack","parseTechniques","_types","_enums","getInvolvedProgram","programName","getTemplate","parseProperties","passJson","propertiesJson","program","uniforms","forEach","assign","propInfo","enums2default","PARAM_TEXTURE_2D","PARAM_INT","PARAM_FLOAT","passDefines","techNum","tech","techName","passNum","passName","detailName","stage","newPass","rasterizerState","blendState","blend","depthStencilState","stencilFuncFront","stencilRefFront","stencilMaskFront","stencilFailOpFront","stencilZFailOpFront","stencilZPassOpFront","stencilWriteMaskFront","stencilFuncBack","stencilRefBack","stencilMaskBack","stencilFailOpBack","stencilZFailOpBack","stencilZPassOpBack","stencilWriteMaskBack","_murmurhash2_gc","_utils","_effectBase","EffectVariant","_EffectBase","_passes","_stagePasses","_onEffectChanged","variantPasses","stagePasses","variant","setPrototypeOf","_stage","serializePasses","Effect","_techniques","_asset","createNative","_pool","materialPool","exampleMat","renderComponent","pool","MaterialVariant","serializeDefines","serializeTechniques","count","mat","maxSize","_clean","register","_CCMaterial","_effectVariant","_materialPool","ccclass","_decorator","_Material","_material","materialName","str","serializePass","excludeProperties","_programName","_cullMode","_blend","_blendEq","_blendAlphaEq","_blendSrc","_blendDst","_blendSrcAlpha","_blendDstAlpha","_blendColor","_depthTest","_depthWrite","_depthFunc","_stencilTest","_stencilFuncFront","_stencilRefFront","_stencilMaskFront","_stencilFailOpFront","_stencilZFailOpFront","_stencilZPassOpFront","_stencilWriteMaskFront","_stencilFuncBack","_stencilRefBack","_stencilMaskBack","_stencilFailOpBack","_stencilZFailOpBack","_stencilZPassOpBack","_stencilWriteMaskBack","serializeUniforms","hashData","param","PARAM_TEXTURE_CUBE","_geomUtils","RendererCamera","_mat4_temp_1","_mat4_temp_2","_v3_temp_1","_v3_temp_2","_v3_temp_3","_cameras","_debugCamera","repositionDebugCamera","getNode","ClearFlags","COLOR","DEPTH","STENCIL","StageFlags","OPAQUE","TRANSPARENT","Component","setStages","dirty","_camera","editor","_clearFlags","_backgroundColor","_depth","_zoomRatio","_targetTexture","_fov","_orthoSize","_nearClip","_farClip","_ortho","_renderStages","_alignWithScreen","zoomRatio","tooltip","CC_DEV","fov","orthoSize","nearClip","_updateClippingpPlanes","farClip","ortho","_updateProjection","_updateRect","cullingMask","_updateCameraMask","clearFlags","setClearFlags","_updateBackgroundColor","setPriority","targetTexture","_updateTargetTexture","renderStages","_updateStages","alignWithScreen","_is3D","cameras","containsNode","_findRendererCamera","_count","_setupDebugCamera","setFov","setNear","setFar","setColor","setNode","addCamera","setFrameBuffer","_framebuffer","setType","flags","stages","_init","beforeDraw","onEnable","onDisable","removeCamera","remove","getScreenToWorldMatrix2D","getWorldToScreenMatrix2D","_mat4_temp_1m","m12","m13","center","visibleRect","screenPosition","screenToWorld","getWorldToScreenPoint","worldPosition","worldToScreen","getRay","screenPos","geomUtils","Ray","fromPoints","renderCamera","_onAlignWithScreen","RAD","atan","setOrthoHeight","getNodeToCameraTransform","getWorldToCameraMatrix","getCameraToWorldPoint","getWorldToCameraPoint","getCameraToWorldMatrix","jsArray","IsStartCalled","IsOnEnableCalled","IsEditorOnEnableCalled","sortedIndex","order","_executionOrder","test","testOrder","testId","stableRemoveInactive","flagToClear","removeAt","LifeCycleInvoker","__ctor__","invokeFunc","Iterator","_zero","_neg","_pos","_invoke","invoke","compareOrder","OneOffInvoker","cancelInactive","compsNeg","sort","compsPos","ReusableInvoker","createInvokeImpl","indiePath","useDt","ensureFlag","fastPath","Function","invokeStart","invokeUpdate","invokeLateUpdate","startInvoker","updateInvoker","lateUpdateInvoker","scheduleInNextFrame","_updating","invokeOnEnable","compScheduler","_onEnabled","_scheduleImmediate","_onDisabled","lateUpdate","enableComp","invoker","disableComp","_deferredSchedule","_earlyStartForNewComps","equalClips","clip1","clip2","PLAY","STOP","PAUSE","RESUME","LASTFRAME","FINISHED","Animation","_animator","_nameToState","_didInit","_currentClip","_defaultClip","defaultClip","currentClip","_writableClips","_clips","playOnLoad","isPlaying","getAnimationState","onDestroy","getClips","playAdditive","enabledInHierarchy","addClip","newName","contains","oldState","newState","removeClip","filter","_EventTargetOn","states","_EventTargetOff","_createStates","defaultClipState","AudioSource","_mute","_pausedFlag","animatable","clamp01","mute","_ensureDataLoaded","_pausedCallback","_restoreCallback","rewind","BlockEvents","BlockInputEvents","menu","inspector","help","GraySpriteState","Transition","NORMAL","HOVER","PRESSED","DISABLED","Button","_pressed","_hovered","_fromColor","_toColor","_time","_transitionFinished","_fromScale","_toScale","_originalScale","_graySpriteMaterial","_spriteMaterial","_sprite","interactable","notify","_updateState","_resetState","_resizeToTarget","_resizeNodeToTargetNode","enableAutoGrayEffect","_updateDisabledState","transition","oldValue","_updateTransition","normalColor","displayName","_getButtonState","_getTarget","pressedColor","hoverColor","disabledColor","zoomScale","normalSprite","pressedSprite","hoverSprite","disabledSprite","_applyTarget","_unregisterTargetEvent","clickEvents","EventHandler","__preload","originalScale","_setTargetColor","_registerNodeEvent","_unregisterNodeEvent","_onTargetSpriteFrameChanged","_setCurrentStateSprite","_onTargetColorChanged","_setCurrentStateColor","_onTargetScaleChanged","_getStateColor","_getStateSprite","_onTouchBegan","_onTouchMove","_onTouchEnded","_onTouchCancel","_onMouseMoveIn","_onMouseMoveOut","_registerTargetEvent","_getTargetSprite","sprite","Sprite","_applyTransition","emitEvents","_updateColorTransitionImmediately","_updateColorTransition","_updateSpriteTransition","_updateScaleTransition","_zoomUp","_zoomBack","oldTransition","useGrayMaterial","_switchGrayMaterial","Canvas","resetInEditor","_designResolution","designResolution","applySettings","_fitWidth","_fitHeight","fitHeight","fitWidth","_fitDesignResolution","widget","Widget","updateAlignment","cameraNode","setSiblingIndex","addComponent","policy","ResolutionPolicy","SHOW_ALL","FIXED_WIDTH","FIXED_HEIGHT","NO_BORDER","designRes","setDesignResolutionSize","IsOnLoadCalled","getClassName","trimLeft","lastIndexOf","__scriptAsset","_isOnLoadCalled","onFocusInEditor","onLostFocusInEditor","typeOrClassName","getComponents","getComponentInChildren","_getLocalBounds","unscheduleAllCallbacks","eventTargets","destroyComp","_removeComponent","cloned","instantiate","_clone","scheduleOnce","callback_fn","_requireComponent","cls","reqComp","requireComponent","executionOrder","__scriptUuid","_componentId","_componentName","_genCompIdIfNeeded","_compId2Name","_compName2Id","handler","customEventData","compType","_getClassById","getClassByName","_getClassId","compId","LabelFrame","HorizontalAlign","TextAlignment","VerticalAlign","VerticalTextAlignment","Overflow","CLAMP","SHRINK","RESIZE_HEIGHT","CacheMode","BITMAP","CHAR","Label","_actualFontSize","_assemblerData","_frame","_ttfTexture","_letterTexture","_updateMaterial","_updateMaterialCanvas","_updateMaterialWebgl","_useOriginalSize","_string","string","setVertsDirty","_checkStringEmpty","multiline","horizontalAlign","LEFT","verticalAlign","TOP","actualFontSize","_fontSize","fontFamily","_lineHeight","lineHeight","overflow","_enableWrapText","enableWrapText","_N$file","font","_isSystemFontUsed","_forceUpdateRenderData","useSystemFont","markForValidate","_bmFontOriginalSize","_spacingX","spacingX","_batchAsBitmap","cacheMode","_styleFlags","enableBold","enableItalic","enableUnderline","_underlineHeight","underlineHeight","_shareAtlas","clearCharCache","clearAllCache","_nodeSizeChanged","_assembler","_resetAssemblerData","_updateColor","_validateRender","_materials","disableRender","_resetAssembler","markForRender","_applyFontTexture","_onBMFontTextureLoaded","updateRenderData","_getAssemblerData","getMaterial","_enableBold","_enableItalics","_enableUnderline","NodeEvent","Type","HORIZONTAL","VERTICAL","GRID","ResizeMode","CONTAINER","CHILDREN","AxisDirection","VerticalDirection","BOTTOM_TO_TOP","TOP_TO_BOTTOM","HorizontalDirection","LEFT_TO_RIGHT","RIGHT_TO_LEFT","Layout","_layoutSize","_layoutDirty","_resize","_N$layoutType","_doLayoutDirty","resizeMode","cellSize","startAxis","_N$padding","paddingLeft","paddingRight","paddingTop","paddingBottom","spacingY","verticalDirection","horizontalDirection","affectedByScale","_migratePaddingData","_addEventListeners","_removeEventListeners","_doScaleDirty","updateLayout","_resized","_childAdded","_childRemoved","_addChildrenEventListeners","_removeChildrenEventListeners","_doLayoutHorizontally","baseWidth","rowBreak","fnPositionY","applyChildren","layoutAnchor","sign","paddingX","leftBoundaryOfLayout","nextX","rowMaxHeight","tempMaxHeight","secondMaxHeight","containerResizeBoundary","maxHeightChildAnchorY","activeChildCount","newChildWidth","childScaleX","_getUsedScaleValue","childScaleY","childBoundingBoxWidth","childBoundingBoxHeight","rightBoundaryOfChild","rowBreakBoundary","leftToRightRowBreak","rightToLeftRowBreak","finalPositionY","tempFinalPositionY","signX","topMarign","_getVerticalBaseHeight","newHeight","_doLayoutVertically","baseHeight","columnBreak","fnPositionX","paddingY","bottomBoundaryOfLayout","nextY","columnMaxWidth","tempMaxWidth","secondMaxWidth","column","maxWidthChildAnchorX","newChildHeight","topBoundaryOfChild","columnBreakBoundary","bottomToTopColumnBreak","topToBottomColumnBreak","finalPositionX","tempFinalPositionX","rightMarign","_doLayoutBasic","allChildrenBoundingBox","leftBottomSpace","rightTopSpace","xMax","yMax","newSize","toFixed","newAnchorX","newAnchorY","_doLayoutGridAxisHorizontal","layoutSize","topOffset","boundary","_doLayoutGridAxisVertical","leftOffset","newWidth","_doLayoutGrid","_getHorizontalBaseWidth","_doLayout","_mat","_vec","_materialVariant","Graphics","_vec2_temp","_circlepoints","_calculateCircle","radius","segements","anglePerStep","MaskType","RECT","ELLIPSE","IMAGE_STENCIL","_graphics","_enableMaterial","_exitMaterial","_clearMaterial","_spriteFrame","_type","alphaThreshold","_updateGraphics","_activateMaterial","lastSprite","slide","inverted","_segments","FLAG_POST_RENDER","_removeGraphics","_createGraphics","STENCIL_DISABLE","setMaterial","Assembler","lineWidth","strokeColor","graphics","lineTo","stroke","fill","rx","ry","px","py","enable","FLAG_RENDER","FLAG_UPDATE_RENDER_DATA","BlendFunc","MotionStreak","preview","_fadeTime","fadeTime","_minSeg","minSeg","_stroke","_fastMode","fastMode","_renderData","materials","_vertsDirty","assembler","registerValidate","instantiated","getMaterials","_getDefaultMaterial","updateColor","_checkBacth","_flush","_dummyNode","_tempPoint","_tempPrevPoint","quintEaseOut","getTimeInMilliseconds","Date","getMilliseconds","SCROLL_TO_TOP","SCROLL_TO_BOTTOM","SCROLL_TO_LEFT","SCROLL_TO_RIGHT","SCROLLING","BOUNCE_TOP","BOUNCE_BOTTOM","BOUNCE_LEFT","BOUNCE_RIGHT","SCROLL_ENDED","TOUCH_UP","AUTOSCROLL_ENDED_WITH_THRESHOLD","SCROLL_BEGAN","eventMap","scroll-to-top","scroll-to-bottom","scroll-to-left","scroll-to-right","scrolling","bounce-bottom","bounce-left","bounce-right","bounce-top","scroll-ended","touch-up","scroll-ended-with-threshold","scroll-began","ScrollView","_topBoundary","_bottomBoundary","_leftBoundary","_rightBoundary","_touchMoveDisplacements","_touchMoveTimeDeltas","_touchMovePreviousTimestamp","_touchMoved","_autoScrolling","_autoScrollAttenuate","_autoScrollStartPosition","_autoScrollTargetDelta","_autoScrollTotalTime","_autoScrollAccumulatedTime","_autoScrollCurrentlyOutOfBoundary","_autoScrollBraking","_autoScrollBrakingStartPosition","_outOfBoundaryAmount","_outOfBoundaryAmountDirty","_stopMouseWheel","_mouseWheelEventElapsedTime","_isScrollEndedWithThresholdEventFired","_scrollEventEmitMask","_isBouncing","_scrolling","_calculateBoundary","horizontal","vertical","inertia","brake","elastic","bounceDuration","horizontalScrollBar","Scrollbar","setTargetScrollView","_updateScrollBar","verticalScrollBar","scrollEvents","cancelInnerEvents","_view","scrollToBottom","timeInSecond","attenuated","moveDelta","_calculateMovePercentDelta","anchor","applyToHorizontal","applyToVertical","_startAutoScroll","_moveContent","scrollToTop","scrollToLeft","scrollToRight","scrollToTopLeft","scrollToTopRight","scrollToBottomLeft","scrollToBottomRight","scrollToOffset","maxScrollOffset","getMaxScrollOffset","scrollTo","getScrollOffset","topDelta","_getContentTopBoundary","leftDeta","_getContentLeftBoundary","viewSize","horizontalMaximizeOffset","verticalMaximizeOffset","scrollToPercentHorizontal","scrollToPercentVertical","stopAutoScroll","setContentPosition","fuzzyEquals","getContentPosition","isScrolling","isAutoScrolling","_registerEvent","_onTouchMoved","_onTouchCancelled","_onMouseWheel","_unregisterEvent","captureListeners","_hasNestedViewGroup","deltaMove","wheelPrecision","CC_RUNTIME","getScrollY","_processDeltaMove","_handlePressLogic","_checkMouseWheel","_stopPropagationIfTargetIsMe","_getHowMuchOutOfBoundary","_processInertiaScroll","_dispatchEvent","_onScrollBarTouchEnded","scrollSize","bottomDeta","_getContentBottomBoundary","totalScrollDelta","_moveContentToTopLeft","scrollViewSize","_updateScrollBarState","_adjustContentOutOfBoundary","layout","Event","CAPTURING_PHASE","ViewGroup","AT_TARGET","_handleMoveLogic","getStartLocation","cancelEvent","EventTouch","getTouches","simulate","_handleReleaseLogic","_scrollChildren","_gatherTouchMove","_getLocalAxisAlignDelta","getPreviousLocation","outOfBoundary","realMove","_clampDelta","scrollEventType","_onScrollBarTouchBegan","timeStamp","_startBounceBackIfNeeded","bounceBackAmount","bounceBackTime","touchMoveVelocity","_calculateTouchMoveVelocity","_startInertiaScroll","_isOutOfBoundary","_isNecessaryAutoScrollBrake","getScrollEndedEventTiming","_processAutoScrolling","isAutoScrollBrake","brakingFactor","percentage","newPosition","reachedEnd","brakeOffsetPosition","inertiaTotalMovement","_startAttenuatingAutoScroll","_calculateAttenuatedFactor","initialVelocity","_calculateAutoScrollTimeByInitalSpeed","targetDelta","scrollviewSize","totalMoveWidth","totalMoveHeight","attenuatedFactorX","attenuatedFactorY","originalMoveLength","factor","initalSpeed","adjustedDeltaMove","_flattenVectorByDirection","totalTime","reduce","totalMovement","canStartBounceBack","adjustedMove","_getContentRightBoundary","addition","outOfBoundaryAmount","_onScroll","_hideScrollbar","SpriteType","SIMPLE","SLICED","TILED","FILLED","MESH","FillType","RADIAL","SizeMode","CUSTOM","TRIMMED","RAW","GRAY","_sizeMode","_fillType","_fillCenter","_fillStart","_fillRange","_isTrimmedMode","_atlas","_applySpriteFrame","fillType","fillCenter","fillStart","fillRange","trim","sizeMode","_applySpriteSize","setVisible","setState","_applyAtlas","oldFrame","oldTexture","newTexture","WXSubContextView","SwanSubContextView","BUILTIN_CLASSID_RE","MissingClass","_$erialized","MissingScript","compiled","safeFindClass","reportMissingClass","getMissingWrapper","_MissingScript","EventMouse","eventType","_eventType","_button","_prevX","_prevY","_scrollX","_scrollY","setScrollData","scrollX","scrollY","getScrollX","setLocation","getLocationInView","_designResolutionSize","_setPrevCursor","getDelta","getDeltaX","getDeltaY","setButton","button","getButton","getLocationX","getLocationY","DOWN","UP","MOVE","SCROLL","BUTTON_LEFT","BUTTON_RIGHT","BUTTON_MIDDLE","BUTTON_4","BUTTON_5","BUTTON_6","BUTTON_7","BUTTON_8","touchArr","TOUCH","_eventCode","_touches","currentTouch","getEventCode","_setEventCode","eventCode","_setTouches","touches","setTouchInfo","getID","MAX_TOUCHES","BEGAN","MOVED","ENDED","CANCELED","EventAcceleration","acc","ACCELERATION","EventKeyboard","keyCode","isPressed","KEYBOARD","listenerID","_onEvent","_listenerID","_registered","_fixedPriority","_node","_isEnabled","_setPaused","_setRegistered","registered","_isRegistered","_getType","_getListenerID","_setFixedPriority","fixedPriority","_getFixedPriority","_setSceneGraphPriority","_getSceneGraphPriority","checkAvailable","isEnabled","UNKNOWN","TOUCH_ALL_AT_ONCE","ListenerID","Custom","listenerId","_onCustomEvent","Mouse","eventListener","TouchOneByOne","_claimedTouches","setSwallowTouches","needSwallow","isSwallowTouches","TouchAllAtOnce","onTouchesBegan","onTouchesMoved","onTouchesEnded","onTouchesCancelled","Acceleration","_onAccelerationEvent","Keyboard","onKeyPressed","onKeyReleased","argObj","listenerType","eventName","_EventListenerVector","_fixedListeners","_sceneGraphListeners","gt0Index","empty","clearSceneGraphListeners","clearFixedListeners","getFixedPriorityListeners","getSceneGraphPriorityListeners","__getListenerID","DIRTY_NONE","DIRTY_FIXED_PRIORITY","DIRTY_SCENE_GRAPH_PRIORITY","DIRTY_ALL","_listenersMap","_priorityDirtyFlagMap","_nodeListenersMap","_toAddedListeners","_toRemovedListeners","_dirtyListeners","_inDispatch","_currentTouch","_internalCustomListenerIDs","selListeners","childrenCount","_BaseNode","_addListener","_forceAddEventListener","_setDirty","_associateNodeAndEventListener","_getListeners","_updateDirtyFlagForSceneGraph","locDirtyListeners","selKey","_removeAllListenersInVector","listenerVector","selListener","_dissociateNodeAndEventListener","_removeListenersForListenerID","fixedPriorityListeners","sceneGraphPriorityListeners","locToAddedListeners","_sortEventListeners","locFlagMap","_sortListenersOfFixedPriority","_sortListenersOfSceneGraphPriority","sceneGraphListener","_sortEventListenersOfSceneGraphPriorityDes","l1","node1","node2","ex","fixedListeners","_sortListenersOfFixedPriorityAsc","_onUpdateListeners","idx","toRemovedListeners","locListenersMap","locPriorityDirtyFlagMap","_cleanToRemovedListeners","_updateTouchListeners","locInDispatch","_onTouchEventCallback","argsObj","selTouch","removedIdx","isClaimed","getCode","ENABLE_MULTI_TOUCH","CANCELLED","isStopped","needsMutableSet","_dispatchTouchEvent","oneByOneListeners","allAtOnceListeners","originalTouches","mutableTouches","oneByOneArgsObj","_dispatchEventToListeners","_onTouchesEventCallback","callbackParams","onEvent","eventOrArgs","shouldStopPropagation","locDirtyFlagMap","_sortNumberAsc","nodeOrPriority","isNumber","addCustomListener","isFound","locListener","_removeListenerInVector","_removeListenerInCallback","listenersCopy","removeCustomListeners","customEventName","removeAllListeners","locListeners","locInternalCustomEventIDs","getType","_onListenerCallback","dispatchCustomEvent","optionalUserData","ev","EventCustom","setUserData","Touch","_lastModified","_point","_prevPoint","_startPoint","getPreviousLocationInView","getStartLocationInView","_startPointCaptured","_convertPointWithScale","_setPoint","_setPrevPoint","CallbacksInvoker","EventListeners","_callbackTable","rootInvoker","isInvoking","infos","callbackInfos","containCanceled","purgeCanceled","__on","__off","unuse","NO_TYPE","reuse","stopPropagationImmediate","getCurrentTarget","BUBBLING_PHASE","detail","getUserData","getEventName","_eventPool","Pool","_get","inputManger","KEY_DOWN","KEY_UP","DEVICEMOTION","keyboardListener","accelerationListener","SystemEvent","setAccelerometerEnabled","isEnable","DeviceMotionEvent","requestPermission","response","setAccelerometerInterval","systemEvent","hasKeyDownEventListener","hasKeyUpEventListener","LineCap","LineJoin","_impl","_Impl","_lineWidth","_strokeColor","BLACK","_lineJoin","MITER","_lineCap","BUTT","_fillColor","_miterLimit","lineJoin","lineCap","fillColor","miterLimit","bezierCurveTo","c1x","c1y","c2x","c2y","quadraticCurveTo","cx","cy","arc","endAngle","counterclockwise","ellipse","circle","roundRect","fillRect","clean","Helper","PointFlags","KAPPA90","ctx","hda","ndivs","da","kappa","dx","dy","tanx","tany","ptanx","ptany","tesselateBezier","y3","x4","y4","level","x12","y12","x23","y23","x34","y34","x123","y123","x234","y234","x1234","y1234","d3","_tessTol","_addPoint","PT_BEVEL","ROUND","SQUARE","BEVEL","PT_CORNER","PT_LEFT","PT_INNERBEVEL","Pipeline","LoadingItems","AssetLoader","Downloader","Loader","AssetTable","assetTables","assets","_info","raw","getResWithUrl","res","isUuid","_uuidInSettings","_getAssetInfoInRuntime","isRawAsset","_sharedResources","_sharedList","CCLoader","assetLoader","downloader","md5Pipe","_autoReleaseSetting","getXMLHttpRequest","XMLHttpRequest","ActiveXObject","addDownloadHandlers","extMap","addHandlers","addLoadHandlers","resources","progressCallback","completeCallback","singleRes","resource","_cache","queue","errors","items","getContent","initQueueDeps","append","flowInDeps","urlList","completedCount","totalCount","_ownerQueue","_childOnProgress","deps","ownerQueue","getQueue","accepted","_assetTables","_getResUuid","mount","quiet","assetTable","substr","getUuid","extname","_getReferenceKey","assetOrUrlOrUuid","_urlNotFound","_parseLoadResArgs","onComplete","isValidType","loadRes","setAutoReleaseRecursively","_loadResUuids","uuids","urls","assetRes","urlRes","loadResArray","isTypesArray","assetType","loadResDir","getUuidArray","getRes","ref","alias","getResCount","getDependsRecursively","getBuiltinDeps","releaseAsset","releaseRes","releaseResDir","removed","setAutoRelease","depends","depend","isAutoRelease","assetOrUrl","ID","async","pipeline","reusedArray","queryAssetInfo","rawUrl","toLowerCase","queueId","pushToMap","Entry","_pathToUuid","isMatchByWord","nextAscii","out_urls","path2uuid","isMainAsset","substring","newEntry","_getInfo_DEBUG","CC_DEBUG","formatSupport","loadDomAudio","dom","clearEvent","failure","USE_LOADER_EVENT","readyState","loadWebAudio","request","open","responseType","onload","onerror","send","urlParam","parseDepends","parsed","dependKeys","visitAsset","excludeMap","visitComponent","getOwnPropertyNames","_j","_val","visitNode","oldSceneAssets","nextSceneAssets","persistNodes","releaseSettings","_i3","_i4","_key","xhr","errInfo","arrayBuffer","Uint8Array","status","errorMessage","ontimeout","downloadAudio","PackDownloader","downloadBinary","downloadText","urlAppendTimestamp","downloadScript","isAsync","loadHandler","removeChild","errorHandler","location","protocol","crossOrigin","downloadImage","isCrossOrigin","img","Image","naturalWidth","loadCallback","errorCallback","defaultMap","png","jpg","bmp","jpeg","gif","ico","tiff","pvr","pkm","ogg","wav","m4a","txt","xml","vsh","fsh","atlas","tmx","tsx","ExportJson","plist","fnt","eot","ttf","woff","svg","ttc","binary","dbbin","skel","_curConcurrent","_loadQueue","_subpackages","_handleLoadQueue","DOWNLOAD_MAX_CONCURRENT","nextOne","syncRet","downloadFunc","ignoreMaxConcurrency","loadSubpackage","pac","textUtils","_canvasContext","_testString","_fontFaces","_loadingFonts","_timeout","useNativeCheck","nativeCheck","FontFace","match","exec","safari10Match","vendor","_checkFontLoaded","allFontsLoaded","fontLoadHandle","fontFamilyName","oldWidth","refWidth","fontDesc","safeMeasureText","clearInterval","nativeCheckFontLoaded","Promise","resolve","reject","check","fonts","timeoutId","race","fontLoader","loadFont","_getFontFamily","labelCanvas","getContext","fontStyle","fontStr","textContent","preloadDiv","divStyle","innerHTML","fontHandle","ttfIndex","slashPos","plistParser","loadUuid","loadJSON","parse","platform","FB_PLAYABLE_ADS","tex","loadAudioAsAsset","audioClip","loadBinary","PVR_HEADER_LENGTH","PVR_MAGIC","PVR_HEADER_MAGIC","PVR_HEADER_HEIGHT","PVR_HEADER_WIDTH","PVR_HEADER_METADATA","ETC_PKM_HEADER_SIZE","ETC_PKM_FORMAT_OFFSET","ETC_PKM_ENCODED_WIDTH_OFFSET","ETC_PKM_ENCODED_HEIGHT_OFFSET","ETC_PKM_WIDTH_OFFSET","ETC_PKM_HEIGHT_OFFSET","ETC1_RGB_NO_MIPMAPS","ETC2_RGB_NO_MIPMAPS","ETC2_RGBA_NO_MIPMAPS","readBEUint16","header","ArrayBuffer","Int32Array","dataOffset","prefab","fire","_qid","random","_queues","ItemState","WORKING","COMPLETE","_queueDeps","isIdValid","_parseUrlParam","itemSplit","createItem","checkedIds","checkCircleReference","recursiveCall","subDep","_pipeline","_errorUrls","_appending","completed","allComplete","itemComplete","dep","registerQueueDep","depId","queueDepList","finishDep","flowIn","isEmptyObject","isCompleted","isItemCompleted","exists","hasListener","errorListId","isString","UuidRegex","MD5Pipe","md5AssetsMap","md5NativeAssetsMap","libraryBase","transformURL","replace","hashValue","Unpackers","PackState","Invalid","Removed","Downloading","Loaded","UnpackerData","unpacker","uuidToPack","packIndices","globalUnpackers","toBeChecked","packUuid","msToRelease","initPacks","packs","pushFront","_loadNewPack","packUrl","packJson","_doLoadNewPack","_doPreload","unpackerData","JsonUnpacker","packedJson","TextureUnpacker","maxDuration","retrieve","_selectLoadedPack","packUuids","existsPackState","existsPackUuid","flow","pipe","pipeId","itemState","flowOut","pipes","_pipes","insertPipe","nextPipe","previousPipe","insertPipeAfter","refPipe","newPipe","appendPipe","copyItemStates","srcItem","dstItems","getUuidFromURL","matches","_uuidToSubPack","SubPackPipe","subpackage","packName","pack","overrideMimeType","responseText","jsons","contents","indices","datas","__type__","_noCacheRex","isSceneObj","tdInfo","deferredLoadRawAssetsInRuntime","dependUuid","uuidList","objList","uuidObjList","propList","uuidPropList","stillUseUrl","_stillUseUrl","deferredLoadRaw","_ownerProp","loadDepends","itemsMap","wasRawAssetType","dependSrc","dependUrl","loadCallbackCtx","canDeferredLoad","isScene","classFinder","stack","Details","existingAsset","CompScheduler","IsPreloadStarted","IsOnLoadStarted","Deactivating","UnsortedInvoker","invokePreload","invokeOnLoad","activateTasksPool","_componentCorrupted","_activatingStack","task","_activateNodeRecursively","preloadInvoker","onLoadInvoker","onEnableInvoker","originCount","activateComp","_deactivateNodeRecursively","lastTask","resetComp","decodeUuid","_libraryBase","_rawAssetsBase","_uuidToRawAsset","RawAssetEntry","errorInfo","inRawAssetsDir","_queryAssetInfoInEditor","parseUuidInEditor","loadJson","randomUuid","getTime","getAssetByUuid","_uuidToAsset","libraryPath","stripSep","rawAssetsBase","subpackages","subPackPipe","md5ImportMap","md5Entries","md5RawAssetsMap","rawAssets","mountPoint","typeId","isSubAsset","packedAssets","mountPaths","_builtins","_builtinDeps","loadBuiltins","dirname","builtin","internalMountPath","getBuiltins","Attr","isPlainEmptyObj_DEV","cloneable_DEV","DELIMETER","preprocess","BUILTIN_ENTRIES","pushUnique","deferredInitializer","declareProperties","$super","appendProp","__props__","defineProp","propName","es6","defaultValue","setClassAttr","parseAttributes","defineGetSet","getter","setter","getOwnPropertyDescriptor","setterUndefined","getDefault","defaultVal","mixinWithInherited","dest","getPropertyDescriptor","doDefine","baseClass","ctors","fireClass","__es6__","__ES6__","_getAllCtors","_createCtor","CCClass","_isCCClass","getClassAttrs","__initProps__","compileProps","setClassName","_RF","peek","script","_setClassId","getNewValueTypeCodeJit","clsName","propVal","escapeForJS","getInitPropsJit","attrs","F","attrKey","statement","expression","IDENTIFIER_RE","ValueType","actualClass","initProps","boundSuperCalls","ctorLen","SNIPPET","ctorName","getCtors","__ctors__","baseOrMixins","concat","baseOrMixin","baseCtors","SuperCallReg","xyz","hasSuperCall","pd","superFunc","preprocessAttrs","__values__","_sealed","some","staticPropName","validateMethodWithProps","_registerEditorProps","_fastDefine","serializableFields","attr","getInheritanceChain","klass","chain","getSuper","PrimitiveTypes","attributes","usedInGetter","propNamePrefix","initAttrs","primitiveType","ScriptUuid","ScriptAsset","isEnum","getList","parseSimpleAttr","attrName","expectType","fastDefine","getNewValueTypeCode","Preprocess","CACHE_KEY","fNOP","getSubDict","checkCtorArgument","decorate","_checkNormalArgument","validator_DEV","decoratorName","checkCompArgument","_argumentChecker","checkStringArgument","checkNumberArgument","getClassCache","getDefaultFromInitializer","initializer","extractActualDefaultValues","dummyObj","genProperty","desc","fullOptions","getFullFormOfProperty","existsProperty","actualDefaultValues","decoratedProto","createEditorDecorator","argCheckFunc","editorPropName","staticValue","decoratedValue","createDummyDecorator","executeInEditMode","disallowMultiple","playOnFocus","icon","property","ctorProtoOrOptions","normalized","ctorProto","isInteger","reverseKey","enumType","enumDef","__enums__","enums","_didAccelerateFun","timestamp","_accelEnabled","_registerAccelerometerEvent","_accelCurTime","_unregisterAccelerometerEvent","_accelInterval","_registerKeyboardEvent","preventDefault","_acceleration","_accelDeviceEvent","DeviceOrientationEvent","BROWSER_TYPE_MOBILE_QQ","_deviceEventType","ua","_minus","didAccelerate","mAcceleration","eventAcceleration","_accelMinus","tmpX","orientation","OS_ANDROID","TOUCH_TIMEOUT","_vec2","_mousePressed","_isRegisterEvent","_preTouchPoint","_prevMousePoint","_preTouchPool","_preTouchPoolPointer","_touchesIntegerDict","_indexBitsUsed","_maxTouches","_canvasBoundingRect","adjustedLeft","adjustedTop","_getUnUsedIndex","_removeUsedIndexBit","_glView","_updateCanvasBoundingRect","canvasBoundingRect","docElem","handleTouchesBegin","curTouch","touchID","handleTouches","locTouchIntDict","unusedIndex","_convertTouchesWithScale","handleTouchesMove","locTouches","handleTouchesEnd","getSetOfTouchesEndOrCancel","handleTouchesCancel","locTouchesIntDict","getPreTouch","preTouch","locPreTouchPool","setPreTouch","getTouchByXY","tx","ty","locPreTouch","convertToLocationInView","getMouseEvent","locPreMouse","_convertMouseToLocationInView","getPointByEvent","BROWSER_TYPE_QQ","pageX","pageY","scrollLeft","clientX","clientY","getTouchesByEvent","touch_event","preLocation","locView","changedTouches","BROWSER_TYPE_FIREFOX","identifier","selfPointer","prohibition","supportMouse","supportTouches","_mouseEventsOnElement","focus","wheelDelta","msPointerEnabled","_pointerEventsMap","MSPointerDown","MSPointerMove","MSPointerUp","MSPointerCancel","_touchEventsMap","touchstart","touchesToHandle","touchmove","touchend","touchcancel","registerTouchEvent","_eventName","DEG","ONE","SRC_ALPHA","SRC_ALPHA_SATURATE","SRC_COLOR","DST_ALPHA","DST_COLOR","ONE_MINUS_SRC_ALPHA","ONE_MINUS_SRC_COLOR","ONE_MINUS_DST_ALPHA","ONE_MINUS_DST_COLOR","ONE_MINUS_CONSTANT_ALPHA","ONE_MINUS_CONSTANT_COLOR","ORIENTATION_PORTRAIT","ORIENTATION_LANDSCAPE","ORIENTATION_AUTO","DENSITYDPI_DEVICE","DENSITYDPI_HIGH","DENSITYDPI_MEDIUM","DENSITYDPI_LOW","FIX_ARTIFACTS_BY_STRECHING_TEXEL_TMX","DIRECTOR_STATS_POSITION","BATCH_VERTEX_COUNT","ENABLE_TILEDMAP_CULLING","ENABLE_CULLING","SHOW_MESH_WIREFRAME","SHOW_MESH_NORMAL","KEY","none","back","backspace","tab","enter","ctrl","alt","capslock","escape","space","pageup","pagedown","home","right","down","select","insert","Delete","0","2","3","4","5","6","7","8","9","f","o","num0","num1","num2","num3","num4","num5","num6","num7","num8","num9","*","+","-","numdel","/","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","numlock","scrolllock",";","semicolon","equal","=",",","comma","dash",".","forwardslash","grave","[","openbracket","backslash","]","closebracket","quote","dpadLeft","dpadRight","dpadUp","dpadDown","dpadCenter","ImageFormat","JPG","PNG","TIFF","WEBP","PVR","ETC","S3TC","ATITC","TGA","RAWDATA","BlendFactor","CENTER","RIGHT","BOTTOM","Destroyed","DontSave","EditorOnly","Dirty","DontDestroy","PersistentMask","LockedInEditor","IsPositionLocked","IsRotationLocked","IsScaleLocked","IsAnchorLocked","IsSizeLocked","objectsToDestroy","deferredDestroy","deleteCount","compileDestruct","shouldSkipId","idToSkip","propsToReset","_destruct","__destruct__","strictMode","SAXParser","DOMParser","_isSupportDOMParser","_parser","xmlTxt","_parseXML","textxml","xmlDoc","parseFromString","loadXML","PlistParser","childNodes","nodeType","_parseNode","_parseDict","_parseArray","firstChild","nodeValue","saxParser","screen","_supportsFullScreen","_onfullscreenchange","_onfullscreenerror","_preOnFullScreenChange","_preOnFullScreenError","_preOnTouch","_touchEvent","_fn","_fnMap","valL","requestFullscreen","fullScreen","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","requestFullScreen","onFullScreenChange","onFullScreenError","isBrowser","webkitEnterFullscreen","fullscreenchange","fullscreenerror","exitFullScreen","webkitExitFullscreen","exitFullscreen","autoFullScreen","_ensureFullScreen","disableAutoFullScreen","touchTarget","fullScreenErrorEventName","_CCSettings","_global","global","LANGUAGE_ENGLISH","LANGUAGE_CHINESE","LANGUAGE_FRENCH","LANGUAGE_ITALIAN","LANGUAGE_GERMAN","LANGUAGE_SPANISH","LANGUAGE_DUTCH","LANGUAGE_RUSSIAN","LANGUAGE_KOREAN","LANGUAGE_JAPANESE","LANGUAGE_HUNGARIAN","LANGUAGE_PORTUGUESE","LANGUAGE_ARABIC","LANGUAGE_NORWEGIAN","LANGUAGE_POLISH","LANGUAGE_TURKISH","LANGUAGE_UKRAINIAN","LANGUAGE_ROMANIAN","LANGUAGE_BULGARIAN","LANGUAGE_UNKNOWN","OS_WINDOWS","OS_MARMALADE","OS_LINUX","OS_BADA","OS_BLACKBERRY","OS_OSX","OS_WP8","OS_WINRT","OS_UNKNOWN","WIN32","LINUX","MACOS","ANDROID","IPHONE","IPAD","BLACKBERRY","NACL","EMSCRIPTEN","TIZEN","WINRT","WP8","MOBILE_BROWSER","DESKTOP_BROWSER","EDITOR_PAGE","EDITOR_CORE","WECHAT_GAME","QQ_PLAY","BAIDU_GAME","VIVO_GAME","OPPO_GAME","HUAWEI_GAME","XIAOMI_GAME","JKW_GAME","ALIPAY_GAME","WECHAT_GAME_SUB","BAIDU_GAME_SUB","QTT_GAME","BROWSER_TYPE_WECHAT","BROWSER_TYPE_WECHAT_GAME","BROWSER_TYPE_WECHAT_GAME_SUB","BROWSER_TYPE_BAIDU_GAME","BROWSER_TYPE_BAIDU_GAME_SUB","BROWSER_TYPE_XIAOMI_GAME","BROWSER_TYPE_ALIPAY_GAME","BROWSER_TYPE_QQ_PLAY","BROWSER_TYPE_ANDROID","BROWSER_TYPE_IE","BROWSER_TYPE_UCBS","BROWSER_TYPE_360","BROWSER_TYPE_BAIDU_APP","BROWSER_TYPE_MAXTHON","BROWSER_TYPE_OPERA","BROWSER_TYPE_OUPENG","BROWSER_TYPE_MIUI","BROWSER_TYPE_CHROME","BROWSER_TYPE_LIEBAO","BROWSER_TYPE_QZONE","BROWSER_TYPE_SOUGOU","BROWSER_TYPE_UNKNOWN","isNative","glExtension","getMaxJointMatrixSize","_maxJointMatrixSize","gl","maxUniforms","getParameter","MAX_VERTEX_UNIFORM_VECTORS","__globalAdapter","adaptSys","nav","doc","docEle","FbPlayableAd","currLanguage","language","browserLanguage","languageCode","isAndroid","iOS","osVersion","osMainVersion","uaResult","maxTouchPoints","osName","appVersion","OS_UNIX","browserTypes","typeMap","micromessenger","trident","edge","360 aphone","mxbrowser","opr/","ubrowser","browserVersion","innerWidth","innerHeight","devicePixelRatio","windowPixelResolution","_checkWebGLRenderMode","_tmpCanvas1","localStorage","setItem","_supportWebp","toDataURL","_supportCanvas","_supportWebGL","WebGLRenderingContext","opengl","supportWebAudio","AudioContext","webkitAudioContext","mozAudioContext","ONLY_ONE","DELAY_CREATE_CTX","ONE_SOURCE","canPlayType","NetworkType","LAN","WWAN","getNetworkType","getBatteryLevel","garbageCollect","restartVM","getSafeAreaRect","visibleSize","getVisibleSize","isObjectValid","dump","openURL","initSys","__BrowserGetter","html","getElementsByTagName","availWidth","availHeight","meta","adaptationType","_scissorRect","View","_strategyer","ContainerStrategy","_strategy","ContentStrategy","_frameSize","_originalDesignResolutionSize","_visibleRect","_autoFullScreen","_maxPixelRatio","_retinaEnabled","_resizeCallback","_resizing","_resizeWithBrowserSize","_orientationChanging","_orientation","_isAdjustViewport","_antiAliasEnabled","_resolutionPolicy","_rpExactFit","EQUAL_TO_FRAME","EXACT_FIT","_rpShowAll","_rpNoBorder","_rpFixedHeight","_rpFixedWidth","_initFrameSize","_resizeEvent","forceOrEvent","prevFrameW","prevFrameH","prevRotated","containerStyle","display","_orientationChange","resizeWithBrowserSize","setResizeCallback","setOrientation","designWidth","designHeight","locFrameSize","isLandscape","transformOrigin","_setViewportMeta","metas","overwrite","vp","getElementById","head","pattern","elems","getElementsByName","currentVP","RegExp","_adjustViewportMeta","adjustViewportMeta","enableRetina","isRetinaEnabled","enableAntiAlias","imageSmoothingEnabled","mozImageSmoothingEnabled","isAntiAliasEnabled","enableAutoFullScreen","isAutoFullScreenEnabled","setCanvasSize","getCanvasSize","getFrameSize","setFrameSize","getVisibleSizeInPixel","getVisibleOrigin","getVisibleOriginInPixel","getResolutionPolicy","setResolutionPolicy","resolutionPolicy","_locPolicy","preApply","viewport","vb","rv","postApply","updateCameraViewport","getDesignResolutionSize","setRealPixelResolution","setViewportInPoints","locScaleX","locScaleY","setScissorInPoints","ceil","sw","sh","boxArr","SCISSOR_BOX","scissor","isScissorEnabled","SCISSOR_TEST","getScissorRect","scaleXFactor","scaleYFactor","getViewportRect","getScaleX","getScaleY","getDevicePixelRatio","relatedPos","posLeft","posTop","in_out_point","selPoint","selPrePoint","designedResolution","_setupContainer","locCanvas","_setupStyle","locContainer","_fixContainer","bs","contStyle","_result","_buildResult","containerW","containerH","contentW","contentH","EqualToFrame","frameH","ProportionalToFrame","frameW","designW","designH","offx","offy","OriginalContainer","globalAdapter","adaptContainerStrategy","adaptView","PROPORTION_TO_FRAME","ORIGINAL_CONTAINER","ExactFit","ShowAll","NoBorder","FixedHeight","FixedWidth","containerStg","contentStg","_containerStrategy","_contentStrategy","setContainerStrategy","setContentStrategy","topLeft","topRight","bottomLeft","bottomRight","bottom","createAttrsSingle","superAttrs","createAttrs","subclass","superClass","chains","__attrs__","newAttrs","prefix","PrimitiveType","getTypeChecker_ET","getObjTypeChecker_ET","CallbackInfo","callbackInfoPool","CallbackList","removeByCallback","removeByTarget","cancelAll","callbackListPool","keyOrTarget","_list","deepFlatten","strList","flattenCodeArray","_Deserializer","ignoreEditorOnly","deserializedList","deserializedData","_classFinder","_idList","_idObjList","_idPropList","_dereference","idPropList","idList","idObjList","onDereferenced","compileObjectTypeJit","sources","accessorToSet","propNameLiteralToSet","assumeHavePropIfIsValue","ctorCode","jsonObj","jsonArray","refCount","_deserializeObject","serialized","_deserializeFireClass","_deserializeTypedObject","_deserializeObjField","_deserializePrimitiveObject","__id__","__uuid__","dObj","DEFAULT","fastDefinedProps","compileDeserialize","TYPE","SAVE_URL_AS_ASSET","FORMERLY_SERIALIZED_AS","accessorToGet","propNameToRead","isPrimitiveType","userType","defaultType","__deserialize__","details","createAssetRefs","tempDetails","deserializer","assignAssetsBy","Editor","asAsset","NonUuidMark","IdGenerater","category","Compiler","VAR","LOCAL_OBJ","LOCAL_TEMP_OBJ","DEFAULT_MODULE_CACHE","cc.Node","cc.Label","cc.Button","cc.Widget","cc.Animation","cc.ClickEvent","cc.PrefabInfo","Float64Array","Int8Array","Int16Array","Uint16Array","Uint32Array","getTypedArrayName","Declaration","varName","mergeDeclaration","writeAssignment","codeArray","Assignments","targetExpression","_exps","_targetExp","equalsToDefault","getPropAccessor","Parser","globalVariablesDeclaration","objsToClear_iN$t","objs","funcs","funcModuleCache","globalVariables","globalVariableId","localVariableId","getFuncModule","globalVar","enumerateObject","code","_iN$t","writeCode","targetVar","pair","usedInNew","clsNameIsModule","getObjRef","setValueType","srcValue","assignments","enumerateField","enumerateCCClass","setObjProp","instantiateArray","arrayVar","source","instantiateTypedArray","line","isView","instantiateObj","createCode","isChildOf","CCValueType","_isDomNode","isDomNode","original","internal_force","doInstantiate","objsToClearTmpVar","initValue","tempCIDGenerater","_getPropertyDescriptor","getPrototypeOf","_copyprop","dunderProto","superclass","tmpValueDesc","tmpGetSetDesc","tmpGetDesc","tmpSetDesc","objOrCtor","__classname__","retval","charAt","_idToClass","_nameToClass","setup","publicName","table","doSetClassName","unregisterClass","classId","__cid__","classname","allowTempId","obsoleted","newExpr","extractPropName","oldProp","newProp","obsoletes","objName","REGEXP_NUM_OR_STR","REGEXP_STR","argLen","regExpToTest","forceDictMode","cleanupFunc","_cleanup","verifyType","removeArray","minusArr","appendObjectsAt","addObjs","arr_clone","resize","Attrs","SerializableAttrs","canUsedInGet","parseNotify","newKey","newValue","checkUrl","parseType","isRawAssetType","propname_dev","classname_dev","_short","fullForm","requiringFrames","beh","frameInfo","anyKey","_rawAssets","refNode","otherNode","compareDocumentPosition","nodeName","_manager","Assembler2D","_Assembler","_assertThisInitialized","initData","initLocal","createQuadData","verticesFloats","indicesCount","_local","uintVerts","uintVDatas","floatsPerVert","colorOffset","getBuffer","_handle","_meshBuffer","updateWorldVerts","local","verts","vDatas","matrixm","vl","vr","vt","al","ar","bl","br","ct","db","fillBuffers","worldMatDirty","renderData","vData","iData","iDatas","offsetInfo","verticesCount","vertexOffset","byteOffset","vbuf","_vData","ibuf","_iData","indiceOffset","vertexId","packToDynamicAtlas","packedFrame","insertSpriteFrame","uvOffset","_pool3","_assemblerId","getAssemblerId","assemblerCtor","__assemblerId__","_renderComp","_vertexFormat","_assemblerPool","_extendNative","renderComp","getVfmt","vfmtPosUvColor","renderCompCtor","__assembler__","getConstructor","Device","canvasEL","_canvas","_caps","_stats","drawcalls","_vx","_vy","_vw","_vh","_sx","_sy","_sw","_sh","_restoreTexture","unit","setViewport","setScissor","clearRect","fillStyle","globalAlpha","resetDrawCalls","getDrawCalls","_device","_width","updateImage","_inputAssembler","_initBuiltins","defaultTexture","WRAP_REPEAT","mipmap","programTemplates","programChunks","InputAssembler","Pass","renderEngine","drawCalls","_cameraNode","_flow","ModelBatcher","ForwardRenderer","canvasRenderer","RenderComponentHandle","ecScene","_batcher","FlagOfset","DONOTHING","BREAK_FLOW","LOCAL_TRANSFORM","WORLD_TRANSFORM","TRANSFORM","UPDATE_RENDER_DATA","OPACITY","OPACITY_COLOR","RENDER","POST_RENDER","FINAL","_func","_next","_proto","_doNothing","_localTransform","_worldTransform","parentOpacityDirty","_updateRenderData","_render","batcher","parentOpacity","worldDirtyFlag","colorVal","_fastSetA","flows","_postRender","postFillBuffers","EMPTY_FLOW","createFlow","getFlow","tFlag","_validateList","_inValidateList","validateRenderers","visitRootNode","rootNode","walking","terminate","_renderScene","forwardRenderer","getBachther","FLAG_DONOTHING","FLAG_BREAK_FLOW","FLAG_LOCAL_TRANSFORM","FLAG_OPACITY","FLAG_FINAL","_assembler2d","shareLabelInfo","LetterInfo","_tmpRect","_comp","_horizontalKernings","_lettersInfo","_linesWidth","_linesOffsetX","_numberOfLines","_textDesiredHeight","_letterOffsetY","_tailoredTopY","_tailoredBottomY","_bmfontScale","_originFontSize","_hAlign","_vAlign","_overflow","_isWrapText","_labelWidth","_labelHeight","_maxLineWidth","BmfontAssembler","_reserveQuads","_updateFontFamily","_updateProperties","_updateLabelInfo","_updateContent","_resetProperties","_updateFontScale","fontAsset","fontAtlas","_setupBMFontOverflowMetrics","_computeHorizontalKerningForText","_alignText","stringLen","kerningDict","horizontalKernings","kerningAmount","_multilineTextWrap","nextTokenFunc","textLen","lineIndex","nextTokenX","nextTokenY","longestLine","letterRight","highestY","lowestY","letterDef","letterPosition","character","tokenLen","tokenHighestY","tokenLowestY","tokenRight","nextLetterX","newLine","letterIndex","letterX","isUnicodeSpace","_getFontScale","_recordLetterInfo","_recordPlaceholderInfo","atlasName","_getFirstCharLen","_getFirstWordLen","startIndex","isUnicodeCJK","_multilineTextWrapByWord","_multilineTextWrapByChar","tmpInfo","_computeAlignmentOffset","_isVerticalClamp","_shrinkLabelToContentSize","_updateQuads","_isHorizontalClamp","_scaleFontSizeDown","shouldUpdateContent","lambda","mid","letterClamp","ctr","letterInfo","_isHorizontalClamped","wordWidth","letterOverClamp","dataLength","appx","appy","clipTop","_determineRect","letterPositionX","appendQuad","_quadsUpdated","tempRect","trimmedLeft","trimmedTop","originalX","blank","_bmfont","LabelOutline","RenderTexture","OUTLINE_SUPPORTED","getFontFamily","_invisibleAlpha","LetterTexture","labelInfo","_labelInfo","_offsetY","LetterAtlas","initWithSize","_nexty","beforeSceneLoad","computeHash","toHEX","isOutlined","_updateTexture","_canvasPool","BASELINE_RATIO","startX","startY","MIDDLE_RATIO","textAlign","textBaseline","strokeStyle","strokeText","fillText","insertLetterTexture","letterTexture","drawTextureAt","bleed","chars","_char2","_char3","LetterFontAssembler","outline","_getFontDesc","_sharedLabelData","LabelShadow","deleteFromDynamicAtlas","_fontDesc","_drawFontSize","_splitedStrings","_canvasSize","_outlineComp","_outlineColor","_shadowComp","_shadowColor","_canvasPadding","_contentSizeExtend","_nodeContentSize","_enableItalic","_underlineThickness","_drawUnderlinePos","_drawUnderlineWidth","TTFAssembler","assemblerData","_Assembler2D","_calculateLabelFont","_calculateSplitedStrings","_updateLabelDimensions","_calculateTextBaseline","_calDynamicAtlas","updateVerts","_updatePaddingRect","outlineWidth","shadowWidth","blur","_calculateFillTextStartPosition","labelX","drawStartY","_getLineHeight","firstLinelabelY","_setupOutline","_setupShadow","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","_drawUnderline","underlinewidth","strokeRect","startPosition","isMultiple","measureText","_measureText","drawTextPosX","drawTextPosY","paragraphedStrings","rawHeight","canvasSizeX","canvasSizeY","paraLength","rawWidth","_rawHeight","hAlign","canvasWidthNoMargin","allWidth","textFragment","fragmentText","nodeSpacingY","_calculateParagraphLength","paragraphLength","totalHeight","maxLength","canvasHeightNoMargin","vAlign","deleteAtlasSpriteFrame","earcut","holeIndices","dim","minX","minY","hasHoles","outerLen","outerNode","linkedList","triangles","eliminateHoles","earcutLinked","clockwise","signedArea","insertNode","removeNode","filterPoints","again","steiner","area","ear","indexCurve","isEarHashed","isEar","cureLocalIntersections","splitEarcut","pointInTriangle","minTX","minTY","maxTX","maxTY","minZ","zOrder","maxZ","nextZ","prevZ","intersects","locallyInside","isValidDiagonal","splitPolygon","getLeftmost","compareX","eliminateHole","hole","findHoleBridge","hx","hy","qx","mx","my","tanMin","sortLinked","tail","numMerges","pSize","qSize","inSize","leftmost","ax","ay","bx","intersectsPolygon","middleInside","q1","inside","a2","an","bp","deviation","polygonArea","trianglesArea","flatten","holes","dimensions","holeIndex","Point","dmx","dmy","Path","Impl","_distTol","_updatePathOffset","_paths","_pathLength","_pathOffset","_pointsOffset","_commandx","_commandy","closed","nbevel","complex","_addPath","_curPath","pt","pathPoints","MeshBuffer","vfmtPosColor","Earcut","atan2","curveDivs","tol","clamp","GraphicsAssembler","_buffers","_bufferOffset","requestBuffer","indiceStart","vertexStart","meshbuffer","ia","_vb","_ib","getBuffers","buffers","_flushIA","uploadData","genBuffer","cverts","maxVertsCount","MAX_VERTEX","requestStatic","_curColor","_flattenPaths","_expandStroke","_expandFill","impl","ncap","_calculateJoins","pointsLength","_l2","_path","pts","_pointsLength","dPos","normalizeSelf","_buttCapStart","_roundCapStart","_roundJoin","_bevelJoin","_vset","vDataoOfset","_dPos","_dx","_dy","_buttCapEnd","_roundCapEnd","indicesOffset","_start","_end","_l3","_path2","_pointsLength2","earcutData","vDataOffset","newIndices","_j2","nIndices","first","_end2","iw","ptsLength","dmr2","dlx0","dly0","dlx1","dly1","nleft","_chooseBevel","bevel","dlx","dly","lw","rw","p1x","lx0","ly0","lx1","ly1","a0","a1","_out","rx0","ry0","rx1","ry1","_a2","_n","_a3","lx","ly","_out2","uintVData","_uintVData","assemblers","_dataOffset","WebglBmfontAssembler","createFlexData","flexBuffer","_flexBuffer","reserve","used","vid","_getColor","rectWidth","rectHeight","uvDataOffset","appendVerts","world","WebglLetterFontAssembler","createData","requestRenderData","_LetterFontAssembler","_ttf","WebglTTFAssembler","updateUVs","srcOffset","dstOffset","_TTFAssembler","canvasWidth","canvasHeight","shadow","shadowOffset","_CCLabel","_letter","_ttf2","_bmfont2","_letter2","label","TTF","Bmfont","Letter","TTF3D","Bmfont3D","Letter3D","SimpleSpriteAssembler","vfmtPos","_maxLevel","_maskStack","getWriteMask","getStencilRef","applyStencil","failOp","writeMask","zFailOp","zPassOp","STENCIL_ENABLE","pushMask","exitMask","_flushMaterial","enableMask","applyClearMask","DS_FUNC_NEVER","STENCIL_OP_REPLACE","STENCIL_OP_ZERO","applyAreaMask","DS_FUNC_EQUAL","MaskAssembler","dir","setPoint","setDir","_normal","MotionStreakAssembler","cur","matrix","difx","dify","cr","cg","ca","findLast","_this$_renderData$_fl","usedVertices","usedIndices","usedVerticesFloats","BarFilledAssembler","fillEnd","ul","quadUV0","quadUV1","quadUV2","quadUV3","quadUV4","quadUV5","quadUV6","quadUV7","textureRect","progressEnd","MeshSpriteAssembler","updateIndices","contentWidth","contentHeight","originalWidth","originalHeight","trimX","trimY","PI_2","_vertPos","_vertices","_uvs","_intersectPoint_1","_intersectPoint_2","_center","_triangles","_calcInsectedPoints","intersectPoints","tanAngle","cotAngle","sinAngle","cosAngle","yleft","yright","xtop","xbottom","_calculateVertices","_calculateUVs","u0","v0","v1","_getVertAngle","placementX","placementY","RadialFilledAssembler","floatsPerTriangle","triangleIndex","triangle","_generateTriangle","testIndex","allocWorldVerts","vert0","vert1","vert2","v0x","v0y","v1x","v1y","progressX","progressY","_generateUV","px1","px2","py1","py2","cw","ch","ow","oh","rh","trimRight","SlicedAssembler","meshCount","indexOffset","sizableWidth","sizableHeight","xScale","yScale","voffset","localRowY","localColX","worldIndex","TiledAssembler","hRepeat","vRepeat","_updateIndices","_this$_local","localX","localY","yindex","ylength","xindex","xlength","coefv","coefu","_CCSprite","_simple","_sliced","_tiled","_radialFilled","_barFilled","_mesh","_simple2","_sliced2","_tiled2","_radialFilled2","_barFilled2","_mesh2","Simple","Sliced","Tiled","RadialFilled","BarFilled","Mesh","Simple3D","Sliced3D","Tiled3D","RadialFilled3D","BarFilled3D","Mesh3D","FlexBuffer","vfmt","_handler","_index","_vfmt","_verticesBytes","_bytes","_initVerticesCount","_initIndicesCount","_reallocVData","floatsCount","oldData","updateMesh","_reallocIData","newFloatsCount","realloced","newIndicesCount","updateMeshRange","vertexFormat","_vertexBytes","_arrOffset","_vbArr","VertexBuffer","USAGE_DYNAMIC","_ibArr","IndexBuffer","INDEX_FMT_UINT16","USAGE_STATIC","_initVDataCount","_initIDataCount","_offsetInfo","_reallocBuffer","vertexsData","indicesData","switchBuffer","checkAndSwitchBuffer","vertexCount","indiceCount","byteLength","indiceLength","_updateOffset","copyOldData","oldVData","newData","oldIData","forwardIndiceStartToOffset","_recyclePool","_model","vfmt3D","QuadBuffer","SpineBuffer","empty_material","empty_ia","renderScene","_iaPool","_modelPool","_quadBuffer","_quadBuffer3D","_meshBuffer3D","_batchedModels","_sortKey","models","setInputAssembler","setEffect","removeModel","model","sortKey","addModel","_vertexBuffer","_indexBuffer","vertextFormat","_fillQuadBuffer","vertextID","RenderData","_infos","initQuadIndices","adjust","VertexFormat","ATTR_POSITION","ATTR_TYPE_FLOAT32","ATTR_UV0","ATTR_COLOR","ATTR_TYPE_UINT8","XYZ_UV_Color","XY_UV_Color","vfmtPosUvTwoColor","ATTR_COLOR0","XY_UV_Two_Color","vfmtPosUv","XY_UV","XY_Color","XY","EXTNAME_RE","DIRNAME_RE","NORMALIZE_RE","pathStr","mainFileName","fileName","basename","baseName","changeExtname","tempStr","changeBasename","isSameExt","_normalize","oldUrl","sep","AffineTransform","determinant","matm","transformVec2","transOrY","transformSize","transformRect","ol","ob","or","ot","lbx","lby","rbx","rby","ltx","lty","rtx","rty","transformObb","out_bl","out_tl","out_tr","out_br","anAffineTransform","xa","findComponent","findComponents","_comp2","findChildComponent","findChildComponents","_onSetParent","getChildByName","siblingIndex","siblings","oldIndex","walk","prefunc","postfunc","afterChildren","_stacks","_stackId","removeAllChildren","_checkMultipleComp","_RFpeek","ReqComp","_addComponentAt","removeComponent","_getDependComponent","destroyAllChildren","newParent","shouldActiveNow","thisPrefabInfo","_registerIfAttached","destroyByParent","childIndex","propertyDefine","EPSILON","_srcBlendFactor","_dstBlendFactor","srcBlendFactor","_updateBlendFunc","dstBlendFactor","_updateMaterialBlendFunc","Base64Values","BASE64_VALUES","HexChars","UuidTemplate","Indices","isFinite","base64","lhs","rhs","referenceNode","nameList","subChild","_normalMaterial","normalMaterial","_grayMaterial","grayMaterial","sameNameGetSets","diffNameGetSets","np","getterFunc","suffix","NextPOT","min_inclusive","max_inclusive","degreesToRadians","radiansToDegrees","_PrefabInfo","fileId","eulerAnglesX","eulerAnglesY","eulerAnglesZ","_globalZOrder","PerfCounter","_showFPS","_rootNode","_label","generateStats","average","below","draws","logic","_counter","generateNode","leftLabel","rightLabel","beforeUpdate","afterUpdate","afterDraw","stat","human","Counter","_value","_averageValue","_accumValue","_accumSamples","_accumStart","_average","alarm","over","tick","_BASELINE_RATIO","LRUCache","moveToHead","discard","measureCache","label_wordRex","label_symbolRex","label_lastWordRex","label_lastEnglish","label_firstEnglish","label_firstEmoji","label_lastEmoji","label_wrapinspection","__CHINESE_REG","__JAPANESE_REG","__KOREAN_REG","metric","stringToken","maxWidth","wrappedWords","fuzzyLen","tmpText","sLine","pushNum","checkWhile","sText","cacheImage","NodeUnit","MemPool","unitClass","_unitClass","_findOrder","_initNative","_nativeMemPool","_buildUnit","unitID","_destroyUnit","_findUnitID","findUnit","findOrder","hasSpace","firstUnit","isAllFree","Super","TRS_Stride","FLOAT_BYTES","LocalMatrix_Stride","WorldMatrix_Stride","UnitBase","memPool","contentNum","_contentNum","trsList","FLOAT_ARRAY_TYPE","localMatList","worldMatList","_spacesData","_memPool","_signData","signIndex","UnitBaseProto","headFreeIndex","spaceNum","freeStr","usingNum","usingStr","totalNum","_valueType","_CCClass","_misc","_ValueType","fromHex","hex","subtract","multiply","divide","ag","toArray","ofs","fromArray","getR","setR","getG","setG","getB","setB","getA","setA","toCSS","opt","fromHEX","hexString","fmt","toRGBValue","fromHSV","toHSV","hsv","WHITE_R","BLACK_R","TRANSPARENT_R","GRAY_R","RED_R","RED","GREEN_R","GREEN","BLUE_R","BLUE","YELLOW_R","YELLOW","ORANGE_R","ORANGE","CYAN_R","CYAN","MAGENTA_R","MAGENTA","_vec3","_mat2","_size","_quat","_exportNames","math","Mat3","m00","m01","m02","m03","m04","m05","m06","m07","m08","m10","m11","m20","m21","m22","transpose","a01","a02","a12","a00","a10","a11","a20","a21","a22","b01","b11","b21","det","adjoint","b00","b02","b10","b12","b20","b22","multiplyMat4","translate","rotate","rad","fromTranslation","fromScaling","fromQuat","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","default_up","lengthSqr","cross","_fromViewUpIIFE","normalFromMat4","a03","a13","a23","a30","a31","a32","a33","b03","b04","b05","b06","b07","b08","b09","frob","multiplyScalar","multiplyScalarAndAdd","exactEquals","a4","a5","a6","a7","a8","b0","b5","b6","b7","b8","IDENTITY","_a00","_a01","_a02","_a03","_a10","_a11","_a12","_a13","_a20","_a21","_a22","_a23","_a30","_a31","_a32","_a33","m23","m30","m31","m32","m33","mulScalar","axis","rotateX","rotateY","rotateZ","fromXRotation","fromYRotation","fromZRotation","xy","xz","yz","getTranslation","getScaling","m3","m3_1","m09","trace","S","toRTS","v3_1","fromMat3","fromRTS","sz","fromRTSOrigin","ox","oy","oz","frustum","near","far","rl","tb","nf","perspective","fovy","aspect","lr","bt","eye","eyex","eyey","eyez","upx","upy","upz","z0","z1","inverseTranspose","strictEquals","epsilon","sm","number","m14","m15","_z","_w","rotationTo","dot","fromAxisAngle","getAxisAngle","outAxis","scaleAndAdd","bw","bz","rotateAround","rot","qt_1","rotateAroundLocal","calculateW","slerp","scale0","scale1","cosom","omega","sinom","sqlerp","qt_2","invDot","fromAxes","xAxis","yAxis","zAxis","halfToRad","_s","_s2","_s3","cz","toAxisX","fy","fz","toAxisY","fx","toAxisZ","outerZ","bank","heading","attitude","toDegree","sqx","sqy","sqz","euler","fromMinMax","min_x","min_y","maxax","maxay","maxbx","maxby","intersection","rectB","axMin","ayMin","axMax","ayMax","bxMin","byMin","bxMax","byMax","containsRect","aw","ah","bh","ZERO_R","tmp_quat","maxDiff","_d2r","_r2d","randomRange","seed","pseudoRandomRange","INT_BITS","pseudoRandom","_js","magSqr","subSelf","mulSelf","divSelf","scaleSelf","negSelf","negate","neg","squaredDistance","inverse","transformMat3","v2_1","v2_2","cosine","variance","addSelf","invsqrt","magSqr1","magSqr2","theta","signAngle","radians","rotateSelf","project","maxAxis","squaredMagnitude","ONE_R","UP_R","RIGHT_R","zero","az","cosTheta","sinTheta","rhw","transformMat4Normal","transformAffine","ix","iy","iz","transformRTS","transformInverseRTS","rz","v3_2","projectOnPlane","sqrLen","vec1","vec2","FRONT_R","FRONT","Vec4","equals4f","strictEquals4f","minInclusive","maxInclusive","v4","NEG_ONE_R","NEG_ONE","CCSpriteFrame","WebGLEXT","GFXObjectType","GFXStatus","GFXAttributeName","GFXType","GFXFormat","GFXBufferUsageBit","GFXMemoryUsageBit","GFXBufferAccessBit","GFXPrimitiveMode","GFXPolygonMode","GFXShadeModel","GFXCullMode","GFXComparisonFunc","GFXStencilOp","GFXBlendOp","GFXBlendFactor","GFXColorMask","GFXFilter","GFXAddress","GFXTextureType","GFXTextureUsageBit","GFXSampleCount","GFXTextureFlagBit","GFXTextureViewType","GFXShaderType","GFXBindingType","GFXCommandBufferType","GFXLoadOp","GFXStoreOp","GFXTextureLayout","GFXPipelineBindPoint","GFXDynamicState","GFXStencilFace","GFXQueueType","GFXClearFlag","RenderPassStage","RenderPriority","GFXObject","gfxType","_gfxType","_status","UNREADY","UniformBinding","SamplerInfoIndex","MAX_BINDING_SUPPORTED","BOOL","INT","INT2","INT3","INT4","FLOAT","FLOAT2","FLOAT3","FLOAT4","MAT2","MAT3","MAT4","SAMPLER2D","SAMPLER_CUBE","sizeMap","formatMap","R32I","RG32I","RGB32I","RGBA32I","R32F","RG32F","RGB32F","passParams","BACK","ADD","SUB","REV_SUB","CONSTANT_COLOR","CONSTANT_ALPHA","NEVER","LESS","EQUAL","LEQUAL","GREATER","NOTEQUAL","GEQUAL","ALWAYS","KEEP","REPLACE","INCR","INCR_WRAP","DECR","DECR_WRAP","INVERT","mappings","murmurhash2_32_gc","effectStructure","$techniques","$passes","any","sampler","RenderQueue","OVERLAY","GFXGetTypeSize","UINT","BOOL2","UINT2","BOOL3","UINT3","BOOL4","UINT4","MAT2X3","MAT2X4","MAT3X2","MAT3X4","MAT4X2","SAMPLER1D","SAMPLER1D_ARRAY","SAMPLER2D_ARRAY","SAMPLER3D","_memop","_m4_tmp","_stageInfos","RecyclePool","_float2_pool","_float3_pool","_float4_pool","_float9_pool","_float16_pool","_float64_pool","_int2_pool","_int3_pool","_int4_pool","_int64_pool","Base","_this$_type2defaultVa","_type2defaultValue","PARAM_INT2","PARAM_INT3","PARAM_INT4","PARAM_FLOAT2","PARAM_FLOAT3","PARAM_FLOAT4","PARAM_COLOR4","PARAM_MAT3","PARAM_MAT4","defaultTextureCube","_stage2fn","_usedTextureUnits","_viewPools","_drawItemsPools","_stageItemsPools","_resetTextuerUnit","_allocTextureUnit","maxTextureUnits","_registerStage","fn","_requestView","clearOpts","CLEAR_COLOR","CLEAR_DEPTH","CLEAR_STENCIL","_stencil","_models","drawItem","extractDrawItem","_stages","stageItems","_drawItem","stageItem","stageInfo","_setProperty","slots","setTextureArray","setUniformDirectly","setUniform","_draw","programLib","setVertexBuffer","setIndexBuffer","setPrimitiveType","_primitiveType","getProgram","setProgram","_uniforms","variants","enableBlend","setBlendFuncSep","setBlendEqSep","setBlendColor32","enableDepthTest","setDepthFunc","enableDepthWrite","setStencilTest","setStencilFuncFront","setStencilOpFront","setStencilFuncBack","setStencilOpBack","draw","ib","PT_TRIANGLES","_detailName","setStage","setProperties","newProperties","__proto__","_shdID","_generateDefines","tmpDefines","_replaceMacroNums","reg","_unrollLoops","begin","snippet","unroll","parsedBegin","parsedEnd","_replaceHighp","ProgramLib","_templates","_checkPrecision","prog","_ref","glsl1","vert","frag","cnt","log2","_map","samplers","blocks","members","extensions","hasProgram","getKey","tmpl","tmplDefs","errPrefix","customDef","_highpSupported","Program","link","vertLines","fragLines","defineLength","originLine","fileID","highpSupported","getShaderPrecisionFormat","vertHighp","VERTEX_SHADER","HIGH_FLOAT","fragHighp","FRAGMENT_SHADER","precision","Technique","_genID","_priority","_clearModel","_matView","_matViewInv","_matProj","_matViewProj","_matInvViewProj","_cullingByID","_shadowLight","getForward","_mappings","PROJ_PERSPECTIVE","PROJ_ORTHO","LIGHT_DIRECTIONAL","LIGHT_POINT","LIGHT_SPOT","LIGHT_AMBIENT","SHADOW_NONE","SHADOW_HARD","SHADOW_SOFT","ivec2","ivec3","ivec4","vec3","vec4","PARAM_MAT2","mat2","mat3","sampler2D","samplerCube","CLEAR_SKYBOX","BUFFER_VIEW_INT8","BUFFER_VIEW_UINT8","BUFFER_VIEW_INT16","BUFFER_VIEW_UINT16","BUFFER_VIEW_INT32","BUFFER_VIEW_UINT32","BUFFER_VIEW_FLOAT32","_texture2d","_textureCube","_type2uniformCommit","_type2uniformCommit2","uniform1i","uniform1f","uniform2fv","uniform3fv","uniform4fv","uniform2iv","uniform3iv","uniform4iv","uniformMatrix2fv","uniformMatrix3fv","uniformMatrix4fv","_type2uniformArrayCommit","_type2uniformArrayCom","uniform1iv","uniform1fv","_commitBlendStates","BLEND","BLEND_CONSTANT_COLOR","BLEND_ONE_MINUS_CONSTANT_COLOR","blendSep","blendFuncSeparate","blendEquationSeparate","blendFunc","blendEquation","disable","_commitDepthStates","DEPTH_TEST","depthMask","_commitStencilStates","STENCIL_TEST","stencilSep","stencilFuncSeparate","stencilMaskSeparate","stencilOpSeparate","stencilOp","_commitCullMode","CULL_NONE","CULL_FACE","cullFace","_commitVertexBuffers","attrsDirty","maxStream","vertexBuffers","vertexBufferOffsets","maxVertexAttribs","_newAttributes","vbOffset","_glID","bindBuffer","ARRAY_BUFFER","_attributes","_enabledAttributes","enableVertexAttribArray","vertexAttribPointer","stride","disableVertexAttribArray","_commitTextures","maxTextureSlot","textureUnits","activeTexture","TEXTURE0","bindTexture","_attach","attachment","face","framebufferTexture2D","FRAMEBUFFER","TEXTURE_2D","TEXTURE_CUBE_MAP_POSITIVE_X","framebufferRenderbuffer","RENDERBUFFER","preserveDrawingBuffer","_extensions","_initExtensions","_initCaps","_initStates","initDefault","_current","vendorPrefixes","getExtension","extDrawBuffers","maxVertexStreams","maxVertexTextures","MAX_VERTEX_TEXTURE_IMAGE_UNITS","maxFragUniforms","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_TEXTURE_IMAGE_UNITS","MAX_VERTEX_ATTRIBS","maxTextureSize","MAX_TEXTURE_SIZE","maxDrawBuffers","MAX_DRAW_BUFFERS_WEBGL","maxColorAttachments","MAX_COLOR_ATTACHMENTS_WEBGL","FUNC_ADD","colorMask","POLYGON_OFFSET_FILL","depthRange","clearDepth","clearStencil","_restoreIndexBuffer","indexBuffer","ELEMENT_ARRAY_BUFFER","allowFloatTexture","fb","bindFramebuffer","numColors","_colors","colorBuffer","COLOR_ATTACHMENT0","DEPTH_ATTACHMENT","STENCIL_ATTACHMENT","_depthStencil","DEPTH_STENCIL_ATTACHMENT","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","setStencilFunc","setStencilOp","rgba","setBlendColor","setBlendFunc","dst","srcAlpha","dstAlpha","setBlendEq","eq","alphaEq","stream","slot","textures","sameType","isFloat32Array","isInt32Array","programDirty","_linked","useProgram","uniformInfo","commitFunc","drawElements","_bytesPerIndex","drawArrays","attrType","ATTR_TYPE_INT8","ATTR_TYPE_INT16","ATTR_TYPE_UINT16","ATTR_TYPE_INT32","ATTR_TYPE_UINT32","_filterGL","LINEAR_MIPMAP_LINEAR","_textureFmtGL","internalFormat","pixelType","USAGE_STREAM","INDEX_FMT_UINT8","INDEX_FMT_UINT32","ATTR_NORMAL","ATTR_TANGENT","ATTR_BITANGENT","ATTR_WEIGHTS","ATTR_JOINTS","ATTR_COLOR1","ATTR_UV","ATTR_UV1","ATTR_UV2","ATTR_UV3","ATTR_UV4","ATTR_UV5","ATTR_UV6","ATTR_UV7","ATTR_TEX_COORD","ATTR_TEX_COORD1","ATTR_TEX_COORD2","ATTR_TEX_COORD3","ATTR_TEX_COORD4","ATTR_TEX_COORD5","ATTR_TEX_COORD6","ATTR_TEX_COORD7","ATTR_TEX_COORD8","FILTER_NEAREST","FILTER_LINEAR","WRAP_CLAMP","WRAP_MIRROR","TEXTURE_FMT_RGB_DXT1","TEXTURE_FMT_RGBA_DXT1","TEXTURE_FMT_RGBA_DXT3","TEXTURE_FMT_RGBA_DXT5","TEXTURE_FMT_RGB16F","TEXTURE_FMT_RGBA16F","TEXTURE_FMT_RGB32F","TEXTURE_FMT_R32F","TEXTURE_FMT_111110F","TEXTURE_FMT_SRGB","TEXTURE_FMT_SRGBA","TEXTURE_FMT_D16","TEXTURE_FMT_D32","TEXTURE_FMT_D24S8","DS_FUNC_LEQUAL","DS_FUNC_GREATER","DS_FUNC_NOTEQUAL","DS_FUNC_GEQUAL","RB_FMT_RGBA4","RB_FMT_RGB5_A1","RB_FMT_RGB565","RB_FMT_D16","RB_FMT_S8","RB_FMT_D24S8","BLEND_FUNC_SUBTRACT","BLEND_FUNC_REVERSE_SUBTRACT","BLEND_ZERO","BLEND_ONE","BLEND_SRC_COLOR","BLEND_ONE_MINUS_SRC_COLOR","BLEND_DST_COLOR","BLEND_ONE_MINUS_DST_COLOR","BLEND_DST_ALPHA","BLEND_ONE_MINUS_DST_ALPHA","BLEND_CONSTANT_ALPHA","BLEND_ONE_MINUS_CONSTANT_ALPHA","BLEND_SRC_ALPHA_SATURATE","STENCIL_OP_INCR","STENCIL_OP_INCR_WRAP","STENCIL_OP_DECR","STENCIL_OP_DECR_WRAP","STENCIL_OP_INVERT","CULL_FRONT","CULL_FRONT_AND_BACK","PT_POINTS","PT_LINES","PT_LINE_LOOP","PT_LINE_STRIP","PT_TRIANGLE_STRIP","PT_TRIANGLE_FAN","FrameBuffer","colors","depthStencil","createFramebuffer","deleteFramebuffer","getHandle","BYTES_PER_INDEX","_BYTES_PER_INDEX","usage","_usage","_numIndices","_needExpandDataStore","createBuffer","deleteBuffer","bytes","glUsage","bufferData","bufferSubData","setUsage","TextureCube","RenderBuffer","attrTypeBytes","glFilter","glTextureFmt","_parseError","errorLog","parts","_samplers","_errors","_vertSource","_fragSource","vertShader","_createShader","fragShader","createProgram","attachShader","linkProgram","failed","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","getProgramParameter","LINK_STATUS","getProgramInfoLog","numAttributes","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","numUniforms","ACTIVE_UNIFORMS","getActiveUniform","_location","getUniformLocation","deleteProgram","shader","createShader","shaderSource","compileShader","createRenderbuffer","bindRenderbuffer","renderbufferStorage","deleteRenderbuffer","_default","cpy","_Texture","createTexture","_genMipmap","caps","textureMaxSize","isPow2","_setMipmap","hint","GENERATE_MIPMAP_HINT","NICEST","generateMipmap","_setTexInfo","updateSubImage","glFmt","_setSubImage","_setImage","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","compressedTexSubImage2D","texSubImage2D","compressedTexImage2D","texImage2D","pot","texParameteri","TEXTURE_MIN_FILTER","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","TEXTURE_MAX_ANISOTROPY_EXT","TEXTURE_CUBE_MAP","faceIndex","levelImages","_textureID","deleteTexture","_bytesPerVertex","_numVertices","getFormat","_attr2el","_elements","CircularPool","_cursor","_timsort","FixedArray","cmp","_circularPool","_fixedArray","_linkedArray","_typedArrayPool","LinkedArray","_head","_tail","alloc","_prev","free","binder","cursor","_idx","_frees","_expand","old","lo","hi","compare","TypeError","alphabeticalCompare","remaining","runLength","DEFAULT_MIN_MERGE","makeAscendingRun","binaryInsertionSort","ts","TimSort","minRun","minRunLength","pushRun","mergeRuns","forceMergeRuns","DEFAULT_MIN_GALLOPING","DEFAULT_TMP_STORAGE_LENGTH","POWERS_OF_TEN","log10","aStr","bStr","runHi","reverseRun","pivot","gallopLeft","lastOffset","maxOffset","gallopRight","minGallop","tmpStorageLength","stackLength","runStart","stackSize","mergeAt","start1","length1","start2","length2","mergeLow","mergeHigh","cursor1","cursor2","count1","count2","exit","customCursor","customDest","_bufferPools","_nextPow16","_log2","_alloc","_free","buf","alloc_int8","alloc_uint8","alloc_int16","alloc_uint16","alloc_int32","alloc_uint32","alloc_float32","alloc_float64","alloc_dataview","DataView","_baseRenderer","_a16_view","_a16_view_inv","_a16_proj","_a16_viewProj","_a4_camPos","_a64_shadow_lightViewProj","_a16_shadow_lightViewProjs","_a4_shadow_info","_camPos","_camFwd","_v3_tmp1","_BaseRenderer","_directionalLights","_pointLights","_spotLights","_shadowLights","_ambientLights","_numLights","_shadowStage","_opaqueStage","_transparentStage","_updateLights","extractView","lights","_lights","light","shadowType","_updateDefines","CC_NUM_DIR_LIGHTS","CC_NUM_POINT_LIGHTS","CC_NUM_SPOT_LIGHTS","CC_NUM_AMBIENT_LIGHTS","CC_NUM_SHADOW_LIGHTS","_submitLightsUniforms","directions","lightNum","_directionUniform","_colorUniform","positionAndRanges","_lightNum","_light","_positionUniform","_range","_positionAndRanges","_directions","_colors2","_lightNum2","_light2","_index2","_spotUniform","_colors3","_lightNum3","_light3","_index3","_submitShadowStageUniforms","shadowInfo","shadowMinDepth","shadowMaxDepth","shadowDepthScale","shadowDarkness","shadowBias","_submitOtherStagesUniforms","viewProjMatrix","infoIndex","_sortItems","_drawItems","shadowLights","_i5","_item","shadowIdx","shadowMap","_tmp_mat4","_tmp_v3","_tmp2_v3","_poolID","_projection","_near","_far","_orthoHeight","setCullingMask","getPriority","getOrthoHeight","getFov","getNear","getFar","getColor","getDepth","getStencil","getClearFlags","getStages","getFramebuffer","framebuffer","_calcMatrices","screenPointToRay","worldPos","worldMatrixToScreen","worldMatrix","halfWidth","halfHeight","Model","_viewID","_cameraID","_userKey","_castShadow","_boundingShape","setUserKey","app","_app","_views","_add","_remove","setDebugCamera","cam","getCameraCount","getCamera","getModelCount","getModel","getLightCount","getLight","addLight","removeLight","addView","removeView","getInstanceCtor","typeName","className2InspectorName","valueCtor","enums2ctor","_CCTexture2D","gfxTexture2D","ctor2default","_ctor2default","_enums2ctor","ctor2enums","_ctor2enums","PARAM_COLOR3","_enums2default","getInstanceType","TiledMapAsset","tmxXmlStr","textureNames","textureSizes","imageLayerTextures","imageLayerTextureNames","tsxFiles","tsxFileNames","TypedArray","LOG2E","Timer","_timerTable","getOwnPropertyDescriptors","descriptors","ownKeys","getOwnPropertySymbols","searchString","extendStatics","__extends","__","__assign","__rest","__decorate","decorators","Reflect","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","fulfilled","rejected","done","__generator","_","sent","trys","ops","verb","throw","return","Symbol","op","__exportStar","__values","__read","__spread","__await","__asyncGenerator","asyncIterator","settle","fulfill","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","__importStar","mod","__esModule","__importDefault","defineMacro","defineDeprecatedMacroGetter","recommandedUsage","defined","CC_BUILD","CC_JSB","CC_NATIVERENDERER","CC_SUPPORT_JIT","CC_PHYSICS_BUILTIN","CC_PHYSICS_CANNON","CC_PREVIEW","WECHATGAMESUB","getSharedCanvas","WECHATGAME","getSystemInfoSync","QQPLAY"],"mappings":"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","file":"cocos2d-js-min.6da38.js","sourcesContent":["\n// Based on https://github.com/substack/browser-pack/blob/master/prelude.js\n\n// modules are defined as an array\n// [ module function, map of requireuires ]\n//\n// map of requireuires is short require name -> numeric require\n//\n// anything defined in a previous bundle is accessed via the\n// orig method which is the requireuire for previous bundles\n\n(function outer (modules, cache, entry) {\n    function newRequire(name, jumped){\n        var module = cache[name];\n        if(!module) {\n            var moduleData = modules[name];\n            if(!moduleData) {\n                // this module is excluded from engine\n                return undefined;\n            }\n            var exports = {};\n            module = cache[name] = {exports: exports};\n            moduleData[0](function(x){\n                return newRequire(moduleData[1][x] || x);\n            },module,exports);\n        }\n        return module.exports;\n    }\n    for(var i=0;i<entry.length;i++) newRequire(entry[i]);\n\n    // Override the current require with this new one\n    return newRequire;\n})\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('../core/platform/CCClass');\nconst misc = require('../core/utils/misc');\n\n/**\n * @module cc\n */\n\n/**\n * !#en Base class cc.Action for action classes.\n * !#zh Action 类是所有动作类型的基类。\n * @class Action\n */\ncc.Action = cc.Class({\n    name: 'cc.Action',\n\n    //**************Public Functions***********\n\n    ctor:function () {\n        this.originalTarget = null;\n        this.target = null;\n        this.tag = cc.Action.TAG_INVALID;\n    },\n\n    /**\n     * !#en\n     * to copy object with deep copy.\n     * returns a clone of action.\n     * !#zh 返回一个克隆的动作。\n     * @method clone\n     * @return {Action}\n     */\n    clone:function () {\n        var action = new cc.Action();\n        action.originalTarget = null;\n        action.target = null;\n        action.tag = this.tag;\n        return action;\n    },\n\n    /**\n     * !#en\n     * return true if the action has finished.\n     * !#zh 如果动作已完成就返回 true。\n     * @method isDone\n     * @return {Boolean}\n     */\n    isDone:function () {\n        return true;\n    },\n\n    // called before the action start. It will also set the target.\n    startWithTarget:function (target) {\n        this.originalTarget = target;\n        this.target = target;\n    },\n\n    // called after the action has finished. It will set the 'target' to nil.\n    stop:function () {\n        this.target = null;\n    },\n\n    // called every frame with it's delta time. <br />\n    step:function (dt) {\n        cc.logID(1006);\n    },\n\n    // Called once per frame. Time is the number of seconds of a frame interval.\n    update:function (dt) {\n        cc.logID(1007);\n    },\n\n    /**\n     * !#en get the target.\n     * !#zh 获取当前目标节点。\n     * @method getTarget\n     * @return {Node}\n     */\n    getTarget:function () {\n        return this.target;\n    },\n\n    /**\n     * !#en The action will modify the target properties.\n     * !#zh 设置目标节点。\n     * @method setTarget\n     * @param {Node} target\n     */\n    setTarget:function (target) {\n        this.target = target;\n    },\n\n    /**\n     * !#en get the original target.\n     * !#zh 获取原始目标节点。\n     * @method getOriginalTarget\n     * @return {Node}\n     */\n    getOriginalTarget:function () {\n        return this.originalTarget;\n    },\n\n    // Set the original target, since target can be nil.\n    // Is the target that were used to run the action.\n    // Unless you are doing something complex, like cc.ActionManager, you should NOT call this method.\n    setOriginalTarget:function (originalTarget) {\n        this.originalTarget = originalTarget;\n    },\n\n    /**\n     * !#en get tag number.\n     * !#zh 获取用于识别动作的标签。\n     * @method getTag\n     * @return {Number}\n     */\n    getTag:function () {\n        return this.tag;\n    },\n\n    /**\n     * !#en set tag number.\n     * !#zh 设置标签，用于识别动作。\n     * @method setTag\n     * @param {Number} tag\n     */\n    setTag:function (tag) {\n        this.tag = tag;\n    },\n\n    // Currently JavaScript Bindigns (JSB), in some cases, needs to use retain and release. This is a bug in JSB,\n    // and the ugly workaround is to use retain/release. So, these 2 methods were added to be compatible with JSB.\n    // This is a hack, and should be removed once JSB fixes the retain/release bug.\n    retain:function () {\n    },\n\n    // Currently JavaScript Bindigns (JSB), in some cases, needs to use retain and release. This is a bug in JSB,\n    // and the ugly workaround is to use retain/release. So, these 2 methods were added to be compatible with JSB.\n    // This is a hack, and should be removed once JSB fixes the retain/release bug.\n    release:function () {\n    }\n});\n\n/**\n * !#en Default Action tag.\n * !#zh 默认动作标签。\n * @property TAG_INVALID\n * @constant\n * @static\n * @type {Number}\n * @default -1\n */\ncc.Action.TAG_INVALID = -1;\n\n\n/**\n * !#en\n * Base class actions that do have a finite time duration. <br/>\n * Possible actions: <br/>\n * - An action with a duration of 0 seconds. <br/>\n * - An action with a duration of 35.5 seconds.\n *\n * Infinite time actions are valid\n * !#zh 有限时间动作，这种动作拥有时长 duration 属性。\n * @class FiniteTimeAction\n * @extends Action\n */\ncc.FiniteTimeAction = cc.Class({\n    name: 'cc.FiniteTimeAction',\n    extends: cc.Action,\n\n    ctor:function () {\n        //! duration in seconds\n        this._duration = 0;\n    },\n\n    /**\n     * !#en get duration of the action. (seconds).\n     * !#zh 获取动作以秒为单位的持续时间。\n     * @method getDuration\n     * @return {Number}\n     */\n    getDuration:function () {\n        return this._duration * (this._timesForRepeat || 1);\n    },\n\n    /**\n     * !#en set duration of the action. (seconds).\n     * !#zh 设置动作以秒为单位的持续时间。\n     * @method setDuration\n     * @param {Number} duration\n     */\n    setDuration:function (duration) {\n        this._duration = duration;\n    },\n\n    /**\n     * !#en\n     * Returns a reversed action. <br />\n     * For example: <br />\n     * - The action will be x coordinates of 0 move to 100. <br />\n     * - The reversed action will be x of 100 move to 0.\n     * - Will be rewritten\n     * !#zh 返回一个新的动作，执行与原动作完全相反的动作。\n     * @method reverse\n     * @return {Null}\n     */\n    reverse:function () {\n        cc.logID(1008);\n        return null;\n    },\n\n    /**\n     * !#en\n     * to copy object with deep copy.\n     * returns a clone of action.\n     * !#zh 返回一个克隆的动作。\n     * @method clone\n     * @return {FiniteTimeAction}\n     */\n    clone:function () {\n        return new cc.FiniteTimeAction();\n    }\n});\n\n/**\n * @module cc\n */\n\n/*\n * Changes the speed of an action, making it take longer (speed > 1)\n * or less (speed < 1) time. <br/>\n * Useful to simulate 'slow motion' or 'fast forward' effect.\n *\n * @warning This action can't be Sequenceable because it is not an cc.IntervalAction\n * @class Speed\n * @extends Action\n *\n * @param {ActionInterval} action\n * @param {Number} speed\n */\ncc.Speed = cc.Class({\n    name: 'cc.Speed',\n    extends: cc.Action,\n\n    ctor:function (action, speed) {\n        this._speed = 0;\n        this._innerAction = null;\n\n\t\taction && this.initWithAction(action, speed);\n    },\n\n    /*\n     * Gets the current running speed. <br />\n     * Will get a percentage number, compared to the original speed.\n     *\n     * @method getSpeed\n     * @return {Number}\n     */\n    getSpeed:function () {\n        return this._speed;\n    },\n\n    /*\n     * alter the speed of the inner function in runtime.\n     * @method setSpeed\n     * @param {Number} speed\n     */\n    setSpeed:function (speed) {\n        this._speed = speed;\n    },\n\n    /*\n     * initializes the action.\n     * @method initWithAction\n     * @param {ActionInterval} action\n     * @param {Number} speed\n     * @return {Boolean}\n     */\n    initWithAction:function (action, speed) {\n        if (!action) {\n            cc.errorID(1021);\n            return false;\n        }\n\n        this._innerAction = action;\n        this._speed = speed;\n        return true;\n    },\n\n    clone:function () {\n        var action = new cc.Speed();\n        action.initWithAction(this._innerAction.clone(), this._speed);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.Action.prototype.startWithTarget.call(this, target);\n        this._innerAction.startWithTarget(target);\n    },\n\n    stop:function () {\n        this._innerAction.stop();\n        cc.Action.prototype.stop.call(this);\n    },\n\n    step:function (dt) {\n        this._innerAction.step(dt * this._speed);\n    },\n\n    isDone:function () {\n        return this._innerAction.isDone();\n    },\n\n    reverse:function () {\n        return new cc.Speed(this._innerAction.reverse(), this._speed);\n    },\n\n    /*\n     * Set inner Action.\n     * @method setInnerAction\n     * @param {ActionInterval} action\n     */\n    setInnerAction:function (action) {\n        if (this._innerAction !== action) {\n            this._innerAction = action;\n        }\n    },\n\n    /*\n     * Get inner Action.\n     * @method getInnerAction\n     * @return {ActionInterval}\n     */\n    getInnerAction:function () {\n        return this._innerAction;\n    }\n});\n\n/**\n * @module cc\n */\n\n/**\n * !#en\n * Creates the speed action which changes the speed of an action, making it take longer (speed > 1)\n * or less (speed < 1) time. <br/>\n * Useful to simulate 'slow motion' or 'fast forward' effect.\n * !#zh 修改目标动作的速率。\n * @warning This action can't be Sequenceable because it is not an cc.IntervalAction\n *\n * @method speed\n * @param {ActionInterval} action\n * @param {Number} speed\n * @return {Action}\n * @example\n * // change the target action speed;\n * var action = cc.scaleTo(0.2, 1, 0.6);\n * var newAction = cc.speed(action, 0.5);\n */\ncc.speed = function (action, speed) {\n    return new cc.Speed(action, speed);\n};\n\n/*\n * cc.Follow is a follow action which makes its target follows another node.\n *\n * @example\n * //example\n * //Instead of using cc.Camera as a \"follower\", use this action instead.\n * layer.runAction(cc.follow(hero));\n *\n * @property {Number}  leftBoundary - world leftBoundary.\n * @property {Number}  rightBoundary - world rightBoundary.\n * @property {Number}  topBoundary - world topBoundary.\n * @property {Number}  bottomBoundary - world bottomBoundary.\n *\n * @param {cc.Node} followedNode\n * @param {Rect} rect\n * @example\n * // creates the action with a set boundary\n * var followAction = new cc.Follow(node, cc.rect(0, 0, s.width * 2 - 100, s.height));\n * this.runAction(followAction);\n *\n * // creates the action with no boundary set\n * var followAction = new cc.Follow(node);\n * this.runAction(followAction);\n *\n * @class\n * @extends Action\n */\ncc.Follow = cc.Class({\n    name: 'cc.Follow',\n    extends: cc.Action,\n\n\t/*\n     * Constructor function, override it to extend the construction behavior, remember to call \"this._super()\" in the extended \"ctor\" function. <br />\n\t * creates the action with a set boundary. <br/>\n\t * creates the action with no boundary set.\n     * @param {cc.Node} followedNode\n     * @param {Rect} rect\n\t */\n    ctor:function (followedNode, rect) {\n        // node to follow\n        this._followedNode = null;\n        // whether camera should be limited to certain area\n        this._boundarySet = false;\n        // if screen size is bigger than the boundary - update not needed\n        this._boundaryFullyCovered = false;\n        // fast access to the screen dimensions\n        this._halfScreenSize = null;\n        this._fullScreenSize = null;\n\n        this.leftBoundary = 0.0;\n        this.rightBoundary = 0.0;\n        this.topBoundary = 0.0;\n        this.bottomBoundary = 0.0;\n        this._worldRect = cc.rect(0, 0, 0, 0);\n\n\t\tif(followedNode)\n\t\t\trect ? this.initWithTarget(followedNode, rect)\n\t\t\t\t : this.initWithTarget(followedNode);\n    },\n\n    clone:function () {\n        var action = new cc.Follow();\n        var locRect = this._worldRect;\n        var rect = new cc.Rect(locRect.x, locRect.y, locRect.width, locRect.height);\n        action.initWithTarget(this._followedNode, rect);\n        return action;\n    },\n\n    /*\n     * Get whether camera should be limited to certain area.\n     *\n     * @return {Boolean}\n     */\n    isBoundarySet:function () {\n        return this._boundarySet;\n    },\n\n    /*\n     * alter behavior - turn on/off boundary.\n     *\n     * @param {Boolean} value\n     */\n    setBoudarySet:function (value) {\n        this._boundarySet = value;\n    },\n\n    /*\n     * initializes the action with a set boundary.\n     *\n     * @param {cc.Node} followedNode\n     * @param {Rect} [rect=]\n     * @return {Boolean}\n     */\n    initWithTarget:function (followedNode, rect) {\n        if (!followedNode) {\n            cc.errorID(1022);\n            return false;\n        }\n\n        var _this = this;\n        rect = rect || cc.rect(0, 0, 0, 0);\n        _this._followedNode = followedNode;\n        _this._worldRect = rect;\n\n        _this._boundarySet = !(rect.width === 0 && rect.height === 0);\n\n        _this._boundaryFullyCovered = false;\n\n        var winSize = cc.winSize;\n        _this._fullScreenSize = cc.v2(winSize.width, winSize.height);\n        _this._halfScreenSize = _this._fullScreenSize.mul(0.5);\n\n        if (_this._boundarySet) {\n            _this.leftBoundary = -((rect.x + rect.width) - _this._fullScreenSize.x);\n            _this.rightBoundary = -rect.x;\n            _this.topBoundary = -rect.y;\n            _this.bottomBoundary = -((rect.y + rect.height) - _this._fullScreenSize.y);\n\n            if (_this.rightBoundary < _this.leftBoundary) {\n                // screen width is larger than world's boundary width\n                //set both in the middle of the world\n                _this.rightBoundary = _this.leftBoundary = (_this.leftBoundary + _this.rightBoundary) / 2;\n            }\n            if (_this.topBoundary < _this.bottomBoundary) {\n                // screen width is larger than world's boundary width\n                //set both in the middle of the world\n                _this.topBoundary = _this.bottomBoundary = (_this.topBoundary + _this.bottomBoundary) / 2;\n            }\n\n            if ((_this.topBoundary === _this.bottomBoundary) && (_this.leftBoundary === _this.rightBoundary))\n                _this._boundaryFullyCovered = true;\n        }\n        return true;\n    },\n\n    step:function (dt) {\n        var targetWorldPos = this.target.convertToWorldSpaceAR(cc.Vec2.ZERO);\n        var followedWorldPos = this._followedNode.convertToWorldSpaceAR(cc.Vec2.ZERO);\n        // compute the offset between followed and target node\n        var delta = targetWorldPos.sub(followedWorldPos);\n        var tempPos = this.target.parent.convertToNodeSpaceAR(delta.add(this._halfScreenSize));\n\n        if (this._boundarySet) {\n            // whole map fits inside a single screen, no need to modify the position - unless map boundaries are increased\n            if (this._boundaryFullyCovered)\n                return;\n\n\t        this.target.setPosition(misc.clampf(tempPos.x, this.leftBoundary, this.rightBoundary), misc.clampf(tempPos.y, this.bottomBoundary, this.topBoundary));\n        } else {\n            this.target.setPosition(tempPos.x, tempPos.y);\n        }\n    },\n\n    isDone:function () {\n        return ( !this._followedNode.activeInHierarchy );\n    },\n\n    stop:function () {\n        this.target = null;\n        cc.Action.prototype.stop.call(this);\n    }\n});\n\n/**\n * !#en Create a follow action which makes its target follows another node.\n * !#zh 追踪目标节点的位置。\n * @method follow\n * @param {Node} followedNode\n * @param {Rect} rect\n * @return {Action|Null} returns the cc.Follow object on success\n * @example\n * // example\n * // creates the action with a set boundary\n * var followAction = cc.follow(targetNode, cc.rect(0, 0, screenWidth * 2 - 100, screenHeight));\n * node.runAction(followAction);\n *\n * // creates the action with no boundary set\n * var followAction = cc.follow(targetNode);\n * node.runAction(followAction);\n */\ncc.follow = function (followedNode, rect) {\n    return new cc.Follow(followedNode, rect);\n};\n","/****************************************************************************\n Copyright (c) 2008 Radu Gruian\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011 Vit Valentin\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n\n Orignal code by Radu Gruian: http://www.codeproject.com/Articles/30838/Overhauser-Catmull-Rom-Splines-for-Camera-Animatio.So\n\n Adapted to cocos2d-x by Vit Valentin\n\n Adapted from cocos2d-x to cocos2d-iphone by Ricardo Quesada\n ****************************************************************************/\n\n/**\n * @module cc\n */\n\n/*\n * Returns the Cardinal Spline position for a given set of control points, tension and time. <br />\n * CatmullRom Spline formula. <br />\n * s(-ttt + 2tt - t)P1 + s(-ttt + tt)P2 + (2ttt - 3tt + 1)P2 + s(ttt - 2tt + t)P3 + (-2ttt + 3tt)P3 + s(ttt - tt)P4\n *\n * @method cardinalSplineAt\n * @param {Vec2} p0\n * @param {Vec2} p1\n * @param {Vec2} p2\n * @param {Vec2} p3\n * @param {Number} tension\n * @param {Number} t\n * @return {Vec2}\n */\nfunction cardinalSplineAt (p0, p1, p2, p3, tension, t) {\n    var t2 = t * t;\n    var t3 = t2 * t;\n\n    /*\n     * Formula: s(-ttt + 2tt - t)P1 + s(-ttt + tt)P2 + (2ttt - 3tt + 1)P2 + s(ttt - 2tt + t)P3 + (-2ttt + 3tt)P3 + s(ttt - tt)P4\n     */\n    var s = (1 - tension) / 2;\n\n    var b1 = s * ((-t3 + (2 * t2)) - t);                      // s(-t3 + 2 t2 - t)P1\n    var b2 = s * (-t3 + t2) + (2 * t3 - 3 * t2 + 1);          // s(-t3 + t2)P2 + (2 t3 - 3 t2 + 1)P2\n    var b3 = s * (t3 - 2 * t2 + t) + (-2 * t3 + 3 * t2);      // s(t3 - 2 t2 + t)P3 + (-2 t3 + 3 t2)P3\n    var b4 = s * (t3 - t2);                                   // s(t3 - t2)P4\n\n    var x = (p0.x * b1 + p1.x * b2 + p2.x * b3 + p3.x * b4);\n    var y = (p0.y * b1 + p1.y * b2 + p2.y * b3 + p3.y * b4);\n    return cc.v2(x, y);\n};\n\n/*\n * returns a point from the array\n * @method getControlPointAt\n * @param {Array} controlPoints\n * @param {Number} pos\n * @return {Array}\n */\nfunction getControlPointAt (controlPoints, pos) {\n    var p = Math.min(controlPoints.length - 1, Math.max(pos, 0));\n    return controlPoints[p];\n};\n\nfunction reverseControlPoints (controlPoints) {\n    var newArray = [];\n    for (var i = controlPoints.length - 1; i >= 0; i--) {\n        newArray.push(cc.v2(controlPoints[i].x, controlPoints[i].y));\n    }\n    return newArray;\n}\n\nfunction cloneControlPoints (controlPoints) {\n    var newArray = [];\n    for (var i = 0; i < controlPoints.length; i++)\n        newArray.push(cc.v2(controlPoints[i].x, controlPoints[i].y));\n    return newArray;\n}\n\n\n/*\n * Cardinal Spline path. http://en.wikipedia.org/wiki/Cubic_Hermite_spline#Cardinal_spline\n * Absolute coordinates.\n *\n * @class CardinalSplineTo\n * @extends ActionInterval\n *\n * @param {Number} duration\n * @param {Array} points array of control points\n * @param {Number} tension\n *\n * @example\n * //create a cc.CardinalSplineTo\n * var action1 = cc.cardinalSplineTo(3, array, 0);\n */\ncc.CardinalSplineTo = cc.Class({\n    name: 'cc.CardinalSplineTo',\n    extends: cc.ActionInterval,\n\n    ctor: function (duration, points, tension) {\n        /* Array of control points */\n        this._points = [];\n        this._deltaT = 0;\n        this._tension = 0;\n        this._previousPosition = null;\n        this._accumulatedDiff = null;\n        tension !== undefined && cc.CardinalSplineTo.prototype.initWithDuration.call(this, duration, points, tension);\n    },\n\n    initWithDuration:function (duration, points, tension) {\n        if (!points || points.length === 0) {\n            cc.errorID(1024);\n            return false;\n        }\n\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, duration)) {\n            this.setPoints(points);\n            this._tension = tension;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.CardinalSplineTo();\n        action.initWithDuration(this._duration, cloneControlPoints(this._points), this._tension);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        // Issue #1441 from cocos2d-iphone\n        this._deltaT = 1 / (this._points.length - 1);\n        this._previousPosition = cc.v2(this.target.x, this.target.y);\n        this._accumulatedDiff = cc.v2(0, 0);\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        var p, lt;\n        var ps = this._points;\n        // eg.\n        // p..p..p..p..p..p..p\n        // 1..2..3..4..5..6..7\n        // want p to be 1, 2, 3, 4, 5, 6\n        if (dt === 1) {\n            p = ps.length - 1;\n            lt = 1;\n        } else {\n            var locDT = this._deltaT;\n            p = 0 | (dt / locDT);\n            lt = (dt - locDT * p) / locDT;\n        }\n\n        var newPos = cardinalSplineAt(\n            getControlPointAt(ps, p - 1),\n            getControlPointAt(ps, p - 0),\n            getControlPointAt(ps, p + 1),\n            getControlPointAt(ps, p + 2),\n            this._tension, lt);\n\n        if (cc.macro.ENABLE_STACKABLE_ACTIONS) {\n            var tempX, tempY;\n            tempX = this.target.x - this._previousPosition.x;\n            tempY = this.target.y - this._previousPosition.y;\n            if (tempX !== 0 || tempY !== 0) {\n                var locAccDiff = this._accumulatedDiff;\n                tempX = locAccDiff.x + tempX;\n                tempY = locAccDiff.y + tempY;\n                locAccDiff.x = tempX;\n                locAccDiff.y = tempY;\n                newPos.x += tempX;\n                newPos.y += tempY;\n            }\n        }\n        this.updatePosition(newPos);\n    },\n\n    reverse:function () {\n        var reversePoints = reverseControlPoints(this._points);\n        return cc.cardinalSplineTo(this._duration, reversePoints, this._tension);\n    },\n\n    /*\n     * update position of target\n     * @method updatePosition\n     * @param {Vec2} newPos\n     */\n    updatePosition:function (newPos) {\n        this.target.setPosition(newPos);\n        this._previousPosition = newPos;\n    },\n\n    /*\n     * Points getter\n     * @method getPoints\n     * @return {Array}\n     */\n    getPoints:function () {\n        return this._points;\n    },\n\n    /**\n     * Points setter\n     * @method setPoints\n     * @param {Array} points\n     */\n    setPoints:function (points) {\n        this._points = points;\n    }\n});\n\n/**\n * !#en Creates an action with a Cardinal Spline array of points and tension.\n * !#zh 按基数样条曲线轨迹移动到目标位置。\n * @method cardinalSplineTo\n * @param {Number} duration\n * @param {Array} points array of control points\n * @param {Number} tension\n * @return {ActionInterval}\n *\n * @example\n * //create a cc.CardinalSplineTo\n * var action1 = cc.cardinalSplineTo(3, array, 0);\n */\ncc.cardinalSplineTo = function (duration, points, tension) {\n    return new cc.CardinalSplineTo(duration, points, tension);\n};\n\n/*\n * Cardinal Spline path. http://en.wikipedia.org/wiki/Cubic_Hermite_spline#Cardinal_spline\n * Relative coordinates.\n *\n * @class CardinalSplineBy\n * @extends CardinalSplineTo\n *\n * @param {Number} duration\n * @param {Array} points\n * @param {Number} tension\n *\n * @example\n * //create a cc.CardinalSplineBy\n * var action1 = cc.cardinalSplineBy(3, array, 0);\n */\ncc.CardinalSplineBy = cc.Class({\n    name: 'cc.CardinalSplineBy',\n    extends: cc.CardinalSplineTo,\n\n    ctor:function (duration, points, tension) {\n        this._startPosition = cc.v2(0, 0);\n        tension !== undefined && this.initWithDuration(duration, points, tension);\n    },\n\n    startWithTarget:function (target) {\n        cc.CardinalSplineTo.prototype.startWithTarget.call(this, target);\n        this._startPosition.x = target.x;\n        this._startPosition.y = target.y;\n    },\n\n    reverse:function () {\n        var copyConfig = this._points.slice();\n        var current;\n        //\n        // convert \"absolutes\" to \"diffs\"\n        //\n        var p = copyConfig[0];\n        for (var i = 1; i < copyConfig.length; ++i) {\n            current = copyConfig[i];\n            copyConfig[i] = current.sub(p);\n            p = current;\n        }\n\n        // convert to \"diffs\" to \"reverse absolute\"\n        var reverseArray = reverseControlPoints(copyConfig);\n\n        // 1st element (which should be 0,0) should be here too\n        p = reverseArray[ reverseArray.length - 1 ];\n        reverseArray.pop();\n\n        p.x = -p.x;\n        p.y = -p.y;\n\n        reverseArray.unshift(p);\n        for (var i = 1; i < reverseArray.length; ++i) {\n            current = reverseArray[i];\n            current.x = -current.x;\n            current.y = -current.y;\n            current.x += p.x;\n            current.y += p.y;\n            reverseArray[i] = current;\n            p = current;\n        }\n        return cc.cardinalSplineBy(this._duration, reverseArray, this._tension);\n    },\n\n    /**\n     * update position of target\n     * @method updatePosition\n     * @param {Vec2} newPos\n     */\n    updatePosition:function (newPos) {\n        var pos = this._startPosition;\n        var posX = newPos.x + pos.x;\n        var posY = newPos.y + pos.y;\n        this._previousPosition.x = posX;\n        this._previousPosition.y = posY;\n        this.target.setPosition(posX, posY);\n    },\n\n    clone:function () {\n        var a = new cc.CardinalSplineBy();\n        a.initWithDuration(this._duration, cloneControlPoints(this._points), this._tension);\n        return a;\n    }\n});\n\n/**\n * !#en Creates an action with a Cardinal Spline array of points and tension.\n * !#zh 按基数样条曲线轨迹移动指定的距离。\n * @method cardinalSplineBy\n * @param {Number} duration\n * @param {Array} points\n * @param {Number} tension\n *\n * @return {ActionInterval}\n */\ncc.cardinalSplineBy = function (duration, points, tension) {\n    return new cc.CardinalSplineBy(duration, points, tension);\n};\n\n/*\n * An action that moves the target with a CatmullRom curve to a destination point.<br/>\n * A Catmull Rom is a Cardinal Spline with a tension of 0.5.  <br/>\n * http://en.wikipedia.org/wiki/Cubic_Hermite_spline#Catmull.E2.80.93Rom_spline\n * Absolute coordinates.\n *\n * @class CatmullRomTo\n * @extends CardinalSplineTo\n *\n * @param {Number} dt\n * @param {Array} points\n *\n * @example\n * var action1 = cc.catmullRomTo(3, array);\n */\ncc.CatmullRomTo = cc.Class({\n    name: 'cc.CatmullRomTo',\n    extends: cc.CardinalSplineTo,\n\n    ctor: function(dt, points) {\n        points && this.initWithDuration(dt, points);\n    },\n\n    initWithDuration:function (dt, points) {\n        return cc.CardinalSplineTo.prototype.initWithDuration.call(this, dt, points, 0.5);\n    },\n\n    clone:function () {\n        var action = new cc.CatmullRomTo();\n        action.initWithDuration(this._duration, cloneControlPoints(this._points));\n        return action;\n    }\n});\n\n/**\n * !#en Creates an action with a Cardinal Spline array of points and tension.\n * !#zh 按 Catmull Rom 样条曲线轨迹移动到目标位置。\n * @method catmullRomTo\n * @param {Number} dt\n * @param {Array} points\n * @return {ActionInterval}\n *\n * @example\n * var action1 = cc.catmullRomTo(3, array);\n */\ncc.catmullRomTo = function (dt, points) {\n    return new cc.CatmullRomTo(dt, points);\n};\n\n/*\n * An action that moves the target with a CatmullRom curve by a certain distance.  <br/>\n * A Catmull Rom is a Cardinal Spline with a tension of 0.5.<br/>\n * http://en.wikipedia.org/wiki/Cubic_Hermite_spline#Catmull.E2.80.93Rom_spline\n * Relative coordinates.\n *\n * @class CatmullRomBy\n * @extends CardinalSplineBy\n *\n * @param {Number} dt\n * @param {Array} points\n *\n * @example\n * var action1 = cc.catmullRomBy(3, array);\n */\ncc.CatmullRomBy = cc.Class({\n    name: 'cc.CatmullRomBy',\n    extends: cc.CardinalSplineBy,\n\n    ctor: function(dt, points) {\n        points && this.initWithDuration(dt, points);\n    },\n\n    initWithDuration:function (dt, points) {\n        return cc.CardinalSplineTo.prototype.initWithDuration.call(this, dt, points, 0.5);\n    },\n\n    clone:function () {\n        var action = new cc.CatmullRomBy();\n        action.initWithDuration(this._duration, cloneControlPoints(this._points));\n        return action;\n    }\n});\n\n/**\n * !#en Creates an action with a Cardinal Spline array of points and tension.\n * !#zh 按 Catmull Rom 样条曲线轨迹移动指定的距离。\n * @method catmullRomBy\n * @param {Number} dt\n * @param {Array} points\n * @return {ActionInterval}\n * @example\n * var action1 = cc.catmullRomBy(3, array);\n */\ncc.catmullRomBy = function (dt, points) {\n    return new cc.CatmullRomBy(dt, points);\n};\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * @module cc\n */\n\n/**\n * !#en\n * Creates the action easing object with the rate parameter. <br />\n * From slow to fast.\n * !#zh 创建 easeIn 缓动对象，由慢到快。\n * @method easeIn\n * @param {Number} rate\n * @return {Object}\n * @example\n * action.easing(cc.easeIn(3.0));\n */\ncc.easeIn = function (rate) {\n    return {\n        _rate: rate,\n        easing: function (dt) {\n            return Math.pow(dt, this._rate);\n        },\n        reverse: function(){\n            return cc.easeIn(1 / this._rate);\n        }\n    };\n};\n\n/**\n * !#en\n * Creates the action easing object with the rate parameter. <br />\n * From fast to slow.\n * !#zh 创建 easeOut 缓动对象，由快到慢。\n * @method easeOut\n * @param {Number} rate\n * @return {Object}\n * @example\n * action.easing(cc.easeOut(3.0));\n */\ncc.easeOut = function (rate) {\n    return {\n        _rate: rate,\n        easing: function (dt) {\n            return Math.pow(dt, 1 / this._rate);\n        },\n        reverse: function(){\n            return cc.easeOut(1 / this._rate);\n        }\n    };\n};\n\n/**\n * !#en\n * Creates the action easing object with the rate parameter. <br />\n * Slow to fast then to slow.\n * !#zh 创建 easeInOut 缓动对象，慢到快，然后慢。\n * @method easeInOut\n * @param {Number} rate\n * @return {Object}\n *\n * @example\n * action.easing(cc.easeInOut(3.0));\n */\ncc.easeInOut = function (rate) {\n    return {\n        _rate: rate,\n        easing: function (dt) {\n            dt *= 2;\n            if (dt < 1)\n                return 0.5 * Math.pow(dt, this._rate);\n            else\n                return 1.0 - 0.5 * Math.pow(2 - dt, this._rate);\n        },\n        reverse: function(){\n            return cc.easeInOut(this._rate);\n        }\n    };\n};\n\n/**\n * !#en\n * Creates the action easing object with the rate parameter. <br />\n * Reference easeInExpo: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeExponentialIn 缓动对象。<br />\n * EaseExponentialIn 是按指数函数缓动进入的动作。<br />\n * 参考 easeInExpo：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeExponentialIn\n * @return {Object}\n * @example\n * action.easing(cc.easeExponentialIn());\n */\nvar _easeExponentialInObj = {\n    easing: function(dt){\n        return dt === 0 ? 0 : Math.pow(2, 10 * (dt - 1));\n    },\n    reverse: function(){\n        return _easeExponentialOutObj;\n    }\n};\ncc.easeExponentialIn = function(){\n    return _easeExponentialInObj;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeOutExpo: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeExponentialOut 缓动对象。<br />\n * EaseExponentialOut 是按指数函数缓动退出的动作。<br />\n * 参考 easeOutExpo：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeExponentialOut\n * @return {Object}\n * @example\n * action.easing(cc.easeExponentialOut());\n */\nvar _easeExponentialOutObj = {\n    easing: function(dt){\n        return dt === 1 ? 1 : (-(Math.pow(2, -10 * dt)) + 1);\n    },\n    reverse: function(){\n        return _easeExponentialInObj;\n    }\n};\ncc.easeExponentialOut = function(){\n    return _easeExponentialOutObj;\n};\n\n/**\n * !#en\n * Creates an EaseExponentialInOut action easing object. <br />\n * Reference easeInOutExpo: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeExponentialInOut 缓动对象。<br />\n * EaseExponentialInOut 是按指数函数缓动进入并退出的动作。<br />\n * 参考 easeInOutExpo：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeExponentialInOut\n * @return {Object}\n * @example\n * action.easing(cc.easeExponentialInOut());\n */\nvar _easeExponentialInOutObj = {\n    easing: function(dt){\n        if( dt !== 1 && dt !== 0) {\n            dt *= 2;\n            if (dt < 1)\n                return 0.5 * Math.pow(2, 10 * (dt - 1));\n            else\n                return 0.5 * (-Math.pow(2, -10 * (dt - 1)) + 2);\n        }\n        return dt;\n    },\n    reverse: function(){\n        return _easeExponentialInOutObj;\n    }\n};\ncc.easeExponentialInOut = function(){\n    return _easeExponentialInOutObj;\n};\n\n/**\n * !#en\n * Creates an EaseSineIn action. <br />\n * Reference easeInSine: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 EaseSineIn 缓动对象。<br />\n * EaseSineIn 是按正弦函数缓动进入的动作。<br />\n * 参考 easeInSine：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeSineIn\n * @return {Object}\n * @example\n * action.easing(cc.easeSineIn());\n */\nvar _easeSineInObj = {\n    easing: function(dt){\n        return (dt===0 || dt===1) ? dt : -1 * Math.cos(dt * Math.PI / 2) + 1;\n    },\n    reverse: function(){\n        return _easeSineOutObj;\n    }\n};\ncc.easeSineIn = function(){\n    return _easeSineInObj;\n};\n\n/**\n * !#en\n * Creates an EaseSineOut action easing object. <br />\n * Reference easeOutSine: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 EaseSineOut 缓动对象。<br />\n * EaseSineIn 是按正弦函数缓动退出的动作。<br />\n * 参考 easeOutSine：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeSineOut\n * @return {Object}\n * @example\n * action.easing(cc.easeSineOut());\n */\nvar _easeSineOutObj = {\n    easing: function(dt){\n        return (dt===0 || dt===1) ? dt : Math.sin(dt * Math.PI / 2);\n    },\n    reverse: function(){\n        return _easeSineInObj;\n    }\n};\ncc.easeSineOut = function(){\n    return _easeSineOutObj;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeInOutSine: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeSineInOut 缓动对象。<br />\n * EaseSineIn 是按正弦函数缓动进入并退出的动作。<br />\n * 参考 easeInOutSine：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeSineInOut\n * @return {Object}\n * @example\n * action.easing(cc.easeSineInOut());\n */\nvar _easeSineInOutObj = {\n    easing: function(dt){\n        return (dt === 0 || dt === 1) ? dt : -0.5 * (Math.cos(Math.PI * dt) - 1);\n    },\n    reverse: function(){\n        return _easeSineInOutObj;\n    }\n};\ncc.easeSineInOut = function(){\n    return _easeSineInOutObj;\n};\n\n/**\n * @module cc\n */\n\n/**\n * !#en\n * Creates the action easing object with the period in radians (default is 0.3). <br />\n * Reference easeInElastic: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeElasticIn 缓动对象。<br />\n * EaseElasticIn 是按弹性曲线缓动进入的动作。<br />\n * 参数 easeInElastic：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeElasticIn\n * @param {Number} period\n * @return {Object}\n * @example\n * // example\n * action.easing(cc.easeElasticIn(3.0));\n */\n//default ease elastic in object (period = 0.3)\nvar _easeElasticInObj = {\n    easing:function(dt){\n        if (dt === 0 || dt === 1)\n            return dt;\n        dt = dt - 1;\n        return -Math.pow(2, 10 * dt) * Math.sin((dt - (0.3 / 4)) * Math.PI * 2 / 0.3);\n    },\n     reverse:function(){\n         return _easeElasticOutObj;\n     }\n };\ncc.easeElasticIn = function (period) {\n    if(period && period !== 0.3){\n        return {\n            _period: period,\n            easing: function (dt) {\n                if (dt === 0 || dt === 1)\n                    return dt;\n                dt = dt - 1;\n                return -Math.pow(2, 10 * dt) * Math.sin((dt - (this._period / 4)) * Math.PI * 2 / this._period);\n            },\n            reverse:function () {\n                return cc.easeElasticOut(this._period);\n            }\n        };\n    }\n    return _easeElasticInObj;\n};\n\n/**\n * !#en\n * Creates the action easing object with the period in radians (default is 0.3). <br />\n * Reference easeOutElastic: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeElasticOut 缓动对象。<br />\n * EaseElasticOut 是按弹性曲线缓动退出的动作。<br />\n * 参考 easeOutElastic：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeElasticOut\n * @param {Number} period\n * @return {Object}\n * @example\n * // example\n * action.easing(cc.easeElasticOut(3.0));\n */\n//default ease elastic out object (period = 0.3)\nvar _easeElasticOutObj = {\n    easing: function (dt) {\n        return (dt === 0 || dt === 1) ? dt : Math.pow(2, -10 * dt) * Math.sin((dt - (0.3 / 4)) * Math.PI * 2 / 0.3) + 1;\n    },\n    reverse:function(){\n        return _easeElasticInObj;\n    }\n};\ncc.easeElasticOut = function (period) {\n    if(period && period !== 0.3){\n        return {\n            _period: period,\n            easing: function (dt) {\n                return (dt === 0 || dt === 1) ? dt : Math.pow(2, -10 * dt) * Math.sin((dt - (this._period / 4)) * Math.PI * 2 / this._period) + 1;\n            },\n            reverse:function(){\n                return cc.easeElasticIn(this._period);\n            }\n        };\n    }\n    return _easeElasticOutObj;\n};\n\n/**\n * !#en\n * Creates the action easing object with the period in radians (default is 0.3). <br />\n * Reference easeInOutElastic: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeElasticInOut 缓动对象。<br />\n * EaseElasticInOut 是按弹性曲线缓动进入并退出的动作。<br />\n * 参考 easeInOutElastic：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeElasticInOut\n * @param {Number} period\n * @return {Object}\n * @example\n * // example\n * action.easing(cc.easeElasticInOut(3.0));\n */\ncc.easeElasticInOut = function (period) {\n    period = period || 0.3;\n    return {\n        _period: period,\n        easing: function (dt) {\n            var newT = 0;\n            var locPeriod = this._period;\n            if (dt === 0 || dt === 1) {\n                newT = dt;\n            } else {\n                dt = dt * 2;\n                if (!locPeriod)\n                    locPeriod = this._period = 0.3 * 1.5;\n                var s = locPeriod / 4;\n                dt = dt - 1;\n                if (dt < 0)\n                    newT = -0.5 * Math.pow(2, 10 * dt) * Math.sin((dt - s) * Math.PI * 2 / locPeriod);\n                else\n                    newT = Math.pow(2, -10 * dt) * Math.sin((dt - s) * Math.PI * 2 / locPeriod) * 0.5 + 1;\n            }\n            return newT;\n        },\n        reverse: function(){\n            return cc.easeElasticInOut(this._period);\n        }\n    };\n};\n\n/**\n * @module cc\n */\n\nfunction _bounceTime (time1) {\n    if (time1 < 1 / 2.75) {\n        return 7.5625 * time1 * time1;\n    } else if (time1 < 2 / 2.75) {\n        time1 -= 1.5 / 2.75;\n        return 7.5625 * time1 * time1 + 0.75;\n    } else if (time1 < 2.5 / 2.75) {\n        time1 -= 2.25 / 2.75;\n        return 7.5625 * time1 * time1 + 0.9375;\n    }\n\n    time1 -= 2.625 / 2.75;\n    return 7.5625 * time1 * time1 + 0.984375;\n};\n\nvar _easeBounceInObj = {\n    easing: function(dt){\n        return 1 - _bounceTime(1 - dt);\n    },\n    reverse: function(){\n        return _easeBounceOutObj;\n    }\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Eased bounce effect at the beginning.\n * !#zh\n * 创建 easeBounceIn 缓动对象。<br />\n * EaseBounceIn 是按弹跳动作缓动进入的动作。\n * @method easeBounceIn\n * @return {Object}\n * @example\n * // example\n * action.easing(cc.easeBounceIn());\n */\ncc.easeBounceIn = function(){\n    return _easeBounceInObj;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Eased bounce effect at the ending.\n * !#zh\n * 创建 easeBounceOut 缓动对象。<br />\n * EaseBounceOut 是按弹跳动作缓动退出的动作。\n * @method easeBounceOut\n * @return {Object}\n * @example\n * // example\n * action.easing(cc.easeBounceOut());\n */\nvar _easeBounceOutObj = {\n    easing: function(dt){\n        return _bounceTime(dt);\n    },\n    reverse:function () {\n        return _easeBounceInObj;\n    }\n};\ncc.easeBounceOut = function(){\n    return _easeBounceOutObj;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Eased bounce effect at the begining and ending.\n * !#zh\n * 创建 easeBounceInOut 缓动对象。<br />\n * EaseBounceInOut 是按弹跳动作缓动进入并退出的动作。\n * @method easeBounceInOut\n * @return {Object}\n * @example\n * // example\n * action.easing(cc.easeBounceInOut());\n */\nvar _easeBounceInOutObj = {\n    easing: function (time1) {\n        var newT;\n        if (time1 < 0.5) {\n            time1 = time1 * 2;\n            newT = (1 - _bounceTime(1 - time1)) * 0.5;\n        } else {\n            newT = _bounceTime(time1 * 2 - 1) * 0.5 + 0.5;\n        }\n        return newT;\n    },\n    reverse: function(){\n        return _easeBounceInOutObj;\n    }\n};\ncc.easeBounceInOut = function(){\n    return _easeBounceInOutObj;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * In the opposite direction to move slowly, and then accelerated to the right direction.\n * !#zh\n * 创建 easeBackIn 缓动对象。<br />\n * easeBackIn 是在相反的方向缓慢移动，然后加速到正确的方向。<br />\n * @method easeBackIn\n * @return {Object}\n * @example\n * // example\n * action.easing(cc.easeBackIn());\n */\nvar _easeBackInObj = {\n    easing: function (time1) {\n        var overshoot = 1.70158;\n        return (time1===0 || time1===1) ? time1 : time1 * time1 * ((overshoot + 1) * time1 - overshoot);\n    },\n    reverse: function(){\n        return _easeBackOutObj;\n    }\n};\ncc.easeBackIn = function(){\n    return _easeBackInObj;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Fast moving more than the finish, and then slowly back to the finish.\n * !#zh\n * 创建 easeBackOut 缓动对象。<br />\n * easeBackOut 快速移动超出目标，然后慢慢回到目标点。\n * @method easeBackOut\n * @return {Object}\n * @example\n * // example\n * action.easing(cc.easeBackOut());\n */\nvar _easeBackOutObj = {\n    easing: function (time1) {\n        var overshoot = 1.70158;\n        time1 = time1 - 1;\n        return time1 * time1 * ((overshoot + 1) * time1 + overshoot) + 1;\n    },\n    reverse: function(){\n        return _easeBackInObj;\n    }\n};\ncc.easeBackOut = function(){\n    return _easeBackOutObj;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Begining of cc.EaseBackIn. Ending of cc.EaseBackOut.\n * !#zh\n * 创建 easeBackInOut 缓动对象。<br />\n * @method easeBackInOut\n * @return {Object}\n * @example\n * // example\n * action.easing(cc.easeBackInOut());\n */\nvar _easeBackInOutObj = {\n    easing: function (time1) {\n        var overshoot = 1.70158 * 1.525;\n        time1 = time1 * 2;\n        if (time1 < 1) {\n            return (time1 * time1 * ((overshoot + 1) * time1 - overshoot)) / 2;\n        } else {\n            time1 = time1 - 2;\n            return (time1 * time1 * ((overshoot + 1) * time1 + overshoot)) / 2 + 1;\n        }\n    },\n    reverse: function(){\n        return _easeBackInOutObj;\n    }\n};\ncc.easeBackInOut = function(){\n    return _easeBackInOutObj;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Into the 4 reference point. <br />\n * To calculate the motion curve.\n * !#zh\n * 创建 easeBezierAction 缓动对象。<br />\n * EaseBezierAction 是按贝塞尔曲线缓动的动作。\n * @method easeBezierAction\n * @param {Number} p0 The first bezier parameter\n * @param {Number} p1 The second bezier parameter\n * @param {Number} p2 The third bezier parameter\n * @param {Number} p3 The fourth bezier parameter\n * @returns {Object}\n * @example\n * // example\n * action.easing(cc.easeBezierAction(0.5, 0.5, 1.0, 1.0));\n */\ncc.easeBezierAction = function(a, b, c, d){\n    return {\n        easing: function(t){\n            return (Math.pow(1-t,3) * a + 3*t*(Math.pow(1-t,2))*b + 3*Math.pow(t,2)*(1-t)*c + Math.pow(t,3)*d);\n        },\n        reverse: function(){\n            return cc.easeBezierAction(d, c, b, a);\n        }\n    };\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeInQuad: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeQuadraticActionIn 缓动对象。<br />\n * EaseQuadraticIn是按二次函数缓动进入的动作。<br />\n * 参考 easeInQuad：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeQuadraticActionIn\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.easeQuadraticActionIn());\n */\nvar _easeQuadraticActionIn = {\n    easing: function(time){\n        return Math.pow(time, 2);\n    },\n    reverse: function(){\n        return _easeQuadraticActionIn;\n    }\n};\ncc.easeQuadraticActionIn = function(){\n    return _easeQuadraticActionIn;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeOutQuad: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeQuadraticActionOut 缓动对象。<br />\n * EaseQuadraticOut 是按二次函数缓动退出的动作。<br />\n * 参考 easeOutQuad：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeQuadraticActionOut\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.easeQuadraticActionOut());\n */\nvar _easeQuadraticActionOut = {\n    easing: function(time){\n        return -time*(time-2);\n    },\n    reverse: function(){\n        return _easeQuadraticActionOut;\n    }\n};\ncc.easeQuadraticActionOut = function(){\n    return _easeQuadraticActionOut;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeInOutQuad: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeQuadraticActionInOut 缓动对象。<br />\n * EaseQuadraticInOut 是按二次函数缓动进入并退出的动作。<br />\n * 参考 easeInOutQuad：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeQuadraticActionInOut\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.easeQuadraticActionInOut());\n */\nvar _easeQuadraticActionInOut = {\n    easing: function(time){\n        var resultTime = time;\n        time *= 2;\n        if(time < 1){\n            resultTime = time * time * 0.5;\n        }else{\n            --time;\n            resultTime = -0.5 * ( time * ( time - 2 ) - 1)\n        }\n        return resultTime;\n    },\n    reverse: function(){\n        return _easeQuadraticActionInOut;\n    }\n};\ncc.easeQuadraticActionInOut = function(){\n    return _easeQuadraticActionInOut;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeIntQuart: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeQuarticActionIn 缓动对象。<br />\n * EaseQuarticIn 是按四次函数缓动进入的动作。<br />\n * 参考 easeIntQuart：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeQuarticActionIn\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.easeQuarticActionIn());\n */\nvar _easeQuarticActionIn = {\n    easing: function(time){\n        return time * time * time * time;\n    },\n    reverse: function(){\n        return _easeQuarticActionIn;\n    }\n};\ncc.easeQuarticActionIn = function(){\n    return _easeQuarticActionIn;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeOutQuart: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeQuarticActionOut 缓动对象。<br />\n * EaseQuarticOut 是按四次函数缓动退出的动作。<br />\n * 参考 easeOutQuart：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeQuarticActionOut\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.QuarticActionOut());\n */\nvar _easeQuarticActionOut = {\n    easing: function(time){\n        time -= 1;\n        return -(time * time * time * time - 1);\n    },\n    reverse: function(){\n        return _easeQuarticActionOut;\n    }\n};\ncc.easeQuarticActionOut = function(){\n    return _easeQuarticActionOut;\n};\n\n/**\n * !#en\n * Creates the action easing object.  <br />\n * Reference easeInOutQuart: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeQuarticActionInOut 缓动对象。<br />\n * EaseQuarticInOut 是按四次函数缓动进入并退出的动作。<br />\n * 参考 easeInOutQuart：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeQuarticActionInOut\n * @returns {Object}\n */\nvar _easeQuarticActionInOut = {\n    easing: function(time){\n        time = time*2;\n        if (time < 1)\n            return 0.5 * time * time * time * time;\n        time -= 2;\n        return -0.5 * (time * time * time * time - 2);\n    },\n    reverse: function(){\n        return _easeQuarticActionInOut;\n    }\n};\ncc.easeQuarticActionInOut = function(){\n    return _easeQuarticActionInOut;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeInQuint: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeQuinticActionIn 缓动对象。<br />\n * EaseQuinticIn 是按五次函数缓动进的动作。<br />\n * 参考 easeInQuint：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeQuinticActionIn\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.easeQuinticActionIn());\n */\nvar _easeQuinticActionIn = {\n    easing: function(time){\n        return time * time * time * time * time;\n    },\n    reverse: function(){\n        return _easeQuinticActionIn;\n    }\n};\ncc.easeQuinticActionIn = function(){\n    return _easeQuinticActionIn;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeOutQuint: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeQuinticActionOut 缓动对象。<br />\n * EaseQuinticOut 是按五次函数缓动退出的动作\n * 参考 easeOutQuint：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeQuinticActionOut\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.easeQuadraticActionOut());\n */\nvar _easeQuinticActionOut = {\n    easing: function(time){\n        time -=1;\n        return (time * time * time * time * time + 1);\n    },\n    reverse: function(){\n        return _easeQuinticActionOut;\n    }\n};\ncc.easeQuinticActionOut = function(){\n    return _easeQuinticActionOut;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeInOutQuint: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeQuinticActionInOut 缓动对象。<br />\n * EaseQuinticInOut是按五次函数缓动进入并退出的动作。<br />\n * 参考 easeInOutQuint：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeQuinticActionInOut\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.easeQuinticActionInOut());\n */\nvar _easeQuinticActionInOut = {\n    easing: function(time){\n        time = time*2;\n        if (time < 1)\n            return 0.5 * time * time * time * time * time;\n        time -= 2;\n        return 0.5 * (time * time * time * time * time + 2);\n    },\n    reverse: function(){\n        return _easeQuinticActionInOut;\n    }\n};\ncc.easeQuinticActionInOut = function(){\n    return _easeQuinticActionInOut;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeInCirc: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeCircleActionIn 缓动对象。<br />\n * EaseCircleIn是按圆形曲线缓动进入的动作。<br />\n * 参考 easeInCirc：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeCircleActionIn\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.easeCircleActionIn());\n */\nvar _easeCircleActionIn = {\n    easing: function(time){\n        return -1 * (Math.sqrt(1 - time * time) - 1);\n    },\n    reverse: function(){\n        return _easeCircleActionIn;\n    }\n};\ncc.easeCircleActionIn = function(){\n    return _easeCircleActionIn;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeOutCirc: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeCircleActionOut 缓动对象。<br />\n * EaseCircleOut是按圆形曲线缓动退出的动作。<br />\n * 参考 easeOutCirc：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeCircleActionOut\n * @returns {Object}\n * @example\n * //example\n * actioneasing(cc.easeCircleActionOut());\n */\nvar _easeCircleActionOut = {\n    easing: function(time){\n        time = time - 1;\n        return Math.sqrt(1 - time * time);\n    },\n    reverse: function(){\n        return _easeCircleActionOut;\n    }\n};\ncc.easeCircleActionOut = function(){\n    return _easeCircleActionOut;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeInOutCirc: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeCircleActionInOut 缓动对象。<br />\n * EaseCircleInOut 是按圆形曲线缓动进入并退出的动作。<br />\n * 参考 easeInOutCirc：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeCircleActionInOut\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.easeCircleActionInOut());\n */\nvar _easeCircleActionInOut = {\n    easing: function(time){\n        time = time * 2;\n        if (time < 1)\n            return -0.5 * (Math.sqrt(1 - time * time) - 1);\n        time -= 2;\n        return 0.5 * (Math.sqrt(1 - time * time) + 1);\n    },\n    reverse: function(){\n        return _easeCircleActionInOut;\n    }\n};\ncc.easeCircleActionInOut = function(){\n    return _easeCircleActionInOut;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeInCubic: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeCubicActionIn 缓动对象。<br />\n * EaseCubicIn 是按三次函数缓动进入的动作。<br />\n * 参考 easeInCubic：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeCubicActionIn\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.easeCubicActionIn());\n */\nvar _easeCubicActionIn = {\n    easing: function(time){\n        return time * time * time;\n    },\n    reverse: function(){\n        return _easeCubicActionIn;\n    }\n};\ncc.easeCubicActionIn = function(){\n    return _easeCubicActionIn;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeOutCubic: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeCubicActionOut 缓动对象。<br />\n * EaseCubicOut 是按三次函数缓动退出的动作。<br />\n * 参考 easeOutCubic：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeCubicActionOut\n * @returns {Object}\n * @example\n * //example\n * action.easing(cc.easeCubicActionOut());\n */\nvar _easeCubicActionOut = {\n    easing: function(time){\n        time -= 1;\n        return (time * time * time + 1);\n    },\n    reverse: function(){\n        return _easeCubicActionOut;\n    }\n};\ncc.easeCubicActionOut = function(){\n    return _easeCubicActionOut;\n};\n\n/**\n * !#en\n * Creates the action easing object. <br />\n * Reference easeInOutCubic: <br />\n * http://www.zhihu.com/question/21981571/answer/19925418\n * !#zh\n * 创建 easeCubicActionInOut 缓动对象。<br />\n * EaseCubicInOut是按三次函数缓动进入并退出的动作。<br />\n * 参考 easeInOutCubic：http://www.zhihu.com/question/21981571/answer/19925418\n * @method easeCubicActionInOut\n * @returns {Object}\n */\nvar _easeCubicActionInOut = {\n    easing: function(time){\n        time = time*2;\n        if (time < 1)\n            return 0.5 * time * time * time;\n        time -= 2;\n        return 0.5 * (time * time * time + 2);\n    },\n    reverse: function(){\n        return _easeCubicActionInOut;\n    }\n};\ncc.easeCubicActionInOut = function(){\n    return _easeCubicActionInOut;\n};\n\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * @module cc\n */\n\n/**\n * !#en Instant actions are immediate actions. They don't have a duration like the ActionInterval actions.\n * !#zh 即时动作，这种动作立即就会执行，继承自 FiniteTimeAction。\n * @class ActionInstant\n * @extends FiniteTimeAction\n */\ncc.ActionInstant = cc.Class({\n    name: 'cc.ActionInstant',\n    extends: cc.FiniteTimeAction,\n    isDone:function () {\n        return true;\n    },\n\n    step:function (dt) {\n        this.update(1);\n    },\n\n    update:function (dt) {\n        //nothing\n    },\n\n    /**\n     * returns a reversed action. <br />\n     * For example: <br />\n     * - The action is x coordinates of 0 move to 100. <br />\n     * - The reversed action will be x of 100 move to 0.\n     * @returns {Action}\n     */\n    reverse:function(){\n        return this.clone();\n    },\n\n    clone:function(){\n        return new cc.ActionInstant();\n    }\n});\n\n/**\n * @module cc\n */\n\n/*\n * Show the node.\n * @class Show\n * @extends ActionInstant\n */\ncc.Show = cc.Class({\n    name: 'cc.Show',\n    extends: cc.ActionInstant,\n\n    update:function (dt) {\n        var _renderComps = this.target.getComponentsInChildren(cc.RenderComponent);\n        for (var i = 0; i < _renderComps.length; ++i) {\n            var render = _renderComps[i];\n            render.enabled = true;\n        }\n    },\n\n    reverse:function () {\n        return new cc.Hide();\n    },\n\n    clone:function(){\n        return new cc.Show();\n    }\n});\n\n/**\n * !#en Show the Node.\n * !#zh 立即显示。\n * @method show\n * @return {ActionInstant}\n * @example\n * // example\n * var showAction = cc.show();\n */\ncc.show = function () {\n    return new cc.Show();\n};\n\n/*\n * Hide the node.\n * @class Hide\n * @extends ActionInstant\n */\ncc.Hide = cc.Class({\n    name: 'cc.Hide',\n    extends: cc.ActionInstant,\n\n    update:function (dt) {\n        var _renderComps = this.target.getComponentsInChildren(cc.RenderComponent);\n        for (var i = 0; i < _renderComps.length; ++i) {\n            var render = _renderComps[i];\n            render.enabled = false;\n        }\n    },\n\n    reverse:function () {\n        return new cc.Show();\n    },\n\n    clone:function(){\n        return new cc.Hide();\n    }\n});\n\n/**\n * !#en Hide the node.\n * !#zh 立即隐藏。\n * @method hide\n * @return {ActionInstant}\n * @example\n * // example\n * var hideAction = cc.hide();\n */\ncc.hide = function () {\n    return new cc.Hide();\n};\n\n/*\n * Toggles the visibility of a node.\n * @class ToggleVisibility\n * @extends ActionInstant\n */\ncc.ToggleVisibility = cc.Class({\n    name: 'cc.ToggleVisibility',\n    extends: cc.ActionInstant,\n\n    update:function (dt) {\n        var _renderComps = this.target.getComponentsInChildren(cc.RenderComponent);\n        for (var i = 0; i < _renderComps.length; ++i) {\n            var render = _renderComps[i];\n            render.enabled = !render.enabled;\n        }\n    },\n\n    reverse:function () {\n        return new cc.ToggleVisibility();\n    },\n\n    clone:function(){\n        return new cc.ToggleVisibility();\n    }\n});\n\n/**\n * !#en Toggles the visibility of a node.\n * !#zh 显隐状态切换。\n * @method toggleVisibility\n * @return {ActionInstant}\n * @example\n * // example\n * var toggleVisibilityAction = cc.toggleVisibility();\n */\ncc.toggleVisibility = function () {\n    return new cc.ToggleVisibility();\n};\n\n/*\n * Delete self in the next frame.\n * @class RemoveSelf\n * @extends ActionInstant\n * @param {Boolean} [isNeedCleanUp=true]\n *\n * @example\n * // example\n * var removeSelfAction = new cc.RemoveSelf(false);\n */\ncc.RemoveSelf = cc.Class({\n    name: 'cc.RemoveSelf',\n    extends: cc.ActionInstant,\n\n    ctor:function(isNeedCleanUp){\n        this._isNeedCleanUp = true;\n\t    isNeedCleanUp !== undefined && this.init(isNeedCleanUp);\n    },\n\n    update:function(dt){\n        this.target.removeFromParent(this._isNeedCleanUp);\n    },\n\n    init:function(isNeedCleanUp){\n        this._isNeedCleanUp = isNeedCleanUp;\n        return true;\n    },\n\n    reverse:function(){\n        return new cc.RemoveSelf(this._isNeedCleanUp);\n    },\n\n    clone:function(){\n        return new cc.RemoveSelf(this._isNeedCleanUp);\n    }\n});\n\n/**\n * !#en Create a RemoveSelf object with a flag indicate whether the target should be cleaned up while removing.\n * !#zh 从父节点移除自身。\n * @method removeSelf\n * @param {Boolean} [isNeedCleanUp = true]\n * @return {ActionInstant}\n *\n * @example\n * // example\n * var removeSelfAction = cc.removeSelf();\n */\ncc.removeSelf = function(isNeedCleanUp){\n    return new cc.RemoveSelf(isNeedCleanUp);\n};\n\n/*\n * Flips the sprite horizontally.\n * @class FlipX\n * @extends ActionInstant\n * @param {Boolean} flip Indicate whether the target should be flipped or not\n *\n * @example\n * var flipXAction = new cc.FlipX(true);\n */\ncc.FlipX = cc.Class({\n    name: 'cc.FlipX',\n    extends: cc.ActionInstant,\n\n    ctor:function(flip){\n        this._flippedX = false;\n\t\tflip !== undefined && this.initWithFlipX(flip);\n    },\n\n    /*\n     * initializes the action with a set flipX.\n     * @param {Boolean} flip\n     * @return {Boolean}\n     */\n    initWithFlipX:function (flip) {\n        this._flippedX = flip;\n        return true;\n    },\n\n    update:function (dt) {\n        this.target.scaleX = Math.abs(this.target.scaleX) * (this._flippedX ? -1 : 1);\n    },\n\n    reverse:function () {\n        return new cc.FlipX(!this._flippedX);\n    },\n\n    clone:function(){\n        var action = new cc.FlipX();\n        action.initWithFlipX(this._flippedX);\n        return action;\n    }\n});\n\n/**\n * !#en Create a FlipX action to flip or unflip the target.\n * !#zh X轴翻转。\n * @method flipX\n * @param {Boolean} flip Indicate whether the target should be flipped or not\n * @return {ActionInstant}\n * @example\n * var flipXAction = cc.flipX(true);\n */\ncc.flipX = function (flip) {\n    return new cc.FlipX(flip);\n};\n\n/*\n * Flips the sprite vertically\n * @class FlipY\n * @extends ActionInstant\n * @param {Boolean} flip\n * @example\n * var flipYAction = new cc.FlipY(true);\n */\ncc.FlipY = cc.Class({\n    name: 'cc.FlipY',\n    extends: cc.ActionInstant,\n\n    ctor: function(flip){\n        this._flippedY = false;\n\t\tflip !== undefined && this.initWithFlipY(flip);\n    },\n\n    /*\n     * initializes the action with a set flipY.\n     * @param {Boolean} flip\n     * @return {Boolean}\n     */\n    initWithFlipY:function (flip) {\n        this._flippedY = flip;\n        return true;\n    },\n\n    update:function (dt) {\n        this.target.scaleY = Math.abs(this.target.scaleY) * (this._flippedY ? -1 : 1);\n    },\n\n    reverse:function () {\n        return new cc.FlipY(!this._flippedY);\n    },\n\n    clone:function(){\n        var action = new cc.FlipY();\n        action.initWithFlipY(this._flippedY);\n        return action;\n    }\n});\n\n/**\n * !#en Create a FlipY action to flip or unflip the target.\n * !#zh Y轴翻转。\n * @method flipY\n * @param {Boolean} flip\n * @return {ActionInstant}\n * @example\n * var flipYAction = cc.flipY(true);\n */\ncc.flipY = function (flip) {\n    return new cc.FlipY(flip);\n};\n\n/*\n * Places the node in a certain position\n * @class Place\n * @extends ActionInstant\n * @param {Vec2|Number} pos\n * @param {Number} [y]\n * @example\n * var placeAction = new cc.Place(cc.v2(200, 200));\n * var placeAction = new cc.Place(200, 200);\n */\ncc.Place = cc.Class({\n    name: 'cc.Place',\n    extends: cc.ActionInstant,\n\n    ctor:function(pos, y){\n        this._x = 0;\n\t    this._y = 0;\n\n\t\tif (pos !== undefined) {\n\t\t\tif (pos.x !== undefined) {\n\t\t\t\ty = pos.y;\n\t\t\t\tpos = pos.x;\n\t\t\t}\n\t\t\tthis.initWithPosition(pos, y);\n\t\t}\n    },\n\n    /*\n     * Initializes a Place action with a position\n     * @param {number} x\n     * @param {number} y\n     * @return {Boolean}\n     */\n    initWithPosition: function (x, y) {\n        this._x = x;\n        this._y = y;\n        return true;\n    },\n\n    update:function (dt) {\n        this.target.setPosition(this._x, this._y);\n    },\n\n    clone:function(){\n        var action = new cc.Place();\n        action.initWithPosition(this._x, this._y);\n        return action;\n    }\n});\n\n/**\n * !#en Creates a Place action with a position.\n * !#zh 放置在目标位置。\n * @method place\n * @param {Vec2|Number} pos\n * @param {Number} [y]\n * @return {ActionInstant}\n * @example\n * // example\n * var placeAction = cc.place(cc.v2(200, 200));\n * var placeAction = cc.place(200, 200);\n */\ncc.place = function (pos, y) {\n    return new cc.Place(pos, y);\n};\n\n\n/*\n * Calls a 'callback'.\n * @class CallFunc\n * @extends ActionInstant\n * @param {function} selector\n * @param {object} [selectorTarget=null]\n * @param {*} [data=null] data for function, it accepts all data types.\n * @example\n * // example\n * // CallFunc without data\n * var finish = new cc.CallFunc(this.removeSprite, this);\n *\n * // CallFunc with data\n * var finish = new cc.CallFunc(this.removeFromParentAndCleanup, this,  true);\n */\ncc.CallFunc = cc.Class({\n    name: 'cc.CallFunc',\n    extends: cc.ActionInstant,\n\n    /*\n     * Constructor function, override it to extend the construction behavior, remember to call \"this._super()\" in the extended \"ctor\" function. <br />\n\t * Creates a CallFunc action with the callback.\n\t * @param {function} selector\n\t * @param {object} [selectorTarget=null]\n\t * @param {*} [data=null] data for function, it accepts all data types.\n\t */\n    ctor:function(selector, selectorTarget, data){\n        this._selectorTarget = null;\n        this._function = null;\n        this._data = null;\n        this.initWithFunction(selector, selectorTarget, data);\n    },\n\n    /*\n     * Initializes the action with a function or function and its target\n     * @param {function} selector\n     * @param {object|Null} selectorTarget\n     * @param {*|Null} [data] data for function, it accepts all data types.\n     * @return {Boolean}\n     */\n    initWithFunction:function (selector, selectorTarget, data) {\n        if (selector) {\n            this._function = selector;\n        }\n        if (selectorTarget) {\n            this._selectorTarget = selectorTarget;\n        }\n        if (data !== undefined) {\n            this._data = data;\n        }\n        return true;\n    },\n\n    /*\n     * execute the function.\n     */\n    execute:function () {\n        if (this._function) {\n            this._function.call(this._selectorTarget, this.target, this._data);\n        }\n    },\n\n    update:function (dt) {\n        this.execute();\n    },\n\n    /*\n     * Get selectorTarget.\n     * @return {object}\n     */\n    getTargetCallback:function () {\n        return this._selectorTarget;\n    },\n\n    /*\n     * Set selectorTarget.\n     * @param {object} sel\n     */\n    setTargetCallback:function (sel) {\n        if (sel !== this._selectorTarget) {\n            if (this._selectorTarget)\n                this._selectorTarget = null;\n            this._selectorTarget = sel;\n        }\n    },\n\n    clone:function(){\n        var action = new cc.CallFunc();\n        action.initWithFunction(this._function, this._selectorTarget, this._data);\n        return action;\n    }\n});\n\n/**\n * !#en Creates the action with the callback.\n * !#zh 执行回调函数。\n * @method callFunc\n * @param {function} selector\n * @param {object} [selectorTarget=null]\n * @param {*} [data=null] - data for function, it accepts all data types.\n * @return {ActionInstant}\n * @example\n * // example\n * // CallFunc without data\n * var finish = cc.callFunc(this.removeSprite, this);\n *\n * // CallFunc with data\n * var finish = cc.callFunc(this.removeFromParentAndCleanup, this._grossini,  true);\n */\ncc.callFunc = function (selector, selectorTarget, data) {\n    return new cc.CallFunc(selector, selectorTarget, data);\n};\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n\n/**\n * @module cc\n */\n\n/**\n * !#en\n * <p> An interval action is an action that takes place within a certain period of time. <br/>\n * It has an start time, and a finish time. The finish time is the parameter<br/>\n * duration plus the start time.</p>\n *\n * <p>These CCActionInterval actions have some interesting properties, like:<br/>\n * - They can run normally (default)  <br/>\n * - They can run reversed with the reverse method   <br/>\n * - They can run with the time altered with the Accelerate, AccelDeccel and Speed actions. </p>\n *\n * <p>For example, you can simulate a Ping Pong effect running the action normally and<br/>\n * then running it again in Reverse mode. </p>\n * !#zh 时间间隔动作，这种动作在已定时间内完成，继承 FiniteTimeAction。\n * @class ActionInterval\n * @extends FiniteTimeAction\n * @param {Number} d duration in seconds\n */\ncc.ActionInterval = cc.Class({\n    name: 'cc.ActionInterval',\n    extends: cc.FiniteTimeAction,\n\n    ctor:function (d) {\n        this.MAX_VALUE = 2;\n        this._elapsed = 0;\n        this._firstTick = false;\n        this._easeList = null;\n        this._speed = 1;\n        this._timesForRepeat = 1;\n        this._repeatForever = false;\n        this._repeatMethod = false;//Compatible with repeat class, Discard after can be deleted\n        this._speedMethod = false;//Compatible with repeat class, Discard after can be deleted\n        d !== undefined && cc.ActionInterval.prototype.initWithDuration.call(this, d);\n    },\n\n    /*\n     * How many seconds had elapsed since the actions started to run.\n     * @return {Number}\n     */\n    getElapsed:function () {\n        return this._elapsed;\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} d duration in seconds\n     * @return {Boolean}\n     */\n    initWithDuration:function (d) {\n        this._duration = (d === 0) ? cc.macro.FLT_EPSILON : d;\n        // prevent division by 0\n        // This comparison could be in step:, but it might decrease the performance\n        // by 3% in heavy based action games.\n        this._elapsed = 0;\n        this._firstTick = true;\n        return true;\n    },\n\n    isDone:function () {\n        return (this._elapsed >= this._duration);\n    },\n\n    _cloneDecoration: function(action){\n        action._repeatForever = this._repeatForever;\n        action._speed = this._speed;\n        action._timesForRepeat = this._timesForRepeat;\n        action._easeList = this._easeList;\n        action._speedMethod = this._speedMethod;\n        action._repeatMethod = this._repeatMethod;\n    },\n\n    _reverseEaseList: function(action){\n        if(this._easeList){\n            action._easeList = [];\n            for(var i=0; i<this._easeList.length; i++){\n                action._easeList.push(this._easeList[i].reverse());\n            }\n        }\n    },\n\n    clone:function () {\n        var action = new cc.ActionInterval(this._duration);\n        this._cloneDecoration(action);\n        return action;\n    },\n\n    /**\n     * !#en Implementation of ease motion.\n     * !#zh 缓动运动。\n     * @method easing\n     * @param {Object} easeObj\n     * @returns {ActionInterval}\n     * @example\n     * action.easing(cc.easeIn(3.0));\n     */\n    easing: function (easeObj) {\n        if (this._easeList)\n            this._easeList.length = 0;\n        else\n            this._easeList = [];\n        for (var i = 0; i < arguments.length; i++)\n            this._easeList.push(arguments[i]);\n        return this;\n    },\n\n    _computeEaseTime: function (dt) {\n        var locList = this._easeList;\n        if ((!locList) || (locList.length === 0))\n            return dt;\n        for (var i = 0, n = locList.length; i < n; i++)\n            dt = locList[i].easing(dt);\n        return dt;\n    },\n\n    step:function (dt) {\n        if (this._firstTick) {\n            this._firstTick = false;\n            this._elapsed = 0;\n        } else\n            this._elapsed += dt;\n\n        //this.update((1 > (this._elapsed / this._duration)) ? this._elapsed / this._duration : 1);\n        //this.update(Math.max(0, Math.min(1, this._elapsed / Math.max(this._duration, cc.macro.FLT_EPSILON))));\n        var t = this._elapsed / (this._duration > 0.0000001192092896 ? this._duration : 0.0000001192092896);\n        t = (1 > t ? t : 1);\n        this.update(t > 0 ? t : 0);\n\n        //Compatible with repeat class, Discard after can be deleted (this._repeatMethod)\n        if(this._repeatMethod && this._timesForRepeat > 1 && this.isDone()){\n            if(!this._repeatForever){\n                this._timesForRepeat--;\n            }\n            //var diff = locInnerAction.getElapsed() - locInnerAction._duration;\n            this.startWithTarget(this.target);\n            // to prevent jerk. issue #390 ,1247\n            //this._innerAction.step(0);\n            //this._innerAction.step(diff);\n            this.step(this._elapsed - this._duration);\n\n        }\n    },\n\n    startWithTarget:function (target) {\n        cc.Action.prototype.startWithTarget.call(this, target);\n        this._elapsed = 0;\n        this._firstTick = true;\n    },\n\n    reverse:function () {\n        cc.logID(1010);\n        return null;\n    },\n\n    /*\n     * Set amplitude rate.\n     * @warning It should be overridden in subclass.\n     * @param {Number} amp\n     */\n    setAmplitudeRate:function (amp) {\n        // Abstract class needs implementation\n        cc.logID(1011);\n    },\n\n    /*\n     * Get amplitude rate.\n     * @warning It should be overridden in subclass.\n     * @return {Number} 0\n     */\n    getAmplitudeRate:function () {\n        // Abstract class needs implementation\n        cc.logID(1012);\n        return 0;\n    },\n\n    /**\n     * !#en\n     * Changes the speed of an action, making it take longer (speed>1)\n     * or less (speed<1) time. <br/>\n     * Useful to simulate 'slow motion' or 'fast forward' effect.\n     * !#zh\n     * 改变一个动作的速度，使它的执行使用更长的时间（speed > 1）<br/>\n     * 或更少（speed < 1）可以有效得模拟“慢动作”或“快进”的效果。\n     * @param {Number} speed\n     * @returns {Action}\n     */\n    speed: function(speed){\n        if(speed <= 0){\n            cc.logID(1013);\n            return this;\n        }\n\n        this._speedMethod = true;//Compatible with repeat class, Discard after can be deleted\n        this._speed *= speed;\n        return this;\n    },\n\n    /**\n     * Get this action speed.\n     * @return {Number}\n     */\n    getSpeed: function(){\n        return this._speed;\n    },\n\n    /**\n     * Set this action speed.\n     * @param {Number} speed\n     * @returns {ActionInterval}\n     */\n    setSpeed: function(speed){\n        this._speed = speed;\n        return this;\n    },\n\n    /**\n     * !#en\n     * Repeats an action a number of times.\n     * To repeat an action forever use the CCRepeatForever action.\n     * !#zh 重复动作可以按一定次数重复一个动作，使用 RepeatForever 动作来永远重复一个动作。\n     * @method repeat\n     * @param {Number} times\n     * @returns {ActionInterval}\n     */\n    repeat: function(times){\n        times = Math.round(times);\n        if(isNaN(times) || times < 1){\n            cc.logID(1014);\n            return this;\n        }\n        this._repeatMethod = true;//Compatible with repeat class, Discard after can be deleted\n        this._timesForRepeat *= times;\n        return this;\n    },\n\n    /**\n     * !#en\n     * Repeats an action for ever.  <br/>\n     * To repeat the an action for a limited number of times use the Repeat action. <br/>\n     * !#zh 永远地重复一个动作，有限次数内重复一个动作请使用 Repeat 动作。\n     * @method repeatForever\n     * @returns {ActionInterval}\n     */\n    repeatForever: function(){\n        this._repeatMethod = true;//Compatible with repeat class, Discard after can be deleted\n        this._timesForRepeat = this.MAX_VALUE;\n        this._repeatForever = true;\n        return this;\n    }\n});\n\ncc.actionInterval = function (d) {\n    return new cc.ActionInterval(d);\n};\n\n/**\n * @module cc\n */\n\n/*\n * Runs actions sequentially, one after another.\n * @class Sequence\n * @extends ActionInterval\n * @param {Array|FiniteTimeAction} tempArray\n * @example\n * // create sequence with actions\n * var seq = new cc.Sequence(act1, act2);\n *\n * // create sequence with array\n * var seq = new cc.Sequence(actArray);\n */\ncc.Sequence = cc.Class({\n    name: 'cc.Sequence',\n    extends: cc.ActionInterval,\n\n    ctor:function (tempArray) {\n        this._actions = [];\n        this._split = null;\n        this._last = 0;\n        this._reversed = false;\n\n        var paramArray = (tempArray instanceof Array) ? tempArray : arguments;\n        if (paramArray.length === 1) {\n            cc.errorID(1019);\n            return;\n        }\n        var last = paramArray.length - 1;\n        if ((last >= 0) && (paramArray[last] == null))\n            cc.logID(1015);\n\n        if (last >= 0) {\n            var prev = paramArray[0], action1;\n            for (var i = 1; i < last; i++) {\n                if (paramArray[i]) {\n                    action1 = prev;\n                    prev = cc.Sequence._actionOneTwo(action1, paramArray[i]);\n                }\n            }\n            this.initWithTwoActions(prev, paramArray[last]);\n        }\n    },\n\n    /*\n     * Initializes the action <br/>\n     * @param {FiniteTimeAction} actionOne\n     * @param {FiniteTimeAction} actionTwo\n     * @return {Boolean}\n     */\n    initWithTwoActions:function (actionOne, actionTwo) {\n        if (!actionOne || !actionTwo) {\n            cc.errorID(1025);\n            return false;\n        }\n\n        var durationOne = actionOne._duration, durationTwo = actionTwo._duration;\n        durationOne *= actionOne._repeatMethod ? actionOne._timesForRepeat : 1;\n        durationTwo *= actionTwo._repeatMethod ? actionTwo._timesForRepeat : 1;\n        var d = durationOne + durationTwo;\n        this.initWithDuration(d);\n\n        this._actions[0] = actionOne;\n        this._actions[1] = actionTwo;\n        return true;\n    },\n\n    clone:function () {\n        var action = new cc.Sequence();\n        this._cloneDecoration(action);\n        action.initWithTwoActions(this._actions[0].clone(), this._actions[1].clone());\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        this._split = this._actions[0]._duration / this._duration;\n        this._split *= this._actions[0]._repeatMethod ? this._actions[0]._timesForRepeat : 1;\n        this._last = -1;\n    },\n\n    stop:function () {\n        // Issue #1305\n        if (this._last !== -1)\n            this._actions[this._last].stop();\n        cc.Action.prototype.stop.call(this);\n    },\n\n    update:function (dt) {\n        var new_t, found = 0;\n        var locSplit = this._split, locActions = this._actions, locLast = this._last, actionFound;\n\n        dt = this._computeEaseTime(dt);\n        if (dt < locSplit) {\n            // action[0]\n            new_t = (locSplit !== 0) ? dt / locSplit : 1;\n\n            if (found === 0 && locLast === 1 && this._reversed) {\n                // Reverse mode ?\n                // XXX: Bug. this case doesn't contemplate when _last==-1, found=0 and in \"reverse mode\"\n                // since it will require a hack to know if an action is on reverse mode or not.\n                // \"step\" should be overriden, and the \"reverseMode\" value propagated to inner Sequences.\n                locActions[1].update(0);\n                locActions[1].stop();\n            }\n        } else {\n            // action[1]\n            found = 1;\n            new_t = (locSplit === 1) ? 1 : (dt - locSplit) / (1 - locSplit);\n\n            if (locLast === -1) {\n                // action[0] was skipped, execute it.\n                locActions[0].startWithTarget(this.target);\n                locActions[0].update(1);\n                locActions[0].stop();\n            }\n            if (locLast === 0) {\n                // switching to action 1. stop action 0.\n                locActions[0].update(1);\n                locActions[0].stop();\n            }\n        }\n\n        actionFound = locActions[found];\n        // Last action found and it is done.\n        if (locLast === found && actionFound.isDone())\n            return;\n\n        // Last action not found\n        if (locLast !== found)\n            actionFound.startWithTarget(this.target);\n\n        new_t = new_t * actionFound._timesForRepeat;\n        actionFound.update(new_t > 1 ? new_t % 1 : new_t);\n        this._last = found;\n    },\n\n    reverse:function () {\n        var action = cc.Sequence._actionOneTwo(this._actions[1].reverse(), this._actions[0].reverse());\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        action._reversed = true;\n        return action;\n    }\n});\n\n/**\n * !#en\n * Helper constructor to create an array of sequenceable actions\n * The created action will run actions sequentially, one after another.\n * !#zh 顺序执行动作，创建的动作将按顺序依次运行。\n * @method sequence\n * @param {FiniteTimeAction|FiniteTimeAction[]} actionOrActionArray\n * @param {FiniteTimeAction} ...tempArray\n * @return {ActionInterval}\n * @example\n * // example\n * // create sequence with actions\n * var seq = cc.sequence(act1, act2);\n *\n * // create sequence with array\n * var seq = cc.sequence(actArray);\n */\n// todo: It should be use new\ncc.sequence = function (/*Multiple Arguments*/tempArray) {\n    var paramArray = (tempArray instanceof Array) ? tempArray : arguments;\n    if (paramArray.length === 1) {\n        cc.errorID(1019);\n        return null;\n    }\n    var last = paramArray.length - 1;\n    if ((last >= 0) && (paramArray[last] == null))\n        cc.logID(1015);\n\n    var result = null;\n    if (last >= 0) {\n        result = paramArray[0];\n        for (var i = 1; i <= last; i++) {\n            if (paramArray[i]) {\n                result = cc.Sequence._actionOneTwo(result, paramArray[i]);\n            }\n        }\n    }\n\n    return result;\n};\n\ncc.Sequence._actionOneTwo = function (actionOne, actionTwo) {\n    var sequence = new cc.Sequence();\n    sequence.initWithTwoActions(actionOne, actionTwo);\n    return sequence;\n};\n\n/*\n * Repeats an action a number of times.\n * To repeat an action forever use the CCRepeatForever action.\n * @class Repeat\n * @extends ActionInterval\n * @param {FiniteTimeAction} action\n * @param {Number} times\n * @example\n * var rep = new cc.Repeat(cc.sequence(jump2, jump1), 5);\n */\ncc.Repeat = cc.Class({\n    name: 'cc.Repeat',\n    extends: cc.ActionInterval,\n\n    ctor: function (action, times) {\n        this._times = 0;\n        this._total = 0;\n        this._nextDt = 0;\n        this._actionInstant = false;\n        this._innerAction = null;\n\t\ttimes !== undefined && this.initWithAction(action, times);\n    },\n\n    /*\n     * @param {FiniteTimeAction} action\n     * @param {Number} times\n     * @return {Boolean}\n     */\n    initWithAction:function (action, times) {\n        var duration = action._duration * times;\n\n        if (this.initWithDuration(duration)) {\n            this._times = times;\n            this._innerAction = action;\n            if (action instanceof cc.ActionInstant){\n                this._actionInstant = true;\n                this._times -= 1;\n            }\n            this._total = 0;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.Repeat();\n        this._cloneDecoration(action);\n        action.initWithAction(this._innerAction.clone(), this._times);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        this._total = 0;\n        this._nextDt = this._innerAction._duration / this._duration;\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        this._innerAction.startWithTarget(target);\n    },\n\n    stop:function () {\n        this._innerAction.stop();\n        cc.Action.prototype.stop.call(this);\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        var locInnerAction = this._innerAction;\n        var locDuration = this._duration;\n        var locTimes = this._times;\n        var locNextDt = this._nextDt;\n\n        if (dt >= locNextDt) {\n            while (dt > locNextDt && this._total < locTimes) {\n                locInnerAction.update(1);\n                this._total++;\n                locInnerAction.stop();\n                locInnerAction.startWithTarget(this.target);\n                locNextDt += locInnerAction._duration / locDuration;\n                this._nextDt = locNextDt > 1 ? 1 : locNextDt;\n            }\n\n            // fix for issue #1288, incorrect end value of repeat\n            if (dt >= 1.0 && this._total < locTimes) {\n                // fix for cocos-creator/fireball/issues/4310\n                locInnerAction.update(1);\n                this._total++;\n            }\n\n            // don't set a instant action back or update it, it has no use because it has no duration\n            if (!this._actionInstant) {\n                if (this._total === locTimes) {\n                    locInnerAction.stop();\n                } else {\n                    // issue #390 prevent jerk, use right update\n                    locInnerAction.update(dt - (locNextDt - locInnerAction._duration / locDuration));\n                }\n            }\n        } else {\n            locInnerAction.update((dt * locTimes) % 1.0);\n        }\n    },\n\n    isDone:function () {\n        return this._total === this._times;\n    },\n\n    reverse:function () {\n        var action = new cc.Repeat(this._innerAction.reverse(), this._times);\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    },\n\n    /*\n     * Set inner Action.\n     * @param {FiniteTimeAction} action\n     */\n    setInnerAction:function (action) {\n        if (this._innerAction !== action) {\n            this._innerAction = action;\n        }\n    },\n\n    /*\n     * Get inner Action.\n     * @return {FiniteTimeAction}\n     */\n    getInnerAction:function () {\n        return this._innerAction;\n    }\n});\n\n/**\n * !#en Creates a Repeat action. Times is an unsigned integer between 1 and pow(2,30)\n * !#zh 重复动作，可以按一定次数重复一个动，如果想永远重复一个动作请使用 repeatForever 动作来完成。\n * @method repeat\n * @param {FiniteTimeAction} action\n * @param {Number} times\n * @return {ActionInterval}\n * @example\n * // example\n * var rep = cc.repeat(cc.sequence(jump2, jump1), 5);\n */\ncc.repeat = function (action, times) {\n    return new cc.Repeat(action, times);\n};\n\n\n/*\n * Repeats an action for ever.  <br/>\n * To repeat the an action for a limited number of times use the Repeat action. <br/>\n * @warning This action can't be Sequenceable because it is not an IntervalAction\n * @class RepeatForever\n * @extends ActionInterval\n * @param {FiniteTimeAction} action\n * @example\n * var rep = new cc.RepeatForever(cc.sequence(jump2, jump1), 5);\n */\ncc.RepeatForever = cc.Class({\n    name: 'cc.RepeatForever',\n    extends: cc.ActionInterval,\n\n    ctor:function (action) {\n        this._innerAction = null;\n\t\taction && this.initWithAction(action);\n    },\n\n    /*\n     * @param {ActionInterval} action\n     * @return {Boolean}\n     */\n    initWithAction:function (action) {\n        if (!action) {\n            cc.errorID(1026);\n            return false;\n        }\n\n        this._innerAction = action;\n        return true;\n    },\n\n    clone:function () {\n        var action = new cc.RepeatForever();\n        this._cloneDecoration(action);\n        action.initWithAction(this._innerAction.clone());\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        this._innerAction.startWithTarget(target);\n    },\n\n    step:function (dt) {\n        var locInnerAction = this._innerAction;\n        locInnerAction.step(dt);\n        if (locInnerAction.isDone()) {\n            //var diff = locInnerAction.getElapsed() - locInnerAction._duration;\n            locInnerAction.startWithTarget(this.target);\n            // to prevent jerk. issue #390 ,1247\n            //this._innerAction.step(0);\n            //this._innerAction.step(diff);\n            locInnerAction.step(locInnerAction.getElapsed() - locInnerAction._duration);\n        }\n    },\n\n    isDone:function () {\n        return false;\n    },\n\n    reverse:function () {\n        var action = new cc.RepeatForever(this._innerAction.reverse());\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    },\n\n    /*\n     * Set inner action.\n     * @param {ActionInterval} action\n     */\n    setInnerAction:function (action) {\n        if (this._innerAction !== action) {\n            this._innerAction = action;\n        }\n    },\n\n    /*\n     * Get inner action.\n     * @return {ActionInterval}\n     */\n    getInnerAction:function () {\n        return this._innerAction;\n    }\n});\n\n/**\n * !#en Create a acton which repeat forever, as it runs forever, it can't be added into cc.sequence and cc.spawn.\n * !#zh 永远地重复一个动作，有限次数内重复一个动作请使用 repeat 动作，由于这个动作不会停止，所以不能被添加到 cc.sequence 或 cc.spawn 中。\n * @method repeatForever\n * @param {FiniteTimeAction} action\n * @return {ActionInterval}\n * @example\n * // example\n * var repeat = cc.repeatForever(cc.rotateBy(1.0, 360));\n */\ncc.repeatForever = function (action) {\n    return new cc.RepeatForever(action);\n};\n\n\n/* \n * Spawn a new action immediately\n * @class Spawn\n * @extends ActionInterval\n */\ncc.Spawn = cc.Class({\n    name: 'cc.Spawn',\n    extends: cc.ActionInterval,\n\n    ctor:function (tempArray) {\n        this._one = null;\n        this._two = null;\n\n\t\tvar paramArray = (tempArray instanceof Array) ? tempArray : arguments;\n        if (paramArray.length === 1) {\n            cc.errorID(1020);\n            return;\n        }\n\t\tvar last = paramArray.length - 1;\n\t\tif ((last >= 0) && (paramArray[last] == null))\n\t\t\tcc.logID(1015);\n\n        if (last >= 0) {\n            var prev = paramArray[0], action1;\n            for (var i = 1; i < last; i++) {\n                if (paramArray[i]) {\n                    action1 = prev;\n                    prev = cc.Spawn._actionOneTwo(action1, paramArray[i]);\n                }\n            }\n            this.initWithTwoActions(prev, paramArray[last]);\n        }\n    },\n\n    /* initializes the Spawn action with the 2 actions to spawn\n     * @param {FiniteTimeAction} action1\n     * @param {FiniteTimeAction} action2\n     * @return {Boolean}\n     */\n    initWithTwoActions:function (action1, action2) {\n        if (!action1 || !action2) {\n            cc.errorID(1027);\n            return false;\n        }\n\n        var ret = false;\n\n        var d1 = action1._duration;\n        var d2 = action2._duration;\n\n        if (this.initWithDuration(Math.max(d1, d2))) {\n            this._one = action1;\n            this._two = action2;\n\n            if (d1 > d2) {\n                this._two = cc.Sequence._actionOneTwo(action2, cc.delayTime(d1 - d2));\n            } else if (d1 < d2) {\n                this._one = cc.Sequence._actionOneTwo(action1, cc.delayTime(d2 - d1));\n            }\n\n            ret = true;\n        }\n        return ret;\n    },\n\n    clone:function () {\n        var action = new cc.Spawn();\n        this._cloneDecoration(action);\n        action.initWithTwoActions(this._one.clone(), this._two.clone());\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        this._one.startWithTarget(target);\n        this._two.startWithTarget(target);\n    },\n\n    stop:function () {\n        this._one.stop();\n        this._two.stop();\n        cc.Action.prototype.stop.call(this);\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        if (this._one)\n            this._one.update(dt);\n        if (this._two)\n            this._two.update(dt);\n    },\n\n    reverse:function () {\n        var action = cc.Spawn._actionOneTwo(this._one.reverse(), this._two.reverse());\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    }\n});\n\n/**\n * !#en Create a spawn action which runs several actions in parallel.\n * !#zh 同步执行动作，同步执行一组动作。\n * @method spawn\n * @param {FiniteTimeAction|FiniteTimeAction[]} actionOrActionArray\n * @param {FiniteTimeAction} ...tempArray\n * @return {FiniteTimeAction}\n * @example\n * // example\n * var action = cc.spawn(cc.jumpBy(2, cc.v2(300, 0), 50, 4), cc.rotateBy(2, 720));\n * todo:It should be the direct use new\n */\ncc.spawn = function (/*Multiple Arguments*/tempArray) {\n    var paramArray = (tempArray instanceof Array) ? tempArray : arguments;\n    if (paramArray.length === 1) {\n        cc.errorID(1020);\n        return null;\n    }\n    if ((paramArray.length > 0) && (paramArray[paramArray.length - 1] == null))\n        cc.logID(1015);\n\n    var prev = paramArray[0];\n    for (var i = 1; i < paramArray.length; i++) {\n        if (paramArray[i] != null)\n            prev = cc.Spawn._actionOneTwo(prev, paramArray[i]);\n    }\n    return prev;\n};\n\ncc.Spawn._actionOneTwo = function (action1, action2) {\n    var pSpawn = new cc.Spawn();\n    pSpawn.initWithTwoActions(action1, action2);\n    return pSpawn;\n};\n\n\n/*\n * Rotates a Node object to a certain angle by modifying its angle property. <br/>\n * The direction will be decided by the shortest angle.\n * @class RotateTo\n * @extends ActionInterval\n * @param {Number} duration duration in seconds\n * @param {Number} dstAngle dstAngle in degrees.\n * @example\n * var rotateTo = new cc.RotateTo(2, 61.0);\n */\ncc.RotateTo = cc.Class({\n    name: 'cc.RotateTo',\n    extends: cc.ActionInterval,\n\n    ctor:function (duration, dstAngle) {\n        this._startAngle = 0;\n        this._dstAngle = 0;\n        this._angle = 0;\n        dstAngle !== undefined && this.initWithDuration(duration, dstAngle);\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} duration\n     * @param {Number} dstAngle\n     * @return {Boolean}\n     */\n    initWithDuration:function (duration, dstAngle) {\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, duration)) {\n            this._dstAngle = dstAngle;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.RotateTo();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._dstAngle);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n\n        let startAngle = target.angle % 360;\n\n        let angle = cc.macro.ROTATE_ACTION_CCW ? (this._dstAngle - startAngle) : (this._dstAngle + startAngle);\n        if (angle > 180) angle -= 360;\n        if (angle < -180) angle += 360;\n\n        this._startAngle = startAngle;\n        this._angle = cc.macro.ROTATE_ACTION_CCW ? angle : -angle;\n    },\n\n    reverse:function () {\n        cc.logID(1016);\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        if (this.target) {\n            this.target.angle = this._startAngle + this._angle * dt;\n        }\n    }\n});\n\n/**\n * !#en\n * Rotates a Node object to a certain angle by modifying its angle property. <br/>\n * The direction will be decided by the shortest angle.\n * !#zh 旋转到目标角度，通过逐帧修改它的 angle 属性，旋转方向将由最短的角度决定。\n * @method rotateTo\n * @param {Number} duration duration in seconds\n * @param {Number} dstAngle dstAngle in degrees.\n * @return {ActionInterval}\n * @example\n * // example\n * var rotateTo = cc.rotateTo(2, 61.0);\n */\ncc.rotateTo = function (duration, dstAngle) {\n    return new cc.RotateTo(duration, dstAngle);\n};\n\n\n/*\n * Rotates a Node object clockwise a number of degrees by modifying its angle property.\n * Relative to its properties to modify.\n * @class RotateBy\n * @extends ActionInterval\n * @param {Number} duration duration in seconds\n * @param {Number} deltaAngle deltaAngle in degrees\n * @example\n * var actionBy = new cc.RotateBy(2, 360);\n */\ncc.RotateBy = cc.Class({\n    name: 'cc.RotateBy',\n    extends: cc.ActionInterval,\n\n    ctor: function (duration, deltaAngle) {\n        deltaAngle *= cc.macro.ROTATE_ACTION_CCW ? 1 : -1;\n\n        this._deltaAngle = 0;\n        this._startAngle = 0;\n        deltaAngle !== undefined && this.initWithDuration(duration, deltaAngle);\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} duration duration in seconds\n     * @param {Number} deltaAngle deltaAngle in degrees\n     * @return {Boolean}\n     */\n    initWithDuration:function (duration, deltaAngle) {\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, duration)) {\n            this._deltaAngle = deltaAngle;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.RotateBy();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._deltaAngle);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        this._startAngle = target.angle;\n        this._deltaAngle *= -1;\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        if (this.target) {\n            this.target.angle = this._startAngle + this._deltaAngle * dt;\n        }\n    },\n\n    reverse:function () {\n        var action = new cc.RotateBy();\n        action.initWithDuration(this._duration, -this._deltaAngle);\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    }\n});\n\n/**\n * !#en\n * Rotates a Node object clockwise a number of degrees by modifying its angle property.\n * Relative to its properties to modify.\n * !#zh 旋转指定的角度。\n * @method rotateBy\n * @param {Number} duration duration in seconds\n * @param {Number} deltaAngle deltaAngle in degrees\n * @return {ActionInterval}\n * @example\n * // example\n * var actionBy = cc.rotateBy(2, 360);\n */\ncc.rotateBy = function (duration, deltaAngle) {\n    return new cc.RotateBy(duration, deltaAngle);\n};\n\n\n/*\n * <p>\n * Moves a Node object x,y pixels by modifying its position property.                                  <br/>\n * x and y are relative to the position of the object.                                                     <br/>\n * Several MoveBy actions can be concurrently called, and the resulting                                  <br/>\n * movement will be the sum of individual movements.\n * </p>\n * @class MoveBy\n * @extends ActionInterval\n * @param {Number} duration duration in seconds\n * @param {Vec2|Number} deltaPos\n * @param {Number} [deltaY]\n * @example\n * var actionTo = cc.moveBy(2, cc.v2(windowSize.width - 40, windowSize.height - 40));\n */\ncc.MoveBy = cc.Class({\n    name: 'cc.MoveBy',\n    extends: cc.ActionInterval,\n\n    ctor:function (duration, deltaPos, deltaY) {\n        this._positionDelta = cc.v2(0, 0);\n        this._startPosition = cc.v2(0, 0);\n        this._previousPosition = cc.v2(0, 0);\n\n        deltaPos !== undefined && cc.MoveBy.prototype.initWithDuration.call(this, duration, deltaPos, deltaY);\t\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} duration duration in seconds\n     * @param {Vec2} position\n     * @param {Number} [y]\n     * @return {Boolean}\n     */\n    initWithDuration:function (duration, position, y) {\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, duration)) {\n\t        if(position.x !== undefined) {\n\t\t        y = position.y;\n\t\t        position = position.x;\n\t        }\n\n            this._positionDelta.x = position;\n            this._positionDelta.y = y;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.MoveBy();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._positionDelta);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        var locPosX = target.x;\n        var locPosY = target.y;\n        this._previousPosition.x = locPosX;\n        this._previousPosition.y = locPosY;\n        this._startPosition.x = locPosX;\n        this._startPosition.y = locPosY;\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        if (this.target) {\n            var x = this._positionDelta.x * dt;\n            var y = this._positionDelta.y * dt;\n            var locStartPosition = this._startPosition;\n            if (cc.macro.ENABLE_STACKABLE_ACTIONS) {\n                var targetX = this.target.x;\n                var targetY = this.target.y;\n                var locPreviousPosition = this._previousPosition;\n\n                locStartPosition.x = locStartPosition.x + targetX - locPreviousPosition.x;\n                locStartPosition.y = locStartPosition.y + targetY - locPreviousPosition.y;\n                x = x + locStartPosition.x;\n                y = y + locStartPosition.y;\n\t            locPreviousPosition.x = x;\n\t            locPreviousPosition.y = y;\n\t            this.target.setPosition(x, y);\n            } else {\n                this.target.setPosition(locStartPosition.x + x, locStartPosition.y + y);\n            }\n        }\n    },\n\n    reverse:function () {\n        var action = new cc.MoveBy(this._duration, cc.v2(-this._positionDelta.x, -this._positionDelta.y));\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    }\n});\n\n/**\n * !#en\n * Moves a Node object x,y pixels by modifying its position property.                                  <br/>\n * x and y are relative to the position of the object.                                                     <br/>\n * Several MoveBy actions can be concurrently called, and the resulting                                  <br/>\n * movement will be the sum of individual movements.\n * !#zh 移动指定的距离。\n * @method moveBy\n * @param {Number} duration duration in seconds\n * @param {Vec2|Number} deltaPos\n * @param {Number} [deltaY]\n * @return {ActionInterval}\n * @example\n * // example\n * var actionTo = cc.moveBy(2, cc.v2(windowSize.width - 40, windowSize.height - 40));\n */\ncc.moveBy = function (duration, deltaPos, deltaY) {\n    return new cc.MoveBy(duration, deltaPos, deltaY);\n};\n\n\n/*\n * Moves a Node object to the position x,y. x and y are absolute coordinates by modifying its position property. <br/>\n * Several MoveTo actions can be concurrently called, and the resulting                                            <br/>\n * movement will be the sum of individual movements.\n * @class MoveTo\n * @extends MoveBy\n * @param {Number} duration duration in seconds\n * @param {Vec2|Number} position\n * @param {Number} [y]\n * @example\n * var actionBy = new cc.MoveTo(2, cc.v2(80, 80));\n */\ncc.MoveTo = cc.Class({\n    name: 'cc.MoveTo',\n    extends: cc.MoveBy,\n\n    ctor:function (duration, position, y) {\n        this._endPosition = cc.v2(0, 0);\n\t\tposition !== undefined && this.initWithDuration(duration, position, y);\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} duration  duration in seconds\n     * @param {Vec2} position\n     * @param {Number} [y]\n     * @return {Boolean}\n     */\n    initWithDuration:function (duration, position, y) {\n        if (cc.MoveBy.prototype.initWithDuration.call(this, duration, position, y)) {\n\t        if(position.x !== undefined) {\n\t\t        y = position.y;\n\t\t        position = position.x;\n\t        }\n\n            this._endPosition.x = position;\n            this._endPosition.y = y;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.MoveTo();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._endPosition);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.MoveBy.prototype.startWithTarget.call(this, target);\n        this._positionDelta.x = this._endPosition.x - target.x;\n        this._positionDelta.y = this._endPosition.y - target.y;\n    }\n});\n\n/**\n * !#en\n * Moves a Node object to the position x,y. x and y are absolute coordinates by modifying its position property. <br/>\n * Several MoveTo actions can be concurrently called, and the resulting                                            <br/>\n * movement will be the sum of individual movements.\n * !#zh 移动到目标位置。\n * @method moveTo\n * @param {Number} duration duration in seconds\n * @param {Vec2|Number} position\n * @param {Number} [y]\n * @return {ActionInterval}\n * @example\n * // example\n * var actionBy = cc.moveTo(2, cc.v2(80, 80));\n */\ncc.moveTo = function (duration, position, y) {\n    return new cc.MoveTo(duration, position, y);\n};\n\n/*\n * Skews a Node object to given angles by modifying its skewX and skewY properties\n * @class SkewTo\n * @extends ActionInterval\n * @param {Number} t time in seconds\n * @param {Number} sx\n * @param {Number} sy\n * @example\n * var actionTo = new cc.SkewTo(2, 37.2, -37.2);\n */\ncc.SkewTo = cc.Class({\n    name: 'cc.SkewTo',\n    extends: cc.ActionInterval,\n\n    ctor: function (t, sx, sy) {\n        this._skewX = 0;\n        this._skewY = 0;\n        this._startSkewX = 0;\n        this._startSkewY = 0;\n        this._endSkewX = 0;\n        this._endSkewY = 0;\n        this._deltaX = 0;\n        this._deltaY = 0;\n        sy !== undefined && cc.SkewTo.prototype.initWithDuration.call(this, t, sx, sy);\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} t time in seconds\n     * @param {Number} sx\n     * @param {Number} sy\n     * @return {Boolean}\n     */\n    initWithDuration:function (t, sx, sy) {\n        var ret = false;\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, t)) {\n            this._endSkewX = sx;\n            this._endSkewY = sy;\n            ret = true;\n        }\n        return ret;\n    },\n\n    clone:function () {\n        var action = new cc.SkewTo();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._endSkewX, this._endSkewY);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n\n        this._startSkewX = target.skewX % 180;\n        this._deltaX = this._endSkewX - this._startSkewX;\n        if (this._deltaX > 180)\n            this._deltaX -= 360;\n        if (this._deltaX < -180)\n            this._deltaX += 360;\n\n        this._startSkewY = target.skewY % 360;\n        this._deltaY = this._endSkewY - this._startSkewY;\n        if (this._deltaY > 180)\n            this._deltaY -= 360;\n        if (this._deltaY < -180)\n            this._deltaY += 360;\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        this.target.skewX = this._startSkewX + this._deltaX * dt;\n        this.target.skewY = this._startSkewY + this._deltaY * dt;\n    }\n});\n\n/**\n * !#en\n * Create a action which skews a Node object to given angles by modifying its skewX and skewY properties.\n * Changes to the specified value.\n * !#zh 偏斜到目标角度。\n * @method skewTo\n * @param {Number} t time in seconds\n * @param {Number} sx\n * @param {Number} sy\n * @return {ActionInterval}\n * @example\n * // example\n * var actionTo = cc.skewTo(2, 37.2, -37.2);\n */\ncc.skewTo = function (t, sx, sy) {\n    return new cc.SkewTo(t, sx, sy);\n};\n\n/*\n * Skews a Node object by skewX and skewY degrees.\n * Relative to its property modification.\n * @class SkewBy\n * @extends SkewTo\n * @param {Number} t time in seconds\n * @param {Number} sx  skew in degrees for X axis\n * @param {Number} sy  skew in degrees for Y axis\n */\ncc.SkewBy = cc.Class({\n    name: 'cc.SkewBy',\n    extends: cc.SkewTo,\n\n\tctor: function(t, sx, sy) {\n\t\tsy !== undefined && this.initWithDuration(t, sx, sy);\n\t},\n\n    /*\n     * Initializes the action.\n     * @param {Number} t time in seconds\n     * @param {Number} deltaSkewX  skew in degrees for X axis\n     * @param {Number} deltaSkewY  skew in degrees for Y axis\n     * @return {Boolean}\n     */\n    initWithDuration:function (t, deltaSkewX, deltaSkewY) {\n        var ret = false;\n        if (cc.SkewTo.prototype.initWithDuration.call(this, t, deltaSkewX, deltaSkewY)) {\n            this._skewX = deltaSkewX;\n            this._skewY = deltaSkewY;\n            ret = true;\n        }\n        return ret;\n    },\n\n    clone:function () {\n        var action = new cc.SkewBy();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._skewX, this._skewY);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.SkewTo.prototype.startWithTarget.call(this, target);\n        this._deltaX = this._skewX;\n        this._deltaY = this._skewY;\n        this._endSkewX = this._startSkewX + this._deltaX;\n        this._endSkewY = this._startSkewY + this._deltaY;\n    },\n\n    reverse:function () {\n        var action = new cc.SkewBy(this._duration, -this._skewX, -this._skewY);\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    }\n});\n\n/**\n * !#en\n * Skews a Node object by skewX and skewY degrees. <br />\n * Relative to its property modification.\n * !#zh 偏斜指定的角度。\n * @method skewBy\n * @param {Number} t time in seconds\n * @param {Number} sx sx skew in degrees for X axis\n * @param {Number} sy sy skew in degrees for Y axis\n * @return {ActionInterval}\n * @example\n * // example\n * var actionBy = cc.skewBy(2, 0, -90);\n */\ncc.skewBy = function (t, sx, sy) {\n    return new cc.SkewBy(t, sx, sy);\n};\n\n\n/*\n * Moves a Node object simulating a parabolic jump movement by modifying its position property.\n * Relative to its movement.\n * @class JumpBy\n * @extends ActionInterval\n * @param {Number} duration\n * @param {Vec2|Number} position\n * @param {Number} [y]\n * @param {Number} height\n * @param {Number} jumps\n * @example\n * var actionBy = new cc.JumpBy(2, cc.v2(300, 0), 50, 4);\n * var actionBy = new cc.JumpBy(2, 300, 0, 50, 4);\n */\ncc.JumpBy = cc.Class({\n    name: 'cc.JumpBy',\n    extends: cc.ActionInterval,\n\n    ctor:function (duration, position, y, height, jumps) {\n        this._startPosition = cc.v2(0, 0);\n        this._previousPosition = cc.v2(0, 0);\n        this._delta = cc.v2(0, 0);\n        this._height = 0;\n        this._jumps = 0;\n\n        height !== undefined && cc.JumpBy.prototype.initWithDuration.call(this, duration, position, y, height, jumps);\n    },\n    /*\n     * Initializes the action.\n     * @param {Number} duration\n     * @param {Vec2|Number} position\n     * @param {Number} [y]\n     * @param {Number} height\n     * @param {Number} jumps\n     * @return {Boolean}\n     * @example\n     * actionBy.initWithDuration(2, cc.v2(300, 0), 50, 4);\n     * actionBy.initWithDuration(2, 300, 0, 50, 4);\n     */\n    initWithDuration:function (duration, position, y, height, jumps) {\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, duration)) {\n\t        if (jumps === undefined) {\n\t\t        jumps = height;\n\t\t        height = y;\n\t\t        y = position.y;\n\t\t        position = position.x;\n\t        }\n            this._delta.x = position;\n            this._delta.y = y;\n            this._height = height;\n            this._jumps = jumps;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.JumpBy();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._delta, this._height, this._jumps);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        var locPosX = target.x;\n        var locPosY = target.y;\n        this._previousPosition.x = locPosX;\n        this._previousPosition.y = locPosY;\n        this._startPosition.x = locPosX;\n        this._startPosition.y = locPosY;\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        if (this.target) {\n            var frac = dt * this._jumps % 1.0;\n            var y = this._height * 4 * frac * (1 - frac);\n            y += this._delta.y * dt;\n\n            var x = this._delta.x * dt;\n            var locStartPosition = this._startPosition;\n            if (cc.macro.ENABLE_STACKABLE_ACTIONS) {\n                var targetX = this.target.x;\n                var targetY = this.target.y;\n                var locPreviousPosition = this._previousPosition;\n\n                locStartPosition.x = locStartPosition.x + targetX - locPreviousPosition.x;\n                locStartPosition.y = locStartPosition.y + targetY - locPreviousPosition.y;\n                x = x + locStartPosition.x;\n                y = y + locStartPosition.y;\n\t            locPreviousPosition.x = x;\n\t            locPreviousPosition.y = y;\n\t            this.target.setPosition(x, y);\n            } else {\n                this.target.setPosition(locStartPosition.x + x, locStartPosition.y + y);\n            }\n        }\n    },\n\n    reverse:function () {\n        var action = new cc.JumpBy(this._duration, cc.v2(-this._delta.x, -this._delta.y), this._height, this._jumps);\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    }\n});\n\n/**\n * !#en\n * Moves a Node object simulating a parabolic jump movement by modifying it's position property.\n * Relative to its movement.\n * !#zh 用跳跃的方式移动指定的距离。\n * @method jumpBy\n * @param {Number} duration\n * @param {Vec2|Number} position\n * @param {Number} [y]\n * @param {Number} [height]\n * @param {Number} [jumps]\n * @return {ActionInterval}\n * @example\n * // example\n * var actionBy = cc.jumpBy(2, cc.v2(300, 0), 50, 4);\n * var actionBy = cc.jumpBy(2, 300, 0, 50, 4);\n */\ncc.jumpBy = function (duration, position, y, height, jumps) {\n    return new cc.JumpBy(duration, position, y, height, jumps);\n};\n\n/*\n * Moves a Node object to a parabolic position simulating a jump movement by modifying it's position property. <br />\n * Jump to the specified location.\n * @class JumpTo\n * @extends JumpBy\n * @param {Number} duration\n * @param {Vec2|Number} position\n * @param {Number} [y]\n * @param {Number} [height]\n * @param {Number} [jumps]\n * @example\n * var actionTo = new cc.JumpTo(2, cc.v2(300, 0), 50, 4);\n * var actionTo = new cc.JumpTo(2, 300, 0, 50, 4);\n */\ncc.JumpTo = cc.Class({\n    name: 'cc.JumpTo',\n    extends: cc.JumpBy,\n\n    ctor:function (duration, position, y, height, jumps) {\n        this._endPosition = cc.v2(0, 0);\n        height !== undefined && this.initWithDuration(duration, position, y, height, jumps);\n    },\n    /*\n     * Initializes the action.\n     * @param {Number} duration\n     * @param {Vec2|Number} position\n     * @param {Number} [y]\n     * @param {Number} height\n     * @param {Number} jumps\n     * @return {Boolean}\n     * @example\n     * actionTo.initWithDuration(2, cc.v2(300, 0), 50, 4);\n     * actionTo.initWithDuration(2, 300, 0, 50, 4);\n     */\n    initWithDuration:function (duration, position, y, height, jumps) {\n        if (cc.JumpBy.prototype.initWithDuration.call(this, duration, position, y, height, jumps)) {\n            if (jumps === undefined) {\n                y = position.y;\n                position = position.x;\n            }\n            this._endPosition.x = position;\n            this._endPosition.y = y;\n            return true;\n        }\n        return false;\n    },\n\n    startWithTarget:function (target) {\n        cc.JumpBy.prototype.startWithTarget.call(this, target);\n        this._delta.x = this._endPosition.x - this._startPosition.x;\n        this._delta.y = this._endPosition.y - this._startPosition.y;\n    },\n\n    clone:function () {\n        var action = new cc.JumpTo();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._endPosition, this._height, this._jumps);\n        return action;\n    }\n});\n\n/**\n * !#en\n * Moves a Node object to a parabolic position simulating a jump movement by modifying its position property. <br />\n * Jump to the specified location.\n * !#zh 用跳跃的方式移动到目标位置。\n * @method jumpTo\n * @param {Number} duration\n * @param {Vec2|Number} position\n * @param {Number} [y]\n * @param {Number} [height]\n * @param {Number} [jumps]\n * @return {ActionInterval}\n * @example\n * // example\n * var actionTo = cc.jumpTo(2, cc.v2(300, 300), 50, 4);\n * var actionTo = cc.jumpTo(2, 300, 300, 50, 4);\n */\ncc.jumpTo = function (duration, position, y, height, jumps) {\n    return new cc.JumpTo(duration, position, y, height, jumps);\n};\n\n/* An action that moves the target with a cubic Bezier curve by a certain distance.\n * Relative to its movement.\n * @class BezierBy\n * @extends ActionInterval\n * @param {Number} t - time in seconds\n * @param {Vec2[]} c - Array of points\n * @example\n * var bezier = [cc.v2(0, windowSize.height / 2), cc.v2(300, -windowSize.height / 2), cc.v2(300, 100)];\n * var bezierForward = new cc.BezierBy(3, bezier);\n */\nfunction bezierAt (a, b, c, d, t) {\n    return (Math.pow(1 - t, 3) * a +\n        3 * t * (Math.pow(1 - t, 2)) * b +\n        3 * Math.pow(t, 2) * (1 - t) * c +\n        Math.pow(t, 3) * d );\n};\ncc.BezierBy = cc.Class({\n    name: 'cc.BezierBy',\n    extends: cc.ActionInterval,\n\n    ctor:function (t, c) {\n        this._config = [];\n        this._startPosition = cc.v2(0, 0);\n        this._previousPosition = cc.v2(0, 0);\n        c && cc.BezierBy.prototype.initWithDuration.call(this, t, c);\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} t - time in seconds\n     * @param {Vec2[]} c - Array of points\n     * @return {Boolean}\n     */\n    initWithDuration:function (t, c) {\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, t)) {\n            this._config = c;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.BezierBy();\n        this._cloneDecoration(action);\n        var newConfigs = [];\n        for (var i = 0; i < this._config.length; i++) {\n            var selConf = this._config[i];\n            newConfigs.push(cc.v2(selConf.x, selConf.y));\n        }\n        action.initWithDuration(this._duration, newConfigs);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        var locPosX = target.x;\n        var locPosY = target.y;\n        this._previousPosition.x = locPosX;\n        this._previousPosition.y = locPosY;\n        this._startPosition.x = locPosX;\n        this._startPosition.y = locPosY;\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        if (this.target) {\n            var locConfig = this._config;\n            var xa = 0;\n            var xb = locConfig[0].x;\n            var xc = locConfig[1].x;\n            var xd = locConfig[2].x;\n\n            var ya = 0;\n            var yb = locConfig[0].y;\n            var yc = locConfig[1].y;\n            var yd = locConfig[2].y;\n\n            var x = bezierAt(xa, xb, xc, xd, dt);\n            var y = bezierAt(ya, yb, yc, yd, dt);\n\n            var locStartPosition = this._startPosition;\n            if (cc.macro.ENABLE_STACKABLE_ACTIONS) {\n                var targetX = this.target.x;\n                var targetY = this.target.y;\n                var locPreviousPosition = this._previousPosition;\n\n                locStartPosition.x = locStartPosition.x + targetX - locPreviousPosition.x;\n                locStartPosition.y = locStartPosition.y + targetY - locPreviousPosition.y;\n                x = x + locStartPosition.x;\n                y = y + locStartPosition.y;\n\t            locPreviousPosition.x = x;\n\t            locPreviousPosition.y = y;\n\t            this.target.setPosition(x, y);\n            } else {\n                this.target.setPosition(locStartPosition.x + x, locStartPosition.y + y);\n            }\n        }\n    },\n\n    reverse:function () {\n        var locConfig = this._config;\n        var x0 = locConfig[0].x, y0 = locConfig[0].y;\n        var x1 = locConfig[1].x, y1 = locConfig[1].y;\n        var x2 = locConfig[2].x, y2 = locConfig[2].y;\n        var r = [\n            cc.v2(x1 - x2, y1 - y2),\n            cc.v2(x0 - x2, y0 - y2),\n            cc.v2(-x2, -y2) ];\n        var action = new cc.BezierBy(this._duration, r);\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    }\n});\n\n/**\n * !#en\n * An action that moves the target with a cubic Bezier curve by a certain distance.\n * Relative to its movement.\n * !#zh 按贝赛尔曲线轨迹移动指定的距离。\n * @method bezierBy\n * @param {Number} t - time in seconds\n * @param {Vec2[]} c - Array of points\n * @return {ActionInterval}\n * @example\n * // example\n * var bezier = [cc.v2(0, windowSize.height / 2), cc.v2(300, -windowSize.height / 2), cc.v2(300, 100)];\n * var bezierForward = cc.bezierBy(3, bezier);\n */\ncc.bezierBy = function (t, c) {\n    return new cc.BezierBy(t, c);\n};\n\n\n/* An action that moves the target with a cubic Bezier curve to a destination point.\n * @class BezierTo\n * @extends BezierBy\n * @param {Number} t\n * @param {Vec2[]} c - Array of points\n * @example\n * var bezier = [cc.v2(0, windowSize.height / 2), cc.v2(300, -windowSize.height / 2), cc.v2(300, 100)];\n * var bezierTo = new cc.BezierTo(2, bezier);\n */\ncc.BezierTo = cc.Class({\n    name: 'cc.BezierTo',\n    extends: cc.BezierBy,\n\n    ctor:function (t, c) {\n        this._toConfig = [];\n\t\tc && this.initWithDuration(t, c);\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} t time in seconds\n     * @param {Vec2[]} c - Array of points\n     * @return {Boolean}\n     */\n    initWithDuration:function (t, c) {\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, t)) {\n            this._toConfig = c;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.BezierTo();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._toConfig);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.BezierBy.prototype.startWithTarget.call(this, target);\n        var locStartPos = this._startPosition;\n        var locToConfig = this._toConfig;\n        var locConfig = this._config;\n\n        locConfig[0] = locToConfig[0].sub(locStartPos);\n        locConfig[1] = locToConfig[1].sub(locStartPos);\n        locConfig[2] = locToConfig[2].sub(locStartPos);\n    }\n});\n/**\n * !#en An action that moves the target with a cubic Bezier curve to a destination point.\n * !#zh 按贝赛尔曲线轨迹移动到目标位置。\n * @method bezierTo\n * @param {Number} t\n * @param {Vec2[]} c - Array of points\n * @return {ActionInterval}\n * @example\n * // example\n * var bezier = [cc.v2(0, windowSize.height / 2), cc.v2(300, -windowSize.height / 2), cc.v2(300, 100)];\n * var bezierTo = cc.bezierTo(2, bezier);\n */\ncc.bezierTo = function (t, c) {\n    return new cc.BezierTo(t, c);\n};\n\n\n/* Scales a Node object to a zoom factor by modifying it's scale property.\n * @warning This action doesn't support \"reverse\"\n * @class ScaleTo\n * @extends ActionInterval\n * @param {Number} duration\n * @param {Number} sx  scale parameter in X\n * @param {Number} [sy] scale parameter in Y, if Null equal to sx\n * @example\n * // It scales to 0.5 in both X and Y.\n * var actionTo = new cc.ScaleTo(2, 0.5);\n *\n * // It scales to 0.5 in x and 2 in Y\n * var actionTo = new cc.ScaleTo(2, 0.5, 2);\n */\ncc.ScaleTo = cc.Class({\n    name: 'cc.ScaleTo',\n    extends: cc.ActionInterval,\n\n    ctor:function (duration, sx, sy) {\n        this._scaleX = 1;\n        this._scaleY = 1;\n        this._startScaleX = 1;\n        this._startScaleY = 1;\n        this._endScaleX = 0;\n        this._endScaleY = 0;\n        this._deltaX = 0;\n        this._deltaY = 0;\n        sx !== undefined && cc.ScaleTo.prototype.initWithDuration.call(this, duration, sx, sy);\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} duration\n     * @param {Number} sx\n     * @param {Number} [sy=]\n     * @return {Boolean}\n     */\n    initWithDuration:function (duration, sx, sy) { //function overload here\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, duration)) {\n            this._endScaleX = sx;\n            this._endScaleY = (sy != null) ? sy : sx;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.ScaleTo();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._endScaleX, this._endScaleY);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        this._startScaleX = target.scaleX;\n        this._startScaleY = target.scaleY;\n        this._deltaX = this._endScaleX - this._startScaleX;\n        this._deltaY = this._endScaleY - this._startScaleY;\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        if (this.target) {\n            this.target.scaleX = this._startScaleX + this._deltaX * dt;\n\t        this.target.scaleY = this._startScaleY + this._deltaY * dt;\n        }\n    }\n});\n/**\n * !#en Scales a Node object to a zoom factor by modifying it's scale property.\n * !#zh 将节点大小缩放到指定的倍数。\n * @method scaleTo\n * @param {Number} duration\n * @param {Number} sx  scale parameter in X\n * @param {Number} [sy] scale parameter in Y, if Null equal to sx\n * @return {ActionInterval}\n * @example\n * // example\n * // It scales to 0.5 in both X and Y.\n * var actionTo = cc.scaleTo(2, 0.5);\n *\n * // It scales to 0.5 in x and 2 in Y\n * var actionTo = cc.scaleTo(2, 0.5, 2);\n */\ncc.scaleTo = function (duration, sx, sy) { //function overload\n    return new cc.ScaleTo(duration, sx, sy);\n};\n\n\n/* Scales a Node object a zoom factor by modifying it's scale property.\n * Relative to its changes.\n * @class ScaleBy\n * @extends ScaleTo\n */\ncc.ScaleBy = cc.Class({\n    name: 'cc.ScaleBy',\n    extends: cc.ScaleTo,\n\n    startWithTarget:function (target) {\n        cc.ScaleTo.prototype.startWithTarget.call(this, target);\n        this._deltaX = this._startScaleX * this._endScaleX - this._startScaleX;\n        this._deltaY = this._startScaleY * this._endScaleY - this._startScaleY;\n    },\n\n    reverse:function () {\n        var action = new cc.ScaleBy(this._duration, 1 / this._endScaleX, 1 / this._endScaleY);\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    },\n\n    clone:function () {\n        var action = new cc.ScaleBy();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._endScaleX, this._endScaleY);\n        return action;\n    }\n});\n/**\n * !#en\n * Scales a Node object a zoom factor by modifying it's scale property.\n * Relative to its changes.\n * !#zh 按指定的倍数缩放节点大小。\n * @method scaleBy\n * @param {Number} duration duration in seconds\n * @param {Number} sx sx  scale parameter in X\n * @param {Number|Null} [sy=] sy scale parameter in Y, if Null equal to sx\n * @return {ActionInterval}\n * @example\n * // example without sy, it scales by 2 both in X and Y\n * var actionBy = cc.scaleBy(2, 2);\n *\n * //example with sy, it scales by 0.25 in X and 4.5 in Y\n * var actionBy2 = cc.scaleBy(2, 0.25, 4.5);\n */\ncc.scaleBy = function (duration, sx, sy) {\n    return new cc.ScaleBy(duration, sx, sy);\n};\n\n/* Blinks a Node object by modifying it's visible property\n * @class Blink\n * @extends ActionInterval\n * @param {Number} duration  duration in seconds\n * @param {Number} blinks  blinks in times\n * @example\n * var action = new cc.Blink(2, 10);\n */\ncc.Blink = cc.Class({\n    name: 'cc.Blink',\n    extends: cc.ActionInterval,\n\n    ctor:function (duration, blinks) {\n        this._times = 0;\n        this._originalState = false;\n\t\tblinks !== undefined && this.initWithDuration(duration, blinks);\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} duration duration in seconds\n     * @param {Number} blinks blinks in times\n     * @return {Boolean}\n     */\n    initWithDuration:function (duration, blinks) {\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, duration)) {\n            this._times = blinks;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.Blink();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._times);\n        return action;\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        if (this.target && !this.isDone()) {\n            var slice = 1.0 / this._times;\n            var m = dt % slice;\n            this.target.opacity = (m > (slice / 2)) ? 255 : 0;\n        }\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        this._originalState = target.opacity;\n    },\n\n    stop:function () {\n        this.target.opacity = this._originalState;\n        cc.ActionInterval.prototype.stop.call(this);\n    },\n\n    reverse:function () {\n        var action = new cc.Blink(this._duration, this._times);\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    }\n});\n/**\n * !#en Blinks a Node object by modifying it's visible property.\n * !#zh 闪烁（基于透明度）。\n * @method blink\n * @param {Number} duration  duration in seconds\n * @param {Number} blinks blinks in times\n * @return {ActionInterval}\n * @example\n * // example\n * var action = cc.blink(2, 10);\n */\ncc.blink = function (duration, blinks) {\n    return new cc.Blink(duration, blinks);\n};\n\n/* Fades an object that implements the cc.RGBAProtocol protocol. It modifies the opacity from the current value to a custom one.\n * @warning This action doesn't support \"reverse\"\n * @class FadeTo\n * @extends ActionInterval\n * @param {Number} duration\n * @param {Number} opacity 0-255, 0 is transparent\n * @example\n * var action = new cc.FadeTo(1.0, 0);\n */\ncc.FadeTo = cc.Class({\n    name: 'cc.FadeTo',\n    extends: cc.ActionInterval,\n\n    ctor:function (duration, opacity) {\n        this._toOpacity = 0;\n        this._fromOpacity = 0;\n        opacity !== undefined && cc.FadeTo.prototype.initWithDuration.call(this, duration, opacity);\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} duration  duration in seconds\n     * @param {Number} opacity\n     * @return {Boolean}\n     */\n    initWithDuration:function (duration, opacity) {\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, duration)) {\n            this._toOpacity = opacity;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.FadeTo();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._toOpacity);\n        return action;\n    },\n\n    update:function (time) {\n        time = this._computeEaseTime(time);\n        var fromOpacity = this._fromOpacity !== undefined ? this._fromOpacity : 255;\n        this.target.opacity = fromOpacity + (this._toOpacity - fromOpacity) * time;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        this._fromOpacity = target.opacity;\n    }\n});\n\n/**\n * !#en\n * Fades an object that implements the cc.RGBAProtocol protocol.\n * It modifies the opacity from the current value to a custom one.\n * !#zh 修改透明度到指定值。\n * @method fadeTo\n * @param {Number} duration\n * @param {Number} opacity 0-255, 0 is transparent\n * @return {ActionInterval}\n * @example\n * // example\n * var action = cc.fadeTo(1.0, 0);\n */\ncc.fadeTo = function (duration, opacity) {\n    return new cc.FadeTo(duration, opacity);\n};\n\n/* Fades In an object that implements the cc.RGBAProtocol protocol. It modifies the opacity from 0 to 255.<br/>\n * The \"reverse\" of this action is FadeOut\n * @class FadeIn\n * @extends FadeTo\n * @param {Number} duration duration in seconds\n */\ncc.FadeIn = cc.Class({\n    name: 'cc.FadeIn',\n    extends: cc.FadeTo,\n\n    ctor:function (duration) {\n        if (duration == null)\n            duration = 0;\n        this._reverseAction = null;\n        this.initWithDuration(duration, 255);\n    },\n\n    reverse:function () {\n        var action = new cc.FadeOut();\n        action.initWithDuration(this._duration, 0);\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    },\n\n    clone:function () {\n        var action = new cc.FadeIn();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._toOpacity);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        if(this._reverseAction)\n            this._toOpacity = this._reverseAction._fromOpacity;\n        cc.FadeTo.prototype.startWithTarget.call(this, target);\n    }\n});\n\n/**\n * !#en Fades In an object that implements the cc.RGBAProtocol protocol. It modifies the opacity from 0 to 255.\n * !#zh 渐显效果。\n * @method fadeIn\n * @param {Number} duration duration in seconds\n * @return {ActionInterval}\n * @example\n * //example\n * var action = cc.fadeIn(1.0);\n */\ncc.fadeIn = function (duration) {\n    return new cc.FadeIn(duration);\n};\n\n\n/* Fades Out an object that implements the cc.RGBAProtocol protocol. It modifies the opacity from 255 to 0.\n * The \"reverse\" of this action is FadeIn\n * @class FadeOut\n * @extends FadeTo\n * @param {Number} duration duration in seconds\n */\ncc.FadeOut = cc.Class({\n    name: 'cc.FadeOut',\n    extends: cc.FadeTo,\n\n    ctor:function (duration) {\n        if (duration == null)\n            duration = 0;\n        this._reverseAction = null;\n        this.initWithDuration(duration, 0);\n    },\n\n    reverse:function () {\n        var action = new cc.FadeIn();\n        action._reverseAction = this;\n        action.initWithDuration(this._duration, 255);\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    },\n\n    clone:function () {\n        var action = new cc.FadeOut();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._toOpacity);\n        return action;\n    }\n});\n\n/**\n * !#en Fades Out an object that implements the cc.RGBAProtocol protocol. It modifies the opacity from 255 to 0.\n * !#zh 渐隐效果。\n * @method fadeOut\n * @param {Number} d  duration in seconds\n * @return {ActionInterval}\n * @example\n * // example\n * var action = cc.fadeOut(1.0);\n */\ncc.fadeOut = function (d) {\n    return new cc.FadeOut(d);\n};\n\n/* Tints a Node that implements the cc.NodeRGB protocol from current tint to a custom one.\n * @warning This action doesn't support \"reverse\"\n * @class TintTo\n * @extends ActionInterval\n * @param {Number} duration\n * @param {Number} red 0-255\n * @param {Number} green  0-255\n * @param {Number} blue 0-255\n * @example\n * var action = new cc.TintTo(2, 255, 0, 255);\n */\ncc.TintTo = cc.Class({\n    name: 'cc.TintTo',\n    extends: cc.ActionInterval,\n\n    ctor:function (duration, red, green, blue) {\n        this._to = cc.color(0, 0, 0);\n        this._from = cc.color(0, 0, 0);\n\n        if (red instanceof cc.Color) {\n            blue = red.b;\n            green = red.g;\n            red = red.r;\n        }\n\n        blue !== undefined && this.initWithDuration(duration, red, green, blue);\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} duration\n     * @param {Number} red 0-255\n     * @param {Number} green 0-255\n     * @param {Number} blue 0-255\n     * @return {Boolean}\n     */\n    initWithDuration:function (duration, red, green, blue) {\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, duration)) {\n            this._to = cc.color(red, green, blue);\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.TintTo();\n        this._cloneDecoration(action);\n        var locTo = this._to;\n        action.initWithDuration(this._duration, locTo.r, locTo.g, locTo.b);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n\n        this._from = this.target.color;\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        var locFrom = this._from, locTo = this._to;\n        if (locFrom) {\n            this.target.color = cc.color(\n                    locFrom.r + (locTo.r - locFrom.r) * dt,\n                    locFrom.g + (locTo.g - locFrom.g) * dt,\n                    locFrom.b + (locTo.b - locFrom.b) * dt);\n        }\n    }\n});\n\n/**\n * !#en Tints a Node that implements the cc.NodeRGB protocol from current tint to a custom one.\n * !#zh 修改颜色到指定值。\n * @method tintTo\n * @param {Number} duration\n * @param {Number} red 0-255\n * @param {Number} green  0-255\n * @param {Number} blue 0-255\n * @return {ActionInterval}\n * @example\n * // example\n * var action = cc.tintTo(2, 255, 0, 255);\n */\ncc.tintTo = function (duration, red, green, blue) {\n    return new cc.TintTo(duration, red, green, blue);\n};\n\n\n/* Tints a Node that implements the cc.NodeRGB protocol from current tint to a custom one.\n * Relative to their own color change.\n * @class TintBy\n * @extends ActionInterval\n * @param {Number} duration  duration in seconds\n * @param {Number} deltaRed\n * @param {Number} deltaGreen\n * @param {Number} deltaBlue\n * @example\n * var action = new cc.TintBy(2, -127, -255, -127);\n */\ncc.TintBy = cc.Class({\n    name: 'cc.TintBy',\n    extends: cc.ActionInterval,\n\n    ctor:function (duration, deltaRed, deltaGreen, deltaBlue) {\n        this._deltaR = 0;\n        this._deltaG = 0;\n        this._deltaB = 0;\n        this._fromR = 0;\n        this._fromG = 0;\n        this._fromB = 0;\n\t\tdeltaBlue !== undefined && this.initWithDuration(duration, deltaRed, deltaGreen, deltaBlue);\n    },\n\n    /*\n     * Initializes the action.\n     * @param {Number} duration\n     * @param {Number} deltaRed 0-255\n     * @param {Number} deltaGreen 0-255\n     * @param {Number} deltaBlue 0-255\n     * @return {Boolean}\n     */\n    initWithDuration:function (duration, deltaRed, deltaGreen, deltaBlue) {\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, duration)) {\n            this._deltaR = deltaRed;\n            this._deltaG = deltaGreen;\n            this._deltaB = deltaBlue;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.TintBy();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration, this._deltaR, this._deltaG, this._deltaB);\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n\n        var color = target.color;\n        this._fromR = color.r;\n        this._fromG = color.g;\n        this._fromB = color.b;\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n\n        this.target.color = cc.color(this._fromR + this._deltaR * dt,\n                                    this._fromG + this._deltaG * dt,\n                                    this._fromB + this._deltaB * dt);\n    },\n\n    reverse:function () {\n        var action = new cc.TintBy(this._duration, -this._deltaR, -this._deltaG, -this._deltaB);\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    }\n});\n\n/**\n * !#en\n * Tints a Node that implements the cc.NodeRGB protocol from current tint to a custom one.\n * Relative to their own color change.\n * !#zh 按照指定的增量修改颜色。\n * @method tintBy\n * @param {Number} duration  duration in seconds\n * @param {Number} deltaRed\n * @param {Number} deltaGreen\n * @param {Number} deltaBlue\n * @return {ActionInterval}\n * @example\n * // example\n * var action = cc.tintBy(2, -127, -255, -127);\n */\ncc.tintBy = function (duration, deltaRed, deltaGreen, deltaBlue) {\n    return new cc.TintBy(duration, deltaRed, deltaGreen, deltaBlue);\n};\n\n/* Delays the action a certain amount of seconds\n * @class DelayTime\n * @extends ActionInterval\n */\ncc.DelayTime = cc.Class({\n    name: 'cc.DelayTime',\n    extends: cc.ActionInterval,\n\n    update:function (dt) {},\n\n    reverse:function () {\n        var action = new cc.DelayTime(this._duration);\n        this._cloneDecoration(action);\n        this._reverseEaseList(action);\n        return action;\n    },\n\n    clone:function () {\n        var action = new cc.DelayTime();\n        this._cloneDecoration(action);\n        action.initWithDuration(this._duration);\n        return action;\n    }\n});\n\n/**\n * !#en Delays the action a certain amount of seconds.\n * !#zh 延迟指定的时间量。\n * @method delayTime\n * @param {Number} d duration in seconds\n * @return {ActionInterval}\n * @example\n * // example\n * var delay = cc.delayTime(1);\n */\ncc.delayTime = function (d) {\n    return new cc.DelayTime(d);\n};\n\n/*\n * <p>\n * Executes an action in reverse order, from time=duration to time=0                                     <br/>\n * @warning Use this action carefully. This action is not sequenceable.                                 <br/>\n * Use it as the default \"reversed\" method of your own actions, but using it outside the \"reversed\"      <br/>\n * scope is not recommended.\n * </p>\n * @class ReverseTime\n * @extends ActionInterval\n * @param {FiniteTimeAction} action\n * @example\n *  var reverse = new cc.ReverseTime(this);\n */\ncc.ReverseTime = cc.Class({\n    name: 'cc.ReverseTime',\n    extends: cc.ActionInterval,\n\n    ctor:function (action) {\n        this._other = null;\n\t\taction && this.initWithAction(action);\n    },\n\n    /*\n     * @param {FiniteTimeAction} action\n     * @return {Boolean}\n     */\n    initWithAction:function (action) {\n        if (!action) {\n            cc.errorID(1028);\n            return false;\n        }\n        if (action === this._other) {\n            cc.errorID(1029);\n            return false;\n        }\n\n        if (cc.ActionInterval.prototype.initWithDuration.call(this, action._duration)) {\n            // Don't leak if action is reused\n            this._other = action;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.ReverseTime();\n        this._cloneDecoration(action);\n        action.initWithAction(this._other.clone());\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        this._other.startWithTarget(target);\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        if (this._other)\n            this._other.update(1 - dt);\n    },\n\n    reverse:function () {\n        return this._other.clone();\n    },\n\n    stop:function () {\n        this._other.stop();\n        cc.Action.prototype.stop.call(this);\n    }\n});\n\n/**\n * !#en Executes an action in reverse order, from time=duration to time=0.\n * !#zh 反转目标动作的时间轴。\n * @method reverseTime\n * @param {FiniteTimeAction} action\n * @return {ActionInterval}\n * @example\n * // example\n *  var reverse = cc.reverseTime(this);\n */\ncc.reverseTime = function (action) {\n    return new cc.ReverseTime(action);\n};\n\n/*\n * <p>\n * Overrides the target of an action so that it always runs on the target<br/>\n * specified at action creation rather than the one specified by runAction.\n * </p>\n * @class TargetedAction\n * @extends ActionInterval\n * @param {Node} target\n * @param {FiniteTimeAction} action\n */\ncc.TargetedAction = cc.Class({\n    name: 'cc.TargetedAction',\n    extends: cc.ActionInterval,\n\n    ctor: function (target, action) {\n        this._action = null;\n        this._forcedTarget = null;\n\t\taction && this.initWithTarget(target, action);\n    },\n\n    /*\n     * Init an action with the specified action and forced target\n     * @param {Node} target\n     * @param {FiniteTimeAction} action\n     * @return {Boolean}\n     */\n    initWithTarget:function (target, action) {\n        if (this.initWithDuration(action._duration)) {\n            this._forcedTarget = target;\n            this._action = action;\n            return true;\n        }\n        return false;\n    },\n\n    clone:function () {\n        var action = new cc.TargetedAction();\n        this._cloneDecoration(action);\n        action.initWithTarget(this._forcedTarget, this._action.clone());\n        return action;\n    },\n\n    startWithTarget:function (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n        this._action.startWithTarget(this._forcedTarget);\n    },\n\n    stop:function () {\n        this._action.stop();\n    },\n\n    update:function (dt) {\n        dt = this._computeEaseTime(dt);\n        this._action.update(dt);\n    },\n\n    /*\n     * return the target that the action will be forced to run with\n     * @return {Node}\n     */\n    getForcedTarget:function () {\n        return this._forcedTarget;\n    },\n\n    /*\n     * set the target that the action will be forced to run with\n     * @param {Node} forcedTarget\n     */\n    setForcedTarget:function (forcedTarget) {\n        if (this._forcedTarget !== forcedTarget)\n            this._forcedTarget = forcedTarget;\n    }\n});\n\n/**\n * !#en Create an action with the specified action and forced target.\n * !#zh 用已有动作和一个新的目标节点创建动作。\n * @method targetedAction\n * @param {Node} target\n * @param {FiniteTimeAction} action\n * @return {ActionInterval}\n */\ncc.targetedAction = function (target, action) {\n    return new cc.TargetedAction(target, action);\n};\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('../core/platform/CCClass');\nvar js = require('../core/platform/js');\n\n/*\n * @class HashElement\n * @constructor\n * @private\n */\nvar HashElement = function () {\n    this.actions = [];\n    this.target = null; //ccobject\n    this.actionIndex = 0;\n    this.currentAction = null; //CCAction\n    this.paused = false;\n    this.lock = false;\n};\n\n/**\n * !#en\n * cc.ActionManager is a class that can manage actions.<br/>\n * Normally you won't need to use this class directly. 99% of the cases you will use the CCNode interface,\n * which uses this class's singleton object.\n * But there are some cases where you might need to use this class. <br/>\n * Examples:<br/>\n * - When you want to run an action where the target is different from a CCNode.<br/>\n * - When you want to pause / resume the actions<br/>\n * !#zh\n * cc.ActionManager 是可以管理动作的单例类。<br/>\n * 通常你并不需要直接使用这个类，99%的情况您将使用 CCNode 的接口。<br/>\n * 但也有一些情况下，您可能需要使用这个类。 <br/>\n * 例如：\n *  - 当你想要运行一个动作，但目标不是 CCNode 类型时。 <br/>\n *  - 当你想要暂停/恢复动作时。 <br/>\n * @class ActionManager\n * @example {@link cocos2d/core/CCActionManager/ActionManager.js}\n */\ncc.ActionManager = function () {\n    this._hashTargets = js.createMap(true);\n    this._arrayTargets = [];\n    this._currentTarget = null;\n    cc.director._scheduler && cc.director._scheduler.enableForTarget(this);\n};\ncc.ActionManager.prototype = {\n    constructor: cc.ActionManager,\n    _elementPool: [],\n\n    _searchElementByTarget:function (arr, target) {\n        for (var k = 0; k < arr.length; k++) {\n            if (target === arr[k].target)\n                return arr[k];\n        }\n        return null;\n    },\n\n    _getElement: function (target, paused) {\n        var element = this._elementPool.pop();\n        if (!element) {\n            element = new HashElement();\n        }\n        element.target = target;\n        element.paused = !!paused;\n        return element;\n    },\n\n    _putElement: function (element) {\n        element.actions.length = 0;\n        element.actionIndex = 0;\n        element.currentAction = null;\n        element.paused = false;\n        element.target = null;\n        element.lock = false;\n        this._elementPool.push(element);\n    },\n\n    /**\n     * !#en\n     * Adds an action with a target.<br/>\n     * If the target is already present, then the action will be added to the existing target.\n     * If the target is not present, a new instance of this target will be created either paused or not, and the action will be added to the newly created target.\n     * When the target is paused, the queued actions won't be 'ticked'.\n     * !#zh\n     * 增加一个动作，同时还需要提供动作的目标对象，目标对象是否暂停作为参数。<br/>\n     * 如果目标已存在，动作将会被直接添加到现有的节点中。<br/>\n     * 如果目标不存在，将为这一目标创建一个新的实例，并将动作添加进去。<br/>\n     * 当目标状态的 paused 为 true，动作将不会被执行\n     *\n     * @method addAction\n     * @param {Action} action\n     * @param {Node} target\n     * @param {Boolean} paused\n     */\n    addAction:function (action, target, paused) {\n        if (!action || !target) {\n            cc.errorID(1000);\n            return;\n        }\n\n        //check if the action target already exists\n        var element = this._hashTargets[target._id];\n        //if doesn't exists, create a hashelement and push in mpTargets\n        if (!element) {\n            element = this._getElement(target, paused);\n            this._hashTargets[target._id] = element;\n            this._arrayTargets.push(element);\n        }\n        else if (!element.actions) {\n            element.actions = [];\n        }\n\n        element.actions.push(action);\n        action.startWithTarget(target);\n    },\n\n    /**\n     * !#en Removes all actions from all the targets.\n     * !#zh 移除所有对象的所有动作。\n     * @method removeAllActions\n     */\n    removeAllActions:function () {\n        var locTargets = this._arrayTargets;\n        for (var i = 0; i < locTargets.length; i++) {\n            var element = locTargets[i];\n            if (element)\n                this._putElement(element);\n        }\n        this._arrayTargets.length = 0;\n        this._hashTargets = js.createMap(true);\n    },\n    /**\n     * !#en\n     * Removes all actions from a certain target. <br/>\n     * All the actions that belongs to the target will be removed.\n     * !#zh\n     * 移除指定对象上的所有动作。<br/>\n     * 属于该目标的所有的动作将被删除。\n     * @method removeAllActionsFromTarget\n     * @param {Node} target\n     * @param {Boolean} forceDelete\n     */\n    removeAllActionsFromTarget:function (target, forceDelete) {\n        // explicit null handling\n        if (target == null)\n            return;\n        var element = this._hashTargets[target._id];\n        if (element) {\n            element.actions.length = 0;\n            this._deleteHashElement(element);\n        }\n    },\n    /**\n     * !#en Removes an action given an action reference.\n     * !#zh 移除指定的动作。\n     * @method removeAction \n     * @param {Action} action\n     */\n    removeAction:function (action) {\n        // explicit null handling\n        if (action == null)\n            return;\n        var target = action.getOriginalTarget();\n        var element = this._hashTargets[target._id];\n\n        if (element) {\n            for (var i = 0; i < element.actions.length; i++) {\n                if (element.actions[i] === action) {\n                    element.actions.splice(i, 1);\n                    // update actionIndex in case we are in tick. looping over the actions\n                    if (element.actionIndex >= i)\n                        element.actionIndex--;\n                    break;\n                }\n            }\n        } else {\n            cc.logID(1001);\n        }\n    },\n\n    /**\n     * !#en Removes an action given its tag and the target.\n     * !#zh 删除指定对象下特定标签的一个动作，将删除首个匹配到的动作。\n     * @method removeActionByTag\n     * @param {Number} tag\n     * @param {Node} target\n     */\n    removeActionByTag:function (tag, target) {\n        if(tag === cc.Action.TAG_INVALID)\n            cc.logID(1002);\n\n        cc.assertID(target, 1003);\n\n        var element = this._hashTargets[target._id];\n\n        if (element) {\n            var limit = element.actions.length;\n            for (var i = 0; i < limit; ++i) {\n                var action = element.actions[i];\n                if (action && action.getTag() === tag && action.getOriginalTarget() === target) {\n                    this._removeActionAtIndex(i, element);\n                    break;\n                }\n            }\n        }\n    },\n\n    /**\n     * !#en Gets an action given its tag an a target.\n     * !#zh 通过目标对象和标签获取一个动作。\n     * @method getActionByTag\n     * @param {Number} tag\n     * @param {Node} target\n     * @return {Action|Null}  return the Action with the given tag on success\n     */\n    getActionByTag:function (tag, target) {\n        if(tag === cc.Action.TAG_INVALID)\n            cc.logID(1004);\n\n        var element = this._hashTargets[target._id];\n        if (element) {\n            if (element.actions != null) {\n                for (var i = 0; i < element.actions.length; ++i) {\n                    var action = element.actions[i];\n                    if (action && action.getTag() === tag)\n                        return action;\n                }\n            }\n            cc.logID(1005, tag);\n        }\n        return null;\n    },\n\n\n    /**\n     * !#en\n     * Returns the numbers of actions that are running in a certain target. <br/>\n     * Composable actions are counted as 1 action. <br/>\n     * Example: <br/>\n     * - If you are running 1 Sequence of 7 actions, it will return 1. <br/>\n     * - If you are running 7 Sequences of 2 actions, it will return 7.\n     * !#zh\n     * 返回指定对象下所有正在运行的动作数量。 <br/>\n     * 组合动作被算作一个动作。<br/>\n     * 例如：<br/>\n     *  - 如果您正在运行 7 个动作组成的序列动作（Sequence），这个函数将返回 1。<br/>\n     *  - 如果你正在运行 2 个序列动作（Sequence）和 5 个普通动作，这个函数将返回 7。<br/>\n     *\n     * @method getNumberOfRunningActionsInTarget\n     * @param {Node} target\n     * @return {Number}\n     */\n    getNumberOfRunningActionsInTarget:function (target) {\n        var element = this._hashTargets[target._id];\n        if (element)\n            return (element.actions) ? element.actions.length : 0;\n\n        return 0;\n    },\n    /**\n     * !#en Pauses the target: all running actions and newly added actions will be paused.\n     * !#zh 暂停指定对象：所有正在运行的动作和新添加的动作都将会暂停。\n     * @method pauseTarget\n     * @param {Node} target\n     */\n    pauseTarget:function (target) {\n        var element = this._hashTargets[target._id];\n        if (element)\n            element.paused = true;\n    },\n    /**\n     * !#en Resumes the target. All queued actions will be resumed.\n     * !#zh 让指定目标恢复运行。在执行序列中所有被暂停的动作将重新恢复运行。\n     * @method resumeTarget\n     * @param {Node} target\n     */\n    resumeTarget:function (target) {\n        var element = this._hashTargets[target._id];\n        if (element)\n            element.paused = false;\n    },\n\n    /**\n     * !#en Pauses all running actions, returning a list of targets whose actions were paused.\n     * !#zh 暂停所有正在运行的动作，返回一个包含了那些动作被暂停了的目标对象的列表。\n     * @method pauseAllRunningActions\n     * @return {Array}  a list of targets whose actions were paused.\n     */\n    pauseAllRunningActions:function(){\n        var idsWithActions = [];\n        var locTargets = this._arrayTargets;\n        for(var i = 0; i< locTargets.length; i++){\n            var element = locTargets[i];\n            if(element && !element.paused){\n                element.paused = true;\n                idsWithActions.push(element.target);\n            }\n        }\n        return idsWithActions;\n    },\n\n    /**\n     * !#en Resume a set of targets (convenience function to reverse a pauseAllRunningActions or pauseTargets call).\n     * !#zh 让一组指定对象恢复运行（用来逆转 pauseAllRunningActions 效果的便捷函数）。\n     * @method resumeTargets\n     * @param {Array} targetsToResume\n     */\n    resumeTargets:function(targetsToResume){\n        if (!targetsToResume)\n            return;\n\n        for (var i = 0; i< targetsToResume.length; i++) {\n            if(targetsToResume[i])\n                this.resumeTarget(targetsToResume[i]);\n        }\n    },\n\n    /**\n     * !#en Pause a set of targets.\n     * !#zh 暂停一组指定对象。\n     * @method pauseTargets\n     * @param {Array} targetsToPause\n     */\n    pauseTargets:function(targetsToPause){\n        if (!targetsToPause)\n            return;\n\n        for (var i = 0; i< targetsToPause.length; i++) {\n            if (targetsToPause[i])\n                this.pauseTarget(targetsToPause[i]);\n        }\n    },\n\n    /**\n     * !#en\n     * purges the shared action manager. It releases the retained instance. <br/>\n     * because it uses this, so it can not be static.\n     * !#zh\n     * 清除共用的动作管理器。它释放了持有的实例。 <br/>\n     * 因为它使用 this，因此它不能是静态的。\n     * @method purgeSharedManager\n     */\n    purgeSharedManager:function () {\n        cc.director.getScheduler().unscheduleUpdate(this);\n    },\n\n    //protected\n    _removeActionAtIndex:function (index, element) {\n        var action = element.actions[index];\n\n        element.actions.splice(index, 1);\n\n        // update actionIndex in case we are in tick. looping over the actions\n        if (element.actionIndex >= index)\n            element.actionIndex--;\n\n        if (element.actions.length === 0) {\n            this._deleteHashElement(element);\n        }\n    },\n\n    _deleteHashElement:function (element) {\n        var ret = false;\n        if (element && !element.lock) {\n            if (this._hashTargets[element.target._id]) {\n                delete this._hashTargets[element.target._id];\n                var targets = this._arrayTargets;\n                for (var i = 0, l = targets.length; i < l; i++) {\n                    if (targets[i] === element) {\n                        targets.splice(i, 1);\n                        break;\n                    }\n                }\n                this._putElement(element);\n                ret = true;\n            }\n        }\n        return ret;\n    },\n\n    /**\n     * !#en The ActionManager update。\n     * !#zh ActionManager 主循环。\n     * @method update\n     * @param {Number} dt delta time in seconds\n     */\n    update:function (dt) {\n        var locTargets = this._arrayTargets , locCurrTarget;\n        for (var elt = 0; elt < locTargets.length; elt++) {\n            this._currentTarget = locTargets[elt];\n            locCurrTarget = this._currentTarget;\n            if (!locCurrTarget.paused && locCurrTarget.actions) {\n                locCurrTarget.lock = true;\n                // The 'actions' CCMutableArray may change while inside this loop.\n                for (locCurrTarget.actionIndex = 0; locCurrTarget.actionIndex < locCurrTarget.actions.length; locCurrTarget.actionIndex++) {\n                    locCurrTarget.currentAction = locCurrTarget.actions[locCurrTarget.actionIndex];\n                    if (!locCurrTarget.currentAction)\n                        continue;\n\n                    //use for speed\n                    locCurrTarget.currentAction.step(dt * ( locCurrTarget.currentAction._speedMethod ? locCurrTarget.currentAction._speed : 1 ) );\n                    \n                    if (locCurrTarget.currentAction && locCurrTarget.currentAction.isDone()) {\n                        locCurrTarget.currentAction.stop();\n                        var action = locCurrTarget.currentAction;\n                        // Make currentAction nil to prevent removeAction from salvaging it.\n                        locCurrTarget.currentAction = null;\n                        this.removeAction(action);\n                    }\n\n                    locCurrTarget.currentAction = null;\n                }\n                locCurrTarget.lock = false;\n            }\n            // only delete currentTarget if no actions were scheduled during the cycle (issue #481)\n            if (locCurrTarget.actions.length === 0) {\n                this._deleteHashElement(locCurrTarget) && elt--;\n            }\n        }\n    }\n};\n\nif (CC_TEST) {\n    cc.ActionManager.prototype.isTargetPaused_TEST = function (target) {\n        var element = this._hashTargets[target._id];\n        return element.paused;\n    };\n}\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('./CCActionManager');\nrequire('./CCAction');\nrequire('./CCActionInterval');\nrequire('./CCActionInstant');\nrequire('./CCActionEase');\nrequire('./CCActionCatmullRom');\nrequire('./tween');\n","\nlet TweenAction = cc.Class({\n    name: 'cc.TweenAction',\n    extends: cc.ActionInterval,\n\n    ctor (duration, props, opts) {\n        this._opts = opts = opts || Object.create(null);\n        this._props = Object.create(null);\n\n        // global easing or progress used for this action\n        opts.progress = opts.progress || this.progress;\n        if (opts.easing && typeof opts.easing === 'string') {\n            let easingName = opts.easing;\n            opts.easing = cc.easing[easingName];\n            !opts.easing && cc.warnID(1031, easingName);\n        }\n\n        let relative = this._opts.relative;\n\n        for (let name in props) {\n            let value = props[name];\n\n            // property may have custom easing or progress function\n            let easing, progress;\n            if (value.value !== undefined && (value.easing || value.progress)) {\n                if (typeof value.easing === 'string') {\n                    easing = cc.easing[value.easing];\n                    !easing && cc.warnID(1031, value.easing);\n                }\n                else {\n                    easing = value.easing;\n                }\n                progress = value.progress;\n                value = value.value;\n            }\n\n            let isNumber = typeof value === 'number';\n            if (!isNumber && (!value.lerp || (relative && !value.add && !value.mul) || !value.clone)) {\n                cc.warn(`Can not animate ${name} property, because it do not have [lerp, (add|mul), clone] function.`);\n                continue;\n            }\n\n            let prop = Object.create(null);\n            prop.value = value;\n            prop.easing = easing;\n            prop.progress = progress;\n            this._props[name] = prop;\n        }\n\n        this._originProps = props;\n        this.initWithDuration(duration);\n    },\n\n    clone () {\n        var action = new TweenAction(this._duration, this._originProps, this._opts);\n        this._cloneDecoration(action);\n        return action;\n    },\n\n    startWithTarget (target) {\n        cc.ActionInterval.prototype.startWithTarget.call(this, target);\n\n        let relative = !!this._opts.relative;\n        let props = this._props;\n        for (let name in props) {\n            let value = target[name];\n            let prop = props[name];\n\n            if (typeof value === 'number') {\n                prop.start = value;\n                prop.current = value;\n                prop.end = relative ? value + prop.value : prop.value;\n            }\n            else {\n                prop.start = value.clone();\n                prop.current = value.clone();\n                prop.end = relative ? (value.add || value.mul).call(value, prop.value) : prop.value;\n            }\n        }\n    },\n\n    update (t) {\n        let opts = this._opts;\n        let easingTime = t;\n        if (opts.easing) easingTime = opts.easing(t);\n\n        let target = this.target;\n        if (!target) return;\n\n        let props = this._props;\n        let progress = this._opts.progress;\n        for (let name in props) {\n            let prop = props[name];\n            let time = prop.easing ? prop.easing(t) : easingTime;\n            let current = prop.current = (prop.progress || progress)(prop.start, prop.end, prop.current, time);\n            target[name] = current;\n        }\n    },\n\n    progress (start, end, current, t) {\n        if (typeof start === 'number') {\n            current = start + (end - start) * t;\n        }\n        else {\n            start.lerp(end, t, current);\n        }\n        return current;\n    }\n});\n\nlet SetAction = cc.Class({\n    name: 'cc.SetAction',\n    extends: cc.ActionInstant,\n\n    ctor (props) {\n        this._props = {};\n        props !== undefined && this.init(props);\n    },\n\n    init (props) {\n        for (let name in props) {\n            this._props[name] = props[name];\n        }\n        return true;\n    },\n\n    update () {\n        let props = this._props;\n        let target = this.target;\n        for (let name in props) {\n            target[name] = props[name];\n        }\n    },\n\n    clone () {\n        var action = new SetAction();\n        action.init(this._props);\n        return action;\n    }\n});\n\n\n\n/**\n * !#en\n * Tween provide a simple and flexible way to create action.\n * Tween's api is more flexible than cc.Action:\n *  - Support creating an action sequence in chained api,\n *  - Support animate any objects' any properties, not limited to node's properties.\n *    By contrast, cc.Action needs to create a new action class to support new node property.\n *  - Support working with cc.Action,\n *  - Support easing and progress function.\n * !#zh\n * Tween 提供了一个简单灵活的方法来创建 action。\n * 相对于 Cocos 传统的 cc.Action，cc.Tween 在创建动画上要灵活非常多：\n *  - 支持以链式结构的方式创建一个动画序列。\n *  - 支持对任意对象的任意属性进行缓动，不再局限于节点上的属性，而 cc.Action 添加一个属性的支持时还需要添加一个新的 action 类型。\n *  - 支持与 cc.Action 混用\n *  - 支持设置 {{#crossLink \"Easing\"}}{{/crossLink}} 或者 progress 函数\n * @class Tween\n * @param {Object} [target]\n * @example\n * cc.tween(node)\n *   .to(1, {scale: 2, position: cc.v3(100, 100, 100)})\n *   .call(() => { console.log('This is a callback'); })\n *   .by(1, {scale: 3, position: cc.v3(200, 200, 200)}, {easing: 'sineOutIn'})\n *   .run(cc.find('Canvas/cocos'));\n */\nfunction Tween (target) {\n    this._actions = [];\n    this._finalAction = null;\n    this._target = target;\n}\n\n/**\n * !#en\n * Insert an action or tween to this sequence\n * !#zh\n * 插入一个 action 或者 tween 到队列中\n * @method then \n * @param {Action|Tween} other\n * @return {Tween}\n */\nTween.prototype.then = function (other) {\n    if (other instanceof cc.Action) {\n        this._actions.push(other.clone());\n    }\n    else {\n        this._actions.push(other._union());\n    }\n    return this;\n};\n\n\n/**\n * !#en\n * Set tween target\n * !#zh\n * 设置 tween 的 target\n * @method target\n * @param {Object} target\n * @return {Tween}\n */\nTween.prototype.target = function (target) {\n    this._target = target;\n    return this;\n};\n\n/**\n * !#en\n * Start this tween\n * !#zh\n * 运行当前 tween\n * @method start\n * @return {Tween}\n */\nTween.prototype.start = function () {\n    if (!this._target) {\n        cc.warn('Please set target to tween first');\n        return this;\n    }\n    if (this._finalAction) {\n        cc.director.getActionManager().removeAction(this._finalAction);\n    }\n    this._finalAction = this._union();\n    cc.director.getActionManager().addAction(this._finalAction, this._target, false);\n    return this;\n};\n\n/**\n * !#en\n * Stop this tween\n * !#zh\n * 停止当前 tween\n * @method stop\n * @return {Tween}\n */\nTween.prototype.stop = function () {\n    if (this._finalAction) {\n        cc.director.getActionManager().removeAction(this._finalAction);\n    }\n    return this;\n};\n\n\n\n/**\n * !#en\n * Clone a tween\n * !#zh\n * 克隆当前 tween\n * @method clone\n * @param {Object} [target]\n * @return {Tween}\n */\nTween.prototype.clone = function (target) {\n    let action = this._union();\n    return cc.tween(target).then(action.clone());\n};\n\n/**\n * !#en\n * Integrate all previous actions to an action.\n * !#zh\n * 将之前所有的 action 整合为一个 action。\n * @method union\n * @return {Tween}\n */\nTween.prototype.union = function () {\n    let action = this._union();\n    this._actions.length = 0;\n    this._actions.push(action);\n    return this;\n};\n\nTween.prototype._union = function () {\n    let actions = this._actions;\n\n    if (actions.length === 1) {\n        actions = actions[0];\n    }\n    else {\n        actions = cc.sequence(actions);\n    }\n\n    return actions;\n};\n\nlet tmp_args = [];\n\nfunction wrapAction (action) {\n    return function () {\n        tmp_args.length = 0;\n        for (let l = arguments.length, i = 0; i < l; i++) {\n            let arg = tmp_args[i] = arguments[i];\n            if (arg instanceof Tween) {\n                tmp_args[i] = arg._union();\n            }\n        }\n\n        return action.apply(this, tmp_args);\n    };\n}\n\nlet actions = {\n    /**\n     * !#en\n     * Add an action which calculate with absolute value\n     * !#zh\n     * 添加一个对属性进行绝对值计算的 action\n     * @method to\n     * @param {Number} duration \n     * @param {Object} props - {scale: 2, position: cc.v3(100, 100, 100)}\n     * @param {Object} [opts] \n     * @param {Function} [opts.progress]\n     * @param {Function|String} [opts.easing]\n     * @return {Tween}\n     */\n    to (duration, props, opts) {\n        opts = opts || Object.create(null);\n        opts.relative = false;\n        return new TweenAction(duration, props, opts);\n    },\n\n    /**\n     * !#en\n     * Add an action which calculate with relative value\n     * !#zh\n     * 添加一个对属性进行相对值计算的 action\n     * @method by\n     * @param {Number} duration \n     * @param {Object} props - {scale: 2, position: cc.v3(100, 100, 100)}\n     * @param {Object} [opts] \n     * @param {Function} [opts.progress]\n     * @param {Function|String} [opts.easing]\n     * @return {Tween}\n     */\n    by (duration, props, opts) {\n        opts = opts || Object.create(null);\n        opts.relative = true;\n        return new TweenAction(duration, props, opts);\n    },\n\n    /**\n     * !#en\n     * Directly set target properties\n     * !#zh\n     * 直接设置 target 的属性\n     * @method set\n     * @param {Object} props\n     * @return {Tween}\n     */\n    set (props) {\n        return new SetAction(props);\n    },\n\n    /**\n     * !#en\n     * Add an delay action\n     * !#zh\n     * 添加一个延时 action\n     * @method delay\n     * @param {Number} duration \n     * @return {Tween}\n     */\n    delay: cc.delayTime,\n    /**\n     * !#en\n     * Add an callback action\n     * !#zh\n     * 添加一个回调 action\n     * @method call\n     * @param {Function} callback\n     * @return {Tween}\n     */\n    call: cc.callFunc,\n    /**\n     * !#en\n     * Add an hide action\n     * !#zh\n     * 添加一个隐藏 action\n     * @method hide\n     * @return {Tween}\n     */\n    hide: cc.hide,\n    /**\n     * !#en\n     * Add an show action\n     * !#zh\n     * 添加一个显示 action\n     * @method show\n     * @return {Tween}\n     */\n    show: cc.show,\n    /**\n     * !#en\n     * Add an removeSelf action\n     * !#zh\n     * 添加一个移除自己 action\n     * @method removeSelf\n     * @return {Tween}\n     */\n    removeSelf: cc.removeSelf,\n    /**\n     * !#en\n     * Add an sequence action\n     * !#zh\n     * 添加一个队列 action\n     * @method sequence\n     * @param {Action|Tween} action\n     * @param {Action|Tween} ...actions\n     * @return {Tween}\n     */\n    sequence: wrapAction(cc.sequence),\n    /**\n     * !#en\n     * Add an parallel action\n     * !#zh\n     * 添加一个并行 action\n     * @method parallel\n     * @param {Action|Tween} action\n     * @param {Action|Tween} ...actions\n     * @return {Tween}\n     */\n    parallel: wrapAction(cc.spawn)\n};\n\n// these action will use previous action as their parameters\nlet previousAsInputActions = {\n    /**\n     * !#en\n     * Add an repeat action. \n     * This action will integrate before actions to a sequence action as their parameters.\n     * !#zh\n     * 添加一个重复 action，这个 action 会将前一个动作作为他的参数。\n     * @method repeat\n     * @param {Number} repeatTimes \n     * @param {Action | Tween} [action]\n     * @return {Tween}\n     */\n    repeat: cc.repeat,\n    /**\n     * !#en\n     * Add an repeat forever action\n     * This action will integrate before actions to a sequence action as their parameters.\n     * !#zh\n     * 添加一个永久重复 action，这个 action 会将前一个动作作为他的参数。\n     * @method repeatForever\n     * @param {Action | Tween} [action]\n     * @return {Tween}\n     */\n    repeatForever: function (action) {\n        // TODO: fixed with cc.repeatForever\n        return cc.repeat(action, 10e8);\n    },\n    /**\n     * !#en\n     * Add an reverse time action.\n     * This action will integrate before actions to a sequence action as their parameters.\n     * !#zh\n     * 添加一个倒置时间 action，这个 action 会将前一个动作作为他的参数。\n     * @method reverseTime\n     * @param {Action | Tween} [action]\n     * @return {Tween}\n     */\n    reverseTime: cc.reverseTime,\n};\n\n\nlet keys = Object.keys(actions);\nfor (let i = 0; i < keys.length; i++) {\n    let key = keys[i];\n    Tween.prototype[key] = function () {\n        let action = actions[key].apply(actions, arguments);\n        this._actions.push(action);\n        return this;\n    };\n}\n\nkeys = Object.keys(previousAsInputActions);\nfor (let i = 0; i < keys.length; i++) {\n    let key = keys[i];\n    Tween.prototype[key] = function () {\n\n        let actions = this._actions;\n        let action = arguments[arguments.length - 1];\n        let length = arguments.length - 1;\n\n        if (action instanceof cc.Tween) {\n            action = action._union();\n        }\n        else if (!(action instanceof cc.Action)) {\n            action = actions[actions.length - 1];\n            actions.length -= 1;\n            length += 1;\n        }\n\n        let args = [action];\n        for (let i = 0; i < length; i++) {\n            args.push(arguments[i]);\n        }\n\n        action = previousAsInputActions[key].apply(this, args);\n        actions.push(action);\n\n        return this;\n    };\n}\n\n/**\n * @module cc\n */\n\n/**\n * @method tween\n * @param {Object} [target] - the target to animate\n * @return {Tween}\n */\ncc.tween = function (target) {\n    return new Tween(target);\n};\n\ncc.Tween = Tween;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst js = cc.js;\nconst Playable = require('./playable');\nconst { EventAnimCurve, EventInfo } = require('./animation-curves');\nconst WrapModeMask = require('./types').WrapModeMask;\nconst binarySearch = require('../core/utils/binary-search').binarySearchEpsilon;\n\n// The actual animator for Animation Component\n\nfunction AnimationAnimator (target, animation) {\n    Playable.call(this);\n    this.target = target;\n    this.animation = animation;\n\n    this._anims = new js.array.MutableForwardIterator([]);\n}\njs.extend(AnimationAnimator, Playable);\nlet p = AnimationAnimator.prototype;\n\np.playState = function (state, startTime) {\n    if (!state.clip) {\n        return;\n    }\n\n    if (!state.curveLoaded) {\n        initClipData(this.target, state);\n    }\n\n    state.animator = this;\n    state.play();\n\n    if (typeof startTime === 'number') {\n        state.setTime(startTime);\n    }\n\n    this.play();\n};\n\np.stopStatesExcept = function (state) {\n    let iterator = this._anims;\n    let array = iterator.array;\n    for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n        let anim = array[iterator.i];\n        if (anim === state) {\n            continue;\n        }\n\n        this.stopState(anim);\n    }\n};\n\np.addAnimation = function (anim) {\n    let index = this._anims.array.indexOf(anim);\n    if (index === -1) {\n        this._anims.push(anim);\n    }\n\n    anim._setEventTarget(this.animation);\n};\n\np.removeAnimation = function (anim) {\n    let index = this._anims.array.indexOf(anim);\n    if (index >= 0) {\n        this._anims.fastRemoveAt(index);\n\n        if (this._anims.array.length === 0) {\n            this.stop();\n        }\n    }\n    else {\n        cc.errorID(3908);\n    }\n\n    anim.animator = null;\n};\n\np.sample = function () {\n    let iterator = this._anims;\n    let array = iterator.array;\n    for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n        let anim = array[iterator.i];\n        anim.sample();\n    }\n};\n\np.stopState = function (state) {\n    if (state) {\n        state.stop();\n    }\n};\n\np.pauseState = function (state) {\n    if (state) {\n        state.pause();\n    }\n};\n\np.resumeState = function (state) {\n    if (state) {\n        state.resume();\n    }\n\n    if (this.isPaused) {\n        this.resume();\n    }\n};\n\np.setStateTime = function (state, time) {\n    if (time !== undefined) {\n        if (state) {\n            state.setTime(time);\n            state.sample();\n        }    \n    }\n    else {\n        time = state;\n\n        let array = this._anims.array;\n        for (let i = 0; i < array.length; ++i) {\n            let anim = array[i];\n            anim.setTime(time);\n            anim.sample();\n        }\n    }\n};\n\np.onStop = function () {\n    let iterator = this._anims;\n    let array = iterator.array;\n    for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n        let anim = array[iterator.i];\n        anim.stop();\n    }\n};\n\np.onPause = function () {\n    let array = this._anims.array;\n    for (let i = 0; i < array.length; ++i) {\n        let anim = array[i];\n        anim.pause();\n\n        // need to unbind animator to anim, or it maybe cannot be gc.\n        anim.animator = null;\n    }\n};\n\np.onResume = function () {\n    let array = this._anims.array;\n    for (let i = 0; i < array.length; ++i) {\n        let anim = array[i];\n        \n        // rebind animator to anim\n        anim.animator = this;\n\n        anim.resume();\n    }\n};\n\np._reloadClip = function (state) {\n    initClipData(this.target, state);\n};\n\n// 这个方法应该是 SampledAnimCurve 才能用\nfunction createBatchedProperty (propPath, firstDotIndex, mainValue, animValue) {\n    mainValue = mainValue.clone();\n    let nextValue = mainValue;\n    let leftIndex = firstDotIndex + 1;\n    let rightIndex = propPath.indexOf('.', leftIndex);\n\n    // scan property path\n    while (rightIndex !== -1) {\n        let nextName = propPath.slice(leftIndex, rightIndex);\n        nextValue = nextValue[nextName];\n        leftIndex = rightIndex + 1;\n        rightIndex = propPath.indexOf('.', leftIndex);\n    }\n    let lastPropName = propPath.slice(leftIndex);\n    nextValue[lastPropName] = animValue;\n\n    return mainValue;\n}\n\nif (CC_TEST) {\n    cc._Test.createBatchedProperty = createBatchedProperty;\n}\n\n\nfunction initClipData (root, state) {\n    let clip = state.clip;\n\n    state.duration = clip.duration;\n    state.speed = clip.speed;\n    state.wrapMode = clip.wrapMode;\n    state.frameRate = clip.sample;\n\n    if ((state.wrapMode & WrapModeMask.Loop) === WrapModeMask.Loop) {\n        state.repeatCount = Infinity;\n    }\n    else {\n        state.repeatCount = 1;\n    }\n\n    let curves = state.curves = clip.createCurves(state, root);\n\n    // events curve\n\n    let events = clip.events;\n\n    if (!CC_EDITOR && events) {\n        let curve;\n\n        for (let i = 0, l = events.length; i < l; i++) {\n            if (!curve) {\n                curve = new EventAnimCurve();\n                curve.target = root;\n                curves.push(curve);\n            }\n\n            let eventData = events[i];\n            let ratio = eventData.frame / state.duration;\n\n            let eventInfo;\n            let index = binarySearch(curve.ratios, ratio);\n            if (index >= 0) {\n                eventInfo = curve.events[index];\n            }\n            else {\n                eventInfo = new EventInfo();\n                curve.ratios.push(ratio);\n                curve.events.push(eventInfo);\n            }\n\n            eventInfo.add(eventData.func, eventData.params);\n        }\n    }\n}\n\nif (CC_TEST) {\n    cc._Test.initClipData = initClipData;\n}\n\n\nmodule.exports = AnimationAnimator;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst WrapMode = require('./types').WrapMode;\nconst { DynamicAnimCurve, quickFindIndex } = require('./animation-curves');\nconst sampleMotionPaths = require('./motion-path-helper').sampleMotionPaths;\nconst binarySearch = require('../core/utils/binary-search').binarySearchEpsilon;\n\n/**\n * !#en Class for animation data handling.\n * !#zh 动画剪辑，用于存储动画数据。\n * @class AnimationClip\n * @extends Asset\n */\nvar AnimationClip = cc.Class({\n    name: 'cc.AnimationClip',\n    extends: cc.Asset,\n\n    properties: {\n        _duration: {\n            default: 0,\n            type: cc.Float,\n        },\n\n        /**\n         * !#en Duration of this animation.\n         * !#zh 动画的持续时间。\n         * @property duration\n         * @type {Number}\n         */\n        duration: {\n            get: function () { return this._duration; },\n        },\n\n        /**\n         * !#en FrameRate of this animation.\n         * !#zh 动画的帧速率。\n         * @property sample\n         * @type {Number}\n         */\n        sample: {\n            default: 60,\n        },\n\n        /**\n         * !#en Speed of this animation.\n         * !#zh 动画的播放速度。\n         * @property speed\n         * @type {Number}\n         */\n        speed: {\n            default: 1\n        },\n\n        /**\n         * !#en WrapMode of this animation.\n         * !#zh 动画的循环模式。\n         * @property wrapMode\n         * @type {WrapMode}\n         */\n        wrapMode: {\n            default: WrapMode.Normal\n        },\n\n        /**\n         * !#en Curve data.\n         * !#zh 曲线数据。\n         * @property curveData\n         * @type {Object}\n         * @example {@link cocos2d/core/animation-clip/curve-data.js}\n         */\n        curveData: {\n            default: {},\n            visible: false,\n        },\n\n        /**\n         * !#en Event data.\n         * !#zh 事件数据。\n         * @property events\n         * @type {Object[]}\n         * @example {@link cocos2d/core/animation-clip/event-data.js}\n         * @typescript events: {frame: number, func: string, params: string[]}[]\n         */\n        events: {\n            default: [],\n            visible: false,\n        }\n    },\n\n    statics: {\n        /**\n         * !#en Crate clip with a set of sprite frames\n         * !#zh 使用一组序列帧图片来创建动画剪辑\n         * @method createWithSpriteFrames\n         * @param {[SpriteFrame]} spriteFrames\n         * @param {Number} sample\n         * @return {AnimationClip}\n         * @static\n         * @example\n         *\n         * var clip = cc.AnimationClip.createWithSpriteFrames(spriteFrames, 10);\n         *\n         */\n        createWithSpriteFrames: function (spriteFrames, sample) {\n            if (!Array.isArray(spriteFrames)) {\n                cc.errorID(3905);\n                return null;\n            }\n\n            var clip = new AnimationClip();\n            clip.sample = sample || clip.sample;\n\n            clip._duration = spriteFrames.length / clip.sample;\n\n            var frames = [];\n            var step = 1 / clip.sample;\n\n            for (var i = 0, l = spriteFrames.length; i < l; i++) {\n                frames[i] = { frame: (i * step), value: spriteFrames[i] };\n            }\n\n            clip.curveData = {\n                comps: {\n                    // component\n                    'cc.Sprite': {\n                        // component properties\n                        'spriteFrame': frames\n                    }\n                }\n            };\n\n            return clip;\n        }\n    },\n\n    onLoad () {\n        this._duration = Number.parseFloat(this.duration);\n        this.speed = Number.parseFloat(this.speed);\n        this.wrapMode = Number.parseInt(this.wrapMode);\n        this.frameRate = Number.parseFloat(this.sample);\n    },\n\n    createPropCurve (target, propPath, keyframes) {\n        let motionPaths = [];\n        let isMotionPathProp = target instanceof cc.Node && propPath === 'position';\n\n        let curve = new DynamicAnimCurve();\n\n        // 缓存目标对象，所以 Component 必须一开始都创建好并且不能运行时动态替换……\n        curve.target = target;\n        curve.prop = propPath;\n\n        // for each keyframes\n        for (let i = 0, l = keyframes.length; i < l; i++) {\n            let keyframe = keyframes[i];\n            let ratio = keyframe.frame / this.duration;\n            curve.ratios.push(ratio);\n\n            if (isMotionPathProp) {\n                motionPaths.push(keyframe.motionPath);\n            }\n\n            let curveValue = keyframe.value;\n            curve.values.push(curveValue);\n\n            let curveTypes = keyframe.curve;\n            if (curveTypes) {\n                if (typeof curveTypes === 'string') {\n                    curve.types.push(curveTypes);\n                    continue;\n                }\n                else if (Array.isArray(curveTypes)) {\n                    if (curveTypes[0] === curveTypes[1] &&\n                        curveTypes[2] === curveTypes[3]) {\n                        curve.types.push(DynamicAnimCurve.Linear);\n                    }\n                    else {\n                        curve.types.push(DynamicAnimCurve.Bezier(curveTypes));\n                    }\n                    continue;\n                }\n            }\n            curve.types.push(DynamicAnimCurve.Linear);\n        }\n        \n        if (isMotionPathProp) {\n            sampleMotionPaths(motionPaths, curve, this.duration, this.sample, target);\n        }\n\n        // if every piece of ratios are the same, we can use the quick function to find frame index.\n        let ratios = curve.ratios;\n        let currRatioDif, lastRatioDif;\n        let canOptimize = true;\n        let EPSILON = 1e-6;\n        for (let i = 1, l = ratios.length; i < l; i++) {\n            currRatioDif = ratios[i] - ratios[i-1];\n            if (i === 1) {\n                lastRatioDif = currRatioDif;\n            }\n            else if (Math.abs(currRatioDif - lastRatioDif) > EPSILON) {\n                canOptimize = false;                \n                break;\n            }\n        }\n\n        curve._findFrameIndex = canOptimize ? quickFindIndex : binarySearch;\n\n        // find the lerp function\n        let firstValue = curve.values[0];\n        if (firstValue !== undefined && firstValue !== null && !curve._lerp) {\n            if (typeof firstValue === 'number') {\n                curve._lerp = DynamicAnimCurve.prototype._lerpNumber;\n            }\n            else if (firstValue instanceof cc.Quat) {\n                curve._lerp = DynamicAnimCurve.prototype._lerpQuat;\n            }\n            else if (firstValue instanceof cc.Vec2 || firstValue instanceof cc.Vec3) {\n                curve._lerp = DynamicAnimCurve.prototype._lerpVector;\n            }\n            else if (firstValue.lerp) {\n                curve._lerp = DynamicAnimCurve.prototype._lerpObject;\n            }\n        }\n\n        return curve;\n    },\n\n    createTargetCurves (target, curveData, curves) {\n        let propsData = curveData.props;\n        let compsData = curveData.comps;\n\n        if (propsData) {\n            for (let propPath in propsData) {\n                let data = propsData[propPath];\n                let curve = this.createPropCurve(target, propPath, data);\n\n                curves.push(curve);\n            }\n        }\n\n        if (compsData) {\n            for (let compName in compsData) {\n                let comp = target.getComponent(compName);\n\n                if (!comp) {\n                    continue;\n                }\n\n                let compData = compsData[compName];\n                for (let propPath in compData) {\n                    let data = compData[propPath];\n                    let curve = this.createPropCurve(comp, propPath, data);\n\n                    curves.push(curve);\n                }\n            }\n        }\n    },\n\n    createCurves (state, root) {\n        let curveData = this.curveData;\n        let childrenCurveDatas = curveData.paths;\n        let curves = [];\n\n        this.createTargetCurves(root, curveData, curves);\n\n        for (let namePath in childrenCurveDatas) {\n            let target = cc.find(namePath, root);\n\n            if (!target) {\n                continue;\n            }\n\n            let childCurveDatas = childrenCurveDatas[namePath];\n            this.createTargetCurves(target, childCurveDatas, curves);\n        }\n\n        return curves;\n    }\n});\n\ncc.AnimationClip = module.exports = AnimationClip;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n\nconst bezierByTime = require('./bezier').bezierByTime;\n\nconst binarySearch = require('../core/utils/binary-search').binarySearchEpsilon;\nconst WrapModeMask = require('./types').WrapModeMask;\nconst WrappedInfo = require('./types').WrappedInfo;\n\n/**\n * Compute a new ratio by curve type\n * @param {Number} ratio - The origin ratio\n * @param {Array|String} type - If it's Array, then ratio will be computed with bezierByTime. If it's string, then ratio will be computed with cc.easing function\n */\nfunction computeRatioByType (ratio, type) {\n    if (typeof type === 'string') {\n        var func = cc.easing[type];\n        if (func) {\n            ratio = func(ratio);\n        }\n        else {\n            cc.errorID(3906, type);\n        }\n    }\n    else if (Array.isArray(type)) {\n        // bezier curve\n        ratio = bezierByTime(type, ratio);\n    }\n\n    return ratio;\n}\n\n//\n// 动画数据类，相当于 AnimationClip。\n// 虽然叫做 AnimCurve，但除了曲线，可以保存任何类型的值。\n//\n// @class AnimCurve\n//\n//\nvar AnimCurve = cc.Class({\n    name: 'cc.AnimCurve',\n\n    //\n    // @method sample\n    // @param {number} time\n    // @param {number} ratio - The normalized time specified as a number between 0.0 and 1.0 inclusive.\n    // @param {AnimationState} state\n    //\n    sample: function (time, ratio, state) {},\n\n    onTimeChangedManually: undefined\n});\n\n/**\n * 当每两帧之前的间隔都一样的时候可以使用此函数快速查找 index\n */\nfunction quickFindIndex (ratios, ratio) {\n    var length = ratios.length - 1;\n\n    if (length === 0) return 0;\n\n    var start = ratios[0];\n    if (ratio < start) return 0;\n\n    var end = ratios[length];\n    if (ratio > end) return ~ratios.length;\n\n    ratio = (ratio - start) / (end - start);\n\n    var eachLength = 1 / length;\n    var index = ratio / eachLength;\n    var floorIndex = index | 0;\n    var EPSILON = 1e-6;\n\n    if ((index - floorIndex) < EPSILON) {\n        return floorIndex;\n    }\n    else if ((floorIndex + 1 - index) < EPSILON) {\n        return floorIndex + 1;\n    }\n\n    return ~(floorIndex + 1);\n}\n\n//\n//\n// @class DynamicAnimCurve\n//\n// @extends AnimCurve\n//\nvar DynamicAnimCurve = cc.Class({\n    name: 'cc.DynamicAnimCurve',\n    extends: AnimCurve,\n\n    ctor () {\n        // cache last frame index\n        this._cachedIndex = 0;\n    },\n\n    properties: {\n\n        // The object being animated.\n        // @property target\n        // @type {object}\n        target: null,\n\n        // The name of the property being animated.\n        // @property prop\n        // @type {string}\n        prop: '',\n\n        // The values of the keyframes. (y)\n        // @property values\n        // @type {any[]}\n        values: [],\n\n        // The keyframe ratio of the keyframe specified as a number between 0.0 and 1.0 inclusive. (x)\n        // @property ratios\n        // @type {number[]}\n        ratios: [],\n\n        // @property types\n        // @param {object[]}\n        // Each array item maybe type:\n        // - [x, x, x, x]: Four control points for bezier\n        // - null: linear\n        types: [],\n    },\n\n    _findFrameIndex: binarySearch,\n    _lerp: undefined,\n\n    _lerpNumber (from, to, t) {\n        return from + (to - from) * t;\n    },\n\n    _lerpObject (from, to, t) {\n        return from.lerp(to, t);\n    },\n\n    _lerpQuat: (function () {\n        let out = cc.quat();\n        return function (from, to, t) {\n            return from.lerp(to, t, out);\n        };\n    })(),\n\n    _lerpVector: (function () {\n        let out = cc.v3();\n        return function (from, to, t) {\n            return from.lerp(to, t, out);\n        };\n    })(),\n\n    sample (time, ratio, state) {\n        let values = this.values;\n        let ratios = this.ratios;\n        let frameCount = ratios.length;\n\n        if (frameCount === 0) {\n            return;\n        }\n\n        // only need to refind frame index when ratio is out of range of last from ratio and to ratio.\n        let shoudRefind = true;\n        let cachedIndex = this._cachedIndex;\n        if (cachedIndex < 0) {\n            cachedIndex = ~cachedIndex;\n            if (cachedIndex > 0 && cachedIndex < ratios.length) {\n                let fromRatio = ratios[cachedIndex - 1];\n                let toRatio = ratios[cachedIndex];\n                if (ratio > fromRatio && ratio < toRatio) {\n                    shoudRefind = false;\n                }\n            }\n        }\n\n        if (shoudRefind) {\n            this._cachedIndex = this._findFrameIndex(ratios, ratio);\n        }\n\n        // evaluate value\n        let value;\n        let index = this._cachedIndex;\n        if (index < 0) {\n            index = ~index;\n\n            if (index <= 0) {\n                value = values[0];\n            }\n            else if (index >= frameCount) {\n                value = values[frameCount - 1];\n            }\n            else {\n                var fromVal = values[index - 1];\n\n                if (!this._lerp) {\n                    value = fromVal;\n                }\n                else {\n                    var fromRatio = ratios[index - 1];\n                    var toRatio = ratios[index];\n                    var type = this.types[index - 1];\n                    var ratioBetweenFrames = (ratio - fromRatio) / (toRatio - fromRatio);\n\n                    if (type) {\n                        ratioBetweenFrames = computeRatioByType(ratioBetweenFrames, type);\n                    }\n\n                    // calculate value\n                    var toVal = values[index];\n\n                    value = this._lerp(fromVal, toVal, ratioBetweenFrames);\n                }\n            }\n        }\n        else {\n            value = values[index];\n        }\n\n        this.target[this.prop] = value;\n    }\n});\n\nDynamicAnimCurve.Linear = null;\nDynamicAnimCurve.Bezier = function (controlPoints) {\n    return controlPoints;\n};\n\n\n/**\n * Event information,\n * @class EventInfo\n *\n */\nvar EventInfo = function () {\n    this.events = [];\n};\n\n/**\n * @param {Function} [func] event function\n * @param {Object[]} [params] event params\n */\nEventInfo.prototype.add = function (func, params) {\n    this.events.push({\n        func: func || '',\n        params: params || []\n    });\n};\n\n\n/**\n *\n * @class EventAnimCurve\n *\n * @extends AnimCurve\n */\nvar EventAnimCurve = cc.Class({\n    name: 'cc.EventAnimCurve',\n    extends: AnimCurve,\n\n    properties: {\n        /**\n         * The object being animated.\n         * @property target\n         * @type {object}\n         */\n        target: null,\n\n        /** The keyframe ratio of the keyframe specified as a number between 0.0 and 1.0 inclusive. (x)\n         * @property ratios\n         * @type {number[]}\n         */\n        ratios: [],\n\n        /**\n         * @property events\n         * @type {EventInfo[]}\n         */\n        events: [],\n\n        _wrappedInfo: {\n            default: function () {\n                return new WrappedInfo();\n            }\n        },\n\n        _lastWrappedInfo: null,\n\n        _ignoreIndex: NaN\n    },\n\n    _wrapIterations: function (iterations) {\n        if (iterations - (iterations | 0) === 0) iterations -= 1;\n        return iterations | 0;\n    },\n\n    sample: function (time, ratio, state) {\n        var length = this.ratios.length;\n\n        var currentWrappedInfo = state.getWrappedInfo(state.time, this._wrappedInfo);\n        var direction = currentWrappedInfo.direction;\n        var currentIndex = binarySearch(this.ratios, currentWrappedInfo.ratio);\n        if (currentIndex < 0) {\n            currentIndex = ~currentIndex - 1;\n\n            // if direction is inverse, then increase index\n            if (direction < 0) currentIndex += 1;\n        }\n\n        if (this._ignoreIndex !== currentIndex) {\n            this._ignoreIndex = NaN;\n        }\n\n        currentWrappedInfo.frameIndex = currentIndex;\n\n        if (!this._lastWrappedInfo) {\n            this._fireEvent(currentIndex);\n            this._lastWrappedInfo = new WrappedInfo(currentWrappedInfo);\n            return;\n        }\n\n        var wrapMode = state.wrapMode;\n        var currentIterations = this._wrapIterations(currentWrappedInfo.iterations);\n\n        var lastWrappedInfo = this._lastWrappedInfo;\n        var lastIterations = this._wrapIterations(lastWrappedInfo.iterations);\n        var lastIndex = lastWrappedInfo.frameIndex;\n        var lastDirection = lastWrappedInfo.direction;\n\n        var interationsChanged = lastIterations !== -1 && currentIterations !== lastIterations;\n\n        if (lastIndex === currentIndex && interationsChanged && length === 1) {\n            this._fireEvent(0);\n        }\n        else if (lastIndex !== currentIndex || interationsChanged) {\n            direction = lastDirection;\n\n            do {\n                if (lastIndex !== currentIndex) {\n                    if (direction === -1 && lastIndex === 0 && currentIndex > 0) {\n                        if ((wrapMode & WrapModeMask.PingPong) === WrapModeMask.PingPong) {\n                            direction *= -1;\n                        }\n                        else {\n                            lastIndex = length;\n                        }\n\n                        lastIterations ++;\n                    }\n                    else if (direction === 1 && lastIndex === length - 1 && currentIndex < length - 1) {\n                        if ((wrapMode & WrapModeMask.PingPong) === WrapModeMask.PingPong) {\n                            direction *= -1;\n                        }\n                        else {\n                            lastIndex = -1;\n                        }\n\n                        lastIterations ++;\n                    }\n\n                    if (lastIndex === currentIndex) break;\n                    if (lastIterations > currentIterations) break;\n                }\n\n                lastIndex += direction;\n\n                cc.director.getAnimationManager().pushDelayEvent(this, '_fireEvent', [lastIndex]);\n            } while (lastIndex !== currentIndex && lastIndex > -1 && lastIndex < length);\n        }\n\n        this._lastWrappedInfo.set(currentWrappedInfo);\n    },\n\n    _fireEvent: function (index) {\n        if (index < 0 || index >= this.events.length || this._ignoreIndex === index) return;\n\n        var eventInfo = this.events[index];\n        var events = eventInfo.events;\n        \n        if ( !this.target.isValid ) { \n            return; \n        }\n        \n        var components = this.target._components;\n\n        for (var i = 0;  i < events.length; i++) {\n            var event = events[i];\n            var funcName = event.func;\n\n            for (var j = 0; j < components.length; j++) {\n                var component = components[j];\n                var func = component[funcName];\n\n                if (func) func.apply(component, event.params);\n            }\n        }\n    },\n\n    onTimeChangedManually: function (time, state) {\n        this._lastWrappedInfo = null;\n        this._ignoreIndex = NaN;\n\n        var info = state.getWrappedInfo(time, this._wrappedInfo);\n        var direction = info.direction;\n        var frameIndex = binarySearch(this.ratios, info.ratio);\n\n        // only ignore when time not on a frame index\n        if (frameIndex < 0) {\n            frameIndex = ~frameIndex - 1;\n\n            // if direction is inverse, then increase index\n            if (direction < 0) frameIndex += 1;\n\n            this._ignoreIndex = frameIndex;\n        }\n    }\n});\n\n\nif (CC_TEST) {\n    cc._Test.DynamicAnimCurve = DynamicAnimCurve;\n    cc._Test.EventAnimCurve = EventAnimCurve;\n    cc._Test.quickFindIndex = quickFindIndex;\n}\n\nmodule.exports = {\n    AnimCurve: AnimCurve,\n    DynamicAnimCurve: DynamicAnimCurve,\n    EventAnimCurve: EventAnimCurve,\n    EventInfo: EventInfo,\n    computeRatioByType: computeRatioByType,\n    quickFindIndex: quickFindIndex\n};\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = cc.js;\n\nvar AnimationManager = cc.Class({\n    ctor: function () {\n        this._anims = new js.array.MutableForwardIterator([]);\n        this._delayEvents = [];\n\n        cc.director._scheduler && cc.director._scheduler.enableForTarget(this);\n    },\n\n    // for manager\n\n    update: function (dt) {\n        var iterator = this._anims;\n        var array = iterator.array;\n        for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n            var anim = array[iterator.i];\n            if (anim._isPlaying && !anim._isPaused) {\n                anim.update(dt);\n            }\n        }\n\n        var events = this._delayEvents;\n        for (let i = 0; i < events.length; i++) {\n            var event = events[i];\n            event.target[event.func].apply(event.target, event.args);\n        }\n        events.length = 0;\n        \n    },\n\n    destruct: function () {},\n\n\n    /**\n     * @param {AnimationState} anim\n     */\n    addAnimation: function (anim) {\n        var index = this._anims.array.indexOf(anim);\n        if (index === -1) {\n            this._anims.push(anim);\n        }\n    },\n\n    /**\n     * @param {AnimationState} anim\n     */\n    removeAnimation: function (anim) {\n        var index = this._anims.array.indexOf(anim);\n        if (index >= 0) {\n            this._anims.fastRemoveAt(index);\n        }\n        else {\n            cc.errorID(3907);\n        }\n    },\n\n    pushDelayEvent: function (target, func, args) {\n        this._delayEvents.push({\n            target: target,\n            func: func,\n            args: args\n        });\n    }\n});\n\n\ncc.AnimationManager = module.exports = AnimationManager;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n\nvar js = cc.js;\nvar Playable = require('./playable');\n\nvar Types = require('./types');\nvar WrappedInfo = Types.WrappedInfo;\nvar WrapMode = Types.WrapMode;\nvar WrapModeMask = Types.WrapModeMask;\n\n/**\n * !#en\n * The AnimationState gives full control over animation playback process.\n * In most cases the Animation Component is sufficient and easier to use. Use the AnimationState if you need full control.\n * !#zh\n * AnimationState 完全控制动画播放过程。<br/>\n * 大多数情况下 动画组件 是足够和易于使用的。如果您需要更多的动画控制接口，请使用 AnimationState。\n * @class AnimationState\n * @extends Playable\n *\n */\n\n/**\n * @method constructor\n * @param {AnimationClip} clip\n * @param {String} [name]\n */\nfunction AnimationState (clip, name) {\n    Playable.call(this);\n    \n    // Mark whether the current frame is played.\n    // When set new time to animation state, we should ensure the frame at the specified time being played at next update.\n    this._currentFramePlayed = false;\n    \n    this._delay = 0;\n    this._delayTime = 0;\n\n    this._wrappedInfo = new WrappedInfo();\n    this._lastWrappedInfo = null;\n\n    this._process = process;\n\n    this._clip = clip;\n    this._name = name || (clip && clip.name);\n\n    /**\n     * @property animator\n     * @type {AnimationAnimator}\n     * @private\n     */\n    this.animator = null;\n\n    /**\n     * !#en The curves list.\n     * !#zh 曲线列表。\n     * @property curves\n     * @type {Object[]}\n     */\n    this.curves = [];\n\n    // http://www.w3.org/TR/web-animations/#idl-def-AnimationTiming\n\n    /**\n     * !#en The start delay which represents the number of seconds from an animation's start time to the start of\n     * the active interval.\n     * !#zh 延迟多少秒播放。\n     *\n     * @property delay\n     * @type {Number}\n     * @default 0\n     */\n    this.delay = 0;\n\n    /**\n     * !#en The animation's iteration count property.\n     *\n     * A real number greater than or equal to zero (including positive infinity) representing the number of times\n     * to repeat the animation node.\n     *\n     * Values less than zero and NaN values are treated as the value 1.0 for the purpose of timing model\n     * calculations.\n     *\n     * !#zh 迭代次数，指动画播放多少次后结束, normalize time。 如 2.5（2次半）\n     *\n     * @property repeatCount\n     * @type {Number}\n     * @default 1\n     */\n    this.repeatCount = 1;\n\n    /**\n     * !#en The iteration duration of this animation in seconds. (length)\n     * !#zh 单次动画的持续时间，秒。\n     *\n     * @property duration\n     * @type {Number}\n     * @readOnly\n     */\n    this.duration = 1;\n\n    /**\n     * !#en The animation's playback speed. 1 is normal playback speed.\n     * !#zh 播放速率。\n     * @property speed\n     * @type {Number}\n     * @default: 1.0\n     */\n    this.speed = 1;\n\n    /**\n     * !#en\n     * Wrapping mode of the playing animation.\n     * Notice : dynamic change wrapMode will reset time and repeatCount property\n     * !#zh\n     * 动画循环方式。\n     * 需要注意的是，动态修改 wrapMode 时，会重置 time 以及 repeatCount\n     *\n     * @property wrapMode\n     * @type {WrapMode}\n     * @default: WrapMode.Normal\n     */\n    this.wrapMode = WrapMode.Normal;\n\n    /**\n     * !#en The current time of this animation in seconds.\n     * !#zh 动画当前的时间，秒。\n     * @property time\n     * @type {Number}\n     * @default 0\n     */\n    this.time = 0;\n\n    // Animation as event target\n    this._target = null;\n    this._lastframeEventOn = false;\n    this.emit = function () {\n        var args = new Array(arguments.length);\n        for (var i = 0, l = args.length; i < l; i++) {\n            args[i] = arguments[i];\n        }\n        cc.director.getAnimationManager().pushDelayEvent(this, '_emit', args);\n    };\n}\njs.extend(AnimationState, Playable);\n\nvar proto = AnimationState.prototype;\n\nproto._emit = function (type, state) {\n    if (this._target && this._target.isValid) {\n        this._target.emit(type, type, state);\n    }\n};\n\nproto.on = function (type, callback, target) {\n    if (this._target && this._target.isValid) {\n        if (type === 'lastframe') {\n            this._lastframeEventOn = true;\n        }\n        return this._target.on(type, callback, target);\n    }\n    else {\n        return null;\n    }\n};\n\nproto.once = function (type, callback, target) {\n    if (this._target && this._target.isValid) {\n        if (type === 'lastframe') {\n            this._lastframeEventOn = true;\n        }\n        let self = this;\n        return this._target.once(type, function (event) {\n            callback.call(target, event);\n            self._lastframeEventOn = false;\n        });\n    }\n    else {\n        return null;\n    }\n};\n\nproto.off = function (type, callback, target) {\n    if (this._target && this._target.isValid) {\n        if (type === 'lastframe') {\n            if (!this._target.hasEventListener(type)) {\n                this._lastframeEventOn = false;\n            }\n        }\n        this._target.off(type, callback, target);\n    }\n};\n\nproto._setEventTarget = function (target) {\n    this._target = target;\n};\n\nproto.onPlay = function () {\n    // replay\n    this.setTime(0);\n    this._delayTime = this._delay;\n    \n    cc.director.getAnimationManager().addAnimation(this);\n\n    if (this.animator) {\n        this.animator.addAnimation(this);\n    }\n    \n    this.emit('play', this);\n};\n\nproto.onStop = function () {\n    if (!this.isPaused) {\n        cc.director.getAnimationManager().removeAnimation(this);\n    }\n\n    if (this.animator) {\n        this.animator.removeAnimation(this);\n    }\n\n    this.emit('stop', this);\n};\n\nproto.onResume = function () {\n    cc.director.getAnimationManager().addAnimation(this);\n    this.emit('resume', this);\n};\n\nproto.onPause = function () {\n    cc.director.getAnimationManager().removeAnimation(this);\n    this.emit('pause', this);\n};\n\nproto.setTime = function (time) {\n    this._currentFramePlayed = false;\n    this.time = time || 0;\n\n    var curves = this.curves;\n    for (var i = 0, l = curves.length; i < l; i++) {\n        var curve = curves[i];\n        if (curve.onTimeChangedManually) {\n            curve.onTimeChangedManually(time, this);\n        }\n    }\n};\n\nfunction process () {\n    // sample\n    var info = this.sample();\n\n    if (this._lastframeEventOn) {\n        var lastInfo;\n        if (!this._lastWrappedInfo) {\n            lastInfo = this._lastWrappedInfo = new WrappedInfo(info);\n        } else {\n            lastInfo = this._lastWrappedInfo;\n        }\n\n        if (this.repeatCount > 1 && ((info.iterations | 0) > (lastInfo.iterations | 0))) {\n            this.emit('lastframe', this);\n        }\n\n        lastInfo.set(info);\n    }\n\n    if (info.stopped) {\n        this.stop();\n        this.emit('finished', this);\n    }\n}\n\nfunction simpleProcess () {\n    var time = this.time;\n    var duration = this.duration;\n\n    if (time > duration) {\n        time = time % duration;\n        if (time === 0) time = duration;\n    }\n    else if (time < 0) {\n        time = time % duration;\n        if (time !== 0) time += duration;\n    }\n\n    var ratio = time / duration;\n\n    var curves = this.curves;\n    for (var i = 0, len = curves.length; i < len; i++) {\n        var curve = curves[i];\n        curve.sample(time, ratio, this);\n    }\n\n    if (this._lastframeEventOn) {\n        if (this._lastIterations === undefined) {\n            this._lastIterations = ratio;\n        }\n\n        if ((this.time > 0 && this._lastIterations > ratio) || (this.time < 0 && this._lastIterations < ratio)) {\n            this.emit('lastframe', this);\n        }\n\n        this._lastIterations = ratio;\n    }\n}\n\nproto.update = function (delta) {\n    // calculate delay time\n\n    if (this._delayTime > 0) {\n        this._delayTime -= delta;\n        if (this._delayTime > 0) {\n            // still waiting\n            return;\n        }\n    }\n\n    // make first frame perfect\n\n    //var playPerfectFirstFrame = (this.time === 0);\n    if (this._currentFramePlayed) {\n        this.time += (delta * this.speed);\n    }\n    else {\n        this._currentFramePlayed = true;\n    }\n\n    this._process();\n};\n\nproto._needRevers = function (currentIterations) {\n    var wrapMode = this.wrapMode;\n    var needRevers = false;\n\n    if ((wrapMode & WrapModeMask.PingPong) === WrapModeMask.PingPong) {\n        var isEnd = currentIterations - (currentIterations | 0) === 0;\n        if (isEnd && (currentIterations > 0)) {\n            currentIterations -= 1;\n        }\n\n        var isOddIteration = currentIterations & 1;\n        if (isOddIteration) {\n            needRevers = !needRevers;\n        }\n    }\n    if ((wrapMode & WrapModeMask.Reverse) === WrapModeMask.Reverse) {\n        needRevers = !needRevers;\n    }\n    return needRevers;\n};\n\nproto.getWrappedInfo = function (time, info) {\n    info = info || new WrappedInfo();\n    \n    var stopped = false;\n    var duration = this.duration;\n    var repeatCount = this.repeatCount;\n\n    var currentIterations = time > 0 ? (time / duration) : -(time / duration);\n    if (currentIterations >= repeatCount) {\n        currentIterations = repeatCount;\n\n        stopped = true;\n        var tempRatio = repeatCount - (repeatCount | 0);\n        if (tempRatio === 0) {\n            tempRatio = 1;  // 如果播放过，动画不复位\n        }\n        time = tempRatio * duration * (time > 0 ? 1 : -1);\n    }\n\n    if (time > duration) {\n        var tempTime = time % duration;\n        time = tempTime === 0 ? duration : tempTime;\n    }\n    else if (time < 0) {\n        time = time % duration;\n        if (time !== 0 ) time += duration;\n    }\n\n    var needRevers = false;\n    var shouldWrap = this._wrapMode & WrapModeMask.ShouldWrap;\n    if (shouldWrap) {\n        needRevers = this._needRevers(currentIterations);\n    }\n\n    var direction = needRevers ? -1 : 1;\n    if (this.speed < 0) {\n        direction *= -1;\n    }\n\n    // calculate wrapped time\n    if (shouldWrap && needRevers) {\n        time = duration - time;\n    }\n\n    info.ratio = time / duration;\n    info.time = time;\n    info.direction = direction;\n    info.stopped = stopped;\n    info.iterations = currentIterations;\n\n    return info;\n};\n\nproto.sample = function () {\n    var info = this.getWrappedInfo(this.time, this._wrappedInfo);\n    var curves = this.curves;\n    for (var i = 0, len = curves.length; i < len; i++) {\n        var curve = curves[i];\n        curve.sample(info.time, info.ratio, this);\n    }\n\n    return info;\n};\n\n\n/**\n * !#en The clip that is being played by this animation state.\n * !#zh 此动画状态正在播放的剪辑。\n * @property clip\n * @type {AnimationClip}\n * @final\n */\njs.get(proto, 'clip', function () {\n    return this._clip;\n});\n\n/**\n * !#en The name of the playing animation.\n * !#zh 动画的名字\n * @property name\n * @type {String}\n * @readOnly\n */\njs.get(proto, 'name', function () {\n    return this._name;\n});\n\njs.obsolete(proto, 'AnimationState.length', 'duration');\n\njs.getset(proto, 'curveLoaded',\n    function () {\n        return this.curves.length > 0;\n    },\n    function () {\n        this.curves.length = 0;\n    }\n);\n\n\njs.getset(proto, 'wrapMode',\n    function () {\n        return this._wrapMode;\n    },\n    function (value) {\n        this._wrapMode = value;\n\n        if (CC_EDITOR) return;\n\n        // dynamic change wrapMode will need reset time to 0\n        this.time = 0;\n\n        if (value & WrapModeMask.Loop) {\n            this.repeatCount = Infinity;\n        }\n        else {\n            this.repeatCount = 1;\n        }\n        \n    }\n);\n\njs.getset(proto, 'repeatCount',\n    function () {\n        return this._repeatCount;\n    },\n    function (value) {\n        this._repeatCount = value;\n        \n        var shouldWrap = this._wrapMode & WrapModeMask.ShouldWrap;\n        var reverse = (this.wrapMode & WrapModeMask.Reverse) === WrapModeMask.Reverse;\n        if (value === Infinity && !shouldWrap && !reverse) {\n            this._process = simpleProcess;\n        }\n        else {\n            this._process = process;\n        }\n    }\n);\n\njs.getset(proto, 'delay', \n    function () {\n        return this._delay;\n    },\n    function (value) {\n        this._delayTime = this._delay = value;\n    }\n);\n\n\ncc.AnimationState = module.exports = AnimationState;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n//var bezier = (function () {\n//    function B1 (t) { return (t * t * t); }\n//    function B2 (t) { return (3 * t * t * (1 - t)); }\n//    function B3 (t) { return (3 * t * (1 - t) * (1 - t)); }\n//    function B4 (t) { return ((1 - t) * (1 - t) * (1 - t)); }\n//    function bezier (C1, C2, C3, C4, t) {\n//        return C1 * B1(t) + C2 * B2(t) + C3 * B3(t) + C4 * B4(t);\n//    }\n//\n//    //function bezier (C1, C2, C3, C4, t, out) {\n//    //    out.x = C1.x * B1(t) + C2.x * B2(t) + C3.x * B3(t) + C4.x * B4(t);\n//    //    out.y = C1.y * B1(t) + C2.y * B2(t) + C3.y * B3(t) + C4.y * B4(t);\n//    //}\n//\n//    return bezier;\n//})();\nfunction bezier (C1, C2, C3, C4, t) {\n    var t1 = 1 - t;\n    return t1 * (t1 * (C1 + (C2 * 3 - C1) * t) + C3 * 3 * t * t) + C4 * t * t * t;\n}\n//function bezier (c0, c1, c2, c3, t) {\n//    var cy = 3.0 * (c1);\n//    var by = 3.0 * (c3 - c1) - cy;\n//    var ay = 1 - cy - by;\n//    return (ay * t * t * t) + (by * t * t) + (cy * t);\n//}\n\n//var sin = Math.sin;\nvar cos = Math.cos,\n    acos = Math.acos,\n    max = Math.max,\n    //atan2 = Math.atan2,\n    pi = Math.PI,\n    tau = 2 * pi,\n    sqrt = Math.sqrt;\n\nfunction crt (v) {\n    if (v < 0) {\n        return -Math.pow(-v, 1 / 3);\n    }\n    else {\n        return Math.pow(v, 1 / 3);\n    }\n}\n\n//function align (curve, line) {\n//    var tx = line.p1.x,\n//        ty = line.p1.y,\n//        a = -atan2(line.p2.y-ty, line.p2.x-tx);\n//    curve = [{x:0, y:1}, {x: curve[0], y: 1-curve[1]}, {x: curve[2], y: 1-curve[3]}, {x:1, y:0}];\n//    return curve.map(function(v) {\n//        return {\n//            x: (v.x-tx)*cos(a) - (v.y-ty)*sin(a),\n//            y: (v.x-tx)*sin(a) + (v.y-ty)*cos(a)\n//        };\n//    });\n//}\n\n// Modified from http://jsbin.com/yibipofeqi/1/edit, optimized for animations.\n// The origin Cardano's algorithm is based on http://www.trans4mind.com/personal_development/mathematics/polynomials/cubicAlgebra.htm\nfunction cardano (curve, x) {\n    // align curve with the intersecting line:\n        //var line = {p1: {x: x, y: 0}, p2: {x: x, y: 1}};\n        //var aligned = align(curve, line);\n        //// and rewrite from [a(1-t)^3 + 3bt(1-t)^2 + 3c(1-t)t^2 + dt^3] form\n        //    pa = aligned[0].y,\n        //    pb = aligned[1].y,\n        //    pc = aligned[2].y,\n        //    pd = aligned[3].y;\n        ////// curve = [{x:0, y:1}, {x: curve[0], y: 1-curve[1]}, {x: curve[2], y: 1-curve[3]}, {x:1, y:0}];\n    var pa = x - 0;\n    var pb = x - curve[0];\n    var pc = x - curve[2];\n    var pd = x - 1;\n\n    // to [t^3 + at^2 + bt + c] form:\n    var pa3 = pa * 3;\n    var pb3 = pb * 3;\n    var pc3 = pc * 3;\n    var d = (-pa + pb3 - pc3 + pd),\n        rd = 1 / d,\n        r3 = 1 / 3,\n        a = (pa3 - 6 * pb + pc3) * rd,\n        a3 = a * r3,\n        b = (-pa3 + pb3) * rd,\n        c = pa * rd,\n    // then, determine p and q:\n        p = (3 * b - a * a) * r3,\n        p3 = p * r3,\n        q = (2 * a * a * a - 9 * a * b + 27 * c) / 27,\n        q2 = q / 2,\n    // and determine the discriminant:\n        discriminant = q2 * q2 + p3 * p3 * p3,\n    // and some reserved variables\n        u1, v1, x1, x2, x3;\n\n    // If the discriminant is negative, use polar coordinates\n    // to get around square roots of negative numbers\n    if (discriminant < 0) {\n        var mp3 = -p * r3,\n            mp33 = mp3 * mp3 * mp3,\n            r = sqrt(mp33),\n        // compute cosphi corrected for IEEE float rounding:\n            t = -q / (2 * r),\n            cosphi = t < -1 ? -1 : t > 1 ? 1 : t,\n            phi = acos(cosphi),\n            crtr = crt(r),\n            t1 = 2 * crtr;\n        x1 = t1 * cos(phi * r3) - a3;\n        x2 = t1 * cos((phi + tau) * r3) - a3;\n        x3 = t1 * cos((phi + 2 * tau) * r3) - a3;\n\n        // choose best percentage\n        if (0 <= x1 && x1 <= 1) {\n            if (0 <= x2 && x2 <= 1) {\n                if (0 <= x3 && x3 <= 1) {\n                    return max(x1, x2, x3);\n                }\n                else {\n                    return max(x1, x2);\n                }\n            }\n            else if (0 <= x3 && x3 <= 1) {\n                return max(x1, x3);\n            }\n            else {\n                return x1;\n            }\n        }\n        else {\n            if (0 <= x2 && x2 <= 1) {\n                if (0 <= x3 && x3 <= 1) {\n                    return max(x2, x3);\n                }\n                else {\n                    return x2;\n                }\n            }\n            else {\n                return x3;\n            }\n        }\n    }\n    else if (discriminant === 0) {\n        u1 = q2 < 0 ? crt(-q2) : -crt(q2);\n        x1 = 2 * u1 - a3;\n        x2 = -u1 - a3;\n\n        // choose best percentage\n        if (0 <= x1 && x1 <= 1) {\n            if (0 <= x2 && x2 <= 1) {\n                return max(x1, x2);\n            }\n            else {\n                return x1;\n            }\n        }\n        else {\n            return x2;\n        }\n    }\n    // one real root, and two imaginary roots\n    else {\n        var sd = sqrt(discriminant);\n        u1 = crt(-q2 + sd);\n        v1 = crt(q2 + sd);\n        x1 = u1 - v1 - a3;\n        return x1;\n    }\n}\n\nfunction bezierByTime (controlPoints, x) {\n    var percent = cardano(controlPoints, x);    // t\n    var p1y = controlPoints[1]; // b\n    var p2y = controlPoints[3]; // c\n    // return bezier(0, p1y, p2y, 1, percent);\n    return ((1 - percent) * (p1y + (p2y - p1y) * percent) * 3 + percent * percent) * percent;\n}\n\nif (CC_TEST) {\n    cc._Test.bezier = bezier;\n    cc._Test.bezierByTime = bezierByTime;\n}\n\nmodule.exports = {\n    bezier: bezier,\n    bezierByTime: bezierByTime\n};\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * @module cc\n */\n\n /**\n  * !#en\n  * This class provide easing methods for {{#crossLink \"tween\"}}{{/crossLink}} class.<br>\n  * Demonstratio: https://easings.net/\n  * !#zh\n  * 缓动函数类，为 {{#crossLink \"Tween\"}}{{/crossLink}} 提供缓动效果函数。<br>\n  * 函数效果演示： https://easings.net/\n  * @class Easing\n  */\n\nvar easing = {\n    constant: function () { return 0; },\n    linear: function (k) { return k; },\n\n    // quad\n    //  easing equation function for a quadratic (t^2)\n    //  @param t: Current time (in frames or seconds).\n    //  @return: The correct value.\n\n    /**\n     * !#en Easing in with quadratic formula. From slow to fast.\n     * !#zh 平方曲线缓入函数。运动由慢到快。\n     * @method quadIn\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value\n     */\n    quadIn: function (k) { return k * k; },\n    /**\n     * !#en Easing out with quadratic formula. From fast to slow.\n     * !#zh 平方曲线缓出函数。运动由快到慢。\n     * @method quadOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value\n     */\n    quadOut: function (k) { return k * ( 2 - k ); },\n    /**\n     * !#en Easing in and out with quadratic formula. From slow to fast, then back to slow.\n     * !#zh 平方曲线缓入缓出函数。运动由慢到快再到慢。\n     * @method quadInOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value\n     */\n    quadInOut: function (k) {\n        if (( k *= 2 ) < 1) {\n            return 0.5 * k * k;\n        }\n        return -0.5 * ( --k * ( k - 2 ) - 1 );\n    },\n\n    // cubic\n    //  easing equation function for a cubic (t^3)\n    //  @param t: Current time (in frames or seconds).\n    //  @return: The correct value.\n\n    /**\n     * !#en Easing in with cubic formula. From slow to fast.\n     * !#zh 立方曲线缓入函数。运动由慢到快。\n     * @method cubicIn\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    cubicIn: function (k) { return k * k * k; },\n    /**\n     * !#en Easing out with cubic formula. From slow to fast.\n     * !#zh 立方曲线缓出函数。运动由快到慢。\n     * @method cubicOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    cubicOut: function (k) { return --k * k * k + 1; },\n    /**\n     * !#en Easing in and out with cubic formula. From slow to fast, then back to slow.\n     * !#zh 立方曲线缓入缓出函数。运动由慢到快再到慢。\n     * @method cubicInOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    cubicInOut: function (k) {\n        if (( k *= 2 ) < 1) {\n            return 0.5 * k * k * k;\n        }\n        return 0.5 * ( ( k -= 2 ) * k * k + 2 );\n    },\n\n    // quart\n    //  easing equation function for a quartic (t^4)\n    //  @param t: Current time (in frames or seconds).\n    //  @return: The correct value.\n\n    /**\n     * !#en Easing in with quartic formula. From slow to fast.\n     * !#zh 四次方曲线缓入函数。运动由慢到快。\n     * @method quartIn\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    quartIn: function (k) { return k * k * k * k; },\n    /**\n     * !#en Easing out with quartic formula. From fast to slow.\n     * !#zh 四次方曲线缓出函数。运动由快到慢。\n     * @method quartOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    quartOut: function (k) { return 1 - ( --k * k * k * k ); },\n    /**\n     * !#en Easing in and out with quartic formula. From slow to fast, then back to slow.\n     * !#zh 四次方曲线缓入缓出函数。运动由慢到快再到慢。\n     * @method quartInOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    quartInOut:  function (k) {\n        if (( k *= 2 ) < 1) {\n            return 0.5 * k * k * k * k;\n        }\n        return -0.5 * ( ( k -= 2 ) * k * k * k - 2 );\n    },\n\n    // quint\n    //  easing equation function for a quintic (t^5)\n    //  @param t: Current time (in frames or seconds).\n    //  @return: The correct value.\n\n    /**\n     * !#en Easing in with quintic formula. From slow to fast.\n     * !#zh 五次方曲线缓入函数。运动由慢到快。\n     * @method quintIn\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    quintIn: function (k) { return k * k * k * k * k; },\n    /**\n     * !#en Easing out with quintic formula. From fast to slow.\n     * !#zh 五次方曲线缓出函数。运动由快到慢。\n     * @method quintOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    quintOut: function (k) { return --k * k * k * k * k + 1; },\n    /**\n     * !#en Easing in and out with quintic formula. From slow to fast, then back to slow.\n     * !#zh 五次方曲线缓入缓出函数。运动由慢到快再到慢。\n     * @method quintInOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    quintInOut: function (k) {\n        if (( k *= 2 ) < 1) {\n            return 0.5 * k * k * k * k * k;\n        }\n        return 0.5 * ( ( k -= 2 ) * k * k * k * k + 2 );\n    },\n\n    // sine\n    //  easing equation function for a sinusoidal (sin(t))\n    //  @param t: Current time (in frames or seconds).\n    //  @return: The correct value.\n\n    /**\n     * !#en Easing in and out with sine formula. From slow to fast.\n     * !#zh 正弦曲线缓入函数。运动由慢到快。\n     * @method sineIn\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    sineIn: function (k) { return 1 - Math.cos(k * Math.PI / 2); },\n    /**\n     * !#en Easing in and out with sine formula. From fast to slow.\n     * !#zh 正弦曲线缓出函数。运动由快到慢。\n     * @method sineOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    sineOut: function (k) { return Math.sin(k * Math.PI / 2); },\n    /**\n     * !#en Easing in and out with sine formula. From slow to fast, then back to slow.\n     * !#zh 正弦曲线缓入缓出函数。运动由慢到快再到慢。\n     * @method sineInOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    sineInOut: function (k) { return 0.5 * ( 1 - Math.cos(Math.PI * k) ); },\n\n    // expo\n    //  easing equation function for an exponential (2^t)\n    //  param t: Current time (in frames or seconds).\n    //  return: The correct value.\n\n    /**\n     * !#en Easing in and out with exponential formula. From slow to fast.\n     * !#zh 指数曲线缓入函数。运动由慢到快。\n     * @method expoIn\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    expoIn: function (k) { return k === 0 ? 0 : Math.pow(1024, k - 1); },\n    /**\n     * !#en Easing in and out with exponential formula. From fast to slow.\n     * !#zh 指数曲线缓出函数。运动由快到慢。\n     * @method expoOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    expoOut: function (k) { return k === 1 ? 1 : 1 - Math.pow(2, -10 * k); },\n    /**\n     * !#en Easing in and out with exponential formula. From slow to fast.\n     * !#zh 指数曲线缓入和缓出函数。运动由慢到很快再到慢。\n     * @method expoInOut\n     * @param {Number} t The current time as a percentage of the total time, then back to slow.\n     * @return {Number} The correct value.\n     */\n    expoInOut: function (k) {\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if (( k *= 2 ) < 1) {\n            return 0.5 * Math.pow(1024, k - 1);\n        }\n        return 0.5 * ( -Math.pow(2, -10 * ( k - 1 )) + 2 );\n    },\n\n    // circ\n    //  easing equation function for a circular (sqrt(1-t^2))\n    //  @param t: Current time (in frames or seconds).\n    //  @return:\tThe correct value.\n\n    /**\n     * !#en Easing in and out with circular formula. From slow to fast.\n     * !#zh 循环公式缓入函数。运动由慢到快。\n     * @method circIn\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    circIn: function (k) { return 1 - Math.sqrt(1 - k * k); },\n    /**\n     * !#en Easing in and out with circular formula. From fast to slow.\n     * !#zh 循环公式缓出函数。运动由快到慢。\n     * @method circOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    circOut: function (k) { return Math.sqrt(1 - ( --k * k )); },\n    /**\n     * !#en Easing in and out with circular formula. From slow to fast.\n     * !#zh 指数曲线缓入缓出函数。运动由慢到很快再到慢。\n     * @method circInOut\n     * @param {Number} t The current time as a percentage of the total time, then back to slow.\n     * @return {Number} The correct value.\n     */\n    circInOut: function (k) {\n        if (( k *= 2 ) < 1) {\n            return -0.5 * ( Math.sqrt(1 - k * k) - 1);\n        }\n        return 0.5 * ( Math.sqrt(1 - ( k -= 2) * k) + 1);\n    },\n\n    // elastic\n    //  easing equation function for an elastic (exponentially decaying sine wave)\n    //  @param t: Current time (in frames or seconds).\n    //  @return: The correct value.\n    //  recommand value: elastic (t)\n\n    /**\n     * !#en Easing in action with a spring oscillating effect.\n     * !#zh 弹簧回震效果的缓入函数。\n     * @method elasticIn\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    elasticIn: function (k) {\n        var s, a = 0.1, p = 0.4;\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if (!a || a < 1) {\n            a = 1;\n            s = p / 4;\n        }\n        else {\n            s = p * Math.asin(1 / a) / ( 2 * Math.PI );\n        }\n        return -( a * Math.pow(2, 10 * ( k -= 1 )) * Math.sin(( k - s ) * ( 2 * Math.PI ) / p) );\n    },\n    /**\n     * !#en Easing out action with a spring oscillating effect.\n     * !#zh 弹簧回震效果的缓出函数。\n     * @method elasticOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    elasticOut: function (k) {\n        var s, a = 0.1, p = 0.4;\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if (!a || a < 1) {\n            a = 1;\n            s = p / 4;\n        }\n        else {\n            s = p * Math.asin(1 / a) / ( 2 * Math.PI );\n        }\n        return ( a * Math.pow(2, -10 * k) * Math.sin(( k - s ) * ( 2 * Math.PI ) / p) + 1 );\n    },\n    /**\n     * !#en Easing in and out action with a spring oscillating effect.\n     * !#zh 弹簧回震效果的缓入缓出函数。\n     * @method elasticInOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    elasticInOut: function (k) {\n        var s, a = 0.1, p = 0.4;\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if (!a || a < 1) {\n            a = 1;\n            s = p / 4;\n        }\n        else {\n            s = p * Math.asin(1 / a) / ( 2 * Math.PI );\n        }\n        if (( k *= 2 ) < 1) {\n            return -0.5 *\n                   ( a * Math.pow(2, 10 * ( k -= 1 )) * Math.sin(( k - s ) * ( 2 * Math.PI ) / p) );\n        }\n        return a * Math.pow(2, -10 * ( k -= 1 )) * Math.sin(( k - s ) * ( 2 * Math.PI ) / p) * 0.5 + 1;\n    },\n\n    // back\n    //  easing equation function for a back (overshooting cubic easing: (s+1)*t^3 - s*t^2)\n    //  @param t: Current time (in frames or seconds).\n    //  @return: The correct value.\n\n    /**\n     * !#en Easing in action with \"back up\" behavior.\n     * !#zh 回退效果的缓入函数。\n     * @method backIn\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    backIn: function (k) {\n        var s = 1.70158;\n        return k * k * ( ( s + 1 ) * k - s );\n    },\n    /**\n     * !#en Easing out action with \"back up\" behavior.\n     * !#zh 回退效果的缓出函数。\n     * @method backOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    backOut: function (k) {\n        var s = 1.70158;\n        return --k * k * ( ( s + 1 ) * k + s ) + 1;\n    },\n    /**\n     * !#en Easing in and out action with \"back up\" behavior.\n     * !#zh 回退效果的缓入缓出函数。\n     * @method backInOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    backInOut: function (k) {\n        var s = 1.70158 * 1.525;\n        if (( k *= 2 ) < 1) {\n            return 0.5 * ( k * k * ( ( s + 1 ) * k - s ) );\n        }\n        return 0.5 * ( ( k -= 2 ) * k * ( ( s + 1 ) * k + s ) + 2 );\n    },\n\n    // bounce\n    //  easing equation function for a bounce (exponentially decaying parabolic bounce)\n    //  @param t: Current time (in frames or seconds).\n    //  @return: The correct value.\n\n    /**\n     * !#en Easing in action with bouncing effect.\n     * !#zh 弹跳效果的缓入函数。\n     * @method bounceIn\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    bounceIn: function (k) {\n        return 1 - easing.bounceOut(1 - k);\n    },\n    /**\n     * !#en Easing out action with bouncing effect.\n     * !#zh 弹跳效果的缓出函数。\n     * @method bounceOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    bounceOut: function (k) {\n        if (k < ( 1 / 2.75 )) {\n            return 7.5625 * k * k;\n        }\n        else if (k < ( 2 / 2.75 )) {\n            return 7.5625 * ( k -= ( 1.5 / 2.75 ) ) * k + 0.75;\n        }\n        else if (k < ( 2.5 / 2.75 )) {\n            return 7.5625 * ( k -= ( 2.25 / 2.75 ) ) * k + 0.9375;\n        }\n        else {\n            return 7.5625 * ( k -= ( 2.625 / 2.75 ) ) * k + 0.984375;\n        }\n    },\n    /**\n     * !#en Easing in and out action with bouncing effect.\n     * !#zh 弹跳效果的缓入缓出函数。\n     * @method bounceInOut\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    bounceInOut: function (k) {\n        if (k < 0.5) {\n            return easing.bounceIn(k * 2) * 0.5;\n        }\n        return easing.bounceOut(k * 2 - 1) * 0.5 + 0.5;\n    },\n\n    /**\n     * !#en Target will run action with smooth effect.\n     * !#zh 平滑效果函数。\n     * @method smooth\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    // t<=0: 0 | 0<t<1: 3*t^2 - 2*t^3 | t>=1: 1\n    smooth: function (t) {\n        if (t <= 0) {\n            return 0;\n        }\n        if (t >= 1) {\n            return 1;\n        }\n        return t * t * (3 - 2 * t);\n    },\n\n    /**\n     * !#en Target will run action with fade effect.\n     * !#zh 渐褪效果函数。\n     * @method fade\n     * @param {Number} t The current time as a percentage of the total time.\n     * @return {Number} The correct value.\n     */\n    // t<=0: 0 | 0<t<1: 6*t^5 - 15*t^4 + 10*t^3 | t>=1: 1\n    fade: function (t) {\n        if (t <= 0) {\n            return 0;\n        }\n        if (t >= 1) {\n            return 1;\n        }\n        return t * t * t * (t * (t * 6 - 15) + 10);\n    },\n};\n\nfunction _makeOutIn (fnIn, fnOut) {\n    return function (k) {\n        if (k < 0.5) {\n            return fnOut(k * 2) / 2;\n        }\n        return fnIn(2 * k - 1) / 2 + 0.5;\n    };\n}\neasing.quadOutIn = _makeOutIn(easing.quadIn, easing.quadOut);\neasing.cubicOutIn = _makeOutIn(easing.cubicIn, easing.cubicOut);\neasing.quartOutIn = _makeOutIn(easing.quartIn, easing.quartOut);\neasing.quintOutIn = _makeOutIn(easing.quintIn, easing.quintOut);\neasing.sineOutIn = _makeOutIn(easing.sineIn, easing.sineOut);\neasing.expoOutIn = _makeOutIn(easing.expoIn, easing.expoOut);\neasing.circOutIn = _makeOutIn(easing.circIn, easing.circOut);\neasing.backOutIn = _makeOutIn(easing.backIn, easing.backOut);\neasing.bounceIn = function (k) { return 1 - easing.bounceOut(1 - k); };\neasing.bounceInOut = function (k) {\n    if (k < 0.5) {\n        return easing.bounceIn(k * 2) * 0.5;\n    }\n    return easing.bounceOut(k * 2 - 1) * 0.5 + 0.5;\n};\neasing.bounceOutIn = _makeOutIn(easing.bounceIn, easing.bounceOut);\n\n/**\n * @module cc\n */\n\n/**\n * !#en This is a Easing instance.\n * !#zh 这是一个 Easing 类实例。\n * @property easing\n * @type Easing\n */\n\ncc.easing = module.exports = easing;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('./bezier');\nrequire('./easing');\nrequire('./types');\nrequire('./motion-path-helper');\nrequire('./animation-curves');\nrequire('./animation-clip');\nrequire('./animation-manager');\nrequire('./animation-state');\nrequire('./animation-animator');\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar DynamicAnimCurve = require('./animation-curves').DynamicAnimCurve;\nvar computeRatioByType = require('./animation-curves').computeRatioByType;\n\nvar bezier = require('./bezier').bezier;\nvar binarySearch = require('../core/utils/binary-search').binarySearchEpsilon;\n\nvar v2 = cc.v2;\n\nfunction Curve (points) {\n    this.points = points || [];\n    this.beziers = [];\n    this.ratios = [];\n    this.progresses = [];\n\n    this.length = 0;\n\n    this.computeBeziers();\n}\nCurve.prototype.computeBeziers = function () {\n    this.beziers.length = 0;\n    this.ratios.length = 0;\n    this.progresses.length = 0;\n    this.length = 0;\n\n    var bezier;\n\n    for (var i = 1; i < this.points.length; i++) {\n        var startPoint = this.points[i - 1];\n        var endPoint = this.points[i];\n        bezier = new Bezier();\n        bezier.start = startPoint.pos;\n        bezier.startCtrlPoint = startPoint.out;\n        bezier.end = endPoint.pos;\n        bezier.endCtrlPoint = endPoint.in;\n        this.beziers.push(bezier);\n\n        this.length += bezier.getLength();\n    }\n\n    var current = 0;\n    for (var i = 0; i < this.beziers.length; i++) {\n        bezier = this.beziers[i];\n        this.ratios[i] = bezier.getLength() / this.length;\n        this.progresses[i] = current = current + this.ratios[i];\n    }\n\n    return this.beziers;\n};\n\nfunction Bezier () {\n    this.start = v2();\n    this.end = v2();\n    this.startCtrlPoint = v2(); // cp0, cp1\n    this.endCtrlPoint = v2();   // cp2, cp3\n}\n\n// Get point at relative position in curve according to arc length\n// - u [0 .. 1]\nBezier.prototype.getPointAt = function ( u ) {\n    var t = this.getUtoTmapping( u );\n    return this.getPoint( t );\n};\n\n\n// Get point at time t\n//  - t [0 .. 1]\nBezier.prototype.getPoint = function ( t ) {\n    var x = bezier(this.start.x, this.startCtrlPoint.x, this.endCtrlPoint.x, this.end.x, t);\n    var y = bezier(this.start.y, this.startCtrlPoint.y, this.endCtrlPoint.y, this.end.y, t);\n\n    return new v2(x, y);\n};\n\n// Get total curve arc length\nBezier.prototype.getLength = function () {\n\n    var lengths = this.getLengths();\n    return lengths[ lengths.length - 1 ];\n\n};\n\n// Get list of cumulative segment lengths\nBezier.prototype.getLengths = function ( divisions ) {\n\n    if ( ! divisions ) divisions = (this.__arcLengthDivisions) ? (this.__arcLengthDivisions): 200;\n\n    if ( this.cacheArcLengths\n        && ( this.cacheArcLengths.length === divisions + 1 )) {\n\n        //console.log( \"cached\", this.cacheArcLengths );\n        return this.cacheArcLengths;\n\n    }\n\n    var cache = [];\n    var current, last = this.getPoint( 0 ), vector = v2();\n    var p, sum = 0;\n\n    cache.push( 0 );\n\n    for ( p = 1; p <= divisions; p ++ ) {\n\n        current = this.getPoint ( p / divisions );\n        vector.x = last.x - current.x;\n        vector.y = last.y - current.y;\n        sum += vector.mag();\n        cache.push( sum );\n        last = current;\n\n    }\n\n    this.cacheArcLengths = cache;\n\n    return cache; // { sums: cache, sum:sum }; Sum is in the last element.\n};\n\nBezier.prototype.getUtoTmapping = function ( u, distance ) {\n\n    var arcLengths = this.getLengths();\n\n    var i = 0, il = arcLengths.length;\n\n    var targetArcLength; // The targeted u distance value to get\n\n    if ( distance ) {\n        targetArcLength = distance;\n    } else {\n        targetArcLength = u * arcLengths[ il - 1 ];\n    }\n\n    //var time = Date.now();\n\n    // binary search for the index with largest value smaller than target u distance\n\n    var low = 0, high = il - 1, comparison;\n\n    while ( low <= high ) {\n\n        i = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\n\n        comparison = arcLengths[ i ] - targetArcLength;\n\n        if ( comparison < 0 ) {\n\n            low = i + 1;\n            continue;\n\n        } else if ( comparison > 0 ) {\n\n            high = i - 1;\n            continue;\n\n        } else {\n\n            high = i;\n            break;\n\n            // DONE\n\n        }\n\n    }\n\n    i = high;\n\n    //console.log('b' , i, low, high, Date.now()- time);\n\n    if ( arcLengths[ i ] === targetArcLength ) {\n\n        var t = i / ( il - 1 );\n        return t;\n\n    }\n\n    // we could get finer grain at lengths, or use simple interpolatation between two points\n\n    var lengthBefore = arcLengths[ i ];\n    var lengthAfter = arcLengths[ i + 1 ];\n\n    var segmentLength = lengthAfter - lengthBefore;\n\n    // determine where we are between the 'before' and 'after' points\n\n    var segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\n\n    // add that fractional amount to t\n\n    var t = ( i + segmentFraction ) / ( il -1 );\n\n    return t;\n};\n\n\nfunction checkMotionPath(motionPath) {\n    if (!Array.isArray(motionPath)) return false;\n\n    for (let i = 0, l = motionPath.length; i < l; i++) {\n        let controls = motionPath[i];\n\n        if (!Array.isArray(controls) || controls.length !== 6) return false;\n    }\n\n    return true;\n}\n\nfunction sampleMotionPaths (motionPaths, data, duration, fps, target) {\n\n    function createControlPoints(array) {\n        if (array instanceof cc.Vec2) {\n            return {\n                in: array,\n                pos: array,\n                out: array\n            };\n        }\n        else if (Array.isArray(array) && array.length === 6) {\n            return {\n                in: v2(array[2], array[3]),\n                pos: v2(array[0], array[1]),\n                out: v2(array[4], array[5])\n            };\n        }\n\n        return {\n            in: cc.Vec2.ZERO,\n            pos: cc.Vec2.ZERO,\n            out: cc.Vec2.ZERO\n        };\n    }\n\n    let values = data.values = data.values.map(function (value) {\n        if (Array.isArray(value)) {\n            value = value.length === 2 ? cc.v2(value[0], value[1]) : cc.v3(value[0], value[1], value[2]);\n        }\n        return value;\n    });\n\n    if (motionPaths.length === 0 || values.length === 0) {\n        return;\n    }\n\n    let motionPathValid = false;\n    for (let i = 0; i < motionPaths.length; i++) {\n        let motionPath = motionPaths[i];\n        if (motionPath && !checkMotionPath(motionPath)) {\n            cc.errorID(3904, target ? target.name : '', 'position', i);\n            motionPath = null;\n        }\n        if (motionPath && motionPath.length > 0) {\n            motionPathValid = true;\n            break;\n        }\n    }\n\n    if (!motionPathValid) {\n        return;\n    }\n\n    if (values.length === 1) {\n        return;\n    }\n\n    var types = data.types;\n    var ratios = data.ratios;\n\n    var newValues = data.values = [];\n    var newTypes = data.types = [];\n    var newRatios = data.ratios = [];\n\n    function addNewDatas (value, type, ratio) {\n        newValues.push(value);\n        newTypes.push(type);\n        newRatios.push(ratio);\n    }\n\n    // ensure every ratio section's length is the same\n    var startRatioOffset = 0;\n\n    var EPSILON = 1e-6;\n    var newType = DynamicAnimCurve.Linear;\n\n    // do not need to compute last path\n    for (var i = 0, l = motionPaths.length; i < l-1; i++) {\n        var motionPath = motionPaths[i];\n\n        var ratio = ratios[i];\n        var nextRatio = ratios[i + 1];\n        var betweenRatio = nextRatio - ratio;\n\n        var value = values[i];\n        var nextValue = values[i + 1];\n\n        var type = types[i];\n\n        var results = [];\n        var progress = startRatioOffset / betweenRatio;\n        var speed = 1 / (betweenRatio * duration * fps);\n        var finalProgress;\n\n        if (motionPath && motionPath.length > 0) {\n            var points = [];\n            points.push(createControlPoints(value));\n\n            for (var j = 0, l2 = motionPath.length; j < l2; j++) {\n                var controlPoints = createControlPoints(motionPath[j]);\n                points.push(controlPoints);\n            }\n\n            points.push(createControlPoints(nextValue));\n\n            // create Curve to compute beziers\n            var curve = new Curve(points);\n            curve.computeBeziers();\n\n            // sample beziers\n            var progresses = curve.progresses;\n\n            while ( 1 - progress > EPSILON) {\n                finalProgress = progress;\n\n                finalProgress = computeRatioByType(finalProgress, type);\n\n                var pos, bezier, normal, length;\n\n                if (finalProgress < 0) {\n                    bezier = curve.beziers[0];\n                    length =  (0 - finalProgress) * bezier.getLength();\n                    normal = bezier.start.sub(bezier.endCtrlPoint).normalize();\n                    pos = bezier.start.add(normal.mul(length));\n                }\n                else if (finalProgress > 1) {\n                    bezier = curve.beziers[curve.beziers.length - 1];\n                    length =  (finalProgress - 1) * bezier.getLength();\n                    normal = bezier.end.sub(bezier.startCtrlPoint).normalize();\n                    pos = bezier.end.add(normal.mul(length));\n                }\n                else {\n                    var bezierIndex = binarySearch(progresses, finalProgress);\n                    if (bezierIndex < 0) bezierIndex = ~bezierIndex;\n\n                    finalProgress -= bezierIndex > 0 ? progresses[bezierIndex - 1] : 0;\n                    finalProgress = finalProgress / curve.ratios[bezierIndex];\n\n                    pos = curve.beziers[bezierIndex].getPointAt(finalProgress);\n                }\n\n                results.push(pos);\n                progress += speed;\n            }\n\n        }\n        else {\n            while ( 1 - progress > EPSILON) {\n                finalProgress = progress;\n\n                finalProgress = computeRatioByType(finalProgress, type);\n\n                results.push(value.lerp(nextValue, finalProgress));\n\n                progress += speed;\n            }\n        }\n\n        newType = type === 'constant' ? type : DynamicAnimCurve.Linear;\n\n        for (var j = 0, l2 = results.length; j < l2; j++) {\n            var newRatio = ratio + startRatioOffset + speed * j * betweenRatio;\n            addNewDatas(results[j], newType, newRatio);\n        }\n\n        if (Math.abs(progress - 1) > EPSILON) // progress > 1\n            startRatioOffset = (progress - 1) * betweenRatio;\n        else\n            startRatioOffset = 0;\n    }\n\n    if (ratios[ratios.length - 1] !== newRatios[newRatios.length -1]) {\n        addNewDatas(values[values.length - 1], newType, ratios[ratios.length - 1]);\n    }\n}\n\nif (CC_TEST) {\n    cc._Test.sampleMotionPaths = sampleMotionPaths;\n}\n\nmodule.exports = {\n    sampleMotionPaths: sampleMotionPaths,\n    Curve: Curve,\n    Bezier: Bezier\n};\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = cc.js;\nconst debug = require('../core/CCDebug');\n\n/**\n * @class Playable\n *\n */\nfunction Playable () {\n    this._isPlaying = false;\n    this._isPaused = false;\n    this._stepOnce = false;\n}\n\nvar prototype = Playable.prototype;\n\n/**\n * !#en Is playing or paused in play mode?\n * !#zh 当前是否正在播放。\n * @property isPlaying\n * @type {boolean}\n * @default false\n * @readOnly\n */\njs.get(prototype, 'isPlaying', function () {\n    return this._isPlaying;\n}, true);\n\n/**\n * !#en Is currently paused? This can be true even if in edit mode(isPlaying == false).\n * !#zh 当前是否正在暂停\n * @property isPaused\n * @type {boolean}\n * @default false\n * @readOnly\n */\njs.get(prototype, 'isPaused', function () {\n    return this._isPaused;\n}, true);\n\n// virtual\n\nvar virtual = function () {};\n/**\n * @method onPlay\n * @private\n */\nprototype.onPlay = virtual;\n/**\n * @method onPause\n * @private\n */\nprototype.onPause = virtual;\n/**\n * @method onResume\n * @private\n */\nprototype.onResume = virtual;\n/**\n * @method onStop\n * @private\n */\nprototype.onStop = virtual;\n/**\n * @method onError\n * @param {string} errorCode\n * @private\n */\nprototype.onError = virtual;\n\n// public\n\n/**\n * !#en Play this animation.\n * !#zh 播放动画。\n * @method play\n */\nprototype.play = function () {\n    if (this._isPlaying) {\n        if (this._isPaused) {\n            this._isPaused = false;\n            this.onResume();\n        }\n        else {\n            this.onError(debug.getError(3912));\n        }\n    }\n    else {\n        this._isPlaying = true;\n        this.onPlay();\n    }\n};\n\n/**\n * !#en Stop this animation.\n * !#zh 停止动画播放。\n * @method stop\n */\nprototype.stop = function () {\n    if (this._isPlaying) {\n        this._isPlaying = false;\n        this.onStop();\n\n        // need reset pause flag after onStop\n        this._isPaused = false;\n    }\n};\n\n/**\n * !#en Pause this animation.\n * !#zh 暂停动画。\n * @method pause\n */\nprototype.pause = function () {\n    if (this._isPlaying && !this._isPaused) {\n        this._isPaused = true;\n        this.onPause();\n    }\n};\n\n/**\n * !#en Resume this animation.\n * !#zh 重新播放动画。\n * @method resume\n */\nprototype.resume = function () {\n    if (this._isPlaying && this._isPaused) {\n        this._isPaused = false;\n        this.onResume();\n    }\n};\n\n/**\n * !#en Perform a single frame step.\n * !#zh 执行一帧动画。\n * @method step\n */\nprototype.step = function () {\n    this.pause();\n    this._stepOnce = true;\n    if (!this._isPlaying) {\n        this.play();\n    }\n};\n\nmodule.exports = Playable;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar WrapModeMask = {\n    Loop: 1 << 1,\n    ShouldWrap: 1 << 2,\n    // Reserved: 1 << 3,\n    PingPong: 1 << 4 | 1 << 1 | 1 << 2,  // Loop, ShouldWrap\n    Reverse: 1 << 5 | 1 << 2,      // ShouldWrap\n};\n\n/**\n * !#en Specifies how time is treated when it is outside of the keyframe range of an Animation.\n * !#zh 动画使用的循环模式。\n * @enum WrapMode\n * @memberof cc\n */\nvar WrapMode = cc.Enum({\n\n    /**\n     * !#en Reads the default wrap mode set higher up.\n     * !#zh 向 Animation Component 或者 AnimationClip 查找 wrapMode\n     * @property {Number} Default\n     */\n    Default: 0,\n\n    /**\n     * !#en All iterations are played as specified.\n     * !#zh 动画只播放一遍\n     * @property {Number} Normal\n     */\n    Normal: 1,\n\n    /**\n     * !#en All iterations are played in the reverse direction from the way they are specified.\n     * !#zh 从最后一帧或结束位置开始反向播放，到第一帧或开始位置停止\n     * @property {Number} Reverse\n     */\n    Reverse: WrapModeMask.Reverse,\n\n    /**\n     * !#en When time reaches the end of the animation, time will continue at the beginning.\n     * !#zh 循环播放\n     * @property {Number} Loop\n     */\n    Loop: WrapModeMask.Loop,\n\n    /**\n     * !#en All iterations are played in the reverse direction from the way they are specified.\n     * And when time reaches the start of the animation, time will continue at the ending.\n     * !#zh 反向循环播放\n     * @property {Number} LoopReverse\n     */\n    LoopReverse: WrapModeMask.Loop | WrapModeMask.Reverse,\n\n    /**\n     * !#en Even iterations are played as specified, odd iterations are played in the reverse direction from the way they\n     * are specified.\n     * !#zh 从第一帧播放到最后一帧，然后反向播放回第一帧，到第一帧后再正向播放，如此循环\n     * @property {Number} PingPong\n     */\n    PingPong: WrapModeMask.PingPong,\n\n    /**\n     * !#en Even iterations are played in the reverse direction from the way they are specified, odd iterations are played\n     * as specified.\n     * !#zh 从最后一帧开始反向播放，其他同 PingPong\n     * @property {Number} PingPongReverse\n     */\n    PingPongReverse: WrapModeMask.PingPong | WrapModeMask.Reverse\n});\n\ncc.WrapMode = WrapMode;\n\n// For internal\nfunction WrappedInfo (info) {\n    if (info) {\n        this.set(info);\n        return;\n    }\n\n    this.ratio = 0;\n    this.time = 0;\n    this.direction = 1;\n    this.stopped = true;\n    this.iterations = 0;\n    this.frameIndex = undefined;\n}\n\nWrappedInfo.prototype.set = function (info) {\n    this.ratio = info.ratio;\n    this.time = info.time;\n    this.direction = info.direction;\n    this.stopped = info.stopped;\n    this.iterations = info.iterations;\n    this.frameIndex = info.frameIndex;\n};\n\nmodule.exports = {\n    WrapModeMask,\n    WrapMode,\n    WrappedInfo\n};\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst EventTarget = require('../core/event/event-target');\nconst sys = require('../core/platform/CCSys');\nconst LoadMode = require('../core/assets/CCAudioClip').LoadMode;\n\nlet touchBinded = false;\nlet touchPlayList = [\n    //{ instance: Audio, offset: 0, audio: audio }\n];\n\nlet Audio = function (src) {\n    EventTarget.call(this);\n\n    this._src = src;\n    this._element = null;\n    this.id = 0;\n\n    this._volume = 1;\n    this._loop = false;\n    this._nextTime = 0;  // playback position to set\n\n    this._state = Audio.State.INITIALZING;\n\n    this._onended = function () {\n        this._state = Audio.State.STOPPED;\n        this.emit('ended');\n    }.bind(this);\n};\n\ncc.js.extend(Audio, EventTarget);\n\n/**\n * !#en Audio state.\n * !#zh 声音播放状态\n * @enum audioEngine.AudioState\n * @memberof cc\n */\n// TODO - At present, the state is mixed with two states of users and systems, and it is best to split into two types. A \"loading\" should also be added to the system state.\nAudio.State = {\n    /**\n     * @property {Number} ERROR\n     */\n    ERROR : -1,\n    /**\n     * @property {Number} INITIALZING\n     */\n    INITIALZING: 0,\n    /**\n     * @property {Number} PLAYING\n     */\n    PLAYING: 1,\n    /**\n     * @property {Number} PAUSED\n     */\n    PAUSED: 2,\n    /**\n     * @property {Number} STOPPED\n     */\n    STOPPED: 3,\n};\n\n(function (proto) {\n\n    proto._bindEnded = function (callback) {\n        callback = callback || this._onended;\n        let elem = this._element;\n        if (this._src && (elem instanceof HTMLAudioElement)) {\n            elem.addEventListener('ended', callback);\n        } else {\n            elem.onended = callback;\n        }\n    };\n\n    proto._unbindEnded = function () {\n        let elem = this._element;\n        if (elem instanceof HTMLAudioElement) {\n            elem.removeEventListener('ended', this._onended);\n        } else if (elem) {\n            elem.onended = null;\n        }\n    };\n\n    // proto.mount = function (elem) {\n    //     if (CC_DEBUG) {\n    //         cc.warn('Audio.mount(value) is deprecated. Please use Audio._onLoaded().');\n    //     }\n    // };\n\n    proto._onLoaded = function () {\n        this._createElement();\n        \n        this.setVolume(this._volume);\n        this.setLoop(this._loop);\n        if (this._nextTime !== 0) {\n            this.setCurrentTime(this._nextTime);\n        }\n        if (this.getState() === Audio.State.PLAYING) {\n            this.play();\n        }\n        else {\n            this._state = Audio.State.INITIALZING;\n        }\n    };\n\n    proto._createElement = function () {\n        let elem = this._src._nativeAsset;\n        if (elem instanceof HTMLAudioElement) {\n            // Reuse dom audio element\n            if (!this._element) {\n                this._element = document.createElement('audio');\n            }\n            this._element.src = elem.src;\n        }\n        else {\n            this._element = new WebAudioElement(elem, this);\n        }\n    };\n\n    proto.play = function () {\n        // marked as playing so it will playOnLoad\n        this._state = Audio.State.PLAYING;\n\n        if (!this._element) {\n            return;\n        }\n\n        this._bindEnded();\n        this._element.play();\n\n        this._touchToPlay();\n    };\n\n    proto._touchToPlay = function () {\n        if (this._src && this._src.loadMode === LoadMode.DOM_AUDIO &&\n            this._element.paused) {\n            touchPlayList.push({ instance: this, offset: 0, audio: this._element });\n        }\n\n        if (touchBinded) return;\n        touchBinded = true;\n\n        let touchEventName = ('ontouchend' in window) ? 'touchend' : 'mousedown';\n        // Listen to the touchstart body event and play the audio when necessary.\n        cc.game.canvas.addEventListener(touchEventName, function () {\n            let item;\n            while (item = touchPlayList.pop()) {\n                item.audio.play(item.offset);\n            }\n        });\n    };\n\n    proto.destroy = function () {\n        this._element = null;\n    };\n\n    proto.pause = function () {\n        if (!this._element || this.getState() !== Audio.State.PLAYING) return;\n        this._unbindEnded();\n        this._element.pause();\n        this._state = Audio.State.PAUSED;\n    };\n\n    proto.resume = function () {\n        if (!this._element || this.getState() !== Audio.State.PAUSED) return;\n        this._bindEnded();\n        this._element.play();\n        this._state = Audio.State.PLAYING;\n    };\n\n    proto.stop = function () {\n        if (!this._element) return;\n        this._element.pause();\n        try {\n            this._element.currentTime = 0;\n        } catch (error) {}\n        // remove touchPlayList\n        for (let i = 0; i < touchPlayList.length; i++) {\n            if (touchPlayList[i].instance === this) {\n                touchPlayList.splice(i, 1);\n                break;\n            }\n        }\n        this._unbindEnded();\n        this.emit('stop');\n        this._state = Audio.State.STOPPED;\n    };\n\n    proto.setLoop = function (loop) {\n        this._loop = loop;\n        if (this._element) {\n            this._element.loop = loop;\n        }\n    };\n    proto.getLoop = function () {\n        return this._loop;\n    };\n\n    proto.setVolume = function (num) {\n        this._volume = num;\n        if (this._element) {\n            this._element.volume = num;\n        }\n    };\n    proto.getVolume = function () {\n        return this._volume;\n    };\n\n    proto.setCurrentTime = function (num) {\n        if (this._element) {\n            this._nextTime = 0;\n        }\n        else {\n            this._nextTime = num;\n            return;\n        }\n\n        // setCurrentTime would fire 'ended' event\n        // so we need to change the callback to rebind ended callback after setCurrentTime\n        this._unbindEnded();\n        this._bindEnded(function () {\n            this._bindEnded();\n        }.bind(this));\n\n        try {\n            this._element.currentTime = num;\n        }\n        catch (err) {\n            let _element = this._element;\n            if (_element.addEventListener) {\n                let func = function () {\n                    _element.removeEventListener('loadedmetadata', func);\n                    _element.currentTime = num;\n                };\n                _element.addEventListener('loadedmetadata', func);\n            }\n        }\n    };\n\n    proto.getCurrentTime = function () {\n        return this._element ? this._element.currentTime : 0;\n    };\n\n    proto.getDuration = function () {\n        return this._element ? this._element.duration : 0;\n    };\n\n    proto.getState = function () {\n        // HACK: in some browser, audio may not fire 'ended' event\n        // so we need to force updating the Audio state\n        this._forceUpdatingState();\n        \n        return this._state;\n    };\n\n    proto._forceUpdatingState = function () {\n        let elem = this._element;\n        if (elem) {\n            if (Audio.State.PLAYING === this._state && elem.paused) {\n                this._state = Audio.State.STOPPED;\n            }\n            else if (Audio.State.STOPPED === this._state && !elem.paused) {\n                this._state = Audio.State.PLAYING;\n            }\n        }\n    };\n\n    Object.defineProperty(proto, 'src', {\n        get: function () {\n            return this._src;\n        },\n        set: function (clip) {\n            this._unbindEnded();\n            if (clip) {\n                this._src = clip;\n                if (clip.loaded) {\n                    this._onLoaded();\n                }\n                else {\n                    let self = this;\n                    clip.once('load', function () {\n                        if (clip === self._src) {\n                            self._onLoaded();\n                        }\n                    });\n                    cc.loader.load({\n                            url: clip.nativeUrl,\n                            // For audio, we should skip loader otherwise it will load a new audioClip.\n                            skips: ['Loader'],\n                        },\n                        function (err, audioNativeAsset) {\n                            if (err) {\n                                cc.error(err);\n                                return;\n                            }\n                            if (!clip.loaded) {\n                                clip._nativeAsset = audioNativeAsset;\n                            }\n                        });\n                }\n            }\n            else {\n                this._src = null;\n                if (this._element instanceof WebAudioElement) {\n                    this._element = null;\n                }\n                else {\n                    this._element.src = '';\n                }\n                this._state = Audio.State.INITIALZING;\n            }\n            return clip;\n        },\n        enumerable: true,\n        configurable: true\n    });\n\n    Object.defineProperty(proto, 'paused', {\n        get: function () {\n            return this._element ? this._element.paused : true;\n        },\n        enumerable: true,\n        configurable: true\n    });\n\n    // setFinishCallback\n\n})(Audio.prototype);\n\n\n// TIME_CONSTANT is used as an argument of setTargetAtTime interface\n// TIME_CONSTANT need to be a positive number on Edge and Baidu browser\n// TIME_CONSTANT need to be 0 by default, or may fail to set volume at the very beginning of playing audio\nlet TIME_CONSTANT;\nif (cc.sys.browserType === cc.sys.BROWSER_TYPE_EDGE || \n    cc.sys.browserType === cc.sys.BROWSER_TYPE_BAIDU ||\n    cc.sys.browserType === cc.sys.BROWSER_TYPE_UC) {\n    TIME_CONSTANT = 0.01;\n}\nelse {\n    TIME_CONSTANT = 0;\n}\n\n// Encapsulated WebAudio interface\nlet WebAudioElement = function (buffer, audio) {\n    this._audio = audio;\n    this._context = sys.__audioSupport.context;\n    this._buffer = buffer;\n\n    this._gainObj = this._context['createGain']();\n    this.volume = 1;\n\n    this._gainObj['connect'](this._context['destination']);\n    this._loop = false;\n    // The time stamp on the audio time axis when the recording begins to play.\n    this._startTime = -1;\n    // Record the currently playing 'Source'\n    this._currentSource = null;\n    // Record the time has been played\n    this.playedLength = 0;\n\n    this._currentTimer = null;\n\n    this._endCallback = function () {\n        if (this.onended) {\n            this.onended(this);\n        }\n    }.bind(this);\n};\n\n(function (proto) {\n    proto.play = function (offset) {\n        // If repeat play, you need to stop before an audio\n        if (this._currentSource && !this.paused) {\n            this._currentSource.onended = null;\n            this._currentSource.stop(0);\n            this.playedLength = 0;\n        }\n\n        let audio = this._context[\"createBufferSource\"]();\n        audio.buffer = this._buffer;\n        audio[\"connect\"](this._gainObj);\n        audio.loop = this._loop;\n\n        this._startTime = this._context.currentTime;\n        offset = offset || this.playedLength;\n        if (offset) {\n            this._startTime -= offset;\n        }\n        let duration = this._buffer.duration;\n\n        let startTime = offset;\n        let endTime;\n        if (this._loop) {\n            if (audio.start)\n                audio.start(0, startTime);\n            else if (audio[\"notoGrainOn\"])\n                audio[\"noteGrainOn\"](0, startTime);\n            else\n                audio[\"noteOn\"](0, startTime);\n        } else {\n            endTime = duration - offset;\n            if (audio.start)\n                audio.start(0, startTime, endTime);\n            else if (audio[\"noteGrainOn\"])\n                audio[\"noteGrainOn\"](0, startTime, endTime);\n            else\n                audio[\"noteOn\"](0, startTime, endTime);\n        }\n\n        this._currentSource = audio;\n\n        audio.onended = this._endCallback;\n\n        // If the current audio context time stamp is 0 and audio context state is suspended\n        // There may be a need to touch events before you can actually start playing audio\n        if ((!audio.context.state || audio.context.state === \"suspended\") && this._context.currentTime === 0) {\n            let self = this;\n            clearTimeout(this._currentTimer);\n            this._currentTimer = setTimeout(function () {\n                if (self._context.currentTime === 0) {\n                    touchPlayList.push({\n                        instance: self._audio,\n                        offset: offset,\n                        audio: self\n                    });\n                }\n            }, 10);\n        }\n        // HACK: fix mobile safari can't play\n        if (cc.sys.browserType === cc.sys.BROWSER_TYPE_SAFARI && cc.sys.isMobile) {\n            if (audio.context.state === 'interrupted') {\n                audio.context.resume();\n            }\n        }\n    };\n\n    proto.pause = function () {\n        clearTimeout(this._currentTimer);\n        if (this.paused) return;\n        // Record the time the current has been played\n        this.playedLength = this._context.currentTime - this._startTime;\n        // If more than the duration of the audio, Need to take the remainder\n        this.playedLength %= this._buffer.duration;\n        let audio = this._currentSource;\n        this._currentSource = null;\n        this._startTime = -1;\n        if (audio)\n            audio.stop(0);\n    };\n\n    Object.defineProperty(proto, 'paused', {\n        get: function () {\n            // If the current audio is a loop, paused is false\n            if (this._currentSource && this._currentSource.loop)\n                return false;\n\n            // startTime default is -1\n            if (this._startTime === -1)\n                return true;\n\n            // Current time -  Start playing time > Audio duration\n            return this._context.currentTime - this._startTime > this._buffer.duration;\n        },\n        enumerable: true,\n        configurable: true\n    });\n\n    Object.defineProperty(proto, 'loop', {\n        get: function () {\n            return this._loop;\n        },\n        set: function (bool) {\n            if (this._currentSource)\n                this._currentSource.loop = bool;\n\n            return this._loop = bool;\n        },\n        enumerable: true,\n        configurable: true\n    });\n\n    Object.defineProperty(proto, 'volume', {\n        get: function () {\n            return this._volume;\n        },\n        set: function (num) {\n            this._volume = num;\n            // https://www.chromestatus.com/features/5287995770929152\n            if (this._gainObj.gain.setTargetAtTime) {\n                try {\n                    this._gainObj.gain.setTargetAtTime(num, this._context.currentTime, TIME_CONSTANT);\n                }\n                catch (e) {\n                    // Some other unknown browsers may crash if TIME_CONSTANT is 0\n                    this._gainObj.gain.setTargetAtTime(num, this._context.currentTime, 0.01);\n                }\n            }\n            else {\n                this._gainObj.gain.value = num;\n            }\n\n            if (sys.os === sys.OS_IOS && !this.paused && this._currentSource) {\n                // IOS must be stop webAudio\n                this._currentSource.onended = null;\n                this.pause();\n                this.play();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n\n    Object.defineProperty(proto, 'currentTime', {\n        get: function () {\n            if (this.paused) {\n                return this.playedLength;\n            }\n            // Record the time the current has been played\n            this.playedLength = this._context.currentTime - this._startTime;\n            // If more than the duration of the audio, Need to take the remainder\n            this.playedLength %= this._buffer.duration;\n            return this.playedLength;\n        },\n        set: function (num) {\n            if (!this.paused) {\n                this.pause();\n                this.playedLength = num;\n                this.play();\n            } else {\n                this.playedLength = num;\n            }\n            return num;\n        },\n        enumerable: true,\n        configurable: true\n    });\n\n    Object.defineProperty(proto, 'duration', {\n        get: function () {\n            return this._buffer.duration;\n        },\n        enumerable: true,\n        configurable: true\n    });\n\n})(WebAudioElement.prototype);\n\nmodule.exports = cc.Audio = Audio;\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst Audio = require('./CCAudio');\nconst AudioClip = require('../core/assets/CCAudioClip');\nconst js = cc.js;\n\nlet _instanceId = 0;\nlet _id2audio = js.createMap(true);\nlet _url2id = {};\nlet _audioPool = [];\n\nlet recycleAudio = function (audio) {\n    audio._finishCallback = null;\n    audio.off('ended');\n    audio.off('stop');\n    audio.src = null;\n    // In case repeatly recycle audio\n    if (!_audioPool.includes(audio)) {\n        if (_audioPool.length < 32) {\n            _audioPool.push(audio);\n        }\n        else {\n            audio.destroy();\n        }\n    }\n};\n\nlet getAudioFromPath = function (path) {\n    var id = _instanceId++;\n    var list = _url2id[path];\n    if (!list) {\n        list = _url2id[path] = [];\n    }\n    if (audioEngine._maxAudioInstance <= list.length) {\n        var oldId = list.shift();\n        var oldAudio = getAudioFromId(oldId);\n        // Stop will recycle audio automatically by event callback\n        oldAudio.stop();\n    }\n\n    var audio = _audioPool.pop() || new Audio();\n    var callback = function () {\n        var audioInList = getAudioFromId(this.id);\n        if (audioInList) {\n            delete _id2audio[this.id];\n            var index = list.indexOf(this.id);\n            cc.js.array.fastRemoveAt(list, index);\n        }\n        recycleAudio(this);\n    };\n\n    audio.on('ended', function () {\n        if (this._finishCallback) {\n            this._finishCallback();\n        }\n        callback.call(this);\n    }, audio);\n\n    audio.on('stop', callback, audio);\n    audio.id = id;\n    _id2audio[id] = audio;\n    list.push(id);\n\n    return audio;\n};\n\nlet getAudioFromId = function (id) {\n    return _id2audio[id];\n};\n\nlet handleVolume  = function (volume) {\n    if (volume === undefined) {\n        // set default volume as 1\n        volume = 1;\n    }\n    else if (typeof volume === 'string') {\n        volume = Number.parseFloat(volume);\n    }\n    return volume;\n};\n\n/**\n * !#en cc.audioEngine is the singleton object, it provide simple audio APIs.\n * !#zh\n * cc.audioengine是单例对象。<br/>\n * 主要用来播放音频，播放的时候会返回一个 audioID，之后都可以通过这个 audioID 来操作这个音频对象。<br/>\n * 不使用的时候，请使用 cc.audioEngine.uncache(filePath); 进行资源释放 <br/>\n * 注意：<br/>\n * 在 Android 系统浏览器上，不同浏览器，不同版本的效果不尽相同。<br/>\n * 比如说：大多数浏览器都需要用户物理交互才可以开始播放音效，有一些不支持 WebAudio，<br/>\n * 有一些不支持多音轨播放。总之如果对音乐依赖比较强，请做尽可能多的测试。\n * @class audioEngine\n * @static\n */\nvar audioEngine = {\n\n    AudioState: Audio.State,\n\n    _maxWebAudioSize: 2097152, // 2048kb * 1024\n    _maxAudioInstance: 24,\n\n    _id2audio: _id2audio,\n\n    /**\n     * !#en Play audio.\n     * !#zh 播放音频\n     * @method play\n     * @param {AudioClip} clip - The audio clip to play.\n     * @param {Boolean} loop - Whether the music loop or not.\n     * @param {Number} volume - Volume size.\n     * @return {Number} audioId\n     * @example\n     * cc.loader.loadRes(url, cc.AudioClip, function (err, clip) {\n     *     var audioID = cc.audioEngine.play(clip, false, 0.5);\n     * });\n     */\n    play: function (clip, loop, volume/*, profile*/) {\n        var path = clip;\n        var audio;\n        if (typeof clip === 'string') {\n            // backward compatibility since 1.10\n            cc.warnID(8401, 'cc.audioEngine', 'cc.AudioClip', 'AudioClip', 'cc.AudioClip', 'audio');\n            path = clip;\n            // load clip\n            audio = getAudioFromPath(path);\n            AudioClip._loadByUrl(path, function (err, clip) {\n                if (clip) {\n                    audio.src = clip;\n                }\n            });\n        }\n        else {\n            if (!clip) {\n                return;\n            }\n            path = clip.nativeUrl;\n            audio = getAudioFromPath(path);\n            audio.src = clip;\n        }\n\n        audio.setLoop(loop || false);\n        volume = handleVolume(volume);\n        audio.setVolume(volume);\n        audio.play();\n\n        return audio.id;\n    },\n\n    /**\n     * !#en Set audio loop.\n     * !#zh 设置音频是否循环。\n     * @method setLoop\n     * @param {Number} audioID - audio id.\n     * @param {Boolean} loop - Whether cycle.\n     * @example\n     * cc.audioEngine.setLoop(id, true);\n     */\n    setLoop: function (audioID, loop) {\n        var audio = getAudioFromId(audioID);\n        if (!audio || !audio.setLoop)\n            return;\n        audio.setLoop(loop);\n    },\n\n    /**\n     * !#en Get audio cycle state.\n     * !#zh 获取音频的循环状态。\n     * @method isLoop\n     * @param {Number} audioID - audio id.\n     * @return {Boolean} Whether cycle.\n     * @example\n     * cc.audioEngine.isLoop(id);\n     */\n    isLoop: function (audioID) {\n        var audio = getAudioFromId(audioID);\n        if (!audio || !audio.getLoop)\n            return false;\n        return audio.getLoop();\n    },\n\n    /**\n     * !#en Set the volume of audio.\n     * !#zh 设置音量（0.0 ~ 1.0）。\n     * @method setVolume\n     * @param {Number} audioID - audio id.\n     * @param {Number} volume - Volume must be in 0.0~1.0 .\n     * @example\n     * cc.audioEngine.setVolume(id, 0.5);\n     */\n    setVolume: function (audioID, volume) {\n        var audio = getAudioFromId(audioID);\n        if (audio) {\n            audio.setVolume(volume);\n        }\n    },\n\n    /**\n     * !#en The volume of the music max value is 1.0,the min value is 0.0 .\n     * !#zh 获取音量（0.0 ~ 1.0）。\n     * @method getVolume\n     * @param {Number} audioID - audio id.\n     * @return {Number}\n     * @example\n     * var volume = cc.audioEngine.getVolume(id);\n     */\n    getVolume: function (audioID) {\n        var audio = getAudioFromId(audioID);\n        return audio ? audio.getVolume() : 1;\n    },\n\n    /**\n     * !#en Set current time\n     * !#zh 设置当前的音频时间。\n     * @method setCurrentTime\n     * @param {Number} audioID - audio id.\n     * @param {Number} sec - current time.\n     * @return {Boolean}\n     * @example\n     * cc.audioEngine.setCurrentTime(id, 2);\n     */\n    setCurrentTime: function (audioID, sec) {\n        var audio = getAudioFromId(audioID);\n        if (audio) {\n            audio.setCurrentTime(sec);\n            return true;\n        }\n        else {\n            return false;\n        }\n    },\n\n    /**\n     * !#en Get current time\n     * !#zh 获取当前的音频播放时间。\n     * @method getCurrentTime\n     * @param {Number} audioID - audio id.\n     * @return {Number} audio current time.\n     * @example\n     * var time = cc.audioEngine.getCurrentTime(id);\n     */\n    getCurrentTime: function (audioID) {\n        var audio = getAudioFromId(audioID);\n        return audio ? audio.getCurrentTime() : 0;\n    },\n\n    /**\n     * !#en Get audio duration\n     * !#zh 获取音频总时长。\n     * @method getDuration\n     * @param {Number} audioID - audio id.\n     * @return {Number} audio duration.\n     * @example\n     * var time = cc.audioEngine.getDuration(id);\n     */\n    getDuration: function (audioID) {\n        var audio = getAudioFromId(audioID);\n        return audio ? audio.getDuration() : 0;\n    },\n\n    /**\n     * !#en Get audio state\n     * !#zh 获取音频状态。\n     * @method getState\n     * @param {Number} audioID - audio id.\n     * @return {audioEngine.AudioState} audio duration.\n     * @example\n     * var state = cc.audioEngine.getState(id);\n     */\n    getState: function (audioID) {\n        var audio = getAudioFromId(audioID);\n        return audio ? audio.getState() : this.AudioState.ERROR;\n    },\n\n    /**\n     * !#en Set Audio finish callback\n     * !#zh 设置一个音频结束后的回调\n     * @method setFinishCallback\n     * @param {Number} audioID - audio id.\n     * @param {Function} callback - loaded callback.\n     * @example\n     * cc.audioEngine.setFinishCallback(id, function () {});\n     */\n    setFinishCallback: function (audioID, callback) {\n        var audio = getAudioFromId(audioID);\n        if (!audio)\n            return;\n        audio._finishCallback = callback;\n    },\n\n    /**\n     * !#en Pause playing audio.\n     * !#zh 暂停正在播放音频。\n     * @method pause\n     * @param {Number} audioID - The return value of function play.\n     * @example\n     * cc.audioEngine.pause(audioID);\n     */\n    pause: function (audioID) {\n        var audio = getAudioFromId(audioID);\n        if (audio) {\n            audio.pause();\n            return true;\n        }\n        else {\n            return false;\n        }\n    },\n\n    _pauseIDCache: [],\n    /**\n     * !#en Pause all playing audio\n     * !#zh 暂停现在正在播放的所有音频。\n     * @method pauseAll\n     * @example\n     * cc.audioEngine.pauseAll();\n     */\n    pauseAll: function () {\n        for (var id in _id2audio) {\n            var audio = _id2audio[id];\n            var state = audio.getState();\n            if (state === Audio.State.PLAYING) {\n                this._pauseIDCache.push(id);\n                audio.pause();\n            }\n        }\n    },\n\n    /**\n     * !#en Resume playing audio.\n     * !#zh 恢复播放指定的音频。\n     * @method resume\n     * @param {Number} audioID - The return value of function play.\n     * @example\n     * cc.audioEngine.resume(audioID);\n     */\n    resume: function (audioID) {\n        var audio = getAudioFromId(audioID);\n        if (audio) {\n            audio.resume();\n        }\n    },\n\n    /**\n     * !#en Resume all playing audio.\n     * !#zh 恢复播放所有之前暂停的所有音频。\n     * @method resumeAll\n     * @example\n     * cc.audioEngine.resumeAll();\n     */\n    resumeAll: function () {\n        for (var i = 0; i < this._pauseIDCache.length; ++i) {\n            var id = this._pauseIDCache[i];\n            var audio = getAudioFromId(id);\n            if (audio)\n                audio.resume();\n        }\n        this._pauseIDCache.length = 0;\n    },\n\n    /**\n     * !#en Stop playing audio.\n     * !#zh 停止播放指定音频。\n     * @method stop\n     * @param {Number} audioID - The return value of function play.\n     * @example\n     * cc.audioEngine.stop(audioID);\n     */\n    stop: function (audioID) {\n        var audio = getAudioFromId(audioID);\n        if (audio) {\n            // Stop will recycle audio automatically by event callback\n            audio.stop();\n            return true;\n        }\n        else {\n            return false;\n        }\n    },\n\n    /**\n     * !#en Stop all playing audio.\n     * !#zh 停止正在播放的所有音频。\n     * @method stopAll\n     * @example\n     * cc.audioEngine.stopAll();\n     */\n    stopAll: function () {\n        for (var id in _id2audio) {\n            var audio = _id2audio[id];\n            if (audio) {\n                // Stop will recycle audio automatically by event callback\n                audio.stop();\n            }\n        }\n    },\n\n    /**\n     * !#en Set up an audio can generate a few examples.\n     * !#zh 设置一个音频可以设置几个实例\n     * @method setMaxAudioInstance\n     * @param {Number} num - a number of instances to be created from within an audio\n     * @example\n     * cc.audioEngine.setMaxAudioInstance(20);\n     */\n    setMaxAudioInstance: function (num) {\n        this._maxAudioInstance = num;\n    },\n\n    /**\n     * !#en Getting audio can produce several examples.\n     * !#zh 获取一个音频可以设置几个实例\n     * @method getMaxAudioInstance\n     * @return {Number} a - number of instances to be created from within an audio\n     * @example\n     * cc.audioEngine.getMaxAudioInstance();\n     */\n    getMaxAudioInstance: function () {\n        return this._maxAudioInstance;\n    },\n\n    /**\n     * !#en Unload the preloaded audio from internal buffer.\n     * !#zh 卸载预加载的音频。\n     * @method uncache\n     * @param {AudioClip} clip\n     * @example\n     * cc.audioEngine.uncache(filePath);\n     */\n    uncache: function (clip) {\n        var filePath = clip;\n        if (typeof clip === 'string') {\n            // backward compatibility since 1.10\n            cc.warnID(8401, 'cc.audioEngine', 'cc.AudioClip', 'AudioClip', 'cc.AudioClip', 'audio');\n            filePath = clip;\n        }\n        else {\n            if (!clip) {\n                return;\n            }\n            filePath = clip.nativeUrl;\n        }\n\n        var list = _url2id[filePath];\n        if (!list) return;\n        while (list.length > 0) {\n            var id = list.pop();\n            var audio = _id2audio[id];\n            if (audio) {\n                // Stop will recycle audio automatically by event callback\n                audio.stop();\n                delete _id2audio[id];\n            }\n        }\n    },\n\n    /**\n     * !#en Unload all audio from internal buffer.\n     * !#zh 卸载所有音频。\n     * @method uncacheAll\n     * @example\n     * cc.audioEngine.uncacheAll();\n     */\n    uncacheAll: function () {\n        this.stopAll();\n        let audio;\n        for (let id in _id2audio) {\n            audio = _id2audio[id];\n            if (audio) {\n                audio.destroy();\n            }\n        }\n        while (audio = _audioPool.pop()) {\n            audio.destroy();\n        }\n        _id2audio = js.createMap(true);\n        _url2id = {};\n    },\n\n    /**\n     * !#en Gets an audio profile by name.\n     *\n     * @param profileName A name of audio profile.\n     * @return The audio profile.\n     */\n    getProfile: function (profileName) {},\n\n    /**\n     * !#en Preload audio file.\n     * !#zh 预加载一个音频\n     * @method preload\n     * @param {String} filePath - The file path of an audio.\n     * @param {Function} [callback] - The callback of an audio.\n     * @example\n     * cc.audioEngine.preload(path);\n     * @deprecated `cc.audioEngine.preload` is deprecated, use `cc.loader.loadRes(url, cc.AudioClip)` instead please.\n     */\n    preload: function (filePath, callback) {\n        if (CC_DEBUG) {\n            cc.warn('`cc.audioEngine.preload` is deprecated, use `cc.loader.loadRes(url, cc.AudioClip)` instead please.');\n        }\n\n        cc.loader.load(filePath, callback && function (error) {\n            if (!error) {\n                callback();\n            }\n        });\n    },\n\n    /**\n     * !#en Set a size, the unit is KB. Over this size is directly resolved into DOM nodes.\n     * !#zh 设置一个以 KB 为单位的尺寸，大于这个尺寸的音频在加载的时候会强制使用 dom 方式加载\n     * @method setMaxWebAudioSize\n     * @param {Number} kb - The file path of an audio.\n     * @example\n     * cc.audioEngine.setMaxWebAudioSize(300);\n     */\n    // Because webAudio takes up too much memory，So allow users to manually choose\n    setMaxWebAudioSize: function (kb) {\n        this._maxWebAudioSize = kb * 1024;\n    },\n\n    _breakCache: null,\n    _break: function () {\n        this._breakCache = [];\n        for (var id in _id2audio) {\n            var audio = _id2audio[id];\n            var state = audio.getState();\n            if (state === Audio.State.PLAYING) {\n                this._breakCache.push(id);\n                audio.pause();\n            }\n        }\n    },\n\n    _restore: function () {\n        if (!this._breakCache) return;\n\n        while (this._breakCache.length > 0) {\n            var id = this._breakCache.pop();\n            var audio = getAudioFromId(id);\n            if (audio && audio.resume)\n                audio.resume();\n        }\n        this._breakCache = null;\n    },\n\n    ///////////////////////////////\n    // Classification of interface\n\n    _music: {\n        id: -1,\n        loop: false,\n        volume: 1,\n    },\n\n    _effect: {\n        volume: 1,\n        pauseCache: [],\n    },\n\n    /**\n     * !#en Play background music\n     * !#zh 播放背景音乐\n     * @method playMusic\n     * @param {AudioClip} clip - The audio clip to play.\n     * @param {Boolean} loop - Whether the music loop or not.\n     * @return {Number} audioId\n     * @example\n     * cc.loader.loadRes(url, cc.AudioClip, function (err, clip) {\n     *     var audioID = cc.audioEngine.playMusic(clip, false);\n     * });\n     */\n    playMusic: function (clip, loop) {\n        var music = this._music;\n        this.stop(music.id);\n        music.id = this.play(clip, loop, music.volume);\n        music.loop = loop;\n        return music.id;\n    },\n\n    /**\n     * !#en Stop background music.\n     * !#zh 停止播放背景音乐。\n     * @method stopMusic\n     * @example\n     * cc.audioEngine.stopMusic();\n     */\n    stopMusic: function () {\n        this.stop(this._music.id);\n    },\n\n    /**\n     * !#en Pause the background music.\n     * !#zh 暂停播放背景音乐。\n     * @method pauseMusic\n     * @example\n     * cc.audioEngine.pauseMusic();\n     */\n    pauseMusic: function () {\n        this.pause(this._music.id);\n        return this._music.id;\n    },\n\n    /**\n     * !#en Resume playing background music.\n     * !#zh 恢复播放背景音乐。\n     * @method resumeMusic\n     * @example\n     * cc.audioEngine.resumeMusic();\n     */\n    resumeMusic: function () {\n        this.resume(this._music.id);\n        return this._music.id;\n    },\n\n    /**\n     * !#en Get the volume(0.0 ~ 1.0).\n     * !#zh 获取音量（0.0 ~ 1.0）。\n     * @method getMusicVolume\n     * @return {Number}\n     * @example\n     * var volume = cc.audioEngine.getMusicVolume();\n     */\n    getMusicVolume: function () {\n        return this._music.volume;\n    },\n\n    /**\n     * !#en Set the background music volume.\n     * !#zh 设置背景音乐音量（0.0 ~ 1.0）。\n     * @method setMusicVolume\n     * @param {Number} volume - Volume must be in 0.0~1.0.\n     * @example\n     * cc.audioEngine.setMusicVolume(0.5);\n     */\n    setMusicVolume: function (volume) {\n        volume = handleVolume(volume);\n        var music = this._music;\n        music.volume = volume;\n        this.setVolume(music.id, music.volume);\n        return music.volume;\n    },\n\n    /**\n     * !#en Background music playing state\n     * !#zh 背景音乐是否正在播放\n     * @method isMusicPlaying\n     * @return {Boolean}\n     * @example\n     * cc.audioEngine.isMusicPlaying();\n     */\n    isMusicPlaying: function () {\n        return this.getState(this._music.id) === this.AudioState.PLAYING;\n    },\n\n    /**\n     * !#en Play effect audio.\n     * !#zh 播放音效\n     * @method playEffect\n     * @param {AudioClip} clip - The audio clip to play.\n     * @param {Boolean} loop - Whether the music loop or not.\n     * @return {Number} audioId\n     * @example\n     * cc.loader.loadRes(url, cc.AudioClip, function (err, clip) {\n     *     var audioID = cc.audioEngine.playEffect(clip, false);\n     * });\n     */\n    playEffect: function (clip, loop) {\n        return this.play(clip, loop || false, this._effect.volume);\n    },\n\n    /**\n     * !#en Set the volume of effect audio.\n     * !#zh 设置音效音量（0.0 ~ 1.0）。\n     * @method setEffectsVolume\n     * @param {Number} volume - Volume must be in 0.0~1.0.\n     * @example\n     * cc.audioEngine.setEffectsVolume(0.5);\n     */\n    setEffectsVolume: function (volume) {\n        volume = handleVolume(volume);\n        var musicId = this._music.id;\n        this._effect.volume = volume;\n        for (var id in _id2audio) {\n            var audio = _id2audio[id];\n            if (!audio || audio.id === musicId) continue;\n            audioEngine.setVolume(id, volume);\n        }\n    },\n\n    /**\n     * !#en The volume of the effect audio max value is 1.0,the min value is 0.0 .\n     * !#zh 获取音效音量（0.0 ~ 1.0）。\n     * @method getEffectsVolume\n     * @return {Number}\n     * @example\n     * var volume = cc.audioEngine.getEffectsVolume();\n     */\n    getEffectsVolume: function () {\n        return this._effect.volume;\n    },\n\n    /**\n     * !#en Pause effect audio.\n     * !#zh 暂停播放音效。\n     * @method pauseEffect\n     * @param {Number} audioID - audio id.\n     * @example\n     * cc.audioEngine.pauseEffect(audioID);\n     */\n    pauseEffect: function (audioID) {\n        return this.pause(audioID);\n    },\n\n    /**\n     * !#en Stop playing all the sound effects.\n     * !#zh 暂停播放所有音效。\n     * @method pauseAllEffects\n     * @example\n     * cc.audioEngine.pauseAllEffects();\n     */\n    pauseAllEffects: function () {\n        var musicId = this._music.id;\n        var effect = this._effect;\n        effect.pauseCache.length = 0;\n\n        for (var id in _id2audio) {\n            var audio = _id2audio[id];\n            if (!audio || audio.id === musicId) continue;\n            var state = audio.getState();\n            if (state === this.AudioState.PLAYING) {\n                effect.pauseCache.push(id);\n                audio.pause();\n            }\n        }\n    },\n\n    /**\n     * !#en Resume effect audio.\n     * !#zh 恢复播放音效音频。\n     * @method resumeEffect\n     * @param {Number} audioID - The return value of function play.\n     * @example\n     * cc.audioEngine.resumeEffect(audioID);\n     */\n    resumeEffect: function (id) {\n        this.resume(id);\n    },\n\n    /**\n     * !#en Resume all effect audio.\n     * !#zh 恢复播放所有之前暂停的音效。\n     * @method resumeAllEffects\n     * @example\n     * cc.audioEngine.resumeAllEffects();\n     */\n    resumeAllEffects: function () {\n        var pauseIDCache = this._effect.pauseCache;\n        for (var i = 0; i < pauseIDCache.length; ++i) {\n            var id = pauseIDCache[i];\n            var audio = _id2audio[id];\n            if (audio)\n                audio.resume();\n        }\n    },\n\n    /**\n     * !#en Stop playing the effect audio.\n     * !#zh 停止播放音效。\n     * @method stopEffect\n     * @param {Number} audioID - audio id.\n     * @example\n     * cc.audioEngine.stopEffect(id);\n     */\n    stopEffect: function (audioID) {\n        return this.stop(audioID);\n    },\n\n    /**\n     * !#en Stop playing all the effects.\n     * !#zh 停止播放所有音效。\n     * @method stopAllEffects\n     * @example\n     * cc.audioEngine.stopAllEffects();\n     */\n    stopAllEffects: function () {\n        var musicId = this._music.id;\n        for (var id in _id2audio) {\n            var audio = _id2audio[id];\n            if (!audio || audio.id === musicId) continue;\n            var state = audio.getState();\n            if (state === audioEngine.AudioState.PLAYING) {\n                audio.stop();\n            }\n        }\n    }\n};\n\nmodule.exports = cc.audioEngine = audioEngine;","/****************************************************************************\n Copyright (c) 2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst utils = require('./platform/utils');\nconst debugInfos = require('../../DebugInfos') || {};\nconst ERROR_MAP_URL = 'https://github.com/cocos-creator/engine/blob/master/EngineErrorMap.md';\n\n// the html element displays log in web page (DebugMode.INFO_FOR_WEB_PAGE)\nlet logList;\n\n/**\n * @module cc\n */\n\ncc.log = cc.warn = cc.error = cc.assert = console.log.bind ? console.log.bind(console) : console.log;\n\nlet resetDebugSetting = function (mode) {\n    // reset\n    cc.log = cc.warn = cc.error = cc.assert = function () {};\n\n    if (mode === DebugMode.NONE)\n        return;\n\n    if (mode > DebugMode.ERROR) {\n        //log to web page\n\n        function logToWebPage (msg) {\n            if (!cc.game.canvas)\n                return;\n\n            if (!logList) {\n                var logDiv = document.createElement(\"Div\");\n                logDiv.setAttribute(\"id\", \"logInfoDiv\");\n                logDiv.setAttribute(\"width\", \"200\");\n                logDiv.setAttribute(\"height\", cc.game.canvas.height);\n                var logDivStyle = logDiv.style;\n                logDivStyle.zIndex = \"99999\";\n                logDivStyle.position = \"absolute\";\n                logDivStyle.top = logDivStyle.left = \"0\";\n\n                logList = document.createElement(\"textarea\");\n                logList.setAttribute(\"rows\", \"20\");\n                logList.setAttribute(\"cols\", \"30\");\n                logList.setAttribute(\"disabled\", \"true\");\n                var logListStyle = logList.style;\n                logListStyle.backgroundColor = \"transparent\";\n                logListStyle.borderBottom = \"1px solid #cccccc\";\n                logListStyle.borderTopWidth = logListStyle.borderLeftWidth = logListStyle.borderRightWidth = \"0px\";\n                logListStyle.borderTopStyle = logListStyle.borderLeftStyle = logListStyle.borderRightStyle = \"none\";\n                logListStyle.padding = \"0px\";\n                logListStyle.margin = 0;\n\n                logDiv.appendChild(logList);\n                cc.game.canvas.parentNode.appendChild(logDiv);\n            }\n\n            logList.value = logList.value + msg + \"\\r\\n\";\n            logList.scrollTop = logList.scrollHeight;\n        }\n\n        cc.error = function () {\n            logToWebPage(\"ERROR :  \" + cc.js.formatStr.apply(null, arguments));\n        };\n        cc.assert = function (cond, msg) {\n            'use strict';\n            if (!cond && msg) {\n                msg = cc.js.formatStr.apply(null, cc.js.shiftArguments.apply(null, arguments));\n                logToWebPage(\"ASSERT: \" + msg);\n            }\n        };\n        if (mode !== DebugMode.ERROR_FOR_WEB_PAGE) {\n            cc.warn = function () {\n                logToWebPage(\"WARN :  \" + cc.js.formatStr.apply(null, arguments));\n            };\n        }\n        if (mode === DebugMode.INFO_FOR_WEB_PAGE) {\n            cc.log = function () {\n                logToWebPage(cc.js.formatStr.apply(null, arguments));\n            };\n        }\n    }\n    else if (console && console.log.apply) {//console is null when user doesn't open dev tool on IE9\n        //log to console\n\n        // For JSB\n        if (!console.error) console.error = console.log;\n        if (!console.warn) console.warn = console.log;\n\n        /**\n         * !#en\n         * Outputs an error message to the Cocos Creator Console (editor) or Web Console (runtime).<br/>\n         * - In Cocos Creator, error is red.<br/>\n         * - In Chrome, error have a red icon along with red message text.<br/>\n         * !#zh\n         * 输出错误消息到 Cocos Creator 编辑器的 Console 或运行时页面端的 Console 中。<br/>\n         * - 在 Cocos Creator 中，错误信息显示是红色的。<br/>\n         * - 在 Chrome 中，错误信息有红色的图标以及红色的消息文本。<br/>\n         *\n         * @method error\n         * @param {any} msg - A JavaScript string containing zero or more substitution strings.\n         * @param {any} ...subst - JavaScript objects with which to replace substitution strings within msg. This gives you additional control over the format of the output.\n         */\n        if (CC_EDITOR) {\n            cc.error = Editor.error;\n        }\n        else if (console.error.bind) {\n            // use bind to avoid pollute call stacks\n            cc.error = console.error.bind(console);\n        }\n        else {\n            cc.error = CC_JSB || CC_RUNTIME ? console.error : function () {\n                return console.error.apply(console, arguments);\n            };\n        }\n        cc.assert = function (cond, msg) {\n            if (!cond) {\n                if (msg) {\n                    msg = cc.js.formatStr.apply(null, cc.js.shiftArguments.apply(null, arguments));\n                }\n                if (CC_DEV) {\n                    debugger;\n                }\n                if (CC_TEST) {\n                    ok(false, msg);\n                }\n                else {\n                    throw new Error(msg);\n                }\n            }\n        }\n    }\n    if (mode !== DebugMode.ERROR) {\n        /**\n         * !#en\n         * Outputs a warning message to the Cocos Creator Console (editor) or Web Console (runtime).\n         * - In Cocos Creator, warning is yellow.\n         * - In Chrome, warning have a yellow warning icon with the message text.\n         * !#zh\n         * 输出警告消息到 Cocos Creator 编辑器的 Console 或运行时 Web 端的 Console 中。<br/>\n         * - 在 Cocos Creator 中，警告信息显示是黄色的。<br/>\n         * - 在 Chrome 中，警告信息有着黄色的图标以及黄色的消息文本。<br/>\n         * @method warn\n         * @param {any} msg - A JavaScript string containing zero or more substitution strings.\n         * @param {any} ...subst - JavaScript objects with which to replace substitution strings within msg. This gives you additional control over the format of the output.\n         */\n        if (CC_EDITOR) {\n            cc.warn = Editor.warn;\n        }\n        else if (console.warn.bind) {\n            // use bind to avoid pollute call stacks\n            cc.warn = console.warn.bind(console);\n        }\n        else {\n            cc.warn = CC_JSB || CC_RUNTIME ? console.warn : function () {\n                return console.warn.apply(console, arguments);\n            };\n        }\n    }\n    if (CC_EDITOR) {\n        cc.log = Editor.log;\n    }\n    else if (mode === DebugMode.INFO) {\n        /**\n         * !#en Outputs a message to the Cocos Creator Console (editor) or Web Console (runtime).\n         * !#zh 输出一条消息到 Cocos Creator 编辑器的 Console 或运行时 Web 端的 Console 中。\n         * @method log\n         * @param {String|any} msg - A JavaScript string containing zero or more substitution strings.\n         * @param {any} ...subst - JavaScript objects with which to replace substitution strings within msg. This gives you additional control over the format of the output.\n         */\n        if (CC_JSB || CC_RUNTIME) {\n            if (scriptEngineType === \"JavaScriptCore\") {\n                // console.log has to use `console` as its context for iOS 8~9. Therefore, apply it.\n                cc.log = function () {\n                    return console.log.apply(console, arguments);\n                };\n            } else {\n                cc.log = console.log;\n            }\n        }\n        else if (console.log.bind) {\n            // use bind to avoid pollute call stacks\n            cc.log = console.log.bind(console);\n        }\n        else {\n            cc.log = function () {\n                return console.log.apply(console, arguments);\n            };\n        }\n    }\n};\n\ncc._throw = CC_EDITOR ? Editor.error : function (error) {\n    utils.callInNextTick(function () {\n        throw error;\n    });\n};\n\nfunction getTypedFormatter (type) {\n    return function () {\n        var id = arguments[0];\n        var msg = CC_DEBUG ? (debugInfos[id] || 'unknown id') : `${type} ${id}, please go to ${ERROR_MAP_URL}#${id} to see details.`;\n        if (arguments.length === 1) {\n            return msg;\n        }\n        else if (arguments.length === 2) {\n            return CC_DEBUG ? cc.js.formatStr(msg, arguments[1]) :\n                msg + ' Arguments: ' + arguments[1];\n        }\n        else {\n            var argsArray = cc.js.shiftArguments.apply(null, arguments);\n            return CC_DEBUG ? cc.js.formatStr.apply(null, [msg].concat(argsArray)) :\n                msg + ' Arguments: ' + argsArray.join(', ');\n        }\n    };\n}\n\nvar logFormatter = getTypedFormatter('Log');\ncc.logID = function () {\n    cc.log(logFormatter.apply(null, arguments));\n};\n\nvar warnFormatter = getTypedFormatter('Warning');\ncc.warnID = function () {\n    cc.warn(warnFormatter.apply(null, arguments));\n};\n\nvar errorFormatter = getTypedFormatter('Error');\ncc.errorID = function () {\n    cc.error(errorFormatter.apply(null, arguments));\n};\n\nvar assertFormatter = getTypedFormatter('Assert');\ncc.assertID = function (cond) {\n    'use strict';\n    if (cond) {\n        return;\n    }\n    cc.assert(false, assertFormatter.apply(null, cc.js.shiftArguments.apply(null, arguments)));\n};\n\n/**\n* !#en Enum for debug modes.\n* !#zh 调试模式\n* @enum debug.DebugMode\n* @memberof cc\n */\nvar DebugMode = cc.Enum({\n    /**\n     * !#en The debug mode none.\n     * !#zh 禁止模式，禁止显示任何日志信息。\n     * @property NONE\n     * @type {Number}\n     * @static\n     */\n    NONE: 0,\n    /**\n     * !#en The debug mode info.\n     * !#zh 信息模式，在 console 中显示所有日志。\n     * @property INFO\n     * @type {Number}\n     * @static\n     */\n    INFO: 1,\n    /**\n     * !#en The debug mode warn.\n     * !#zh 警告模式，在 console 中只显示 warn 级别以上的（包含 error）日志。\n     * @property WARN\n     * @type {Number}\n     * @static\n     */\n    WARN: 2,\n    /**\n     * !#en The debug mode error.\n     * !#zh 错误模式，在 console 中只显示 error 日志。\n     * @property ERROR\n     * @type {Number}\n     * @static\n     */\n    ERROR: 3,\n    /**\n     * !#en The debug mode info for web page.\n     * !#zh 信息模式（仅 WEB 端有效），在画面上输出所有信息。\n     * @property INFO_FOR_WEB_PAGE\n     * @type {Number}\n     * @static\n     */\n    INFO_FOR_WEB_PAGE: 4,\n    /**\n     * !#en The debug mode warn for web page.\n     * !#zh 警告模式（仅 WEB 端有效），在画面上输出 warn 级别以上的（包含 error）信息。\n     * @property WARN_FOR_WEB_PAGE\n     * @type {Number}\n     * @static\n     */\n    WARN_FOR_WEB_PAGE: 5,\n    /**\n     * !#en The debug mode error for web page.\n     * !#zh 错误模式（仅 WEB 端有效），在画面上输出 error 信息。\n     * @property ERROR_FOR_WEB_PAGE\n     * @type {Number}\n     * @static\n     */\n    ERROR_FOR_WEB_PAGE: 6\n});\n/**\n * !#en An object to boot the game.\n * !#zh 包含游戏主体信息并负责驱动游戏的游戏对象。\n * @class debug\n * @main\n * @static\n */\nmodule.exports = cc.debug = {\n    DebugMode: DebugMode,\n\n    _resetDebugSetting: resetDebugSetting,\n\n    /**\n     * !#en Gets error message with the error id and possible parameters.\n     * !#zh 通过 error id 和必要的参数来获取错误信息。\n     * @method getError\n     * @param {String} errorId\n     * @param {any} [param]\n     * @return {String}\n     */\n    getError: getTypedFormatter('ERROR'),\n\n    /**\n     * !#en Returns whether or not to display the FPS informations.\n     * !#zh 是否显示 FPS 信息。\n     * @method isDisplayStats\n     * @return {Boolean}\n     */\n    isDisplayStats: function () {\n        return cc.profiler ? cc.profiler.isShowingStats() : false;\n    },\n\n    /**\n     * !#en Sets whether display the FPS on the bottom-left corner.\n     * !#zh 设置是否在左下角显示 FPS。\n     * @method setDisplayStats\n     * @param {Boolean} displayStats\n     */\n    setDisplayStats: function (displayStats) {\n        if (cc.profiler && cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS) {\n            displayStats ? cc.profiler.showStats() : cc.profiler.hideStats();\n            cc.game.config.showFPS = !!displayStats;\n        }\n    },\n}","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst EventTarget = require('./event/event-target');\nconst AutoReleaseUtils = require('./load-pipeline/auto-release-utils');\nconst ComponentScheduler = require('./component-scheduler');\nconst NodeActivator = require('./node-activator');\nconst Obj = require('./platform/CCObject');\nconst game = require('./CCGame');\nconst renderer = require('./renderer');\nconst eventManager = require('./event-manager');\nconst Scheduler = require('./CCScheduler');\n\n//----------------------------------------------------------------------------------------------------------------------\n\n/**\n * !#en\n * <p>\n *    ATTENTION: USE cc.director INSTEAD OF cc.Director.<br/>\n *    cc.director is a singleton object which manage your game's logic flow.<br/>\n *    Since the cc.director is a singleton, you don't need to call any constructor or create functions,<br/>\n *    the standard way to use it is by calling:<br/>\n *      - cc.director.methodName(); <br/>\n *\n *    It creates and handle the main Window and manages how and when to execute the Scenes.<br/>\n *    <br/>\n *    The cc.director is also responsible for:<br/>\n *      - initializing the OpenGL context<br/>\n *      - setting the OpenGL pixel format (default on is RGB565)<br/>\n *      - setting the OpenGL buffer depth (default on is 0-bit)<br/>\n *      - setting the color for clear screen (default one is BLACK)<br/>\n *      - setting the projection (default one is 3D)<br/>\n *      - setting the orientation (default one is Portrait)<br/>\n *      <br/>\n *    <br/>\n *    The cc.director also sets the default OpenGL context:<br/>\n *      - GL_TEXTURE_2D is enabled<br/>\n *      - GL_VERTEX_ARRAY is enabled<br/>\n *      - GL_COLOR_ARRAY is enabled<br/>\n *      - GL_TEXTURE_COORD_ARRAY is enabled<br/>\n * </p>\n * <p>\n *   cc.director also synchronizes timers with the refresh rate of the display.<br/>\n *   Features and Limitations:<br/>\n *      - Scheduled timers & drawing are synchronizes with the refresh rate of the display<br/>\n *      - Only supports animation intervals of 1/60 1/30 & 1/15<br/>\n * </p>\n *\n * !#zh\n * <p>\n *     注意：用 cc.director 代替 cc.Director。<br/>\n *     cc.director 一个管理你的游戏的逻辑流程的单例对象。<br/>\n *     由于 cc.director 是一个单例，你不需要调用任何构造函数或创建函数，<br/>\n *     使用它的标准方法是通过调用：<br/>\n *       - cc.director.methodName();\n *     <br/>\n *     它创建和处理主窗口并且管理什么时候执行场景。<br/>\n *     <br/>\n *     cc.director 还负责：<br/>\n *      - 初始化 OpenGL 环境。<br/>\n *      - 设置OpenGL像素格式。(默认是 RGB565)<br/>\n *      - 设置OpenGL缓冲区深度 (默认是 0-bit)<br/>\n *      - 设置空白场景的颜色 (默认是 黑色)<br/>\n *      - 设置投影 (默认是 3D)<br/>\n *      - 设置方向 (默认是 Portrait)<br/>\n *    <br/>\n *    cc.director 设置了 OpenGL 默认环境 <br/>\n *      - GL_TEXTURE_2D   启用。<br/>\n *      - GL_VERTEX_ARRAY 启用。<br/>\n *      - GL_COLOR_ARRAY  启用。<br/>\n *      - GL_TEXTURE_COORD_ARRAY 启用。<br/>\n * </p>\n * <p>\n *   cc.director 也同步定时器与显示器的刷新速率。\n *   <br/>\n *   特点和局限性: <br/>\n *      - 将计时器 & 渲染与显示器的刷新频率同步。<br/>\n *      - 只支持动画的间隔 1/60 1/30 & 1/15。<br/>\n * </p>\n *\n * @class Director\n * @extends EventTarget\n */\ncc.Director = function () {\n    EventTarget.call(this);\n\n    // paused?\n    this._paused = false;\n    // purge?\n    this._purgeDirectorInNextLoop = false;\n\n    this._winSizeInPoints = null;\n\n    // scenes\n    this._loadingScene = '';\n    this._scene = null;\n\n    // FPS\n    this._totalFrames = 0;\n    this._lastUpdate = 0;\n    this._deltaTime = 0.0;\n    this._startTime = 0.0;\n\n    // ParticleSystem max step delta time\n    this._maxParticleDeltaTime = 0.0;\n\n    // Scheduler for user registration update\n    this._scheduler = null;\n    // Scheduler for life-cycle methods in component\n    this._compScheduler = null;\n    // Node activator\n    this._nodeActivator = null;\n    // Action manager\n    this._actionManager = null;\n\n    var self = this;\n    game.on(game.EVENT_SHOW, function () {\n        self._lastUpdate = performance.now();\n    });\n\n    game.once(game.EVENT_ENGINE_INITED, this.init, this);\n};\n\ncc.Director.prototype = {\n    constructor: cc.Director,\n    init: function () {\n        this._totalFrames = 0;\n        this._lastUpdate = performance.now();\n        this._startTime = this._lastUpdate;\n        this._paused = false;\n        this._purgeDirectorInNextLoop = false;\n        this._winSizeInPoints = cc.size(0, 0);\n        this._scheduler = new Scheduler();\n\n        if (cc.ActionManager) {\n            this._actionManager = new cc.ActionManager();\n            this._scheduler.scheduleUpdate(this._actionManager, Scheduler.PRIORITY_SYSTEM, false);\n        } else {\n            this._actionManager = null;\n        }\n\n        this.sharedInit();\n        return true;\n    },\n\n    /*\n     * Manage all init process shared between the web engine and jsb engine.\n     * All platform independent init process should be occupied here.\n     */\n    sharedInit: function () {\n        this._compScheduler = new ComponentScheduler();\n        this._nodeActivator = new NodeActivator();\n\n        // Event manager\n        if (eventManager) {\n            eventManager.setEnabled(true);\n        }\n\n        // Animation manager\n        if (cc.AnimationManager) {\n            this._animationManager = new cc.AnimationManager();\n            this._scheduler.scheduleUpdate(this._animationManager, Scheduler.PRIORITY_SYSTEM, false);\n        }\n        else {\n            this._animationManager = null;\n        }\n\n        // collision manager\n        if (cc.CollisionManager) {\n            this._collisionManager = new cc.CollisionManager();\n            this._scheduler.scheduleUpdate(this._collisionManager, Scheduler.PRIORITY_SYSTEM, false);\n        }\n        else {\n            this._collisionManager = null;\n        }\n\n        // physics manager\n        if (cc.PhysicsManager) {\n            this._physicsManager = new cc.PhysicsManager();\n            this._scheduler.scheduleUpdate(this._physicsManager, Scheduler.PRIORITY_SYSTEM, false);\n        }\n        else {\n            this._physicsManager = null;\n        }\n\n        // physics 3d manager\n        if (cc.Physics3DManager) {\n            this._physics3DManager = new cc.Physics3DManager();\n            this._scheduler.scheduleUpdate(this._physics3DManager, Scheduler.PRIORITY_SYSTEM, false);\n        } else {\n            this._physics3DManager = null;\n        }\n\n        // WidgetManager\n        if (cc._widgetManager) {\n            cc._widgetManager.init(this);\n        }\n\n        cc.loader.init(this);\n    },\n\n    /**\n     * calculates delta time since last time it was called\n     */\n    calculateDeltaTime: function (now) {\n        if (!now) now = performance.now();\n\n        // avoid delta time from being negative\n        // negative deltaTime would be caused by the precision of now's value, for details please see: https://developer.mozilla.org/zh-CN/docs/Web/API/window/requestAnimationFrame\n        this._deltaTime = now > this._lastUpdate ? (now - this._lastUpdate) / 1000 : 0;\n        if (CC_DEBUG && (this._deltaTime > 1))\n            this._deltaTime = 1 / 60.0;\n\n        this._lastUpdate = now;\n    },\n\n    /**\n     * !#en\n     * Converts a view coordinate to an WebGL coordinate<br/>\n     * Useful to convert (multi) touches coordinates to the current layout (portrait or landscape)<br/>\n     * Implementation can be found in CCDirectorWebGL.\n     * !#zh 将触摸点的屏幕坐标转换为 WebGL View 下的坐标。\n     * @method convertToGL\n     * @param {Vec2} uiPoint\n     * @return {Vec2}\n     * @deprecated since v2.0\n     */\n    convertToGL: function (uiPoint) {\n        var container = game.container;\n        var view = cc.view;\n        var box = container.getBoundingClientRect();\n        var left = box.left + window.pageXOffset - container.clientLeft;\n        var top = box.top + window.pageYOffset - container.clientTop;\n        var x = view._devicePixelRatio * (uiPoint.x - left);\n        var y = view._devicePixelRatio * (top + box.height - uiPoint.y);\n        return view._isRotated ? cc.v2(view._viewportRect.width - y, x) : cc.v2(x, y);\n    },\n\n    /**\n     * !#en\n     * Converts an OpenGL coordinate to a view coordinate<br/>\n     * Useful to convert node points to window points for calls such as glScissor<br/>\n     * Implementation can be found in CCDirectorWebGL.\n     * !#zh 将触摸点的 WebGL View 坐标转换为屏幕坐标。\n     * @method convertToUI\n     * @param {Vec2} glPoint\n     * @return {Vec2}\n     * @deprecated since v2.0\n     */\n    convertToUI: function (glPoint) {\n        var container = game.container;\n        var view = cc.view;\n        var box = container.getBoundingClientRect();\n        var left = box.left + window.pageXOffset - container.clientLeft;\n        var top = box.top + window.pageYOffset - container.clientTop;\n        var uiPoint = cc.v2(0, 0);\n        if (view._isRotated) {\n            uiPoint.x = left + glPoint.y / view._devicePixelRatio;\n            uiPoint.y = top + box.height - (view._viewportRect.width - glPoint.x) / view._devicePixelRatio;\n        }\n        else {\n            uiPoint.x = left + glPoint.x * view._devicePixelRatio;\n            uiPoint.y = top + box.height - glPoint.y * view._devicePixelRatio;\n        }\n        return uiPoint;\n    },\n\n    /**\n     * End the life of director in the next frame\n     * @method end\n     */\n    end: function () {\n        this._purgeDirectorInNextLoop = true;\n    },\n\n    /**\n     * !#en\n     * Returns the size of the WebGL view in points.<br/>\n     * It takes into account any possible rotation (device orientation) of the window.\n     * !#zh 获取视图的大小，以点为单位。\n     * @method getWinSize\n     * @return {Size}\n     * @deprecated since v2.0\n     */\n    getWinSize: function () {\n        return cc.size(cc.winSize);\n    },\n\n    /**\n     * !#en\n     * Returns the size of the OpenGL view in pixels.<br/>\n     * It takes into account any possible rotation (device orientation) of the window.<br/>\n     * On Mac winSize and winSizeInPixels return the same value.\n     * (The pixel here refers to the resource resolution. If you want to get the physics resolution of device, you need to use cc.view.getFrameSize())\n     * !#zh\n     * 获取视图大小，以像素为单位（这里的像素指的是资源分辨率。\n     * 如果要获取屏幕物理分辨率，需要用 cc.view.getFrameSize()）\n     * @method getWinSizeInPixels\n     * @return {Size}\n     * @deprecated since v2.0\n     */\n    getWinSizeInPixels: function () {\n        return cc.size(cc.winSize);\n    },\n\n    /**\n     * !#en Pause the director's ticker, only involve the game logic execution.\n     * It won't pause the rendering process nor the event manager.\n     * If you want to pause the entier game including rendering, audio and event, \n     * please use {{#crossLink \"Game.pause\"}}cc.game.pause{{/crossLink}}\n     * !#zh 暂停正在运行的场景，该暂停只会停止游戏逻辑执行，但是不会停止渲染和 UI 响应。\n     * 如果想要更彻底得暂停游戏，包含渲染，音频和事件，请使用 {{#crossLink \"Game.pause\"}}cc.game.pause{{/crossLink}}。\n     * @method pause\n     */\n    pause: function () {\n        if (this._paused)\n            return;\n        this._paused = true;\n    },\n\n    /**\n     * Removes cached all cocos2d cached data.\n     * @deprecated since v2.0\n     */\n    purgeCachedData: function () {\n        cc.loader.releaseAll();\n    },\n\n    /**\n     * Purge the cc.director itself, including unschedule all schedule, remove all event listeners, clean up and exit the running scene, stops all animations, clear cached data.\n     */\n    purgeDirector: function () {\n        //cleanup scheduler\n        this._scheduler.unscheduleAll();\n        this._compScheduler.unscheduleAll();\n\n        this._nodeActivator.reset();\n\n        // Disable event dispatching\n        if (eventManager)\n            eventManager.setEnabled(false);\n\n        if (!CC_EDITOR) {\n            if (cc.isValid(this._scene)) {\n                this._scene.destroy();\n            }\n            this._scene = null;\n\n            cc.renderer.clear();\n            cc.AssetLibrary.resetBuiltins();\n        }\n\n        cc.game.pause();\n\n        // Clear all caches\n        cc.loader.releaseAll();\n    },\n\n    /**\n     * Reset the cc.director, can be used to restart the director after purge\n     */\n    reset: function () {\n        this.purgeDirector();\n\n        if (eventManager)\n            eventManager.setEnabled(true);\n\n        // Action manager\n        if (this._actionManager){\n            this._scheduler.scheduleUpdate(this._actionManager, cc.Scheduler.PRIORITY_SYSTEM, false);\n        }\n\n        // Animation manager\n        if (this._animationManager) {\n            this._scheduler.scheduleUpdate(this._animationManager, cc.Scheduler.PRIORITY_SYSTEM, false);\n        }\n\n        // Collider manager\n        if (this._collisionManager) {\n            this._scheduler.scheduleUpdate(this._collisionManager, cc.Scheduler.PRIORITY_SYSTEM, false);\n        }\n\n        // Physics manager\n        if (this._physicsManager) {\n            this._scheduler.scheduleUpdate(this._physicsManager, cc.Scheduler.PRIORITY_SYSTEM, false);\n        }\n\n        cc.game.resume();\n    },\n\n    /**\n     * !#en\n     * Run a scene. Replaces the running scene with a new one or enter the first scene.<br/>\n     * The new scene will be launched immediately.\n     * !#zh 立刻切换指定场景。\n     * @method runSceneImmediate\n     * @param {Scene} scene - The need run scene.\n     * @param {Function} [onBeforeLoadScene] - The function invoked at the scene before loading.\n     * @param {Function} [onLaunched] - The function invoked at the scene after launch.\n     */\n    runSceneImmediate: function (scene, onBeforeLoadScene, onLaunched) {\n        cc.assertID(scene instanceof cc.Scene, 1216);\n\n        CC_BUILD && CC_DEBUG && console.time('InitScene');\n        scene._load();  // ensure scene initialized\n        CC_BUILD && CC_DEBUG && console.timeEnd('InitScene');\n\n        // Re-attach or replace persist nodes\n        CC_BUILD && CC_DEBUG && console.time('AttachPersist');\n        var persistNodeList = Object.keys(game._persistRootNodes).map(function (x) {\n            return game._persistRootNodes[x];\n        });\n        for (let i = 0; i < persistNodeList.length; i++) {\n            let node = persistNodeList[i];\n            var existNode = scene.getChildByUuid(node.uuid);\n            if (existNode) {\n                // scene also contains the persist node, select the old one\n                var index = existNode.getSiblingIndex();\n                existNode._destroyImmediate();\n                scene.insertChild(node, index);\n            }\n            else {\n                node.parent = scene;\n            }\n        }\n        CC_BUILD && CC_DEBUG && console.timeEnd('AttachPersist');\n\n        var oldScene = this._scene;\n        if (!CC_EDITOR) {\n            // auto release assets\n            CC_BUILD && CC_DEBUG && console.time('AutoRelease');\n            var autoReleaseAssets = oldScene && oldScene.autoReleaseAssets && oldScene.dependAssets;\n            AutoReleaseUtils.autoRelease(autoReleaseAssets, scene.dependAssets, persistNodeList);\n            CC_BUILD && CC_DEBUG && console.timeEnd('AutoRelease');\n        }\n\n        // unload scene\n        CC_BUILD && CC_DEBUG && console.time('Destroy');\n        if (cc.isValid(oldScene)) {\n            oldScene.destroy();\n        }\n\n        this._scene = null;\n\n        // purge destroyed nodes belongs to old scene\n        Obj._deferredDestroy();\n        CC_BUILD && CC_DEBUG && console.timeEnd('Destroy');\n\n        if (onBeforeLoadScene) {\n            onBeforeLoadScene();\n        }\n        this.emit(cc.Director.EVENT_BEFORE_SCENE_LAUNCH, scene);\n\n        // Run an Entity Scene\n        this._scene = scene;\n\n        CC_BUILD && CC_DEBUG && console.time('Activate');\n        scene._activate();\n        CC_BUILD && CC_DEBUG && console.timeEnd('Activate');\n\n        //start scene\n        cc.game.resume();\n\n        if (onLaunched) {\n            onLaunched(null, scene);\n        }\n        this.emit(cc.Director.EVENT_AFTER_SCENE_LAUNCH, scene);\n    },\n\n    /**\n     * !#en\n     * Run a scene. Replaces the running scene with a new one or enter the first scene.\n     * The new scene will be launched at the end of the current frame.\n     * !#zh 运行指定场景。\n     * @method runScene\n     * @param {Scene} scene - The need run scene.\n     * @param {Function} [onBeforeLoadScene] - The function invoked at the scene before loading.\n     * @param {Function} [onLaunched] - The function invoked at the scene after launch.\n     * @private\n     */\n    runScene: function (scene, onBeforeLoadScene, onLaunched) {\n        cc.assertID(scene, 1205);\n        cc.assertID(scene instanceof cc.Scene, 1216);\n\n        // ensure scene initialized\n        scene._load();\n\n        // Delay run / replace scene to the end of the frame\n        this.once(cc.Director.EVENT_AFTER_UPDATE, function () {\n            this.runSceneImmediate(scene, onBeforeLoadScene, onLaunched);\n        }, this);\n    },\n\n    //  @Scene loading section\n\n    _getSceneUuid: function (key) {\n        var scenes = game._sceneInfos;\n        if (typeof key === 'string') {\n            if (!key.endsWith('.fire')) {\n                key += '.fire';\n            }\n            if (key[0] !== '/' && !key.startsWith('db://')) {\n                key = '/' + key;    // 使用全名匹配\n            }\n            // search scene\n            for (var i = 0; i < scenes.length; i++) {\n                var info = scenes[i];\n                if (info.url.endsWith(key)) {\n                    return info;\n                }\n            }\n        }\n        else if (typeof key === 'number') {\n            if (0 <= key && key < scenes.length) {\n                return scenes[key];\n            }\n            else {\n                cc.errorID(1206, key);\n            }\n        }\n        else {\n            cc.errorID(1207, key);\n        }\n        return null;\n    },\n\n    /**\n     * !#en Loads the scene by its name.\n     * !#zh 通过场景名称进行加载场景。\n     *\n     * @method loadScene\n     * @param {String} sceneName - The name of the scene to load.\n     * @param {Function} [onLaunched] - callback, will be called after scene launched.\n     * @return {Boolean} if error, return false\n     */\n    loadScene: function (sceneName, onLaunched, _onUnloaded) {\n        if (this._loadingScene) {\n            cc.warnID(1208, sceneName, this._loadingScene);\n            return false;\n        }\n        var info = this._getSceneUuid(sceneName);\n        if (info) {\n            var uuid = info.uuid;\n            this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING, sceneName);\n            this._loadingScene = sceneName;\n            this._loadSceneByUuid(uuid, onLaunched, _onUnloaded);\n            return true;\n        }\n        else {\n            cc.errorID(1209, sceneName);\n            return false;\n        }\n    },\n\n    /**\n     * !#en\n     * Preloads the scene to reduces loading time. You can call this method at any time you want.\n     * After calling this method, you still need to launch the scene by `cc.director.loadScene`.\n     * It will be totally fine to call `cc.director.loadScene` at any time even if the preloading is not\n     * yet finished, the scene will be launched after loaded automatically.\n     * !#zh 预加载场景，你可以在任何时候调用这个方法。\n     * 调用完后，你仍然需要通过 `cc.director.loadScene` 来启动场景，因为这个方法不会执行场景加载操作。\n     * 就算预加载还没完成，你也可以直接调用 `cc.director.loadScene`，加载完成后场景就会启动。\n     *\n     * @method preloadScene\n     * @param {String} sceneName - The name of the scene to preload.\n     * @param {Function} [onProgress] - callback, will be called when the load progression change.\n     * @param {Number} onProgress.completedCount - The number of the items that are already completed\n     * @param {Number} onProgress.totalCount - The total number of the items\n     * @param {Object} onProgress.item - The latest item which flow out the pipeline\n     * @param {Function} [onLoaded] - callback, will be called after scene loaded.\n     * @param {Error} onLoaded.error - null or the error object.\n     * @param {cc.SceneAsset} onLoaded.asset - The scene asset itself.\n     */\n    preloadScene: function (sceneName, onProgress, onLoaded) {\n        if (onLoaded === undefined) {\n            onLoaded = onProgress;\n            onProgress = null;\n        }\n\n        var info = this._getSceneUuid(sceneName);\n        if (info) {\n            this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING, sceneName);\n            cc.loader.load({ uuid: info.uuid, type: 'uuid' }, \n                onProgress,    \n                function (error, asset) {\n                    if (error) {\n                        cc.errorID(1210, sceneName, error.message);\n                    }\n                    if (onLoaded) {\n                        onLoaded(error, asset);\n                    }\n                });       \n        }\n        else {\n            var error = 'Can not preload the scene \"' + sceneName + '\" because it is not in the build settings.';\n            onLoaded(new Error(error));\n            cc.error('preloadScene: ' + error);\n        }\n    },\n\n    /**\n     * Loads the scene by its uuid.\n     * @method _loadSceneByUuid\n     * @param {String} uuid - the uuid of the scene asset to load\n     * @param {Function} [onLaunched]\n     * @param {Function} [onUnloaded]\n     * @param {Boolean} [dontRunScene] - Just download and initialize the scene but will not launch it,\n     *                                   only take effect in the Editor.\n     * @private\n     */\n    _loadSceneByUuid: function (uuid, onLaunched, onUnloaded, dontRunScene) {\n        if (CC_EDITOR) {\n            if (typeof onLaunched === 'boolean') {\n                dontRunScene = onLaunched;\n                onLaunched = null;\n            }\n            if (typeof onUnloaded === 'boolean') {\n                dontRunScene = onUnloaded;\n                onUnloaded = null;\n            }\n        }\n        //cc.AssetLibrary.unloadAsset(uuid);     // force reload\n        console.time('LoadScene ' + uuid);\n        cc.AssetLibrary.loadAsset(uuid, function (error, sceneAsset) {\n            console.timeEnd('LoadScene ' + uuid);\n            var self = cc.director;\n            self._loadingScene = '';\n            if (error) {\n                error = 'Failed to load scene: ' + error;\n                cc.error(error);\n            }\n            else {\n                if (sceneAsset instanceof cc.SceneAsset) {\n                    var scene = sceneAsset.scene;\n                    scene._id = sceneAsset._uuid;\n                    scene._name = sceneAsset._name;\n                    if (CC_EDITOR) {\n                        if (!dontRunScene) {\n                            self.runSceneImmediate(scene, onUnloaded, onLaunched);\n                        }\n                        else {\n                            scene._load();\n                            if (onLaunched) {\n                                onLaunched(null, scene);\n                            }\n                        }\n                    }\n                    else {\n                        self.runSceneImmediate(scene, onUnloaded, onLaunched);\n                    }\n                    return;\n                }\n                else {\n                    error = 'The asset ' + uuid + ' is not a scene';\n                    cc.error(error);\n                }\n            }\n            if (onLaunched) {\n                onLaunched(error);\n            }\n        });\n    },\n\n    /**\n     * !#en Resume game logic execution after pause, if the current scene is not paused, nothing will happen.\n     * !#zh 恢复暂停场景的游戏逻辑，如果当前场景没有暂停将没任何事情发生。\n     * @method resume\n     */\n    resume: function () {\n        if (!this._paused) {\n            return;\n        }\n\n        this._lastUpdate = performance.now();\n        if (!this._lastUpdate) {\n            cc.logID(1200);\n        }\n\n        this._paused = false;\n        this._deltaTime = 0;\n    },\n\n    /**\n     * !#en\n     * Enables or disables WebGL depth test.<br/>\n     * Implementation can be found in CCDirectorCanvas.js/CCDirectorWebGL.js\n     * !#zh 启用/禁用深度测试（在 Canvas 渲染模式下不会生效）。\n     * @method setDepthTest\n     * @param {Boolean} on\n     * @deprecated since v2.0\n     */\n    setDepthTest: function (value) {\n        if (!cc.Camera.main) {\n            return;\n        }\n        cc.Camera.main.depth = !!value;\n    },\n\n    /**\n     * !#en\n     * Set color for clear screen.<br/>\n     * (Implementation can be found in CCDirectorCanvas.js/CCDirectorWebGL.js)\n     * !#zh\n     * 设置场景的默认擦除颜色。<br/>\n     * 支持全透明，但不支持透明度为中间值。要支持全透明需手工开启 cc.macro.ENABLE_TRANSPARENT_CANVAS。\n     * @method setClearColor\n     * @param {Color} clearColor\n     * @deprecated since v2.0\n     */\n    setClearColor: function (clearColor) {\n        if (!cc.Camera.main) {\n            return;\n        }\n        cc.Camera.main.backgroundColor = clearColor;\n    },\n\n    /**\n     * !#en Returns current logic Scene.\n     * !#zh 获取当前逻辑场景。\n     * @method getRunningScene\n     * @private\n     * @return {Scene}\n     * @deprecated since v2.0\n     */\n    getRunningScene: function () {\n        return this._scene;\n    },\n\n    /**\n     * !#en Returns current logic Scene.\n     * !#zh 获取当前逻辑场景。\n     * @method getScene\n     * @return {Scene}\n     * @example\n     *  // This will help you to get the Canvas node in scene\n     *  cc.director.getScene().getChildByName('Canvas');\n     */\n    getScene: function () {\n        return this._scene;\n    },\n\n    /**\n     * !#en Returns the FPS value. Please use {{#crossLink \"Game.setFrameRate\"}}cc.game.setFrameRate{{/crossLink}} to control animation interval.\n     * !#zh 获取单位帧执行时间。请使用 {{#crossLink \"Game.setFrameRate\"}}cc.game.setFrameRate{{/crossLink}} 来控制游戏帧率。\n     * @method getAnimationInterval\n     * @deprecated since v2.0\n     * @return {Number}\n     */\n    getAnimationInterval: function () {\n        return 1000 / game.getFrameRate();\n    },\n\n    /**\n     * Sets animation interval, this doesn't control the main loop.\n     * To control the game's frame rate overall, please use {{#crossLink \"Game.setFrameRate\"}}cc.game.setFrameRate{{/crossLink}}\n     * @method setAnimationInterval\n     * @deprecated since v2.0\n     * @param {Number} value - The animation interval desired.\n     */\n    setAnimationInterval: function (value) {\n        game.setFrameRate(Math.round(1000 / value));\n    },\n\n    /**\n     * !#en Returns the delta time since last frame.\n     * !#zh 获取上一帧的增量时间。\n     * @method getDeltaTime\n     * @return {Number}\n     */\n    getDeltaTime: function () {\n        return this._deltaTime;\n    },\n\n    /**\n     * !#en Returns the total passed time since game start, unit: ms\n     * !#zh 获取从游戏开始到现在总共经过的时间，单位为 ms\n     * @method getTotalTime\n     * @return {Number}\n     */\n    getTotalTime: function () {\n        return performance.now() - this._startTime;\n    },\n\n    /**\n     * !#en Returns how many frames were called since the director started.\n     * !#zh 获取 director 启动以来游戏运行的总帧数。\n     * @method getTotalFrames\n     * @return {Number}\n     */\n    getTotalFrames: function () {\n        return this._totalFrames;\n    },\n\n    /**\n     * !#en Returns whether or not the Director is paused.\n     * !#zh 是否处于暂停状态。\n     * @method isPaused\n     * @return {Boolean}\n     */\n    isPaused: function () {\n        return this._paused;\n    },\n\n    /**\n     * !#en Returns the cc.Scheduler associated with this director.\n     * !#zh 获取和 director 相关联的 cc.Scheduler。\n     * @method getScheduler\n     * @return {Scheduler}\n     */\n    getScheduler: function () {\n        return this._scheduler;\n    },\n\n    /**\n     * !#en Sets the cc.Scheduler associated with this director.\n     * !#zh 设置和 director 相关联的 cc.Scheduler。\n     * @method setScheduler\n     * @param {Scheduler} scheduler\n     */\n    setScheduler: function (scheduler) {\n        if (this._scheduler !== scheduler) {\n            this._scheduler = scheduler;\n        }\n    },\n\n    /**\n     * !#en Returns the cc.ActionManager associated with this director.\n     * !#zh 获取和 director 相关联的 cc.ActionManager（动作管理器）。\n     * @method getActionManager\n     * @return {ActionManager}\n     */\n    getActionManager: function () {\n        return this._actionManager;\n    },\n    /**\n     * !#en Sets the cc.ActionManager associated with this director.\n     * !#zh 设置和 director 相关联的 cc.ActionManager（动作管理器）。\n     * @method setActionManager\n     * @param {ActionManager} actionManager\n     */\n    setActionManager: function (actionManager) {\n        if (this._actionManager !== actionManager) {\n            if (this._actionManager) {\n                this._scheduler.unscheduleUpdate(this._actionManager);\n            }\n            this._actionManager = actionManager;\n            this._scheduler.scheduleUpdate(this._actionManager, cc.Scheduler.PRIORITY_SYSTEM, false);\n        }\n    },\n\n    /* \n     * !#en Returns the cc.AnimationManager associated with this director.\n     * !#zh 获取和 director 相关联的 cc.AnimationManager（动画管理器）。\n     * @method getAnimationManager\n     * @return {AnimationManager}\n     */\n    getAnimationManager: function () {\n        return this._animationManager;\n    },\n\n    /**\n     * !#en Returns the cc.CollisionManager associated with this director.\n     * !#zh 获取和 director 相关联的 cc.CollisionManager （碰撞管理器）。\n     * @method getCollisionManager\n     * @return {CollisionManager}\n     */\n    getCollisionManager: function () {\n        return this._collisionManager;\n    },\n\n    /**\n     * !#en Returns the cc.PhysicsManager associated with this director.\n     * !#zh 返回与 director 相关联的 cc.PhysicsManager （物理管理器）。\n     * @method getPhysicsManager\n     * @return {PhysicsManager}\n     */\n    getPhysicsManager: function () {\n        return this._physicsManager;\n    },\n\n    /**\n     * !#en Returns the cc.Physics3DManager associated with this director.\n     * !#zh 返回与 director 相关联的 cc.Physics3DManager （物理管理器）。\n     * @method getPhysics3DManager\n     * @return {Physics3DManager}\n     */\n    getPhysics3DManager: function () {\n        return this._physics3DManager;\n    },\n\n    // Loop management\n    /*\n     * Starts Animation\n     * @deprecated since v2.1.2\n     */\n    startAnimation: function () {\n        cc.game.resume();\n    },\n\n    /*\n     * Stops animation\n     * @deprecated since v2.1.2\n     */\n    stopAnimation: function () {\n        cc.game.pause();\n    },\n\n    _resetDeltaTime () {\n        this._lastUpdate = performance.now();\n        this._deltaTime = 0;\n    },\n\n    /*\n     * Run main loop of director\n     */\n    mainLoop: CC_EDITOR ? function (deltaTime, updateAnimate) {\n        this._deltaTime = deltaTime;\n\n        // Update\n        if (!this._paused) {\n            this.emit(cc.Director.EVENT_BEFORE_UPDATE);\n\n            this._compScheduler.startPhase();\n            this._compScheduler.updatePhase(deltaTime);\n\n            if (updateAnimate) {\n                this._scheduler.update(deltaTime);\n            }\n\n            this._compScheduler.lateUpdatePhase(deltaTime);\n\n            this.emit(cc.Director.EVENT_AFTER_UPDATE);\n        }\n\n        // Render\n        this.emit(cc.Director.EVENT_BEFORE_DRAW);\n        renderer.render(this._scene, deltaTime);\n        \n        // After draw\n        this.emit(cc.Director.EVENT_AFTER_DRAW);\n\n        this._totalFrames++;\n\n    } : function (now) {\n        if (this._purgeDirectorInNextLoop) {\n            this._purgeDirectorInNextLoop = false;\n            this.purgeDirector();\n        }\n        else {\n            // calculate \"global\" dt\n            this.calculateDeltaTime(now);\n\n            // Update\n            if (!this._paused) {\n                // before update\n                this.emit(cc.Director.EVENT_BEFORE_UPDATE);\n\n                // Call start for new added components\n                this._compScheduler.startPhase();\n\n                // Update for components\n                this._compScheduler.updatePhase(this._deltaTime);\n                // Engine update with scheduler\n                this._scheduler.update(this._deltaTime);\n\n                // Late update for components\n                this._compScheduler.lateUpdatePhase(this._deltaTime);\n\n                // After life-cycle executed\n                this._compScheduler.clearup();\n\n                // User can use this event to do things after update\n                this.emit(cc.Director.EVENT_AFTER_UPDATE);\n                \n                // Destroy entities that have been removed recently\n                Obj._deferredDestroy();\n            }\n\n            // Render\n            this.emit(cc.Director.EVENT_BEFORE_DRAW);\n            renderer.render(this._scene, this._deltaTime);\n\n            // After draw\n            this.emit(cc.Director.EVENT_AFTER_DRAW);\n\n            eventManager.frameUpdateListeners();\n            this._totalFrames++;\n        }\n    },\n\n    __fastOn: function (type, callback, target) {\n        this.on(type, callback, target);\n    },\n\n    __fastOff: function (type, callback, target) {\n        this.off(type, callback, target);\n    },\n};\n\n// Event target\ncc.js.addon(cc.Director.prototype, EventTarget.prototype);\n\n/**\n * !#en The event projection changed of cc.Director. This event will not get triggered since v2.0\n * !#zh cc.Director 投影变化的事件。从 v2.0 开始这个事件不会再被触发\n * @property {String} EVENT_PROJECTION_CHANGED\n * @readonly\n * @static\n * @deprecated since v2.0\n */\ncc.Director.EVENT_PROJECTION_CHANGED = \"director_projection_changed\";\n\n/**\n * !#en The event which will be triggered before loading a new scene.\n * !#zh 加载新场景之前所触发的事件。\n * @event cc.Director.EVENT_BEFORE_SCENE_LOADING\n * @param {String} sceneName - The loading scene name\n */\n/**\n * !#en The event which will be triggered before loading a new scene.\n * !#zh 加载新场景之前所触发的事件。\n * @property {String} EVENT_BEFORE_SCENE_LOADING\n * @readonly\n * @static\n */\ncc.Director.EVENT_BEFORE_SCENE_LOADING = \"director_before_scene_loading\";\n\n/*\n * !#en The event which will be triggered before launching a new scene.\n * !#zh 运行新场景之前所触发的事件。\n * @event cc.Director.EVENT_BEFORE_SCENE_LAUNCH\n * @param {String} sceneName - New scene which will be launched\n */\n/**\n * !#en The event which will be triggered before launching a new scene.\n * !#zh 运行新场景之前所触发的事件。\n * @property {String} EVENT_BEFORE_SCENE_LAUNCH\n * @readonly\n * @static\n */\ncc.Director.EVENT_BEFORE_SCENE_LAUNCH = \"director_before_scene_launch\";\n\n/**\n * !#en The event which will be triggered after launching a new scene.\n * !#zh 运行新场景之后所触发的事件。\n * @event cc.Director.EVENT_AFTER_SCENE_LAUNCH\n * @param {String} sceneName - New scene which is launched\n */\n/**\n * !#en The event which will be triggered after launching a new scene.\n * !#zh 运行新场景之后所触发的事件。\n * @property {String} EVENT_AFTER_SCENE_LAUNCH\n * @readonly\n * @static\n */\ncc.Director.EVENT_AFTER_SCENE_LAUNCH = \"director_after_scene_launch\";\n\n/**\n * !#en The event which will be triggered at the beginning of every frame.\n * !#zh 每个帧的开始时所触发的事件。\n * @event cc.Director.EVENT_BEFORE_UPDATE\n */\n/**\n * !#en The event which will be triggered at the beginning of every frame.\n * !#zh 每个帧的开始时所触发的事件。\n * @property {String} EVENT_BEFORE_UPDATE\n * @readonly\n * @static\n */\ncc.Director.EVENT_BEFORE_UPDATE = \"director_before_update\";\n\n/**\n * !#en The event which will be triggered after engine and components update logic.\n * !#zh 将在引擎和组件 “update” 逻辑之后所触发的事件。\n * @event cc.Director.EVENT_AFTER_UPDATE\n */\n/**\n * !#en The event which will be triggered after engine and components update logic.\n * !#zh 将在引擎和组件 “update” 逻辑之后所触发的事件。\n * @property {String} EVENT_AFTER_UPDATE\n * @readonly\n * @static\n */\ncc.Director.EVENT_AFTER_UPDATE = \"director_after_update\";\n\n/**\n * !#en The event is deprecated since v2.0, please use cc.Director.EVENT_BEFORE_DRAW instead\n * !#zh 这个事件从 v2.0 开始被废弃，请直接使用 cc.Director.EVENT_BEFORE_DRAW\n * @property {String} EVENT_BEFORE_VISIT\n * @readonly\n * @deprecated since v2.0\n * @static\n */\ncc.Director.EVENT_BEFORE_VISIT = \"director_before_draw\";\n\n/**\n * !#en The event is deprecated since v2.0, please use cc.Director.EVENT_BEFORE_DRAW instead\n * !#zh 这个事件从 v2.0 开始被废弃，请直接使用 cc.Director.EVENT_BEFORE_DRAW\n * @property {String} EVENT_AFTER_VISIT\n * @readonly\n * @deprecated since v2.0\n * @static\n */\ncc.Director.EVENT_AFTER_VISIT = \"director_before_draw\";\n\n/**\n * !#en The event which will be triggered before the rendering process.\n * !#zh 渲染过程之前所触发的事件。\n * @event cc.Director.EVENT_BEFORE_DRAW\n */\n/**\n * !#en The event which will be triggered before the rendering process.\n * !#zh 渲染过程之前所触发的事件。\n * @property {String} EVENT_BEFORE_DRAW\n * @readonly\n * @static\n */\ncc.Director.EVENT_BEFORE_DRAW = \"director_before_draw\";\n\n/**\n * !#en The event which will be triggered after the rendering process.\n * !#zh 渲染过程之后所触发的事件。\n * @event cc.Director.EVENT_AFTER_DRAW\n */\n/**\n * !#en The event which will be triggered after the rendering process.\n * !#zh 渲染过程之后所触发的事件。\n * @property {String} EVENT_AFTER_DRAW\n * @readonly\n * @static\n */\ncc.Director.EVENT_AFTER_DRAW = \"director_after_draw\";\n\n//Possible OpenGL projections used by director\n\n/**\n * Constant for 2D projection (orthogonal projection)\n * @property {Number} PROJECTION_2D\n * @default 0\n * @readonly\n * @static\n * @deprecated since v2.0\n */\ncc.Director.PROJECTION_2D = 0;\n\n/**\n * Constant for 3D projection with a fovy=60, znear=0.5f and zfar=1500.\n * @property {Number} PROJECTION_3D\n * @default 1\n * @readonly\n * @static\n * @deprecated since v2.0\n */\ncc.Director.PROJECTION_3D = 1;\n\n/**\n * Constant for custom projection, if cc.Director's projection set to it, it calls \"updateProjection\" on the projection delegate.\n * @property {Number} PROJECTION_CUSTOM\n * @default 3\n * @readonly\n * @static\n * @deprecated since v2.0\n */\ncc.Director.PROJECTION_CUSTOM = 3;\n\n/**\n * Constant for default projection of cc.Director, default projection is 2D projection\n * @property {Number} PROJECTION_DEFAULT\n * @default cc.Director.PROJECTION_2D\n * @readonly\n * @static\n * @deprecated since v2.0\n */\ncc.Director.PROJECTION_DEFAULT = cc.Director.PROJECTION_2D;\n\n/**\n * The event which will be triggered before the physics process.<br/>\n * 物理过程之前所触发的事件。\n * @event Director.EVENT_BEFORE_PHYSICS\n * @readonly\n */\ncc.Director.EVENT_BEFORE_PHYSICS = 'director_before_physics';\n\n/**\n * The event which will be triggered after the physics process.<br/>\n * 物理过程之后所触发的事件。\n * @event Director.EVENT_AFTER_PHYSICS\n * @readonly\n */\ncc.Director.EVENT_AFTER_PHYSICS = 'director_after_physics';\n\n/**\n * @module cc\n */\n\n/**\n * !#en Director\n * !#zh 导演类。\n * @property director\n * @type {Director}\n */\ncc.director = new cc.Director();\n\nmodule.exports = cc.director;","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar EventTarget = require('./event/event-target');\nrequire('../audio/CCAudioEngine');\nconst debug = require('./CCDebug');\nconst renderer = require('./renderer/index.js');\nconst dynamicAtlasManager = require('../core/renderer/utils/dynamic-atlas/manager');\n\n/**\n * @module cc\n */\n\n/**\n * !#en An object to boot the game.\n * !#zh 包含游戏主体信息并负责驱动游戏的游戏对象。\n * @class Game\n * @extends EventTarget\n */\nvar game = {\n    /**\n     * !#en Event triggered when game hide to background.\n     * Please note that this event is not 100% guaranteed to be fired on Web platform,\n     * on native platforms, it corresponds to enter background event, os status bar or notification center may not trigger this event.\n     * !#zh 游戏进入后台时触发的事件。\n     * 请注意，在 WEB 平台，这个事件不一定会 100% 触发，这完全取决于浏览器的回调行为。\n     * 在原生平台，它对应的是应用被切换到后台事件，下拉菜单和上拉状态栏等不一定会触发这个事件，这取决于系统行为。\n     * @property EVENT_HIDE\n     * @type {String}\n     * @example\n     * cc.game.on(cc.game.EVENT_HIDE, function () {\n     *     cc.audioEngine.pauseMusic();\n     *     cc.audioEngine.pauseAllEffects();\n     * });\n     */\n    EVENT_HIDE: \"game_on_hide\",\n\n    /**\n     * !#en Event triggered when game back to foreground\n     * Please note that this event is not 100% guaranteed to be fired on Web platform,\n     * on native platforms, it corresponds to enter foreground event.\n     * !#zh 游戏进入前台运行时触发的事件。\n     * 请注意，在 WEB 平台，这个事件不一定会 100% 触发，这完全取决于浏览器的回调行为。\n     * 在原生平台，它对应的是应用被切换到前台事件。\n     * @property EVENT_SHOW\n     * @constant\n     * @type {String}\n     */\n    EVENT_SHOW: \"game_on_show\",\n\n    /**\n     * !#en Event triggered when game restart\n     * !#zh 调用restart后，触发事件。\n     * @property EVENT_RESTART\n     * @constant\n     * @type {String}\n     */\n    EVENT_RESTART: \"game_on_restart\",\n\n    /**\n     * Event triggered after game inited, at this point all engine objects and game scripts are loaded\n     * @property EVENT_GAME_INITED\n     * @constant\n     * @type {String}\n     */\n    EVENT_GAME_INITED: \"game_inited\",\n\n    /**\n     * Event triggered after engine inited, at this point you will be able to use all engine classes. \n     * It was defined as EVENT_RENDERER_INITED in cocos creator v1.x and renamed in v2.0\n     * @property EVENT_ENGINE_INITED\n     * @constant\n     * @type {String}\n     */\n    EVENT_ENGINE_INITED: \"engine_inited\",\n    // deprecated\n    EVENT_RENDERER_INITED: \"engine_inited\",\n\n    /**\n     * Web Canvas 2d API as renderer backend\n     * @property RENDER_TYPE_CANVAS\n     * @constant\n     * @type {Number}\n     */\n    RENDER_TYPE_CANVAS: 0,\n    /**\n     * WebGL API as renderer backend\n     * @property RENDER_TYPE_WEBGL\n     * @constant\n     * @type {Number}\n     */\n    RENDER_TYPE_WEBGL: 1,\n    /**\n     * OpenGL API as renderer backend\n     * @property RENDER_TYPE_OPENGL\n     * @constant\n     * @type {Number}\n     */\n    RENDER_TYPE_OPENGL: 2,\n\n    _persistRootNodes: {},\n\n    // states\n    _paused: true,//whether the game is paused\n    _configLoaded: false,//whether config loaded\n    _isCloning: false,    // deserializing or instantiating\n    _prepared: false, //whether the engine has prepared\n    _rendererInitialized: false,\n\n    _renderContext: null,\n\n    _intervalId: null,//interval target of main\n\n    _lastTime: null,\n    _frameTime: null,\n\n    // Scenes list\n    _sceneInfos: [],\n\n    /**\n     * !#en The outer frame of the game canvas, parent of game container.\n     * !#zh 游戏画布的外框，container 的父容器。\n     * @property frame\n     * @type {Object}\n     */\n    frame: null,\n    /**\n     * !#en The container of game canvas.\n     * !#zh 游戏画布的容器。\n     * @property container\n     * @type {HTMLDivElement}\n     */\n    container: null,\n    /**\n     * !#en The canvas of the game.\n     * !#zh 游戏的画布。\n     * @property canvas\n     * @type {HTMLCanvasElement}\n     */\n    canvas: null,\n\n    /**\n     * !#en The renderer backend of the game.\n     * !#zh 游戏的渲染器类型。\n     * @property renderType\n     * @type {Number}\n     */\n    renderType: -1,\n\n    /**\n     * !#en\n     * The current game configuration, including:<br/>\n     * 1. debugMode<br/>\n     *      \"debugMode\" possible values :<br/>\n     *      0 - No message will be printed.                                                      <br/>\n     *      1 - cc.error, cc.assert, cc.warn, cc.log will print in console.                      <br/>\n     *      2 - cc.error, cc.assert, cc.warn will print in console.                              <br/>\n     *      3 - cc.error, cc.assert will print in console.                                       <br/>\n     *      4 - cc.error, cc.assert, cc.warn, cc.log will print on canvas, available only on web.<br/>\n     *      5 - cc.error, cc.assert, cc.warn will print on canvas, available only on web.        <br/>\n     *      6 - cc.error, cc.assert will print on canvas, available only on web.                 <br/>\n     * 2. showFPS<br/>\n     *      Left bottom corner fps information will show when \"showFPS\" equals true, otherwise it will be hide.<br/>\n     * 3. exposeClassName<br/>\n     *      Expose class name to chrome debug tools, the class intantiate performance is a little bit slower when exposed.<br/>\n     * 4. frameRate<br/>\n     *      \"frameRate\" set the wanted frame rate for your game, but the real fps depends on your game implementation and the running environment.<br/>\n     * 5. id<br/>\n     *      \"gameCanvas\" sets the id of your canvas element on the web page, it's useful only on web.<br/>\n     * 6. renderMode<br/>\n     *      \"renderMode\" sets the renderer type, only useful on web :<br/>\n     *      0 - Automatically chosen by engine<br/>\n     *      1 - Forced to use canvas renderer<br/>\n     *      2 - Forced to use WebGL renderer, but this will be ignored on mobile browsers<br/>\n     * 7. scenes<br/>\n     *      \"scenes\" include available scenes in the current bundle.<br/>\n     *<br/>\n     * Please DO NOT modify this object directly, it won't have any effect.<br/>\n     * !#zh\n     * 当前的游戏配置，包括：                                                                  <br/>\n     * 1. debugMode（debug 模式，但是在浏览器中这个选项会被忽略）                                <br/>\n     *      \"debugMode\" 各种设置选项的意义。                                                   <br/>\n     *          0 - 没有消息被打印出来。                                                       <br/>\n     *          1 - cc.error，cc.assert，cc.warn，cc.log 将打印在 console 中。                  <br/>\n     *          2 - cc.error，cc.assert，cc.warn 将打印在 console 中。                          <br/>\n     *          3 - cc.error，cc.assert 将打印在 console 中。                                   <br/>\n     *          4 - cc.error，cc.assert，cc.warn，cc.log 将打印在 canvas 中（仅适用于 web 端）。 <br/>\n     *          5 - cc.error，cc.assert，cc.warn 将打印在 canvas 中（仅适用于 web 端）。         <br/>\n     *          6 - cc.error，cc.assert 将打印在 canvas 中（仅适用于 web 端）。                  <br/>\n     * 2. showFPS（显示 FPS）                                                            <br/>\n     *      当 showFPS 为 true 的时候界面的左下角将显示 fps 的信息，否则被隐藏。              <br/>\n     * 3. exposeClassName                                                           <br/>\n     *      暴露类名让 Chrome DevTools 可以识别，如果开启会稍稍降低类的创建过程的性能，但对对象构造没有影响。 <br/>\n     * 4. frameRate (帧率)                                                              <br/>\n     *      “frameRate” 设置想要的帧率你的游戏，但真正的FPS取决于你的游戏实现和运行环境。      <br/>\n     * 5. id                                                                            <br/>\n     *      \"gameCanvas\" Web 页面上的 Canvas Element ID，仅适用于 web 端。                         <br/>\n     * 6. renderMode（渲染模式）                                                         <br/>\n     *      “renderMode” 设置渲染器类型，仅适用于 web 端：                              <br/>\n     *          0 - 通过引擎自动选择。                                                     <br/>\n     *          1 - 强制使用 canvas 渲染。\n     *          2 - 强制使用 WebGL 渲染，但是在部分 Android 浏览器中这个选项会被忽略。     <br/>\n     * 7. scenes                                                                         <br/>\n     *      “scenes” 当前包中可用场景。                                                   <br/>\n     * <br/>\n     * 注意：请不要直接修改这个对象，它不会有任何效果。\n     * @property config\n     * @type {Object}\n     */\n    config: null,\n\n    /**\n     * !#en Callback when the scripts of engine have been load.\n     * !#zh 当引擎完成启动后的回调函数。\n     * @method onStart\n     * @type {Function}\n     */\n    onStart: null,\n\n//@Public Methods\n\n//  @Game play control\n    /**\n     * !#en Set frame rate of game.\n     * !#zh 设置游戏帧率。\n     * @method setFrameRate\n     * @param {Number} frameRate\n     */\n    setFrameRate: function (frameRate) {\n        var config = this.config;\n        config.frameRate = frameRate;\n        if (this._intervalId)\n            window.cancelAnimFrame(this._intervalId);\n        this._intervalId = 0;\n        this._paused = true;\n        this._setAnimFrame();\n        this._runMainLoop();\n    },\n\n    /**\n     * !#en Get frame rate set for the game, it doesn't represent the real frame rate.\n     * !#zh 获取设置的游戏帧率（不等同于实际帧率）。\n     * @method getFrameRate\n     * @return {Number} frame rate\n     */\n    getFrameRate: function () {\n        return this.config.frameRate;\n    },\n\n    /**\n     * !#en Run the game frame by frame.\n     * !#zh 执行一帧游戏循环。\n     * @method step\n     */\n    step: function () {\n        cc.director.mainLoop();\n    },\n\n    /**\n     * !#en Pause the game main loop. This will pause:\n     * game logic execution, rendering process, event manager, background music and all audio effects.\n     * This is different with cc.director.pause which only pause the game logic execution.\n     * !#zh 暂停游戏主循环。包含：游戏逻辑，渲染，事件处理，背景音乐和所有音效。这点和只暂停游戏逻辑的 cc.director.pause 不同。\n     * @method pause\n     */\n    pause: function () {\n        if (this._paused) return;\n        this._paused = true;\n        // Pause audio engine\n        if (cc.audioEngine) {\n            cc.audioEngine._break();\n        }\n        // Pause main loop\n        if (this._intervalId)\n            window.cancelAnimFrame(this._intervalId);\n        this._intervalId = 0;\n    },\n\n    /**\n     * !#en Resume the game from pause. This will resume:\n     * game logic execution, rendering process, event manager, background music and all audio effects.\n     * !#zh 恢复游戏主循环。包含：游戏逻辑，渲染，事件处理，背景音乐和所有音效。\n     * @method resume\n     */\n    resume: function () {\n        if (!this._paused) return;\n        this._paused = false;\n        // Resume audio engine\n        if (cc.audioEngine) {\n            cc.audioEngine._restore();\n        }\n        cc.director._resetDeltaTime();\n        // Resume main loop\n        this._runMainLoop();\n    },\n\n    /**\n     * !#en Check whether the game is paused.\n     * !#zh 判断游戏是否暂停。\n     * @method isPaused\n     * @return {Boolean}\n     */\n    isPaused: function () {\n        return this._paused;\n    },\n\n    /**\n     * !#en Restart game.\n     * !#zh 重新开始游戏\n     * @method restart\n     */\n    restart: function () {\n        cc.director.once(cc.Director.EVENT_AFTER_DRAW, function () {\n            for (var id in game._persistRootNodes) {\n                game.removePersistRootNode(game._persistRootNodes[id]);\n            }\n\n            // Clear scene\n            cc.director.getScene().destroy();\n            cc.Object._deferredDestroy();\n\n            // Clean up audio\n            if (cc.audioEngine) {\n                cc.audioEngine.uncacheAll();\n            }\n\n            cc.director.reset();\n\n            game.pause();\n            cc.AssetLibrary._loadBuiltins(() => {\n                game.onStart();\n                game.emit(game.EVENT_RESTART);\n            });\n        });\n    },\n\n    /**\n     * !#en End game, it will close the game window\n     * !#zh 退出游戏\n     * @method end\n     */\n    end: function () {\n        close();\n    },\n\n//  @Game loading\n\n    _initEngine () {\n        if (this._rendererInitialized) {\n            return;\n        }\n\n        this._initRenderer();\n\n        if (!CC_EDITOR) {\n            this._initEvents();\n        }\n\n        this.emit(this.EVENT_ENGINE_INITED);\n    },\n\n    _loadPreviewScript (cb) {\n        if (CC_PREVIEW && window.__quick_compile_project__) {\n            window.__quick_compile_project__.load(cb);\n        }\n        else {\n            cb();\n        }\n    },\n\n    _prepareFinished (cb) {\n        // Init engine\n        this._initEngine();\n        \n        this._setAnimFrame();\n        cc.AssetLibrary._loadBuiltins(() => {\n            // Log engine version\n            console.log('Cocos Creator v' + cc.ENGINE_VERSION);\n            this._prepared = true;\n            this._runMainLoop();\n\n            this.emit(this.EVENT_GAME_INITED);\n\n            if (cb) cb();\n        });\n    },\n\n    eventTargetOn: EventTarget.prototype.on,\n    eventTargetOnce: EventTarget.prototype.once,\n\n    /**\n     * !#en\n     * Register an callback of a specific event type on the game object.\n     * This type of event should be triggered via `emit`.\n     * !#zh\n     * 注册 game 的特定事件类型回调。这种类型的事件应该被 `emit` 触发。\n     *\n     * @method on\n     * @param {String} type - A string representing the event type to listen for.\n     * @param {Function} callback - The callback that will be invoked when the event is dispatched.\n     *                              The callback is ignored if it is a duplicate (the callbacks are unique).\n     * @param {any} [callback.arg1] arg1\n     * @param {any} [callback.arg2] arg2\n     * @param {any} [callback.arg3] arg3\n     * @param {any} [callback.arg4] arg4\n     * @param {any} [callback.arg5] arg5\n     * @param {Object} [target] - The target (this object) to invoke the callback, can be null\n     * @return {Function} - Just returns the incoming callback so you can save the anonymous function easier.\n     * @typescript\n     * on<T extends Function>(type: string, callback: T, target?: any, useCapture?: boolean): T\n     */\n    on (type, callback, target, once) {\n        // Make sure EVENT_ENGINE_INITED and EVENT_GAME_INITED callbacks to be invoked\n        if ((this._prepared && type === this.EVENT_ENGINE_INITED) ||\n            (!this._paused && type === this.EVENT_GAME_INITED)) {\n            callback.call(target);\n        }\n        else {\n            this.eventTargetOn(type, callback, target, once);\n        }\n    },\n    /**\n     * !#en\n     * Register an callback of a specific event type on the game object,\n     * the callback will remove itself after the first time it is triggered.\n     * !#zh\n     * 注册 game 的特定事件类型回调，回调会在第一时间被触发后删除自身。\n     *\n     * @method once\n     * @param {String} type - A string representing the event type to listen for.\n     * @param {Function} callback - The callback that will be invoked when the event is dispatched.\n     *                              The callback is ignored if it is a duplicate (the callbacks are unique).\n     * @param {any} [callback.arg1] arg1\n     * @param {any} [callback.arg2] arg2\n     * @param {any} [callback.arg3] arg3\n     * @param {any} [callback.arg4] arg4\n     * @param {any} [callback.arg5] arg5\n     * @param {Object} [target] - The target (this object) to invoke the callback, can be null\n     */\n    once (type, callback, target) {\n        // Make sure EVENT_ENGINE_INITED and EVENT_GAME_INITED callbacks to be invoked\n        if ((this._prepared && type === this.EVENT_ENGINE_INITED) ||\n            (!this._paused && type === this.EVENT_GAME_INITED)) {\n            callback.call(target);\n        }\n        else {\n            this.eventTargetOnce(type, callback, target);\n        }\n    },\n\n    /**\n     * !#en Prepare game.\n     * !#zh 准备引擎，请不要直接调用这个函数。\n     * @param {Function} cb\n     * @method prepare\n     */\n    prepare (cb) {\n        // Already prepared\n        if (this._prepared) {\n            if (cb) cb();\n            return;\n        }\n\n        // Load game scripts\n        let jsList = this.config.jsList;\n        if (jsList && jsList.length > 0) {\n            cc.loader.load(jsList, (err) => {\n                if (err) throw new Error(JSON.stringify(err));\n\n                this._loadPreviewScript(() => {\n                    this._prepareFinished(cb);\n                })\n            });\n        }\n        else {\n            this._loadPreviewScript(() => {\n                this._prepareFinished(cb);\n            })\n        }\n    },\n\n    /**\n     * !#en Run game with configuration object and onStart function.\n     * !#zh 运行游戏，并且指定引擎配置和 onStart 的回调。\n     * @method run\n     * @param {Object} config - Pass configuration object or onStart function\n     * @param {Function} onStart - function to be executed after game initialized\n     */\n    run: function (config, onStart) {\n        this._initConfig(config);\n        this.onStart = onStart;\n        this.prepare(game.onStart && game.onStart.bind(game));\n    },\n\n//  @ Persist root node section\n    /**\n     * !#en\n     * Add a persistent root node to the game, the persistent node won't be destroyed during scene transition.<br/>\n     * The target node must be placed in the root level of hierarchy, otherwise this API won't have any effect.\n     * !#zh\n     * 声明常驻根节点，该节点不会被在场景切换中被销毁。<br/>\n     * 目标节点必须位于为层级的根节点，否则无效。\n     * @method addPersistRootNode\n     * @param {Node} node - The node to be made persistent\n     */\n    addPersistRootNode: function (node) {\n        if (!cc.Node.isNode(node) || !node.uuid) {\n            cc.warnID(3800);\n            return;\n        }\n        var id = node.uuid;\n        if (!this._persistRootNodes[id]) {\n            var scene = cc.director._scene;\n            if (cc.isValid(scene)) {\n                if (!node.parent) {\n                    node.parent = scene;\n                }\n                else if ( !(node.parent instanceof cc.Scene) ) {\n                    cc.warnID(3801);\n                    return;\n                }\n                else if (node.parent !== scene) {\n                    cc.warnID(3802);\n                    return;\n                }\n            }\n            this._persistRootNodes[id] = node;\n            node._persistNode = true;\n        }\n    },\n\n    /**\n     * !#en Remove a persistent root node.\n     * !#zh 取消常驻根节点。\n     * @method removePersistRootNode\n     * @param {Node} node - The node to be removed from persistent node list\n     */\n    removePersistRootNode: function (node) {\n        var id = node.uuid || '';\n        if (node === this._persistRootNodes[id]) {\n            delete this._persistRootNodes[id];\n            node._persistNode = false;\n        }\n    },\n\n    /**\n     * !#en Check whether the node is a persistent root node.\n     * !#zh 检查节点是否是常驻根节点。\n     * @method isPersistRootNode\n     * @param {Node} node - The node to be checked\n     * @return {Boolean}\n     */\n    isPersistRootNode: function (node) {\n        return node._persistNode;\n    },\n\n//@Private Methods\n\n//  @Time ticker section\n    _setAnimFrame: function () {\n        this._lastTime = performance.now();\n        var frameRate = game.config.frameRate;\n        this._frameTime = 1000 / frameRate;\n        cc.director._maxParticleDeltaTime = this._frameTime / 1000 * 2;\n        if (CC_JSB || CC_RUNTIME) {\n            jsb.setPreferredFramesPerSecond(frameRate);\n            window.requestAnimFrame = window.requestAnimationFrame;\n            window.cancelAnimFrame = window.cancelAnimationFrame;\n        }\n        else {\n            if (frameRate !== 60 && frameRate !== 30) {\n                window.requestAnimFrame = this._stTime;\n                window.cancelAnimFrame = this._ctTime;\n            }\n            else {\n                window.requestAnimFrame = window.requestAnimationFrame ||\n                window.webkitRequestAnimationFrame ||\n                window.mozRequestAnimationFrame ||\n                window.oRequestAnimationFrame ||\n                window.msRequestAnimationFrame ||\n                this._stTime;\n                window.cancelAnimFrame = window.cancelAnimationFrame ||\n                window.cancelRequestAnimationFrame ||\n                window.msCancelRequestAnimationFrame ||\n                window.mozCancelRequestAnimationFrame ||\n                window.oCancelRequestAnimationFrame ||\n                window.webkitCancelRequestAnimationFrame ||\n                window.msCancelAnimationFrame ||\n                window.mozCancelAnimationFrame ||\n                window.webkitCancelAnimationFrame ||\n                window.oCancelAnimationFrame ||\n                this._ctTime;\n            }\n        }\n    },\n    _stTime: function(callback){\n        var currTime = performance.now();\n        var timeToCall = Math.max(0, game._frameTime - (currTime - game._lastTime));\n        var id = window.setTimeout(function() { callback(); },\n            timeToCall);\n        game._lastTime = currTime + timeToCall;\n        return id;\n    },\n    _ctTime: function(id){\n        window.clearTimeout(id);\n    },\n    //Run game.\n    _runMainLoop: function () {\n        if (CC_EDITOR) {\n            return;\n        }\n        if (!this._prepared) return;\n\n        var self = this, callback, config = self.config,\n            director = cc.director,\n            skip = true, frameRate = config.frameRate;\n\n        debug.setDisplayStats(config.showFPS);\n\n        callback = function (now) {\n            if (!self._paused) {\n                self._intervalId = window.requestAnimFrame(callback);\n                if (!CC_JSB && !CC_RUNTIME && frameRate === 30) {\n                    if (skip = !skip) {\n                        return;\n                    }\n                }\n                director.mainLoop(now);\n            }\n        };\n\n        self._intervalId = window.requestAnimFrame(callback);\n        self._paused = false;\n    },\n\n//  @Game loading section\n    _initConfig (config) {\n        // Configs adjustment\n        if (typeof config.debugMode !== 'number') {\n            config.debugMode = 0;\n        }\n        config.exposeClassName = !!config.exposeClassName;\n        if (typeof config.frameRate !== 'number') {\n            config.frameRate = 60;\n        }\n        let renderMode = config.renderMode;\n        if (typeof renderMode !== 'number' || renderMode > 2 || renderMode < 0) {\n            config.renderMode = 0;\n        }\n        if (typeof config.registerSystemEvent !== 'boolean') {\n            config.registerSystemEvent = true;\n        }\n        if (renderMode === 1) {\n            config.showFPS = false;    \n        }\n        else {\n            config.showFPS = !!config.showFPS;\n        }\n\n        // Scene parser\n        this._sceneInfos = config.scenes || [];\n\n        // Collide Map and Group List\n        this.collisionMatrix = config.collisionMatrix || [];\n        this.groupList = config.groupList || [];\n\n        debug._resetDebugSetting(config.debugMode);\n\n        this.config = config;\n        this._configLoaded = true;\n    },\n\n    _determineRenderType () {\n        let config = this.config,\n            userRenderMode = parseInt(config.renderMode) || 0;\n    \n        // Determine RenderType\n        this.renderType = this.RENDER_TYPE_CANVAS;\n        let supportRender = false;\n    \n        if (userRenderMode === 0) {\n            if (cc.sys.capabilities['opengl']) {\n                this.renderType = this.RENDER_TYPE_WEBGL;\n                supportRender = true;\n            }\n            else if (cc.sys.capabilities['canvas']) {\n                this.renderType = this.RENDER_TYPE_CANVAS;\n                supportRender = true;\n            }\n        }\n        else if (userRenderMode === 1 && cc.sys.capabilities['canvas']) {\n            this.renderType = this.RENDER_TYPE_CANVAS;\n            supportRender = true;\n        }\n        else if (userRenderMode === 2 && cc.sys.capabilities['opengl']) {\n            this.renderType = this.RENDER_TYPE_WEBGL;\n            supportRender = true;\n        }\n    \n        if (!supportRender) {\n            throw new Error(debug.getError(3820, userRenderMode));\n        }\n    },\n\n    _initRenderer () {\n        // Avoid setup to be called twice.\n        if (this._rendererInitialized) return;\n\n        let el = this.config.id,\n            width, height,\n            localCanvas, localContainer;\n\n        if (CC_JSB || CC_RUNTIME) {\n            this.container = localContainer = document.createElement(\"DIV\");\n            this.frame = localContainer.parentNode === document.body ? document.documentElement : localContainer.parentNode;\n            localCanvas = window.__canvas;\n            this.canvas = localCanvas;\n        }\n        else {\n            var element = (el instanceof HTMLElement) ? el : (document.querySelector(el) || document.querySelector('#' + el));\n\n            if (element.tagName === \"CANVAS\") {\n                width = element.width;\n                height = element.height;\n\n                //it is already a canvas, we wrap it around with a div\n                this.canvas = localCanvas = element;\n                this.container = localContainer = document.createElement(\"DIV\");\n                if (localCanvas.parentNode)\n                    localCanvas.parentNode.insertBefore(localContainer, localCanvas);\n            } else {\n                //we must make a new canvas and place into this element\n                if (element.tagName !== \"DIV\") {\n                    cc.warnID(3819);\n                }\n                width = element.clientWidth;\n                height = element.clientHeight;\n                this.canvas = localCanvas = document.createElement(\"CANVAS\");\n                this.container = localContainer = document.createElement(\"DIV\");\n                element.appendChild(localContainer);\n            }\n            localContainer.setAttribute('id', 'Cocos2dGameContainer');\n            localContainer.appendChild(localCanvas);\n            this.frame = (localContainer.parentNode === document.body) ? document.documentElement : localContainer.parentNode;\n\n            function addClass (element, name) {\n                var hasClass = (' ' + element.className + ' ').indexOf(' ' + name + ' ') > -1;\n                if (!hasClass) {\n                    if (element.className) {\n                        element.className += \" \";\n                    }\n                    element.className += name;\n                }\n            }\n            addClass(localCanvas, \"gameCanvas\");\n            localCanvas.setAttribute(\"width\", width || 480);\n            localCanvas.setAttribute(\"height\", height || 320);\n            localCanvas.setAttribute(\"tabindex\", 99);\n        }\n\n        this._determineRenderType();\n        // WebGL context created successfully\n        if (this.renderType === this.RENDER_TYPE_WEBGL) {\n            var opts = {\n                'stencil': true,\n                // MSAA is causing serious performance dropdown on some browsers.\n                'antialias': cc.macro.ENABLE_WEBGL_ANTIALIAS,\n                'alpha': cc.macro.ENABLE_TRANSPARENT_CANVAS\n            };\n            renderer.initWebGL(localCanvas, opts);\n            this._renderContext = renderer.device._gl;\n            \n            // Enable dynamic atlas manager by default\n            if (!cc.macro.CLEANUP_IMAGE_CACHE && dynamicAtlasManager) {\n                dynamicAtlasManager.enabled = true;\n            }\n        }\n        if (!this._renderContext) {\n            this.renderType = this.RENDER_TYPE_CANVAS;\n            // Could be ignored by module settings\n            renderer.initCanvas(localCanvas);\n            this._renderContext = renderer.device._ctx;\n        }\n\n        this.canvas.oncontextmenu = function () {\n            if (!cc._isContextMenuEnable) return false;\n        };\n\n        this._rendererInitialized = true;\n    },\n\n    _initEvents: function () {\n        var win = window, hiddenPropName;\n\n        // register system events\n        if (this.config.registerSystemEvent)\n            cc.internal.inputManager.registerSystemEvent(this.canvas);\n\n        if (typeof document.hidden !== 'undefined') {\n            hiddenPropName = \"hidden\";\n        } else if (typeof document.mozHidden !== 'undefined') {\n            hiddenPropName = \"mozHidden\";\n        } else if (typeof document.msHidden !== 'undefined') {\n            hiddenPropName = \"msHidden\";\n        } else if (typeof document.webkitHidden !== 'undefined') {\n            hiddenPropName = \"webkitHidden\";\n        }\n\n        var hidden = false;\n\n        function onHidden () {\n            if (!hidden) {\n                hidden = true;\n                game.emit(game.EVENT_HIDE);\n            }\n        }\n        // In order to adapt the most of platforms the onshow API.\n        function onShown (arg0, arg1, arg2, arg3, arg4) {\n            if (hidden) {\n                hidden = false;\n                game.emit(game.EVENT_SHOW, arg0, arg1, arg2, arg3, arg4);\n            }\n        }\n\n        if (hiddenPropName) {\n            var changeList = [\n                \"visibilitychange\",\n                \"mozvisibilitychange\",\n                \"msvisibilitychange\",\n                \"webkitvisibilitychange\",\n                \"qbrowserVisibilityChange\"\n            ];\n            for (var i = 0; i < changeList.length; i++) {\n                document.addEventListener(changeList[i], function (event) {\n                    var visible = document[hiddenPropName];\n                    // QQ App\n                    visible = visible || event[\"hidden\"];\n                    if (visible)\n                        onHidden();\n                    else\n                        onShown();\n                });\n            }\n        } else {\n            win.addEventListener(\"blur\", onHidden);\n            win.addEventListener(\"focus\", onShown);\n        }\n\n        if (navigator.userAgent.indexOf(\"MicroMessenger\") > -1) {\n            win.onfocus = onShown;\n        }\n\n        if (\"onpageshow\" in window && \"onpagehide\" in window) {\n            win.addEventListener(\"pagehide\", onHidden);\n            win.addEventListener(\"pageshow\", onShown);\n            // Taobao UIWebKit\n            document.addEventListener(\"pagehide\", onHidden);\n            document.addEventListener(\"pageshow\", onShown);\n        }\n\n        this.on(game.EVENT_HIDE, function () {\n            game.pause();\n        });\n        this.on(game.EVENT_SHOW, function () {\n            game.resume();\n        });\n    }\n};\n\nEventTarget.call(game);\ncc.js.addon(game, EventTarget.prototype);\n\n/**\n * @module cc\n */\n\n/**\n * !#en This is a Game instance.\n * !#zh 这是一个 Game 类的实例，包含游戏主体信息并负责驱动游戏的游戏对象。。\n * @property game\n * @type Game\n */\ncc.game = module.exports = game;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n'use strict';\n\nimport { Mat4, Vec2, Vec3, Quat, Trs } from './value-types';\n\nconst BaseNode = require('./utils/base-node');\nconst PrefabHelper = require('./utils/prefab-helper');\nconst nodeMemPool = require('./utils/trans-pool').NodeMemPool;\nconst AffineTrans = require('./utils/affine-transform');\nconst eventManager = require('./event-manager');\nconst macro = require('./platform/CCMacro');\nconst js = require('./platform/js');\nconst Event = require('./event/event');\nconst EventTarget = require('./event/event-target');\nconst RenderFlow = require('./renderer/render-flow');\n\nconst Flags = cc.Object.Flags;\nconst Destroying = Flags.Destroying;\n\nconst ERR_INVALID_NUMBER = CC_EDITOR && 'The %s is invalid';\nconst ONE_DEGREE = Math.PI / 180;\n\nvar ActionManagerExist = !!cc.ActionManager;\nvar emptyFunc = function () {};\n\n// getWorldPosition temp var\nvar _gwpVec3 = new Vec3();\nvar _gwpQuat = new Quat();\n\n// _invTransformPoint temp var\nvar _tpVec3a = new Vec3();\nvar _tpVec3b = new Vec3();\nvar _tpQuata = new Quat();\nvar _tpQuatb = new Quat();\n\n// setWorldPosition temp var\nvar _swpVec3 = new Vec3();\n\n// getWorldScale temp var\nvar _gwsVec3 = new Vec3();\n\n// setWorldScale temp var\nvar _swsVec3 = new Vec3();\n\n// getWorldRT temp var\nvar _gwrtVec3a = new Vec3();\nvar _gwrtVec3b = new Vec3();\nvar _gwrtQuata = new Quat();\nvar _gwrtQuatb = new Quat();\n\n// lookAt temp var\nvar _laVec3 = new Vec3();\nvar _laQuat = new Quat();\n\n// _hitTest temp var\nvar _htVec3a = new Vec3();\nvar _htVec3b = new Vec3();\n\n// getWorldRotation temp var\nvar _gwrQuat = new Quat();\n\n// setWorldRotation temp var\nvar _swrQuat = new Quat();\n\nvar _quata = new Quat();\nvar _mat4_temp = cc.mat4();\nvar _vec3_temp = new Vec3();\n\nvar _cachedArray = new Array(16);\n_cachedArray.length = 0;\n\nconst POSITION_ON = 1 << 0;\nconst SCALE_ON = 1 << 1;\nconst ROTATION_ON = 1 << 2;\nconst SIZE_ON = 1 << 3;\nconst ANCHOR_ON = 1 << 4;\nconst COLOR_ON = 1 << 5;\n\n\nlet BuiltinGroupIndex = cc.Enum({\n    DEBUG: 31\n});\n\n/**\n * !#en Node's local dirty properties flag\n * !#zh Node 的本地属性 dirty 状态位\n * @enum Node._LocalDirtyFlag\n * @static\n * @private\n * @namespace Node\n */\nvar LocalDirtyFlag = cc.Enum({\n    /**\n     * !#en Flag for position dirty\n     * !#zh 位置 dirty 的标记位\n     * @property {Number} POSITION\n     * @static\n     */\n    POSITION: 1 << 0,\n    /**\n     * !#en Flag for scale dirty\n     * !#zh 缩放 dirty 的标记位\n     * @property {Number} SCALE\n     * @static\n     */\n    SCALE: 1 << 1,\n    /**\n     * !#en Flag for rotation dirty\n     * !#zh 旋转 dirty 的标记位\n     * @property {Number} ROTATION\n     * @static\n     */\n    ROTATION: 1 << 2,\n    /**\n     * !#en Flag for skew dirty\n     * !#zh skew dirty 的标记位\n     * @property {Number} SKEW\n     * @static\n     */\n    SKEW: 1 << 3,\n    /**\n     * !#en Flag for rotation, scale or position dirty\n     * !#zh 旋转，缩放，或位置 dirty 的标记位\n     * @property {Number} TRS\n     * @static\n     */\n    TRS: 1 << 0 | 1 << 1 | 1 << 2,\n    /**\n     * !#en Flag for rotation or scale dirty\n     * !#zh 旋转或缩放 dirty 的标记位\n     * @property {Number} RS\n     * @static\n     */\n    RS: 1 << 1 | 1 << 2,\n    /**\n     * !#en Flag for rotation, scale, position, skew dirty\n     * !#zh 旋转，缩放，位置，或斜角 dirty 的标记位\n     * @property {Number} TRS\n     * @static\n     */\n    TRSS: 1 << 0 | 1 << 1 | 1 << 2 | 1 << 3,\n\n    /**\n     * !#en Flag for physics position dirty\n     * !#zh 物理位置 dirty 的标记位\n     * @property {Number} PHYSICS_POSITION\n     * @static\n     */\n    PHYSICS_POSITION: 1 << 4,\n\n    /**\n     * !#en Flag for physics scale dirty\n     * !#zh 物理缩放 dirty 的标记位\n     * @property {Number} PHYSICS_SCALE\n     * @static\n     */\n    PHYSICS_SCALE: 1 << 5,\n\n    /**\n     * !#en Flag for physics rotation dirty\n     * !#zh 物理旋转 dirty 的标记位\n     * @property {Number} PHYSICS_ROTATION\n     * @static\n     */\n    PHYSICS_ROTATION: 1 << 6,\n\n    /**\n     * !#en Flag for physics trs dirty\n     * !#zh 物理位置旋转缩放 dirty 的标记位\n     * @property {Number} PHYSICS_TRS\n     * @static\n     */\n    PHYSICS_TRS: 1 << 4 | 1 << 5 | 1 << 6,\n\n    /**\n     * !#en Flag for physics rs dirty\n     * !#zh 物理旋转缩放 dirty 的标记位\n     * @property {Number} PHYSICS_RS\n     * @static\n     */\n    PHYSICS_RS: 1 << 5 | 1 << 6,\n\n    /**\n     * !#en Flag for node and physics position dirty\n     * !#zh 所有位置 dirty 的标记位\n     * @property {Number} ALL_POSITION\n     * @static\n     */\n    ALL_POSITION: 1 << 0 | 1 << 4,\n\n    /**\n     * !#en Flag for node and physics scale dirty\n     * !#zh 所有缩放 dirty 的标记位\n     * @property {Number} ALL_SCALE\n     * @static\n     */\n    ALL_SCALE: 1 << 1 | 1 << 5,\n\n    /**\n     * !#en Flag for node and physics rotation dirty\n     * !#zh 所有旋转 dirty 的标记位\n     * @property {Number} ALL_ROTATION\n     * @static\n     */\n    ALL_ROTATION: 1 << 2 | 1 << 6,\n\n    /**\n     * !#en Flag for node and physics trs dirty\n     * !#zh 所有trs dirty 的标记位\n     * @property {Number} ALL_TRS\n     * @static\n     */\n    ALL_TRS: 1 << 0 | 1 << 1 | 1 << 2 | 1 << 4 | 1 << 5 | 1 << 6,\n\n    /**\n     * !#en Flag for all dirty properties\n     * !#zh 覆盖所有 dirty 状态的标记位\n     * @property {Number} ALL\n     * @static\n     */\n    ALL: 0xffff,\n});\n\n/**\n * !#en The event type supported by Node\n * !#zh Node 支持的事件类型\n * @class Node.EventType\n * @static\n * @namespace Node\n */\n// Why EventType defined as class, because the first parameter of Node.on method needs set as 'string' type.\nvar EventType = cc.Enum({\n    /**\n     * !#en The event type for touch start event, you can use its value directly: 'touchstart'\n     * !#zh 当手指触摸到屏幕时。\n     * @property {String} TOUCH_START\n     * @static\n     */\n    TOUCH_START: 'touchstart',\n    /**\n     * !#en The event type for touch move event, you can use its value directly: 'touchmove'\n     * !#zh 当手指在屏幕上移动时。\n     * @property {String} TOUCH_MOVE\n     * @static\n     */\n    TOUCH_MOVE: 'touchmove',\n    /**\n     * !#en The event type for touch end event, you can use its value directly: 'touchend'\n     * !#zh 当手指在目标节点区域内离开屏幕时。\n     * @property {String} TOUCH_END\n     * @static\n     */\n    TOUCH_END: 'touchend',\n    /**\n     * !#en The event type for touch end event, you can use its value directly: 'touchcancel'\n     * !#zh 当手指在目标节点区域外离开屏幕时。\n     * @property {String} TOUCH_CANCEL\n     * @static\n     */\n    TOUCH_CANCEL: 'touchcancel',\n\n    /**\n     * !#en The event type for mouse down events, you can use its value directly: 'mousedown'\n     * !#zh 当鼠标按下时触发一次。\n     * @property {String} MOUSE_DOWN\n     * @static\n     */\n    MOUSE_DOWN: 'mousedown',\n    /**\n     * !#en The event type for mouse move events, you can use its value directly: 'mousemove'\n     * !#zh 当鼠标在目标节点在目标节点区域中移动时，不论是否按下。\n     * @property {String} MOUSE_MOVE\n     * @static\n     */\n    MOUSE_MOVE: 'mousemove',\n    /**\n     * !#en The event type for mouse enter target events, you can use its value directly: 'mouseenter'\n     * !#zh 当鼠标移入目标节点区域时，不论是否按下。\n     * @property {String} MOUSE_ENTER\n     * @static\n     */\n    MOUSE_ENTER: 'mouseenter',\n    /**\n     * !#en The event type for mouse leave target events, you can use its value directly: 'mouseleave'\n     * !#zh 当鼠标移出目标节点区域时，不论是否按下。\n     * @property {String} MOUSE_LEAVE\n     * @static\n     */\n    MOUSE_LEAVE: 'mouseleave',\n    /**\n     * !#en The event type for mouse up events, you can use its value directly: 'mouseup'\n     * !#zh 当鼠标从按下状态松开时触发一次。\n     * @property {String} MOUSE_UP\n     * @static\n     */\n    MOUSE_UP: 'mouseup',\n    /**\n     * !#en The event type for mouse wheel events, you can use its value directly: 'mousewheel'\n     * !#zh 当鼠标滚轮滚动时。\n     * @property {String} MOUSE_WHEEL\n     * @static\n     */\n    MOUSE_WHEEL: 'mousewheel',\n\n    /**\n     * !#en The event type for position change events.\n     * Performance note, this event will be triggered every time corresponding properties being changed,\n     * if the event callback have heavy logic it may have great performance impact, try to avoid such scenario.\n     * !#zh 当节点位置改变时触发的事件。\n     * 性能警告：这个事件会在每次对应的属性被修改时触发，如果事件回调损耗较高，有可能对性能有很大的负面影响，请尽量避免这种情况。\n     * @property {String} POSITION_CHANGED\n     * @static\n     */\n    POSITION_CHANGED: 'position-changed',\n    /**\n     * !#en The event type for rotation change events.\n     * Performance note, this event will be triggered every time corresponding properties being changed,\n     * if the event callback have heavy logic it may have great performance impact, try to avoid such scenario.\n     * !#zh 当节点旋转改变时触发的事件。\n     * 性能警告：这个事件会在每次对应的属性被修改时触发，如果事件回调损耗较高，有可能对性能有很大的负面影响，请尽量避免这种情况。\n     * @property {String} ROTATION_CHANGED\n     * @static\n     */\n    ROTATION_CHANGED: 'rotation-changed',\n    /**\n     * !#en The event type for scale change events.\n     * Performance note, this event will be triggered every time corresponding properties being changed,\n     * if the event callback have heavy logic it may have great performance impact, try to avoid such scenario.\n     * !#zh 当节点缩放改变时触发的事件。\n     * 性能警告：这个事件会在每次对应的属性被修改时触发，如果事件回调损耗较高，有可能对性能有很大的负面影响，请尽量避免这种情况。\n     * @property {String} SCALE_CHANGED\n     * @static\n     */\n    SCALE_CHANGED: 'scale-changed',\n    /**\n     * !#en The event type for size change events.\n     * Performance note, this event will be triggered every time corresponding properties being changed,\n     * if the event callback have heavy logic it may have great performance impact, try to avoid such scenario.\n     * !#zh 当节点尺寸改变时触发的事件。\n     * 性能警告：这个事件会在每次对应的属性被修改时触发，如果事件回调损耗较高，有可能对性能有很大的负面影响，请尽量避免这种情况。\n     * @property {String} SIZE_CHANGED\n     * @static\n     */\n    SIZE_CHANGED: 'size-changed',\n    /**\n     * !#en The event type for anchor point change events.\n     * Performance note, this event will be triggered every time corresponding properties being changed,\n     * if the event callback have heavy logic it may have great performance impact, try to avoid such scenario.\n     * !#zh 当节点锚点改变时触发的事件。\n     * 性能警告：这个事件会在每次对应的属性被修改时触发，如果事件回调损耗较高，有可能对性能有很大的负面影响，请尽量避免这种情况。\n     * @property {String} ANCHOR_CHANGED\n     * @static\n     */\n    ANCHOR_CHANGED: 'anchor-changed',\n    /**\n    * !#en The event type for color change events.\n    * Performance note, this event will be triggered every time corresponding properties being changed,\n    * if the event callback have heavy logic it may have great performance impact, try to avoid such scenario.\n    * !#zh 当节点颜色改变时触发的事件。\n    * 性能警告：这个事件会在每次对应的属性被修改时触发，如果事件回调损耗较高，有可能对性能有很大的负面影响，请尽量避免这种情况。\n    * @property {String} COLOR_CHANGED\n    * @static\n    */\n    COLOR_CHANGED: 'color-changed',\n    /**\n     * !#en The event type for new child added events.\n     * !#zh 当新的子节点被添加时触发的事件。\n     * @property {String} CHILD_ADDED\n     * @static\n     */\n    CHILD_ADDED: 'child-added',\n    /**\n     * !#en The event type for child removed events.\n     * !#zh 当子节点被移除时触发的事件。\n     * @property {String} CHILD_REMOVED\n     * @static\n     */\n    CHILD_REMOVED: 'child-removed',\n    /**\n     * !#en The event type for children reorder events.\n     * !#zh 当子节点顺序改变时触发的事件。\n     * @property {String} CHILD_REORDER\n     * @static\n     */\n    CHILD_REORDER: 'child-reorder',\n    /**\n     * !#en The event type for node group changed events.\n     * !#zh 当节点归属群组发生变化时触发的事件。\n     * @property {String} GROUP_CHANGED\n     * @static\n     */\n    GROUP_CHANGED: 'group-changed',\n    /**\n     * !#en The event type for node's sibling order changed.\n     * !#zh 当节点在兄弟节点中的顺序发生变化时触发的事件。\n     * @property {String} SIBLING_ORDER_CHANGED\n     * @static\n     */\n    SIBLING_ORDER_CHANGED: 'sibling-order-changed',\n});\n\nvar _touchEvents = [\n    EventType.TOUCH_START,\n    EventType.TOUCH_MOVE,\n    EventType.TOUCH_END,\n    EventType.TOUCH_CANCEL,\n];\nvar _mouseEvents = [\n    EventType.MOUSE_DOWN,\n    EventType.MOUSE_ENTER,\n    EventType.MOUSE_MOVE,\n    EventType.MOUSE_LEAVE,\n    EventType.MOUSE_UP,\n    EventType.MOUSE_WHEEL,\n];\n\nvar _skewNeedWarn = true;\nvar _skewWarn = function (value, node) {\n    if (value !== 0) {\n        var nodePath = \"\";\n        if (CC_EDITOR) {\n            var NodeUtils = Editor.require('scene://utils/node');\n            nodePath = `Node: ${NodeUtils.getNodePath(node)}.`\n        }\n        _skewNeedWarn && cc.warn(\"`cc.Node.skewX/Y` is deprecated since v2.2.1, please use 3D node instead.\", nodePath);\n        !CC_EDITOR && (_skewNeedWarn = false);\n    }\n}\n\nvar _currentHovered = null;\n\nvar _touchStartHandler = function (touch, event) {\n    var pos = touch.getLocation();\n    var node = this.owner;\n\n    if (node._hitTest(pos, this)) {\n        event.type = EventType.TOUCH_START;\n        event.touch = touch;\n        event.bubbles = true;\n        node.dispatchEvent(event);\n        return true;\n    }\n    return false;\n};\nvar _touchMoveHandler = function (touch, event) {\n    var node = this.owner;\n    event.type = EventType.TOUCH_MOVE;\n    event.touch = touch;\n    event.bubbles = true;\n    node.dispatchEvent(event);\n};\nvar _touchEndHandler = function (touch, event) {\n    var pos = touch.getLocation();\n    var node = this.owner;\n\n    if (node._hitTest(pos, this)) {\n        event.type = EventType.TOUCH_END;\n    }\n    else {\n        event.type = EventType.TOUCH_CANCEL;\n    }\n    event.touch = touch;\n    event.bubbles = true;\n    node.dispatchEvent(event);\n};\nvar _touchCancelHandler = function (touch, event) {\n    var pos = touch.getLocation();\n    var node = this.owner;\n\n    event.type = EventType.TOUCH_CANCEL;\n    event.touch = touch;\n    event.bubbles = true;\n    node.dispatchEvent(event);\n};\n\nvar _mouseDownHandler = function (event) {\n    var pos = event.getLocation();\n    var node = this.owner;\n\n    if (node._hitTest(pos, this)) {\n        event.type = EventType.MOUSE_DOWN;\n        event.bubbles = true;\n        node.dispatchEvent(event);\n    }\n};\nvar _mouseMoveHandler = function (event) {\n    var pos = event.getLocation();\n    var node = this.owner;\n    var hit = node._hitTest(pos, this);\n    if (hit) {\n        if (!this._previousIn) {\n            // Fix issue when hover node switched, previous hovered node won't get MOUSE_LEAVE notification\n            if (_currentHovered && _currentHovered._mouseListener) {\n                event.type = EventType.MOUSE_LEAVE;\n                _currentHovered.dispatchEvent(event);\n                _currentHovered._mouseListener._previousIn = false;\n            }\n            _currentHovered = this.owner;\n            event.type = EventType.MOUSE_ENTER;\n            node.dispatchEvent(event);\n            this._previousIn = true;\n        }\n        event.type = EventType.MOUSE_MOVE;\n        event.bubbles = true;\n        node.dispatchEvent(event);\n    }\n    else if (this._previousIn) {\n        event.type = EventType.MOUSE_LEAVE;\n        node.dispatchEvent(event);\n        this._previousIn = false;\n        _currentHovered = null;\n    }\n    else {\n        // continue dispatching\n        return;\n    }\n\n    // Event processed, cleanup\n    event.stopPropagation();\n};\nvar _mouseUpHandler = function (event) {\n    var pos = event.getLocation();\n    var node = this.owner;\n\n    if (node._hitTest(pos, this)) {\n        event.type = EventType.MOUSE_UP;\n        event.bubbles = true;\n        node.dispatchEvent(event);\n        event.stopPropagation();\n    }\n};\nvar _mouseWheelHandler = function (event) {\n    var pos = event.getLocation();\n    var node = this.owner;\n\n    if (node._hitTest(pos, this)) {\n        event.type = EventType.MOUSE_WHEEL;\n        event.bubbles = true;\n        node.dispatchEvent(event);\n        event.stopPropagation();\n    }\n};\n\nfunction _searchComponentsInParent (node, comp) {\n    if (comp) {\n        let index = 0;\n        let list = null;\n        for (var curr = node; curr && cc.Node.isNode(curr); curr = curr._parent, ++index) {\n            if (curr.getComponent(comp)) {\n                let next = {\n                    index: index,\n                    node: curr,\n                };\n                \n                if (list) {\n                    list.push(next);\n                } else {\n                    list = [next];\n                }\n            }\n        }\n\n        return list;\n    }\n    \n    return null;\n}\n\nfunction _checkListeners (node, events) {\n    if (!(node._objFlags & Destroying)) {\n        var i = 0;\n        if (node._bubblingListeners) {\n            for (; i < events.length; ++i) {\n                if (node._bubblingListeners.hasEventListener(events[i])) {\n                    return true;\n                }\n            }\n        }\n        if (node._capturingListeners) {\n            for (; i < events.length; ++i) {\n                if (node._capturingListeners.hasEventListener(events[i])) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    return true;\n}\n\nfunction _doDispatchEvent (owner, event) {\n    var target, i;\n    event.target = owner;\n\n    // Event.CAPTURING_PHASE\n    _cachedArray.length = 0;\n    owner._getCapturingTargets(event.type, _cachedArray);\n    // capturing\n    event.eventPhase = 1;\n    for (i = _cachedArray.length - 1; i >= 0; --i) {\n        target = _cachedArray[i];\n        if (target._capturingListeners) {\n            event.currentTarget = target;\n            // fire event\n            target._capturingListeners.emit(event.type, event, _cachedArray);\n            // check if propagation stopped\n            if (event._propagationStopped) {\n                _cachedArray.length = 0;\n                return;\n            }\n        }\n    }\n    _cachedArray.length = 0;\n\n    // Event.AT_TARGET\n    // checks if destroyed in capturing callbacks\n    event.eventPhase = 2;\n    event.currentTarget = owner;\n    if (owner._capturingListeners) {\n        owner._capturingListeners.emit(event.type, event);\n    }\n    if (!event._propagationImmediateStopped && owner._bubblingListeners) {\n        owner._bubblingListeners.emit(event.type, event);\n    }\n\n    if (!event._propagationStopped && event.bubbles) {\n        // Event.BUBBLING_PHASE\n        owner._getBubblingTargets(event.type, _cachedArray);\n        // propagate\n        event.eventPhase = 3;\n        for (i = 0; i < _cachedArray.length; ++i) {\n            target = _cachedArray[i];\n            if (target._bubblingListeners) {\n                event.currentTarget = target;\n                // fire event\n                target._bubblingListeners.emit(event.type, event);\n                // check if propagation stopped\n                if (event._propagationStopped) {\n                    _cachedArray.length = 0;\n                    return;\n                }\n            }\n        }\n    }\n    _cachedArray.length = 0;\n}\n\n// traversal the node tree, child cullingMask must keep the same with the parent.\nfunction _getActualGroupIndex (node) {\n    let groupIndex = node.groupIndex;\n    if (groupIndex === 0 && node.parent) {\n        groupIndex = _getActualGroupIndex(node.parent);\n    }\n    return groupIndex;\n}\n\nfunction _updateCullingMask (node) {\n    let index = _getActualGroupIndex(node);\n    node._cullingMask = 1 << index;\n    if (CC_JSB && CC_NATIVERENDERER) {\n        node._proxy && node._proxy.updateCullingMask();\n    };\n    for (let i = 0; i < node._children.length; i++) {\n        _updateCullingMask(node._children[i]);\n    }\n}\n\n// 2D/3D matrix functions\nfunction updateLocalMatrix3D () {\n    if (this._localMatDirty & LocalDirtyFlag.TRSS) {\n        // Update transform\n        let t = this._matrix;\n        let tm = t.m;\n        Trs.toMat4(t, this._trs);\n\n        // skew\n        if (this._skewX || this._skewY) {\n            let a = tm[0], b = tm[1], c = tm[4], d = tm[5];\n            let skx = Math.tan(this._skewX * ONE_DEGREE);\n            let sky = Math.tan(this._skewY * ONE_DEGREE);\n            if (skx === Infinity)\n                skx = 99999999;\n            if (sky === Infinity)\n                sky = 99999999;\n            tm[0] = a + c * sky;\n            tm[1] = b + d * sky;\n            tm[4] = c + a * skx;\n            tm[5] = d + b * skx;\n        }\n        this._localMatDirty &= ~LocalDirtyFlag.TRSS;\n        // Register dirty status of world matrix so that it can be recalculated\n        this._worldMatDirty = true;\n    }\n}\n\nfunction updateLocalMatrix2D () {\n    let dirtyFlag = this._localMatDirty;\n    if (!(dirtyFlag & LocalDirtyFlag.TRSS)) return;\n\n    // Update transform\n    let t = this._matrix;\n    let tm = t.m;\n    let trs = this._trs;\n\n    if (dirtyFlag & (LocalDirtyFlag.RS | LocalDirtyFlag.SKEW)) {\n        let rotation = -this._eulerAngles.z;\n        let hasSkew = this._skewX || this._skewY;\n        let sx = trs[7], sy = trs[8];\n\n        if (rotation || hasSkew) {\n            let a = 1, b = 0, c = 0, d = 1;\n            // rotation\n            if (rotation) {\n                let rotationRadians = rotation * ONE_DEGREE;\n                c = Math.sin(rotationRadians);\n                d = Math.cos(rotationRadians);\n                a = d;\n                b = -c;\n            }\n            // scale\n            tm[0] = a *= sx;\n            tm[1] = b *= sx;\n            tm[4] = c *= sy;\n            tm[5] = d *= sy;\n            // skew\n            if (hasSkew) {\n                let a = tm[0], b = tm[1], c = tm[4], d = tm[5];\n                let skx = Math.tan(this._skewX * ONE_DEGREE);\n                let sky = Math.tan(this._skewY * ONE_DEGREE);\n                if (skx === Infinity)\n                    skx = 99999999;\n                if (sky === Infinity)\n                    sky = 99999999;\n                tm[0] = a + c * sky;\n                tm[1] = b + d * sky;\n                tm[4] = c + a * skx;\n                tm[5] = d + b * skx;\n            }\n        }\n        else {\n            tm[0] = sx;\n            tm[1] = 0;\n            tm[4] = 0;\n            tm[5] = sy;\n        }\n    }\n\n    // position\n    tm[12] = trs[0];\n    tm[13] = trs[1];\n    \n    this._localMatDirty &= ~LocalDirtyFlag.TRSS;\n    // Register dirty status of world matrix so that it can be recalculated\n    this._worldMatDirty = true;\n}\n\nfunction calculWorldMatrix3D () {\n    // Avoid as much function call as possible\n    if (this._localMatDirty & LocalDirtyFlag.TRSS) {\n        this._updateLocalMatrix();\n    }\n\n    if (this._parent) {\n        let parentMat = this._parent._worldMatrix;\n        Mat4.mul(this._worldMatrix, parentMat, this._matrix);\n    }\n    else {\n        Mat4.copy(this._worldMatrix, this._matrix);\n    }\n    this._worldMatDirty = false;\n}\n\nfunction calculWorldMatrix2D () {\n    // Avoid as much function call as possible\n    if (this._localMatDirty & LocalDirtyFlag.TRSS) {\n        this._updateLocalMatrix();\n    }\n    \n    // Assume parent world matrix is correct\n    let parent = this._parent;\n    if (parent) {\n        this._mulMat(this._worldMatrix, parent._worldMatrix, this._matrix);\n    }\n    else {\n        Mat4.copy(this._worldMatrix, this._matrix);\n    }\n    this._worldMatDirty = false;\n}\n\nfunction mulMat2D (out, a, b) {\n    let am = a.m, bm = b.m, outm = out.m;\n    let aa=am[0], ab=am[1], ac=am[4], ad=am[5], atx=am[12], aty=am[13];\n    let ba=bm[0], bb=bm[1], bc=bm[4], bd=bm[5], btx=bm[12], bty=bm[13];\n    if (ab !== 0 || ac !== 0) {\n        outm[0] = ba * aa + bb * ac;\n        outm[1] = ba * ab + bb * ad;\n        outm[4] = bc * aa + bd * ac;\n        outm[5] = bc * ab + bd * ad;\n        outm[12] = aa * btx + ac * bty + atx;\n        outm[13] = ab * btx + ad * bty + aty;\n    }\n    else {\n        outm[0] = ba * aa;\n        outm[1] = bb * ad;\n        outm[4] = bc * aa;\n        outm[5] = bd * ad;\n        outm[12] = aa * btx + atx;\n        outm[13] = ad * bty + aty;\n    }\n}\n\nconst mulMat3D = Mat4.mul;\n\n/**\n * !#en\n * Class of all entities in Cocos Creator scenes.<br/>\n * For events supported by Node, please refer to {{#crossLink \"Node.EventType\"}}{{/crossLink}}\n * !#zh\n * Cocos Creator 场景中的所有节点类。<br/>\n * 支持的节点事件，请参阅 {{#crossLink \"Node.EventType\"}}{{/crossLink}}。\n * @class Node\n * @extends _BaseNode\n */\nlet NodeDefines = {\n    name: 'cc.Node',\n    extends: BaseNode,\n\n    properties: {\n        // SERIALIZABLE\n        _opacity: 255,\n        _color: cc.Color.WHITE,\n        _contentSize: cc.Size,\n        _anchorPoint: cc.v2(0.5, 0.5),\n        _position: undefined,\n        _scale: undefined,\n        _trs: null,\n        _eulerAngles: cc.Vec3,\n        _skewX: 0.0,\n        _skewY: 0.0,\n        _zIndex: {\n            default: undefined,\n            type: cc.Integer\n        },\n        _localZOrder: {\n            default: 0,\n            serializable: false\n        },\n    \n        _is3DNode: false,\n\n        // internal properties\n        /**\n         * !#en\n         * Group index of node.<br/>\n         * Which Group this node belongs to will resolve that this node's collision components can collide with which other collision componentns.<br/>\n         * !#zh\n         * 节点的分组索引。<br/>\n         * 节点的分组将关系到节点的碰撞组件可以与哪些碰撞组件相碰撞。<br/>\n         * @property groupIndex\n         * @type {Integer}\n         * @default 0\n         */\n        _groupIndex: {\n            default: 0,\n            formerlySerializedAs: 'groupIndex'\n        },\n        groupIndex: {\n            get () {\n                return this._groupIndex;\n            },\n            set (value) {\n                this._groupIndex = value;\n                _updateCullingMask(this);\n                this.emit(EventType.GROUP_CHANGED, this);\n            }\n        },\n\n        /**\n         * !#en\n         * Group of node.<br/>\n         * Which Group this node belongs to will resolve that this node's collision components can collide with which other collision componentns.<br/>\n         * !#zh\n         * 节点的分组。<br/>\n         * 节点的分组将关系到节点的碰撞组件可以与哪些碰撞组件相碰撞。<br/>\n         * @property group\n         * @type {String}\n         */\n        group: {\n            get () {\n                return cc.game.groupList[this.groupIndex] || '';\n            },\n\n            set (value) {\n                // update the groupIndex\n                this.groupIndex = cc.game.groupList.indexOf(value);\n            }\n        },\n\n        //properties moved from base node begin\n\n        /**\n         * !#en The position (x, y) of the node in its parent's coordinates.\n         * !#zh 节点在父节点坐标系中的位置（x, y）。\n         * @property {Vec3} position\n         * @example\n         * cc.log(\"Node Position: \" + node.position);\n         */\n\n        /**\n         * !#en x axis position of node.\n         * !#zh 节点 X 轴坐标。\n         * @property x\n         * @type {Number}\n         * @example\n         * node.x = 100;\n         * cc.log(\"Node Position X: \" + node.x);\n         */\n        x: {\n            get () {\n                return this._trs[0];\n            },\n            set (value) {\n                let trs = this._trs;\n                if (value !== trs[0]) {\n                    if (!CC_EDITOR || isFinite(value)) {\n                        let oldValue;\n                        if (CC_EDITOR) {\n                            oldValue = trs[0];\n                        }\n\n                        trs[0] = value;\n                        this.setLocalDirty(LocalDirtyFlag.ALL_POSITION);\n                        \n                        // fast check event\n                        if (this._eventMask & POSITION_ON) {\n                            // send event\n                            if (CC_EDITOR) {\n                                this.emit(EventType.POSITION_CHANGED, new cc.Vec3(oldValue, trs[1], trs[2]));\n                            }\n                            else {\n                                this.emit(EventType.POSITION_CHANGED);\n                            }\n                        }\n                    }\n                    else {\n                        cc.error(ERR_INVALID_NUMBER, 'new x');\n                    }\n                }\n            },\n        },\n\n        /**\n         * !#en y axis position of node.\n         * !#zh 节点 Y 轴坐标。\n         * @property y\n         * @type {Number}\n         * @example\n         * node.y = 100;\n         * cc.log(\"Node Position Y: \" + node.y);\n         */\n        y: {\n            get () {\n                return this._trs[1];\n            },\n            set (value) {\n                let trs = this._trs;\n                if (value !== trs[1]) {\n                    if (!CC_EDITOR || isFinite(value)) {\n                        let oldValue;\n                        if (CC_EDITOR) {\n                            oldValue = trs[1];\n                        }\n\n                        trs[1] = value;\n                        this.setLocalDirty(LocalDirtyFlag.ALL_POSITION);\n\n                        // fast check event\n                        if (this._eventMask & POSITION_ON) {\n                            // send event\n                            if (CC_EDITOR) {\n                                this.emit(EventType.POSITION_CHANGED, new cc.Vec3(trs[0], oldValue, trs[2]));\n                            }\n                            else {\n                                this.emit(EventType.POSITION_CHANGED);\n                            }\n                        }\n                    }\n                    else {\n                        cc.error(ERR_INVALID_NUMBER, 'new y');\n                    }\n                }\n            },\n        },\n\n        /**\n         * !#en z axis position of node.\n         * !#zh 节点 Z 轴坐标。\n         * @property z\n         * @type {Number}\n         */\n        z: {\n            get () {\n                return this._trs[2];\n            }, \n            set (value) {\n                let trs = this._trs;\n                if (value !== trs[2]) {\n                    if (!CC_EDITOR || isFinite(value)) {\n                        trs[2] = value;\n                        this.setLocalDirty(LocalDirtyFlag.ALL_POSITION);\n                        !CC_NATIVERENDERER && (this._renderFlag |= RenderFlow.FLAG_WORLD_TRANSFORM);\n                        // fast check event\n                        if (this._eventMask & POSITION_ON) {\n                            this.emit(EventType.POSITION_CHANGED);\n                        }\n                    }\n                    else {\n                        cc.error(ERR_INVALID_NUMBER, 'new z');\n                    }\n                }\n            }\n        },\n\n        /**\n         * !#en Rotation of node.\n         * !#zh 该节点旋转角度。\n         * @property rotation\n         * @type {Number}\n         * @deprecated since v2.1\n         * @example\n         * node.rotation = 90;\n         * cc.log(\"Node Rotation: \" + node.rotation);\n         */\n        rotation: {\n            get () {\n                if (CC_DEBUG) {\n                    cc.warn(\"`cc.Node.rotation` is deprecated since v2.1.0, please use `-angle` instead. (`this.node.rotation` -> `-this.node.angle`)\");\n                }\n                return -this.angle;\n            },\n            set (value) {\n                if (CC_DEBUG) {\n                    cc.warn(\"`cc.Node.rotation` is deprecated since v2.1.0, please set `-angle` instead. (`this.node.rotation = x` -> `this.node.angle = -x`)\");\n                }\n                this.angle = -value;\n            }\n        },\n\n        /**\n         * !#en\n         * Angle of node, the positive value is anti-clockwise direction.\n         * !#zh\n         * 该节点的旋转角度，正值为逆时针方向。\n         * @property angle\n         * @type {Number}\n         */\n        angle: {\n            get () {\n                return this._eulerAngles.z;\n            },\n            set (value) {\n                Vec3.set(this._eulerAngles, 0, 0, value);   \n                Trs.fromAngleZ(this._trs, value);\n                this.setLocalDirty(LocalDirtyFlag.ALL_ROTATION);\n\n                if (this._eventMask & ROTATION_ON) {\n                    this.emit(EventType.ROTATION_CHANGED);\n                }\n            }\n        },\n\n        /**\n         * !#en The rotation as Euler angles in degrees, used in 3D node.\n         * !#zh 该节点的欧拉角度，用于 3D 节点。\n         * @property eulerAngles\n         * @type {Vec3}\n         * @example\n         * node.is3DNode = true;\n         * node.eulerAngles = cc.v3(45, 45, 45);\n         * cc.log(\"Node eulerAngles (X, Y, Z): \" + node.eulerAngles.toString());\n         */\n\n        /**\n         * !#en Rotation on x axis.\n         * !#zh 该节点 X 轴旋转角度。\n         * @property rotationX\n         * @type {Number}\n         * @deprecated since v2.1\n         * @example\n         * node.is3DNode = true;\n         * node.eulerAngles = cc.v3(45, 0, 0);\n         * cc.log(\"Node eulerAngles X: \" + node.eulerAngles.x);\n         */\n        rotationX: {\n            get () {\n                if (CC_DEBUG) {\n                    cc.warn(\"`cc.Node.rotationX` is deprecated since v2.1.0, please use `eulerAngles.x` instead. (`this.node.rotationX` -> `this.node.eulerAngles.x`)\");\n                }\n                return this._eulerAngles.x;\n            },\n            set (value) {\n                if (CC_DEBUG) {\n                    cc.warn(\"`cc.Node.rotationX` is deprecated since v2.1.0, please set `eulerAngles` instead. (`this.node.rotationX = x` -> `this.node.is3DNode = true; this.node.eulerAngles = cc.v3(x, 0, 0)`\");\n                }\n                if (this._eulerAngles.x !== value) {\n                    this._eulerAngles.x = value;\n                    // Update quaternion from rotation\n                    if (this._eulerAngles.x === this._eulerAngles.y) {\n                        Trs.fromAngleZ(this._trs, -value);\n                    }\n                    else {\n                        Trs.fromEulerNumber(this._trs, value, this._eulerAngles.y, 0);\n                    }\n                    this.setLocalDirty(LocalDirtyFlag.ALL_ROTATION);\n\n                    if (this._eventMask & ROTATION_ON) {\n                        this.emit(EventType.ROTATION_CHANGED);\n                    }\n                }\n            },\n        },\n\n        /**\n         * !#en Rotation on y axis.\n         * !#zh 该节点 Y 轴旋转角度。\n         * @property rotationY\n         * @type {Number}\n         * @deprecated since v2.1\n         * @example\n         * node.is3DNode = true;\n         * node.eulerAngles = cc.v3(0, 45, 0);\n         * cc.log(\"Node eulerAngles Y: \" + node.eulerAngles.y);\n         */\n        rotationY: {\n            get () {\n                if (CC_DEBUG) {\n                    cc.warn(\"`cc.Node.rotationY` is deprecated since v2.1.0, please use `eulerAngles.y` instead. (`this.node.rotationY` -> `this.node.eulerAngles.y`)\");\n                }\n                return this._eulerAngles.y;\n            },\n            set (value) {\n                if (CC_DEBUG) {\n                    cc.warn(\"`cc.Node.rotationY` is deprecated since v2.1.0, please set `eulerAngles` instead. (`this.node.rotationY = y` -> `this.node.is3DNode = true; this.node.eulerAngles = cc.v3(0, y, 0)`\");\n                }\n                if (this._eulerAngles.y !== value) {\n                    this._eulerAngles.y = value;\n                    // Update quaternion from rotation\n                    if (this._eulerAngles.x === this._eulerAngles.y) {\n                        Trs.fromAngleZ(this._trs, -value);\n                    }\n                    else {\n                        Trs.fromEulerNumber(this._trs, this._eulerAngles.x, value, 0);\n                    }\n                    this.setLocalDirty(LocalDirtyFlag.ALL_ROTATION);\n\n                    if (this._eventMask & ROTATION_ON) {\n                        this.emit(EventType.ROTATION_CHANGED);\n                    }\n                }\n            },\n        },\n\n        eulerAngles: {\n            get () {\n                if (CC_EDITOR) {\n                    return this._eulerAngles;\n                }\n                else {\n                    return Trs.toEuler(this._eulerAngles, this._trs);\n                }\n            }, set (v) {\n                if (CC_EDITOR) {\n                    this._eulerAngles.set(v);\n                }\n            \n                Trs.fromEuler(this._trs, v);\n                this.setLocalDirty(LocalDirtyFlag.ALL_ROTATION);\n                !CC_NATIVERENDERER && (this._renderFlag |= RenderFlow.FLAG_TRANSFORM);\n            }\n        },\n        \n        // This property is used for Mesh Skeleton Animation\n        // Should be removed when node.rotation upgrade to quaternion value\n        quat: {\n            get () {\n                let trs = this._trs;\n                return new Quat(trs[3], trs[4], trs[5], trs[6]);\n            }, set (v) {\n                this.setRotation(v);\n            }\n        },\n\n        /**\n         * !#en The local scale relative to the parent.\n         * !#zh 节点相对父节点的缩放。\n         * @property scale\n         * @type {Number}\n         * @example\n         * node.scale = 1;\n         */\n        scale: {\n            get () {\n                return this._trs[7];\n            },\n            set (v) {\n                this.setScale(v);\n            }\n        },\n\n        /**\n         * !#en Scale on x axis.\n         * !#zh 节点 X 轴缩放。\n         * @property scaleX\n         * @type {Number}\n         * @example\n         * node.scaleX = 0.5;\n         * cc.log(\"Node Scale X: \" + node.scaleX);\n         */\n        scaleX: {\n            get () {\n                return this._trs[7];\n            },\n            set (value) {\n                if (this._trs[7] !== value) {\n                    this._trs[7] = value;\n                    this.setLocalDirty(LocalDirtyFlag.ALL_SCALE);\n\n                    if (this._eventMask & SCALE_ON) {\n                        this.emit(EventType.SCALE_CHANGED);\n                    }\n                }\n            },\n        },\n\n        /**\n         * !#en Scale on y axis.\n         * !#zh 节点 Y 轴缩放。\n         * @property scaleY\n         * @type {Number}\n         * @example\n         * node.scaleY = 0.5;\n         * cc.log(\"Node Scale Y: \" + node.scaleY);\n         */\n        scaleY: {\n            get () {\n                return this._trs[8];\n            },\n            set (value) {\n                if (this._trs[8] !== value) {\n                    this._trs[8] = value;\n                    this.setLocalDirty(LocalDirtyFlag.ALL_SCALE);\n\n                    if (this._eventMask & SCALE_ON) {\n                        this.emit(EventType.SCALE_CHANGED);\n                    }\n                }\n            },\n        },\n\n        /**\n         * !#en Scale on z axis.\n         * !#zh 节点 Z 轴缩放。\n         * @property scaleZ\n         * @type {Number}\n         */\n        scaleZ: {\n            get () {\n                return this._trs[9];\n            }, \n            set (value) {\n                if (this._trs[9] !== value) {\n                    this._trs[9] = value;\n                    this.setLocalDirty(LocalDirtyFlag.ALL_SCALE);\n                    !CC_NATIVERENDERER && (this._renderFlag |= RenderFlow.FLAG_TRANSFORM);\n            \n                    if (this._eventMask & SCALE_ON) {\n                        this.emit(EventType.SCALE_CHANGED);\n                    }\n                }\n            }\n        },\n\n        /**\n         * !#en Skew x\n         * !#zh 该节点 X 轴倾斜角度。\n         * @property skewX\n         * @type {Number}\n         * @example\n         * node.skewX = 0;\n         * cc.log(\"Node SkewX: \" + node.skewX);\n         * @deprecated since v2.2.1\n         */\n        skewX: {\n            get () {\n                return this._skewX;\n            },\n            set (value) {\n                _skewWarn(value, this);\n\n                this._skewX = value;\n                this.setLocalDirty(LocalDirtyFlag.SKEW);\n                if (CC_JSB && CC_NATIVERENDERER) {\n                    this._proxy.updateSkew();\n                }\n            }\n        },\n\n        /**\n         * !#en Skew y\n         * !#zh 该节点 Y 轴倾斜角度。\n         * @property skewY\n         * @type {Number}\n         * @example\n         * node.skewY = 0;\n         * cc.log(\"Node SkewY: \" + node.skewY);\n         * @deprecated since v2.2.1\n         */\n        skewY: {\n            get () {\n                return this._skewY;\n            },\n            set (value) {\n                _skewWarn(value, this);\n\n                this._skewY = value;\n                this.setLocalDirty(LocalDirtyFlag.SKEW);\n                if (CC_JSB && CC_NATIVERENDERER) {\n                    this._proxy.updateSkew();\n                }\n            }\n        },\n\n        /**\n         * !#en Opacity of node, default value is 255.\n         * !#zh 节点透明度，默认值为 255。\n         * @property opacity\n         * @type {Number}\n         * @example\n         * node.opacity = 255;\n         */\n        opacity: {\n            get () {\n                return this._opacity;\n            },\n            set (value) {\n                value = cc.misc.clampf(value, 0, 255);\n                if (this._opacity !== value) {\n                    this._opacity = value;\n                    if (CC_JSB && CC_NATIVERENDERER) {\n                        this._proxy.updateOpacity();\n                    };\n                    this._renderFlag |= RenderFlow.FLAG_OPACITY_COLOR;\n                }\n            },\n            range: [0, 255]\n        },\n\n        /**\n         * !#en Color of node, default value is white: (255, 255, 255).\n         * !#zh 节点颜色。默认为白色，数值为：（255，255，255）。\n         * @property color\n         * @type {Color}\n         * @example\n         * node.color = new cc.Color(255, 255, 255);\n         */\n        color: {\n            get () {\n                return this._color.clone()\n            },\n            set (value) {\n                if (!this._color.equals(value)) {\n                    this._color.set(value);\n                    if (CC_DEV && value.a !== 255) {\n                        cc.warnID(1626);\n                    }\n\n                    this._renderFlag |= RenderFlow.FLAG_COLOR;\n\n                    if (this._eventMask & COLOR_ON) {\n                        this.emit(EventType.COLOR_CHANGED, value);\n                    }\n                }\n            },\n        },\n\n        /**\n         * !#en Anchor point's position on x axis.\n         * !#zh 节点 X 轴锚点位置。\n         * @property anchorX\n         * @type {Number}\n         * @example\n         * node.anchorX = 0;\n         */\n        anchorX: {\n            get () {\n                return this._anchorPoint.x;\n            },\n            set (value) {\n                var anchorPoint = this._anchorPoint;\n                if (anchorPoint.x !== value) {\n                    anchorPoint.x = value;\n                    if (this._eventMask & ANCHOR_ON) {\n                        this.emit(EventType.ANCHOR_CHANGED);\n                    }\n                }\n            },\n        },\n\n        /**\n         * !#en Anchor point's position on y axis.\n         * !#zh 节点 Y 轴锚点位置。\n         * @property anchorY\n         * @type {Number}\n         * @example\n         * node.anchorY = 0;\n         */\n        anchorY: {\n            get () {\n                return this._anchorPoint.y;\n            },\n            set (value) {\n                var anchorPoint = this._anchorPoint;\n                if (anchorPoint.y !== value) {\n                    anchorPoint.y = value;\n                    if (this._eventMask & ANCHOR_ON) {\n                        this.emit(EventType.ANCHOR_CHANGED);\n                    }\n                }\n            },\n        },\n\n        /**\n         * !#en Width of node.\n         * !#zh 节点宽度。\n         * @property width\n         * @type {Number}\n         * @example\n         * node.width = 100;\n         */\n        width: {\n            get () {\n                return this._contentSize.width;\n            },\n            set (value) {\n                if (value !== this._contentSize.width) {\n                    if (CC_EDITOR) {\n                        var clone = cc.size(this._contentSize.width, this._contentSize.height);\n                    }\n                    this._contentSize.width = value;\n                    if (this._eventMask & SIZE_ON) {\n                        if (CC_EDITOR) {\n                            this.emit(EventType.SIZE_CHANGED, clone);\n                        }\n                        else {\n                            this.emit(EventType.SIZE_CHANGED);\n                        }\n                    }\n                }\n            },\n        },\n\n        /**\n         * !#en Height of node.\n         * !#zh 节点高度。\n         * @property height\n         * @type {Number}\n         * @example\n         * node.height = 100;\n         */\n        height: {\n            get () {\n                return this._contentSize.height;\n            },\n            set (value) {\n                if (value !== this._contentSize.height) {\n                    if (CC_EDITOR) {\n                        var clone = cc.size(this._contentSize.width, this._contentSize.height);\n                    }\n                    this._contentSize.height = value;\n                    if (this._eventMask & SIZE_ON) {\n                        if (CC_EDITOR) {\n                            this.emit(EventType.SIZE_CHANGED, clone);\n                        }\n                        else {\n                            this.emit(EventType.SIZE_CHANGED);\n                        }\n                    }\n                }\n            },\n        },\n\n        /**\n         * !#en zIndex is the 'key' used to sort the node relative to its siblings.<br/>\n         * The value of zIndex should be in the range between cc.macro.MIN_ZINDEX and cc.macro.MAX_ZINDEX.<br/>\n         * The Node's parent will sort all its children based on the zIndex value and the arrival order.<br/>\n         * Nodes with greater zIndex will be sorted after nodes with smaller zIndex.<br/>\n         * If two nodes have the same zIndex, then the node that was added first to the children's array will be in front of the other node in the array.<br/>\n         * Node's order in children list will affect its rendering order. Parent is always rendering before all children.\n         * !#zh zIndex 是用来对节点进行排序的关键属性，它决定一个节点在兄弟节点之间的位置。<br/>\n         * zIndex 的取值应该介于 cc.macro.MIN_ZINDEX 和 cc.macro.MAX_ZINDEX 之间\n         * 父节点主要根据节点的 zIndex 和添加次序来排序，拥有更高 zIndex 的节点将被排在后面，如果两个节点的 zIndex 一致，先添加的节点会稳定排在另一个节点之前。<br/>\n         * 节点在 children 中的顺序决定了其渲染顺序。父节点永远在所有子节点之前被渲染\n         * @property zIndex\n         * @type {Number}\n         * @example\n         * node.zIndex = 1;\n         * cc.log(\"Node zIndex: \" + node.zIndex);\n         */\n        zIndex: {\n            get () {\n                return this._localZOrder >> 16;\n            },\n            set (value) {\n                if (value > macro.MAX_ZINDEX) {\n                    cc.warnID(1636);\n                    value = macro.MAX_ZINDEX;\n                }\n                else if (value < macro.MIN_ZINDEX) {\n                    cc.warnID(1637);\n                    value = macro.MIN_ZINDEX;\n                }\n\n                if (this.zIndex !== value) {\n                    this._localZOrder = (this._localZOrder & 0x0000ffff) | (value << 16);\n                    this.emit(EventType.SIBLING_ORDER_CHANGED);\n\n                    this._onSiblingIndexChanged();\n                }\n            }\n        },\n\n        /**\n         * !#en\n         * Switch 2D/3D node. The 2D nodes will run faster.\n         * !#zh\n         * 切换 2D/3D 节点，2D 节点会有更高的运行效率\n         * @property {Boolean} is3DNode\n         * @default false\n        */\n        is3DNode: {\n            get () {\n                return this._is3DNode;\n            }, set (v) {\n                this._is3DNode = v;\n                this._update3DFunction();\n            }\n        },\n    },\n\n    /**\n     * @method constructor\n     * @param {String} [name]\n     */\n    ctor () {\n        this._reorderChildDirty = false;\n\n        // cache component\n        this._widget = null;\n        // fast render component access\n        this._renderComponent = null;\n        // Event listeners\n        this._capturingListeners = null;\n        this._bubblingListeners = null;\n        // Touch event listener\n        this._touchListener = null;\n        // Mouse event listener\n        this._mouseListener = null;\n\n        this._initDataFromPool();\n\n        this._eventMask = 0;\n        this._cullingMask = 1;\n        this._childArrivalOrder = 1;\n\n        // Proxy\n        if (CC_JSB && CC_NATIVERENDERER) {\n            this._proxy = new renderer.NodeProxy(this._spaceInfo.unitID, this._spaceInfo.index, this._id, this._name);\n            this._proxy.init(this);\n        }\n        // should reset _renderFlag for both web and native\n        this._renderFlag = RenderFlow.FLAG_TRANSFORM | RenderFlow.FLAG_OPACITY_COLOR;\n    },\n\n    statics: {\n        EventType,\n        _LocalDirtyFlag: LocalDirtyFlag,\n        // is node but not scene\n        isNode (obj) {\n            return obj instanceof Node && (obj.constructor === Node || !(obj instanceof cc.Scene));\n        },\n        BuiltinGroupIndex\n    },\n\n    // OVERRIDES\n\n    _onSiblingIndexChanged () {\n        // update rendering scene graph, sort them by arrivalOrder\n        if (this._parent) {\n            this._parent._delaySort();\n        }\n    },\n\n    _onPreDestroy () {\n        var destroyByParent = this._onPreDestroyBase();\n\n        // Actions\n        if (ActionManagerExist) {\n            cc.director.getActionManager().removeAllActionsFromTarget(this);\n        }\n\n        // Remove Node.currentHovered\n        if (_currentHovered === this) {\n            _currentHovered = null;\n        }\n\n        // Remove all event listeners if necessary\n        if (this._touchListener || this._mouseListener) {\n            eventManager.removeListeners(this);\n            if (this._touchListener) {\n                this._touchListener.owner = null;\n                this._touchListener.mask = null;\n                this._touchListener = null;\n            }\n            if (this._mouseListener) {\n                this._mouseListener.owner = null;\n                this._mouseListener.mask = null;\n                this._mouseListener = null;\n            }\n        }\n\n        if (CC_JSB && CC_NATIVERENDERER) {\n            this._proxy.destroy();\n            this._proxy = null;\n        }\n\n        this._backDataIntoPool();\n\n        if (this._reorderChildDirty) {\n            cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE, this.sortAllChildren, this);\n        }\n\n        if (!destroyByParent) {\n            // simulate some destruct logic to make undo system work correctly\n            if (CC_EDITOR) {\n                // ensure this node can reattach to scene by undo system\n                this._parent = null;\n            }\n        }\n    },\n\n    _onPostActivated (active) {\n        var actionManager = ActionManagerExist ? cc.director.getActionManager() : null;\n        if (active) {\n            // Refresh transform\n            this._renderFlag |= RenderFlow.FLAG_WORLD_TRANSFORM;\n            // ActionManager & EventManager\n            actionManager && actionManager.resumeTarget(this);\n            eventManager.resumeTarget(this);\n            // Search Mask in parent\n            this._checkListenerMask();\n        } else {\n            // deactivate\n            actionManager && actionManager.pauseTarget(this);\n            eventManager.pauseTarget(this);\n        }\n    },\n\n    _onHierarchyChanged (oldParent) {\n        this._updateOrderOfArrival();\n        // Fixed a bug where children and parent node groups were forced to synchronize, instead of only synchronizing `_cullingMask` value\n        _updateCullingMask(this);\n        if (this._parent) {\n            this._parent._delaySort();\n        }\n        this._renderFlag |= RenderFlow.FLAG_WORLD_TRANSFORM;\n        this._onHierarchyChangedBase(oldParent);\n        if (cc._widgetManager) {\n            cc._widgetManager._nodesOrderDirty = true;\n        }\n\n        if (oldParent && this._activeInHierarchy) {\n            //TODO: It may be necessary to update the listener mask of all child nodes.\n            this._checkListenerMask();\n        }\n        \n        // Node proxy\n        if (CC_JSB && CC_NATIVERENDERER) {\n            this._proxy.updateParent();\n        }\n    },\n\n    // INTERNAL\n\n    _update3DFunction () {\n        if (this._is3DNode) {\n            this._updateLocalMatrix = updateLocalMatrix3D;\n            this._calculWorldMatrix = calculWorldMatrix3D;\n            this._mulMat = mulMat3D;\n        }\n        else {\n            this._updateLocalMatrix = updateLocalMatrix2D;\n            this._calculWorldMatrix = calculWorldMatrix2D;\n            this._mulMat = mulMat2D;\n        }\n        if (this._renderComponent && this._renderComponent._on3DNodeChanged) {\n            this._renderComponent._on3DNodeChanged();\n        }\n        this._renderFlag |= RenderFlow.FLAG_TRANSFORM;\n        this._localMatDirty = LocalDirtyFlag.ALL;\n\n        if (CC_JSB && CC_NATIVERENDERER) {\n            this._proxy.update3DNode();\n        }\n    },\n\n    _initDataFromPool () {\n        if (!this._spaceInfo) {\n            if (CC_EDITOR || CC_TEST) {\n                this._spaceInfo = {\n                    trs: new Float64Array(10),\n                    localMat: new Float64Array(16),\n                    worldMat: new Float64Array(16),\n                }\n            } else {\n                this._spaceInfo = nodeMemPool.pop();            \n            }\n        }\n\n        let spaceInfo = this._spaceInfo;\n        this._matrix = cc.mat4(spaceInfo.localMat);\n        Mat4.identity(this._matrix);\n        this._worldMatrix = cc.mat4(spaceInfo.worldMat);\n        Mat4.identity(this._worldMatrix);\n        this._localMatDirty = LocalDirtyFlag.ALL;\n        this._worldMatDirty = true;\n\n        let trs = this._trs = this._spaceInfo.trs;\n        trs[0] = 0; // position.x\n        trs[1] = 0; // position.y\n        trs[2] = 0; // position.z\n        trs[3] = 0; // rotation.x\n        trs[4] = 0; // rotation.y\n        trs[5] = 0; // rotation.z\n        trs[6] = 1; // rotation.w\n        trs[7] = 1; // scale.x\n        trs[8] = 1; // scale.y\n        trs[9] = 1; // scale.z\n    },\n\n    _backDataIntoPool () {\n        if (!(CC_EDITOR || CC_TEST)) {\n            // push back to pool\n            nodeMemPool.push(this._spaceInfo);\n            this._matrix = null;\n            this._worldMatrix = null;\n            this._trs = null;\n            this._spaceInfo = null;\n        }\n    },\n\n    _toEuler () {\n        if (this.is3DNode) {\n            Trs.toEuler(this._eulerAngles, this._trs);\n        }\n        else {\n            let z = Math.asin(this._trs[5]) / ONE_DEGREE * 2;\n            Vec3.set(this._eulerAngles, 0, 0, z);\n        }\n    },\n\n    _fromEuler () {\n        if (this.is3DNode) {\n            Trs.fromEuler(this._trs, this._eulerAngles);\n        }\n        else {\n            Trs.fromAngleZ(this._trs, this._eulerAngles.z);\n        }\n    },\n\n    _upgrade_1x_to_2x () {\n        if (this._is3DNode) {\n            this._update3DFunction();\n        }\n\n        let trs = this._trs;\n        if (trs) {\n            let desTrs = trs;\n            trs = this._trs = this._spaceInfo.trs;\n            // just adapt to old trs\n            if (desTrs.length === 11) {\n                trs.set(desTrs.subarray(1));\n            } else {\n                trs.set(desTrs);\n            }\n        } else {\n            trs = this._trs = this._spaceInfo.trs;\n        }\n\n        if (this._zIndex !== undefined) {\n            this._localZOrder = this._zIndex << 16;\n            this._zIndex = undefined;\n        }\n\n        if (CC_EDITOR) {\n            if (this._skewX !== 0 || this._skewY !== 0) {\n                var NodeUtils = Editor.require('scene://utils/node');\n                cc.warn(\"`cc.Node.skewX/Y` is deprecated since v2.2.1, please use 3D node instead.\", `Node: ${NodeUtils.getNodePath(this)}.`);\n            }\n        }\n\n        this._fromEuler();\n\n        if (this._localZOrder !== 0) {\n            this._zIndex = (this._localZOrder & 0xffff0000) >> 16;\n        }\n\n        // Upgrade from 2.0.0 preview 4 & earlier versions\n        // TODO: Remove after final version\n        if (this._color.a < 255 && this._opacity === 255) {\n            this._opacity = this._color.a;\n            this._color.a = 255;\n        }\n\n        if (CC_JSB && CC_NATIVERENDERER) {\n            this._renderFlag |= RenderFlow.FLAG_TRANSFORM | RenderFlow.FLAG_OPACITY_COLOR;\n        }\n    },\n\n    /*\n     * The initializer for Node which will be called before all components onLoad\n     */\n    _onBatchCreated () {\n        let prefabInfo = this._prefab;\n        if (prefabInfo && prefabInfo.sync && prefabInfo.root === this) {\n            if (CC_DEV) {\n                // TODO - remove all usage of _synced\n                cc.assert(!prefabInfo._synced, 'prefab should not synced');\n            }\n            PrefabHelper.syncWithPrefab(this);\n        }\n\n        this._upgrade_1x_to_2x();\n\n        this._updateOrderOfArrival();\n\n        // Fixed a bug where children and parent node groups were forced to synchronize, instead of only synchronizing `_cullingMask` value\n        this._cullingMask = 1 << _getActualGroupIndex(this);\n        if (CC_JSB && CC_NATIVERENDERER) {\n            this._proxy && this._proxy.updateCullingMask();\n        };\n\n        if (!this._activeInHierarchy) {\n            // deactivate ActionManager and EventManager by default\n            if (ActionManagerExist) {\n                cc.director.getActionManager().pauseTarget(this);\n            }\n            eventManager.pauseTarget(this);\n        }\n\n        let children = this._children;\n        for (let i = 0, len = children.length; i < len; i++) {\n            children[i]._onBatchCreated();\n        }\n\n        if (children.length > 0) {\n            this._renderFlag |= RenderFlow.FLAG_CHILDREN;\n        }\n\n        if (CC_JSB && CC_NATIVERENDERER) {\n            this._proxy.initNative();\n        }\n    },\n\n    // the same as _onBatchCreated but untouch prefab\n    _onBatchRestored () {\n        this._upgrade_1x_to_2x();\n\n        // Fixed a bug where children and parent node groups were forced to synchronize, instead of only synchronizing `_cullingMask` value\n        this._cullingMask = 1 << _getActualGroupIndex(this);\n        if (CC_JSB && CC_NATIVERENDERER) {\n            this._proxy && this._proxy.updateCullingMask();\n        };\n\n        if (!this._activeInHierarchy) {\n            // deactivate ActionManager and EventManager by default\n\n            // ActionManager may not be inited in the editor worker.\n            let manager = cc.director.getActionManager();\n            manager && manager.pauseTarget(this);\n\n            eventManager.pauseTarget(this);\n        }\n\n        var children = this._children;\n        for (var i = 0, len = children.length; i < len; i++) {\n            children[i]._onBatchRestored();\n        }\n\n        if (children.length > 0) {\n            this._renderFlag |= RenderFlow.FLAG_CHILDREN;\n        }\n\n        if (CC_JSB && CC_NATIVERENDERER) {\n            this._proxy.initNative();\n        }\n    },\n\n    // EVENT TARGET\n    _checkListenerMask () {\n        // Because Mask may be nested, need to find all the Mask components in the parent node. \n        // The click area must satisfy all Masks to trigger the click.\n        if (this._touchListener) {\n            var mask = this._touchListener.mask = _searchComponentsInParent(this, cc.Mask);\n            if (this._mouseListener) {\n                this._mouseListener.mask = mask;\n            }\n        } else if (this._mouseListener) {\n            this._mouseListener.mask = _searchComponentsInParent(this, cc.Mask);\n        }\n    },\n\n    _checknSetupSysEvent (type) {\n        let newAdded = false;\n        let forDispatch = false;\n        if (_touchEvents.indexOf(type) !== -1) {\n            if (!this._touchListener) {\n                this._touchListener = cc.EventListener.create({\n                    event: cc.EventListener.TOUCH_ONE_BY_ONE,\n                    swallowTouches: true,\n                    owner: this,\n                    mask: _searchComponentsInParent(this, cc.Mask),\n                    onTouchBegan: _touchStartHandler,\n                    onTouchMoved: _touchMoveHandler,\n                    onTouchEnded: _touchEndHandler,\n                    onTouchCancelled: _touchCancelHandler\n                });\n                eventManager.addListener(this._touchListener, this);\n                newAdded = true;\n            }\n            forDispatch = true;\n        }\n        else if (_mouseEvents.indexOf(type) !== -1) {\n            if (!this._mouseListener) {\n                this._mouseListener = cc.EventListener.create({\n                    event: cc.EventListener.MOUSE,\n                    _previousIn: false,\n                    owner: this,\n                    mask: _searchComponentsInParent(this, cc.Mask),\n                    onMouseDown: _mouseDownHandler,\n                    onMouseMove: _mouseMoveHandler,\n                    onMouseUp: _mouseUpHandler,\n                    onMouseScroll: _mouseWheelHandler,\n                });\n                eventManager.addListener(this._mouseListener, this);\n                newAdded = true;\n            }\n            forDispatch = true;\n        }\n        if (newAdded && !this._activeInHierarchy) {\n            cc.director.getScheduler().schedule(function () {\n                if (!this._activeInHierarchy) {\n                    eventManager.pauseTarget(this);\n                }\n            }, this, 0, 0, 0, false);\n        }\n        return forDispatch;\n    },\n\n    /**\n     * !#en\n     * Register a callback of a specific event type on Node.<br/>\n     * Use this method to register touch or mouse event permit propagation based on scene graph,<br/>\n     * These kinds of event are triggered with dispatchEvent, the dispatch process has three steps:<br/>\n     * 1. Capturing phase: dispatch in capture targets (`_getCapturingTargets`), e.g. parents in node tree, from root to the real target<br/>\n     * 2. At target phase: dispatch to the listeners of the real target<br/>\n     * 3. Bubbling phase: dispatch in bubble targets (`_getBubblingTargets`), e.g. parents in node tree, from the real target to root<br/>\n     * In any moment of the dispatching process, it can be stopped via `event.stopPropagation()` or `event.stopPropagationImmidiate()`.<br/>\n     * It's the recommended way to register touch/mouse event for Node,<br/>\n     * please do not use cc.eventManager directly for Node.<br/>\n     * You can also register custom event and use `emit` to trigger custom event on Node.<br/>\n     * For such events, there won't be capturing and bubbling phase, your event will be dispatched directly to its listeners registered on the same node.<br/>\n     * You can also pass event callback parameters with `emit` by passing parameters after `type`.\n     * !#zh\n     * 在节点上注册指定类型的回调函数，也可以设置 target 用于绑定响应函数的 this 对象。<br/>\n     * 鼠标或触摸事件会被系统调用 dispatchEvent 方法触发，触发的过程包含三个阶段：<br/>\n     * 1. 捕获阶段：派发事件给捕获目标（通过 `_getCapturingTargets` 获取），比如，节点树中注册了捕获阶段的父节点，从根节点开始派发直到目标节点。<br/>\n     * 2. 目标阶段：派发给目标节点的监听器。<br/>\n     * 3. 冒泡阶段：派发事件给冒泡目标（通过 `_getBubblingTargets` 获取），比如，节点树中注册了冒泡阶段的父节点，从目标节点开始派发直到根节点。<br/>\n     * 同时您可以将事件派发到父节点或者通过调用 stopPropagation 拦截它。<br/>\n     * 推荐使用这种方式来监听节点上的触摸或鼠标事件，请不要在节点上直接使用 cc.eventManager。<br/>\n     * 你也可以注册自定义事件到节点上，并通过 emit 方法触发此类事件，对于这类事件，不会发生捕获冒泡阶段，只会直接派发给注册在该节点上的监听器<br/>\n     * 你可以通过在 emit 方法调用时在 type 之后传递额外的参数作为事件回调的参数列表\n     * @method on\n     * @param {String|Node.EventType} type - A string representing the event type to listen for.<br>See {{#crossLink \"Node/EventTyupe/POSITION_CHANGED\"}}Node Events{{/crossLink}} for all builtin events.\n     * @param {Function} callback - The callback that will be invoked when the event is dispatched. The callback is ignored if it is a duplicate (the callbacks are unique).\n     * @param {Event|any} [callback.event] event or first argument when emit\n     * @param {any} [callback.arg2] arg2\n     * @param {any} [callback.arg3] arg3\n     * @param {any} [callback.arg4] arg4\n     * @param {any} [callback.arg5] arg5\n     * @param {Object} [target] - The target (this object) to invoke the callback, can be null\n     * @param {Boolean} [useCapture=false] - When set to true, the listener will be triggered at capturing phase which is ahead of the final target emit, otherwise it will be triggered during bubbling phase.\n     * @return {Function} - Just returns the incoming callback so you can save the anonymous function easier.\n     * @typescript\n     * on<T extends Function>(type: string, callback: T, target?: any, useCapture?: boolean): T\n     * @example\n     * this.node.on(cc.Node.EventType.TOUCH_START, this.memberFunction, this);  // if \"this\" is component and the \"memberFunction\" declared in CCClass.\n     * node.on(cc.Node.EventType.TOUCH_START, callback, this);\n     * node.on(cc.Node.EventType.TOUCH_MOVE, callback, this);\n     * node.on(cc.Node.EventType.TOUCH_END, callback, this);\n     * node.on(cc.Node.EventType.TOUCH_CANCEL, callback, this);\n     * node.on(cc.Node.EventType.ANCHOR_CHANGED, callback);\n     * node.on(cc.Node.EventType.COLOR_CHANGED, callback);\n     */\n    on (type, callback, target, useCapture) {\n        let forDispatch = this._checknSetupSysEvent(type);\n        if (forDispatch) {\n            return this._onDispatch(type, callback, target, useCapture);\n        }\n        else {\n            switch (type) {\n                case EventType.POSITION_CHANGED:\n                this._eventMask |= POSITION_ON;\n                break;\n                case EventType.SCALE_CHANGED:\n                this._eventMask |= SCALE_ON;\n                break;\n                case EventType.ROTATION_CHANGED:\n                this._eventMask |= ROTATION_ON;\n                break;\n                case EventType.SIZE_CHANGED:\n                this._eventMask |= SIZE_ON;\n                break;\n                case EventType.ANCHOR_CHANGED:\n                this._eventMask |= ANCHOR_ON;\n                break;\n                case EventType.COLOR_CHANGED:\n                this._eventMask |= COLOR_ON;\n                break;\n            }\n            if (!this._bubblingListeners) {\n                this._bubblingListeners = new EventTarget();\n            }\n            return this._bubblingListeners.on(type, callback, target);\n        }\n    },\n\n    /**\n     * !#en\n     * Register an callback of a specific event type on the Node,\n     * the callback will remove itself after the first time it is triggered.\n     * !#zh\n     * 注册节点的特定事件类型回调，回调会在第一时间被触发后删除自身。\n     *\n     * @method once\n     * @param {String} type - A string representing the event type to listen for.\n     * @param {Function} callback - The callback that will be invoked when the event is dispatched.\n     *                              The callback is ignored if it is a duplicate (the callbacks are unique).\n     * @param {Event|any} [callback.event] event or first argument when emit\n     * @param {any} [callback.arg2] arg2\n     * @param {any} [callback.arg3] arg3\n     * @param {any} [callback.arg4] arg4\n     * @param {any} [callback.arg5] arg5\n     * @param {Object} [target] - The target (this object) to invoke the callback, can be null\n     * @typescript\n     * once<T extends Function>(type: string, callback: T, target?: any, useCapture?: boolean): T\n     * @example\n     * node.once(cc.Node.EventType.ANCHOR_CHANGED, callback);\n     */\n    once (type, callback, target, useCapture) {\n        let forDispatch = this._checknSetupSysEvent(type);\n\n        let listeners = null;\n        if (forDispatch && useCapture) {\n            listeners = this._capturingListeners = this._capturingListeners || new EventTarget();\n        }\n        else {\n            listeners = this._bubblingListeners = this._bubblingListeners || new EventTarget();\n        }\n\n        listeners.once(type, callback, target);\n    },\n\n    _onDispatch (type, callback, target, useCapture) {\n        // Accept also patameters like: (type, callback, useCapture)\n        if (typeof target === 'boolean') {\n            useCapture = target;\n            target = undefined;\n        }\n        else useCapture = !!useCapture;\n        if (!callback) {\n            cc.errorID(6800);\n            return;\n        }\n\n        var listeners = null;\n        if (useCapture) {\n            listeners = this._capturingListeners = this._capturingListeners || new EventTarget();\n        }\n        else {\n            listeners = this._bubblingListeners = this._bubblingListeners || new EventTarget();\n        }\n\n        if ( !listeners.hasEventListener(type, callback, target) ) {\n            listeners.on(type, callback, target);\n\n            if (target && target.__eventTargets) {\n                target.__eventTargets.push(this);\n            }\n        }\n\n        return callback;\n    },\n\n    /**\n     * !#en\n     * Removes the callback previously registered with the same type, callback, target and or useCapture.\n     * This method is merely an alias to removeEventListener.\n     * !#zh 删除之前与同类型，回调，目标或 useCapture 注册的回调。\n     * @method off\n     * @param {String} type - A string representing the event type being removed.\n     * @param {Function} [callback] - The callback to remove.\n     * @param {Object} [target] - The target (this object) to invoke the callback, if it's not given, only callback without target will be removed\n     * @param {Boolean} [useCapture=false] - When set to true, the listener will be triggered at capturing phase which is ahead of the final target emit, otherwise it will be triggered during bubbling phase.\n     * @example\n     * this.node.off(cc.Node.EventType.TOUCH_START, this.memberFunction, this);\n     * node.off(cc.Node.EventType.TOUCH_START, callback, this.node);\n     * node.off(cc.Node.EventType.ANCHOR_CHANGED, callback, this);\n     */\n    off (type, callback, target, useCapture) {\n        let touchEvent = _touchEvents.indexOf(type) !== -1;\n        let mouseEvent = !touchEvent && _mouseEvents.indexOf(type) !== -1;\n        if (touchEvent || mouseEvent) {\n            this._offDispatch(type, callback, target, useCapture);\n\n            if (touchEvent) {\n                if (this._touchListener && !_checkListeners(this, _touchEvents)) {\n                    eventManager.removeListener(this._touchListener);\n                    this._touchListener = null;\n                }\n            }\n            else if (mouseEvent) {\n                if (this._mouseListener && !_checkListeners(this, _mouseEvents)) {\n                    eventManager.removeListener(this._mouseListener);\n                    this._mouseListener = null;\n                }\n            }\n        }\n        else if (this._bubblingListeners) {\n            this._bubblingListeners.off(type, callback, target);\n\n            var hasListeners = this._bubblingListeners.hasEventListener(type);\n            // All listener removed\n            if (!hasListeners) {\n                switch (type) {\n                    case EventType.POSITION_CHANGED:\n                    this._eventMask &= ~POSITION_ON;\n                    break;\n                    case EventType.SCALE_CHANGED:\n                    this._eventMask &= ~SCALE_ON;\n                    break;\n                    case EventType.ROTATION_CHANGED:\n                    this._eventMask &= ~ROTATION_ON;\n                    break;\n                    case EventType.SIZE_CHANGED:\n                    this._eventMask &= ~SIZE_ON;\n                    break;\n                    case EventType.ANCHOR_CHANGED:\n                    this._eventMask &= ~ANCHOR_ON;\n                    break;\n                    case EventType.COLOR_CHANGED:\n                    this._eventMask &= ~COLOR_ON;\n                    break;\n                }\n            }\n        }\n    },\n\n    _offDispatch (type, callback, target, useCapture) {\n        // Accept also patameters like: (type, callback, useCapture)\n        if (typeof target === 'boolean') {\n            useCapture = target;\n            target = undefined;\n        }\n        else useCapture = !!useCapture;\n        if (!callback) {\n            this._capturingListeners && this._capturingListeners.removeAll(type);\n            this._bubblingListeners && this._bubblingListeners.removeAll(type);\n        }\n        else {\n            var listeners = useCapture ? this._capturingListeners : this._bubblingListeners;\n            if (listeners) {\n                listeners.off(type, callback, target);\n\n                if (target && target.__eventTargets) {\n                    js.array.fastRemove(target.__eventTargets, this);\n                }\n            }\n\n        }\n    },\n\n    /**\n     * !#en Removes all callbacks previously registered with the same target.\n     * !#zh 移除目标上的所有注册事件。\n     * @method targetOff\n     * @param {Object} target - The target to be searched for all related callbacks\n     * @example\n     * node.targetOff(target);\n     */\n    targetOff (target) {\n        let listeners = this._bubblingListeners;\n        if (listeners) {\n            listeners.targetOff(target);\n\n            // Check for event mask reset\n            if ((this._eventMask & POSITION_ON) && !listeners.hasEventListener(EventType.POSITION_CHANGED)) {\n                this._eventMask &= ~POSITION_ON;\n            }\n            if ((this._eventMask & SCALE_ON) && !listeners.hasEventListener(EventType.SCALE_CHANGED)) {\n                this._eventMask &= ~SCALE_ON;\n            }\n            if ((this._eventMask & ROTATION_ON) && !listeners.hasEventListener(EventType.ROTATION_CHANGED)) {\n                this._eventMask &= ~ROTATION_ON;\n            }\n            if ((this._eventMask & SIZE_ON) && !listeners.hasEventListener(EventType.SIZE_CHANGED)) {\n                this._eventMask &= ~SIZE_ON;\n            }\n            if ((this._eventMask & ANCHOR_ON) && !listeners.hasEventListener(EventType.ANCHOR_CHANGED)) {\n                this._eventMask &= ~ANCHOR_ON;\n            }\n            if ((this._eventMask & COLOR_ON) && !listeners.hasEventListener(EventType.COLOR_CHANGED)) {\n                this._eventMask &= ~COLOR_ON;\n            }\n        }\n        if (this._capturingListeners) {\n            this._capturingListeners.targetOff(target);\n        }\n\n        if (target && target.__eventTargets) {\n            js.array.fastRemove(target.__eventTargets, this);\n        }\n\n        if (this._touchListener && !_checkListeners(this, _touchEvents)) {\n            eventManager.removeListener(this._touchListener);\n            this._touchListener = null;\n        }\n        if (this._mouseListener && !_checkListeners(this, _mouseEvents)) {\n            eventManager.removeListener(this._mouseListener);\n            this._mouseListener = null;\n        }\n    },\n\n    /**\n     * !#en Checks whether the EventTarget object has any callback registered for a specific type of event.\n     * !#zh 检查事件目标对象是否有为特定类型的事件注册的回调。\n     * @method hasEventListener\n     * @param {String} type - The type of event.\n     * @return {Boolean} True if a callback of the specified type is registered; false otherwise.\n     */\n    hasEventListener (type) {\n        let has = false;\n        if (this._bubblingListeners) {\n            has = this._bubblingListeners.hasEventListener(type);\n        }\n        if (!has && this._capturingListeners) {\n            has = this._capturingListeners.hasEventListener(type);\n        }\n        return has;\n    },\n\n    /**\n     * !#en\n     * Trigger an event directly with the event name and necessary arguments.\n     * !#zh\n     * 通过事件名发送自定义事件\n     *\n     * @method emit\n     * @param {String} type - event type\n     * @param {*} [arg1] - First argument in callback\n     * @param {*} [arg2] - Second argument in callback\n     * @param {*} [arg3] - Third argument in callback\n     * @param {*} [arg4] - Fourth argument in callback\n     * @param {*} [arg5] - Fifth argument in callback\n     * @example\n     * \n     * eventTarget.emit('fire', event);\n     * eventTarget.emit('fire', message, emitter);\n     */\n    emit (type, arg1, arg2, arg3, arg4, arg5) {\n        if (this._bubblingListeners) {\n            this._bubblingListeners.emit(type, arg1, arg2, arg3, arg4, arg5);\n        }\n    },\n\n    /**\n     * !#en\n     * Dispatches an event into the event flow.\n     * The event target is the EventTarget object upon which the dispatchEvent() method is called.\n     * !#zh 分发事件到事件流中。\n     *\n     * @method dispatchEvent\n     * @param {Event} event - The Event object that is dispatched into the event flow\n     */\n    dispatchEvent (event) {\n        _doDispatchEvent(this, event);\n        _cachedArray.length = 0;\n    },\n\n    /**\n     * !#en Pause node related system events registered with the current Node. Node system events includes touch and mouse events.\n     * If recursive is set to true, then this API will pause the node system events for the node and all nodes in its sub node tree.\n     * Reference: http://docs.cocos2d-x.org/editors_and_tools/creator-chapters/scripting/internal-events/\n     * !#zh 暂停当前节点上注册的所有节点系统事件，节点系统事件包含触摸和鼠标事件。\n     * 如果传递 recursive 为 true，那么这个 API 将暂停本节点和它的子树上所有节点的节点系统事件。\n     * 参考：https://www.cocos.com/docs/creator/scripting/internal-events.html\n     * @method pauseSystemEvents\n     * @param {Boolean} recursive - Whether to pause node system events on the sub node tree.\n     * @example\n     * node.pauseSystemEvents(true);\n     */\n    pauseSystemEvents (recursive) {\n        eventManager.pauseTarget(this, recursive);\n    },\n\n    /**\n     * !#en Resume node related system events registered with the current Node. Node system events includes touch and mouse events.\n     * If recursive is set to true, then this API will resume the node system events for the node and all nodes in its sub node tree.\n     * Reference: http://docs.cocos2d-x.org/editors_and_tools/creator-chapters/scripting/internal-events/\n     * !#zh 恢复当前节点上注册的所有节点系统事件，节点系统事件包含触摸和鼠标事件。\n     * 如果传递 recursive 为 true，那么这个 API 将恢复本节点和它的子树上所有节点的节点系统事件。\n     * 参考：https://www.cocos.com/docs/creator/scripting/internal-events.html\n     * @method resumeSystemEvents\n     * @param {Boolean} recursive - Whether to resume node system events on the sub node tree.\n     * @example\n     * node.resumeSystemEvents(true);\n     */\n    resumeSystemEvents (recursive) {\n        eventManager.resumeTarget(this, recursive);\n    },\n\n    _hitTest (point, listener) {\n        let w = this._contentSize.width,\n            h = this._contentSize.height,\n            cameraPt = _htVec3a,\n            testPt = _htVec3b;\n        \n        let camera = cc.Camera.findCamera(this);\n        if (camera) {\n            camera.getScreenToWorldPoint(point, cameraPt);\n        }\n        else {\n            cameraPt.set(point);\n        }\n\n        this._updateWorldMatrix();\n        // If scale is 0, it can't be hit.\n        if (!Mat4.invert(_mat4_temp, this._worldMatrix)) {\n            return false;\n        }\n        Vec2.transformMat4(testPt, cameraPt, _mat4_temp);\n        testPt.x += this._anchorPoint.x * w;\n        testPt.y += this._anchorPoint.y * h;\n\n        let hit = false;\n        if (testPt.x >= 0 && testPt.y >= 0 && testPt.x <= w && testPt.y <= h) {\n            hit = true;\n            if (listener && listener.mask) {\n                let mask = listener.mask;\n                let parent = this;\n                let length = mask ? mask.length : 0;\n                // find mask parent, should hit test it\n                for (let i = 0, j = 0; parent && j < length; ++i, parent = parent.parent) {\n                    let temp = mask[j];\n                    if (i === temp.index) {\n                        if (parent === temp.node) {\n                            let comp = parent.getComponent(cc.Mask);\n                            if (comp && comp._enabled && !comp._hitTest(cameraPt)) {\n                                hit = false;\n                                break\n                            } \n\n                            j++;\n                        } else {\n                            // mask parent no longer exists\n                            mask.length = j;\n                            break\n                        }\n                    } else if (i > temp.index) {\n                        // mask parent no longer exists\n                        mask.length = j;\n                        break\n                    }\n                }\n            }\n        } \n\n        return hit;\n    },\n\n    /**\n     * Get all the targets listening to the supplied type of event in the target's capturing phase.\n     * The capturing phase comprises the journey from the root to the last node BEFORE the event target's node.\n     * The result should save in the array parameter, and MUST SORT from child nodes to parent nodes.\n     *\n     * Subclasses can override this method to make event propagable.\n     * @method _getCapturingTargets\n     * @private\n     * @param {String} type - the event type\n     * @param {Array} array - the array to receive targets\n     * @example {@link cocos2d/core/event/_getCapturingTargets.js}\n     */\n    _getCapturingTargets (type, array) {\n        var parent = this.parent;\n        while (parent) {\n            if (parent._capturingListeners && parent._capturingListeners.hasEventListener(type)) {\n                array.push(parent);\n            }\n            parent = parent.parent;\n        }\n    },\n\n    /**\n     * Get all the targets listening to the supplied type of event in the target's bubbling phase.\n     * The bubbling phase comprises any SUBSEQUENT nodes encountered on the return trip to the root of the tree.\n     * The result should save in the array parameter, and MUST SORT from child nodes to parent nodes.\n     *\n     * Subclasses can override this method to make event propagable.\n     * @method _getBubblingTargets\n     * @private\n     * @param {String} type - the event type\n     * @param {Array} array - the array to receive targets\n     */\n    _getBubblingTargets (type, array) {\n        var parent = this.parent;\n        while (parent) {\n            if (parent._bubblingListeners && parent._bubblingListeners.hasEventListener(type)) {\n                array.push(parent);\n            }\n            parent = parent.parent;\n        }\n    },\n\n// ACTIONS\n    /**\n     * !#en\n     * Executes an action, and returns the action that is executed.<br/>\n     * The node becomes the action's target. Refer to cc.Action's getTarget() <br/>\n     * Calling runAction while the node is not active won't have any effect. <br/>\n     * Note：You shouldn't modify the action after runAction, that won't take any effect.<br/>\n     * if you want to modify, when you define action plus.\n     * !#zh\n     * 执行并返回该执行的动作。该节点将会变成动作的目标。<br/>\n     * 调用 runAction 时，节点自身处于不激活状态将不会有任何效果。<br/>\n     * 注意：你不应该修改 runAction 后的动作，将无法发挥作用，如果想进行修改，请在定义 action 时加入。\n     * @method runAction\n     * @param {Action} action\n     * @return {Action} An Action pointer\n     * @example\n     * var action = cc.scaleTo(0.2, 1, 0.6);\n     * node.runAction(action);\n     * node.runAction(action).repeatForever(); // fail\n     * node.runAction(action.repeatForever()); // right\n     */\n    runAction: ActionManagerExist ? function (action) {\n        if (!this.active)\n            return;\n        cc.assertID(action, 1618);\n        let am = cc.director.getActionManager();\n        if (!am._suppressDeprecation) {\n            am._suppressDeprecation = true;\n            cc.warnID(1639);\n        }\n        am.addAction(action, this, false);\n        return action;\n    } : emptyFunc,\n\n    /**\n     * !#en Pause all actions running on the current node. Equals to `cc.director.getActionManager().pauseTarget(node)`.\n     * !#zh 暂停本节点上所有正在运行的动作。和 `cc.director.getActionManager().pauseTarget(node);` 等价。\n     * @method pauseAllActions\n     * @example\n     * node.pauseAllActions();\n     */\n    pauseAllActions: ActionManagerExist ? function () {\n        cc.director.getActionManager().pauseTarget(this);\n    } : emptyFunc,\n\n    /**\n     * !#en Resume all paused actions on the current node. Equals to `cc.director.getActionManager().resumeTarget(node)`.\n     * !#zh 恢复运行本节点上所有暂停的动作。和 `cc.director.getActionManager().resumeTarget(node);` 等价。\n     * @method resumeAllActions\n     * @example\n     * node.resumeAllActions();\n     */\n    resumeAllActions: ActionManagerExist ? function () {\n        cc.director.getActionManager().resumeTarget(this);\n    } : emptyFunc,\n\n    /**\n     * !#en Stops and removes all actions from the running action list .\n     * !#zh 停止并且移除所有正在运行的动作列表。\n     * @method stopAllActions\n     * @example\n     * node.stopAllActions();\n     */\n    stopAllActions: ActionManagerExist ? function () {\n        cc.director.getActionManager().removeAllActionsFromTarget(this);\n    } : emptyFunc,\n\n    /**\n     * !#en Stops and removes an action from the running action list.\n     * !#zh 停止并移除指定的动作。\n     * @method stopAction\n     * @param {Action} action An action object to be removed.\n     * @example\n     * var action = cc.scaleTo(0.2, 1, 0.6);\n     * node.stopAction(action);\n     */\n    stopAction: ActionManagerExist ? function (action) {\n        cc.director.getActionManager().removeAction(action);\n    } : emptyFunc,\n\n    /**\n     * !#en Removes an action from the running action list by its tag.\n     * !#zh 停止并且移除指定标签的动作。\n     * @method stopActionByTag\n     * @param {Number} tag A tag that indicates the action to be removed.\n     * @example\n     * node.stopActionByTag(1);\n     */\n    stopActionByTag: ActionManagerExist ? function (tag) {\n        if (tag === cc.Action.TAG_INVALID) {\n            cc.logID(1612);\n            return;\n        }\n        cc.director.getActionManager().removeActionByTag(tag, this);\n    } : emptyFunc,\n\n    /**\n     * !#en Returns an action from the running action list by its tag.\n     * !#zh 通过标签获取指定动作。\n     * @method getActionByTag\n     * @see cc.Action#getTag and cc.Action#setTag\n     * @param {Number} tag\n     * @return {Action} The action object with the given tag.\n     * @example\n     * var action = node.getActionByTag(1);\n     */\n    getActionByTag: ActionManagerExist ? function (tag) {\n        if (tag === cc.Action.TAG_INVALID) {\n            cc.logID(1613);\n            return null;\n        }\n        return cc.director.getActionManager().getActionByTag(tag, this);\n    } : function () {\n        return null;\n    },\n\n    /**\n     * !#en\n     * Returns the numbers of actions that are running plus the ones that are schedule to run (actions in actionsToAdd and actions arrays).<br/>\n     *    Composable actions are counted as 1 action. Example:<br/>\n     *    If you are running 1 Sequence of 7 actions, it will return 1. <br/>\n     *    If you are running 7 Sequences of 2 actions, it will return 7.</p>\n     * !#zh\n     * 获取运行着的动作加上正在调度运行的动作的总数。<br/>\n     * 例如：<br/>\n     * - 如果你正在运行 7 个动作中的 1 个 Sequence，它将返回 1。<br/>\n     * - 如果你正在运行 2 个动作中的 7 个 Sequence，它将返回 7。<br/>\n     *\n     * @method getNumberOfRunningActions\n     * @return {Number} The number of actions that are running plus the ones that are schedule to run\n     * @example\n     * var count = node.getNumberOfRunningActions();\n     * cc.log(\"Running Action Count: \" + count);\n     */\n    getNumberOfRunningActions: ActionManagerExist ? function () {\n        return cc.director.getActionManager().getNumberOfRunningActionsInTarget(this);\n    } : function () {\n        return 0;\n    },\n\n\n// TRANSFORM RELATED\n    /**\n     * !#en\n     * Returns a copy of the position (x, y, z) of the node in its parent's coordinates.\n     * You can pass a cc.Vec2 or cc.Vec3 as the argument to receive the return values.\n     * !#zh\n     * 获取节点在父节点坐标系中的位置（x, y, z）。\n     * 你可以传一个 cc.Vec2 或者 cc.Vec3 作为参数来接收返回值。\n     * @method getPosition\n     * @param {Vec2|Vec3} [out] - The return value to receive position\n     * @return {Vec2|Vec3} The position (x, y, z) of the node in its parent's coordinates\n     * @example\n     * cc.log(\"Node Position: \" + node.getPosition());\n     */\n    getPosition (out) {\n        out = out || new Vec3();\n        return Trs.toPosition(out, this._trs);\n    },\n\n    /**\n     * !#en\n     * Sets the position (x, y, z) of the node in its parent's coordinates.<br/>\n     * Usually we use cc.v2(x, y) to compose cc.Vec2 object,<br/>\n     * and passing two numbers (x, y) is more efficient than passing cc.Vec2 object.\n     * For 3D node we can use cc.v3(x, y, z) to compose cc.Vec3 object,<br/>\n     * and passing three numbers (x, y, z) is more efficient than passing cc.Vec3 object.\n     * !#zh\n     * 设置节点在父节点坐标系中的位置。<br/>\n     * 可以通过下面的方式设置坐标点：<br/>\n     * 1. 传入 2 个数值 x, y。<br/>\n     * 2. 传入 cc.v2(x, y) 类型为 cc.Vec2 的对象。\n     * 3. 对于 3D 节点可以传入 3 个数值 x, y, z。<br/>\n     * 4. 对于 3D 节点可以传入 cc.v3(x, y, z) 类型为 cc.Vec3 的对象。\n     * @method setPosition\n     * @param {Vec2|Vec3|Number} newPosOrX - X coordinate for position or the position (x, y, z) of the node in coordinates\n     * @param {Number} [y] - Y coordinate for position\n     * @param {Number} [z] - Z coordinate for position\n     */\n    setPosition (newPosOrX, y, z) {\n        let x;\n        if (y === undefined) {\n            x = newPosOrX.x;\n            y = newPosOrX.y;\n            z = newPosOrX.z || 0;\n        }\n        else {\n            x = newPosOrX;\n            z = z || 0\n        }\n    \n        let trs = this._trs;\n        if (trs[0] === x && trs[1] === y && trs[2] === z) {\n            return;\n        }\n    \n        if (CC_EDITOR) {\n            var oldPosition = new cc.Vec3(trs[0], trs[1], trs[2]);\n        }\n    \n        trs[0] = x;\n        trs[1] = y;\n        trs[2] = z;\n        this.setLocalDirty(LocalDirtyFlag.ALL_POSITION);\n        !CC_NATIVERENDERER && (this._renderFlag |= RenderFlow.FLAG_WORLD_TRANSFORM);\n    \n        // fast check event\n        if (this._eventMask & POSITION_ON) {\n            if (CC_EDITOR) {\n                this.emit(EventType.POSITION_CHANGED, oldPosition);\n            }\n            else {\n                this.emit(EventType.POSITION_CHANGED);\n            }\n        }\n    },\n\n    /**\n     * !#en\n     * Returns the scale factor of the node.\n     * Need pass a cc.Vec2 or cc.Vec3 as the argument to receive the return values.\n     * !#zh 获取节点的缩放，需要传一个 cc.Vec2 或者 cc.Vec3 作为参数来接收返回值。\n     * @method getScale\n     * @param {Vec2|Vec3} out\n     * @return {Vec2|Vec3} The scale factor\n     * @example\n     * cc.log(\"Node Scale: \" + node.getScale(cc.v3()));\n     */\n    getScale (out) {\n        if (out !== undefined) {\n            return Trs.toScale(out, this._trs);\n        }\n        else {\n            cc.warnID(1400, 'cc.Node.getScale', 'cc.Node.scale or cc.Node.getScale(cc.Vec3)');\n            return this._trs[7];\n        }\n    },\n\n    /**\n     * !#en\n     * Sets the scale of axis in local coordinates of the node.\n     * You can operate 2 axis in 2D node, and 3 axis in 3D node.\n     * !#zh\n     * 设置节点在本地坐标系中坐标轴上的缩放比例。\n     * 2D 节点可以操作两个坐标轴，而 3D 节点可以操作三个坐标轴。\n     * @method setScale\n     * @param {Number|Vec2|Vec3} x - scaleX or scale object\n     * @param {Number} [y]\n     * @param {Number} [z]\n     * @example\n     * node.setScale(cc.v2(2, 2));\n     * node.setScale(cc.v3(2, 2, 2)); // for 3D node\n     * node.setScale(2);\n     */\n    setScale (x, y, z) {\n        if (x && typeof x !== 'number') {\n            y = x.y;\n            z = x.z === undefined ? 1 : x.z;\n            x = x.x;\n        }\n        else if (x !== undefined && y === undefined) {\n            y = x;\n            z = x;\n        }\n        else if (z === undefined) {\n            z = 1;\n        }\n        let trs = this._trs;\n        if (trs[7] !== x || trs[8] !== y || trs[9] !== z) {\n            trs[7] = x;\n            trs[8] = y;\n            trs[9] = z;\n            this.setLocalDirty(LocalDirtyFlag.ALL_SCALE);\n            !CC_NATIVERENDERER && (this._renderFlag |= RenderFlow.FLAG_TRANSFORM);\n    \n            if (this._eventMask & SCALE_ON) {\n                this.emit(EventType.SCALE_CHANGED);\n            }\n        }\n    },\n\n    /**\n     * !#en\n     * Get rotation of node (in quaternion).\n     * Need pass a cc.Quat as the argument to receive the return values.\n     * !#zh\n     * 获取该节点的 quaternion 旋转角度，需要传一个 cc.Quat 作为参数来接收返回值。\n     * @method getRotation\n     * @param {Quat} out\n     * @return {Quat} Quaternion object represents the rotation\n     */\n    getRotation (out) {\n        if (out instanceof Quat) {\n            return Trs.toRotation(out, this._trs);\n        }\n        else {\n            if (CC_DEBUG) {\n                cc.warn(\"`cc.Node.getRotation()` is deprecated since v2.1.0, please use `-cc.Node.angle` instead. (`this.node.getRotation()` -> `-this.node.angle`)\");\n            }\n            return -this.angle;\n        }\n    },\n\n    /**\n     * !#en Set rotation of node (in quaternion).\n     * !#zh 设置该节点的 quaternion 旋转角度。\n     * @method setRotation\n     * @param {cc.Quat|Number} quat Quaternion object represents the rotation or the x value of quaternion\n     * @param {Number} [y] y value of quternion\n     * @param {Number} [z] z value of quternion\n     * @param {Number} [w] w value of quternion\n     */\n    setRotation (rotation, y, z, w) {\n        if (typeof rotation === 'number' && y === undefined) {\n            if (CC_DEBUG) {\n                cc.warn(\"`cc.Node.setRotation(degree)` is deprecated since v2.1.0, please set `-cc.Node.angle` instead. (`this.node.setRotation(x)` -> `this.node.angle = -x`)\");\n            }\n            this.angle = -rotation;\n        }\n        else {\n            let x = rotation;\n            if (y === undefined) {\n                x = rotation.x;\n                y = rotation.y;\n                z = rotation.z;\n                w = rotation.w;\n            }\n\n            let trs = this._trs;\n            if (trs[3] !== x || trs[4] !== y || trs[5] !== z || trs[6] !== w) {\n                trs[3] = x;\n                trs[4] = y;\n                trs[5] = z;\n                trs[6] = w;\n                this.setLocalDirty(LocalDirtyFlag.ALL_ROTATION);\n\n                if (this._eventMask & ROTATION_ON) {\n                    this.emit(EventType.ROTATION_CHANGED);\n                }\n\n                if (CC_EDITOR) {\n                    this._toEuler();\n                }\n            }\n        }\n    },\n\n    /**\n     * !#en\n     * Returns a copy the untransformed size of the node. <br/>\n     * The contentSize remains the same no matter the node is scaled or rotated.<br/>\n     * All nodes has a size. Layer and Scene has the same size of the screen by default. <br/>\n     * !#zh 获取节点自身大小，不受该节点是否被缩放或者旋转的影响。\n     * @method getContentSize\n     * @return {Size} The untransformed size of the node.\n     * @example\n     * cc.log(\"Content Size: \" + node.getContentSize());\n     */\n    getContentSize () {\n        return cc.size(this._contentSize.width, this._contentSize.height);\n    },\n\n    /**\n     * !#en\n     * Sets the untransformed size of the node.<br/>\n     * The contentSize remains the same no matter the node is scaled or rotated.<br/>\n     * All nodes has a size. Layer and Scene has the same size of the screen.\n     * !#zh 设置节点原始大小，不受该节点是否被缩放或者旋转的影响。\n     * @method setContentSize\n     * @param {Size|Number} size - The untransformed size of the node or The untransformed size's width of the node.\n     * @param {Number} [height] - The untransformed size's height of the node.\n     * @example\n     * node.setContentSize(cc.size(100, 100));\n     * node.setContentSize(100, 100);\n     */\n    setContentSize (size, height) {\n        var locContentSize = this._contentSize;\n        var clone;\n        if (height === undefined) {\n            if ((size.width === locContentSize.width) && (size.height === locContentSize.height))\n                return;\n            if (CC_EDITOR) {\n                clone = cc.size(locContentSize.width, locContentSize.height);\n            }\n            locContentSize.width = size.width;\n            locContentSize.height = size.height;\n        } else {\n            if ((size === locContentSize.width) && (height === locContentSize.height))\n                return;\n            if (CC_EDITOR) {\n                clone = cc.size(locContentSize.width, locContentSize.height);\n            }\n            locContentSize.width = size;\n            locContentSize.height = height;\n        }\n        if (this._eventMask & SIZE_ON) {\n            if (CC_EDITOR) {\n                this.emit(EventType.SIZE_CHANGED, clone);\n            }\n            else {\n                this.emit(EventType.SIZE_CHANGED);\n            }\n        }\n    },\n\n    /**\n     * !#en\n     * Returns a copy of the anchor point.<br/>\n     * Anchor point is the point around which all transformations and positioning manipulations take place.<br/>\n     * It's like a pin in the node where it is \"attached\" to its parent. <br/>\n     * The anchorPoint is normalized, like a percentage. (0,0) means the bottom-left corner and (1,1) means the top-right corner. <br/>\n     * But you can use values higher than (1,1) and lower than (0,0) too.  <br/>\n     * The default anchor point is (0.5,0.5), so it starts at the center of the node.\n     * !#zh\n     * 获取节点锚点，用百分比表示。<br/>\n     * 锚点应用于所有变换和坐标点的操作，它就像在节点上连接其父节点的大头针。<br/>\n     * 锚点是标准化的，就像百分比一样。(0，0) 表示左下角，(1，1) 表示右上角。<br/>\n     * 但是你可以使用比（1，1）更高的值或者比（0，0）更低的值。<br/>\n     * 默认的锚点是（0.5，0.5），因此它开始于节点的中心位置。<br/>\n     * 注意：Creator 中的锚点仅用于定位所在的节点，子节点的定位不受影响。\n     * @method getAnchorPoint\n     * @return {Vec2} The anchor point of node.\n     * @example\n     * cc.log(\"Node AnchorPoint: \" + node.getAnchorPoint());\n     */\n    getAnchorPoint () {\n        return cc.v2(this._anchorPoint);\n    },\n\n    /**\n     * !#en\n     * Sets the anchor point in percent. <br/>\n     * anchor point is the point around which all transformations and positioning manipulations take place. <br/>\n     * It's like a pin in the node where it is \"attached\" to its parent. <br/>\n     * The anchorPoint is normalized, like a percentage. (0,0) means the bottom-left corner and (1,1) means the top-right corner.<br/>\n     * But you can use values higher than (1,1) and lower than (0,0) too.<br/>\n     * The default anchor point is (0.5,0.5), so it starts at the center of the node.\n     * !#zh\n     * 设置锚点的百分比。<br/>\n     * 锚点应用于所有变换和坐标点的操作，它就像在节点上连接其父节点的大头针。<br/>\n     * 锚点是标准化的，就像百分比一样。(0，0) 表示左下角，(1，1) 表示右上角。<br/>\n     * 但是你可以使用比（1，1）更高的值或者比（0，0）更低的值。<br/>\n     * 默认的锚点是（0.5，0.5），因此它开始于节点的中心位置。<br/>\n     * 注意：Creator 中的锚点仅用于定位所在的节点，子节点的定位不受影响。\n     * @method setAnchorPoint\n     * @param {Vec2|Number} point - The anchor point of node or The x axis anchor of node.\n     * @param {Number} [y] - The y axis anchor of node.\n     * @example\n     * node.setAnchorPoint(cc.v2(1, 1));\n     * node.setAnchorPoint(1, 1);\n     */\n    setAnchorPoint (point, y) {\n        var locAnchorPoint = this._anchorPoint;\n        if (y === undefined) {\n            if ((point.x === locAnchorPoint.x) && (point.y === locAnchorPoint.y))\n                return;\n            locAnchorPoint.x = point.x;\n            locAnchorPoint.y = point.y;\n        } else {\n            if ((point === locAnchorPoint.x) && (y === locAnchorPoint.y))\n                return;\n            locAnchorPoint.x = point;\n            locAnchorPoint.y = y;\n        }\n        this.setLocalDirty(LocalDirtyFlag.ALL_POSITION);\n        if (this._eventMask & ANCHOR_ON) {\n            this.emit(EventType.ANCHOR_CHANGED);\n        }\n    },\n\n    /*\n     * Transforms position from world space to local space.\n     * @method _invTransformPoint\n     * @param {Vec3} out\n     * @param {Vec3} vec3\n     */\n    _invTransformPoint (out, pos) {\n        if (this._parent) {\n            this._parent._invTransformPoint(out, pos);\n        } else {\n            Vec3.copy(out, pos);\n        }\n\n        let ltrs = this._trs;\n        // out = parent_inv_pos - pos\n        Trs.toPosition(_tpVec3a, ltrs);\n        Vec3.sub(out, out, _tpVec3a);\n\n        // out = inv(rot) * out\n        Trs.toRotation(_tpQuata, ltrs);\n        Quat.conjugate(_tpQuatb, _tpQuata);\n        Vec3.transformQuat(out, out, _tpQuatb);\n\n        // out = (1/scale) * out\n        Trs.toScale(_tpVec3a, ltrs);\n        Vec3.inverseSafe(_tpVec3b, _tpVec3a);\n        Vec3.mul(out, out, _tpVec3b);\n\n        return out;\n    },\n    \n    /*\n     * Calculate and return world position.\n     * This is not a public API yet, its usage could be updated\n     * @method getWorldPosition\n     * @param {Vec3} out\n     * @return {Vec3}\n     */\n    getWorldPosition (out) {\n        Trs.toPosition(out, this._trs);\n        let curr = this._parent;\n        let ltrs;\n        while (curr) {\n            ltrs = curr._trs;\n            // out = parent_scale * pos\n            Trs.toScale(_gwpVec3, ltrs);\n            Vec3.mul(out, out, _gwpVec3);\n            // out = parent_quat * out\n            Trs.toRotation(_gwpQuat, ltrs);\n            Vec3.transformQuat(out, out, _gwpQuat);\n            // out = out + pos\n            Trs.toPosition(_gwpVec3, ltrs);\n            Vec3.add(out, out, _gwpVec3);\n            curr = curr._parent;\n        }\n        return out;\n    },\n\n    /*\n     * Set world position.\n     * This is not a public API yet, its usage could be updated\n     * @method setWorldPosition\n     * @param {Vec3} pos\n     */\n    setWorldPosition (pos) {\n        let ltrs = this._trs;\n        if (CC_EDITOR) {\n            var oldPosition = new cc.Vec3(ltrs[0], ltrs[1], ltrs[2]);\n        }\n        // NOTE: this is faster than invert world matrix and transform the point\n        if (this._parent) {\n            this._parent._invTransformPoint(_swpVec3, pos);\n        }\n        else {\n            Vec3.copy(_swpVec3, pos);\n        }\n        Trs.fromPosition(ltrs, _swpVec3);\n        this.setLocalDirty(LocalDirtyFlag.ALL_POSITION);\n\n        // fast check event\n        if (this._eventMask & POSITION_ON) {\n            // send event\n            if (CC_EDITOR) {\n                this.emit(EventType.POSITION_CHANGED, oldPosition);\n            }\n            else {\n                this.emit(EventType.POSITION_CHANGED);\n            }\n        }\n    },\n\n    /*\n     * Calculate and return world rotation\n     * This is not a public API yet, its usage could be updated\n     * @method getWorldRotation\n     * @param {Quat} out\n     * @return {Quat}\n     */\n    getWorldRotation (out) {\n        Trs.toRotation(_gwrQuat, this._trs);\n        Quat.copy(out, _gwrQuat);\n        let curr = this._parent;\n        while (curr) {\n            Trs.toRotation(_gwrQuat, curr._trs);\n            Quat.mul(out, _gwrQuat, out);\n            curr = curr._parent;\n        }\n        return out;\n    },\n\n    /*\n     * Set world rotation with quaternion\n     * This is not a public API yet, its usage could be updated\n     * @method setWorldRotation\n     * @param {Quat} val\n     */\n    setWorldRotation (val) {\n        if (this._parent) {\n            this._parent.getWorldRotation(_swrQuat);\n            Quat.conjugate(_swrQuat, _swrQuat);\n            Quat.mul(_swrQuat, _swrQuat, val);\n        }\n        else {\n            Quat.copy(_swrQuat, val);\n        }\n        Trs.fromRotation(this._trs, _swrQuat);\n        if (CC_EDITOR) {\n            this._toEuler();\n        }\n        this.setLocalDirty(LocalDirtyFlag.ALL_ROTATION);\n    },\n\n    /*\n     * Calculate and return world scale\n     * This is not a public API yet, its usage could be updated\n     * @method getWorldScale\n     * @param {Vec3} out\n     * @return {Vec3}\n     */\n    getWorldScale (out) {\n        Trs.toScale(_gwsVec3, this._trs);\n        Vec3.copy(out, _gwsVec3);\n        let curr = this._parent;\n        while (curr) {\n            Trs.toScale(_gwsVec3, curr._trs);\n            Vec3.mul(out, out, _gwsVec3);\n            curr = curr._parent;\n        }\n        return out;\n    },\n\n    /*\n     * Set world scale with vec3\n     * This is not a public API yet, its usage could be updated\n     * @method setWorldScale\n     * @param {Vec3} scale\n     */\n    setWorldScale (scale) {\n        if (this._parent) {\n            this._parent.getWorldScale(_swsVec3);\n            Vec3.div(_swsVec3, scale, _swsVec3);\n        }\n        else {\n            Vec3.copy(_swsVec3, scale);\n        }\n        Trs.fromScale(this._trs, _swsVec3);\n        this.setLocalDirty(LocalDirtyFlag.ALL_SCALE);\n    },\n\n    getWorldRT (out) {\n        let opos = _gwrtVec3a;\n        let orot = _gwrtQuata;\n        let ltrs = this._trs;\n        Trs.toPosition(opos, ltrs);\n        Trs.toRotation(orot, ltrs);\n\n        let curr = this._parent;\n        while (curr) {\n            ltrs = curr._trs;\n            // opos = parent_lscale * lpos\n            Trs.toScale(_gwrtVec3b, ltrs);\n            Vec3.mul(opos, opos, _gwrtVec3b);\n            // opos = parent_lrot * opos\n            Trs.toRotation(_gwrtQuatb, ltrs);\n            Vec3.transformQuat(opos, opos, _gwrtQuatb);\n            // opos = opos + lpos\n            Trs.toPosition(_gwrtVec3b, ltrs);\n            Vec3.add(opos, opos, _gwrtVec3b);\n            // orot = lrot * orot\n            Quat.mul(orot, _gwrtQuatb, orot);\n            curr = curr._parent;\n        }\n        Mat4.fromRT(out, orot, opos);\n        return out;\n    },\n\n    /**\n     * !#en Set rotation by lookAt target point, normally used by Camera Node\n     * !#zh 通过观察目标来设置 rotation，一般用于 Camera Node 上\n     * @method lookAt\n     * @param {Vec3} pos\n     * @param {Vec3} [up] - default is (0,1,0)\n     */\n    lookAt (pos, up) {\n        this.getWorldPosition(_laVec3);\n        Vec3.sub(_laVec3, _laVec3, pos); // NOTE: we use -z for view-dir\n        Vec3.normalize(_laVec3, _laVec3);\n        Quat.fromViewUp(_laQuat, _laVec3, up);\n    \n        this.setWorldRotation(_laQuat);\n    },\n\n    _updateLocalMatrix: updateLocalMatrix2D,\n\n    _calculWorldMatrix () {\n        // Avoid as much function call as possible\n        if (this._localMatDirty & LocalDirtyFlag.TRSS) {\n            this._updateLocalMatrix();\n        }\n        \n        // Assume parent world matrix is correct\n        let parent = this._parent;\n        if (parent) {\n            this._mulMat(this._worldMatrix, parent._worldMatrix, this._matrix);\n        }\n        else {\n            Mat4.copy(this._worldMatrix, this._matrix);\n        }\n        this._worldMatDirty = false;\n    },\n\n    _mulMat: mulMat2D,\n\n    _updateWorldMatrix () {\n        if (this._parent) {\n            this._parent._updateWorldMatrix();\n        }\n        if (this._worldMatDirty) {\n            this._calculWorldMatrix();\n            // Sync dirty to children\n            let children = this._children;\n            for (let i = 0, l = children.length; i < l; i++) {\n                children[i]._worldMatDirty = true;\n            }\n        }\n    },\n\n    setLocalDirty (flag) {\n        this._localMatDirty |= flag;\n        this._worldMatDirty = true;\n\n        if (flag === LocalDirtyFlag.ALL_POSITION || flag === LocalDirtyFlag.POSITION) {\n            this._renderFlag |= RenderFlow.FLAG_WORLD_TRANSFORM;\n        }\n        else {\n            this._renderFlag |= RenderFlow.FLAG_TRANSFORM;\n        }        \n    },\n\n    setWorldDirty () {\n        this._worldMatDirty = true;\n    },\n\n    /**\n     * !#en\n     * Get the local transform matrix (4x4), based on parent node coordinates\n     * !#zh 返回局部空间坐标系的矩阵，基于父节点坐标系。\n     * @method getLocalMatrix\n     * @param {Mat4} out The matrix object to be filled with data\n     * @return {Mat4} Same as the out matrix object\n     * @example\n     * let mat4 = cc.mat4();\n     * node.getLocalMatrix(mat4);\n     */\n    getLocalMatrix (out) {\n        this._updateLocalMatrix();\n        return Mat4.copy(out, this._matrix);\n    },\n    \n    /**\n     * !#en\n     * Get the world transform matrix (4x4)\n     * !#zh 返回世界空间坐标系的矩阵。\n     * @method getWorldMatrix\n     * @param {Mat4} out The matrix object to be filled with data\n     * @return {Mat4} Same as the out matrix object\n     * @example\n     * let mat4 = cc.mat4();\n     * node.getWorldMatrix(mat4);\n     */\n    getWorldMatrix (out) {\n        this._updateWorldMatrix();\n        return Mat4.copy(out, this._worldMatrix);\n    },\n\n    /**\n     * !#en\n     * Converts a Point to node (local) space coordinates.\n     * !#zh\n     * 将一个点转换到节点 (局部) 空间坐标系。\n     * @method convertToNodeSpaceAR\n     * @param {Vec3|Vec2} worldPoint\n     * @param {Vec3|Vec2} [out]\n     * @return {Vec3|Vec2}\n     * @typescript\n     * convertToNodeSpaceAR<T extends cc.Vec2 | cc.Vec3>(worldPoint: T, out?: T): T\n     * @example\n     * var newVec2 = node.convertToNodeSpaceAR(cc.v2(100, 100));\n     * var newVec3 = node.convertToNodeSpaceAR(cc.v3(100, 100, 100));\n     */\n    convertToNodeSpaceAR (worldPoint, out) {\n        this._updateWorldMatrix();\n        Mat4.invert(_mat4_temp, this._worldMatrix);\n\n        if (worldPoint instanceof cc.Vec2) {\n            out = out || new cc.Vec2();\n            return Vec2.transformMat4(out, worldPoint, _mat4_temp);\n        }\n        else {\n            out = out || new cc.Vec3();\n            return Vec3.transformMat4(out, worldPoint, _mat4_temp);\n        }\n    },\n\n    /**\n     * !#en\n     * Converts a Point in node coordinates to world space coordinates.\n     * !#zh\n     * 将节点坐标系下的一个点转换到世界空间坐标系。\n     * @method convertToWorldSpaceAR\n     * @param {Vec3|Vec2} nodePoint\n     * @param {Vec3|Vec2} [out]\n     * @return {Vec3|Vec2}\n     * @typescript\n     * convertToWorldSpaceAR<T extends cc.Vec2 | cc.Vec3>(nodePoint: T, out?: T): T\n     * @example\n     * var newVec2 = node.convertToWorldSpaceAR(cc.v2(100, 100));\n     * var newVec3 = node.convertToWorldSpaceAR(cc.v3(100, 100, 100));\n     */\n    convertToWorldSpaceAR (nodePoint, out) {\n        this._updateWorldMatrix();\n        if (nodePoint instanceof cc.Vec2) {\n            out = out || new cc.Vec2();\n            return Vec2.transformMat4(out, nodePoint, this._worldMatrix);\n        }\n        else {\n            out = out || new cc.Vec3();\n            return Vec3.transformMat4(out, nodePoint, this._worldMatrix);\n        }\n    },\n\n// OLD TRANSFORM ACCESS APIs\n /**\n     * !#en Converts a Point to node (local) space coordinates then add the anchor point position.\n     * So the return position will be related to the left bottom corner of the node's bounding box.\n     * This equals to the API behavior of cocos2d-x, you probably want to use convertToNodeSpaceAR instead\n     * !#zh 将一个点转换到节点 (局部) 坐标系，并加上锚点的坐标。<br/>\n     * 也就是说返回的坐标是相对于节点包围盒左下角的坐标。<br/>\n     * 这个 API 的设计是为了和 cocos2d-x 中行为一致，更多情况下你可能需要使用 convertToNodeSpaceAR。\n     * @method convertToNodeSpace\n     * @deprecated since v2.1.3\n     * @param {Vec2} worldPoint\n     * @return {Vec2}\n     * @example\n     * var newVec2 = node.convertToNodeSpace(cc.v2(100, 100));\n     */\n    convertToNodeSpace (worldPoint) {\n        this._updateWorldMatrix();\n        Mat4.invert(_mat4_temp, this._worldMatrix);\n        let out = new cc.Vec2();\n        Vec2.transformMat4(out, worldPoint, _mat4_temp);\n        out.x += this._anchorPoint.x * this._contentSize.width;\n        out.y += this._anchorPoint.y * this._contentSize.height;\n        return out;\n    },\n\n    /**\n     * !#en Converts a Point related to the left bottom corner of the node's bounding box to world space coordinates.\n     * This equals to the API behavior of cocos2d-x, you probably want to use convertToWorldSpaceAR instead\n     * !#zh 将一个相对于节点左下角的坐标位置转换到世界空间坐标系。\n     * 这个 API 的设计是为了和 cocos2d-x 中行为一致，更多情况下你可能需要使用 convertToWorldSpaceAR\n     * @method convertToWorldSpace\n     * @deprecated since v2.1.3\n     * @param {Vec2} nodePoint\n     * @return {Vec2}\n     * @example\n     * var newVec2 = node.convertToWorldSpace(cc.v2(100, 100));\n     */\n    convertToWorldSpace (nodePoint) {\n        this._updateWorldMatrix();\n        let out = new cc.Vec2(\n            nodePoint.x - this._anchorPoint.x * this._contentSize.width,\n            nodePoint.y - this._anchorPoint.y * this._contentSize.height\n        );\n        return Vec2.transformMat4(out, out, this._worldMatrix);\n    },\n\n    /**\n     * !#en\n     * Returns the matrix that transform the node's (local) space coordinates into the parent's space coordinates.<br/>\n     * The matrix is in Pixels.\n     * !#zh 返回这个将节点（局部）的空间坐标系转换成父节点的空间坐标系的矩阵。这个矩阵以像素为单位。\n     * @method getNodeToParentTransform\n     * @deprecated since v2.0\n     * @param {AffineTransform} [out] The affine transform object to be filled with data\n     * @return {AffineTransform} Same as the out affine transform object\n     * @example\n     * let affineTransform = cc.AffineTransform.create();\n     * node.getNodeToParentTransform(affineTransform);\n     */\n    getNodeToParentTransform (out) {\n        if (!out) {\n            out = AffineTrans.identity();\n        }\n        this._updateLocalMatrix();\n        \n        var contentSize = this._contentSize;\n        _vec3_temp.x = -this._anchorPoint.x * contentSize.width;\n        _vec3_temp.y = -this._anchorPoint.y * contentSize.height;\n\n        Mat4.copy(_mat4_temp, this._matrix);\n        Mat4.transform(_mat4_temp, _mat4_temp, _vec3_temp);\n        return AffineTrans.fromMat4(out, _mat4_temp);\n    },\n\n    /**\n     * !#en\n     * Returns the matrix that transform the node's (local) space coordinates into the parent's space coordinates.<br/>\n     * The matrix is in Pixels.<br/>\n     * This method is AR (Anchor Relative).\n     * !#zh\n     * 返回这个将节点（局部）的空间坐标系转换成父节点的空间坐标系的矩阵。<br/>\n     * 这个矩阵以像素为单位。<br/>\n     * 该方法基于节点坐标。\n     * @method getNodeToParentTransformAR\n     * @deprecated since v2.0\n     * @param {AffineTransform} [out] The affine transform object to be filled with data\n     * @return {AffineTransform} Same as the out affine transform object\n     * @example\n     * let affineTransform = cc.AffineTransform.create();\n     * node.getNodeToParentTransformAR(affineTransform);\n     */\n    getNodeToParentTransformAR (out) {\n        if (!out) {\n            out = AffineTrans.identity();\n        }\n        this._updateLocalMatrix();\n        return AffineTrans.fromMat4(out, this._matrix);\n    },\n\n    /**\n     * !#en Returns the world affine transform matrix. The matrix is in Pixels.\n     * !#zh 返回节点到世界坐标系的仿射变换矩阵。矩阵单位是像素。\n     * @method getNodeToWorldTransform\n     * @deprecated since v2.0\n     * @param {AffineTransform} [out] The affine transform object to be filled with data\n     * @return {AffineTransform} Same as the out affine transform object\n     * @example\n     * let affineTransform = cc.AffineTransform.create();\n     * node.getNodeToWorldTransform(affineTransform);\n     */\n    getNodeToWorldTransform (out) {\n        if (!out) {\n            out = AffineTrans.identity();\n        }\n        this._updateWorldMatrix();\n        \n        var contentSize = this._contentSize;\n        _vec3_temp.x = -this._anchorPoint.x * contentSize.width;\n        _vec3_temp.y = -this._anchorPoint.y * contentSize.height;\n\n        Mat4.copy(_mat4_temp, this._worldMatrix);\n        Mat4.transform(_mat4_temp, _mat4_temp, _vec3_temp);\n\n        return AffineTrans.fromMat4(out, _mat4_temp);\n    },\n\n    /**\n     * !#en\n     * Returns the world affine transform matrix. The matrix is in Pixels.<br/>\n     * This method is AR (Anchor Relative).\n     * !#zh\n     * 返回节点到世界坐标仿射变换矩阵。矩阵单位是像素。<br/>\n     * 该方法基于节点坐标。\n     * @method getNodeToWorldTransformAR\n     * @deprecated since v2.0\n     * @param {AffineTransform} [out] The affine transform object to be filled with data\n     * @return {AffineTransform} Same as the out affine transform object\n     * @example\n     * let affineTransform = cc.AffineTransform.create();\n     * node.getNodeToWorldTransformAR(affineTransform);\n     */\n    getNodeToWorldTransformAR (out) {\n        if (!out) {\n            out = AffineTrans.identity();\n        }\n        this._updateWorldMatrix();\n        return AffineTrans.fromMat4(out, this._worldMatrix);\n    },\n\n    /**\n     * !#en\n     * Returns the matrix that transform parent's space coordinates to the node's (local) space coordinates.<br/>\n     * The matrix is in Pixels. The returned transform is readonly and cannot be changed.\n     * !#zh\n     * 返回将父节点的坐标系转换成节点（局部）的空间坐标系的矩阵。<br/>\n     * 该矩阵以像素为单位。返回的矩阵是只读的，不能更改。\n     * @method getParentToNodeTransform\n     * @deprecated since v2.0\n     * @param {AffineTransform} [out] The affine transform object to be filled with data\n     * @return {AffineTransform} Same as the out affine transform object\n     * @example\n     * let affineTransform = cc.AffineTransform.create();\n     * node.getParentToNodeTransform(affineTransform);\n     */\n    getParentToNodeTransform (out) {\n        if (!out) {\n            out = AffineTrans.identity();\n        }\n        this._updateLocalMatrix();\n        Mat4.invert(_mat4_temp, this._matrix);\n        return AffineTrans.fromMat4(out, _mat4_temp);\n    },\n\n    /**\n     * !#en Returns the inverse world affine transform matrix. The matrix is in Pixels.\n     * !#en 返回世界坐标系到节点坐标系的逆矩阵。\n     * @method getWorldToNodeTransform\n     * @deprecated since v2.0\n     * @param {AffineTransform} [out] The affine transform object to be filled with data\n     * @return {AffineTransform} Same as the out affine transform object\n     * @example\n     * let affineTransform = cc.AffineTransform.create();\n     * node.getWorldToNodeTransform(affineTransform);\n     */\n    getWorldToNodeTransform (out) {\n        if (!out) {\n            out = AffineTrans.identity();\n        }\n        this._updateWorldMatrix();\n        Mat4.invert(_mat4_temp, this._worldMatrix);\n        return AffineTrans.fromMat4(out, _mat4_temp);\n    },\n\n    /**\n     * !#en convenience methods which take a cc.Touch instead of cc.Vec2.\n     * !#zh 将触摸点转换成本地坐标系中位置。\n     * @method convertTouchToNodeSpace\n     * @deprecated since v2.0\n     * @param {Touch} touch - The touch object\n     * @return {Vec2}\n     * @example\n     * var newVec2 = node.convertTouchToNodeSpace(touch);\n     */\n    convertTouchToNodeSpace (touch) {\n        return this.convertToNodeSpace(touch.getLocation());\n    },\n\n    /**\n     * !#en converts a cc.Touch (world coordinates) into a local coordinate. This method is AR (Anchor Relative).\n     * !#zh 转换一个 cc.Touch（世界坐标）到一个局部坐标，该方法基于节点坐标。\n     * @method convertTouchToNodeSpaceAR\n     * @deprecated since v2.0\n     * @param {Touch} touch - The touch object\n     * @return {Vec2}\n     * @example\n     * var newVec2 = node.convertTouchToNodeSpaceAR(touch);\n     */\n    convertTouchToNodeSpaceAR (touch) {\n        return this.convertToNodeSpaceAR(touch.getLocation());\n    },\n    \n    /**\n     * !#en\n     * Returns a \"local\" axis aligned bounding box of the node. <br/>\n     * The returned box is relative only to its parent.\n     * !#zh 返回父节坐标系下的轴向对齐的包围盒。\n     * @method getBoundingBox\n     * @return {Rect} The calculated bounding box of the node\n     * @example\n     * var boundingBox = node.getBoundingBox();\n     */\n    getBoundingBox () {\n        this._updateLocalMatrix();\n        let width = this._contentSize.width;\n        let height = this._contentSize.height;\n        let rect = cc.rect(\n            -this._anchorPoint.x * width, \n            -this._anchorPoint.y * height, \n            width, \n            height);\n        return rect.transformMat4(rect, this._matrix);\n    },\n\n    /**\n     * !#en\n     * Returns a \"world\" axis aligned bounding box of the node.<br/>\n     * The bounding box contains self and active children's world bounding box.\n     * !#zh\n     * 返回节点在世界坐标系下的对齐轴向的包围盒（AABB）。<br/>\n     * 该边框包含自身和已激活的子节点的世界边框。\n     * @method getBoundingBoxToWorld\n     * @return {Rect}\n     * @example\n     * var newRect = node.getBoundingBoxToWorld();\n     */\n    getBoundingBoxToWorld () {\n        if (this._parent) {\n            this._parent._updateWorldMatrix();\n            return this._getBoundingBoxTo();\n        }\n        else {\n            return this.getBoundingBox();\n        }\n    },\n\n    _getBoundingBoxTo () {\n        let width = this._contentSize.width;\n        let height = this._contentSize.height;\n        let rect = cc.rect(\n            -this._anchorPoint.x * width, \n            -this._anchorPoint.y * height, \n            width, \n            height);\n        \n        this._calculWorldMatrix();\n        rect.transformMat4(rect, this._worldMatrix);\n\n        //query child's BoundingBox\n        if (!this._children)\n            return rect;\n\n        var locChildren = this._children;\n        for (var i = 0; i < locChildren.length; i++) {\n            var child = locChildren[i];\n            if (child && child.active) {\n                var childRect = child._getBoundingBoxTo();\n                if (childRect)\n                    rect.union(rect, childRect);\n            }\n        }\n        return rect;\n    },\n\n    _updateOrderOfArrival () {\n        var arrivalOrder = this._parent ? ++this._parent._childArrivalOrder : 0;\n        this._localZOrder = (this._localZOrder & 0xffff0000) | arrivalOrder;\n        \n        this.emit(EventType.SIBLING_ORDER_CHANGED);\n    },\n\n    /**\n     * !#en\n     * Adds a child to the node with z order and name.\n     * !#zh\n     * 添加子节点，并且可以修改该节点的 局部 Z 顺序和名字。\n     * @method addChild\n     * @param {Node} child - A child node\n     * @param {Number} [zIndex] - Z order for drawing priority. Please refer to zIndex property\n     * @param {String} [name] - A name to identify the node easily. Please refer to name property\n     * @example\n     * node.addChild(newNode, 1, \"node\");\n     */\n    addChild (child, zIndex, name) {\n        if (CC_DEV && !cc.Node.isNode(child)) {\n            return cc.errorID(1634, cc.js.getClassName(child));\n        }\n        cc.assertID(child, 1606);\n        cc.assertID(child._parent === null, 1605);\n\n        // invokes the parent setter\n        child.parent = this;\n\n        if (zIndex !== undefined) {\n            child.zIndex = zIndex;\n        }\n        if (name !== undefined) {\n            child.name = name;\n        }\n    },\n\n    /**\n     * !#en Stops all running actions and schedulers.\n     * !#zh 停止所有正在播放的动作和计时器。\n     * @method cleanup\n     * @example\n     * node.cleanup();\n     */\n    cleanup () {\n        // actions\n        ActionManagerExist && cc.director.getActionManager().removeAllActionsFromTarget(this);\n        // event\n        eventManager.removeListeners(this);\n\n        // children\n        var i, len = this._children.length, node;\n        for (i = 0; i < len; ++i) {\n            node = this._children[i];\n            if (node)\n                node.cleanup();\n        }\n    },\n\n    /**\n     * !#en Sorts the children array depends on children's zIndex and arrivalOrder,\n     * normally you won't need to invoke this function.\n     * !#zh 根据子节点的 zIndex 和 arrivalOrder 进行排序，正常情况下开发者不需要手动调用这个函数。\n     *\n     * @method sortAllChildren\n     */\n    sortAllChildren () {\n        if (this._reorderChildDirty) {\n            \n            this._reorderChildDirty = false;\n\n            // delay update arrivalOrder before sort children\n            var _children = this._children, child;\n            // reset arrivalOrder before sort children\n            this._childArrivalOrder = 1;\n            for (let i = 0, len = _children.length; i < len; i++) {\n                child = _children[i];\n                child._updateOrderOfArrival();\n            }\n\n            // Optimize reordering event code to fix problems with setting zindex\n            // https://github.com/cocos-creator/2d-tasks/issues/1186\n            eventManager._setDirtyForNode(this);\n\n            if (_children.length > 1) {\n                // insertion sort\n                var j, child;\n                for (let i = 1, len = _children.length; i < len; i++) {\n                    child = _children[i];\n                    j = i - 1;\n\n                    //continue moving element downwards while zOrder is smaller or when zOrder is the same but mutatedIndex is smaller\n                    while (j >= 0) {\n                        if (child._localZOrder < _children[j]._localZOrder) {\n                            _children[j + 1] = _children[j];\n                        } else {\n                            break;\n                        }\n                        j--;\n                    }\n                    _children[j + 1] = child;\n                }\n                this.emit(EventType.CHILD_REORDER, this);\n            }\n            cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE, this.sortAllChildren, this);\n        }\n    },\n\n    _delaySort () {\n        if (!this._reorderChildDirty) {\n            this._reorderChildDirty = true;\n            cc.director.__fastOn(cc.Director.EVENT_AFTER_UPDATE, this.sortAllChildren, this);\n        }\n    },\n\n    _restoreProperties: CC_EDITOR && function () {\n        /*\n         * TODO: Refine this code after completing undo/redo 2.0.\n         * The node will be destroyed when deleting in the editor,\n         * but it will be reserved and reused for undo.\n        */\n\n        // restore 3d node\n        this.is3DNode = this.is3DNode;\n\n        if (!this._matrix) {\n            this._matrix = cc.mat4(this._spaceInfo.localMat);\n            Mat4.identity(this._matrix);\n        }\n        if (!this._worldMatrix) {\n            this._worldMatrix = cc.mat4(this._spaceInfo.worldMat);\n            Mat4.identity(this._worldMatrix);\n        }\n\n        this._localMatDirty = LocalDirtyFlag.ALL;\n        this._worldMatDirty = true;\n\n        this._fromEuler();\n\n        this._renderFlag |= RenderFlow.FLAG_TRANSFORM;\n        if (this._renderComponent) {\n            this._renderComponent.markForRender(true);\n        }\n\n        if (this._children.length > 0) {\n            this._renderFlag |= RenderFlow.FLAG_CHILDREN;\n        }\n    },\n\n    onRestore: CC_EDITOR && function () {\n        this._onRestoreBase();\n\n        this._restoreProperties();\n\n        var actionManager = cc.director.getActionManager();\n        if (this._activeInHierarchy) {\n            actionManager && actionManager.resumeTarget(this);\n            eventManager.resumeTarget(this);\n        }\n        else {\n            actionManager && actionManager.pauseTarget(this);\n            eventManager.pauseTarget(this);\n        }\n    },\n\n\n};\n\nif (CC_EDITOR) {\n    // deprecated, only used to import old data in editor\n    js.mixin(NodeDefines.properties, {\n        _scaleX: {\n            default: undefined,\n            type: cc.Float,\n            editorOnly: true\n        },\n        _scaleY: {\n            default: undefined,\n            type: cc.Float,\n            editorOnly: true\n        },\n    });\n}\n\nlet Node = cc.Class(NodeDefines);\n\n// 3D Node Property\n\n\n// Node Event\n\n/**\n * !#en\n * The position changing event, you can listen to this event through the statement this.node.on(cc.Node.EventType.POSITION_CHANGED, callback, this);\n * !#zh\n * 位置变动监听事件, 通过 this.node.on(cc.Node.EventType.POSITION_CHANGED, callback, this); 进行监听。\n * @event position-changed\n * @param {Vec2} oldPos - The old position, but this parameter is only available in editor!\n */\n/**\n * !#en\n * The size changing event, you can listen to this event through the statement this.node.on(cc.Node.EventType.SIZE_CHANGED, callback, this);\n * !#zh\n * 尺寸变动监听事件，通过 this.node.on(cc.Node.EventType.SIZE_CHANGED, callback, this); 进行监听。\n * @event size-changed\n * @param {Size} oldSize - The old size, but this parameter is only available in editor!\n */\n/**\n * !#en\n * The anchor changing event, you can listen to this event through the statement this.node.on(cc.Node.EventType.ANCHOR_CHANGED, callback, this);\n * !#zh\n * 锚点变动监听事件，通过 this.node.on(cc.Node.EventType.ANCHOR_CHANGED, callback, this); 进行监听。\n * @event anchor-changed\n */\n/**\n * !#en\n * The adding child event, you can listen to this event through the statement this.node.on(cc.Node.EventType.CHILD_ADDED, callback, this);\n * !#zh\n * 增加子节点监听事件，通过 this.node.on(cc.Node.EventType.CHILD_ADDED, callback, this); 进行监听。\n * @event child-added\n * @param {Node} child - child which have been added\n */\n/**\n * !#en\n * The removing child event, you can listen to this event through the statement this.node.on(cc.Node.EventType.CHILD_REMOVED, callback, this);\n * !#zh\n * 删除子节点监听事件，通过 this.node.on(cc.Node.EventType.CHILD_REMOVED, callback, this); 进行监听。\n * @event child-removed\n * @param {Node} child - child which have been removed\n */\n/**\n * !#en\n * The reordering child event, you can listen to this event through the statement this.node.on(cc.Node.EventType.CHILD_REORDER, callback, this);\n * !#zh\n * 子节点顺序变动监听事件，通过 this.node.on(cc.Node.EventType.CHILD_REORDER, callback, this); 进行监听。\n * @event child-reorder\n * @param {Node} node - node whose children have been reordered\n */\n/**\n * !#en\n * The group changing event, you can listen to this event through the statement this.node.on(cc.Node.EventType.GROUP_CHANGED, callback, this);\n * !#zh\n * 节点分组变动监听事件，通过 this.node.on(cc.Node.EventType.GROUP_CHANGED, callback, this); 进行监听。\n * @event group-changed\n * @param {Node} node - node whose group has changed\n */\n\n// Deprecated APIs\n\n/**\n * !#en\n * Returns the displayed opacity of Node,\n * the difference between displayed opacity and opacity is that displayed opacity is calculated based on opacity and parent node's opacity when cascade opacity enabled.\n * !#zh\n * 获取节点显示透明度，\n * 显示透明度和透明度之间的不同之处在于当启用级连透明度时，\n * 显示透明度是基于自身透明度和父节点透明度计算的。\n *\n * @method getDisplayedOpacity\n * @return {number} displayed opacity\n * @deprecated since v2.0, please use opacity property, cascade opacity is removed\n */\n\n/**\n * !#en\n * Returns the displayed color of Node,\n * the difference between displayed color and color is that displayed color is calculated based on color and parent node's color when cascade color enabled.\n * !#zh\n * 获取节点的显示颜色，\n * 显示颜色和颜色之间的不同之处在于当启用级连颜色时，\n * 显示颜色是基于自身颜色和父节点颜色计算的。\n *\n * @method getDisplayedColor\n * @return {Color}\n * @deprecated since v2.0, please use color property, cascade color is removed\n */\n\n/**\n * !#en Cascade opacity is removed from v2.0\n * Indicate whether node's opacity value affect its child nodes, default value is true.\n * !#zh 透明度级联功能从 v2.0 开始已移除\n * 节点的不透明度值是否影响其子节点，默认值为 true。\n * @property cascadeOpacity\n * @deprecated since v2.0\n * @type {Boolean}\n */\n\n/**\n * !#en Cascade opacity is removed from v2.0\n * Returns whether node's opacity value affect its child nodes.\n * !#zh 透明度级联功能从 v2.0 开始已移除\n * 返回节点的不透明度值是否影响其子节点。\n * @method isCascadeOpacityEnabled\n * @deprecated since v2.0\n * @return {Boolean}\n */\n\n/**\n * !#en Cascade opacity is removed from v2.0\n * Enable or disable cascade opacity, if cascade enabled, child nodes' opacity will be the multiplication of parent opacity and its own opacity.\n * !#zh 透明度级联功能从 v2.0 开始已移除\n * 启用或禁用级连不透明度，如果级连启用，子节点的不透明度将是父不透明度乘上它自己的不透明度。\n * @method setCascadeOpacityEnabled\n * @deprecated since v2.0\n * @param {Boolean} cascadeOpacityEnabled\n */\n\n/**\n * !#en Opacity modify RGB have been removed since v2.0\n * Set whether color should be changed with the opacity value,\n * useless in ccsg.Node, but this function is override in some class to have such behavior.\n * !#zh 透明度影响颜色配置已经被废弃\n * 设置更改透明度时是否修改RGB值，\n * @method setOpacityModifyRGB\n * @deprecated since v2.0\n * @param {Boolean} opacityValue\n */\n\n/**\n * !#en Opacity modify RGB have been removed since v2.0\n * Get whether color should be changed with the opacity value.\n * !#zh 透明度影响颜色配置已经被废弃\n * 获取更改透明度时是否修改RGB值。\n * @method isOpacityModifyRGB\n * @deprecated since v2.0\n * @return {Boolean}\n */\n\n\nlet _p = Node.prototype;\njs.getset(_p, 'position', _p.getPosition, _p.setPosition, false, true);\n\nif (CC_EDITOR) {\n    let vec3_tmp = new Vec3();\n    cc.js.getset(_p, 'worldEulerAngles', function () {\n        let angles = new Vec3(this._eulerAngles);\n        let parent = this.parent;\n        while (parent) {\n            angles.addSelf(parent._eulerAngles);\n            parent = parent.parent;\n        }\n        return angles;\n    }, function (v) {\n        vec3_tmp.set(v);\n        let parent = this.parent;\n        while (parent) {\n            vec3_tmp.subSelf(parent._eulerAngles);\n            parent = parent.parent;\n        }\n        this.eulerAngles = vec3_tmp;\n    });\n}\n\ncc.Node = module.exports = Node;\n","/****************************************************************************\n Copyright (c) 2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n'use strict';\n\nconst Node = require('./CCNode');\nconst RenderFlow = require('./renderer/render-flow');\n\nconst HideInHierarchy = cc.Object.Flags.HideInHierarchy;\nconst LocalDirtyFlag = Node._LocalDirtyFlag;\nconst POSITION_ON = 1 << 0;\n\n/**\n * !#en\n * Class of private entities in Cocos Creator scenes.<br/>\n * The PrivateNode is hidden in editor, and completely transparent to users.<br/>\n * It's normally used as Node's private content created by components in parent node.<br/>\n * So in theory private nodes are not children, they are part of the parent node.<br/>\n * Private node have two important characteristics:<br/>\n * 1. It has the minimum z index and cannot be modified, because they can't be displayed over real children.<br/>\n * 2. The positioning of private nodes is also special, they will consider the left bottom corner of the parent node's bounding box as the origin of local coordinates.<br/>\n *    In this way, they can be easily kept inside the bounding box.<br/>\n * Currently, it's used by RichText component and TileMap component.\n * !#zh\n * Cocos Creator 场景中的私有节点类。<br/>\n * 私有节点在编辑器中不可见，对用户透明。<br/>\n * 通常私有节点是被一些特殊的组件创建出来作为父节点的一部分而存在的，理论上来说，它们不是子节点，而是父节点的组成部分。<br/>\n * 私有节点有两个非常重要的特性：<br/>\n * 1. 它有着最小的渲染排序的 Z 轴深度，并且无法被更改，因为它们不能被显示在其他正常子节点之上。<br/>\n * 2. 它的定位也是特殊的，对于私有节点来说，父节点包围盒的左下角是它的局部坐标系原点，这个原点相当于父节点的位置减去它锚点的偏移。这样私有节点可以比较容易被控制在包围盒之中。<br/>\n * 目前在引擎中，RichText 和 TileMap 都有可能生成私有节点。\n * @class PrivateNode\n * @constructor\n * @param {String} name\n * @extends Node\n */\nlet PrivateNode = cc.Class({\n    name: 'cc.PrivateNode',\n    extends: Node,\n\n    properties: {\n        x: {\n            get () {\n                return this._originPos.x;\n            },\n            set (value) {\n                var localPosition = this._originPos;\n                if (value !== localPosition.x) {\n                    localPosition.x = value;\n                    this._posDirty(true);\n                }\n            },\n            override: true\n        },\n        y: {\n            get () {\n                return this._originPos.y;\n            },\n            set (value) {\n                var localPosition = this._originPos;\n                if (value !== localPosition.y) {\n                    localPosition.y = value;\n                    this._posDirty(true);\n                }\n            },\n            override: true\n        },\n        zIndex: {\n            get () {\n                return cc.macro.MIN_ZINDEX;\n            },\n            set () {\n                cc.warnID(1638);\n            },\n            override: true\n        },\n        showInEditor: {\n            default: false,\n            editorOnly: true,\n            override: true\n        }\n    },\n\n    /**\n     * @method constructor\n     * @param {String} [name]\n     */\n    ctor (name) {\n        this._localZOrder = cc.macro.MIN_ZINDEX << 16;\n        this._originPos = cc.v2();\n        if (CC_EDITOR) {\n            this._objFlags |= HideInHierarchy;\n        }\n    },\n\n    _posDirty (sendEvent) {\n        this.setLocalDirty(LocalDirtyFlag.POSITION);\n        !CC_NATIVERENDERER && (this._renderFlag |= RenderFlow.FLAG_TRANSFORM);\n        if (sendEvent === true && (this._eventMask & POSITION_ON)) {\n            this.emit(Node.EventType.POSITION_CHANGED);\n        }\n    },\n\n    _updateLocalMatrix() {\n        if (!this._localMatDirty) return;\n\n        let parent = this.parent;\n        if (parent) {\n            // Position correction for transform calculation\n            this._trs[0] = this._originPos.x - (parent._anchorPoint.x - 0.5) * parent._contentSize.width;\n            this._trs[1] = this._originPos.y - (parent._anchorPoint.y - 0.5) * parent._contentSize.height;\n        }\n\n        this._super();\n    },\n\n    getPosition () {\n        return new cc.Vec2(this._originPos);\n    },\n\n    setPosition (x, y) {\n        if (y === undefined) {\n            x = x.x;\n            y = x.y;\n        }\n\n        let pos = this._originPos;\n        if (pos.x === x && pos.y === y) {\n            return;\n        }\n        pos.x = x;\n        pos.y = y;\n        this._posDirty(true);\n    },\n\n    setParent(value) {\n        let oldParent = this._parent;\n        this._super(value);\n        if (oldParent !== value) {\n            if (oldParent) {\n                oldParent.off(Node.EventType.ANCHOR_CHANGED, this._posDirty, this);\n            }\n            if (value) {\n                value.on(Node.EventType.ANCHOR_CHANGED, this._posDirty, this);\n            }\n        }\n    },\n\n    // do not update order of arrival\n    _updateOrderOfArrival() {},\n});\n\ncc.js.getset(PrivateNode.prototype, \"parent\", PrivateNode.prototype.getParent, PrivateNode.prototype.setParent);\ncc.js.getset(PrivateNode.prototype, \"position\", PrivateNode.prototype.getPosition, PrivateNode.prototype.setPosition);\n\ncc.PrivateNode = module.exports = PrivateNode;\n","/****************************************************************************\n Copyright (c) 2015-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar NIL = function () {};\n\n/**\n * !#en\n * cc.Scene is a subclass of cc.Node that is used only as an abstract concept.<br/>\n * cc.Scene and cc.Node are almost identical with the difference that users can not modify cc.Scene manually.\n * !#zh\n * cc.Scene 是 cc.Node 的子类，仅作为一个抽象的概念。<br/>\n * cc.Scene 和 cc.Node 有点不同，用户不应直接修改 cc.Scene。\n * @class Scene\n * @extends Node\n */\ncc.Scene = cc.Class({\n    name: 'cc.Scene',\n    extends: require('./CCNode'),\n\n    properties: {\n        _is3DNode: {\n            default: true,\n            override: true\n        },\n\n        /**\n         * !#en Indicates whether all (directly or indirectly) static referenced assets of this scene are releasable by default after scene unloading.\n         * !#zh 指示该场景中直接或间接静态引用到的所有资源是否默认在场景切换后自动释放。\n         * @property {Boolean} autoReleaseAssets\n         * @default false\n         */\n        autoReleaseAssets: {\n            default: undefined,\n            type: cc.Boolean\n        },\n\n    },\n\n    ctor: function () {\n        this._anchorPoint.x = 0.0;\n        this._anchorPoint.y = 0.0;\n\n        this._activeInHierarchy = false;\n        this._inited = !cc.game._isCloning;\n\n        if (CC_EDITOR) {\n            this._prefabSyncedInLiveReload = false;\n        }\n\n        // cache all depend assets for auto release\n        this.dependAssets = null;\n    },\n\n    destroy: function () {\n        if (cc.Object.prototype.destroy.call(this)) {\n            var children = this._children;\n            for (var i = 0; i < children.length; ++i) {\n                children[i].active = false;\n            }\n        }\n        this._active = false;\n        this._activeInHierarchy = false;\n    },\n\n    _onHierarchyChanged: NIL,\n    _instantiate : null,\n\n    _load: function () {\n        if (!this._inited) {\n            if (CC_TEST) {\n                cc.assert(!this._activeInHierarchy, 'Should deactivate ActionManager and EventManager by default');\n            }\n            if (CC_EDITOR && this._prefabSyncedInLiveReload) {\n                this._onBatchRestored();\n            }\n            else {\n                this._onBatchCreated();\n            }\n            this._inited = true;\n        }\n    },\n\n    _activate: function (active) {\n        active = (active !== false);\n        if (CC_EDITOR || CC_TEST) {\n            // register all nodes to editor\n            this._registerIfAttached(active);\n        }\n        cc.director._nodeActivator.activateNode(this, active);\n    }\n});\n\nmodule.exports = cc.Scene;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * @module cc\n */\nconst js = require('./platform/js');\nconst IdGenerater = require('./platform/id-generater');\nconst MAX_POOL_SIZE = 20;\n\nvar idGenerater = new IdGenerater('Scheduler');\n\n//data structures\n/*\n * A list double-linked list used for \"updates with priority\"\n * @class ListEntry\n * @param {Object} target not retained (retained by hashUpdateEntry)\n * @param {Number} priority\n * @param {Boolean} paused\n * @param {Boolean} markedForDeletion selector will no longer be called and entry will be removed at end of the next tick\n */\nvar ListEntry = function (target, priority, paused, markedForDeletion) {\n    this.target = target;\n    this.priority = priority;\n    this.paused = paused;\n    this.markedForDeletion = markedForDeletion;\n};\n\nvar _listEntries = [];\nListEntry.get = function (target, priority, paused, markedForDeletion) {\n    var result = _listEntries.pop();\n    if (result) {\n        result.target = target;\n        result.priority = priority;\n        result.paused = paused;\n        result.markedForDeletion = markedForDeletion;\n    }\n    else {\n        result = new ListEntry(target, priority, paused, markedForDeletion);\n    }\n    return result;\n};\nListEntry.put = function (entry) {\n    if (_listEntries.length < MAX_POOL_SIZE) {\n        entry.target = null;\n        _listEntries.push(entry);\n    }\n};\n\n/*\n * A update entry list\n * @class HashUpdateEntry\n * @param {Array} list Which list does it belong to ?\n * @param {ListEntry} entry entry in the list\n * @param {Object} target hash key (retained)\n * @param {function} callback\n */\nvar HashUpdateEntry = function (list, entry, target, callback) {\n    this.list = list;\n    this.entry = entry;\n    this.target = target;\n    this.callback = callback;\n};\nvar _hashUpdateEntries = [];\nHashUpdateEntry.get = function (list, entry, target, callback) {\n    var result = _hashUpdateEntries.pop();\n    if (result) {\n        result.list = list;\n        result.entry = entry;\n        result.target = target;\n        result.callback = callback;\n    }\n    else {\n        result = new HashUpdateEntry(list, entry, target, callback);\n    }\n    return result;\n};\nHashUpdateEntry.put = function (entry) {\n    if (_hashUpdateEntries.length < MAX_POOL_SIZE) {\n        entry.list = entry.entry = entry.target = entry.callback = null;\n        _hashUpdateEntries.push(entry);\n    }\n};\n\n//\n/*\n * Hash Element used for \"selectors with interval\"\n * @class HashTimerEntry\n * @param {Array} timers\n * @param {Object} target  hash key (retained)\n * @param {Number} timerIndex\n * @param {Timer} currentTimer\n * @param {Boolean} currentTimerSalvaged\n * @param {Boolean} paused\n */\nvar HashTimerEntry = function (timers, target, timerIndex, currentTimer, currentTimerSalvaged, paused) {\n    var _t = this;\n    _t.timers = timers;\n    _t.target = target;\n    _t.timerIndex = timerIndex;\n    _t.currentTimer = currentTimer;\n    _t.currentTimerSalvaged = currentTimerSalvaged;\n    _t.paused = paused;\n};\nvar _hashTimerEntries = [];\nHashTimerEntry.get = function (timers, target, timerIndex, currentTimer, currentTimerSalvaged, paused) {\n    var result = _hashTimerEntries.pop();\n    if (result) {\n        result.timers = timers;\n        result.target = target;\n        result.timerIndex = timerIndex;\n        result.currentTimer = currentTimer;\n        result.currentTimerSalvaged = currentTimerSalvaged;\n        result.paused = paused;\n    }\n    else {\n        result = new HashTimerEntry(timers, target, timerIndex, currentTimer, currentTimerSalvaged, paused);\n    }\n    return result;\n};\nHashTimerEntry.put = function (entry) {\n    if (_hashTimerEntries.length < MAX_POOL_SIZE) {\n        entry.timers = entry.target = entry.currentTimer = null;\n        _hashTimerEntries.push(entry);\n    }\n};\n\n/*\n * Light weight timer\n * @extends cc.Class\n */\nfunction CallbackTimer () {\n    this._lock = false;\n    this._scheduler = null;\n    this._elapsed = -1;\n    this._runForever = false;\n    this._useDelay = false;\n    this._timesExecuted = 0;\n    this._repeat = 0;\n    this._delay = 0;\n    this._interval = 0;\n\n    this._target = null;\n    this._callback = null;\n}\n\nvar proto = CallbackTimer.prototype;\n\nproto.initWithCallback = function (scheduler, callback, target, seconds, repeat, delay) {\n    this._lock = false;\n    this._scheduler = scheduler;\n    this._target = target;\n    this._callback = callback;\n\n    this._elapsed = -1;\n    this._interval = seconds;\n    this._delay = delay;\n    this._useDelay = (this._delay > 0);\n    this._repeat = repeat;\n    this._runForever = (this._repeat === cc.macro.REPEAT_FOREVER);\n    return true;\n};\n/**\n * @return {Number} returns interval of timer\n */\nproto.getInterval = function(){return this._interval;};\n/**\n * @param {Number} interval set interval in seconds\n */\nproto.setInterval = function(interval){this._interval = interval;};\n\n/**\n * triggers the timer\n * @param {Number} dt delta time\n */\nproto.update = function (dt) {\n    if (this._elapsed === -1) {\n        this._elapsed = 0;\n        this._timesExecuted = 0;\n    } else {\n        this._elapsed += dt;\n        if (this._runForever && !this._useDelay) {//standard timer usage\n            if (this._elapsed >= this._interval) {\n                this.trigger();\n                this._elapsed = 0;\n            }\n        } else {//advanced usage\n            if (this._useDelay) {\n                if (this._elapsed >= this._delay) {\n                    this.trigger();\n\n                    this._elapsed -= this._delay;\n                    this._timesExecuted += 1;\n                    this._useDelay = false;\n                }\n            } else {\n                if (this._elapsed >= this._interval) {\n                    this.trigger();\n\n                    this._elapsed = 0;\n                    this._timesExecuted += 1;\n                }\n            }\n\n            if (this._callback && !this._runForever && this._timesExecuted > this._repeat)\n                this.cancel();\n        }\n    }\n};\n\nproto.getCallback = function(){\n    return this._callback;\n};\n\nproto.trigger = function () {\n    if (this._target && this._callback) {\n        this._lock = true;\n        this._callback.call(this._target, this._elapsed);\n        this._lock = false;\n    }\n};\n\nproto.cancel = function () {\n    //override\n    this._scheduler.unschedule(this._callback, this._target);\n};\n\nvar _timers = [];\nCallbackTimer.get = function () {\n    return _timers.pop() || new CallbackTimer();\n};\nCallbackTimer.put = function (timer) {\n    if (_timers.length < MAX_POOL_SIZE && !timer._lock) {\n        timer._scheduler = timer._target = timer._callback = null;\n        _timers.push(timer);\n    }\n};\n\n/**\n * !#en\n * Scheduler is responsible of triggering the scheduled callbacks.<br/>\n * You should not use NSTimer. Instead use this class.<br/>\n * <br/>\n * There are 2 different types of callbacks (selectors):<br/>\n *     - update callback: the 'update' callback will be called every frame. You can customize the priority.<br/>\n *     - custom callback: A custom callback will be called every frame, or with a custom interval of time<br/>\n * <br/>\n * The 'custom selectors' should be avoided when possible. It is faster,\n * and consumes less memory to use the 'update callback'. *\n * !#zh\n * Scheduler 是负责触发回调函数的类。<br/>\n * 通常情况下，建议使用 cc.director.getScheduler() 来获取系统定时器。<br/>\n * 有两种不同类型的定时器：<br/>\n *     - update 定时器：每一帧都会触发。您可以自定义优先级。<br/>\n *     - 自定义定时器：自定义定时器可以每一帧或者自定义的时间间隔触发。<br/>\n * 如果希望每帧都触发，应该使用 update 定时器，使用 update 定时器更快，而且消耗更少的内存。\n *\n * @class Scheduler\n */\ncc.Scheduler = function () {\n    this._timeScale = 1.0;\n    this._updatesNegList = [];  // list of priority < 0\n    this._updates0List = [];    // list of priority == 0\n    this._updatesPosList = [];  // list of priority > 0\n    this._hashForUpdates = js.createMap(true);  // hash used to fetch quickly the list entries for pause, delete, etc\n    this._hashForTimers = js.createMap(true);   // Used for \"selectors with interval\"\n    this._currentTarget = null;\n    this._currentTargetSalvaged = false;\n    this._updateHashLocked = false; // If true unschedule will not remove anything from a hash. Elements will only be marked for deletion.\n\n    this._arrayForTimers = [];  // Speed up indexing\n    //this._arrayForUpdates = [];   // Speed up indexing\n};\n\ncc.Scheduler.prototype = {\n    constructor: cc.Scheduler,\n    //-----------------------private method----------------------\n\n    _removeHashElement: function (element) {\n        delete this._hashForTimers[element.target._id];\n        var arr = this._arrayForTimers;\n        for (var i = 0, l = arr.length; i < l; i++) {\n            if (arr[i] === element) {\n                arr.splice(i, 1);\n                break;\n            }\n        }\n        HashTimerEntry.put(element);\n    },\n\n    _removeUpdateFromHash: function (entry) {\n        var targetId = entry.target._id;\n        var self = this, element = self._hashForUpdates[targetId];\n        if (element) {\n            // Remove list entry from list\n            var list = element.list, listEntry = element.entry;\n            for (var i = 0, l = list.length; i < l; i++) {\n                if (list[i] === listEntry) {\n                    list.splice(i, 1);\n                    break;\n                }\n            }\n\n            delete self._hashForUpdates[targetId];\n            ListEntry.put(listEntry);\n            HashUpdateEntry.put(element);\n        }\n    },\n\n    _priorityIn: function (ppList, listElement, priority) {\n        for (var i = 0; i < ppList.length; i++){\n            if (priority < ppList[i].priority) {\n                ppList.splice(i, 0, listElement);\n                return;\n            }\n        }\n        ppList.push(listElement);\n    },\n\n    _appendIn: function (ppList, listElement) {\n        ppList.push(listElement);\n    },\n\n    //-----------------------public method-------------------------\n    /**\n     * !#en This method should be called for any target which needs to schedule tasks, and this method should be called before any scheduler API usage.\n     * This method will add a `_id` property if it doesn't exist.\n     * !#zh 任何需要用 Scheduler 管理任务的对象主体都应该调用这个方法，并且应该在调用任何 Scheduler API 之前调用这个方法。\n     * 这个方法会给对象添加一个 `_id` 属性，如果这个属性不存在的话。\n     * @method enableForTarget\n     * @param {Object} target\n     */\n    enableForTarget: function (target) {\n        if (!target._id) {\n            if (target.__instanceId) {\n                cc.warnID(1513);\n            }\n            else {\n                target._id = idGenerater.getNewId();\n            }\n        }\n    },\n\n    /**\n     * !#en\n     * Modifies the time of all scheduled callbacks.<br/>\n     * You can use this property to create a 'slow motion' or 'fast forward' effect.<br/>\n     * Default is 1.0. To create a 'slow motion' effect, use values below 1.0.<br/>\n     * To create a 'fast forward' effect, use values higher than 1.0.<br/>\n     * Note：It will affect EVERY scheduled selector / action.\n     * !#zh\n     * 设置时间间隔的缩放比例。<br/>\n     * 您可以使用这个方法来创建一个 “slow motion（慢动作）” 或 “fast forward（快进）” 的效果。<br/>\n     * 默认是 1.0。要创建一个 “slow motion（慢动作）” 效果,使用值低于 1.0。<br/>\n     * 要使用 “fast forward（快进）” 效果，使用值大于 1.0。<br/>\n     * 注意：它影响该 Scheduler 下管理的所有定时器。\n     * @method setTimeScale\n     * @param {Number} timeScale\n     */\n    setTimeScale: function (timeScale) {\n        this._timeScale = timeScale;\n    },\n\n    /**\n     * !#en Returns time scale of scheduler.\n     * !#zh 获取时间间隔的缩放比例。\n     * @method getTimeScale\n     * @return {Number}\n     */\n    getTimeScale: function () {\n        return this._timeScale;\n    },\n\n    /**\n     * !#en 'update' the scheduler. (You should NEVER call this method, unless you know what you are doing.)\n     * !#zh update 调度函数。(不应该直接调用这个方法，除非完全了解这么做的结果)\n     * @method update\n     * @param {Number} dt delta time\n     */\n    update: function (dt) {\n        this._updateHashLocked = true;\n        if(this._timeScale !== 1)\n            dt *= this._timeScale;\n\n        var i, list, len, entry;\n\n        for(i=0,list=this._updatesNegList, len = list.length; i<len; i++){\n            entry = list[i];\n            if (!entry.paused && !entry.markedForDeletion)\n                entry.target.update(dt);\n        }\n\n        for(i=0, list=this._updates0List, len=list.length; i<len; i++){\n            entry = list[i];\n            if (!entry.paused && !entry.markedForDeletion)\n                entry.target.update(dt);\n        }\n\n        for(i=0, list=this._updatesPosList, len=list.length; i<len; i++){\n            entry = list[i];\n            if (!entry.paused && !entry.markedForDeletion)\n                entry.target.update(dt);\n        }\n\n        // Iterate over all the custom selectors\n        var elt, arr = this._arrayForTimers;\n        for(i=0; i<arr.length; i++){\n            elt = arr[i];\n            this._currentTarget = elt;\n            this._currentTargetSalvaged = false;\n\n            if (!elt.paused){\n                // The 'timers' array may change while inside this loop\n                for (elt.timerIndex = 0; elt.timerIndex < elt.timers.length; ++(elt.timerIndex)){\n                    elt.currentTimer = elt.timers[elt.timerIndex];\n                    elt.currentTimerSalvaged = false;\n\n                    elt.currentTimer.update(dt);\n                    elt.currentTimer = null;\n                }\n            }\n\n            // only delete currentTarget if no actions were scheduled during the cycle (issue #481)\n            if (this._currentTargetSalvaged && this._currentTarget.timers.length === 0) {\n                this._removeHashElement(this._currentTarget);\n                --i;\n            }\n        }\n\n        // delete all updates that are marked for deletion\n        // updates with priority < 0\n        for(i=0,list=this._updatesNegList; i<list.length; ){\n            entry = list[i];\n            if(entry.markedForDeletion)\n                this._removeUpdateFromHash(entry);\n            else\n                i++;\n        }\n\n        for(i=0, list=this._updates0List; i<list.length; ){\n            entry = list[i];\n            if (entry.markedForDeletion)\n                this._removeUpdateFromHash(entry);\n            else\n                i++;\n        }\n\n        for(i=0, list=this._updatesPosList; i<list.length; ){\n            entry = list[i];\n            if (entry.markedForDeletion)\n                this._removeUpdateFromHash(entry);\n            else\n                i++;\n        }\n\n        this._updateHashLocked = false;\n        this._currentTarget = null;\n    },\n\n    /**\n     * !#en\n     * <p>\n     *   The scheduled method will be called every 'interval' seconds.<br/>\n     *   If paused is YES, then it won't be called until it is resumed.<br/>\n     *   If 'interval' is 0, it will be called every frame, but if so, it recommended to use 'scheduleUpdateForTarget:' instead.<br/>\n     *   If the callback function is already scheduled, then only the interval parameter will be updated without re-scheduling it again.<br/>\n     *   repeat let the action be repeated repeat + 1 times, use cc.macro.REPEAT_FOREVER to let the action run continuously<br/>\n     *   delay is the amount of time the action will wait before it'll start<br/>\n     * </p>\n     * !#zh\n     * 指定回调函数，调用对象等信息来添加一个新的定时器。<br/>\n     * 如果 paused 值为 true，那么直到 resume 被调用才开始计时。<br/>\n     * 当时间间隔达到指定值时，设置的回调函数将会被调用。<br/>\n     * 如果 interval 值为 0，那么回调函数每一帧都会被调用，但如果是这样，\n     * 建议使用 scheduleUpdateForTarget 代替。<br/>\n     * 如果回调函数已经被定时器使用，那么只会更新之前定时器的时间间隔参数，不会设置新的定时器。<br/>\n     * repeat 值可以让定时器触发 repeat + 1 次，使用 cc.macro.REPEAT_FOREVER\n     * 可以让定时器一直循环触发。<br/>\n     * delay 值指定延迟时间，定时器会在延迟指定的时间之后开始计时。\n     * @method schedule\n     * @param {Function} callback\n     * @param {Object} target\n     * @param {Number} interval\n     * @param {Number} [repeat=cc.macro.REPEAT_FOREVER]\n     * @param {Number} [delay=0]\n     * @param {Boolean} paused\n     * @example {@link cocos2d/core/CCScheduler/schedule.js}\n     * @typescript\n     * schedule(callback: Function, target: any, interval: number, repeat: number, delay: number, paused?: boolean): void\n     * schedule(callback: Function, target: any, interval: number, paused?: boolean): void\n     */\n    schedule: function (callback, target, interval, repeat, delay, paused) {\n        'use strict';\n        if (typeof callback !== 'function') {\n            var tmp = callback;\n            callback = target;\n            target = tmp;\n        }\n        //selector, target, interval, repeat, delay, paused\n        //selector, target, interval, paused\n        if (arguments.length === 4 || arguments.length === 5) {\n            paused = !!repeat;\n            repeat = cc.macro.REPEAT_FOREVER;\n            delay = 0;\n        }\n\n        cc.assertID(target, 1502);\n\n        var targetId = target._id;\n        if (!targetId) {\n            if (target.__instanceId) {\n                cc.warnID(1513);\n                targetId = target._id = target.__instanceId;\n            }\n            else {\n                cc.errorID(1510);\n            }\n        }\n        var element = this._hashForTimers[targetId];\n        if (!element) {\n            // Is this the 1st element ? Then set the pause level to all the callback_fns of this target\n            element = HashTimerEntry.get(null, target, 0, null, null, paused);\n            this._arrayForTimers.push(element);\n            this._hashForTimers[targetId] = element;\n        } else if (element.paused !== paused) {\n            cc.warnID(1511);\n        }\n\n        var timer, i;\n        if (element.timers == null) {\n            element.timers = [];\n        }\n        else {\n            for (i = 0; i < element.timers.length; ++i) {\n                timer = element.timers[i];\n                if (timer && callback === timer._callback) {\n                    cc.logID(1507, timer.getInterval(), interval);\n                    timer._interval = interval;\n                    return;\n                }\n            }\n        }\n\n        timer = CallbackTimer.get();\n        timer.initWithCallback(this, callback, target, interval, repeat, delay);\n        element.timers.push(timer);\n\n        if (this._currentTarget === element && this._currentTargetSalvaged) {\n            this._currentTargetSalvaged = false;\n        }\n    },\n\n    /**\n     * !#en\n     * Schedules the update callback for a given target,\n     * During every frame after schedule started, the \"update\" function of target will be invoked.\n     * !#zh\n     * 使用指定的优先级为指定的对象设置 update 定时器。\n     * update 定时器每一帧都会被触发，触发时自动调用指定对象的 \"update\" 函数。\n     * 优先级的值越低，定时器被触发的越早。\n     * @method scheduleUpdate\n     * @param {Object} target\n     * @param {Number} priority\n     * @param {Boolean} paused\n     */\n    scheduleUpdate: function(target, priority, paused) {\n        var targetId = target._id;\n        if (!targetId) {\n            if (target.__instanceId) {\n                cc.warnID(1513);\n                targetId = target._id = target.__instanceId;\n            }\n            else {\n                cc.errorID(1510);\n            }\n        }\n        var hashElement = this._hashForUpdates[targetId];\n        if (hashElement && hashElement.entry){\n            // check if priority has changed\n            if (hashElement.entry.priority !== priority){\n                if (this._updateHashLocked){\n                    cc.logID(1506);\n                    hashElement.entry.markedForDeletion = false;\n                    hashElement.entry.paused = paused;\n                    return;\n                }else{\n                    // will be added again outside if (hashElement).\n                    this.unscheduleUpdate(target);\n                }\n            }else{\n                hashElement.entry.markedForDeletion = false;\n                hashElement.entry.paused = paused;\n                return;\n            }\n        }\n\n        var listElement = ListEntry.get(target, priority, paused, false);\n        var ppList;\n\n        // most of the updates are going to be 0, that's way there\n        // is an special list for updates with priority 0\n        if (priority === 0) {\n            ppList = this._updates0List;\n            this._appendIn(ppList, listElement);\n        }\n        else {\n            ppList = priority < 0 ? this._updatesNegList : this._updatesPosList;\n            this._priorityIn(ppList, listElement, priority);\n        }\n\n        //update hash entry for quick access\n        this._hashForUpdates[targetId] = HashUpdateEntry.get(ppList, listElement, target, null);\n    },\n\n    /**\n     * !#en\n     * Unschedules a callback for a callback and a given target.\n     * If you want to unschedule the \"update\", use `unscheduleUpdate()`\n     * !#zh\n     * 取消指定对象定时器。\n     * 如果需要取消 update 定时器，请使用 unscheduleUpdate()。\n     * @method unschedule\n     * @param {Function} callback The callback to be unscheduled\n     * @param {Object} target The target bound to the callback.\n     */\n    unschedule: function (callback, target) {\n        //callback, target\n\n        // explicity handle nil arguments when removing an object\n        if (!target || !callback)\n            return;\n        var targetId = target._id;\n        if (!targetId) {\n            if (target.__instanceId) {\n                cc.warnID(1513);\n                targetId = target._id = target.__instanceId;\n            }\n            else {\n                cc.errorID(1510);\n            }\n        }\n\n        var self = this, element = self._hashForTimers[targetId];\n        if (element) {\n            var timers = element.timers;\n            for(var i = 0, li = timers.length; i < li; i++){\n                var timer = timers[i];\n                if (callback === timer._callback) {\n                    if ((timer === element.currentTimer) && (!element.currentTimerSalvaged)) {\n                        element.currentTimerSalvaged = true;\n                    }\n                    timers.splice(i, 1);\n                    CallbackTimer.put(timer);\n                    //update timerIndex in case we are in tick;, looping over the actions\n                    if (element.timerIndex >= i) {\n                        element.timerIndex--;\n                    }\n\n                    if (timers.length === 0) {\n                        if (self._currentTarget === element) {\n                            self._currentTargetSalvaged = true;\n                        } else {\n                            self._removeHashElement(element);\n                        }\n                    }\n                    return;\n                }\n            }\n        }\n    },\n\n    /** \n     * !#en Unschedules the update callback for a given target.\n     * !#zh 取消指定对象的 update 定时器。\n     * @method unscheduleUpdate\n     * @param {Object} target The target to be unscheduled.\n     */\n    unscheduleUpdate: function (target) {\n        if (!target)\n            return;\n        var targetId = target._id;\n        if (!targetId) {\n            if (target.__instanceId) {\n                cc.warnID(1513);\n                targetId = target._id = target.__instanceId;\n            }\n            else {\n                cc.errorID(1510);\n            }\n        }\n\n        var element = this._hashForUpdates[targetId];\n        if (element) {\n            if (this._updateHashLocked) {\n                element.entry.markedForDeletion = true;\n            } else {\n                this._removeUpdateFromHash(element.entry);\n            }\n        }\n    },\n\n    /** \n     * !#en\n     * Unschedules all scheduled callbacks for a given target.\n     * This also includes the \"update\" callback.\n     * !#zh 取消指定对象的所有定时器，包括 update 定时器。\n     * @method unscheduleAllForTarget\n     * @param {Object} target The target to be unscheduled.\n     */\n    unscheduleAllForTarget: function (target) {\n        // explicit nullptr handling\n        if (!target){\n            return;\n        }\n        var targetId = target._id;\n        if (!targetId) {\n            if (target.__instanceId) {\n                cc.warnID(1513);\n                targetId = target._id = target.__instanceId;\n            }\n            else {\n                cc.errorID(1510);\n            }\n        }\n\n        // Custom Selectors\n        var element = this._hashForTimers[targetId];\n        if (element) {\n            var timers = element.timers;\n            if (timers.indexOf(element.currentTimer) > -1 && \n                (!element.currentTimerSalvaged)) {\n                element.currentTimerSalvaged = true;\n            }\n            for (var i = 0, l = timers.length; i < l; i++) {\n                CallbackTimer.put(timers[i]);\n            }\n            timers.length = 0;\n\n            if (this._currentTarget === element){\n                this._currentTargetSalvaged = true;\n            }else{\n                this._removeHashElement(element);\n            }\n        }\n\n        // update selector\n        this.unscheduleUpdate(target);\n    },\n\n    /**\n     * !#en\n     * Unschedules all scheduled callbacks from all targets including the system callbacks.<br/>\n     * You should NEVER call this method, unless you know what you are doing.\n     * !#zh\n     * 取消所有对象的所有定时器，包括系统定时器。<br/>\n     * 不用调用此函数，除非你确定你在做什么。\n     * @method unscheduleAll\n     */\n    unscheduleAll: function(){\n        this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM);\n    },\n\n    /**\n     * !#en\n     * Unschedules all callbacks from all targets with a minimum priority.<br/>\n     * You should only call this with `PRIORITY_NON_SYSTEM_MIN` or higher.\n     * !#zh\n     * 取消所有优先级的值大于指定优先级的定时器。<br/>\n     * 你应该只取消优先级的值大于 PRIORITY_NON_SYSTEM_MIN 的定时器。\n     * @method unscheduleAllWithMinPriority\n     * @param {Number} minPriority The minimum priority of selector to be unscheduled. Which means, all selectors which\n     *        priority is higher than minPriority will be unscheduled.\n     */\n    unscheduleAllWithMinPriority: function(minPriority){\n        // Custom Selectors\n        var i, element, arr = this._arrayForTimers;\n        for(i=arr.length-1; i>=0; i--){\n            element = arr[i];\n            this.unscheduleAllForTarget(element.target);\n        }\n\n        // Updates selectors\n        var entry;\n        var temp_length = 0;\n        if(minPriority < 0){\n            for(i=0; i<this._updatesNegList.length; ){\n                temp_length = this._updatesNegList.length;\n                entry = this._updatesNegList[i];\n                if(entry && entry.priority >= minPriority)\n                    this.unscheduleUpdate(entry.target);\n                if (temp_length == this._updatesNegList.length)\n                    i++;\n            }\n        }\n\n        if(minPriority <= 0){\n            for(i=0; i<this._updates0List.length; ){\n                temp_length = this._updates0List.length;\n                entry = this._updates0List[i];\n                if (entry)\n                    this.unscheduleUpdate(entry.target);\n                if (temp_length == this._updates0List.length)\n                    i++;\n            }\n        }\n\n        for(i=0; i<this._updatesPosList.length; ){\n            temp_length = this._updatesPosList.length;\n            entry = this._updatesPosList[i];\n            if(entry && entry.priority >= minPriority)\n                this.unscheduleUpdate(entry.target);\n            if (temp_length == this._updatesPosList.length)\n                i++;\n        }\n    },\n\n    /** \n     * !#en Checks whether a callback for a given target is scheduled.\n     * !#zh 检查指定的回调函数和回调对象组合是否存在定时器。\n     * @method isScheduled\n     * @param {Function} callback The callback to check.\n     * @param {Object} target The target of the callback.\n     * @return {Boolean} True if the specified callback is invoked, false if not.\n     */\n    isScheduled: function(callback, target){\n        //key, target\n        //selector, target\n        cc.assertID(callback, 1508);\n        cc.assertID(target, 1509);\n        var targetId = target._id;\n        if (!targetId) {\n            if (target.__instanceId) {\n                cc.warnID(1513);\n                targetId = target._id = target.__instanceId;\n            }\n            else {\n                cc.errorID(1510);\n            }\n        }\n        \n        var element = this._hashForTimers[targetId];\n\n        if (!element) {\n            return false;\n        }\n\n        if (element.timers == null){\n            return false;\n        }\n        else {\n            var timers = element.timers;\n            for (var i = 0; i < timers.length; ++i) {\n                var timer =  timers[i];\n\n                if (callback === timer._callback){\n                    return true;\n                }\n            }\n            return false;\n        }\n    },\n\n    /**\n     * !#en\n     * Pause all selectors from all targets.<br/>\n     * You should NEVER call this method, unless you know what you are doing.\n     * !#zh\n     * 暂停所有对象的所有定时器。<br/>\n     * 不要调用这个方法，除非你知道你正在做什么。\n     * @method pauseAllTargets\n     */\n    pauseAllTargets: function () {\n        return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM);\n    },\n\n    /**\n     * !#en\n     * Pause all selectors from all targets with a minimum priority. <br/>\n     * You should only call this with kCCPriorityNonSystemMin or higher.\n     * !#zh\n     * 暂停所有优先级的值大于指定优先级的定时器。<br/>\n     * 你应该只暂停优先级的值大于 PRIORITY_NON_SYSTEM_MIN 的定时器。\n     * @method pauseAllTargetsWithMinPriority\n     * @param {Number} minPriority\n     */\n    pauseAllTargetsWithMinPriority: function (minPriority) {\n        var idsWithSelectors = [];\n\n        var self = this, element, locArrayForTimers = self._arrayForTimers;\n        var i, li;\n        // Custom Selectors\n        for(i = 0, li = locArrayForTimers.length; i < li; i++){\n            element = locArrayForTimers[i];\n            if (element) {\n                element.paused = true;\n                idsWithSelectors.push(element.target);\n            }\n        }\n\n        var entry;\n        if(minPriority < 0){\n            for(i=0; i<this._updatesNegList.length; i++){\n                entry = this._updatesNegList[i];\n                if (entry) {\n                    if(entry.priority >= minPriority){\n                        entry.paused = true;\n                        idsWithSelectors.push(entry.target);\n                    }\n                }\n            }\n        }\n\n        if(minPriority <= 0){\n            for(i=0; i<this._updates0List.length; i++){\n                entry = this._updates0List[i];\n                if (entry) {\n                    entry.paused = true;\n                    idsWithSelectors.push(entry.target);\n                }\n            }\n        }\n\n        for(i=0; i<this._updatesPosList.length; i++){\n            entry = this._updatesPosList[i];\n            if (entry) {\n                if(entry.priority >= minPriority){\n                    entry.paused = true;\n                    idsWithSelectors.push(entry.target);\n                }\n            }\n        }\n\n        return idsWithSelectors;\n    },\n\n    /**\n     * !#en\n     * Resume selectors on a set of targets.<br/>\n     * This can be useful for undoing a call to pauseAllCallbacks.\n     * !#zh\n     * 恢复指定数组中所有对象的定时器。<br/>\n     * 这个函数是 pauseAllCallbacks 的逆操作。\n     * @method resumeTargets\n     * @param {Array} targetsToResume\n     */\n    resumeTargets: function (targetsToResume) {\n        if (!targetsToResume)\n            return;\n\n        for (var i = 0; i < targetsToResume.length; i++) {\n            this.resumeTarget(targetsToResume[i]);\n        }\n    },\n\n    /**\n     * !#en\n     * Pauses the target.<br/>\n     * All scheduled selectors/update for a given target won't be 'ticked' until the target is resumed.<br/>\n     * If the target is not present, nothing happens.\n     * !#zh\n     * 暂停指定对象的定时器。<br/>\n     * 指定对象的所有定时器都会被暂停。<br/>\n     * 如果指定的对象没有定时器，什么也不会发生。\n     * @method pauseTarget\n     * @param {Object} target\n     */\n    pauseTarget: function (target) {\n        cc.assertID(target, 1503);\n        var targetId = target._id;\n        if (!targetId) {\n            if (target.__instanceId) {\n                cc.warnID(1513);\n                targetId = target._id = target.__instanceId;\n            }\n            else {\n                cc.errorID(1510);\n            }\n        }\n\n        //customer selectors\n        var self = this, \n            element = self._hashForTimers[targetId];\n        if (element) {\n            element.paused = true;\n        }\n\n        //update callback\n        var elementUpdate = self._hashForUpdates[targetId];\n        if (elementUpdate) {\n            elementUpdate.entry.paused = true;\n        }\n    },\n\n    /**\n     * !#en\n     * Resumes the target.<br/>\n     * The 'target' will be unpaused, so all schedule selectors/update will be 'ticked' again.<br/>\n     * If the target is not present, nothing happens.\n     * !#zh\n     * 恢复指定对象的所有定时器。<br/>\n     * 指定对象的所有定时器将继续工作。<br/>\n     * 如果指定的对象没有定时器，什么也不会发生。\n     * @method resumeTarget\n     * @param {Object} target\n     */\n    resumeTarget: function (target) {\n        cc.assertID(target, 1504);\n        var targetId = target._id;\n        if (!targetId) {\n            if (target.__instanceId) {\n                cc.warnID(1513);\n                targetId = target._id = target.__instanceId;\n            }\n            else {\n                cc.errorID(1510);\n            }\n        }\n\n        // custom selectors\n        var self = this,\n            element = self._hashForTimers[targetId];\n        if (element) {\n            element.paused = false;\n        }\n\n        //update callback\n        var elementUpdate = self._hashForUpdates[targetId];\n        if (elementUpdate) {\n            elementUpdate.entry.paused = false;\n        }\n    },\n\n    /**\n     * !#en Returns whether or not the target is paused.\n     * !#zh 返回指定对象的定时器是否暂停了。\n     * @method isTargetPaused\n     * @param {Object} target\n     * @return {Boolean}\n     */\n    isTargetPaused: function (target) {\n        cc.assertID(target, 1505);\n        var targetId = target._id;\n        if (!targetId) {\n            if (target.__instanceId) {\n                cc.warnID(1513);\n                targetId = target._id = target.__instanceId;\n            }\n            else {\n                cc.errorID(1510);\n            }\n        }\n\n        // Custom selectors\n        var element = this._hashForTimers[targetId];\n        if (element) {\n            return element.paused;\n        }\n        var elementUpdate = this._hashForUpdates[targetId];\n        if (elementUpdate) {\n            return elementUpdate.entry.paused;\n        }\n        return false;\n    },\n};\n\n/**\n * !#en Priority level reserved for system services.\n * !#zh 系统服务的优先级。\n * @property PRIORITY_SYSTEM\n * @type {Number}\n * @static\n */\ncc.Scheduler.PRIORITY_SYSTEM = 1 << 31;\n\n/**\n * !#en Minimum priority level for user scheduling.\n * !#zh 用户调度最低优先级。\n * @property PRIORITY_NON_SYSTEM\n * @type {Number}\n * @static\n */\ncc.Scheduler.PRIORITY_NON_SYSTEM = cc.Scheduler.PRIORITY_SYSTEM + 1;\n\nmodule.exports = cc.Scheduler;","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar RawAsset = require('./CCRawAsset');\n\n/**\n * !#en\n * Base class for handling assets used in Creator.<br/>\n *\n * You may want to override:<br/>\n * - createNode<br/>\n * - getset functions of _nativeAsset<br/>\n * - cc.Object._serialize<br/>\n * - cc.Object._deserialize<br/>\n * !#zh\n * Creator 中的资源基类。<br/>\n *\n * 您可能需要重写：<br/>\n * - createNode <br/>\n * - _nativeAsset 的 getset 方法<br/>\n * - cc.Object._serialize<br/>\n * - cc.Object._deserialize<br/>\n *\n * @class Asset\n * @extends RawAsset\n */\ncc.Asset = cc.Class({\n    name: 'cc.Asset', extends: RawAsset,\n\n    ctor () {\n        /**\n         * !#en\n         * Whether the asset is loaded or not\n         * !#zh\n         * 该资源是否已经成功加载\n         *\n         * @property loaded\n         * @type {Boolean}\n         */\n        this.loaded = true;\n\n        /**\n         * !#en\n         * Points to the true url of this asset's native object, only valid when asset is loaded and asyncLoadAsset is not enabled.\n         * The difference between nativeUrl and url is that the latter is final path, there is no needs to transform url by md5 and subpackage. \n         * Besides, url may points to temporary path or cached path on mini game platform which has cache mechanism (WeChat etc).\n         * If you want to make use of the native file on those platforms, you should use url instead of nativeUrl.\n         * \n         * !#zh\n         * 资源的原生文件的真实url，只在资源被加载后以及没有启用延迟加载时才有效。 nativeUrl 与 url 的区别在于，url 是资源最终路径，所以 url 不需要再经过 md5 以及子包的路径转换，\n         * 另外某些带缓存机制的小游戏平台（微信等）上url可能会指向临时文件路径或者缓存路径，如果你需要在这些平台上使用资源的原生文件，请使用url，避免使用nativeUrl\n         * @property url\n         * @type {String}\n         */\n        this.url = '';\n    },\n\n    properties: {\n        /**\n         * !#en\n         * Returns the url of this asset's native object, if none it will returns an empty string.\n         * !#zh\n         * 返回该资源对应的目标平台资源的 URL，如果没有将返回一个空字符串。\n         * @property nativeUrl\n         * @type {String}\n         * @readOnly\n         */\n        nativeUrl: {\n            get: function () {\n                if (this._native) {\n                    var name = this._native;\n                    if (name.charCodeAt(0) === 47) {    // '/'\n                        // remove library tag\n                        // not imported in library, just created on-the-fly\n                        return name.slice(1);\n                    }\n                    if (cc.AssetLibrary) {\n                        var base = cc.AssetLibrary.getLibUrlNoExt(this._uuid, true);\n                        if (name.charCodeAt(0) === 46) {  // '.'\n                            // imported in dir where json exist\n                            return base + name;\n                        }\n                        else {\n                            // imported in an independent dir\n                            return base + '/' + name;\n                        }\n                    }\n                    else {\n                        cc.errorID(6400);\n                    }\n                }\n                return '';\n            },\n            visible: false\n        },\n\n        /**\n         * Serializable url for native asset.\n         * @property {String} _native\n         * @default undefined\n         * @private\n         */\n        _native: \"\",\n\n        /**\n         * The underlying native asset of this asset if one is available.\n         * This property can be used to access additional details or functionality releated to the asset.\n         * This property will be initialized by the loader if `_native` is available.\n         * @property {Object} _nativeAsset\n         * @default null\n         * @private\n         */\n        _nativeAsset: {\n            get () {\n                return this._$nativeAsset;\n            },\n            set (obj) {\n                this._$nativeAsset = obj;\n            }\n        },\n    },\n\n    statics: {\n        /**\n         * 应 AssetDB 要求提供这个方法\n         *\n         * @method deserialize\n         * @param {String} data\n         * @return {Asset}\n         * @static\n         * @private\n         */\n        deserialize: CC_EDITOR && function (data) {\n            return cc.deserialize(data);\n        },\n\n        /**\n         * !#en Indicates whether its dependent raw assets can support deferred load if the owner scene (or prefab) is marked as `asyncLoadAssets`.\n         * !#zh 当场景或 Prefab 被标记为 `asyncLoadAssets`，禁止延迟加载该资源所依赖的其它 RawAsset。\n         *\n         * @property {Boolean} preventDeferredLoadDependents\n         * @default false\n         * @static\n         */\n        preventDeferredLoadDependents: false,\n\n        /**\n         * !#en Indicates whether its native object should be preloaded from native url.\n         * !#zh 禁止预加载原生对象。\n         *\n         * @property {Boolean} preventPreloadNativeObject\n         * @default false\n         * @static\n         */\n        preventPreloadNativeObject: false\n    },\n\n    /**\n     * Returns the asset's url.\n     *\n     * The `Asset` object overrides the `toString()` method of the `Object` object.\n     * For `Asset` objects, the toString() method returns a string representation of the object.\n     * JavaScript calls the toString() method automatically when an asset is to be represented as a text value or when a texture is referred to in a string concatenation.\n     *\n     * @method toString\n     * @return {String}\n     */\n    toString () {\n        return this.nativeUrl;\n    },\n\n    /**\n     * 应 AssetDB 要求提供这个方法\n     *\n     * @method serialize\n     * @return {String}\n     * @private\n     */\n    serialize: CC_EDITOR && function () {\n        return Editor.serialize(this);\n    },\n\n    /**\n     * !#en\n     * Create a new node using this asset in the scene.<br/>\n     * If this type of asset dont have its corresponding node type, this method should be null.\n     * !#zh\n     * 使用该资源在场景中创建一个新节点。<br/>\n     * 如果这类资源没有相应的节点类型，该方法应该是空的。\n     *\n     * @method createNode\n     * @param {Function} callback\n     * @param {String} callback.error - null or the error info\n     * @param {Object} callback.node - the created node or null\n     */\n    createNode: null,\n\n    /**\n     * Set native file name for this asset.\n     * @seealso nativeUrl\n     *\n     * @method _setRawAsset\n     * @param {String} filename\n     * @param {Boolean} [inLibrary=true]\n     * @private\n     */\n    _setRawAsset: function (filename, inLibrary) {\n        if (inLibrary !== false) {\n            this._native = filename || undefined;\n        }\n        else {\n            this._native = '/' + filename;  // simply use '/' to tag location where is not in the library\n        }\n    }\n});\n\nmodule.exports = cc.Asset;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst Asset = require('./CCAsset');\nconst EventTarget = require('../event/event-target');\n\nvar LoadMode = cc.Enum({\n    WEB_AUDIO: 0,\n    DOM_AUDIO: 1,\n});\n\n/**\n * !#en Class for audio data handling.\n * !#zh 音频资源类。\n * @class AudioClip\n * @extends Asset\n * @uses EventTarget\n */\nvar AudioClip = cc.Class({\n    name: 'cc.AudioClip',\n    extends: Asset,\n    mixins: [EventTarget],\n\n    ctor () {\n        this.loaded = false;\n\n        // the web audio buffer or <audio> element\n        this._audio = null;\n    },\n\n    properties: {\n        loadMode: {\n            default: LoadMode.WEB_AUDIO,\n            type: LoadMode\n        },\n        _nativeAsset: {\n            get () {\n                return this._audio;\n            },\n            set (value) {\n                // HACK: fix load mp3 as audioClip, _nativeAsset is set as audioClip.\n                // Should load mp3 as audioBuffer indeed.\n                if (value instanceof cc.AudioClip) {\n                    this._audio = value._nativeAsset;\n                }\n                else {\n                    this._audio = value;\n                }\n                if (this._audio) {\n                    this.loaded = true;\n                    this.emit('load');\n                }\n            },\n            override: true\n        }\n    },\n\n    statics: {\n        LoadMode: LoadMode,\n        _loadByUrl: function (url, callback) {\n            var item = cc.loader.getItem(url) || cc.loader.getItem(url + '?useDom=1');\n            if (!item || !item.complete) {\n                cc.loader.load(url, function (error, downloadUrl) {\n                    if (error) {\n                        return callback(error);\n                    }\n                    item = cc.loader.getItem(url) || cc.loader.getItem(url + '?useDom=1');\n                    callback(null, item.content);\n                });\n            }\n            else {\n                if (item._owner instanceof AudioClip) {\n                    // preloaded and retained by audio clip\n                    callback(null, item._owner);\n                }\n                else {\n                    callback(null, item.content);\n                }\n            }\n        }\n    },\n\n    destroy () {\n        cc.audioEngine.uncache(this);\n        this._super();\n    }\n});\n\n/**\n * !#zh\n * 当该资源加载成功后触发该事件\n * !#en\n * This event is emitted when the asset is loaded\n *\n * @event load\n */\n\ncc.AudioClip = AudioClip;\nmodule.exports = AudioClip;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nlet FontLetterDefinition = function() {\n    this.u = 0;\n    this.v = 0;\n    this.w = 0;\n    this.h = 0;\n    this.offsetX = 0;\n    this.offsetY = 0;\n    this.textureID = 0;\n    this.valid = false;\n    this.xAdvance = 0;\n};\n\nlet FontAtlas = function (texture) {\n    this._letterDefinitions = {};\n    this._texture = texture;\n};\n\nFontAtlas.prototype = {\n    constructor: FontAtlas,\n    addLetterDefinitions (letter, letterDefinition) {\n        this._letterDefinitions[letter] = letterDefinition;\n    },\n    cloneLetterDefinition () {\n        let copyLetterDefinitions = {};\n        for (let key in this._letterDefinitions) {\n            let value = new FontLetterDefinition();\n            cc.js.mixin(value, this._letterDefinitions[key]);\n            copyLetterDefinitions[key] = value;\n        }\n        return copyLetterDefinitions;\n    },\n    getTexture () {\n        return this._texture;\n    },\n    getLetter (key) {\n        return this._letterDefinitions[key];\n    },\n    getLetterDefinitionForChar (char) {\n        let key = char.charCodeAt(0);\n        let hasKey = this._letterDefinitions.hasOwnProperty(key);\n        let letter;\n        if (hasKey) {\n            letter = this._letterDefinitions[key];\n        } else {\n            letter = null;\n        }\n        return letter;\n    },\n    clear () {\n        this._letterDefinitions = {};\n    }\n};\n\n/**\n * @module cc\n */\n/**\n * !#en Class for BitmapFont handling.\n * !#zh 位图字体资源类。\n * @class BitmapFont\n * @extends Font\n *\n */\nvar BitmapFont = cc.Class({\n    name: 'cc.BitmapFont',\n    extends: cc.Font,\n\n    properties: {\n        fntDataStr: {\n            default: ''\n        },\n\n        spriteFrame: {\n            default: null,\n            type: cc.SpriteFrame\n        },\n\n        fontSize: {\n            default: -1\n        },\n        //用来缓存 BitmapFont 解析之后的数据\n        _fntConfig: null,\n        _fontDefDictionary: null\n    },\n\n    onLoad () {\n        let spriteFrame = this.spriteFrame;\n        if (!this._fontDefDictionary && spriteFrame) {\n            this._fontDefDictionary = new FontAtlas(spriteFrame._texture);\n        }\n\n        let fntConfig = this._fntConfig;\n        if (!fntConfig) {\n            return;\n        }\n        let fontDict = fntConfig.fontDefDictionary;\n        for (let fontDef in fontDict) {\n            let letter = new FontLetterDefinition();\n\n            let rect = fontDict[fontDef].rect;\n            letter.offsetX = fontDict[fontDef].xOffset;\n            letter.offsetY = fontDict[fontDef].yOffset;\n            letter.w = rect.width;\n            letter.h = rect.height;\n            letter.u = rect.x;\n            letter.v = rect.y;\n            //FIXME: only one texture supported for now\n            letter.textureID = 0;\n            letter.valid = true;\n            letter.xAdvance = fontDict[fontDef].xAdvance;\n\n            this._fontDefDictionary.addLetterDefinitions(fontDef, letter);\n        }\n    }\n});\n\ncc.BitmapFont = BitmapFont;\ncc.BitmapFont.FontLetterDefinition = FontLetterDefinition;\ncc.BitmapFont.FontAtlas = FontAtlas;\nmodule.exports = BitmapFont;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos.com\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * @class BufferAsset\n * @extends Asset\n */\nvar BufferAsset = cc.Class({\n    name: 'cc.BufferAsset',\n    extends: cc.Asset,\n\n    ctor () {\n        this._buffer = null;\n    },\n\n    properties: {\n        _nativeAsset: {\n            get () {\n                return this._buffer;\n            },\n            set (bin) {\n                this._buffer = bin.buffer || bin;\n            },\n            override: true\n        },\n        buffer () {\n            return this._buffer;\n        }\n    }\n});\n\ncc.BufferAsset = module.exports = BufferAsset;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#en Class for Font handling.\n * !#zh 字体资源类。\n * @class Font\n * @extends Asset\n */\nvar Font = cc.Class({\n    name: 'cc.Font',\n    extends: cc.Asset\n});\n\ncc.Font = module.exports = Font;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#en\n * Class for JSON file. When the JSON file is loaded, this object is returned.\n * The parsed JSON object can be accessed through the `json` attribute in it.<br>\n * If you want to get the original JSON text, you should modify the extname to `.txt`\n * so that it is loaded as a `TextAsset` instead of a `JsonAsset`.\n *\n * !#zh\n * JSON 资源类。JSON 文件加载后，将会返回该对象。可以通过其中的 `json` 属性访问解析后的 JSON 对象。<br>\n * 如果你想要获得 JSON 的原始文本，那么应该修改源文件的后缀为 `.txt`，这样就会加载为一个 `TextAsset` 而不是 `JsonAsset`。\n *\n * @class JsonAsset\n * @extends Asset\n */\nvar JsonAsset = cc.Class({\n    name: 'cc.JsonAsset',\n    extends: cc.Asset,\n    properties: {\n        /**\n         * @property {Object} json - The loaded JSON object.\n         */\n        json: null,\n    },\n});\n\nmodule.exports = cc.JsonAsset = JsonAsset;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * @module cc\n */\n/**\n * !#en Class for LabelAtlas handling.\n * !#zh 艺术数字字体资源类。\n * @class LabelAtlas\n * @extends BitmapFont\n *\n */\nvar LabelAtlas = cc.Class({\n    name: 'cc.LabelAtlas',\n    extends: cc.BitmapFont,\n\n    onLoad () {\n        if (!this.spriteFrame) {\n            cc.warnID(9100, this.name);\n            return;\n        }\n        if (!this._fntConfig) {\n            cc.warnID(9101, this.name);\n            return;\n        }\n        this._super();\n    }\n\n});\n\ncc.LabelAtlas = LabelAtlas;\nmodule.exports = LabelAtlas;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#zh\n * Prefab 创建实例所用的优化策略，配合 {{#crossLink \"Prefab.optimizationPolicy\"}}cc.Prefab#optimizationPolicy{{/crossLink}} 使用。\n * !#en\n * An enumeration used with the {{#crossLink \"Prefab.optimizationPolicy\"}}cc.Prefab#optimizationPolicy{{/crossLink}}\n * to specify how to optimize the instantiate operation.\n *\n * @enum Prefab.OptimizationPolicy\n * @since 1.10.0\n */\nvar OptimizationPolicy = cc.Enum({\n    /**\n     * !#zh\n     * 根据创建次数自动调整优化策略。初次创建实例时，行为等同 SINGLE_INSTANCE，多次创建后将自动采用 MULTI_INSTANCE。\n     * !#en\n     * The optimization policy is automatically chosen based on the number of instantiations.\n     * When you first create an instance, the behavior is the same as SINGLE_INSTANCE. MULTI_INSTANCE will be automatically used after multiple creation.\n     * @property {Number} AUTO\n     */\n    AUTO: 0,\n    /**\n     * !#zh\n     * 优化单次创建性能。<br>\n     * 该选项会跳过针对这个 prefab 的代码生成优化操作。当该 prefab 加载后，一般只会创建一个实例时，请选择此项。\n     * !#en\n     * Optimize for single instance creation.<br>\n     * This option skips code generation for this prefab.\n     * When this prefab will usually create only one instances, please select this option.\n     * @property {Number} SINGLE_INSTANCE\n     */\n    SINGLE_INSTANCE: 1,\n    /**\n     * !#zh\n     * 优化多次创建性能。<br>\n     * 该选项会启用针对这个 prefab 的代码生成优化操作。当该 prefab 加载后，一般会创建多个实例时，请选择此项。如果该 prefab 在场景中的节点启用了自动关联，并且在场景中有多份实例，也建议选择此项。\n     * !#en\n     * Optimize for creating instances multiple times.<br>\n     * This option enables code generation for this prefab.\n     * When this prefab will usually create multiple instances, please select this option.\n     * It is also recommended to select this option if the prefab instance in the scene has Auto Sync enabled and there are multiple instances in the scene.\n     * @property {Number} MULTI_INSTANCE\n     */\n    MULTI_INSTANCE: 2,\n});\n\n/**\n * !#en Class for prefab handling.\n * !#zh 预制资源类。\n * @class Prefab\n * @extends Asset\n */\nvar Prefab = cc.Class({\n    name: 'cc.Prefab',\n    extends: cc.Asset,\n    ctor () {\n        /**\n         * Cache function to optimize instance creaton.\n         * @property {Function} _createFunction\n         * @private\n         */\n        this._createFunction = null;\n\n        this._instantiatedTimes = 0;\n    },\n\n    properties: {\n        /**\n         * @property {Node} data - the main cc.Node in the prefab\n         */\n        data: null,\n\n        /**\n         * !#zh\n         * 设置实例化这个 prefab 时所用的优化策略。根据使用情况设置为合适的值，能优化该 prefab 实例化所用的时间。\n         * !#en\n         * Indicates the optimization policy for instantiating this prefab.\n         * Set to a suitable value based on usage, can optimize the time it takes to instantiate this prefab.\n         *\n         * @property {Prefab.OptimizationPolicy} optimizationPolicy\n         * @default Prefab.OptimizationPolicy.AUTO\n         * @since 1.10.0\n         * @example\n         * prefab.optimizationPolicy = cc.Prefab.OptimizationPolicy.MULTI_INSTANCE;\n         */\n        optimizationPolicy: OptimizationPolicy.AUTO,\n\n        /**\n         * !#en Indicates the raw assets of this prefab can be load after prefab loaded.\n         * !#zh 指示该 Prefab 依赖的资源可否在 Prefab 加载后再延迟加载。\n         * @property {Boolean} asyncLoadAssets\n         * @default false\n         */\n        asyncLoadAssets: false,\n\n        /**\n         * @property {Boolean} readonly\n         * @default false\n         */\n        readonly: {\n            default: false,\n            editorOnly: true\n        }\n    },\n\n    statics: {\n        OptimizationPolicy,\n        OptimizationPolicyThreshold: 3,\n    },\n\n    createNode: CC_EDITOR && function (cb) {\n        var node = cc.instantiate(this);\n        node.name = this.name;\n        cb(null, node);\n    },\n\n    /**\n     * Dynamically translation prefab data into minimized code.<br/>\n     * This method will be called automatically before the first time the prefab being instantiated,\n     * but you can re-call to refresh the create function once you modified the original prefab data in script.\n     * @method compileCreateFunction\n     */\n    compileCreateFunction: function () {\n        var jit = require('../platform/instantiate-jit');\n        this._createFunction = jit.compile(this.data);\n    },\n\n    // just instantiate, will not initialize the Node, this will be called during Node's initialization.\n    // @param {Node} [rootToRedirect] - specify an instantiated prefabRoot that all references to prefabRoot in prefab\n    //                                  will redirect to\n    _doInstantiate: function (rootToRedirect) {\n        if (this.data._prefab) {\n            // prefab asset is always synced\n            this.data._prefab._synced = true;\n        }\n        else {\n            // temp guard code\n            cc.warnID(3700);\n        }\n        if (!this._createFunction) {\n            this.compileCreateFunction();\n        }\n        return this._createFunction(rootToRedirect);  // this.data._instantiate();\n    },\n\n    _instantiate: function () {\n        var node, useJit = false;\n        if (CC_SUPPORT_JIT) {\n            if (this.optimizationPolicy === OptimizationPolicy.SINGLE_INSTANCE) {\n                useJit = false;\n            }\n            else if (this.optimizationPolicy === OptimizationPolicy.MULTI_INSTANCE) {\n                useJit = true;\n            }\n            else {\n                // auto\n                useJit = (this._instantiatedTimes + 1) >= Prefab.OptimizationPolicyThreshold;\n            }\n        }\n        if (useJit) {\n            // instantiate node\n            node = this._doInstantiate();\n            // initialize node\n            this.data._instantiate(node);\n        }\n        else {\n            // prefab asset is always synced\n            this.data._prefab._synced = true;\n            // instantiate node\n            node = this.data._instantiate();\n        }\n        ++this._instantiatedTimes;\n\n        // link prefab in editor\n        if (CC_EDITOR || CC_TEST) {\n            var PrefabUtils = Editor.require('scene://utils/prefab');\n            // This operation is not necessary, but some old prefab asset may not contain complete data.\n            PrefabUtils.linkPrefab(this, node);\n        }\n        return node;\n    },\n\n    destroy () {\n        this.data && this.data.destroy();\n        this._super();\n    },\n});\n\ncc.Prefab = module.exports = Prefab;\ncc.js.obsolete(cc, 'cc._Prefab', 'Prefab');\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar CCObject = require('../platform/CCObject');\nvar js = require('../platform/js');\n\n/**\n * !#en\n * The base class for registering asset types.\n * !#zh\n * 注册用的资源基类。\n *\n * @class RawAsset\n * @extends Object\n */\ncc.RawAsset = cc.Class({\n    name: 'cc.RawAsset', extends: CCObject,\n\n    ctor: function () {\n        /**\n         * @property _uuid\n         * @type {String}\n         * @private\n         */\n        Object.defineProperty(this, '_uuid', {\n            value: '',\n            writable: true,\n            // enumerable is false by default, to avoid uuid being assigned to empty string during destroy\n        });\n    },\n});\n\n/**\n * @method isRawAssetType\n * @param {Function} ctor\n * @returns {Boolean}\n * @static\n * @private\n */\njs.value(cc.RawAsset, 'isRawAssetType', function (ctor) {\n    return js.isChildClassOf(ctor, cc.RawAsset) && !js.isChildClassOf(ctor, cc.Asset);\n});\n\n // TODO - DELME after 2.1\njs.value(cc.RawAsset, 'wasRawAssetType', function (ctor) {\n    return ctor === cc.Texture2D ||\n           ctor === cc.AudioClip ||\n           ctor === cc.ParticleAsset ||\n           ctor === cc.Asset;           // since 1.10, all raw asset will import as cc.Asset\n});\n\nmodule.exports = cc.RawAsset;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#en Class for scene handling.\n * !#zh 场景资源类。\n * @class SceneAsset\n * @extends Asset\n *\n */\nvar Scene = cc.Class({\n    name: 'cc.SceneAsset',\n    extends: cc.Asset,\n\n    properties: {\n\n        /**\n         * @property {Scene} scene\n         * @default null\n         */\n        scene: null,\n\n        /**\n         * !#en Indicates the raw assets of this scene can be load after scene launched.\n         * !#zh 指示该场景依赖的资源可否在场景切换后再延迟加载。\n         * @property {Boolean} asyncLoadAssets\n         * @default false\n         */\n        asyncLoadAssets: undefined,\n\n        //// backup prefab assets in editor\n        //// {string} assetUuid: {cc.Node} rootInPrefab\n        //_prefabDatas: {\n        //    default: null,\n        //    editorOnly: true\n        //}\n    },\n});\n\ncc.SceneAsset = Scene;\nmodule.exports = Scene;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#en Class for script handling.\n * !#zh Script 资源类。\n * @class _Script\n * @extends Asset\n *\n * @private\n */\nvar Script = cc.Class({\n    name: 'cc.Script',\n    extends: cc.Asset,\n});\n\ncc._Script = Script;\n\n/**\n * !#en Class for JavaScript handling.\n * !#zh JavaScript 资源类。\n * @class _JavaScript\n * @extends Asset\n * @private\n *\n */\nvar JavaScript = cc.Class({\n    name: 'cc.JavaScript',\n    extends: Script,\n});\n\ncc._JavaScript = JavaScript;\n\n/**\n * !#en Class for coffeescript handling.\n * !#zh CoffeeScript 资源类。\n * @class CoffeeScript\n * @extends Asset\n *\n */\nvar CoffeeScript = cc.Class({\n    name: 'cc.CoffeeScript',\n    extends: Script,\n});\n\ncc._CoffeeScript = CoffeeScript;\n\n/**\n * !#en Class for TypeScript handling.\n * !#zh TypeScript 资源类。\n * @class TypeScript\n * @extends Asset\n *\n */\nvar TypeScript = cc.Class({\n    name: 'cc.TypeScript',\n    extends: Script,\n});\n\ncc._TypeScript = TypeScript;","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#en Class for sprite atlas handling.\n * !#zh 精灵图集资源类。\n * @class SpriteAtlas\n * @extends Asset\n */\nvar SpriteAtlas = cc.Class({\n    name: 'cc.SpriteAtlas',\n    extends: cc.Asset,\n    properties: {\n        _spriteFrames: {\n            default: {}\n        },\n    },\n\n    /**\n     * Returns the texture of the sprite atlas\n     * @method getTexture\n     * @returns {Texture2D}\n     */\n    getTexture: function () {\n        var keys = Object.keys(this._spriteFrames);\n        if (keys.length > 0) {\n            var spriteFrame = this._spriteFrames[keys[0]];\n            return spriteFrame ? spriteFrame.getTexture() : null;\n        }\n        else {\n            return null;\n        }\n    },\n\n    /**\n     * Returns the sprite frame correspond to the given key in sprite atlas.\n     * @method getSpriteFrame\n     * @param {String} key\n     * @returns {SpriteFrame}\n     */\n    getSpriteFrame: function (key) {\n        let sf = this._spriteFrames[key];\n        if (!sf) {\n            return null;\n        } \n        if (!sf.name) {\n            sf.name = key;\n        }\n        return sf;\n    },\n\n    /**\n     * Returns the sprite frames in sprite atlas.\n     * @method getSpriteFrames\n     * @returns {[SpriteFrame]}\n     */\n    getSpriteFrames: function () {\n        var frames = [];\n        var spriteFrames = this._spriteFrames;\n\n        for (var key in spriteFrames) {\n            frames.push(this.getSpriteFrame(key));\n        }\n\n        return frames;\n    }\n});\n\ncc.SpriteAtlas = SpriteAtlas;\nmodule.exports =  SpriteAtlas;\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst EventTarget = require(\"../event/event-target\");\nconst textureUtil = require('../utils/texture-util');\n\nconst INSET_LEFT = 0;\nconst INSET_TOP = 1;\nconst INSET_RIGHT = 2;\nconst INSET_BOTTOM = 3;\n\nlet temp_uvs = [{u: 0, v: 0}, {u: 0, v: 0}, {u: 0, v: 0}, {u: 0, v: 0}];\n\n/**\n * !#en\n * A cc.SpriteFrame has:<br/>\n *  - texture: A cc.Texture2D that will be used by render components<br/>\n *  - rectangle: A rectangle of the texture\n *\n * !#zh\n * 一个 SpriteFrame 包含：<br/>\n *  - 纹理：会被渲染组件使用的 Texture2D 对象。<br/>\n *  - 矩形：在纹理中的矩形区域。\n *\n * @class SpriteFrame\n * @extends Asset\n * @uses EventTarget\n * @example\n * // load a cc.SpriteFrame with image path (Recommend)\n * var self = this;\n * var url = \"test assets/PurpleMonster\";\n * cc.loader.loadRes(url, cc.SpriteFrame, function (err, spriteFrame) {\n *  var node = new cc.Node(\"New Sprite\");\n *  var sprite = node.addComponent(cc.Sprite);\n *  sprite.spriteFrame = spriteFrame;\n *  node.parent = self.node\n * });\n */\nlet SpriteFrame = cc.Class(/** @lends cc.SpriteFrame# */{\n    name: 'cc.SpriteFrame',\n    extends: require('../assets/CCAsset'),\n    mixins: [EventTarget],\n\n    properties: {\n        // Use this property to set texture when loading dependency\n        _textureSetter: {\n            set: function (texture) {\n                if (texture) {\n                    if (CC_EDITOR && Editor.isBuilder) {\n                        // just building\n                        this._texture = texture;\n                        return;\n                    }\n                    if (this._texture !== texture) {\n                        this._refreshTexture(texture);\n                    }\n                    this._textureFilename = texture.url;\n                }\n            }\n        },\n\n        // _textureFilename: {\n        //     get () {\n        //         return (this._texture && this._texture.url) || \"\";\n        //     },\n        //     set (url) {\n        //         let texture = cc.textureCache.addImage(url);\n        //         this._refreshTexture(texture);\n        //     }\n        // },\n\n        /**\n         * !#en Top border of the sprite\n         * !#zh sprite 的顶部边框\n         * @property insetTop\n         * @type {Number}\n         * @default 0\n         */\n        insetTop: {\n            get: function () {\n                return this._capInsets[INSET_TOP];\n            },\n            set: function (value) {\n                this._capInsets[INSET_TOP] = value;\n                if (this._texture) {\n                    this._calculateSlicedUV();\n                }\n            }\n        },\n\n        /**\n         * !#en Bottom border of the sprite\n         * !#zh sprite 的底部边框\n         * @property insetBottom\n         * @type {Number}\n         * @default 0\n         */\n        insetBottom: {\n            get: function () {\n                return this._capInsets[INSET_BOTTOM];\n            },\n            set: function (value) {\n                this._capInsets[INSET_BOTTOM] = value;\n                if (this._texture) {\n                    this._calculateSlicedUV();\n                }\n            }\n        },\n\n        /**\n         * !#en Left border of the sprite\n         * !#zh sprite 的左边边框\n         * @property insetLeft\n         * @type {Number}\n         * @default 0\n         */\n        insetLeft: {\n            get: function () {\n                return this._capInsets[INSET_LEFT];\n            },\n            set: function (value) {\n                this._capInsets[INSET_LEFT] = value;\n                if (this._texture) {\n                    this._calculateSlicedUV();\n                }\n            }\n        },\n\n        /**\n         * !#en Right border of the sprite\n         * !#zh sprite 的左边边框\n         * @property insetRight\n         * @type {Number}\n         * @default 0\n         */\n        insetRight: {\n            get: function () {\n                return this._capInsets[INSET_RIGHT];\n            },\n            set: function (value) {\n                this._capInsets[INSET_RIGHT] = value;\n                if (this._texture) {\n                    this._calculateSlicedUV();\n                }\n            }\n        },\n    },\n\n    /**\n     * !#en\n     * Constructor of SpriteFrame class.\n     * !#zh\n     * SpriteFrame 类的构造函数。\n     * @method constructor\n     * @param {String|Texture2D} [filename]\n     * @param {Rect} [rect]\n     * @param {Boolean} [rotated] - Whether the frame is rotated in the texture\n     * @param {Vec2} [offset] - The offset of the frame in the texture\n     * @param {Size} [originalSize] - The size of the frame in the texture\n     */\n    ctor: function () {\n        // Init EventTarget data\n        EventTarget.call(this);\n\n        let filename = arguments[0];\n        let rect = arguments[1];\n        let rotated = arguments[2];\n        let offset = arguments[3];\n        let originalSize = arguments[4];\n\n        // the location of the sprite on rendering texture\n        this._rect = null;\n        // uv data of frame\n        this.uv = [];\n        // texture of frame\n        this._texture = null;\n        // store original info before packed to dynamic atlas\n        this._original = null;\n\n        // for trimming\n        this._offset = null;\n\n        // for trimming\n        this._originalSize = null;\n\n        this._rotated = false;\n\n        this._flipX = false;\n        this._flipY = false;\n\n        this.vertices = null;\n\n        this._capInsets = [0, 0, 0, 0];\n\n        this.uvSliced = [];\n\n        this._textureFilename = '';\n\n        if (CC_EDITOR) {\n            // Atlas asset uuid\n            this._atlasUuid = '';\n        }\n\n        if (filename !== undefined) {\n            this.setTexture(filename, rect, rotated, offset, originalSize);\n        } else {\n            //todo log Error\n        }\n    },\n\n    /**\n     * !#en Returns whether the texture have been loaded\n     * !#zh 返回是否已加载纹理\n     * @method textureLoaded\n     * @returns {boolean}\n     */\n    textureLoaded: function () {\n        return this._texture && this._texture.loaded;\n    },\n\n    onTextureLoaded (callback, target) {\n        if (this.textureLoaded()) {\n            callback.call(target);\n        }\n        else {\n            this.once('load', callback, target);\n            this.ensureLoadTexture();\n            return false;\n        }\n\n        return true;\n    },\n\n    /**\n     * !#en Returns whether the sprite frame is rotated in the texture.\n     * !#zh 获取 SpriteFrame 是否旋转\n     * @method isRotated\n     * @return {Boolean}\n     */\n    isRotated: function () {\n        return this._rotated;\n    },\n\n    /**\n     * !#en Set whether the sprite frame is rotated in the texture.\n     * !#zh 设置 SpriteFrame 是否旋转\n     * @method setRotated\n     * @param {Boolean} bRotated\n     */\n    setRotated: function (bRotated) {\n        this._rotated = bRotated;\n        if (this._texture)\n            this._calculateUV();\n    },\n\n    /**\n     * !#en Returns whether the sprite frame is flip x axis in the texture.\n     * !#zh 获取 SpriteFrame 是否反转 x 轴\n     * @method isFlipX\n     * @return {Boolean}\n     */\n    isFlipX: function () {\n        return this._flipX;\n    },\n\n    /**\n     * !#en Returns whether the sprite frame is flip y axis in the texture.\n     * !#zh 获取 SpriteFrame 是否反转 y 轴\n     * @method isFlipY\n     * @return {Boolean}\n     */\n    isFlipY: function () {\n        return this._flipY;\n    },\n\n    /**\n     * !#en Set whether the sprite frame is flip x axis in the texture.\n     * !#zh 设置 SpriteFrame 是否翻转 x 轴\n     * @method setFlipX\n     * @param {Boolean} flipX\n     */\n    setFlipX: function (flipX) {\n        this._flipX = flipX;\n        if (this._texture) {\n            this._calculateUV();\n        }\n    },\n\n    /**\n     * !#en Set whether the sprite frame is flip y axis in the texture.\n     * !#zh 设置 SpriteFrame 是否翻转 y 轴\n     * @method setFlipY\n     * @param {Boolean} flipY\n     */\n    setFlipY: function (flipY) {\n        this._flipY = flipY;\n        if (this._texture) {\n            this._calculateUV();\n        }\n    },\n\n    /**\n     * !#en Returns the rect of the sprite frame in the texture.\n     * !#zh 获取 SpriteFrame 的纹理矩形区域\n     * @method getRect\n     * @return {Rect}\n     */\n    getRect: function () {\n        return cc.rect(this._rect);\n    },\n\n    /**\n     * !#en Sets the rect of the sprite frame in the texture.\n     * !#zh 设置 SpriteFrame 的纹理矩形区域\n     * @method setRect\n     * @param {Rect} rect\n     */\n    setRect: function (rect) {\n        this._rect = rect;\n        if (this._texture)\n            this._calculateUV();\n    },\n    \n    /**\n     * !#en Returns the original size of the trimmed image.\n     * !#zh 获取修剪前的原始大小\n     * @method getOriginalSize\n     * @return {Size}\n     */\n    getOriginalSize: function () {\n        return cc.size(this._originalSize);\n    },\n\n    /**\n     * !#en Sets the original size of the trimmed image.\n     * !#zh 设置修剪前的原始大小\n     * @method setOriginalSize\n     * @param {Size} size\n     */\n    setOriginalSize: function (size) {\n        if (!this._originalSize) {\n            this._originalSize = cc.size(size);\n        } else {\n            this._originalSize.width = size.width;\n            this._originalSize.height = size.height;\n        }\n    },\n\n    /**\n     * !#en Returns the texture of the frame.\n     * !#zh 获取使用的纹理实例\n     * @method getTexture\n     * @return {Texture2D}\n     */\n    getTexture: function () {\n        return this._texture;\n    },\n\n    _textureLoadedCallback () {\n        let self = this;\n        let texture = this._texture;\n        if (!texture) {\n            // clearTexture called while loading texture...\n            return;\n        }\n        let w = texture.width, h = texture.height;\n\n        if (self._rect) {\n            self._checkRect(self._texture);\n        }\n        else {\n            self._rect = cc.rect(0, 0, w, h);\n        }\n\n        if (!self._originalSize) {\n            self.setOriginalSize(cc.size(w, h));\n        }\n\n        if (!self._offset) {\n            self.setOffset(cc.v2(0, 0));\n        }\n\n        self._calculateUV();\n\n        // dispatch 'load' event of cc.SpriteFrame\n        self.emit(\"load\");\n    },\n\n    /*\n     * !#en Sets the texture of the frame.\n     * !#zh 设置使用的纹理实例。\n     * @method _refreshTexture\n     * @param {Texture2D} texture\n     */\n    _refreshTexture: function (texture) {\n        this._texture = texture;\n        if (texture.loaded) {\n            this._textureLoadedCallback();\n        }\n        else {\n            texture.once('load', this._textureLoadedCallback, this);\n        }\n    },\n\n    /**\n     * !#en Returns the offset of the frame in the texture.\n     * !#zh 获取偏移量\n     * @method getOffset\n     * @return {Vec2}\n     */\n    getOffset: function () {\n        return cc.v2(this._offset);\n    },\n\n    /**\n     * !#en Sets the offset of the frame in the texture.\n     * !#zh 设置偏移量\n     * @method setOffset\n     * @param {Vec2} offsets\n     */\n    setOffset: function (offsets) {\n        this._offset = cc.v2(offsets);\n    },\n\n    /**\n     * !#en Clone the sprite frame.\n     * !#zh 克隆 SpriteFrame\n     * @method clone\n     * @return {SpriteFrame}\n     */\n    clone: function () {\n        return new SpriteFrame(this._texture || this._textureFilename, this._rect, this._rotated, this._offset, this._originalSize);\n    },\n\n    /**\n     * !#en Set SpriteFrame with Texture, rect, rotated, offset and originalSize.<br/>\n     * !#zh 通过 Texture，rect，rotated，offset 和 originalSize 设置 SpriteFrame。\n     * @method setTexture\n     * @param {String|Texture2D} textureOrTextureFile\n     * @param {Rect} [rect=null]\n     * @param {Boolean} [rotated=false]\n     * @param {Vec2} [offset=cc.v2(0,0)]\n     * @param {Size} [originalSize=rect.size]\n     * @return {Boolean}\n     */\n    setTexture: function (textureOrTextureFile, rect, rotated, offset, originalSize) {\n        if (rect) {\n            this._rect = rect;\n        }\n        else {\n            this._rect = null;\n        }\n\n        if (offset) {\n            this.setOffset(offset);\n        }\n        else {\n            this._offset = null;\n        }\n\n        if (originalSize) {\n            this.setOriginalSize(originalSize);\n        }\n        else {\n            this._originalSize = null;\n        }\n\n        this._rotated = rotated || false;\n\n        // loading texture\n        let texture = textureOrTextureFile;\n        if (typeof texture === 'string' && texture) {\n            this._textureFilename = texture;\n            this._loadTexture();\n        }\n        if (texture instanceof cc.Texture2D && this._texture !== texture) {\n            this._refreshTexture(texture);\n        }\n\n        return true;\n    },\n\n    _loadTexture: function () {\n        if (this._textureFilename) {\n            let texture = textureUtil.loadImage(this._textureFilename);\n            this._refreshTexture(texture);\n        }\n    },\n\n    /**\n     * !#en If a loading scene (or prefab) is marked as `asyncLoadAssets`, all the textures of the SpriteFrame which\n     * associated by user's custom Components in the scene, will not preload automatically.\n     * These textures will be load when Sprite component is going to render the SpriteFrames.\n     * You can call this method if you want to load the texture early.\n     * !#zh 当加载中的场景或 Prefab 被标记为 `asyncLoadAssets` 时，用户在场景中由自定义组件关联到的所有 SpriteFrame 的贴图都不会被提前加载。\n     * 只有当 Sprite 组件要渲染这些 SpriteFrame 时，才会检查贴图是否加载。如果你希望加载过程提前，你可以手工调用这个方法。\n     *\n     * @method ensureLoadTexture\n     * @example\n     * if (spriteFrame.textureLoaded()) {\n     *     this._onSpriteFrameLoaded();\n     * }\n     * else {\n     *     spriteFrame.once('load', this._onSpriteFrameLoaded, this);\n     *     spriteFrame.ensureLoadTexture();\n     * }\n     */\n    ensureLoadTexture: function () {\n        if (this._texture) {\n            if (!this._texture.loaded) {\n                // load exists texture\n                this._refreshTexture(this._texture);\n                textureUtil.postLoadTexture(this._texture);\n            }\n        }\n        else if (this._textureFilename) {\n            // load new texture\n            this._loadTexture();\n        }\n    },\n\n    /**\n     * !#en\n     * If you do not need to use the SpriteFrame temporarily, you can call this method so that its texture could be garbage collected. Then when you need to render the SpriteFrame, you should call `ensureLoadTexture` manually to reload texture.\n     * !#zh\n     * 当你暂时不再使用这个 SpriteFrame 时，可以调用这个方法来保证引用的贴图对象能被 GC。然后当你要渲染 SpriteFrame 时，你需要手动调用 `ensureLoadTexture` 来重新加载贴图。\n     * @method clearTexture\n     * @deprecated since 2.1\n     */\n\n    _checkRect: function (texture) {\n        let rect = this._rect;\n        let maxX = rect.x, maxY = rect.y;\n        if (this._rotated) {\n            maxX += rect.height;\n            maxY += rect.width;\n        }\n        else {\n            maxX += rect.width;\n            maxY += rect.height;\n        }\n        if (maxX > texture.width) {\n            cc.errorID(3300, texture.url + '/' + this.name, maxX, texture.width);\n        }\n        if (maxY > texture.height) {\n            cc.errorID(3400, texture.url + '/' + this.name, maxY, texture.height);\n        }\n    },\n\n    _flipXY (uvs) {\n        if (this._flipX) {\n            let tempVal = uvs[0];\n            uvs[0] = uvs[1];\n            uvs[1] = tempVal;\n\n            tempVal = uvs[2];\n            uvs[2] = uvs[3];\n            uvs[3] = tempVal;\n        }\n\n        if (this._flipY) {\n            let tempVal = uvs[0];\n            uvs[0] = uvs[2];\n            uvs[2] = tempVal;\n\n            tempVal = uvs[1];\n            uvs[1] = uvs[3];\n            uvs[3] = tempVal;\n        }\n    },\n\n    _calculateSlicedUV () {\n        let rect = this._rect;\n        let atlasWidth = this._texture.width;\n        let atlasHeight = this._texture.height;\n        let leftWidth = this._capInsets[INSET_LEFT];\n        let rightWidth = this._capInsets[INSET_RIGHT];\n        let centerWidth = rect.width - leftWidth - rightWidth;\n        let topHeight = this._capInsets[INSET_TOP];\n        let bottomHeight = this._capInsets[INSET_BOTTOM];\n        let centerHeight = rect.height - topHeight - bottomHeight;\n\n        let uvSliced = this.uvSliced;\n        uvSliced.length = 0;\n        if (this._rotated) {\n            temp_uvs[0].u = (rect.x) / atlasWidth;\n            temp_uvs[1].u = (rect.x + bottomHeight) / atlasWidth;\n            temp_uvs[2].u = (rect.x + bottomHeight + centerHeight) / atlasWidth;\n            temp_uvs[3].u = (rect.x + rect.height) / atlasWidth;\n            temp_uvs[3].v = (rect.y) / atlasHeight;\n            temp_uvs[2].v = (rect.y + leftWidth) / atlasHeight;\n            temp_uvs[1].v = (rect.y + leftWidth + centerWidth) / atlasHeight;\n            temp_uvs[0].v = (rect.y + rect.width) / atlasHeight;\n\n            this._flipXY(temp_uvs);\n\n            for (let row = 0; row < 4; ++row) {\n                let rowD = temp_uvs[row];\n                for (let col = 0; col < 4; ++col) {\n                    let colD = temp_uvs[3 - col];\n                    uvSliced.push({\n                        u: rowD.u,\n                        v: colD.v\n                    });\n                }\n            }\n        }\n        else {\n            temp_uvs[0].u = (rect.x) / atlasWidth;\n            temp_uvs[1].u = (rect.x + leftWidth) / atlasWidth;\n            temp_uvs[2].u = (rect.x + leftWidth + centerWidth) / atlasWidth;\n            temp_uvs[3].u = (rect.x + rect.width) / atlasWidth;\n            temp_uvs[3].v = (rect.y) / atlasHeight;\n            temp_uvs[2].v = (rect.y + topHeight) / atlasHeight;\n            temp_uvs[1].v = (rect.y + topHeight + centerHeight) / atlasHeight;\n            temp_uvs[0].v = (rect.y + rect.height) / atlasHeight;\n\n            this._flipXY(temp_uvs);\n\n            for (let row = 0; row < 4; ++row) {\n                let rowD = temp_uvs[row];\n                for (let col = 0; col < 4; ++col) {\n                    let colD = temp_uvs[col];\n                    uvSliced.push({\n                        u: colD.u,\n                        v: rowD.v\n                    });\n                }\n            }\n        }\n    },\n\n    _setDynamicAtlasFrame (frame) {\n        if (!frame) return;\n\n        this._original = {\n            _texture : this._texture,\n            _x : this._rect.x,\n            _y : this._rect.y\n        }\n        \n        this._texture = frame.texture;\n        this._rect.x = frame.x;\n        this._rect.y = frame.y;\n        this._calculateUV();\n    },\n\n    _resetDynamicAtlasFrame () {\n        if (!this._original) return;\n        this._rect.x = this._original._x;\n        this._rect.y = this._original._y;\n        this._texture = this._original._texture;\n        this._original = null;\n        this._calculateUV();\n    },\n\n    _calculateUV () {\n        let rect = this._rect,\n            texture = this._texture,\n            uv = this.uv,\n            texw = texture.width,\n            texh = texture.height;\n\n        if (this._rotated) {\n            let l = texw === 0 ? 0 : rect.x / texw;\n            let r = texw === 0 ? 0 : (rect.x + rect.height) / texw;\n            let b = texh === 0 ? 0 : (rect.y + rect.width) / texh;\n            let t = texh === 0 ? 0 : rect.y / texh;\n            uv[0] = l;\n            uv[1] = t;\n            uv[2] = l;\n            uv[3] = b;\n            uv[4] = r;\n            uv[5] = t;\n            uv[6] = r;\n            uv[7] = b;\n        }\n        else {\n            let l = texw === 0 ? 0 : rect.x / texw;\n            let r = texw === 0 ? 0 : (rect.x + rect.width) / texw;\n            let b = texh === 0 ? 0 : (rect.y + rect.height) / texh;\n            let t = texh === 0 ? 0 : rect.y / texh;\n            uv[0] = l;\n            uv[1] = b;\n            uv[2] = r;\n            uv[3] = b;\n            uv[4] = l;\n            uv[5] = t;\n            uv[6] = r;\n            uv[7] = t;\n        }\n\n        if (this._flipX) {\n            let tempVal = uv[0];\n            uv[0] = uv[2];\n            uv[2] = tempVal;\n\n            tempVal = uv[1];\n            uv[1] = uv[3];\n            uv[3] = tempVal;\n\n            tempVal = uv[4];\n            uv[4] = uv[6];\n            uv[6] = tempVal;\n\n            tempVal = uv[5];\n            uv[5] = uv[7];\n            uv[7] = tempVal;\n        }\n\n        if (this._flipY) {\n            let tempVal = uv[0];\n            uv[0] = uv[4];\n            uv[4] = tempVal;\n\n            tempVal = uv[1];\n            uv[1] = uv[5];\n            uv[5] = tempVal;\n\n            tempVal = uv[2];\n            uv[2] = uv[6];\n            uv[6] = tempVal;\n\n            tempVal = uv[3];\n            uv[3] = uv[7];\n            uv[7] = tempVal;\n        }\n\n        let vertices = this.vertices;\n        if (vertices) {\n            vertices.nu.length = 0;\n            vertices.nv.length = 0;\n            for (let i = 0; i < vertices.u.length; i++) {\n                vertices.nu[i] = vertices.u[i]/texw;\n                vertices.nv[i] = vertices.v[i]/texh;\n            }\n        }\n\n        this._calculateSlicedUV();\n    },\n\n    // SERIALIZATION\n\n    _serialize: CC_EDITOR && function (exporting) {\n        let rect = this._rect;\n        let offset = this._offset;\n        let size = this._originalSize;\n        let uuid;\n        let texture = this._texture;\n        if (texture) {\n            uuid = texture._uuid;\n        }\n        if (!uuid) {\n            let url = this._textureFilename;\n            if (url) {\n                uuid = Editor.Utils.UuidCache.urlToUuid(url);\n            }\n        }\n        if (uuid && exporting) {\n            uuid = Editor.Utils.UuidUtils.compressUuid(uuid, true);\n        }\n\n        let vertices;\n        if (this.vertices) {\n            vertices = {\n                triangles: this.vertices.triangles,\n                x: this.vertices.x,\n                y: this.vertices.y,\n                u: this.vertices.u,\n                v: this.vertices.v\n            };\n        }\n\n        return {\n            name: this._name,\n            texture: uuid || undefined,\n            atlas: exporting ? undefined : this._atlasUuid,  // strip from json if exporting\n            rect: rect ? [rect.x, rect.y, rect.width, rect.height] : undefined,\n            offset: offset ? [offset.x, offset.y] : undefined,\n            originalSize: size ? [size.width, size.height] : undefined,\n            rotated: this._rotated ? 1 : undefined,\n            capInsets: this._capInsets,\n            vertices: vertices\n        };\n    },\n\n    _deserialize: function (data, handle) {\n        let rect = data.rect;\n        if (rect) {\n            this._rect = new cc.Rect(rect[0], rect[1], rect[2], rect[3]);\n        }\n        if (data.offset) {\n            this.setOffset(new cc.Vec2(data.offset[0], data.offset[1]));\n        }\n        if (data.originalSize) {\n            this.setOriginalSize(new cc.Size(data.originalSize[0], data.originalSize[1]));\n        }\n        this._rotated = data.rotated === 1;\n        this._name = data.name;\n\n        let capInsets = data.capInsets;\n        if (capInsets) {\n            this._capInsets[INSET_LEFT] = capInsets[INSET_LEFT];\n            this._capInsets[INSET_TOP] = capInsets[INSET_TOP];\n            this._capInsets[INSET_RIGHT] = capInsets[INSET_RIGHT];\n            this._capInsets[INSET_BOTTOM] = capInsets[INSET_BOTTOM];\n        }\n\n        if (CC_EDITOR) {\n            this._atlasUuid = data.atlas;\n        }\n\n        this.vertices = data.vertices;\n        if (this.vertices) {\n            // initialize normal uv arrays\n            this.vertices.nu = [];\n            this.vertices.nv = [];\n        }\n\n        // load texture via _textureSetter\n        let textureUuid = data.texture;\n        if (textureUuid) {\n            handle.result.push(this, '_textureSetter', textureUuid);\n        }\n    }\n});\n\nlet proto = SpriteFrame.prototype;\n\nproto.copyWithZone = proto.clone;\nproto.copy = proto.clone;\nproto.initWithTexture = proto.setTexture;\n\ncc.SpriteFrame = SpriteFrame;\n\nmodule.exports = SpriteFrame;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst Font = require('./CCFont');\n\n/**\n * @module cc\n */\n/**\n * !#en Class for TTFFont handling.\n * !#zh TTF 字体资源类。\n * @class TTFFont\n * @extends Font\n *\n */\nvar TTFFont = cc.Class({\n    name: 'cc.TTFFont',\n    extends: Font,\n\n    properties: {\n        _fontFamily: null,\n        _nativeAsset: {\n            type: cc.String,\n            get () {\n                return this._fontFamily;\n            },\n            set (value) {\n                this._fontFamily = value || 'Arial';\n            },\n            override: true\n        }\n    }\n});\n\ncc.TTFFont = module.exports = TTFFont;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#en Class for text file.\n * !#zh 文本资源类。\n * @class TextAsset\n * @extends Asset\n */\nvar TextAsset = cc.Class({\n    name: 'cc.TextAsset',\n    extends: cc.Asset,\n    properties: {\n        /**\n         * @property {String} text - The text contents of the resource.\n         */\n        text: \"\",\n    },\n\n    toString () {\n        return this.text;\n    },\n});\n\nmodule.exports = cc.TextAsset = TextAsset;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst EventTarget = require('../event/event-target');\nconst renderer = require('../renderer');\nrequire('../platform/CCClass');\n\nimport gfx from '../../renderer/gfx';\n\nconst GL_NEAREST = 9728;                // gl.NEAREST\nconst GL_LINEAR = 9729;                 // gl.LINEAR\nconst GL_REPEAT = 10497;                // gl.REPEAT\nconst GL_CLAMP_TO_EDGE = 33071;         // gl.CLAMP_TO_EDGE\nconst GL_MIRRORED_REPEAT = 33648;       // gl.MIRRORED_REPEAT\nconst GL_RGBA = 6408;                   // gl.RGBA\n\nconst CHAR_CODE_0 = 48;    // '0'\nconst CHAR_CODE_1 = 49;    // '1'\n\nvar idGenerater = new (require('../platform/id-generater'))('Tex');\n\n\n/**\n * <p>\n * This class allows to easily create OpenGL or Canvas 2D textures from images, text or raw data.                                    <br/>\n * The created cc.Texture2D object will always have power-of-two dimensions.                                                <br/>\n * Depending on how you create the cc.Texture2D object, the actual image area of the texture might be smaller than the texture dimensions <br/>\n *  i.e. \"contentSize\" != (pixelsWide, pixelsHigh) and (maxS, maxT) != (1.0, 1.0).                                           <br/>\n * Be aware that the content of the generated textures will be upside-down! </p>\n\n * @class Texture2D\n * @uses EventTarget\n * @extends Asset\n */\n\n// define a specified number for the pixel format which gfx do not have a standard definition.\nlet CUSTOM_PIXEL_FORMAT = 1024;\n\n/**\n * The texture pixel format, default value is RGBA8888, \n * you should note that textures loaded by normal image files (png, jpg) can only support RGBA8888 format,\n * other formats are supported by compressed file types or raw data.\n * @enum Texture2D.PixelFormat\n */\nconst PixelFormat = cc.Enum({\n    /**\n     * 16-bit texture without Alpha channel\n     * @property RGB565\n     * @readonly\n     * @type {Number}\n     */\n    RGB565: gfx.TEXTURE_FMT_R5_G6_B5,\n    /**\n     * 16-bit textures: RGB5A1\n     * @property RGB5A1\n     * @readonly\n     * @type {Number}\n     */\n    RGB5A1: gfx.TEXTURE_FMT_R5_G5_B5_A1,\n    /**\n     * 16-bit textures: RGBA4444\n     * @property RGBA4444\n     * @readonly\n     * @type {Number}\n     */\n    RGBA4444: gfx.TEXTURE_FMT_R4_G4_B4_A4,\n    /**\n     * 24-bit texture: RGB888\n     * @property RGB888\n     * @readonly\n     * @type {Number}\n     */\n    RGB888: gfx.TEXTURE_FMT_RGB8,\n    /**\n     * 32-bit texture: RGBA8888\n     * @property RGBA8888\n     * @readonly\n     * @type {Number}\n     */\n    RGBA8888: gfx.TEXTURE_FMT_RGBA8,\n    /**\n     * 32-bit float texture: RGBA32F\n     * @property RGBA32F\n     * @readonly\n     * @type {Number}\n     */\n    RGBA32F: gfx.TEXTURE_FMT_RGBA32F,\n    /**\n     * 8-bit textures used as masks\n     * @property A8\n     * @readonly\n     * @type {Number}\n     */\n    A8: gfx.TEXTURE_FMT_A8,\n    /**\n     * 8-bit intensity texture\n     * @property I8\n     * @readonly\n     * @type {Number}\n     */\n    I8: gfx.TEXTURE_FMT_L8,\n    /**\n     * 16-bit textures used as masks\n     * @property AI88\n     * @readonly\n     * @type {Number}\n     */\n    AI8: gfx.TEXTURE_FMT_L8_A8,\n\n    /**\n     * rgb 2 bpp pvrtc\n     * @property RGB_PVRTC_2BPPV1\n     * @readonly\n     * @type {Number}\n     */\n    RGB_PVRTC_2BPPV1: gfx.TEXTURE_FMT_RGB_PVRTC_2BPPV1,\n    /**\n     * rgba 2 bpp pvrtc\n     * @property RGBA_PVRTC_2BPPV1\n     * @readonly\n     * @type {Number}\n     */\n    RGBA_PVRTC_2BPPV1: gfx.TEXTURE_FMT_RGBA_PVRTC_2BPPV1,\n    /**\n     * rgb separate a 2 bpp pvrtc\n     * RGB_A_PVRTC_2BPPV1 texture is a 2x height RGB_PVRTC_2BPPV1 format texture.\n     * It separate the origin alpha channel to the bottom half atlas, the origin rgb channel to the top half atlas\n     * @property RGB_A_PVRTC_2BPPV1\n     * @readonly\n     * @type {Number}\n     */\n    RGB_A_PVRTC_2BPPV1: CUSTOM_PIXEL_FORMAT++,\n    /**\n     * rgb 4 bpp pvrtc\n     * @property RGB_PVRTC_4BPPV1\n     * @readonly\n     * @type {Number}\n     */\n    RGB_PVRTC_4BPPV1: gfx.TEXTURE_FMT_RGB_PVRTC_4BPPV1,\n    /**\n     * rgba 4 bpp pvrtc\n     * @property RGBA_PVRTC_4BPPV1\n     * @readonly\n     * @type {Number}\n     */\n    RGBA_PVRTC_4BPPV1: gfx.TEXTURE_FMT_RGBA_PVRTC_4BPPV1,\n    /**\n     * rgb a 4 bpp pvrtc\n     * RGB_A_PVRTC_4BPPV1 texture is a 2x height RGB_PVRTC_4BPPV1 format texture.\n     * It separate the origin alpha channel to the bottom half atlas, the origin rgb channel to the top half atlas\n     * @property RGB_A_PVRTC_4BPPV1\n     * @readonly\n     * @type {Number}\n     */\n    RGB_A_PVRTC_4BPPV1: CUSTOM_PIXEL_FORMAT++,\n    /**\n     * rgb etc1\n     * @property RGB_ETC1\n     * @readonly\n     * @type {Number}\n     */\n    RGB_ETC1: gfx.TEXTURE_FMT_RGB_ETC1,\n    /**\n     * rgba etc1\n     * @property RGBA_ETC1\n     * @readonly\n     * @type {Number}\n     */\n    RGBA_ETC1: CUSTOM_PIXEL_FORMAT++,\n\n    /**\n     * rgb etc2\n     * @property RGB_ETC2\n     * @readonly\n     * @type {Number}\n     */\n    RGB_ETC2: gfx.TEXTURE_FMT_RGB_ETC2,\n    /**\n     * rgba etc2\n     * @property RGBA_ETC2\n     * @readonly\n     * @type {Number}\n     */\n    RGBA_ETC2: gfx.TEXTURE_FMT_RGBA_ETC2,\n});\n\n/**\n * The texture wrap mode\n * @enum Texture2D.WrapMode\n */\nconst WrapMode = cc.Enum({\n    /**\n     * The constant variable equals gl.REPEAT for texture\n     * @property REPEAT\n     * @type {Number}\n     * @readonly\n     */\n    REPEAT: GL_REPEAT,\n    /**\n     * The constant variable equals gl.CLAMP_TO_EDGE for texture\n     * @property CLAMP_TO_EDGE\n     * @type {Number}\n     * @readonly\n     */\n    CLAMP_TO_EDGE: GL_CLAMP_TO_EDGE,\n    /**\n     * The constant variable equals gl.MIRRORED_REPEAT for texture\n     * @property MIRRORED_REPEAT\n     * @type {Number}\n     * @readonly\n     */\n    MIRRORED_REPEAT: GL_MIRRORED_REPEAT\n});\n\n/**\n * The texture filter mode\n * @enum Texture2D.Filter\n */\nconst Filter = cc.Enum({\n    /**\n     * The constant variable equals gl.LINEAR for texture\n     * @property LINEAR\n     * @type {Number}\n     * @readonly\n     */\n    LINEAR: GL_LINEAR,\n    /**\n     * The constant variable equals gl.NEAREST for texture\n     * @property NEAREST\n     * @type {Number}\n     * @readonly\n     */\n    NEAREST: GL_NEAREST\n});\n\nconst FilterIndex = {\n    9728: 0, // GL_NEAREST\n    9729: 1, // GL_LINEAR\n};\n\nlet _images = [];\nlet _sharedOpts = {\n    width: undefined,\n    height: undefined,\n    minFilter: undefined,\n    magFilter: undefined,\n    wrapS: undefined,\n    wrapT: undefined,\n    format: undefined,\n    genMipmaps: undefined,\n    images: undefined,\n    image: undefined,\n    flipY: undefined,\n    premultiplyAlpha: undefined\n};\nfunction _getSharedOptions () {\n    for (var key in _sharedOpts) {\n        _sharedOpts[key] = undefined;\n    }\n    _images.length = 0;\n    _sharedOpts.images = _images;\n    _sharedOpts.flipY = false;\n    return _sharedOpts;\n}\n\n/**\n * This class allows to easily create OpenGL or Canvas 2D textures from images or raw data.\n *\n * @class Texture2D\n * @uses EventTarget\n * @extends Asset\n */\nvar Texture2D = cc.Class({\n    name: 'cc.Texture2D',\n    extends: require('../assets/CCAsset'),\n    mixins: [EventTarget],\n\n    properties: {\n        _nativeAsset: {\n            get () {\n                // maybe returned to pool in webgl\n                return this._image;\n            },\n            set (data) {\n                if (data._compressed && data._data) {\n                    this.initWithData(data._data, this._format, data.width, data.height);\n                }\n                else {\n                    this.initWithElement(data);\n                }\n            },\n            override: true\n        },\n        _format: PixelFormat.RGBA8888,\n        _premultiplyAlpha: false,\n        _flipY: false,\n        _minFilter: Filter.LINEAR,\n        _magFilter: Filter.LINEAR,\n        _mipFilter: Filter.LINEAR,\n        _wrapS: WrapMode.CLAMP_TO_EDGE,\n        _wrapT: WrapMode.CLAMP_TO_EDGE,\n\n        _genMipmaps: false,\n        /**\n         * !#en Sets whether generate mipmaps for the texture\n         * !#zh 是否为纹理设置生成 mipmaps。\n         * @property {Boolean} genMipmaps\n         * @default false\n         */\n        genMipmaps: {\n            get () {\n                return this._genMipmaps;\n            },\n            set (genMipmaps) {\n                if (this._genMipmaps !== genMipmaps) {\n                    var opts = _getSharedOptions();\n                    opts.genMipmaps = genMipmaps;\n                    this.update(opts);\n                }\n            }\n        },\n\n        _packable: true,\n        /**\n         * !#en \n         * Sets whether texture can be packed into texture atlas.\n         * If need use texture uv in custom Effect, please sets packable to false.\n         * !#zh \n         * 设置纹理是否允许参与合图。\n         * 如果需要在自定义 Effect 中使用纹理 UV，需要禁止该选项。\n         * @property {Boolean} packable\n         * @default true\n         */\n        packable: {\n            get () {\n                return this._packable;\n            },\n            set (val) {\n                this._packable = val;\n            }\n        }\n    },\n\n    statics: {\n        PixelFormat: PixelFormat,\n        WrapMode: WrapMode,\n        Filter: Filter,\n        _FilterIndex: FilterIndex,\n\n        // predefined most common extnames\n        extnames: ['.png', '.jpg', '.jpeg', '.bmp', '.webp', '.pvr', '.pkm'],\n    },\n\n    ctor () {\n        // Id for generate hash in material\n        this._id = idGenerater.getNewId();\n\n        /**\n         * !#en\n         * Whether the texture is loaded or not\n         * !#zh\n         * 贴图是否已经成功加载\n         * @property loaded\n         * @type {Boolean}\n         */\n        this.loaded = false;\n        /**\n         * !#en\n         * Texture width in pixel\n         * !#zh\n         * 贴图像素宽度\n         * @property width\n         * @type {Number}\n         */\n        this.width = 0;\n        /**\n         * !#en\n         * Texture height in pixel\n         * !#zh\n         * 贴图像素高度\n         * @property height\n         * @type {Number}\n         */\n        this.height = 0;\n\n        this._hashDirty = true;\n        this._hash = 0;\n        this._texture = null;\n        \n        if (CC_EDITOR) {\n            this._exportedExts = null;\n        }\n    },\n\n    /**\n     * !#en\n     * Get renderer texture implementation object\n     * extended from render.Texture2D\n     * !#zh  返回渲染器内部贴图对象\n     * @method getImpl\n     */\n    getImpl () {\n        return this._texture;\n    },\n\n    getId () {\n        return this._id;\n    },\n\n    toString () {\n        return this.url || '';\n    },\n\n    /**\n     * Update texture options, not available in Canvas render mode.\n     * image, format, premultiplyAlpha can not be updated in native.\n     * @method update\n     * @param {Object} options\n     * @param {DOMImageElement} options.image\n     * @param {Boolean} options.genMipmaps\n     * @param {PixelFormat} options.format\n     * @param {Filter} options.minFilter\n     * @param {Filter} options.magFilter\n     * @param {WrapMode} options.wrapS\n     * @param {WrapMode} options.wrapT\n     * @param {Boolean} options.premultiplyAlpha\n     */\n    update (options) {\n        if (options) {\n            let updateImg = false;\n            if (options.width !== undefined) {\n                this.width = options.width;\n            }\n            if (options.height !== undefined) {\n                this.height = options.height;\n            }\n            if (options.minFilter !== undefined) {\n                this._minFilter = options.minFilter;\n                options.minFilter = FilterIndex[options.minFilter];\n            }\n            if (options.magFilter !== undefined) {\n                this._magFilter = options.magFilter;\n                options.magFilter = FilterIndex[options.magFilter];\n            }\n            if (options.mipFilter !== undefined) {\n                this._mipFilter = options.mipFilter;\n                options.mipFilter = FilterIndex[options.mipFilter];\n            }\n            if (options.wrapS !== undefined) {\n                this._wrapS = options.wrapS;\n            }\n            if (options.wrapT !== undefined) {\n                this._wrapT = options.wrapT;\n            }\n            if (options.format !== undefined) {\n                this._format = options.format;\n            }\n            if (options.flipY !== undefined) {\n                this._flipY = options.flipY;\n                updateImg = true;\n            }\n            if (options.premultiplyAlpha !== undefined) {\n                this._premultiplyAlpha = options.premultiplyAlpha;\n                updateImg = true;\n            }\n            if (options.genMipmaps !== undefined) {\n                this._genMipmaps = options.genMipmaps;\n            }\n\n            if (updateImg && this._image) {\n                options.image = this._image;\n            }\n            if (options.images && options.images.length > 0) {\n                this._image = options.images[0];\n            }\n            else if (options.image !== undefined) {\n                this._image = options.image;\n                if (!options.images) {\n                    _images.length = 0;\n                    options.images = _images;\n                }\n                // webgl texture 2d uses images\n                options.images.push(options.image);\n            }\n\n            if (options.images && options.images.length > 0) {\n                this._texture.update(options);\n            }\n\n            this._hashDirty = true;\n        }\n    },\n\n    /**\n     * !#en\n     * Init with HTML element.\n     * !#zh 用 HTML Image 或 Canvas 对象初始化贴图。\n     * @method initWithElement\n     * @param {HTMLImageElement|HTMLCanvasElement} element\n     * @example\n     * var img = new Image();\n     * img.src = dataURL;\n     * texture.initWithElement(img);\n     */\n    initWithElement (element) {\n        if (!element)\n            return;\n        this._image = element;\n        if (element.complete || element instanceof HTMLCanvasElement) {\n            this.handleLoadedTexture();\n        }\n        else {\n            var self = this;\n            element.addEventListener('load', function () {\n                self.handleLoadedTexture();\n            });\n            element.addEventListener('error', function (err) {\n                cc.warnID(3119, err.message);\n            });\n        }\n    },\n\n    /**\n     * !#en\n     * Intializes with a texture2d with data in Uint8Array.\n     * !#zh 使用一个存储在 Unit8Array 中的图像数据（raw data）初始化数据。\n     * @method initWithData\n     * @param {TypedArray} data\n     * @param {Number} pixelFormat\n     * @param {Number} pixelsWidth\n     * @param {Number} pixelsHeight\n     * @return {Boolean}\n     */\n    initWithData (data, pixelFormat, pixelsWidth, pixelsHeight) {\n        var opts = _getSharedOptions();\n        opts.image = data;\n        // webgl texture 2d uses images\n        opts.images = [opts.image];\n        opts.genMipmaps = this._genMipmaps;\n        opts.premultiplyAlpha = this._premultiplyAlpha;\n        opts.flipY = this._flipY;\n        opts.minFilter = FilterIndex[this._minFilter];\n        opts.magFilter = FilterIndex[this._magFilter];\n        opts.wrapS = this._wrapS;\n        opts.wrapT = this._wrapT;\n        opts.format = this._getGFXPixelFormat(pixelFormat);\n        opts.width = pixelsWidth;\n        opts.height = pixelsHeight;\n        if (!this._texture) {\n            this._texture = new renderer.Texture2D(renderer.device, opts);\n        }\n        else {\n            this._texture.update(opts);\n        }\n        this.width = pixelsWidth;\n        this.height = pixelsHeight;\n\n        this._checkPackable();\n\n        this.loaded = true;\n        this.emit(\"load\");\n        return true;\n    },\n\n    /**\n     * !#en\n     * HTMLElement Object getter, available only on web.<br/>\n     * Note: texture is packed into texture atlas by default<br/>\n     * you should set texture.packable as false before getting Html element object.\n     * !#zh 获取当前贴图对应的 HTML Image 或 Canvas 对象，只在 Web 平台下有效。<br/>\n     * 注意：<br/>\n     * texture 默认参与动态合图，如果需要获取到正确的 Html 元素对象，需要先设置 texture.packable 为 false\n     * @method getHtmlElementObj\n     * @return {HTMLImageElement|HTMLCanvasElement}\n     */\n    getHtmlElementObj () {\n        return this._image;\n    },\n    \n    /**\n     * !#en\n     * Destory this texture and immediately release its video memory. (Inherit from cc.Object.destroy)<br>\n     * After destroy, this object is not usable any more.\n     * You can use cc.isValid(obj) to check whether the object is destroyed before accessing it.\n     * !#zh\n     * 销毁该贴图，并立即释放它对应的显存。（继承自 cc.Object.destroy）<br/>\n     * 销毁后，该对象不再可用。您可以在访问对象之前使用 cc.isValid(obj) 来检查对象是否已被销毁。\n     * @method destroy\n     * @return {Boolean} inherit from the CCObject\n     */\n    destroy () {\n        this._packable && cc.dynamicAtlasManager && cc.dynamicAtlasManager.deleteAtlasTexture(this);\n\n        this._image = null;\n        this._texture && this._texture.destroy();\n        // TODO cc.textureUtil ?\n        // cc.textureCache.removeTextureForKey(this.url);  // item.rawUrl || item.url\n        this._super();\n    },\n\n    /**\n     * !#en\n     * Pixel format of the texture.\n     * !#zh 获取纹理的像素格式。\n     * @method getPixelFormat\n     * @return {Number}\n     */\n    getPixelFormat () {\n        //support only in WebGl rendering mode\n        return this._format;\n    },\n\n    /**\n     * !#en\n     * Whether or not the texture has their Alpha premultiplied.\n     * !#zh 检查纹理在上传 GPU 时预乘选项是否开启。\n     * @method hasPremultipliedAlpha\n     * @return {Boolean}\n     */\n    hasPremultipliedAlpha () {\n        return this._premultiplyAlpha || false;\n    },\n\n    /**\n     * !#en\n     * Handler of texture loaded event.\n     * Since v2.0, you don't need to invoke this function, it will be invoked automatically after texture loaded.\n     * !#zh 贴图加载事件处理器。v2.0 之后你将不在需要手动执行这个函数，它会在贴图加载成功之后自动执行。\n     * @method handleLoadedTexture\n     * @param {Boolean} [premultiplied]\n     */\n    handleLoadedTexture () {\n        if (!this._image || !this._image.width || !this._image.height)\n            return;\n        \n        this.width = this._image.width;\n        this.height = this._image.height;\n        let opts = _getSharedOptions();\n        opts.image = this._image;\n        // webgl texture 2d uses images\n        opts.images = [opts.image];\n        opts.width = this.width;\n        opts.height = this.height;\n        opts.genMipmaps = this._genMipmaps;\n        opts.format = this._getGFXPixelFormat(this._format);\n        opts.premultiplyAlpha = this._premultiplyAlpha;\n        opts.flipY = this._flipY;\n        opts.minFilter = FilterIndex[this._minFilter];\n        opts.magFilter = FilterIndex[this._magFilter];\n        opts.wrapS = this._wrapS;\n        opts.wrapT = this._wrapT;\n        \n        if (!this._texture) {\n            this._texture = new renderer.Texture2D(renderer.device, opts);\n        }\n        else {\n            this._texture.update(opts);\n        }\n\n        this._checkPackable();\n\n        //dispatch load event to listener.\n        this.loaded = true;\n        this.emit(\"load\");\n\n        if (cc.macro.CLEANUP_IMAGE_CACHE && this._image instanceof HTMLImageElement) {\n            this._clearImage();\n        }\n    },\n\n    /**\n     * !#en\n     * Description of cc.Texture2D.\n     * !#zh cc.Texture2D 描述。\n     * @method description\n     * @returns {String}\n     */\n    description () {\n        return \"<cc.Texture2D | Name = \" + this.url + \" | Dimensions = \" + this.width + \" x \" + this.height + \">\";\n    },\n\n    /**\n     * !#en\n     * Release texture, please use destroy instead.\n     * !#zh 释放纹理，请使用 destroy 替代。\n     * @method releaseTexture\n     * @deprecated since v2.0\n     */\n    releaseTexture () {\n        this._image = null;\n        this._texture && this._texture.destroy();\n    },\n\n    /**\n     * !#en Sets the wrap s and wrap t options. <br/>\n     * If the texture size is NPOT (non power of 2), then in can only use gl.CLAMP_TO_EDGE in gl.TEXTURE_WRAP_{S,T}.\n     * !#zh 设置纹理包装模式。\n     * 若纹理贴图尺寸是 NPOT（non power of 2），则只能使用 Texture2D.WrapMode.CLAMP_TO_EDGE。\n     * @method setTexParameters\n     * @param {Texture2D.WrapMode} wrapS\n     * @param {Texture2D.WrapMode} wrapT\n     */\n    setWrapMode (wrapS, wrapT) {\n        if (this._wrapS !== wrapS || this._wrapT !== wrapT) {\n            var opts = _getSharedOptions();\n            opts.wrapS = wrapS;\n            opts.wrapT = wrapT;\n            this.update(opts);\n        }\n    },\n\n    /**\n     * !#en Sets the minFilter and magFilter options\n     * !#zh 设置纹理贴图缩小和放大过滤器算法选项。\n     * @method setFilters\n     * @param {Texture2D.Filter} minFilter\n     * @param {Texture2D.Filter} magFilter\n     */\n    setFilters (minFilter, magFilter) {\n        if (this._minFilter !== minFilter || this._magFilter !== magFilter) {\n            var opts = _getSharedOptions();\n            opts.minFilter = minFilter;\n            opts.magFilter = magFilter;\n            this.update(opts);\n        }\n    },\n\n    /**\n     * !#en\n     * Sets the flipY options\n     * !#zh 设置贴图的纵向翻转选项。\n     * @method setFlipY\n     * @param {Boolean} flipY\n     */\n    setFlipY (flipY) {\n        if (this._flipY !== flipY) {\n            var opts = _getSharedOptions();\n            opts.flipY = flipY;\n            this.update(opts);\n        }\n    },\n\n    /**\n     * !#en\n     * Sets the premultiply alpha options\n     * !#zh 设置贴图的预乘选项。\n     * @method setPremultiplyAlpha\n     * @param {Boolean} premultiply\n     */\n    setPremultiplyAlpha (premultiply) {\n        if (this._premultiplyAlpha !== premultiply) {\n            var opts = _getSharedOptions();\n            opts.premultiplyAlpha = premultiply;\n            this.update(opts);\n        }\n    },\n\n    _checkPackable () {\n        let dynamicAtlas = cc.dynamicAtlasManager;\n        if (!dynamicAtlas) return;\n\n        if (this._isCompressed()) {\n            this._packable = false;\n            return;\n        }\n\n        let w = this.width, h = this.height;\n        if (!this._image ||\n            w > dynamicAtlas.maxFrameSize || h > dynamicAtlas.maxFrameSize || \n            this._getHash() !== dynamicAtlas.Atlas.DEFAULT_HASH) {\n            this._packable = false;\n            return;\n        }\n\n        if (this._image && this._image instanceof HTMLCanvasElement) {\n            this._packable = true;\n        }\n    },\n\n    _getOpts() {\n        let opts = _getSharedOptions();\n        opts.width = this.width;\n        opts.height = this.height;\n        opts.genMipmaps = this._genMipmaps;\n        opts.format = this._format;\n        opts.premultiplyAlpha = this._premultiplyAlpha;\n        opts.anisotropy = this._anisotropy;\n        opts.flipY = this._flipY;\n        opts.minFilter = FilterIndex[this._minFilter];\n        opts.magFilter = FilterIndex[this._magFilter];\n        opts.mipFilter = FilterIndex[this._mipFilter];\n        opts.wrapS = this._wrapS;\n        opts.wrapT = this._wrapT;\n        return opts;\n    },\n\n    _getGFXPixelFormat (format) {\n        if (format === PixelFormat.RGBA_ETC1) {\n            format = PixelFormat.RGB_ETC1;\n        }\n        else if (format === PixelFormat.RGB_A_PVRTC_4BPPV1) {\n            format = PixelFormat.RGB_PVRTC_4BPPV1;\n        }\n        else if (format === PixelFormat.RGB_A_PVRTC_2BPPV1) {\n            format = PixelFormat.RGB_PVRTC_2BPPV1;\n        }\n        return format;\n    },\n\n    _resetUnderlyingMipmaps(mipmapSources) {\n        const opts = this._getOpts();\n        opts.images = mipmapSources || [null];\n        if (!this._texture) {\n            this._texture = new renderer.Texture2D(renderer.device, opts);\n        } else {\n            this._texture.update(opts);\n        }\n    },\n\n    // SERIALIZATION\n\n    _serialize: (CC_EDITOR || CC_TEST) && function () {\n        let extId = \"\";\n        let exportedExts = this._exportedExts;\n        if (!exportedExts && this._native) {\n            exportedExts = [this._native];\n        }\n        if (exportedExts) {\n            let exts = [];\n            for (let i = 0; i < exportedExts.length; i++) {\n                let extId = \"\";\n                let ext = exportedExts[i];\n                if (ext) {\n                    // ext@format\n                    let extFormat = ext.split('@');\n                    extId = Texture2D.extnames.indexOf(extFormat[0]);\n                    if (extId < 0) {\n                        extId = ext;\n                    }\n                    if (extFormat[1]) {\n                        extId += '@' + extFormat[1];\n                    }\n                }\n                exts.push(extId);\n            }\n            extId = exts.join('_');\n        }\n        let asset = `${extId},${this._minFilter},${this._magFilter},${this._wrapS},${this._wrapT},` +\n                    `${this._premultiplyAlpha ? 1 : 0},${this._genMipmaps ? 1 : 0},${this._packable ? 1 : 0}`;\n        return asset;\n    },\n\n    _deserialize: function (data, handle) {\n        let device = cc.renderer.device;\n\n        let fields = data.split(',');\n        // decode extname\n        let extIdStr = fields[0];\n        if (extIdStr) {\n            let extIds = extIdStr.split('_');\n\n            let defaultExt = '';\n            let bestExt = '';\n            let bestIndex = 999;\n            let bestFormat = this._format;\n            let SupportTextureFormats = cc.macro.SUPPORT_TEXTURE_FORMATS;\n            for (let i = 0; i < extIds.length; i++) {\n                let extFormat = extIds[i].split('@');\n                let tmpExt = extFormat[0];\n                tmpExt = Texture2D.extnames[tmpExt.charCodeAt(0) - CHAR_CODE_0] || tmpExt;\n\n                let index = SupportTextureFormats.indexOf(tmpExt);\n                if (index !== -1 && index < bestIndex) {\n                    \n                    let tmpFormat = extFormat[1] ? parseInt(extFormat[1]) : this._format;\n\n                    // check whether or not support compressed texture\n                    if ( tmpExt === '.pvr' && !device.ext('WEBGL_compressed_texture_pvrtc')) {\n                        continue;\n                    }\n                    else if ((tmpFormat === PixelFormat.RGB_ETC1 || tmpFormat === PixelFormat.RGBA_ETC1) && !device.ext('WEBGL_compressed_texture_etc1')) {\n                        continue;\n                    }\n                    else if ((tmpFormat === PixelFormat.RGB_ETC2 || tmpFormat === PixelFormat.RGBA_ETC2) && !device.ext('WEBGL_compressed_texture_etc')) {\n                        continue;\n                    }\n                    else if (tmpExt === '.webp' && !cc.sys.capabilities.webp) {\n                        continue;\n                    }\n\n                    bestIndex = index;\n                    bestExt = tmpExt;\n                    bestFormat = tmpFormat;\n                }\n                else if (!defaultExt) {\n                    defaultExt = tmpExt;\n                }\n            }\n\n            if (bestExt) {\n                this._setRawAsset(bestExt);\n                this._format = bestFormat;\n            }\n            else {\n                this._setRawAsset(defaultExt);\n                cc.warnID(3120, handle.customEnv.url, defaultExt, defaultExt);\n            }\n        }\n        if (fields.length === 8) {\n            // decode filters\n            this._minFilter = parseInt(fields[1]);\n            this._magFilter = parseInt(fields[2]);\n            // decode wraps\n            this._wrapS = parseInt(fields[3]);\n            this._wrapT = parseInt(fields[4]);\n            // decode premultiply alpha\n            this._premultiplyAlpha = fields[5].charCodeAt(0) === CHAR_CODE_1;\n            this._genMipmaps = fields[6].charCodeAt(0) === CHAR_CODE_1;\n            this._packable = fields[7].charCodeAt(0) === CHAR_CODE_1;\n        }\n    },\n\n    _getHash () {\n        if (!this._hashDirty) {\n            return this._hash;\n        }\n        let genMipmaps = this._genMipmaps ? 1 : 0;\n        let premultiplyAlpha = this._premultiplyAlpha ? 1 : 0;\n        let flipY = this._flipY ? 1 : 0;\n        let minFilter = this._minFilter === Filter.LINEAR ? 1 : 2;\n        let magFilter = this._magFilter === Filter.LINEAR ? 1 : 2;\n        let wrapS = this._wrapS === WrapMode.REPEAT ? 1 : (this._wrapS === WrapMode.CLAMP_TO_EDGE ? 2 : 3);\n        let wrapT = this._wrapT === WrapMode.REPEAT ? 1 : (this._wrapT === WrapMode.CLAMP_TO_EDGE ? 2 : 3);\n        let pixelFormat = this._format;\n        let image = this._image;\n        if (CC_JSB && image) {\n            if (image._glFormat && image._glFormat !== GL_RGBA)\n                pixelFormat = 0;\n            premultiplyAlpha = image._premultiplyAlpha ? 1 : 0;\n        }\n\n        this._hash = Number(`${minFilter}${magFilter}${pixelFormat}${wrapS}${wrapT}${genMipmaps}${premultiplyAlpha}${flipY}`);\n        this._hashDirty = false;\n        return this._hash;\n    },\n\n    _isCompressed () {\n        return this._format < PixelFormat.A8 || this._format > PixelFormat.RGBA32F;\n    },\n    \n    _clearImage () {\n        // wechat game platform will cache image parsed data, \n        // so image will consume much more memory than web, releasing it\n        // Release image in loader cache\n        // native image element has not image.id, release by image.src.\n        cc.loader.removeItem(this._image.id || this._image.src);\n        this._image.src = \"\";\n    }\n});\n\n/**\n * !#zh\n * 当该资源加载成功后触发该事件\n * !#en\n * This event is emitted when the asset is loaded\n *\n * @event load\n */\n\ncc.Texture2D = module.exports = Texture2D;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('./CCRawAsset');\nrequire('./CCAsset');\nrequire('./CCFont');\nrequire('./CCPrefab');\nrequire('./CCAudioClip');\nrequire('./CCScripts');\nrequire('./CCSceneAsset');\nrequire('./CCSpriteFrame');\nrequire('./CCTexture2D');\nrequire('./CCRenderTexture');\nrequire('./CCTTFFont');\nrequire('./CCSpriteAtlas');\nrequire('./CCBitmapFont');\nrequire('./CCLabelAtlas');\nrequire('./CCTextAsset');\nrequire('./CCJsonAsset');\nrequire('./CCBufferAsset');\nrequire('./material');\n","import Asset from '../CCAsset';\nimport { parseEffect } from './effect-parser';\n\n/**\n * !#en Effect Asset.\n * !#zh Effect 资源类型。\n * @class EffectAsset\n * @extends Asset\n */\nlet EffectAsset = cc.Class({\n    name: 'cc.EffectAsset',\n    extends: Asset,\n\n    ctor () {\n        this._effect = null;\n    },\n\n    properties: {\n        properties: Object,\n        techniques: [],\n        shaders: []\n    },\n\n    onLoad () {\n        if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {\n            return;\n        }\n        \n        let lib = cc.renderer._forward._programLib;\n        for (let i = 0; i < this.shaders.length; i++) {\n            lib.define(this.shaders[i]);\n        }\n\n        this._initEffect();\n    },\n\n    _initEffect () {\n        if (this._effect) return;\n        this._effect = parseEffect(this);\n        Object.freeze(this._effect);\n    },\n\n    getInstantiatedEffect () {\n        this._initEffect();\n        return this._effect.clone();\n    },\n\n    getEffect () {\n        this._initEffect();\n        return this._effect;\n    }\n});\n\nmodule.exports = cc.EffectAsset = EffectAsset;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos.com\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst Asset = require('../CCAsset');\nconst Texture = require('../CCTexture2D');\nconst PixelFormat = Texture.PixelFormat;\nconst EffectAsset = require('./CCEffectAsset');\nconst textureUtil = require('../../utils/texture-util');\nconst gfx = cc.gfx;\n\n/**\n * !#en Material builtin name\n * !#zh 内置材质名字\n * @enum Material.BUILTIN_NAME\n */\nconst BUILTIN_NAME = cc.Enum({\n    /**\n     * @property SPRITE\n     * @readonly\n     * @type {String}\n     */\n    SPRITE: '2d-sprite',\n    /**\n     * @property GRAY_SPRITE\n     * @readonly\n     * @type {String}\n     */\n    GRAY_SPRITE: '2d-gray-sprite',\n    /**\n     * @property UNLIT\n     * @readonly\n     * @type {String}\n     */\n    UNLIT: 'unlit',\n})\n\n\n/**\n * !#en Material Asset.\n * !#zh 材质资源类。\n * @class Material\n * @extends Asset\n */\nlet Material = cc.Class({\n    name: 'cc.Material',\n    extends: Asset,\n\n    ctor () {\n        this._manualHash = false;\n        this._dirty = true;\n        this._effect = null;\n    },\n\n    properties: {\n        // deprecated\n        _defines: {\n            default: undefined,\n            type: Object\n        },\n        // deprecated\n        _props: {\n            default: undefined,\n            type: Object\n        },\n\n        _effectAsset: {\n            type: EffectAsset,\n            default: null,\n        },\n\n        _techniqueIndex: 0,\n        _techniqueData: Object,\n\n        effectName: CC_EDITOR ? {\n            get () {\n                return this._effectAsset && this._effectAsset.name;\n            },\n            set (val) {\n                let effectAsset = cc.AssetLibrary.getBuiltin('effect', val);\n                if (!effectAsset) {\n                    Editor.warn(`no effect named '${val}' found`);\n                    return;\n                }\n                this.effectAsset = effectAsset;\n            }\n        } : undefined,\n\n        effectAsset: {\n            get () {\n                return this._effectAsset;\n            },\n            set (asset) {\n                if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {\n                    return;\n                }\n\n                this._effectAsset = asset;\n                if (!asset) {\n                    cc.error('Can not set an empty effect asset.');\n                    return;\n                }\n\n                this._effect = this._effectAsset.getInstantiatedEffect();\n            }\n        },\n\n        effect: {\n            get () {\n                return this._effect;\n            }\n        },\n\n        techniqueIndex: {\n            get () {\n                return this._techniqueIndex;\n            },\n            set (v) {\n                this._techniqueIndex = v;\n                this._effect.switchTechnique(v);\n            }\n        }\n    },\n\n    statics: {\n        getBuiltinMaterial (name) {\n            if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {\n                return new cc.Material();\n            }\n            return cc.AssetLibrary.getBuiltin('material', 'builtin-' + name);\n        },\n\n        BUILTIN_NAME,\n        \n        /**\n         * !#en Creates a Material with builtin Effect.\n         * !#zh 使用内建 Effect 创建一个材质。\n         * @static\n         * @method createWithBuiltin\n         * @param {string} effectName \n         * @param {number} techniqueIndex \n         * @return {Material}\n         */\n        createWithBuiltin (effectName, techniqueIndex = 0) {\n            let effectAsset = cc.AssetLibrary.getBuiltin('effect', 'builtin-' + effectName);\n            return Material.create(effectAsset, techniqueIndex);\n        },\n        /**\n         * !#en Creates a Material.\n         * !#zh 创建一个材质。\n         * @static\n         * @method create\n         * @param {EffectAsset} effectAsset \n         * @param {number} [techniqueIndex] \n         * @return {Material}\n         */\n        create (effectAsset, techniqueIndex = 0) {\n            if (!effectAsset) return null;\n            let material = new Material();\n            material.effectAsset = effectAsset;\n            material.techniqueIndex = techniqueIndex;\n            return material;\n        }\n    },\n\n    /**\n     * !#en Sets the Material property\n     * !#zh 是指材质的属性\n     * @method setProperty\n     * @param {string} name\n     * @param {Object} val\n     * @param {number} [passIdx]\n     * @param {boolean} [directly]\n     */\n    setProperty (name, val, passIdx, directly) {\n        if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) return;\n\n        if (typeof passIdx === 'string') {\n            passIdx = parseInt(passIdx);\n        }\n\n        if (val instanceof Texture) {\n            let format = val.getPixelFormat();\n            let value = (format === PixelFormat.RGBA_ETC1 || format === PixelFormat.RGB_A_PVRTC_4BPPV1 || format === PixelFormat.RGB_A_PVRTC_2BPPV1);\n            let key = 'CC_USE_ALPHA_ATLAS_' + name.toUpperCase();\n            let def = this.getDefine(key, passIdx);\n            if (value || def) {\n                this.define(key, value);\n            }\n            function loaded () {\n                this._effect.setProperty(name, val, passIdx);\n            }\n\n            if (!val.loaded) {\n                val.once('load', loaded, this);\n                textureUtil.postLoadTexture(val);\n                return;\n            }\n        }\n\n        this._effect.setProperty(name, val, passIdx, directly);\n    },\n\n    /**\n     * !#en Gets the Material property.\n     * !#zh 获取材质的属性。\n     * @method getProperty\n     * @param {string} name \n     * @param {number} passIdx \n     */\n    getProperty (name, passIdx) {\n        if (typeof passIdx === 'string') {\n            passIdx = parseInt(passIdx);\n        }\n        return this._effect.getProperty(name, passIdx);\n    },\n\n    /**\n     * !#en Sets the Material define.\n     * !#zh 设置材质的宏定义。\n     * @method define\n     * @param {string} name\n     * @param {boolean|number} val\n     * @param {number} passIdx\n     * @param {boolean} force\n     */\n    define (name, val, passIdx, force) {\n        if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) return;\n\n        if (typeof passIdx === 'string') {\n            passIdx = parseInt(passIdx);\n        }\n        this._effect.define(name, val, passIdx, force);\n    },\n\n    /**\n     * !#en Gets the Material define.\n     * !#zh 获取材质的宏定义。\n     * @method getDefine\n     * @param {string} name \n     * @param {number} passIdx \n     */\n    getDefine (name, passIdx) {\n        if (typeof passIdx === 'string') {\n            passIdx = parseInt(passIdx);\n        }\n        return this._effect.getDefine(name, passIdx);\n    },\n\n    /**\n     * !#en Sets the Material cull mode.\n     * !#zh 设置材质的裁减模式。\n     * @method setCullMode\n     * @param {number} cullMode \n     * @param {number} passIdx \n     */\n    setCullMode (cullMode = gfx.CULL_BACK, passIdx) {\n        this._effect.setCullMode(cullMode, passIdx);\n    },\n\n    /**\n     * !#en Sets the Material depth states.\n     * !#zh 设置材质的深度渲染状态。\n     * @method setDepth\n     * @param {boolean} depthTest \n     * @param {boolean} depthWrite \n     * @param {number} depthFunc \n     * @param {number} passIdx \n     */\n    setDepth (\n        depthTest = false,\n        depthWrite = false,\n        depthFunc = gfx.DS_FUNC_LESS,\n        passIdx\n    ) {\n        this._effect.setDepth(depthTest, depthWrite, depthFunc, passIdx);\n    },\n\n    /**\n     * !#en Sets the Material blend states.\n     * !#zh 设置材质的混合渲染状态。\n     * @method setBlend\n     * @param {number} enabled \n     * @param {number} blendEq \n     * @param {number} blendSrc \n     * @param {number} blendDst \n     * @param {number} blendAlphaEq \n     * @param {number} blendSrcAlpha \n     * @param {number} blendDstAlpha \n     * @param {number} blendColor \n     * @param {number} passIdx \n     */\n    setBlend (\n        enabled = false,\n        blendEq = gfx.BLEND_FUNC_ADD,\n        blendSrc = gfx.BLEND_SRC_ALPHA,\n        blendDst = gfx.BLEND_ONE_MINUS_SRC_ALPHA,\n        blendAlphaEq = gfx.BLEND_FUNC_ADD,\n        blendSrcAlpha = gfx.BLEND_SRC_ALPHA,\n        blendDstAlpha = gfx.BLEND_ONE_MINUS_SRC_ALPHA,\n        blendColor = 0xffffffff,\n        passIdx\n    ) {\n        this._effect.setBlend(enabled, blendEq, blendSrc, blendDst, blendAlphaEq, blendSrcAlpha, blendDstAlpha, blendColor, passIdx);\n    },\n\n    /**\n     * !#en Sets whether enable the stencil test.\n     * !#zh 设置是否开启模板测试。\n     * @method setStencilEnabled\n     * @param {number} stencilTest \n     * @param {number} passIdx \n     */\n    setStencilEnabled (stencilTest = gfx.STENCIL_INHERIT, passIdx) {\n        this._effect.setStencilEnabled(stencilTest, passIdx);\n    },\n\n    /**\n     * !#en Sets the Material stencil render states.\n     * !#zh 设置材质的模板测试渲染参数。\n     * @method setStencil\n     * @param {number} stencilTest \n     * @param {number} stencilFunc \n     * @param {number} stencilRef \n     * @param {number} stencilMask \n     * @param {number} stencilFailOp \n     * @param {number} stencilZFailOp \n     * @param {number} stencilZPassOp \n     * @param {number} stencilWriteMask \n     * @param {number} passIdx \n     */\n    setStencil (\n        stencilTest = gfx.STENCIL_INHERIT,\n        stencilFunc = gfx.DS_FUNC_ALWAYS,\n        stencilRef = 0,\n        stencilMask = 0xff,\n        stencilFailOp = gfx.STENCIL_OP_KEEP,\n        stencilZFailOp = gfx.STENCIL_OP_KEEP,\n        stencilZPassOp = gfx.STENCIL_OP_KEEP,\n        stencilWriteMask = 0xff,\n        passIdx\n    ) {\n        this._effect.setStencil(stencilTest, stencilFunc, stencilRef, stencilMask, stencilFailOp, stencilZFailOp, stencilZPassOp, stencilWriteMask, passIdx);\n    },\n\n    updateHash (hash) {\n        this._manualHash = hash;\n        this._effect && this._effect.updateHash(hash);\n    },\n\n    getHash () {\n        return this._manualHash || (this._effect && this._effect.getHash());\n    },\n\n    onLoad () {\n        this.effectAsset = this._effectAsset;\n        if (!this._effect) return;\n\n        if (this._techniqueIndex) {\n            this._effect.switchTechnique(this._techniqueIndex);\n        }\n\n        this._techniqueData = this._techniqueData || {};\n\n        let passDatas = this._techniqueData;\n        for (let index in passDatas) {\n            index = parseInt(index);\n            let passData = passDatas[index];\n            if (!passData) continue;\n\n            for (let def in passData.defines) {\n                this.define(def, passData.defines[def], index);\n            }\n            for (let prop in passData.props) {\n                this.setProperty(prop, passData.props[prop], index);\n            }\n        }\n\n    },\n});\n\nexport default Material;\ncc.Material = Material;\n","import Pass from '../../../renderer/core/pass';\n\nconst gfx = cc.gfx;\n\nexport default class EffectBase {\n    _dirty = true;\n\n    _name = '';\n    get name () {\n        return this._name;\n    }\n\n    _technique = null;\n    get technique () {\n        return this._technique;\n    }\n\n    get passes (): Pass[] {\n        return [];\n    }\n\n    _createPassProp (name, pass) {\n        let prop = pass._properties[name];\n        if (!prop) {\n            return;\n        }\n\n        let uniform = Object.create(null);\n        uniform.name = name;\n        uniform.type = prop.type;\n        if (prop.value instanceof Float32Array) {\n            uniform.value = new Float32Array(prop.value);\n        }\n        else {\n            uniform.value = prop.value;\n        }\n        pass._properties[name] = uniform;\n\n        return uniform;\n    }\n\n    _setPassProperty (name, value, pass, directly) {\n        let properties = pass._properties;\n        let uniform = properties.hasOwnProperty(name);\n        if (!uniform) {\n            uniform = this._createPassProp(name, pass);\n        }\n        else if (uniform.value === value) return;\n\n        this._dirty = true;\n        return Pass.prototype.setProperty.call(pass, name, value, directly);\n    }\n\n    setProperty (name, value, passIdx, directly) {\n        let success = false;\n        let passes = this.passes;\n        let start = 0, end = passes.length;\n        if (passIdx !== undefined) {\n            start = passIdx, end = passIdx + 1;\n        }\n        for (let i = start; i < end; i++) {\n            if (this._setPassProperty(name, value, passes[i], directly)) {\n                success = true;\n            }\n        }\n        if (!success) {\n            cc.warnID(9103, this.name, name);\n        }\n    }\n\n    getProperty (name, passIdx) {\n        let passes = this.passes;\n        if (passIdx >= passes.length) return;\n\n        let start = 0, end = passes.length;\n        if (passIdx !== undefined) {\n            start = passIdx, end = passIdx + 1;\n        }\n        for (let i = start; i < end; i++) {\n            let value = passes[i].getProperty(name);\n            if (value !== undefined) {\n                return value;\n            }\n        }\n    }\n\n    define (name, value, passIdx, force) {\n        let success = false;\n        let passes = this.passes;\n        let start = 0, end = passes.length;\n        if (passIdx !== undefined) {\n            start = passIdx, end = passIdx + 1;\n        }\n        for (let i = start; i < end; i++) {\n            if (passes[i].define(name, value, force)) {\n                success = true;\n            }\n        }\n        if (!success) {\n            cc.warnID(9104, this.name, name);\n        }\n    }\n\n    getDefine (name, passIdx) {\n        let passes = this.passes;\n        if (passIdx >= passes.length) return;\n        let start = 0, end = passes.length;\n        if (passIdx !== undefined) {\n            start = passIdx, end = passIdx + 1;\n        }\n        for (let i = start; i < end; i++) {\n            let value = passes[i].getDefine(name);\n            if (value !== undefined) {\n                return value;\n            }\n        }\n    }\n\n    setCullMode (cullMode = gfx.CULL_BACK, passIdx) {\n        let passes = this.passes;\n        let start = 0, end = passes.length;\n        if (passIdx !== undefined) {\n            start = passIdx, end = passIdx + 1;\n        }\n        for (let i = start; i < end; i++) {\n            passes[i].setCullMode(cullMode);\n        }\n        this._dirty = true;\n    }\n\n    setDepth (depthTest, depthWrite, depthFunc, passIdx) {\n        let passes = this.passes;\n        let start = 0, end = passes.length;\n        if (passIdx !== undefined) {\n            start = passIdx, end = passIdx + 1;\n        }\n        for (let i = start; i < end; i++) {\n            passes[i].setDepth(depthTest, depthWrite, depthFunc);\n        }\n        this._dirty = true;\n    }\n\n    setBlend (enabled, blendEq, blendSrc, blendDst, blendAlphaEq, blendSrcAlpha, blendDstAlpha, blendColor, passIdx) {\n        let passes = this.passes;\n        let start = 0, end = passes.length;\n        if (passIdx !== undefined) {\n            start = passIdx, end = passIdx + 1;\n        }\n        for (let i = start; i < end; i++) {\n            passes[i].setBlend(\n                enabled,\n                blendEq,\n                blendSrc, blendDst,\n                blendAlphaEq,\n                blendSrcAlpha, blendDstAlpha, blendColor\n            );\n        }\n        this._dirty = true;\n    }\n\n    setStencilEnabled (stencilTest = gfx.STENCIL_INHERIT, passIdx) {\n        let passes = this.passes;\n        let start = 0, end = passes.length;\n        if (passIdx !== undefined) {\n            start = passIdx, end = passIdx + 1;\n        }\n        for (let i = start; i < end; i++) {\n            passes[i].setStencilEnabled(stencilTest);\n        }\n        this._dirty = true;\n    }\n\n    setStencil (enabled, stencilFunc, stencilRef, stencilMask, stencilFailOp, stencilZFailOp, stencilZPassOp, stencilWriteMask, passIdx) {\n        let passes = this.passes;\n        let start = 0, end = passes.length;\n        if (passIdx !== undefined) {\n            start = passIdx, end = passIdx + 1;\n        }\n        for (let i = start; i < end; i++) {\n            let pass = passes[i];\n            pass.setStencilFront(enabled, stencilFunc, stencilRef, stencilMask, stencilFailOp, stencilZFailOp, stencilZPassOp, stencilWriteMask);\n            pass.setStencilBack(enabled, stencilFunc, stencilRef, stencilMask, stencilFailOp, stencilZFailOp, stencilZPassOp, stencilWriteMask);\n        }\n        this._dirty = true;\n    }\n}\n\ncc.EffectBase = EffectBase;\n","import Pass from '../../../renderer/core/pass';\nimport { getInspectorProps, enums2default } from '../../../renderer/types';\nimport enums from '../../../renderer/enums';\nimport Effect from './effect';\nimport Technique from '../../../renderer/core/technique';\n\nfunction getInvolvedProgram (programName) {\n    let lib = cc.renderer._forward._programLib;\n    return lib.getTemplate(programName);\n}\n\n// extract properties from each passes and check whether properties is defined but not used.\nfunction parseProperties (effectAsset, passJson) {\n    let propertiesJson = passJson.properties || {};\n    let program = getInvolvedProgram(passJson.program);\n\n    // check whether properties are defined in the shaders \n    for (let prop in propertiesJson) {\n        let uniformInfo = program.uniforms.find(u => u.name === prop);\n        // the property is not defined in all the shaders used in techs\n        if (!uniformInfo) {\n            cc.warnID(9107, effectAsset.name, prop);\n            continue;\n        }\n    }\n\n    // create properties\n    let properties = {};\n    program.uniforms.forEach(u => {\n        let name = u.name,\n            prop = properties[name] = Object.assign({}, u),\n            propInfo = propertiesJson[name];\n\n        let value = enums2default[u.type];\n        if (propInfo) {\n            if (propInfo.type === enums.PARAM_TEXTURE_2D) {\n                value = null;\n            }\n            else if (propInfo.type === enums.PARAM_INT || propInfo.type === enums.PARAM_FLOAT) {\n                value = Array.isArray(propInfo.value) ? propInfo.value[0] : propInfo.value;\n            }\n            else {\n                value = new Float32Array(propInfo.value);\n            }\n        }\n        else {\n            value = enums2default[u.type];\n        }\n\n        prop.value = value;\n    });\n\n    return properties;\n};\n\nfunction passDefines (pass) {\n    let defines = {};\n    let program = getInvolvedProgram(pass.program);\n    program.defines.forEach(d => {\n        defines[d.name] = enums2default[d.type];\n    })\n    return defines;\n}\n\nfunction parseTechniques (effectAsset) {\n    let techNum = effectAsset.techniques.length;\n    let techniques = new Array(techNum);\n    for (let j = 0; j < techNum; ++j) {\n        let tech = effectAsset.techniques[j];\n        let techName = tech.name || j;\n\n        let passNum = tech.passes.length;\n        let passes = new Array(passNum);\n        for (let k = 0; k < passNum; ++k) {\n            let pass = tech.passes[k];\n\n            let passName = pass.name || k;\n            let detailName = `${effectAsset.name}-${techName}-${passName}`;\n            let stage = pass.stage || 'opaque';\n            let properties = parseProperties(effectAsset, pass);\n            let defines = passDefines(pass);\n\n            let newPass = passes[k] = new Pass(passName, detailName, pass.program, stage, properties, defines);\n\n            // rasterizer state\n            if (pass.rasterizerState) {\n                newPass.setCullMode(pass.rasterizerState.cullMode);\n            }\n\n            // blend state\n            let blendState = pass.blendState && pass.blendState.targets[0];\n            if (blendState) {\n                newPass.setBlend(blendState.blend, blendState.blendEq, blendState.blendSrc,\n                    blendState.blendDst, blendState.blendAlphaEq, blendState.blendSrcAlpha, blendState.blendDstAlpha, blendState.blendColor);\n            }\n\n            // depth stencil state\n            let depthStencilState = pass.depthStencilState;\n            if (depthStencilState) {\n                newPass.setDepth(depthStencilState.depthTest, depthStencilState.depthWrite, depthStencilState.depthFunc);\n                newPass.setStencilFront(depthStencilState.stencilTest, depthStencilState.stencilFuncFront, depthStencilState.stencilRefFront, depthStencilState.stencilMaskFront,\n                    depthStencilState.stencilFailOpFront, depthStencilState.stencilZFailOpFront, depthStencilState.stencilZPassOpFront, depthStencilState.stencilWriteMaskFront);\n                newPass.setStencilBack(depthStencilState.stencilTest, depthStencilState.stencilFuncBack, depthStencilState.stencilRefBack, depthStencilState.stencilMaskBack,\n                    depthStencilState.stencilFailOpBack, depthStencilState.stencilZFailOpBack, depthStencilState.stencilZPassOpBack, depthStencilState.stencilWriteMaskBack);\n            }\n        }\n        techniques[j] = new Technique(techName, passes);\n    }\n\n    return techniques;\n};\n\nexport function parseEffect (effect) {\n    let techniques = parseTechniques(effect);\n    return new Effect(effect.name, techniques, 0, effect);\n};\n\nif (CC_EDITOR) {\n    // inspector only need properties defined in CCEffect\n    Effect.parseForInspector = function (effectAsset) {\n        return effectAsset.techniques.map((tech, techIdx) => {\n            let passes = tech.passes.map((pass, passIdx) => {\n                let program = getInvolvedProgram(pass.program);\n\n                let newProps = {};\n                let props = pass.properties;\n                for (let name in props) {\n                    newProps[name] = getInspectorProps(props[name]);\n                    \n                    let u = program.uniforms.find(u => u.name === name);\n                    newProps[name].defines = u.defines || [];\n                }\n\n                let newDefines = {};\n                program.defines.map(def => {\n                    newDefines[def.name] = getInspectorProps(def);\n                })\n\n                return {\n                    name: pass.name || passIdx,\n                    props: newProps,\n                    defines: newDefines,\n                };\n            })\n\n            return {\n                name: tech.name || techIdx,\n                passes: passes,\n            };\n        })\n    };\n}\n","import murmurhash2 from '../../../renderer/murmurhash2_gc';\nimport utils from './utils';\nimport Pass from '../../../renderer/core/pass';\nimport Effect from './effect';\nimport EffectBase from './effect-base';\n\nconst gfx = cc.gfx;\n\nexport default class EffectVariant extends EffectBase {\n    _effect: Effect;\n    _passes: Pass[] = [];\n    _stagePasses = {};\n    _hash = 0;\n\n    get effect () {\n        return this._effect;\n    }\n\n    get name () {\n        return this._effect && (this._effect.name + ' (variant)');\n    }\n\n    get passes () {\n        return this._passes;\n    }\n\n    get stagePasses () {\n        return this._stagePasses;\n    }\n\n    constructor (effect: Effect) {\n        super();\n        this.init(effect);\n    }\n\n    _onEffectChanged () {\n    }\n\n    init (effect: Effect) {\n        if (effect instanceof EffectVariant) {\n            effect = effect.effect;\n        }\n\n        this._effect = effect;\n        this._dirty = true;\n        \n        if (effect) {\n            let passes = effect.passes;\n            let variantPasses = this._passes;\n            variantPasses.length = 0;\n            let stagePasses = this._stagePasses = {};\n            for (let i = 0; i < passes.length; i++) {\n                let variant = variantPasses[i] = Object.setPrototypeOf({}, passes[i]);\n                variant._properties = Object.setPrototypeOf({}, passes[i]._properties);\n                variant._defines = Object.setPrototypeOf({}, passes[i]._defines);\n\n                if (!stagePasses[variant._stage]) {\n                    stagePasses[variant._stage] = [];\n                }\n                stagePasses[variant._stage].push(variant);\n            }\n        }\n    }\n\n    updateHash (hash: number) {\n\n    }\n\n    getHash () {\n        if (!this._dirty) return this._hash;\n        this._dirty = false;\n\n        let hash = '';\n        hash += utils.serializePasses(this._passes);\n\n        let effect = this._effect;\n        if (effect) {\n            hash += utils.serializePasses(effect.passes);\n        }\n\n        this._hash = murmurhash2(hash, 666);\n\n        this.updateHash(this._hash);\n\n        return this._hash;\n    }\n}\n\ncc.EffectVariant = EffectVariant;\n","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\nimport Technique from '../../../renderer/core/technique';\nimport EffectBase from './effect-base';\n\nexport default class Effect extends EffectBase {\n\n    _techniques: Technique[] = [];\n    _asset = null;\n    \n    get technique () {\n        return this._technique;\n    }\n\n    get passes () {\n        return this._technique.passes;\n    }\n\n    /**\n     * @param {Array} techniques\n     */\n    constructor (name, techniques, techniqueIndex, asset) {\n        super();\n        this.init(name, techniques, techniqueIndex, asset, true);\n    }\n\n    init (name, techniques, techniqueIndex, asset, createNative) {\n        this._name = name;\n        this._techniques = techniques;\n        this._technique = techniques[techniqueIndex];\n        this._asset = asset;\n    }\n\n    switchTechnique (index) {\n        if (index >= this._techniques.length) {\n            cc.warn(`Can not switch to technique with index [${index}]`);\n            return;\n        }\n\n        this._technique = this._techniques[index];\n    }\n\n    clear () {\n        this._techniques = [];\n    }\n\n    clone () {\n        let techniques = [];\n        for (let i = 0; i < this._techniques.length; i++) {\n            techniques.push(this._techniques[i].clone());\n        }\n\n        let techniqueIndex = this._techniques.indexOf(this._technique);\n        return new Effect(this._name, techniques, techniqueIndex, this._asset);\n    }\n}\n\ncc.Effect = Effect;\n","import './CCEffectAsset';\nimport './CCMaterial';\nimport './material-variant';\n","import utils from './utils';\nimport Pool from '../../utils/pool';\n\n/**\n * {\n *   effectUuid: {\n *     defineSerializeKey: []\n *   }\n * }\n */\nclass MaterialPool extends Pool {\n    // default disabled material pool\n    enabled = false;\n    \n    _pool = {};\n\n    get (exampleMat, renderComponent) {\n        let pool = this._pool;\n\n        if (exampleMat instanceof cc.MaterialVariant) {\n            if (exampleMat._owner) {\n                if (exampleMat._owner === renderComponent) {\n                    return exampleMat;\n                }\n                else {\n                    exampleMat = exampleMat.material;\n                }\n            }\n            else {\n                exampleMat._owner = renderComponent;\n                return exampleMat;\n            }\n        }\n\n        let instance;\n        if (this.enabled) {\n            let uuid = exampleMat.effectAsset._uuid;\n            if (pool[uuid]) {\n                let key = \n                    utils.serializeDefines(exampleMat._effect._defines) +\n                    utils.serializeTechniques(exampleMat._effect._techniques);\n                instance = pool[uuid][key] && pool[uuid][key].pop();\n            }\n        }\n    \n        if (!instance) {\n            instance = new cc.MaterialVariant(exampleMat);\n            instance._name = exampleMat._name + ' (Instance)';\n            instance._uuid = exampleMat._uuid;\n        }\n        else {\n            this.count--;\n        }\n    \n        instance._owner = renderComponent;\n    \n        return instance;\n    }\n    \n    put (mat) {\n        if (!this.enabled || !mat._owner) {\n            return;\n        }\n\n        let pool = this._pool;\n        let uuid = mat.effectAsset._uuid;\n        if (!pool[uuid]) {\n            pool[uuid] = {};\n        }\n        let key = \n            utils.serializeDefines(mat._effect._defines) +\n            utils.serializeTechniques(mat._effect._techniques);\n        if (!pool[uuid][key]) {\n            pool[uuid][key] = [];\n        }\n        if (this.count > this.maxSize) return;\n\n        this._clean(mat);\n        pool[uuid][key].push(mat);\n        this.count++;\n    }\n\n    clear () {\n        this._pool = {};\n        this.count = 0;\n    }\n\n    _clean (mat) {\n        mat._owner = null;\n    }\n}\n\nlet materialPool = new MaterialPool();\nPool.register('material', materialPool);\nexport default materialPool;\n","\nimport Material from './CCMaterial';\nimport EffectVariant from './effect-variant';\nimport MaterialPool from './material-pool';\n\nlet { ccclass, } = cc._decorator;\n\n/**\n * !#en\n * Material Variant is an extension of the Material Asset.\n * Changes to Material Variant do not affect other Material Variant or Material Asset, \n * and changes to Material Asset are synchronized to the Material Variant.\n * However, when a Material Variant had already modifies a state, the Material Asset state is not synchronized to the Material Variant.\n * !#zh \n * 材质变体是材质资源的一个延伸。\n * 材质变体的修改不会影响到其他的材质变体或者材质资源，而材质资源的修改会同步体现到材质变体上，\n * 但是当材质变体对一个状态修改后，材质资源再对这个状态修改是不会同步到材质变体上的。\n * @class MaterialVariant\n * @extends Material\n */\n@ccclass('cc.MaterialVariant')\nexport default class MaterialVariant extends Material {\n    _owner: cc.RenderComponent = null;\n    _material: Material = null;\n\n    /**\n     * @method createWithBuiltin\n     * @param {Material.BUILTIN_NAME} materialName \n     * @param {RenderComponent} owner \n     * @typescript\n     * static createWithBuiltin (materialName, owner: cc.RenderComponent): MaterialVariant | null\n     */\n    static createWithBuiltin (materialName: string, owner: cc.RenderComponent): MaterialVariant | null {\n        return MaterialVariant.create(Material.getBuiltinMaterial(materialName), owner);\n    }\n\n    /**\n     * @method create\n     * @param {Material} material \n     * @param {RenderComponent} owner \n     * @typescript\n     * static create (material: Material, owner: cc.RenderComponent): MaterialVariant | null\n     */\n    static create (material: Material, owner: cc.RenderComponent): MaterialVariant | null {\n        if (!material) return null;\n        return MaterialPool.get(material, owner);\n    }\n\n    get uuid () {\n        return this._material.uuid;\n    }\n\n    get owner () {\n        return this._owner;\n    }\n\n    get material () {\n        return this._material;\n    }\n\n    constructor (material: Material) {\n        super();\n        this.init(material);\n    }\n\n    init (material) {\n        this._effect = new EffectVariant(material.effect);\n        this._effectAsset = material._effectAsset;\n        this._material = material;\n    }\n}\n\ncc.MaterialVariant = MaterialVariant;\n","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.  \n\nimport enums from '../../../renderer/enums';\n\n// function genHashCode (str) {\n//     var hash = 0;\n//     if (str.length == 0) {\n//         return hash;\n//     }\n//     for (var i = 0; i < str.length; i++) {\n//         var char = str.charCodeAt(i);\n//         hash = ((hash<<5)-hash)+char;\n//         hash = hash & hash; // Convert to 32bit integer\n//     }\n//     return hash;\n// }\n\nfunction serializeDefines (defines) {\n    let str = '';\n    for (let name in defines) {\n        str += name + defines[name];\n    }\n    return str;\n}\n\nfunction serializePass (pass, excludeProperties) {\n    let str = pass._programName + pass._cullMode;\n    if (pass._blend) {\n        str += pass._blendEq + pass._blendAlphaEq + pass._blendSrc + pass._blendDst\n            + pass._blendSrcAlpha + pass._blendDstAlpha + pass._blendColor;\n    }\n    if (pass._depthTest) {\n        str += pass._depthWrite + pass._depthFunc;\n    }\n    if (pass._stencilTest) {\n        str += pass._stencilFuncFront + pass._stencilRefFront + pass._stencilMaskFront\n            + pass._stencilFailOpFront + pass._stencilZFailOpFront + pass._stencilZPassOpFront\n            + pass._stencilWriteMaskFront\n            + pass._stencilFuncBack + pass._stencilRefBack + pass._stencilMaskBack\n            + pass._stencilFailOpBack + pass._stencilZFailOpBack + pass._stencilZPassOpBack\n            + pass._stencilWriteMaskBack;\n    }\n\n    if (!excludeProperties) {\n        str += serializeUniforms(pass._properties);\n    }\n    str += serializeDefines(pass._defines);\n\n    return str;\n}\n\nfunction serializePasses (passes) {\n    let hashData = '';\n    for (let i = 0; i < passes.length; i++) {\n        hashData += serializePass(passes[i]);\n    }\n    return hashData;\n}\n\nfunction serializeUniforms (uniforms) {\n    let hashData = '';\n    for (let name in uniforms) {\n        let param = uniforms[name];\n        let prop = param.value;\n\n        if (!prop) {\n            continue;\n        }\n\n        if (param.type === enums.PARAM_TEXTURE_2D || param.type === enums.PARAM_TEXTURE_CUBE) {\n            hashData += prop._id + ';';\n        }\n        else {\n            hashData += prop.toString() + ';';\n        }\n    }\n\n    return hashData;\n}\n\nexport default {\n    serializeDefines,\n    serializePasses,\n    serializeUniforms\n};","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport { Mat4, Vec2, Vec3 } from '../value-types';\nimport { Ray } from '../geom-utils';\n\nconst AffineTrans = require('../utils/affine-transform');\nconst renderer = require('../renderer/index');\nconst RenderFlow = require('../renderer/render-flow');\nconst game = require('../CCGame');\n\nlet RendererCamera = null;\nif (CC_JSB && CC_NATIVERENDERER) {\n    RendererCamera = window.renderer.Camera;\n} else {\n    RendererCamera = require('../../renderer/scene/camera');\n}\n\nlet _mat4_temp_1 = cc.mat4();\nlet _mat4_temp_2 = cc.mat4();\n\nlet _v3_temp_1 = cc.v3();\nlet _v3_temp_2 = cc.v3();\nlet _v3_temp_3 = cc.v3();\n\nlet _cameras = [];\n\nlet _debugCamera = null;\n\nfunction repositionDebugCamera () {\n    if (!_debugCamera) return;\n\n    let node = _debugCamera.getNode();\n    let canvas = cc.game.canvas;\n    node.z = canvas.height / 1.1566;\n    node.x = canvas.width / 2;\n    node.y = canvas.height / 2;\n}\n\n/**\n * !#en Values for Camera.clearFlags, determining what to clear when rendering a Camera.\n * !#zh 摄像机清除标记位，决定摄像机渲染时会清除哪些状态\n * @enum Camera.ClearFlags\n */\nlet ClearFlags = cc.Enum({\n    /**\n     * !#en\n     * Clear the background color.\n     * !#zh\n     * 清除背景颜色\n     * @property COLOR\n     */\n    COLOR: 1,\n    /**\n     * !#en\n     * Clear the depth buffer.\n     * !#zh\n     * 清除深度缓冲区\n     * @property DEPTH\n     */\n    DEPTH: 2,\n    /**\n     * !#en\n     * Clear the stencil.\n     * !#zh\n     * 清除模板缓冲区\n     * @property STENCIL\n     */\n    STENCIL: 4,\n});\n\nlet StageFlags = cc.Enum({\n    OPAQUE: 1,\n    TRANSPARENT: 2\n});\n\n/**\n * !#en\n * Camera is usefull when making reel game or other games which need scroll screen.\n * Using camera will be more efficient than moving node to scroll screen.\n * Camera \n * !#zh\n * 摄像机在制作卷轴或是其他需要移动屏幕的游戏时比较有用，使用摄像机将会比移动节点来移动屏幕更加高效。\n * @class Camera\n * @extends Component\n */\nlet Camera = cc.Class({\n    name: 'cc.Camera',\n    extends: cc.Component,\n\n    ctor () {\n        if (game.renderType !== game.RENDER_TYPE_CANVAS) {\n            let camera = new RendererCamera();\n\n            camera.setStages([\n                'opaque',\n            ]);\n\n            camera.dirty = true;\n\n            this._inited = false;\n            this._camera = camera;\n        }\n        else {\n            this._inited = true;\n        }\n    },\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.others/Camera',\n        inspector: 'packages://inspector/inspectors/comps/camera.js',\n        executeInEditMode: true\n    },\n\n    properties: {\n        _cullingMask: 0xffffffff,\n        _clearFlags: ClearFlags.DEPTH | ClearFlags.STENCIL,\n        _backgroundColor: cc.color(0, 0, 0, 255),\n        _depth: 0,\n        _zoomRatio: 1,\n        _targetTexture: null,\n        _fov: 60,\n        _orthoSize: 10,\n        _nearClip: 1,\n        _farClip: 4096,\n        _ortho: true,\n        _rect: cc.rect(0, 0, 1, 1),\n        _renderStages: 1,\n        _alignWithScreen: true,\n\n        /**\n         * !#en\n         * The camera zoom ratio, only support 2D camera.\n         * !#zh\n         * 摄像机缩放比率, 只支持 2D camera。\n         * @property {Number} zoomRatio\n         */\n        zoomRatio: {\n            get () {\n                return this._zoomRatio;\n            },\n            set (value) {\n                this._zoomRatio = value;\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.zoomRatio',\n        },\n\n        /**\n         * !#en\n         * Field of view. The width of the Camera’s view angle, measured in degrees along the local Y axis.\n         * !#zh\n         * 决定摄像机视角的宽度，当摄像机处于透视投影模式下这个属性才会生效。\n         * @property {Number} fov\n         * @default 60\n         */\n        fov: {\n            get () {\n                return this._fov;\n            },\n            set (v) {\n                this._fov = v;\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.fov',\n        },\n\n        /**\n         * !#en\n         * The viewport size of the Camera when set to orthographic projection.\n         * !#zh\n         * 摄像机在正交投影模式下的视窗大小。\n         * @property {Number} orthoSize\n         * @default 10\n         */\n        orthoSize: {\n            get () {\n                return this._orthoSize;\n            },\n            set (v) {\n                this._orthoSize = v;\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.orthoSize',\n        },\n\n        /**\n         * !#en\n         * The near clipping plane.\n         * !#zh\n         * 摄像机的近剪裁面。\n         * @property {Number} nearClip\n         * @default 0.1\n         */\n        nearClip: {\n            get () {\n                return this._nearClip;\n            },\n            set (v) {\n                this._nearClip = v;\n                this._updateClippingpPlanes();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.nearClip',\n        },\n\n        /**\n         * !#en\n         * The far clipping plane.\n         * !#zh\n         * 摄像机的远剪裁面。\n         * @property {Number} farClip\n         * @default 4096\n         */\n        farClip: {\n            get () {\n                return this._farClip;\n            },\n            set (v) {\n                this._farClip = v;\n                this._updateClippingpPlanes();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.farClip',\n        },\n\n        /**\n         * !#en\n         * Is the camera orthographic (true) or perspective (false)?\n         * !#zh\n         * 设置摄像机的投影模式是正交还是透视模式。\n         * @property {Boolean} ortho\n         * @default false\n         */\n        ortho: {\n            get () {\n                return this._ortho;\n            },\n            set (v) {\n                this._ortho = v;\n                this._updateProjection();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.ortho',\n        },\n\n        /**\n         * !#en\n         * Four values (0 ~ 1) that indicate where on the screen this camera view will be drawn.\n         * !#zh\n         * 决定摄像机绘制在屏幕上哪个位置，值为（0 ~ 1）。\n         * @property {Rect} rect\n         * @default cc.rect(0,0,1,1)\n         */\n        rect: {\n            get () {\n                return this._rect;\n            },\n            set (v) {\n                this._rect = v;\n                this._updateRect();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.rect',\n        },\n\n        /**\n         * !#en\n         * This is used to render parts of the scene selectively.\n         * !#zh\n         * 决定摄像机会渲染场景的哪一部分。\n         * @property {Number} cullingMask\n         */\n        cullingMask: {\n            get () {\n                return this._cullingMask;\n            },\n            set (value) {\n                this._cullingMask = value;\n                this._updateCameraMask();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.cullingMask',\n        },\n\n        /**\n         * !#en\n         * Determining what to clear when camera rendering.\n         * !#zh\n         * 决定摄像机渲染时会清除哪些状态。\n         * @property {Camera.ClearFlags} clearFlags\n         */\n        clearFlags: {\n            get () {\n                return this._clearFlags;\n            },\n            set (value) {\n                this._clearFlags = value;\n                if (this._camera) {\n                    this._camera.setClearFlags(value);\n                }\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.clearFlags',\n        },\n\n        /**\n         * !#en\n         * The color with which the screen will be cleared.\n         * !#zh\n         * 摄像机用于清除屏幕的背景色。\n         * @property {Color} backgroundColor\n         */\n        backgroundColor: {\n            get () {\n                return this._backgroundColor;\n            },\n            set (value) {\n                this._backgroundColor = value;\n                this._updateBackgroundColor();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.backgroundColor',\n        },\n\n        /**\n         * !#en\n         * Camera's depth in the camera rendering order.\n         * !#zh\n         * 摄像机深度，用于决定摄像机的渲染顺序。\n         * @property {Number} depth\n         */\n        depth: {\n            get () {\n                return this._depth;\n            },\n            set (value) {\n                this._depth = value;\n                if (this._camera) {\n                    this._camera.setPriority(value);\n                }\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.depth',\n        },\n\n        /**\n         * !#en\n         * Destination render texture.\n         * Usually cameras render directly to screen, but for some effects it is useful to make a camera render into a texture.\n         * !#zh\n         * 摄像机渲染的目标 RenderTexture。\n         * 一般摄像机会直接渲染到屏幕上，但是有一些效果可以使用摄像机渲染到 RenderTexture 上再对 RenderTexture 进行处理来实现。\n         * @property {RenderTexture} targetTexture\n         */\n        targetTexture: {\n            get () {\n                return this._targetTexture;\n            },\n            set (value) {\n                this._targetTexture = value;\n                this._updateTargetTexture();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.targetTexture',\n        },\n\n        /**\n         * !#en\n         * Sets the camera's render stages.\n         * !#zh\n         * 设置摄像机渲染的阶段\n         * @property {Number} renderStages\n         */\n        renderStages: {\n            get () {\n                return this._renderStages;\n            },\n            set (val) {\n                this._renderStages = val;\n                this._updateStages();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.camera.renderStages',\n        },\n\n        /**\n         * !#en Whether auto align camera viewport to screen\n         * !#zh 是否自动将摄像机的视口对准屏幕\n         * @property {Boolean} alignWithScreen\n         */\n        alignWithScreen: {\n            get () {\n                return this._alignWithScreen;\n            },\n            set (v) {\n                this._alignWithScreen = v;\n            }\n        },\n\n        _is3D: {\n            get () {\n                return this.node && this.node._is3DNode;\n            }\n        }\n    },\n\n    statics: {\n        /**\n         * !#en\n         * The first enabled camera.\n         * !#zh\n         * 第一个被激活的摄像机。\n         * @property {Camera} main\n         * @static\n         */\n        main: null,\n\n        /**\n         * !#en\n         * All enabled cameras.\n         * !#zh\n         * 激活的所有摄像机。\n         * @property {[Camera]} cameras\n         * @static\n         */\n        cameras: _cameras,\n\n        ClearFlags: ClearFlags,\n\n        /**\n         * !#en\n         * Get the first camera which the node belong to.\n         * !#zh\n         * 获取节点所在的第一个摄像机。\n         * @method findCamera\n         * @param {Node} node \n         * @return {Camera}\n         * @static\n         */\n        findCamera (node) {\n            for (let i = 0, l = _cameras.length; i < l; i++) {\n                let camera = _cameras[i];\n                if (camera.containsNode(node)) {\n                    return camera;\n                }\n            }\n\n            return null;\n        },\n\n        _findRendererCamera (node) {\n            let cameras = renderer.scene._cameras;\n            for (let i = 0; i < cameras._count; i++) {\n                if (cameras._data[i]._cullingMask & node._cullingMask) {\n                    return cameras._data[i];\n                }\n            }\n            return null;\n        },\n\n        _setupDebugCamera () {\n            if (_debugCamera) return;\n            if (game.renderType === game.RENDER_TYPE_CANVAS) return;\n            let camera = new RendererCamera();\n            _debugCamera = camera;\n\n            camera.setStages([\n                'opaque',\n            ]);\n            \n            camera.setFov(Math.PI * 60 / 180);\n            camera.setNear(0.1);\n            camera.setFar(4096);\n\n            camera.dirty = true;\n\n            camera.cullingMask = 1 << cc.Node.BuiltinGroupIndex.DEBUG;\n            camera.setPriority(cc.macro.MAX_ZINDEX);\n            camera.setClearFlags(0);\n            camera.setColor(0, 0, 0, 0);\n\n            let node = new cc.Node();\n            camera.setNode(node);\n\n            repositionDebugCamera();\n            cc.view.on('design-resolution-changed', repositionDebugCamera);\n\n            renderer.scene.addCamera(camera);\n        }\n    },\n\n    _updateCameraMask () {\n        if (this._camera) {\n            let mask = this._cullingMask & (~(1 << cc.Node.BuiltinGroupIndex.DEBUG));\n            this._camera.cullingMask = mask;\n        }\n    },\n\n    _updateBackgroundColor () {\n        if (!this._camera) return;\n\n        let color = this._backgroundColor;\n        this._camera.setColor(\n            color.r / 255,\n            color.g / 255,\n            color.b / 255,\n            color.a / 255,\n        );\n    },\n\n    _updateTargetTexture () {\n        if (!this._camera) return;\n\n        let texture = this._targetTexture;\n        this._camera.setFrameBuffer(texture ? texture._framebuffer : null);\n    },\n\n    _updateClippingpPlanes () {\n        if (!this._camera) return;\n        this._camera.setNear(this._nearClip);\n        this._camera.setFar(this._farClip);\n    },\n\n    _updateProjection () {\n        if (!this._camera) return;\n        let type = this._ortho ? 1 : 0;\n        this._camera.setType(type);\n    },\n\n    _updateRect () {\n        if (!this._camera) return;\n        let rect = this._rect;\n        this._camera.setRect(rect.x, rect.y, rect.width, rect.height);\n    },\n\n    _updateStages () {\n        let flags = this._renderStages;\n        let stages = [];\n        if (flags & StageFlags.OPAQUE) {\n            stages.push('opaque');\n        }\n        if (flags & StageFlags.TRANSPARENT) {\n            stages.push('transparent');\n        }\n        this._camera.setStages(stages);\n    },\n\n    _init () {\n        if (this._inited) return;\n        this._inited = true;\n\n        let camera = this._camera;\n        if (!camera) return;\n        camera.setNode(this.node);\n        camera.setClearFlags(this._clearFlags);\n        camera.setPriority(this._depth);\n        this._updateBackgroundColor();\n        this._updateCameraMask();\n        this._updateTargetTexture();\n        this._updateClippingpPlanes();\n        this._updateProjection();\n        this._updateStages();\n        this._updateRect();\n        this.beforeDraw();\n    },\n\n    onLoad () {\n        this._init();\n    },\n\n    onEnable () {\n        if (!CC_EDITOR && game.renderType !== game.RENDER_TYPE_CANVAS) {\n            cc.director.on(cc.Director.EVENT_BEFORE_DRAW, this.beforeDraw, this);\n            renderer.scene.addCamera(this._camera);\n        }\n        _cameras.push(this);\n    },\n\n    onDisable () {\n        if (!CC_EDITOR && game.renderType !== game.RENDER_TYPE_CANVAS) {\n            cc.director.off(cc.Director.EVENT_BEFORE_DRAW, this.beforeDraw, this);\n            renderer.scene.removeCamera(this._camera);\n        }\n        cc.js.array.remove(_cameras, this);\n    },\n\n    /**\n     * !#en\n     * Get the screen to world matrix, only support 2D camera which alignWithScreen is true.\n     * !#zh\n     * 获取屏幕坐标系到世界坐标系的矩阵，只适用于 alignWithScreen 为 true 的 2D 摄像机。\n     * @method getScreenToWorldMatrix2D\n     * @param {Mat4} out - the matrix to receive the result\n     * @return {Mat4} out\n     */\n    getScreenToWorldMatrix2D (out) {\n        this.getWorldToScreenMatrix2D(out);\n        Mat4.invert(out, out);\n        return out;\n    },\n\n    /**\n     * !#en\n     * Get the world to camera matrix, only support 2D camera which alignWithScreen is true.\n     * !#zh\n     * 获取世界坐标系到摄像机坐标系的矩阵，只适用于 alignWithScreen 为 true 的 2D 摄像机。\n     * @method getWorldToScreenMatrix2D\n     * @param {Mat4} out - the matrix to receive the result\n     * @return {Mat4} out\n     */\n    getWorldToScreenMatrix2D (out) {\n        this.node.getWorldRT(_mat4_temp_1);\n\n        let zoomRatio = this.zoomRatio;\n        let _mat4_temp_1m = _mat4_temp_1.m;\n        _mat4_temp_1m[0] *= zoomRatio;\n        _mat4_temp_1m[1] *= zoomRatio;\n        _mat4_temp_1m[4] *= zoomRatio;\n        _mat4_temp_1m[5] *= zoomRatio;\n\n        let m12 = _mat4_temp_1m[12];\n        let m13 = _mat4_temp_1m[13];\n\n        let center = cc.visibleRect.center;\n        _mat4_temp_1m[12] = center.x - (_mat4_temp_1m[0] * m12 + _mat4_temp_1m[4] * m13);\n        _mat4_temp_1m[13] = center.y - (_mat4_temp_1m[1] * m12 + _mat4_temp_1m[5] * m13);\n\n        if (out !== _mat4_temp_1) {\n            Mat4.copy(out, _mat4_temp_1);\n        }\n        return out;\n    },\n\n    /**\n     * !#en\n     * Convert point from screen to world.\n     * !#zh\n     * 将坐标从屏幕坐标系转换到世界坐标系。\n     * @method getScreenToWorldPoint\n     * @param {Vec3|Vec2} screenPosition \n     * @param {Vec3|Vec2} [out] \n     * @return {Vec3|Vec2} out\n     */\n    getScreenToWorldPoint (screenPosition, out) {\n        if (this.node.is3DNode) {\n            out = out || new cc.Vec3();\n            this._camera.screenToWorld(out, screenPosition, cc.visibleRect.width, cc.visibleRect.height);\n        }\n        else {\n            out = out || new cc.Vec2();\n            this.getScreenToWorldMatrix2D(_mat4_temp_1);\n            Vec2.transformMat4(out, screenPosition, _mat4_temp_1);\n        }\n        return out;\n    },\n\n    /**\n     * !#en\n     * Convert point from world to screen.\n     * !#zh\n     * 将坐标从世界坐标系转化到屏幕坐标系。\n     * @method getWorldToScreenPoint\n     * @param {Vec3|Vec2} worldPosition \n     * @param {Vec3|Vec2} [out] \n     * @return {Vec3|Vec2} out\n     */\n    getWorldToScreenPoint (worldPosition, out) {\n        if (this.node.is3DNode) {\n            out = out || new cc.Vec3();\n            this._camera.worldToScreen(out, worldPosition, cc.visibleRect.width, cc.visibleRect.height);\n        }\n        else {\n            out = out || new cc.Vec2();\n            this.getWorldToScreenMatrix2D(_mat4_temp_1);\n            Vec2.transformMat4(out, worldPosition, _mat4_temp_1);\n        }\n        \n        return out;\n    },\n\n    /**\n     * !#en\n     * Get a ray from screen position\n     * !#zh\n     * 从屏幕坐标获取一条射线\n     * @method getRay\n     * @param {Vec2} screenPos\n     * @return {Ray}\n     */\n    getRay (screenPos) {\n        if (!cc.geomUtils) return screenPos;\n        \n        Vec3.set(_v3_temp_3, screenPos.x, screenPos.y, 1);\n        this._camera.screenToWorld(_v3_temp_2, _v3_temp_3, cc.visibleRect.width, cc.visibleRect.height);\n\n        if (this.ortho) {\n            Vec3.set(_v3_temp_3, screenPos.x, screenPos.y, -1);\n            this._camera.screenToWorld(_v3_temp_1, _v3_temp_3, cc.visibleRect.width, cc.visibleRect.height);\n        }\n        else {\n            this.node.getWorldPosition(_v3_temp_1);\n        }\n\n        return Ray.fromPoints(new Ray(), _v3_temp_1, _v3_temp_2);\n    },\n\n    /**\n     * !#en\n     * Check whether the node is in the camera.\n     * !#zh\n     * 检测节点是否被此摄像机影响\n     * @method containsNode\n     * @param {Node} node - the node which need to check\n     * @return {Boolean}\n     */\n    containsNode (node) {\n        return node._cullingMask & this.cullingMask;\n    },\n\n    /**\n     * !#en\n     * Render the camera manually.\n     * !#zh\n     * 手动渲染摄像机。\n     * @method render\n     * @param {Node} root \n     */\n    render (root) {\n        root = root || cc.director.getScene();\n        if (!root) return null;\n\n        // force update node world matrix\n        this.node.getWorldMatrix(_mat4_temp_1);\n        this.beforeDraw();\n        RenderFlow.render(root);\n        if (!CC_JSB) {\n            renderer._forward.renderCamera(this._camera, renderer.scene);\n        }\n    },\n\n    _onAlignWithScreen () {\n        let height = cc.game.canvas.height / cc.view._scaleY;\n\n        let targetTexture = this._targetTexture;\n        if (targetTexture) {\n            if (CC_EDITOR) {\n                height = cc.engine.getDesignResolutionSize().height;\n            }\n            else {\n                height = cc.visibleRect.height;\n            }\n        }\n\n        let fov = this._fov * cc.macro.RAD;\n        this.node.z = height / (Math.tan(fov / 2) * 2);\n\n        fov = Math.atan(Math.tan(fov / 2) / this.zoomRatio) * 2;\n        this._camera.setFov(fov);\n        this._camera.setOrthoHeight(height / 2 / this.zoomRatio);\n        this.node.setRotation(0, 0, 0, 1);\n    },\n\n    beforeDraw () {\n        if (!this._camera) return;\n\n        if (this._alignWithScreen) {\n            this._onAlignWithScreen();\n        }\n        else {\n            let fov = this._fov * cc.macro.RAD;\n            fov = Math.atan(Math.tan(fov / 2) / this.zoomRatio) * 2;\n            this._camera.setFov(fov);\n\n            this._camera.setOrthoHeight(this._orthoSize / this.zoomRatio);\n        }\n\n        this._camera.dirty = true;\n    }\n});\n\n// deprecated\ncc.js.mixin(Camera.prototype, {\n    /**\n     * !#en\n     * Returns the matrix that transform the node's (local) space coordinates into the camera's space coordinates.\n     * !#zh\n     * 返回一个将节点坐标系转换到摄像机坐标系下的矩阵\n     * @method getNodeToCameraTransform\n     * @deprecated since v2.0.0\n     * @param {Node} node - the node which should transform\n     * @return {AffineTransform}\n     */\n    getNodeToCameraTransform (node) {\n        let out = AffineTrans.identity();\n        node.getWorldMatrix(_mat4_temp_2);\n        if (this.containsNode(node)) {\n            this.getWorldToCameraMatrix(_mat4_temp_1);\n            Mat4.mul(_mat4_temp_2, _mat4_temp_2, _mat4_temp_1);\n        }\n        AffineTrans.fromMat4(out, _mat4_temp_2);\n        return out;\n    },\n\n    /**\n     * !#en\n     * Conver a camera coordinates point to world coordinates.\n     * !#zh\n     * 将一个摄像机坐标系下的点转换到世界坐标系下。\n     * @method getCameraToWorldPoint\n     * @deprecated since v2.1.3\n     * @param {Vec2} point - the point which should transform\n     * @param {Vec2} [out] - the point to receive the result\n     * @return {Vec2} out\n     */\n    getCameraToWorldPoint (point, out) {\n        return this.getScreenToWorldPoint(point, out);\n    },\n\n    /**\n     * !#en\n     * Conver a world coordinates point to camera coordinates.\n     * !#zh\n     * 将一个世界坐标系下的点转换到摄像机坐标系下。\n     * @method getWorldToCameraPoint\n     * @deprecated since v2.1.3\n     * @param {Vec2} point \n     * @param {Vec2} [out] - the point to receive the result\n     * @return {Vec2} out\n     */\n    getWorldToCameraPoint (point, out) {\n        return this.getWorldToScreenPoint(point, out);\n    },\n\n    /**\n     * !#en\n     * Get the camera to world matrix\n     * !#zh\n     * 获取摄像机坐标系到世界坐标系的矩阵\n     * @method getCameraToWorldMatrix\n     * @deprecated since v2.1.3\n     * @param {Mat4} out - the matrix to receive the result\n     * @return {Mat4} out\n     */\n    getCameraToWorldMatrix (out) {\n        return this.getScreenToWorldMatrix2D(out);\n    },\n\n\n    /**\n     * !#en\n     * Get the world to camera matrix\n     * !#zh\n     * 获取世界坐标系到摄像机坐标系的矩阵\n     * @method getWorldToCameraMatrix\n     * @deprecated since v2.1.3\n     * @param {Mat4} out - the matrix to receive the result\n     * @return {Mat4} out\n     */\n    getWorldToCameraMatrix (out) {\n        return this.getWorldToScreenMatrix2D(out);\n    },\n});\n\nmodule.exports = cc.Camera = Camera;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('./platform/CCClass');\nvar Flags = require('./platform/CCObject').Flags;\nvar jsArray = require('./platform/js').array;\n\nvar IsStartCalled = Flags.IsStartCalled;\nvar IsOnEnableCalled = Flags.IsOnEnableCalled;\nvar IsEditorOnEnableCalled = Flags.IsEditorOnEnableCalled;\n\nvar callerFunctor = CC_EDITOR && require('./utils/misc').tryCatchFunctor_EDITOR;\nvar callOnEnableInTryCatch = CC_EDITOR && callerFunctor('onEnable');\nvar callOnDisableInTryCatch = CC_EDITOR && callerFunctor('onDisable');\n\nfunction sortedIndex (array, comp) {\n    var order = comp.constructor._executionOrder;\n    var id = comp._id;\n    for (var l = 0, h = array.length - 1, m = h >>> 1;\n         l <= h;\n         m = (l + h) >>> 1\n    ) {\n        var test = array[m];\n        var testOrder = test.constructor._executionOrder;\n        if (testOrder > order) {\n            h = m - 1;\n        }\n        else if (testOrder < order) {\n            l = m + 1;\n        }\n        else {\n            var testId = test._id;\n            if (testId > id) {\n                h = m - 1;\n            }\n            else if (testId < id) {\n                l = m + 1;\n            }\n            else {\n                return m;\n            }\n        }\n    }\n    return ~l;\n}\n\n// remove disabled and not invoked component from array\nfunction stableRemoveInactive (iterator, flagToClear) {\n    var array = iterator.array;\n    var next = iterator.i + 1;\n    while (next < array.length) {\n        var comp = array[next];\n        if (comp._enabled && comp.node._activeInHierarchy) {\n            ++next;\n        }\n        else {\n            iterator.removeAt(next);\n            if (flagToClear) {\n                comp._objFlags &= ~flagToClear;\n            }\n        }\n    }\n}\n\n// This class contains some queues used to invoke life-cycle methods by script execution order\nvar LifeCycleInvoker = cc.Class({\n    __ctor__ (invokeFunc) {\n        var Iterator = jsArray.MutableForwardIterator;\n        // components which priority === 0 (default)\n        this._zero = new Iterator([]);\n        // components which priority < 0\n        this._neg = new Iterator([]);\n        // components which priority > 0\n        this._pos = new Iterator([]);\n\n        if (CC_TEST) {\n            cc.assert(typeof invokeFunc === 'function', 'invokeFunc must be type function');\n        }\n        this._invoke = invokeFunc;\n    },\n    statics: {\n        stableRemoveInactive\n    },\n    add: null,\n    remove: null,\n    invoke: null,\n});\n\nfunction compareOrder (a, b) {\n    return a.constructor._executionOrder - b.constructor._executionOrder;\n}\n\n// for onLoad: sort once all components registered, invoke once\nvar OneOffInvoker = cc.Class({\n    extends: LifeCycleInvoker,\n    add (comp) {\n        var order = comp.constructor._executionOrder;\n        (order === 0 ? this._zero : (order < 0 ? this._neg : this._pos)).array.push(comp);\n    },\n    remove (comp) {\n        var order = comp.constructor._executionOrder;\n        (order === 0 ? this._zero : (order < 0 ? this._neg : this._pos)).fastRemove(comp);\n    },\n    cancelInactive (flagToClear) {\n        stableRemoveInactive(this._zero, flagToClear);\n        stableRemoveInactive(this._neg, flagToClear);\n        stableRemoveInactive(this._pos, flagToClear);\n    },\n    invoke () {\n        var compsNeg = this._neg;\n        if (compsNeg.array.length > 0) {\n            compsNeg.array.sort(compareOrder);\n            this._invoke(compsNeg);\n            compsNeg.array.length = 0;\n        }\n\n        this._invoke(this._zero);\n        this._zero.array.length = 0;\n\n        var compsPos = this._pos;\n        if (compsPos.array.length > 0) {\n            compsPos.array.sort(compareOrder);\n            this._invoke(compsPos);\n            compsPos.array.length = 0;\n        }\n    },\n});\n\n// for update: sort every time new component registered, invoke many times\nvar ReusableInvoker = cc.Class({\n    extends: LifeCycleInvoker,\n    add (comp) {\n        var order = comp.constructor._executionOrder;\n        if (order === 0) {\n            this._zero.array.push(comp);\n        }\n        else {\n            var array = order < 0 ? this._neg.array : this._pos.array;\n            var i = sortedIndex(array, comp);\n            if (i < 0) {\n                array.splice(~i, 0, comp);\n            }\n            else if (CC_DEV) {\n                cc.error('component already added');\n            }\n        }\n    },\n    remove (comp) {\n        var order = comp.constructor._executionOrder;\n        if (order === 0) {\n            this._zero.fastRemove(comp);\n        }\n        else {\n            var iterator = order < 0 ? this._neg : this._pos;\n            var i = sortedIndex(iterator.array, comp);\n            if (i >= 0) {\n                iterator.removeAt(i);\n            }\n        }\n    },\n    invoke (dt) {\n        if (this._neg.array.length > 0) {\n            this._invoke(this._neg, dt);\n        }\n\n        this._invoke(this._zero, dt);\n\n        if (this._pos.array.length > 0) {\n            this._invoke(this._pos, dt);\n        }\n    },\n});\n\nfunction enableInEditor (comp) {\n    if (!(comp._objFlags & IsEditorOnEnableCalled)) {\n        cc.engine.emit('component-enabled', comp.uuid);\n        comp._objFlags |= IsEditorOnEnableCalled;\n    }\n}\n\n// return function to simply call each component with try catch protection\nfunction createInvokeImpl (indiePath, useDt, ensureFlag, fastPath) {\n    if (CC_SUPPORT_JIT) {\n        // function (it) {\n        //     var a = it.array;\n        //     for (it.i = 0; it.i < a.length; ++it.i) {\n        //         var c = a[it.i];\n        //         // ...\n        //     }\n        // }\n        let body = 'var a=it.array;' +\n                   'for(it.i=0;it.i<a.length;++it.i){' +\n                   'var c=a[it.i];' +\n                   indiePath +\n                   '}';\n        fastPath = useDt ? Function('it', 'dt', body) : Function('it', body);\n        indiePath = Function('c', 'dt', indiePath);\n    }\n    return function (iterator, dt) {\n        try {\n            fastPath(iterator, dt);\n        }\n        catch (e) {\n            // slow path\n            cc._throw(e);\n            var array = iterator.array;\n            if (ensureFlag) {\n                array[iterator.i]._objFlags |= ensureFlag;\n            }\n            ++iterator.i;   // invoke next callback\n            for (; iterator.i < array.length; ++iterator.i) {\n                try {\n                    indiePath(array[iterator.i], dt);\n                }\n                catch (e) {\n                    cc._throw(e);\n                    if (ensureFlag) {\n                        array[iterator.i]._objFlags |= ensureFlag;\n                    }\n                }\n            }\n        }\n    };\n}\n\nvar invokeStart = CC_SUPPORT_JIT ?\n    createInvokeImpl('c.start();c._objFlags|=' + IsStartCalled, false, IsStartCalled) :\n    createInvokeImpl(function (c) {\n            c.start();\n            c._objFlags |= IsStartCalled;\n        },\n        false,\n        IsStartCalled,\n        function (iterator) {\n            var array = iterator.array;\n            for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n                let comp = array[iterator.i];\n                comp.start();\n                comp._objFlags |= IsStartCalled;\n            }\n        }\n    );\nvar invokeUpdate = CC_SUPPORT_JIT ?\n    createInvokeImpl('c.update(dt)', true) :\n    createInvokeImpl(function (c, dt) {\n            c.update(dt);\n        },\n        true,\n        undefined,\n        function (iterator, dt) {\n            var array = iterator.array;\n            for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n                array[iterator.i].update(dt);\n            }\n        }\n    );\nvar invokeLateUpdate = CC_SUPPORT_JIT ?\n    createInvokeImpl('c.lateUpdate(dt)', true) :\n    createInvokeImpl(function (c, dt) {\n            c.lateUpdate(dt);\n        },\n        true,\n        undefined,\n        function (iterator, dt) {\n            var array = iterator.array;\n            for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n                array[iterator.i].lateUpdate(dt);\n            }\n        }\n    );\n/**\n * The Manager for Component's life-cycle methods.\n */\nfunction ctor () {\n    // invokers\n    this.startInvoker = new OneOffInvoker(invokeStart);\n    this.updateInvoker = new ReusableInvoker(invokeUpdate);\n    this.lateUpdateInvoker = new ReusableInvoker(invokeLateUpdate);\n\n    // components deferred to next frame\n    this.scheduleInNextFrame = [];\n\n    // during a loop\n    this._updating = false;\n}\nvar ComponentScheduler = cc.Class({\n    ctor: ctor,\n    unscheduleAll: ctor,\n\n    statics: {\n        LifeCycleInvoker,\n        OneOffInvoker,\n        createInvokeImpl,\n        invokeOnEnable: CC_EDITOR ? function (iterator) {\n            var compScheduler = cc.director._compScheduler;\n            var array = iterator.array;\n            for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n                let comp = array[iterator.i];\n                if (comp._enabled) {\n                    callOnEnableInTryCatch(comp);\n                    var deactivatedDuringOnEnable = !comp.node._activeInHierarchy;\n                    if (!deactivatedDuringOnEnable) {\n                        compScheduler._onEnabled(comp);\n                    }\n                }\n            }\n        } : function (iterator) {\n            var compScheduler = cc.director._compScheduler;\n            var array = iterator.array;\n            for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n                let comp = array[iterator.i];\n                if (comp._enabled) {\n                    comp.onEnable();\n                    var deactivatedDuringOnEnable = !comp.node._activeInHierarchy;\n                    if (!deactivatedDuringOnEnable) {\n                        compScheduler._onEnabled(comp);\n                    }\n                }\n            }\n        }\n    },\n\n    _onEnabled (comp) {\n        cc.director.getScheduler().resumeTarget(comp);\n        comp._objFlags |= IsOnEnableCalled;\n\n        // schedule\n        if (this._updating) {\n            this.scheduleInNextFrame.push(comp);\n        }\n        else {\n            this._scheduleImmediate(comp);\n        }\n    },\n\n    _onDisabled (comp) {\n        cc.director.getScheduler().pauseTarget(comp);\n        comp._objFlags &= ~IsOnEnableCalled;\n\n        // cancel schedule task\n        var index = this.scheduleInNextFrame.indexOf(comp);\n        if (index >= 0) {\n            jsArray.fastRemoveAt(this.scheduleInNextFrame, index);\n            return;\n        }\n\n        // unschedule\n        if (comp.start && !(comp._objFlags & IsStartCalled)) {\n            this.startInvoker.remove(comp);\n        }\n        if (comp.update) {\n            this.updateInvoker.remove(comp);\n        }\n        if (comp.lateUpdate) {\n            this.lateUpdateInvoker.remove(comp);\n        }\n    },\n\n    enableComp: CC_EDITOR ? function (comp, invoker) {\n        if (cc.engine.isPlaying || comp.constructor._executeInEditMode) {\n            if (!(comp._objFlags & IsOnEnableCalled)) {\n                if (comp.onEnable) {\n                    if (invoker) {\n                        invoker.add(comp);\n                        enableInEditor(comp);\n                        return;\n                    }\n                    else {\n                        callOnEnableInTryCatch(comp);\n\n                        var deactivatedDuringOnEnable = !comp.node._activeInHierarchy;\n                        if (deactivatedDuringOnEnable) {\n                            return;\n                        }\n                    }\n                }\n                this._onEnabled(comp);\n            }\n        }\n        enableInEditor(comp);\n    } : function (comp, invoker) {\n        if (!(comp._objFlags & IsOnEnableCalled)) {\n            if (comp.onEnable) {\n                if (invoker) {\n                    invoker.add(comp);\n                    return;\n                }\n                else {\n                    comp.onEnable();\n\n                    var deactivatedDuringOnEnable = !comp.node._activeInHierarchy;\n                    if (deactivatedDuringOnEnable) {\n                        return;\n                    }\n                }\n            }\n            this._onEnabled(comp);\n        }\n    },\n\n    disableComp: CC_EDITOR ? function (comp) {\n        if (cc.engine.isPlaying || comp.constructor._executeInEditMode) {\n            if (comp._objFlags & IsOnEnableCalled) {\n                if (comp.onDisable) {\n                    callOnDisableInTryCatch(comp);\n                }\n                this._onDisabled(comp);\n            }\n        }\n        if (comp._objFlags & IsEditorOnEnableCalled) {\n            cc.engine.emit('component-disabled', comp.uuid);\n            comp._objFlags &= ~IsEditorOnEnableCalled;\n        }\n    } : function (comp) {\n        if (comp._objFlags & IsOnEnableCalled) {\n            if (comp.onDisable) {\n                comp.onDisable();\n            }\n            this._onDisabled(comp);\n        }\n    },\n\n    _scheduleImmediate (comp) {\n        if (comp.start && !(comp._objFlags & IsStartCalled)) {\n            this.startInvoker.add(comp);\n        }\n        if (comp.update) {\n            this.updateInvoker.add(comp);\n        }\n        if (comp.lateUpdate) {\n            this.lateUpdateInvoker.add(comp);\n        }\n    },\n\n    _deferredSchedule () {\n        var comps = this.scheduleInNextFrame;\n        for (var i = 0, len = comps.length; i < len; i++) {\n            var comp = comps[i];\n            this._scheduleImmediate(comp);\n        }\n        comps.length = 0;\n    },\n\n    // Call new registered start schedule immediately since last time start phase calling in this frame\n    // See cocos-creator/2d-tasks/issues/256\n    _earlyStartForNewComps () {\n        if (this.scheduleInNextFrame.length > 0) {\n            this._deferredSchedule();\n            this.startInvoker.invoke();\n        }\n    },\n\n    startPhase () {\n        // Start of this frame\n        this._updating = true;\n\n        if (this.scheduleInNextFrame.length > 0) {\n            this._deferredSchedule();\n        }\n\n        // call start\n        this.startInvoker.invoke();\n\n        // As is often the case, _deferredSchedule should clear scheduleInNextFrame,\n        // once not cleared, it indicates that there is a node activated during start\n        this._earlyStartForNewComps();\n\n        // if (CC_PREVIEW) {\n        //     try {\n        //         this.startInvoker.invoke();\n        //     }\n        //     catch (e) {\n        //         // prevent start from getting into infinite loop\n        //         this.startInvoker._neg.array.length = 0;\n        //         this.startInvoker._zero.array.length = 0;\n        //         this.startInvoker._pos.array.length = 0;\n        //         throw e;\n        //     }\n        // }\n        // else {\n        //     this.startInvoker.invoke();\n        // }\n    },\n\n    updatePhase (dt) {\n        this.updateInvoker.invoke(dt);\n    },\n\n    lateUpdatePhase (dt) {\n        this.lateUpdateInvoker.invoke(dt);\n\n        // End of this frame\n        this._updating = false;\n    },\n\n    clearup () {\n        this._earlyStartForNewComps();\n    },\n});\n\nmodule.exports = ComponentScheduler;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst AnimationAnimator = require('../../animation/animation-animator');\nconst AnimationClip = require('../../animation/animation-clip');\nconst EventTarget = require('../event/event-target');\nconst js = require('../platform/js');\n\nlet equalClips = CC_EDITOR ? function (clip1, clip2) {\n    return clip1 === clip2 || (clip1 && clip2 && (clip1.name === clip2.name || clip1._uuid === clip2._uuid));\n} : function (clip1, clip2) {\n    return clip1 === clip2;\n};\n\n/**\n * !#en The event type supported by Animation\n * !#zh Animation 支持的事件类型\n * @class Animation.EventType\n * @static\n * @namespace Animationd\n */\nlet EventType = cc.Enum({\n    /**\n     * !#en Emit when begin playing animation\n     * !#zh 开始播放时触发\n     * @property {String} PLAY\n     * @static\n     */\n    PLAY: 'play',\n    /**\n     * !#en Emit when stop playing animation\n     * !#zh 停止播放时触发\n     * @property {String} STOP\n     * @static\n     */\n    STOP: 'stop',\n    /**\n     * !#en Emit when pause animation\n     * !#zh 暂停播放时触发\n     * @property {String} PAUSE   \n     * @static\n     */\n    PAUSE: 'pause',\n    /**\n     * !#en Emit when resume animation\n     * !#zh 恢复播放时触发\n     * @property {String} RESUME\n     * @static\n     */\n    RESUME: 'resume',\n    /**\n     * !#en If animation repeat count is larger than 1, emit when animation play to the last frame\n     * !#zh 假如动画循环次数大于 1，当动画播放到最后一帧时触发\n     * @property {String} LASTFRAME\n     * @static\n     */\n    LASTFRAME: 'lastframe',\n    /**\n     * !#en Emit when finish playing animation\n     * !#zh 动画播放完成时触发\n     * @property {String} FINISHED\n     * @static\n     */\n    FINISHED: 'finished'\n});\n\n/**\n * !#en The animation component is used to play back animations.\n *   \n * Animation provide several events to register：\n *  - play : Emit when begin playing animation\n *  - stop : Emit when stop playing animation\n *  - pause : Emit when pause animation\n *  - resume : Emit when resume animation\n *  - lastframe : If animation repeat count is larger than 1, emit when animation play to the last frame\n *  - finished : Emit when finish playing animation\n *\n * !#zh Animation 组件用于播放动画。\n *   \n * Animation 提供了一系列可注册的事件：\n *  - play : 开始播放时\n *  - stop : 停止播放时\n *  - pause : 暂停播放时\n *  - resume : 恢复播放时\n *  - lastframe : 假如动画循环次数大于 1，当动画播放到最后一帧时\n *  - finished : 动画播放完成时\n * \n * @class Animation\n * @extends Component\n * @uses EventTarget\n */\nlet Animation = cc.Class({\n    name: 'cc.Animation',\n    extends: require('./CCComponent'),\n    mixins: [EventTarget],\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.others/Animation',\n        help: 'i18n:COMPONENT.help_url.animation',\n        executeInEditMode: true,\n    },\n\n    statics: {\n        EventType\n    },\n\n    ctor: function () {\n        cc.EventTarget.call(this);\n\n        // The actual implement for Animation\n        this._animator = null;\n\n        this._nameToState = js.createMap(true);\n        this._didInit = false;\n\n        this._currentClip = null;\n    },\n\n    properties: {\n\n        _defaultClip: {\n            default: null,\n            type: AnimationClip,\n        },\n\n        /**\n         * !#en Animation will play the default clip when start game.\n         * !#zh 在勾选自动播放或调用 play() 时默认播放的动画剪辑。\n         * @property defaultClip\n         * @type {AnimationClip}\n         */\n        defaultClip: {\n            type: AnimationClip,\n            get: function () {\n                return this._defaultClip;\n            },\n            set: function (value) {\n                if (!CC_EDITOR || (cc.engine && cc.engine.isPlaying)) {\n                    return;\n                }\n\n                if (this._defaultClip) {\n                    this.removeClip(this._defaultClip, true);\n                }\n                if (value) {\n                    this.addClip(value);\n                }\n                this._defaultClip = value;\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.animation.default_clip'\n        },\n\n        /**\n         * !#en Current played clip.\n         * !#zh 当前播放的动画剪辑。\n         * @property currentClip\n         * @type {AnimationClip}\n         */\n        currentClip: {\n            get: function () {\n                return this._currentClip;\n            },\n            set: function (value) {\n                this._currentClip = value;\n            },\n            type: AnimationClip,\n            visible: false\n        },\n\n        // This property is used to watch clip changes in editor.\n        // Don't use in your game, use addClip/removeClip instead.\n        _writableClips: {\n            get () {\n                return this._clips;\n            },\n            set (val) {\n                this._didInit = false;\n                this._clips = val;\n                this._init();\n            },\n            type: [AnimationClip],\n        },\n\n        /**\n         * !#en All the clips used in this animation.\n         * !#zh 通过脚本可以访问并播放的 AnimationClip 列表。\n         * @property _clips\n         * @type {AnimationClip[]}\n         * @private\n         */\n        _clips: {\n            default: [],\n            type: [AnimationClip],\n            tooltip: CC_DEV && 'i18n:COMPONENT.animation.clips',\n            visible: true\n        },\n\n        /**\n         * !#en Whether the animation should auto play the default clip when start game.\n         * !#zh 是否在运行游戏后自动播放默认动画剪辑。\n         * @property playOnLoad\n         * @type {Boolean}\n         * @default true\n         */\n        playOnLoad: {\n            default: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.animation.play_on_load'\n        }\n    },\n\n    start: function () {\n        if (!CC_EDITOR && this.playOnLoad && this._defaultClip) {\n            let isPlaying = this._animator && this._animator.isPlaying;\n            if (!isPlaying) {\n                let state = this.getAnimationState(this._defaultClip.name);\n                this._animator.playState(state);\n            }\n        }\n    },\n\n    onEnable: function () {\n        if (this._animator) {\n            this._animator.resume();\n        }\n    },\n\n    onDisable: function () {\n        if (this._animator) {\n            this._animator.pause();\n        }\n    },\n\n    onDestroy: function () {\n        this.stop();\n    },\n\n    ///////////////////////////////////////////////////////////////////////////////\n    // Public Methods\n    ///////////////////////////////////////////////////////////////////////////////\n\n    /**\n     * !#en Get all the clips used in this animation.\n     * !#zh 获取动画组件上的所有动画剪辑。\n     * @method getClips\n     * @return {AnimationClip[]}\n     */\n    getClips: function () {\n        return this._clips;\n    },\n\n    /**\n     * !#en Plays an animation and stop other animations.\n     * !#zh 播放指定的动画，并且停止当前正在播放动画。如果没有指定动画，则播放默认动画。\n     * @method play\n     * @param {String} [name] - The name of animation to play. If no name is supplied then the default animation will be played.\n     * @param {Number} [startTime] - play an animation from startTime\n     * @return {AnimationState} - The AnimationState of playing animation. In cases where the animation can't be played (ie, there is no default animation or no animation with the specified name), the function will return null.\n     * @example\n     * var animCtrl = this.node.getComponent(cc.Animation);\n     * animCtrl.play(\"linear\");\n     */\n    play: function (name, startTime) {\n        let state = this.playAdditive(name, startTime);\n        this._animator.stopStatesExcept(state);\n        return state;\n    },\n\n    /**\n     * !#en\n     * Plays an additive animation, it will not stop other animations.\n     * If there are other animations playing, then will play several animations at the same time.\n     * !#zh 播放指定的动画（将不会停止当前播放的动画）。如果没有指定动画，则播放默认动画。\n     * @method playAdditive\n     * @param {String} [name] - The name of animation to play. If no name is supplied then the default animation will be played.\n     * @param {Number} [startTime] - play an animation from startTime\n     * @return {AnimationState} - The AnimationState of playing animation. In cases where the animation can't be played (ie, there is no default animation or no animation with the specified name), the function will return null.\n     * @example\n     * // linear_1 and linear_2 at the same time playing.\n     * var animCtrl = this.node.getComponent(cc.Animation);\n     * animCtrl.playAdditive(\"linear_1\");\n     * animCtrl.playAdditive(\"linear_2\");\n     */\n    playAdditive: function (name, startTime) {\n        this._init();\n        let state = this.getAnimationState(name || (this._defaultClip && this._defaultClip.name));\n\n        if (state) {\n            this.enabled = true;\n\n            let animator = this._animator;\n            if (animator.isPlaying && state.isPlaying) {\n                if (state.isPaused) {\n                    animator.resumeState(state);\n                }\n                else {\n                    animator.stopState(state);\n                    animator.playState(state, startTime);\n                }\n            }\n            else {\n                animator.playState(state, startTime);\n            }\n\n            // Animation cannot be played when the component is not enabledInHierarchy.\n            // That would cause an error for the animation lost the reference after destroying the node.\n            // If users play the animation when the component is not enabledInHierarchy,\n            // we pause the animator here so that it will automatically resume the animation when users enable the component.\n            if (!this.enabledInHierarchy) {\n                animator.pause();\n            }\n\n            this.currentClip = state.clip;\n        }\n        return state;\n    },\n\n    /**\n     * !#en Stops an animation named name. If no name is supplied then stops all playing animations that were started with this Animation. <br/>\n     * Stopping an animation also Rewinds it to the Start.\n     * !#zh 停止指定的动画。如果没有指定名字，则停止当前正在播放的动画。\n     * @method stop\n     * @param {String} [name] - The animation to stop, if not supplied then stops all playing animations.\n     */\n    stop: function (name) {\n        if (!this._didInit) {\n            return;\n        }\n        if (name) {\n            let state = this._nameToState[name];\n            if (state) {\n                this._animator.stopState(state);\n            }\n        }\n        else {\n            this._animator.stop();\n        }\n    },\n\n    /**\n     * !#en Pauses an animation named name. If no name is supplied then pauses all playing animations that were started with this Animation.\n     * !#zh 暂停当前或者指定的动画。如果没有指定名字，则暂停当前正在播放的动画。\n     * @method pause\n     * @param {String} [name] - The animation to pauses, if not supplied then pauses all playing animations.\n     */\n    pause: function (name) {\n        if (!this._didInit) {\n            return;\n        }\n        if (name) {\n            let state = this._nameToState[name];\n            if (state) {\n                this._animator.pauseState(state);\n            }\n        }\n        else {\n            this.enabled = false;\n        }\n    },\n\n    /**\n     * !#en Resumes an animation named name. If no name is supplied then resumes all paused animations that were started with this Animation.\n     * !#zh 重新播放指定的动画，如果没有指定名字，则重新播放当前正在播放的动画。\n     * @method resume\n     * @param {String} [name] - The animation to resumes, if not supplied then resumes all paused animations.\n     */\n    resume: function (name) {\n        if (!this._didInit) {\n            return;\n        }\n        if (name) {\n            let state = this._nameToState[name];\n            if (state) {\n                this._animator.resumeState(state);\n            }\n        }\n        else {\n            this.enabled = true;\n        }\n    },\n\n    /**\n     * !#en Make an animation named name go to the specified time. If no name is supplied then make all animations go to the specified time.\n     * !#zh 设置指定动画的播放时间。如果没有指定名字，则设置当前播放动画的播放时间。\n     * @method setCurrentTime\n     * @param {Number} [time] - The time to go to\n     * @param {String} [name] - Specified animation name, if not supplied then make all animations go to the time.\n     */\n    setCurrentTime: function (time, name) {\n        this._init();\n        if (name) {\n            let state = this._nameToState[name];\n            if (state) {\n                this._animator.setStateTime(state, time);\n            }\n        }\n        else {\n            this._animator.setStateTime(time);\n        }\n    },\n\n    /**\n     * !#en Returns the animation state named name. If no animation with the specified name, the function will return null.\n     * !#zh 获取当前或者指定的动画状态，如果未找到指定动画剪辑则返回 null。\n     * @method getAnimationState\n     * @param {String} name\n     * @return {AnimationState}\n     */\n    getAnimationState: function (name) {\n        this._init();\n        let state = this._nameToState[name];\n\n        if (CC_EDITOR && (!state || !cc.js.array.contains(this._clips, state.clip))) {\n            this._didInit = false;\n\n            if (this._animator) {\n                this._animator.stop();\n            }\n\n            this._init();\n            state = this._nameToState[name];\n        }\n\n        if (state && !state.curveLoaded) {\n            this._animator._reloadClip(state);\n        }\n\n        return state || null;\n    },\n\n    /**\n     * !#en Adds a clip to the animation with name newName. If a clip with that name already exists it will be replaced with the new clip.\n     * !#zh 添加动画剪辑，并且可以重新设置该动画剪辑的名称。\n     * @method addClip\n     * @param {AnimationClip} clip - the clip to add\n     * @param {String} [newName]\n     * @return {AnimationState} - The AnimationState which gives full control over the animation clip.\n     */\n    addClip: function (clip, newName) {\n        if (!clip) {\n            cc.warnID(3900);\n            return;\n        }\n        this._init();\n\n        // add clip\n        if (!cc.js.array.contains(this._clips, clip)) {\n            this._clips.push(clip);\n        }\n\n        // replace same name clip\n        newName = newName || clip.name;\n        let oldState = this._nameToState[newName];\n        if (oldState) {\n            if (oldState.clip === clip) {\n                return oldState;\n            }\n            else {\n                var index = this._clips.indexOf(oldState.clip);\n                if (index !== -1) {\n                    this._clips.splice(index, 1);\n                }\n            }\n        }\n\n        // replace state\n        let newState = new cc.AnimationState(clip, newName);\n        this._nameToState[newName] = newState;\n        return newState;\n    },\n\n    /**\n     * !#en \n     * Remove clip from the animation list. This will remove the clip and any animation states based on it.\n     * If there are animation states depand on the clip are playing or clip is defaultClip, it will not delete the clip.\n     * But if force is true, then will always remove the clip and any animation states based on it. If clip is defaultClip, defaultClip will be reset to null\n     * !#zh\n     * 从动画列表中移除指定的动画剪辑，<br/>\n     * 如果依赖于 clip 的 AnimationState 正在播放或者 clip 是 defaultClip 的话，默认是不会删除 clip 的。\n     * 但是如果 force 参数为 true，则会强制停止该动画，然后移除该动画剪辑和相关的动画。这时候如果 clip 是 defaultClip，defaultClip 将会被重置为 null。\n     * @method removeClip\n     * @param {AnimationClip} clip\n     * @param {Boolean} [force=false] - If force is true, then will always remove the clip and any animation states based on it.\n     */\n    removeClip: function (clip, force) {\n        if (!clip) {\n            cc.warnID(3901);\n            return;\n        }\n        this._init();\n\n        let state;\n        for (let name in this._nameToState) {\n            state = this._nameToState[name];\n            if (equalClips(state.clip, clip)) {\n                break;\n            }\n        }\n\n        if (clip === this._defaultClip) {\n            if (force) this._defaultClip = null;\n            else {\n                if (!CC_TEST) cc.warnID(3902);\n                return;\n            } \n        }\n\n        if (state && state.isPlaying) {\n            if (force) this.stop(state.name);\n            else {\n                if (!CC_TEST) cc.warnID(3903);\n                return;\n            }\n        }\n\n        this._clips = this._clips.filter(function (item) {\n            return !equalClips(item, clip);\n        });\n\n        if (state) {\n            delete this._nameToState[state.name];    \n        }\n    },\n\n    /**\n     * !#en\n     * Samples animations at the current state.<br/>\n     * This is useful when you explicitly want to set up some animation state, and sample it once.\n     * !#zh 对指定或当前动画进行采样。你可以手动将动画设置到某一个状态，然后采样一次。\n     * @method sample\n     * @param {String} name\n     */\n    sample: function (name) {\n        this._init();\n\n        if (name) {\n            let state = this._nameToState[name];\n            if (state) {\n                state.sample();\n            }\n        }\n        else {\n            this._animator.sample();\n        }\n    },\n\n\n    /**\n     * !#en \n     * Register animation event callback.\n     * The event arguments will provide the AnimationState which emit the event.\n     * When play an animation, will auto register the event callback to the AnimationState, and unregister the event callback from the AnimationState when animation stopped.\n     * !#zh\n     * 注册动画事件回调。\n     * 回调的事件里将会附上发送事件的 AnimationState。\n     * 当播放一个动画时，会自动将事件注册到对应的 AnimationState 上，停止播放时会将事件从这个 AnimationState 上取消注册。\n     * @method on\n     * @param {String} type - A string representing the event type to listen for.\n     * @param {Function} callback - The callback that will be invoked when the event is dispatched.\n     *                              The callback is ignored if it is a duplicate (the callbacks are unique).\n     * @param {cc.AnimationState} state \n     * @param {Object} [target] - The target (this object) to invoke the callback, can be null\n     * @param {Boolean} [useCapture=false] - When set to true, the capture argument prevents callback\n     *                              from being invoked when the event's eventPhase attribute value is BUBBLING_PHASE.\n     *                              When false, callback will NOT be invoked when event's eventPhase attribute value is CAPTURING_PHASE.\n     *                              Either way, callback will be invoked when event's eventPhase attribute value is AT_TARGET.\n     *\n     * @return {Function} - Just returns the incoming callback so you can save the anonymous function easier.\n     * @typescript\n     * on(type: string, callback: (event: Event.EventCustom) => void, target?: any, useCapture?: boolean): (event: Event.EventCustom) => void\n     * on<T>(type: string, callback: (event: T) => void, target?: any, useCapture?: boolean): (event: T) => void\n     * @example\n     * onPlay: function (type, state) {\n     *     // callback\n     * }\n     * \n     * // register event to all animation\n     * animation.on('play', this.onPlay, this);\n     */\n    on: function (type, callback, target, useCapture) {\n        this._init();\n\n        let ret = this._EventTargetOn(type, callback, target, useCapture);\n        \n        if (type === 'lastframe') {\n            let states = this._nameToState;\n            for (let name in states) {\n                states[name]._lastframeEventOn = true;\n            }\n        }\n\n        return ret;\n    },\n\n\n    /**\n     * !#en\n     * Unregister animation event callback.\n     * !#zh\n     * 取消注册动画事件回调。\n     * @method off\n     * @param {String} type - A string representing the event type being removed.\n     * @param {Function} [callback] - The callback to remove.\n     * @param {Object} [target] - The target (this object) to invoke the callback, if it's not given, only callback without target will be removed\n     * @param {Boolean} [useCapture=false] - Specifies whether the callback being removed was registered as a capturing callback or not.\n     *                              If not specified, useCapture defaults to false. If a callback was registered twice,\n     *                              one with capture and one without, each must be removed separately. Removal of a capturing callback\n     *                              does not affect a non-capturing version of the same listener, and vice versa.\n     *\n     * @example\n     * // unregister event to all animation\n     * animation.off('play', this.onPlay, this);\n     */\n    off: function (type, callback, target, useCapture) {\n        this._init();\n\n        if (type === 'lastframe') {\n            let states = this._nameToState;\n            for (let name in states) {\n                states[name]._lastframeEventOn = false;\n            }\n        }\n\n        this._EventTargetOff(type, callback, target, useCapture);\n    },\n\n    ///////////////////////////////////////////////////////////////////////////////\n    // Internal Methods\n    ///////////////////////////////////////////////////////////////////////////////\n\n    // Dont forget to call _init before every actual process in public methods.\n    // Just invoking _init by onLoad is not enough because onLoad is called only if the entity is active.\n\n    _init: function () {\n        if (this._didInit) {\n            return;\n        }\n        this._didInit = true;\n        this._animator = new AnimationAnimator(this.node, this);\n        this._createStates();\n    },\n\n    _createStates: function() {\n        this._nameToState = js.createMap(true);\n        \n        // create animation states\n        let state = null;\n        let defaultClipState = false;\n        for (let i = 0; i < this._clips.length; ++i) {\n            let clip = this._clips[i];\n            if (clip) {\n                state = new cc.AnimationState(clip);\n\n                if (CC_EDITOR) {\n                    this._animator._reloadClip(state);\n                }\n\n                this._nameToState[state.name] = state;\n                if (equalClips(this._defaultClip, clip)) {\n                    defaultClipState = state;\n                }\n            }\n        }\n        if (this._defaultClip && !defaultClipState) {\n            state = new cc.AnimationState(this._defaultClip);\n\n            if (CC_EDITOR) {\n                this._animator._reloadClip(state);\n            }\n\n            this._nameToState[state.name] = state;\n        }\n    }\n});\n\nAnimation.prototype._EventTargetOn = EventTarget.prototype.on;\nAnimation.prototype._EventTargetOff = EventTarget.prototype.off;\n\ncc.Animation = module.exports = Animation;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst misc = require('../utils/misc');\nconst Component = require('./CCComponent');\nconst AudioClip = require('../assets/CCAudioClip');\n\n/**\n * !#en Audio Source.\n * !#zh 音频源组件，能对音频剪辑。\n * @class AudioSource\n * @extends Component\n */\nvar AudioSource = cc.Class({\n    name: 'cc.AudioSource',\n    extends: Component,\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.others/AudioSource',\n        help: 'i18n:COMPONENT.help_url.audiosource',\n    },\n\n    ctor: function () {\n        // We can't require Audio here because jsb Audio is implemented outside the engine,\n        // it can only take effect rely on overwriting cc.Audio\n        this.audio = new cc.Audio();\n    },\n\n    properties: {\n        _clip: {\n            default: null,\n            type: AudioClip\n        },\n        _volume: 1,\n        _mute: false,\n        _loop: false,\n        _pausedFlag: {\n            default: false,\n            serializable: false\n        },\n\n        /**\n         * !#en\n         * Is the audio source playing (Read Only). <br/>\n         * Note: isPlaying is not supported for Native platforms.\n         * !#zh\n         * 该音频剪辑是否正播放（只读）。<br/>\n         * 注意：Native 平台暂时不支持 isPlaying。\n         * @property isPlaying\n         * @type {Boolean}\n         * @readOnly\n         * @default false\n         */\n        isPlaying: {\n            get: function () {\n                var state = this.audio.getState();\n                return state === cc.Audio.State.PLAYING;\n            },\n            visible: false\n        },\n\n        /**\n         * !#en The clip of the audio source to play.\n         * !#zh 要播放的音频剪辑。\n         * @property clip\n         * @type {AudioClip}\n         * @default 1\n         */\n        clip: {\n            get: function () {\n                return this._clip;\n            },\n            set: function (value) {\n                if (typeof value === 'string') {\n                    // backward compatibility since 1.10\n                    cc.warnID(8401, 'cc.AudioSource', 'cc.AudioClip', 'AudioClip', 'cc.AudioClip', 'audio');\n                    let self = this;\n                    AudioClip._loadByUrl(value, function (err, clip) {\n                        if (clip) {\n                            self.clip = clip;\n                        }\n                    });\n                    return;\n                }\n\n                if (value === this._clip) {\n                    return;\n                }\n                this._clip = value;\n                this.audio.stop();\n                if (this.preload) {\n                    this.audio.src = this._clip;\n                }\n            },\n            type: AudioClip,\n            tooltip: CC_DEV && 'i18n:COMPONENT.audio.clip',\n            animatable: false\n        },\n\n        /**\n         * !#en The volume of the audio source.\n         * !#zh 音频源的音量（0.0 ~ 1.0）。\n         * @property volume\n         * @type {Number}\n         * @default 1\n         */\n        volume: {\n            get: function () {\n                return this._volume;\n            },\n            set: function (value) {\n                value = misc.clamp01(value);\n                this._volume = value;\n                if (!this._mute) {\n                    this.audio.setVolume(value);\n                }\n                return value;\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.audio.volume'\n        },\n\n        /**\n         * !#en Is the audio source mute?\n         * !#zh 是否静音音频源。Mute 是设置音量为 0，取消静音是恢复原来的音量。\n         * @property mute\n         * @type {Boolean}\n         * @default false\n         */\n        mute: {\n            get: function () {\n                return this._mute;\n            },\n            set: function (value) {\n                this._mute = value;\n                this.audio.setVolume(value ? 0 : this._volume);\n                return value;\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.audio.mute',\n        },\n\n        /**\n         * !#en Is the audio source looping?\n         * !#zh 音频源是否循环播放？\n         * @property loop\n         * @type {Boolean}\n         * @default false\n         */\n        loop: {\n            get: function () {\n                return this._loop;\n            },\n            set: function (value) {\n                this._loop = value;\n                this.audio.setLoop(value);\n                return value;\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.audio.loop'\n        },\n\n        /**\n         * !#en If set to true, the audio source will automatically start playing on onEnable.\n         * !#zh 如果设置为 true，音频源将在 onEnable 时自动播放。\n         * @property playOnLoad\n         * @type {Boolean}\n         * @default true\n         */\n        playOnLoad: {\n            default: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.audio.play_on_load',\n            animatable: false\n        },\n\n        preload: {\n            default: false,\n            animatable: false\n        }\n    },\n\n    _ensureDataLoaded () {\n        if (this.audio.src !== this._clip) {\n            this.audio.src = this._clip;\n        }\n    },\n\n    _pausedCallback: function () {\n        var state = this.audio.getState();\n        if (state === cc.Audio.State.PLAYING) {\n            this.audio.pause();\n            this._pausedFlag = true;\n        }\n    },\n\n    _restoreCallback: function () {\n        if (this._pausedFlag) {\n            this.audio.resume();\n        }\n        this._pausedFlag = false;\n    },\n\n    onLoad: function () {\n        this.audio.setVolume(this._mute ? 0 : this._volume);\n        this.audio.setLoop(this._loop);\n    },\n\n    onEnable: function () {\n        if (this.preload) {\n            this.audio.src = this._clip;\n        }\n        if (this.playOnLoad) {\n            this.play();\n        }\n        cc.game.on(cc.game.EVENT_HIDE, this._pausedCallback, this);\n        cc.game.on(cc.game.EVENT_SHOW, this._restoreCallback, this);\n    },\n\n    onDisable: function () {\n        this.stop();\n        cc.game.off(cc.game.EVENT_HIDE, this._pausedCallback, this);\n        cc.game.off(cc.game.EVENT_SHOW, this._restoreCallback, this);\n    },\n\n    onDestroy: function () {\n        this.stop();\n        this.audio.destroy();\n        cc.audioEngine.uncache(this._clip);\n    },\n\n    /**\n     * !#en Plays the clip.\n     * !#zh 播放音频剪辑。\n     * @method play\n     */\n    play: function () {\n        if ( !this._clip ) return;\n\n        var audio = this.audio;\n        if (this._clip.loaded) {\n            audio.stop();\n        }\n        this._ensureDataLoaded();\n        audio.setCurrentTime(0);\n        audio.play();\n    },\n\n    /**\n     * !#en Stops the clip.\n     * !#zh 停止当前音频剪辑。\n     * @method stop\n     */\n    stop: function () {\n        this.audio.stop();\n    },\n\n    /**\n     * !#en Pause the clip.\n     * !#zh 暂停当前音频剪辑。\n     * @method pause\n     */\n    pause: function () {\n        this.audio.pause();\n    },\n\n    /**\n     * !#en Resume the clip.\n     * !#zh 恢复播放。\n     * @method resume\n     */\n    resume: function () {\n        this._ensureDataLoaded();\n        this.audio.resume();\n    },\n\n    /**\n     * !#en Rewind playing music.\n     * !#zh 从头开始播放。\n     * @method rewind\n     */\n    rewind: function(){\n        this.audio.setCurrentTime(0);\n    },\n\n    /**\n     * !#en Get current time\n     * !#zh 获取当前的播放时间\n     * @method getCurrentTime\n     * @return {Number}\n     */\n    getCurrentTime: function () {\n        return this.audio.getCurrentTime();\n    },\n\n    /**\n     * !#en Set current time\n     * !#zh 设置当前的播放时间\n     * @method setCurrentTime\n     * @param {Number} time\n     * @return {Number}\n     */\n    setCurrentTime: function (time) {\n        this.audio.setCurrentTime(time);\n        return time;\n    },\n\n    /**\n     * !#en Get audio duration\n     * !#zh 获取当前音频的长度\n     * @method getDuration\n     * @return {Number}\n     */\n    getDuration: function () {\n        return this.audio.getDuration();\n    }\n\n});\n\ncc.AudioSource = module.exports = AudioSource;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst BlockEvents = ['touchstart', 'touchmove', 'touchend',\n                     'mousedown', 'mousemove', 'mouseup',\n                     'mouseenter', 'mouseleave', 'mousewheel'];\n\nfunction stopPropagation (event) {\n    event.stopPropagation();\n}\n\n/**\n * !#en\n * This component will block all input events (mouse and touch) within the bounding box of the node, preventing the input from penetrating into the underlying node, typically for the background of the top UI.<br>\n * This component does not have any API interface and can be added directly to the scene to take effect.\n * !#zh\n * 该组件将拦截所属节点 bounding box 内的所有输入事件（鼠标和触摸），防止输入穿透到下层节点，一般用于上层 UI 的背景。<br>\n * 该组件没有任何 API 接口，直接添加到场景即可生效。\n *\n * @class BlockInputEvents\n * @extends Component\n */\nconst BlockInputEvents = cc.Class({\n    name: 'cc.BlockInputEvents',\n    extends: require('./CCComponent'),\n    editor: {\n        menu: 'i18n:MAIN_MENU.component.ui/Block Input Events',\n        inspector: 'packages://inspector/inspectors/comps/block-input-events.js',\n        help: 'i18n:COMPONENT.help_url.block_input_events',\n    },\n\n    onEnable () {\n        for (var i = 0; i < BlockEvents.length; i++) {\n            // supply the 'this' parameter so that the callback could be added and removed correctly,\n            // even if the same component is added more than once to a Node.\n            this.node.on(BlockEvents[i], stopPropagation, this);\n        }\n    },\n    onDisable () {\n        for (var i = 0; i < BlockEvents.length; i++) {\n            this.node.off(BlockEvents[i], stopPropagation, this);\n        }\n    }\n});\n\ncc.BlockInputEvents = module.exports = BlockInputEvents;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst Component = require('./CCComponent');\nconst GraySpriteState = require('../utils/gray-sprite-state');\n\n/**\n * !#en Enum for transition type.\n * !#zh 过渡类型\n * @enum Button.Transition\n */\nlet Transition = cc.Enum({\n    /**\n     * !#en The none type.\n     * !#zh 不做任何过渡\n     * @property {Number} NONE\n     */\n    NONE: 0,\n\n    /**\n     * !#en The color type.\n     * !#zh 颜色过渡\n     * @property {Number} COLOR\n     */\n    COLOR: 1,\n\n    /**\n     * !#en The sprite type.\n     * !#zh 精灵过渡\n     * @property {Number} SPRITE\n     */\n    SPRITE: 2,\n    /**\n     * !#en The scale type\n     * !#zh 缩放过渡\n     * @property {Number} SCALE\n     */\n    SCALE: 3\n});\n\nconst State = cc.Enum({\n    NORMAL: 0,\n    HOVER: 1,\n    PRESSED: 2,\n    DISABLED: 3,\n});\n\n/**\n * !#en\n * Button has 4 Transition types<br/>\n * When Button state changed:<br/>\n *  If Transition type is Button.Transition.NONE, Button will do nothing<br/>\n *  If Transition type is Button.Transition.COLOR, Button will change target's color<br/>\n *  If Transition type is Button.Transition.SPRITE, Button will change target Sprite's sprite<br/>\n *  If Transition type is Button.Transition.SCALE, Button will change target node's scale<br/>\n *\n * Button will trigger 5 events:<br/>\n *  Button.EVENT_TOUCH_DOWN<br/>\n *  Button.EVENT_TOUCH_UP<br/>\n *  Button.EVENT_HOVER_IN<br/>\n *  Button.EVENT_HOVER_MOVE<br/>\n *  Button.EVENT_HOVER_OUT<br/>\n *  User can get the current clicked node with 'event.target' from event object which is passed as parameter in the callback function of click event.\n *\n * !#zh\n * 按钮组件。可以被按下，或者点击。\n *\n * 按钮可以通过修改 Transition 来设置按钮状态过渡的方式：\n * \n *   - Button.Transition.NONE   // 不做任何过渡\n *   - Button.Transition.COLOR  // 进行颜色之间过渡\n *   - Button.Transition.SPRITE // 进行精灵之间过渡\n *   - Button.Transition.SCALE // 进行缩放过渡\n *\n * 按钮可以绑定事件（但是必须要在按钮的 Node 上才能绑定事件）：<br/>\n * 以下事件可以在全平台上都触发：\n * \n *   - cc.Node.EventType.TOUCH_START  // 按下时事件\n *   - cc.Node.EventType.TOUCH_Move   // 按住移动后事件\n *   - cc.Node.EventType.TOUCH_END    // 按下后松开后事件\n *   - cc.Node.EventType.TOUCH_CANCEL // 按下取消事件\n * \n * 以下事件只在 PC 平台上触发：\n * \n *   - cc.Node.EventType.MOUSE_DOWN  // 鼠标按下时事件\n *   - cc.Node.EventType.MOUSE_MOVE  // 鼠标按住移动后事件\n *   - cc.Node.EventType.MOUSE_ENTER // 鼠标进入目标事件\n *   - cc.Node.EventType.MOUSE_LEAVE // 鼠标离开目标事件\n *   - cc.Node.EventType.MOUSE_UP    // 鼠标松开事件\n *   - cc.Node.EventType.MOUSE_WHEEL // 鼠标滚轮事件\n * \n * 用户可以通过获取 __点击事件__ 回调函数的参数 event 的 target 属性获取当前点击对象。\n * @class Button\n * @extends Component\n * @uses GraySpriteState\n * @example\n *\n * // Add an event to the button.\n * button.node.on(cc.Node.EventType.TOUCH_START, function (event) {\n *     cc.log(\"This is a callback after the trigger event\");\n * });\n\n * // You could also add a click event\n * //Note: In this way, you can't get the touch event info, so use it wisely.\n * button.node.on('click', function (button) {\n *    //The event is a custom event, you could get the Button component via first argument\n * })\n *\n */\nlet Button = cc.Class({\n    name: 'cc.Button',\n    extends: Component,\n    mixins: [GraySpriteState],\n\n    ctor () {\n        this._pressed = false;\n        this._hovered = false;\n        this._fromColor = null;\n        this._toColor = null;\n        this._time = 0;\n        this._transitionFinished = true;\n        // init _originalScale in __preload()\n        this._fromScale = cc.Vec2.ZERO;\n        this._toScale = cc.Vec2.ZERO;\n        this._originalScale = null;\n\n        this._graySpriteMaterial = null;\n        this._spriteMaterial = null;\n\n        this._sprite = null;\n    },\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.ui/Button',\n        help: 'i18n:COMPONENT.help_url.button',\n        inspector: 'packages://inspector/inspectors/comps/button.js',\n        executeInEditMode: true\n    },\n\n    properties: {\n        /**\n         * !#en\n         * Whether the Button is disabled.\n         * If true, the Button will trigger event and do transition.\n         * !#zh\n         * 按钮事件是否被响应，如果为 false，则按钮将被禁用。\n         * @property {Boolean} interactable\n         * @default true\n         */\n        interactable: {\n            default: true,\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.interactable',\n            notify () {\n                this._updateState();\n\n                if (!this.interactable) {\n                    this._resetState();\n                }\n            },\n            animatable: false\n        },\n\n        _resizeToTarget: {\n            animatable: false,\n            set (value) {\n                if (value) {\n                    this._resizeNodeToTargetNode();\n                }\n            }\n        },\n\n        /**\n         * !#en When this flag is true, Button target sprite will turn gray when interactable is false.\n         * !#zh 如果这个标记为 true，当 button 的 interactable 属性为 false 的时候，会使用内置 shader 让 button 的 target 节点的 sprite 组件变灰\n         * @property {Boolean} enableAutoGrayEffect\n         */\n        enableAutoGrayEffect: {\n            default: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.auto_gray_effect',\n            notify () {\n                this._updateDisabledState();\n            }\n        },\n\n        /**\n         * !#en Transition type\n         * !#zh 按钮状态改变时过渡方式。\n         * @property {Button.Transition} transition\n         * @default Button.Transition.Node\n         */\n        transition: {\n            default: Transition.NONE,\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.transition',\n            type: Transition,\n            animatable: false,\n            notify (oldValue) {\n                this._updateTransition(oldValue);\n            },\n            formerlySerializedAs: 'transition'\n        },\n\n        // color transition\n\n        /**\n         * !#en Normal state color.\n         * !#zh 普通状态下按钮所显示的颜色。\n         * @property {Color} normalColor\n         */\n        normalColor: {\n            default: cc.Color.WHITE,\n            displayName: 'Normal',\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.normal_color',\n            notify () {\n                if (this.transition === Transition.Color && this._getButtonState() === State.NORMAL) {\n                    this._getTarget().opacity = this.normalColor.a;\n                }\n                this._updateState();\n            }\n        },\n\n        /**\n         * !#en Pressed state color\n         * !#zh 按下状态时按钮所显示的颜色。\n         * @property {Color} pressedColor\n         */\n        pressedColor: {\n            default: cc.color(211, 211, 211),\n            displayName: 'Pressed',\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.pressed_color',\n            notify () {\n                if (this.transition === Transition.Color && this._getButtonState() === State.PRESSED) {\n                    this._getTarget().opacity = this.pressedColor.a;\n                }\n                this._updateState();\n            },\n            formerlySerializedAs: 'pressedColor'\n        },\n\n        /**\n         * !#en Hover state color\n         * !#zh 悬停状态下按钮所显示的颜色。\n         * @property {Color} hoverColor\n         */\n        hoverColor: {\n            default: cc.Color.WHITE,\n            displayName: 'Hover',\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.hover_color',\n            notify () {\n                if (this.transition === Transition.Color && this._getButtonState() === State.HOVER) {\n                    this._getTarget().opacity = this.hoverColor.a;\n                }\n                this._updateState();\n            },\n            formerlySerializedAs: 'hoverColor'\n        },\n\n        /**\n         * !#en Disabled state color\n         * !#zh 禁用状态下按钮所显示的颜色。\n         * @property {Color} disabledColor\n         */\n        disabledColor: {\n            default: cc.color(124, 124, 124),\n            displayName: 'Disabled',\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.disabled_color',\n            notify () {\n                if (this.transition === Transition.Color && this._getButtonState() === State.DISABLED) {\n                    this._getTarget().opacity = this.disabledColor.a;\n                }\n                this._updateState();\n            }\n        },\n\n        /**\n         * !#en Color and Scale transition duration\n         * !#zh 颜色过渡和缩放过渡时所需时间\n         * @property {Number} duration\n         */\n        duration: {\n            default: 0.1,\n            range: [0, 10],\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.duration',\n        },\n\n        /**\n         * !#en  When user press the button, the button will zoom to a scale.\n         * The final scale of the button  equals (button original scale * zoomScale)\n         * !#zh 当用户点击按钮后，按钮会缩放到一个值，这个值等于 Button 原始 scale * zoomScale\n         * @property {Number} zoomScale\n         */\n        zoomScale: {\n            default: 1.2,\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.zoom_scale'\n        },\n\n        // sprite transition\n        /**\n         * !#en Normal state sprite\n         * !#zh 普通状态下按钮所显示的 Sprite 。\n         * @property {SpriteFrame} normalSprite\n         */\n        normalSprite: {\n            default: null,\n            type: cc.SpriteFrame,\n            displayName: 'Normal',\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.normal_sprite',\n            notify () {\n                this._updateState();\n            }\n        },\n\n        /**\n         * !#en Pressed state sprite\n         * !#zh 按下状态时按钮所显示的 Sprite 。\n         * @property {SpriteFrame} pressedSprite\n         */\n        pressedSprite: {\n            default: null,\n            type: cc.SpriteFrame,\n            displayName: 'Pressed',\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.pressed_sprite',\n            formerlySerializedAs: 'pressedSprite',\n            notify () {\n                this._updateState();\n            }\n        },\n\n        /**\n         * !#en Hover state sprite\n         * !#zh 悬停状态下按钮所显示的 Sprite 。\n         * @property {SpriteFrame} hoverSprite\n         */\n        hoverSprite: {\n            default: null,\n            type: cc.SpriteFrame,\n            displayName: 'Hover',\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.hover_sprite',\n            formerlySerializedAs: 'hoverSprite',\n            notify () {\n                this._updateState();\n            }\n        },\n\n        /**\n         * !#en Disabled state sprite\n         * !#zh 禁用状态下按钮所显示的 Sprite 。\n         * @property {SpriteFrame} disabledSprite\n         */\n        disabledSprite: {\n            default: null,\n            type: cc.SpriteFrame,\n            displayName: 'Disabled',\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.disabled_sprite',\n            notify () {\n                this._updateState();\n            }\n        },\n\n        /**\n         * !#en\n         * Transition target.\n         * When Button state changed:\n         *  If Transition type is Button.Transition.NONE, Button will do nothing\n         *  If Transition type is Button.Transition.COLOR, Button will change target's color\n         *  If Transition type is Button.Transition.SPRITE, Button will change target Sprite's sprite\n         * !#zh\n         * 需要过渡的目标。\n         * 当前按钮状态改变规则：\n         * -如果 Transition type 选择 Button.Transition.NONE，按钮不做任何过渡。\n         * -如果 Transition type 选择 Button.Transition.COLOR，按钮会对目标颜色进行颜色之间的过渡。\n         * -如果 Transition type 选择 Button.Transition.Sprite，按钮会对目标 Sprite 进行 Sprite 之间的过渡。\n         * @property {Node} target\n         */\n        target: {\n            default: null,\n            type: cc.Node,\n            tooltip: CC_DEV && \"i18n:COMPONENT.button.target\",\n            notify (oldValue) {\n                this._applyTarget();\n                if (oldValue && this.target !== oldValue) {\n                    this._unregisterTargetEvent(oldValue);\n                }\n            }\n        },\n\n        /**\n         * !#en If Button is clicked, it will trigger event's handler\n         * !#zh 按钮的点击事件列表。\n         * @property {Component.EventHandler[]} clickEvents\n         */\n        clickEvents: {\n            default: [],\n            type: cc.Component.EventHandler,\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.click_events',\n        }\n    },\n\n    statics: {\n        Transition: Transition,\n    },\n\n    __preload () {\n        this._applyTarget();\n        this._resetState();\n    },\n\n    _resetState () {\n        this._pressed = false;\n        this._hovered = false;\n        // // Restore button status\n        let target = this._getTarget();\n        let transition = this.transition;\n        let originalScale = this._originalScale;\n\n        if (transition === Transition.COLOR && this.interactable) {\n            this._setTargetColor(this.normalColor);\n        }\n        else if (transition === Transition.SCALE && originalScale) {\n            target.setScale(originalScale.x, originalScale.y);\n        }\n        this._transitionFinished = true;\n    },\n\n    onEnable () {\n        // check sprite frames\n        if (this.normalSprite) {\n            this.normalSprite.ensureLoadTexture();\n        }\n        if (this.hoverSprite) {\n            this.hoverSprite.ensureLoadTexture();\n        }\n        if (this.pressedSprite) {\n            this.pressedSprite.ensureLoadTexture();\n        }\n        if (this.disabledSprite) {\n            this.disabledSprite.ensureLoadTexture();\n        }\n        \n        if (!CC_EDITOR) {\n            this._registerNodeEvent();\n        }\n    },\n\n    onDisable () {\n        this._resetState();\n\n        if (!CC_EDITOR) {\n            this._unregisterNodeEvent();\n        }\n    },\n\n    _getTarget () {\n        return this.target ? this.target : this.node;\n    },\n\n    _onTargetSpriteFrameChanged (comp) {\n        if (this.transition === Transition.SPRITE) {\n            this._setCurrentStateSprite(comp.spriteFrame);\n        }\n    },\n\n    _onTargetColorChanged (color) {\n        if (this.transition === Transition.COLOR) {\n            this._setCurrentStateColor(color);\n        }\n    },\n\n    _onTargetScaleChanged () {\n        let target = this._getTarget();\n        // update _originalScale if target scale changed\n        if (this._originalScale) {\n            if (this.transition !== Transition.SCALE || this._transitionFinished) {\n                this._originalScale.x = target.scaleX;\n                this._originalScale.y = target.scaleY;\n            }\n        }\n    },\n\n    _setTargetColor (color) {\n        let target = this._getTarget();\n        target.color = color;\n        target.opacity = color.a;\n    },\n\n    _getStateColor (state) {\n        switch (state) {\n            case State.NORMAL:\n                return this.normalColor;\n            case State.HOVER:\n                return this.hoverColor;\n            case State.PRESSED:\n                return this.pressedColor;\n            case State.DISABLED:\n                return this.disabledColor;\n        }\n    },\n\n    _getStateSprite (state) {\n        switch (state) {\n            case State.NORMAL:\n                return this.normalSprite;\n            case State.HOVER:\n                return this.hoverSprite;\n            case State.PRESSED:\n                return this.pressedSprite;\n            case State.DISABLED:\n                return this.disabledSprite;\n        }\n    },\n\n    _setCurrentStateColor (color) {\n        switch ( this._getButtonState() ) {\n            case State.NORMAL:\n                this.normalColor = color;\n                break;\n            case State.HOVER:\n                this.hoverColor = color;\n                break;\n            case State.PRESSED:\n                this.pressedColor = color;\n                break;\n            case State.DISABLED:\n                this.disabledColor = color;\n                break;\n        }\n    },\n\n    _setCurrentStateSprite (spriteFrame) {\n        switch ( this._getButtonState() ) {\n            case State.NORMAL:\n                this.normalSprite = spriteFrame;\n                break;\n            case State.HOVER:\n                this.hoverSprite = spriteFrame;\n                break;\n            case State.PRESSED:\n                this.pressedSprite = spriteFrame;\n                break;\n            case State.DISABLED:\n                this.disabledSprite = spriteFrame;\n                break;\n        }\n    },\n\n    update (dt) {\n        let target = this._getTarget();\n        if (this._transitionFinished) return;\n        if (this.transition !== Transition.COLOR && this.transition !== Transition.SCALE) return;\n\n        this.time += dt;\n        let ratio = 1.0;\n        if (this.duration > 0) {\n            ratio = this.time / this.duration;\n        }\n\n        // clamp ratio\n        if (ratio >= 1) {\n            ratio = 1;\n        }\n\n        if (this.transition === Transition.COLOR) {\n            let color = this._fromColor.lerp(this._toColor, ratio);\n            this._setTargetColor(color);\n        }\n        // Skip if _originalScale is invalid\n        else if (this.transition === Transition.SCALE && this._originalScale) {\n            target.scale = this._fromScale.lerp(this._toScale, ratio);\n        }\n\n        if (ratio === 1) {\n            this._transitionFinished = true;\n        }\n\n    },\n\n    _registerNodeEvent () {\n        this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMove, this);\n        this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this);\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);\n\n        this.node.on(cc.Node.EventType.MOUSE_ENTER, this._onMouseMoveIn, this);\n        this.node.on(cc.Node.EventType.MOUSE_LEAVE, this._onMouseMoveOut, this);\n    },\n\n    _unregisterNodeEvent () {\n        this.node.off(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this);\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMove, this);\n        this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this);\n        this.node.off(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);\n\n        this.node.off(cc.Node.EventType.MOUSE_ENTER, this._onMouseMoveIn, this);\n        this.node.off(cc.Node.EventType.MOUSE_LEAVE, this._onMouseMoveOut, this);\n    },\n\n    _registerTargetEvent (target) {\n        if (CC_EDITOR) {\n            target.on('spriteframe-changed', this._onTargetSpriteFrameChanged, this);\n            target.on(cc.Node.EventType.COLOR_CHANGED, this._onTargetColorChanged, this);\n        }\n        target.on(cc.Node.EventType.SCALE_CHANGED, this._onTargetScaleChanged, this);\n    },\n\n    _unregisterTargetEvent (target) {\n        if (CC_EDITOR) {\n            target.off('spriteframe-changed', this._onTargetSpriteFrameChanged, this);\n            target.off(cc.Node.EventType.COLOR_CHANGED, this._onTargetColorChanged, this);\n        }\n        target.off(cc.Node.EventType.SCALE_CHANGED, this._onTargetScaleChanged, this);\n    },\n\n    _getTargetSprite (target) {\n        let sprite = null;\n        if (target) {\n            sprite = target.getComponent(cc.Sprite);\n        }\n        return sprite;\n    },\n\n    _applyTarget () {\n        let target = this._getTarget();\n        this._sprite = this._getTargetSprite(target);\n        if (!this._originalScale) {\n            this._originalScale = cc.Vec2.ZERO;\n        }\n        this._originalScale.x = target.scaleX;\n        this._originalScale.y = target.scaleY;\n\n        this._registerTargetEvent(target);\n    },\n\n    // touch event handler\n    _onTouchBegan (event) {\n        if (!this.interactable || !this.enabledInHierarchy) return;\n\n        this._pressed = true;\n        this._updateState();\n        event.stopPropagation();\n    },\n\n    _onTouchMove (event) {\n        if (!this.interactable || !this.enabledInHierarchy || !this._pressed) return;\n        // mobile phone will not emit _onMouseMoveOut,\n        // so we have to do hit test when touch moving\n        let touch = event.touch;\n        let hit = this.node._hitTest(touch.getLocation());\n        let target = this._getTarget();\n        let originalScale = this._originalScale;\n\n        if (this.transition === Transition.SCALE && originalScale) {\n            if (hit) {\n                this._fromScale.x = originalScale.x;\n                this._fromScale.y = originalScale.y;\n                this._toScale.x = originalScale.x * this.zoomScale;\n                this._toScale.y = originalScale.y * this.zoomScale;\n                this._transitionFinished = false;\n            } else {\n                this.time = 0;\n                this._transitionFinished = true;\n                target.setScale(originalScale.x, originalScale.y);\n            }\n        } else {\n            let state;\n            if (hit) {\n                state = State.PRESSED;\n            } else {\n                state = State.NORMAL;\n            }\n            this._applyTransition(state);\n        }\n        event.stopPropagation();\n    },\n\n    _onTouchEnded (event) {\n        if (!this.interactable || !this.enabledInHierarchy) return;\n\n        if (this._pressed) {\n            cc.Component.EventHandler.emitEvents(this.clickEvents, event);\n            this.node.emit('click', this);\n        }\n        this._pressed = false;\n        this._updateState();\n        event.stopPropagation();\n    },\n\n    _onTouchCancel () {\n        if (!this.interactable || !this.enabledInHierarchy) return;\n\n        this._pressed = false;\n        this._updateState();\n    },\n\n    _onMouseMoveIn () {\n        if (this._pressed || !this.interactable || !this.enabledInHierarchy) return;\n        if (this.transition === Transition.SPRITE && !this.hoverSprite) return;\n\n        if (!this._hovered) {\n            this._hovered = true;\n            this._updateState();\n        }\n    },\n\n    _onMouseMoveOut () {\n        if (this._hovered) {\n            this._hovered = false;\n            this._updateState();\n        }\n    },\n\n    // state handler\n    _updateState () {\n        let state = this._getButtonState();\n        this._applyTransition(state);\n        this._updateDisabledState();\n    },\n\n    _getButtonState () {\n        let state;\n        if (!this.interactable) {\n            state = State.DISABLED;\n        }\n        else if (this._pressed) {\n            state = State.PRESSED;\n        }\n        else if (this._hovered) {\n            state = State.HOVER;\n        }\n        else {\n            state = State.NORMAL;\n        }\n        return state;\n    },\n\n    _updateColorTransitionImmediately (state) {\n        let color = this._getStateColor(state);\n        this._setTargetColor(color);\n        this._fromColor = color.clone();\n        this._toColor = color;\n    },\n\n    _updateColorTransition (state) {\n        if (CC_EDITOR || state === State.DISABLED) {\n            this._updateColorTransitionImmediately(state);\n        } else {\n            let target = this._getTarget();\n            let color = this._getStateColor(state);\n            this._fromColor = target.color.clone();\n            this._toColor = color;\n            this.time = 0;\n            this._transitionFinished = false;\n        }\n    },\n\n    _updateSpriteTransition (state) {\n        let sprite = this._getStateSprite(state);\n        if (this._sprite && sprite) {\n            this._sprite.spriteFrame = sprite;\n        }\n    },\n\n    _updateScaleTransition (state) {\n        if (state === State.PRESSED) {\n            this._zoomUp();\n        } else {\n            this._zoomBack();\n        }\n    },\n\n    _zoomUp () {\n        // skip before __preload()\n        if (!this._originalScale) {\n            return;\n        }\n\n        this._fromScale.x = this._originalScale.x;\n        this._fromScale.y = this._originalScale.y;\n        this._toScale.x = this._originalScale.x * this.zoomScale;\n        this._toScale.y = this._originalScale.y * this.zoomScale;\n        this.time = 0;\n        this._transitionFinished = false;\n    },\n\n    _zoomBack () {\n        // skip before __preload()\n        if (!this._originalScale) {\n            return;\n        }\n\n        let target = this._getTarget();\n        this._fromScale.x = target.scaleX;\n        this._fromScale.y = target.scaleY;\n        this._toScale.x = this._originalScale.x;\n        this._toScale.y = this._originalScale.y;\n        this.time = 0;\n        this._transitionFinished = false;\n    },\n\n    _updateTransition (oldTransition) {\n        // Reset to normal data when change transition.\n        if (oldTransition === Transition.COLOR) {\n            this._updateColorTransitionImmediately(State.NORMAL);\n        }\n        else if (oldTransition === Transition.SPRITE) {\n            this._updateSpriteTransition(State.NORMAL);\n        }\n        this._updateState();\n    },\n\n    _applyTransition (state) {\n        let transition = this.transition;\n        if (transition === Transition.COLOR) {\n            this._updateColorTransition(state);\n        } else if (transition === Transition.SPRITE) {\n            this._updateSpriteTransition(state);\n        } else if (transition === Transition.SCALE) {\n            this._updateScaleTransition(state);\n        }\n    },\n\n    _resizeNodeToTargetNode: CC_EDITOR && function () {\n        this.node.setContentSize(this._getTarget().getContentSize());\n    },\n\n    _updateDisabledState () {\n        if (this._sprite) {\n            let useGrayMaterial = false;\n\n            if (this.enableAutoGrayEffect) {\n                if (!(this.transition === Transition.SPRITE && this.disabledSprite)) {\n                    if (!this.interactable) {\n                        useGrayMaterial = true;\n                    }\n                }\n            }\n\n            this._switchGrayMaterial(useGrayMaterial, this._sprite);\n        }\n    }\n});\n\ncc.Button = module.exports = Button;\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event click\n * @param {Event.EventCustom} event\n * @param {Button} button - The Button component.\n */\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar Camera = require('../camera/CCCamera');\nvar Component = require('./CCComponent');\n\n// Screen adaptation strategy for Canvas + Widget\nfunction addWidgetComponent (canvas) {\n    let widget = canvas.node.getComponent(cc.Widget);\n    if (!widget) {\n        widget = canvas.node.addComponent(cc.Widget);\n    }\n    widget.isAlignTop = true;\n    widget.isAlignBottom = true;\n    widget.isAlignLeft = true;\n    widget.isAlignRight = true;\n}\n\n/**\n * !#zh: 作为 UI 根节点，为所有子节点提供视窗四边的位置信息以供对齐，另外提供屏幕适配策略接口，方便从编辑器设置。\n * 注：由于本节点的尺寸会跟随屏幕拉伸，所以 anchorPoint 只支持 (0.5, 0.5)，否则适配不同屏幕时坐标会有偏差。\n *\n * @class Canvas\n * @extends Component\n */\nvar Canvas = cc.Class({\n    name: 'cc.Canvas',\n    extends: Component,\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.ui/Canvas',\n        help: 'i18n:COMPONENT.help_url.canvas',\n        executeInEditMode: true,\n        disallowMultiple: true,\n    },\n\n    resetInEditor: CC_EDITOR && function () {\n        _Scene._applyCanvasPreferences(this);\n        addWidgetComponent(this);\n    },\n\n    statics: {\n        /**\n         * !#en Current active canvas, the scene should only have one active canvas at the same time.\n         * !#zh 当前激活的画布组件，场景同一时间只能有一个激活的画布。\n         * @property {Canvas} instance\n         * @static\n         */\n        instance: null\n    },\n\n    properties: {\n\n        /**\n         * !#en The desigin resolution for current scene.\n         * !#zh 当前场景设计分辨率。\n         * @property {Size} designResolution\n         * @default new cc.Size(960, 640)\n         */\n        _designResolution: cc.size(960, 640),\n        designResolution: {\n            get: function () {\n                return cc.size(this._designResolution);\n            },\n            set: function (value) {\n                this._designResolution.width = value.width;\n                this._designResolution.height = value.height;\n                this.applySettings();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.canvas.design_resolution'\n        },\n\n        _fitWidth: false,\n        _fitHeight: true,\n\n        /**\n         * !#en TODO\n         * !#zh: 是否优先将设计分辨率高度撑满视图高度。\n         * @property {Boolean} fitHeight\n         * @default false\n         */\n        fitHeight: {\n            get: function () {\n                return this._fitHeight;\n            },\n            set: function (value) {\n                if (this._fitHeight !== value) {\n                    this._fitHeight = value;\n                    this.applySettings();\n                }\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.canvas.fit_height'\n        },\n\n        /**\n         * !#en TODO\n         * !#zh: 是否优先将设计分辨率宽度撑满视图宽度。\n         * @property {Boolean} fitWidth\n         * @default false\n         */\n        fitWidth: {\n            get: function () {\n                return this._fitWidth;\n            },\n            set: function (value) {\n                if (this._fitWidth !== value) {\n                    this._fitWidth = value;\n                    this.applySettings();\n                }\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.canvas.fit_width'\n        }\n    },\n\n    // fit canvas node to design resolution\n    _fitDesignResolution: CC_EDITOR && function () {\n        // TODO: support paddings of locked widget\n        var designSize = cc.engine.getDesignResolutionSize();\n        this.node.setPosition(designSize.width * 0.5, designSize.height * 0.5);\n        this.node.setContentSize(designSize);\n    },\n\n    __preload: function () {\n        if (CC_DEV) {\n            var Flags = cc.Object.Flags;\n            this._objFlags |= (Flags.IsPositionLocked | Flags.IsAnchorLocked | Flags.IsSizeLocked);\n        }\n\n        if (Canvas.instance) {\n            return cc.errorID(6700,\n                this.node.name, Canvas.instance.node.name);\n        }\n        Canvas.instance = this;\n\n        // Align node to fit the screen\n        this.applySettings();\n\n        // Stretch to matched size during the scene initialization\n        let widget = this.getComponent(cc.Widget);\n        if (widget) {\n            widget.updateAlignment();\n        }\n        else if (CC_EDITOR) {\n            this._fitDesignResolution();\n        }\n\n        // Constantly align canvas node in edit mode\n        if (CC_EDITOR) {\n            cc.director.on(cc.Director.EVENT_AFTER_UPDATE, this._fitDesignResolution, this);\n            cc.engine.on('design-resolution-changed', this._fitDesignResolution, this);\n        }\n\n        // Camera could be removed in canvas render mode\n        let cameraNode = cc.find('Main Camera', this.node);\n        if (!cameraNode) {\n            cameraNode = new cc.Node('Main Camera');\n            cameraNode.parent = this.node;\n            cameraNode.setSiblingIndex(0);\n        }\n        let camera = cameraNode.getComponent(Camera);\n        if (!camera) {\n            camera = cameraNode.addComponent(Camera);\n\n            let ClearFlags = Camera.ClearFlags;\n            camera.clearFlags = ClearFlags.COLOR | ClearFlags.DEPTH | ClearFlags.STENCIL;\n            camera.depth = -1;\n        }\n        Camera.main = camera;\n    },\n\n    onDestroy: function () {\n        if (CC_EDITOR) {\n            cc.director.off(cc.Director.EVENT_AFTER_UPDATE, this._fitDesignResolution, this);\n            cc.engine.off('design-resolution-changed', this._fitDesignResolution, this);\n        }\n\n        if (Canvas.instance === this) {\n            Canvas.instance = null;\n        }\n    },\n\n    applySettings: function () {\n        var ResolutionPolicy = cc.ResolutionPolicy;\n        var policy;\n\n        if (this.fitHeight && this.fitWidth) {\n            policy = ResolutionPolicy.SHOW_ALL;\n        }\n        else if (!this.fitHeight && !this.fitWidth) {\n            policy = ResolutionPolicy.NO_BORDER;\n        }\n        else if (this.fitWidth) {\n            policy = ResolutionPolicy.FIXED_WIDTH;\n        }\n        else {      // fitHeight\n            policy = ResolutionPolicy.FIXED_HEIGHT;\n        }\n\n        var designRes = this._designResolution;\n        if (CC_EDITOR) {\n            cc.engine.setDesignResolutionSize(designRes.width, designRes.height);\n        }\n        else {\n            cc.view.setDesignResolutionSize(designRes.width, designRes.height, policy);\n        }\n    }\n});\n\n\ncc.Canvas = module.exports = Canvas;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar CCObject = require('../platform/CCObject');\nvar js = require('../platform/js');\nvar idGenerater = new (require('../platform/id-generater'))('Comp');\n\nvar IsOnEnableCalled = CCObject.Flags.IsOnEnableCalled;\nvar IsOnLoadCalled = CCObject.Flags.IsOnLoadCalled;\n\n/**\n * !#en\n * Base class for everything attached to Node(Entity).<br/>\n * <br/>\n * NOTE: Not allowed to use construction parameters for Component's subclasses,\n *       because Component is created by the engine.\n * !#zh\n * 所有附加到节点的基类。<br/>\n * <br/>\n * 注意：不允许使用组件的子类构造参数，因为组件是由引擎创建的。\n *\n * @class Component\n * @extends Object\n */\nvar Component = cc.Class({\n    name: 'cc.Component',\n    extends: CCObject,\n\n    ctor: CC_EDITOR ? function () {\n        if ((typeof _Scene !== \"undefined\") && _Scene.AssetsWatcher) {\n            _Scene.AssetsWatcher.initComponent(this);\n        }\n        this._id = Editor.Utils.UuidUtils.uuid();\n\n        /**\n         * Register all related EventTargets,\n         * all event callbacks will be removed in _onPreDestroy\n         * @property {Array} __eventTargets\n         * @private\n         */\n        this.__eventTargets = [];\n    } : function () {\n        this._id = idGenerater.getNewId();\n\n        this.__eventTargets = [];\n    },\n\n    properties: {\n        /**\n         * !#en The node this component is attached to. A component is always attached to a node.\n         * !#zh 该组件被附加到的节点。组件总会附加到一个节点。\n         * @property node\n         * @type {Node}\n         * @example\n         * cc.log(comp.node);\n         */\n        node: {\n            default: null,\n            visible: false\n        },\n\n        name: {\n            get () {\n                if (this._name) {\n                    return this._name;\n                }\n                var className = cc.js.getClassName(this);\n                var trimLeft = className.lastIndexOf('.');\n                if (trimLeft >= 0) {\n                    className = className.slice(trimLeft + 1);\n                }\n                return this.node.name + '<' + className + '>';\n            },\n            set (value) {\n                this._name = value;\n            },\n            visible: false\n        },\n\n        /**\n         * !#en The uuid for editor.\n         * !#zh 组件的 uuid，用于编辑器。\n         * @property uuid\n         * @type {String}\n         * @readOnly\n         * @example\n         * cc.log(comp.uuid);\n         */\n        uuid: {\n            get () {\n                return this._id;\n            },\n            visible: false\n        },\n\n        __scriptAsset: CC_EDITOR && {\n            get () {},\n            //set (value) {\n            //    if (this.__scriptUuid !== value) {\n            //        if (value && Editor.Utils.UuidUtils.isUuid(value._uuid)) {\n            //            var classId = Editor.Utils.UuidUtils.compressUuid(value._uuid);\n            //            var NewComp = cc.js._getClassById(classId);\n            //            if (js.isChildClassOf(NewComp, cc.Component)) {\n            //                cc.warn('Sorry, replacing component script is not yet implemented.');\n            //                //Editor.Ipc.sendToWins('reload:window-scripts', Editor._Sandbox.compiled);\n            //            }\n            //            else {\n            //                cc.error('Can not find a component in the script which uuid is \"%s\".', value._uuid);\n            //            }\n            //        }\n            //        else {\n            //            cc.error('Invalid Script');\n            //        }\n            //    }\n            //},\n            displayName: 'Script',\n            type: cc._Script,\n            tooltip: CC_DEV && 'i18n:INSPECTOR.component.script'\n        },\n\n        /**\n         * @property _enabled\n         * @type {Boolean}\n         * @private\n         */\n        _enabled: true,\n\n        /**\n         * !#en indicates whether this component is enabled or not.\n         * !#zh 表示该组件自身是否启用。\n         * @property enabled\n         * @type {Boolean}\n         * @default true\n         * @example\n         * comp.enabled = true;\n         * cc.log(comp.enabled);\n         */\n        enabled: {\n            get () {\n                return this._enabled;\n            },\n            set (value) {\n                if (this._enabled !== value) {\n                    this._enabled = value;\n                    if (this.node._activeInHierarchy) {\n                        var compScheduler = cc.director._compScheduler;\n                        if (value) {\n                            compScheduler.enableComp(this);\n                        }\n                        else {\n                            compScheduler.disableComp(this);\n                        }\n                    }\n                }\n            },\n            visible: false,\n            animatable: true\n        },\n\n        /**\n         * !#en indicates whether this component is enabled and its node is also active in the hierarchy.\n         * !#zh 表示该组件是否被启用并且所在的节点也处于激活状态。\n         * @property enabledInHierarchy\n         * @type {Boolean}\n         * @readOnly\n         * @example\n         * cc.log(comp.enabledInHierarchy);\n         */\n        enabledInHierarchy: {\n            get () {\n                return this._enabled && this.node._activeInHierarchy;\n            },\n            visible: false\n        },\n\n        /**\n         * !#en Returns a value which used to indicate the onLoad get called or not.\n         * !#zh 返回一个值用来判断 onLoad 是否被调用过，不等于 0 时调用过，等于 0 时未调用。\n         * @property _isOnLoadCalled\n         * @type {Number}\n         * @readOnly\n         * @example\n         * cc.log(this._isOnLoadCalled > 0);\n         */\n        _isOnLoadCalled: {\n            get () {\n                return this._objFlags & IsOnLoadCalled;\n            }\n        },\n    },\n\n    // LIFECYCLE METHODS\n\n    // Fireball provides lifecycle methods that you can specify to hook into this process.\n    // We provide Pre methods, which are called right before something happens, and Post methods which are called right after something happens.\n\n    /**\n     * !#en Update is called every frame, if the Component is enabled.<br/>\n     * This is a lifecycle method. It may not be implemented in the super class. You can only call its super class method inside it. It should not be called manually elsewhere.\n     * !#zh 如果该组件启用，则每帧调用 update。<br/>\n     * 该方法为生命周期方法，父类未必会有实现。并且你只能在该方法内部调用父类的实现，不可在其它地方直接调用该方法。\n     * @method update\n     * @param {Number} dt - the delta time in seconds it took to complete the last frame\n     * @protected\n     */\n    update: null,\n\n    /**\n     * !#en LateUpdate is called every frame, if the Component is enabled.<br/>\n     * This is a lifecycle method. It may not be implemented in the super class. You can only call its super class method inside it. It should not be called manually elsewhere.\n     * !#zh 如果该组件启用，则每帧调用 LateUpdate。<br/>\n     * 该方法为生命周期方法，父类未必会有实现。并且你只能在该方法内部调用父类的实现，不可在其它地方直接调用该方法。\n     * @method lateUpdate\n     * @param {Number} dt - the delta time in seconds it took to complete the last frame\n     * @protected\n     */\n    lateUpdate: null,\n\n    /**\n     * `__preload` is called before every onLoad.\n     * It is used to initialize the builtin components internally,\n     * to avoid checking whether onLoad is called before every public method calls.\n     * This method should be removed if script priority is supported.\n     *\n     * @method __preload\n     * @private\n     */\n    __preload: null,\n\n    /**\n     * !#en\n     * When attaching to an active node or its node first activated.\n     * onLoad is always called before any start functions, this allows you to order initialization of scripts.<br/>\n     * This is a lifecycle method. It may not be implemented in the super class. You can only call its super class method inside it. It should not be called manually elsewhere.\n     * !#zh\n     * 当附加到一个激活的节点上或者其节点第一次激活时候调用。onLoad 总是会在任何 start 方法调用前执行，这能用于安排脚本的初始化顺序。<br/>\n     * 该方法为生命周期方法，父类未必会有实现。并且你只能在该方法内部调用父类的实现，不可在其它地方直接调用该方法。\n     * @method onLoad\n     * @protected\n     */\n    onLoad: null,\n\n    /**\n     * !#en\n     * Called before all scripts' update if the Component is enabled the first time.\n     * Usually used to initialize some logic which need to be called after all components' `onload` methods called.<br/>\n     * This is a lifecycle method. It may not be implemented in the super class. You can only call its super class method inside it. It should not be called manually elsewhere.\n     * !#zh\n     * 如果该组件第一次启用，则在所有组件的 update 之前调用。通常用于需要在所有组件的 onLoad 初始化完毕后执行的逻辑。<br/>\n     * 该方法为生命周期方法，父类未必会有实现。并且你只能在该方法内部调用父类的实现，不可在其它地方直接调用该方法。\n     * @method start\n     * @protected\n     */\n    start: null,\n\n    /**\n     * !#en Called when this component becomes enabled and its node is active.<br/>\n     * This is a lifecycle method. It may not be implemented in the super class. You can only call its super class method inside it. It should not be called manually elsewhere.\n     * !#zh 当该组件被启用，并且它的节点也激活时。<br/>\n     * 该方法为生命周期方法，父类未必会有实现。并且你只能在该方法内部调用父类的实现，不可在其它地方直接调用该方法。\n     * @method onEnable\n     * @protected\n     */\n    onEnable: null,\n\n    /**\n     * !#en Called when this component becomes disabled or its node becomes inactive.<br/>\n     * This is a lifecycle method. It may not be implemented in the super class. You can only call its super class method inside it. It should not be called manually elsewhere.\n     * !#zh 当该组件被禁用或节点变为无效时调用。<br/>\n     * 该方法为生命周期方法，父类未必会有实现。并且你只能在该方法内部调用父类的实现，不可在其它地方直接调用该方法。\n     * @method onDisable\n     * @protected\n     */\n    onDisable: null,\n\n    /**\n     * !#en Called when this component will be destroyed.<br/>\n     * This is a lifecycle method. It may not be implemented in the super class. You can only call its super class method inside it. It should not be called manually elsewhere.\n     * !#zh 当该组件被销毁时调用<br/>\n     * 该方法为生命周期方法，父类未必会有实现。并且你只能在该方法内部调用父类的实现，不可在其它地方直接调用该方法。\n     * @method onDestroy\n     * @protected\n     */\n    onDestroy: null,\n\n    /**\n     * @method onFocusInEditor\n     * @protected\n     */\n    onFocusInEditor: null,\n    /**\n     * @method onLostFocusInEditor\n     * @protected\n     */\n    onLostFocusInEditor: null,\n    /**\n     * !#en Called to initialize the component or node’s properties when adding the component the first time or when the Reset command is used. This function is only called in editor.\n     * !#zh 用来初始化组件或节点的一些属性，当该组件被第一次添加到节点上或用户点击了它的 Reset 菜单时调用。这个回调只会在编辑器下调用。\n     * @method resetInEditor\n     * @protected\n     */\n    resetInEditor: null,\n\n    // PUBLIC\n\n    /**\n     * !#en Adds a component class to the node. You can also add component to node by passing in the name of the script.\n     * !#zh 向节点添加一个组件类，你还可以通过传入脚本的名称来添加组件。\n     *\n     * @method addComponent\n     * @param {Function|String} typeOrClassName - the constructor or the class name of the component to add\n     * @return {Component} - the newly added component\n     * @example\n     * var sprite = node.addComponent(cc.Sprite);\n     * var test = node.addComponent(\"Test\");\n     * @typescript\n     * addComponent<T extends Component>(type: {new(): T}): T\n     * addComponent(className: string): any\n     */\n    addComponent (typeOrClassName) {\n        return this.node.addComponent(typeOrClassName);\n    },\n\n    /**\n     * !#en\n     * Returns the component of supplied type if the node has one attached, null if it doesn't.<br/>\n     * You can also get component in the node by passing in the name of the script.\n     * !#zh\n     * 获取节点上指定类型的组件，如果节点有附加指定类型的组件，则返回，如果没有则为空。<br/>\n     * 传入参数也可以是脚本的名称。\n     *\n     * @method getComponent\n     * @param {Function|String} typeOrClassName\n     * @return {Component}\n     * @example\n     * // get sprite component.\n     * var sprite = node.getComponent(cc.Sprite);\n     * // get custom test calss.\n     * var test = node.getComponent(\"Test\");\n     * @typescript\n     * getComponent<T extends Component>(type: {prototype: T}): T\n     * getComponent(className: string): any\n     */\n    getComponent (typeOrClassName) {\n        return this.node.getComponent(typeOrClassName);\n    },\n\n    /**\n     * !#en Returns all components of supplied Type in the node.\n     * !#zh 返回节点上指定类型的所有组件。\n     *\n     * @method getComponents\n     * @param {Function|String} typeOrClassName\n     * @return {Component[]}\n     * @example\n     * var sprites = node.getComponents(cc.Sprite);\n     * var tests = node.getComponents(\"Test\");\n     * @typescript\n     * getComponents<T extends Component>(type: {prototype: T}): T[]\n     * getComponents(className: string): any[]\n     */\n    getComponents (typeOrClassName) {\n        return this.node.getComponents(typeOrClassName);\n    },\n\n    /**\n     * !#en Returns the component of supplied type in any of its children using depth first search.\n     * !#zh 递归查找所有子节点中第一个匹配指定类型的组件。\n     *\n     * @method getComponentInChildren\n     * @param {Function|String} typeOrClassName\n     * @returns {Component}\n     * @example\n     * var sprite = node.getComponentInChildren(cc.Sprite);\n     * var Test = node.getComponentInChildren(\"Test\");\n     * @typescript\n     * getComponentInChildren<T extends Component>(type: {prototype: T}): T\n     * getComponentInChildren(className: string): any\n     */\n    getComponentInChildren (typeOrClassName) {\n        return this.node.getComponentInChildren(typeOrClassName);\n    },\n\n    /**\n     * !#en Returns the components of supplied type in self or any of its children using depth first search.\n     * !#zh 递归查找自身或所有子节点中指定类型的组件\n     *\n     * @method getComponentsInChildren\n     * @param {Function|String} typeOrClassName\n     * @returns {Component[]}\n     * @example\n     * var sprites = node.getComponentsInChildren(cc.Sprite);\n     * var tests = node.getComponentsInChildren(\"Test\");\n     * @typescript\n     * getComponentsInChildren<T extends Component>(type: {prototype: T}): T[]\n     * getComponentsInChildren(className: string): any[]\n     */\n    getComponentsInChildren (typeOrClassName) {\n        return this.node.getComponentsInChildren(typeOrClassName);\n    },\n\n    // VIRTUAL\n\n    /**\n     * !#en\n     * If the component's bounding box is different from the node's, you can implement this method to supply\n     * a custom axis aligned bounding box (AABB), so the editor's scene view can perform hit test properly.\n     * !#zh\n     * 如果组件的包围盒与节点不同，您可以实现该方法以提供自定义的轴向对齐的包围盒（AABB），\n     * 以便编辑器的场景视图可以正确地执行点选测试。\n     *\n     * @method _getLocalBounds\n     * @param {Rect} out_rect - the Rect to receive the bounding box\n     */\n    _getLocalBounds: null,\n\n    /**\n     * !#en\n     * onRestore is called after the user clicks the Reset item in the Inspector's context menu or performs\n     * an undo operation on this component.<br/>\n     * <br/>\n     * If the component contains the \"internal state\", short for \"temporary member variables which not included<br/>\n     * in its CCClass properties\", then you may need to implement this function.<br/>\n     * <br/>\n     * The editor will call the getset accessors of your component to record/restore the component's state<br/>\n     * for undo/redo operation. However, in extreme cases, it may not works well. Then you should implement<br/>\n     * this function to manually synchronize your component's \"internal states\" with its public properties.<br/>\n     * Once you implement this function, all the getset accessors of your component will not be called when<br/>\n     * the user performs an undo/redo operation. Which means that only the properties with default value<br/>\n     * will be recorded or restored by editor.<br/>\n     * <br/>\n     * Similarly, the editor may failed to reset your component correctly in extreme cases. Then if you need<br/>\n     * to support the reset menu, you should manually synchronize your component's \"internal states\" with its<br/>\n     * properties in this function. Once you implement this function, all the getset accessors of your component<br/>\n     * will not be called during reset operation. Which means that only the properties with default value<br/>\n     * will be reset by editor.\n     *\n     * This function is only called in editor mode.\n     * !#zh\n     * onRestore 是用户在检查器菜单点击 Reset 时，对此组件执行撤消操作后调用的。<br/>\n     * <br/>\n     * 如果组件包含了“内部状态”（不在 CCClass 属性中定义的临时成员变量），那么你可能需要实现该方法。<br/>\n     * <br/>\n     * 编辑器执行撤销/重做操作时，将调用组件的 get set 来录制和还原组件的状态。\n     * 然而，在极端的情况下，它可能无法良好运作。<br/>\n     * 那么你就应该实现这个方法，手动根据组件的属性同步“内部状态”。\n     * 一旦你实现这个方法，当用户撤销或重做时，组件的所有 get set 都不会再被调用。\n     * 这意味着仅仅指定了默认值的属性将被编辑器记录和还原。<br/>\n     * <br/>\n     * 同样的，编辑可能无法在极端情况下正确地重置您的组件。<br/>\n     * 于是如果你需要支持组件重置菜单，你需要在该方法中手工同步组件属性到“内部状态”。<br/>\n     * 一旦你实现这个方法，组件的所有 get set 都不会在重置操作时被调用。\n     * 这意味着仅仅指定了默认值的属性将被编辑器重置。\n     * <br/>\n     * 此方法仅在编辑器下会被调用。\n     * @method onRestore\n     */\n    onRestore: null,\n\n    // OVERRIDE\n\n    destroy () {\n        if (CC_EDITOR) {\n            var depend = this.node._getDependComponent(this);\n            if (depend) {\n                return cc.errorID(3626,\n                    cc.js.getClassName(this), cc.js.getClassName(depend));\n            }\n        }\n        if (this._super()) {\n            if (this._enabled && this.node._activeInHierarchy) {\n                cc.director._compScheduler.disableComp(this);\n            }\n        }\n    },\n\n    _onPreDestroy () {\n        // Schedules\n        this.unscheduleAllCallbacks();\n\n        // Remove all listeners\n        var eventTargets = this.__eventTargets;\n        for (var i = eventTargets.length - 1; i >= 0; --i) {\n            var target = eventTargets[i];\n            target && target.targetOff(this);\n        }\n        eventTargets.length = 0;\n\n        //\n        if (CC_EDITOR && !CC_TEST) {\n            _Scene.AssetsWatcher.stop(this);\n        }\n\n        // onDestroy\n        cc.director._nodeActivator.destroyComp(this);\n\n        // do remove component\n        this.node._removeComponent(this);\n    },\n\n    _instantiate (cloned) {\n        if (!cloned) {\n            cloned = cc.instantiate._clone(this, this);\n        }\n        cloned.node = null;\n        return cloned;\n    },\n\n// Scheduler\n\n    /**\n     * !#en\n     * Schedules a custom selector.<br/>\n     * If the selector is already scheduled, then the interval parameter will be updated without scheduling it again.\n     * !#zh\n     * 调度一个自定义的回调函数。<br/>\n     * 如果回调函数已调度，那么将不会重复调度它，只会更新时间间隔参数。\n     * @method schedule\n     * @param {function} callback The callback function\n     * @param {Number} [interval=0]  Tick interval in seconds. 0 means tick every frame.\n     * @param {Number} [repeat=cc.macro.REPEAT_FOREVER]    The selector will be executed (repeat + 1) times, you can use cc.macro.REPEAT_FOREVER for tick infinitely.\n     * @param {Number} [delay=0]     The amount of time that the first tick will wait before execution. Unit: s\n     * @example\n     * var timeCallback = function (dt) {\n     *   cc.log(\"time: \" + dt);\n     * }\n     * this.schedule(timeCallback, 1);\n     */\n    schedule (callback, interval, repeat, delay) {\n        cc.assertID(callback, 1619);\n\n        interval = interval || 0;\n        cc.assertID(interval >= 0, 1620);\n\n        repeat = isNaN(repeat) ? cc.macro.REPEAT_FOREVER : repeat;\n        delay = delay || 0;\n\n        var scheduler = cc.director.getScheduler();\n\n        // should not use enabledInHierarchy to judge whether paused,\n        // because enabledInHierarchy is assigned after onEnable.\n        // Actually, if not yet scheduled, resumeTarget/pauseTarget has no effect on component,\n        // therefore there is no way to guarantee the paused state other than isTargetPaused.\n        var paused = scheduler.isTargetPaused(this);\n\n        scheduler.schedule(callback, this, interval, repeat, delay, paused);\n    },\n\n    /**\n     * !#en Schedules a callback function that runs only once, with a delay of 0 or larger.\n     * !#zh 调度一个只运行一次的回调函数，可以指定 0 让回调函数在下一帧立即执行或者在一定的延时之后执行。\n     * @method scheduleOnce\n     * @see cc.Node#schedule\n     * @param {function} callback  A function wrapped as a selector\n     * @param {Number} [delay=0]  The amount of time that the first tick will wait before execution. Unit: s\n     * @example\n     * var timeCallback = function (dt) {\n     *   cc.log(\"time: \" + dt);\n     * }\n     * this.scheduleOnce(timeCallback, 2);\n     */\n    scheduleOnce (callback, delay) {\n        this.schedule(callback, 0, 0, delay);\n    },\n\n    /**\n     * !#en Unschedules a custom callback function.\n     * !#zh 取消调度一个自定义的回调函数。\n     * @method unschedule\n     * @see cc.Node#schedule\n     * @param {function} callback_fn  A function wrapped as a selector\n     * @example\n     * this.unschedule(_callback);\n     */\n    unschedule (callback_fn) {\n        if (!callback_fn)\n            return;\n\n        cc.director.getScheduler().unschedule(callback_fn, this);\n    },\n\n    /**\n     * !#en\n     * unschedule all scheduled callback functions: custom callback functions, and the 'update' callback function.<br/>\n     * Actions are not affected by this method.\n     * !#zh 取消调度所有已调度的回调函数：定制的回调函数以及 'update' 回调函数。动作不受此方法影响。\n     * @method unscheduleAllCallbacks\n     * @example\n     * this.unscheduleAllCallbacks();\n     */\n    unscheduleAllCallbacks () {\n        cc.director.getScheduler().unscheduleAllForTarget(this);\n    },\n});\n\nComponent._requireComponent = null;\nComponent._executionOrder = 0;\n\nif (CC_EDITOR || CC_TEST) {\n\n    // INHERITABLE STATIC MEMBERS\n\n    Component._executeInEditMode = false;\n    Component._playOnFocus = false;\n    Component._disallowMultiple = null;\n    Component._help = '';\n\n    // NON-INHERITED STATIC MEMBERS\n    // (TypeScript 2.3 will still inherit them, so always check hasOwnProperty before using)\n\n    js.value(Component, '_inspector', '', true);\n    js.value(Component, '_icon', '', true);\n\n    // COMPONENT HELPERS\n\n    cc._componentMenuItems = [];\n\n    Component._addMenuItem = function (cls, path, priority) {\n        cc._componentMenuItems.push({\n            component: cls,\n            menuPath: path,\n            priority: priority\n        });\n    };\n}\n\n// we make this non-enumerable, to prevent inherited by sub classes.\njs.value(Component, '_registerEditorProps', function (cls, props) {\n    var reqComp = props.requireComponent;\n    if (reqComp) {\n        cls._requireComponent = reqComp;\n    }\n    var order = props.executionOrder;\n    if (order && typeof order === 'number') {\n        cls._executionOrder = order;\n    }\n    if (CC_EDITOR || CC_TEST) {\n        var name = cc.js.getClassName(cls);\n        for (var key in props) {\n            var val = props[key];\n            switch (key) {\n                case 'executeInEditMode':\n                    cls._executeInEditMode = !!val;\n                    break;\n\n                case 'playOnFocus':\n                    if (val) {\n                        var willExecuteInEditMode = ('executeInEditMode' in props) ? props.executeInEditMode : cls._executeInEditMode;\n                        if (willExecuteInEditMode) {\n                            cls._playOnFocus = true;\n                        }\n                        else {\n                            cc.warnID(3601, name);\n                        }\n                    }\n                    break;\n\n                case 'inspector':\n                    js.value(cls, '_inspector', val, true);\n                    break;\n\n                case 'icon':\n                    js.value(cls, '_icon', val, true);\n                    break;\n\n                case 'menu':\n                    Component._addMenuItem(cls, val, props.menuPriority);\n                    break;\n\n                case 'disallowMultiple':\n                    cls._disallowMultiple = cls;\n                    break;\n\n                case 'requireComponent':\n                case 'executionOrder':\n                    // skip here\n                    break;\n\n                case 'help':\n                    cls._help = val;\n                    break;\n\n                default:\n                    cc.warnID(3602, key, name);\n                    break;\n            }\n        }\n    }\n});\n\nComponent.prototype.__scriptUuid = '';\n\ncc.Component = module.exports = Component;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#en\n * Component will register a event to target component's handler.\n * And it will trigger the handler when a certain event occurs.\n *\n * !@zh\n * “EventHandler” 类用来设置场景中的事件回调，\n * 该类允许用户设置回调目标节点，目标组件名，组件方法名，\n * 并可通过 emit 方法调用目标函数。\n * @class Component.EventHandler\n * @example\n * // Let's say we have a MainMenu component on newTarget\n * // file: MainMenu.js\n * cc.Class({\n *   extends: cc.Component,\n *   // sender: the node MainMenu.js belongs to\n *   // eventType: CustomEventData\n *   onClick (sender, eventType) {\n *     cc.log('click');\n *   }\n * })\n * // Create new EventHandler\n * var eventHandler = new cc.Component.EventHandler();\n * eventHandler.target = newTarget;\n * eventHandler.component = \"MainMenu\";\n * eventHandler.handler = \"onClick\";\n * eventHandler.customEventData = \"my data\";\n */\ncc.Component.EventHandler = cc.Class({\n    name: 'cc.ClickEvent',\n    properties: {\n        /**\n         * !#en the node that contains target callback, such as the node example script belongs to\n         * !#zh 事件响应函数所在节点 ，比如例子中脚本归属的节点本身\n         * @property target\n         * @type {Node}\n         * @default null\n         */\n        target: {\n            default: null,\n            type: cc.Node,\n        },\n        /**\n         * !#en name of the component(script) that contains target callback, such as the name 'MainMenu' of script in example\n         * !#zh 事件响应函数所在组件名（脚本名）, 比如例子中的脚本名 'MainMenu'\n         * @property component\n         * @type {String}\n         * @default ''\n         */\n        // only for deserializing old project component field\n        component: '',\n        _componentId: '',\n        _componentName: {\n            get () {\n                this._genCompIdIfNeeded();\n\n                return this._compId2Name(this._componentId);\n            },\n            set (value) {\n                this._componentId = this._compName2Id(value);\n            },\n        },\n        /**\n         * !#en Event handler, such as function's name 'onClick' in example\n         * !#zh 响应事件函数名，比如例子中的 'onClick'\n         * @property handler\n         * @type {String}\n         * @default ''\n         */\n        handler: {\n            default: '',\n        },\n\n        /**\n         * !#en Custom Event Data, such as 'eventType' in example\n         * !#zh 自定义事件数据，比如例子中的 eventType\n         * @property customEventData\n         * @default ''\n         * @type {String}\n         */\n        customEventData: {\n            default: ''\n        }\n    },\n\n    statics: {\n        /**\n         * @method emitEvents\n         * @param {Component.EventHandler[]} events\n         * @param {any} ...params\n         * @static\n         */\n        emitEvents: function(events) {\n            'use strict';\n            let args;\n            if (arguments.length > 0) {\n                args = new Array(arguments.length - 1);\n                for (let i = 0, l = args.length; i < l; i++) {\n                    args[i] = arguments[i+1];\n                }\n            }\n            for (let i = 0, l = events.length; i < l; i++) {\n                var event = events[i];\n                if (!(event instanceof cc.Component.EventHandler)) continue;\n\n                event.emit(args);\n            }\n        }\n    },\n\n    /**\n     * !#en Emit event with params\n     * !#zh 触发目标组件上的指定 handler 函数，该参数是回调函数的参数值（可不填）。\n     * @method emit\n     * @param {Array} params\n     * @example\n     * // Call Function\n     * var eventHandler = new cc.Component.EventHandler();\n     * eventHandler.target = newTarget;\n     * eventHandler.component = \"MainMenu\";\n     * eventHandler.handler = \"OnClick\"\n     * eventHandler.emit([\"param1\", \"param2\", ....]);\n     */\n    emit: function(params) {\n        var target = this.target;\n        if (!cc.isValid(target)) return;\n\n        this._genCompIdIfNeeded();\n        var compType = cc.js._getClassById(this._componentId);\n        \n        var comp = target.getComponent(compType);\n        if (!cc.isValid(comp)) return;\n\n        var handler = comp[this.handler];\n        if (typeof(handler) !== 'function') return;\n\n        if (this.customEventData != null && this.customEventData !== '') {\n            params = params.slice();\n            params.push(this.customEventData);\n        }\n\n        handler.apply(comp, params);\n    },\n\n    _compName2Id (compName) {\n        let comp = cc.js.getClassByName(compName);\n        return cc.js._getClassId(comp);\n    },\n\n    _compId2Name (compId) {\n        let comp = cc.js._getClassById(compId);\n        return cc.js.getClassName(comp);\n    },\n\n    // to be deprecated in the future\n    _genCompIdIfNeeded () {\n        if (!this._componentId) {\n            this._componentName = this.component;\n            this.component = '';\n        }\n    },\n});\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst macro = require('../platform/CCMacro');\nconst RenderComponent = require('./CCRenderComponent');\nconst Material = require('../assets/material/CCMaterial');\nconst LabelFrame = require('../renderer/utils/label/label-frame');\n\n/**\n * !#en Enum for text alignment.\n * !#zh 文本横向对齐类型\n * @enum Label.HorizontalAlign\n */\n/**\n * !#en Alignment left for text.\n * !#zh 文本内容左对齐。\n * @property {Number} LEFT\n */\n/**\n * !#en Alignment center for text.\n * !#zh 文本内容居中对齐。\n * @property {Number} CENTER\n */\n/**\n * !#en Alignment right for text.\n * !#zh 文本内容右边对齐。\n * @property {Number} RIGHT\n */\nconst HorizontalAlign = macro.TextAlignment;\n\n/**\n * !#en Enum for vertical text alignment.\n * !#zh 文本垂直对齐类型\n * @enum Label.VerticalAlign\n */\n/**\n * !#en Vertical alignment top for text.\n * !#zh 文本顶部对齐。\n * @property {Number} TOP\n */\n/**\n * !#en Vertical alignment center for text.\n * !#zh 文本居中对齐。\n * @property {Number} CENTER\n */\n/**\n * !#en Vertical alignment bottom for text.\n * !#zh 文本底部对齐。\n * @property {Number} BOTTOM\n */\nconst VerticalAlign = macro.VerticalTextAlignment;\n\n/**\n * !#en Enum for Overflow.\n * !#zh Overflow 类型\n * @enum Label.Overflow\n */\n/**\n * !#en NONE.\n * !#zh 不做任何限制。\n * @property {Number} NONE\n */\n/**\n * !#en In CLAMP mode, when label content goes out of the bounding box, it will be clipped.\n * !#zh CLAMP 模式中，当文本内容超出边界框时，多余的会被截断。\n * @property {Number} CLAMP\n */\n/**\n * !#en In SHRINK mode, the font size will change dynamically to adapt the content size. This mode may takes up more CPU resources when the label is refreshed.\n * !#zh SHRINK 模式，字体大小会动态变化，以适应内容大小。这个模式在文本刷新的时候可能会占用较多 CPU 资源。\n * @property {Number} SHRINK\n */\n/**\n * !#en In RESIZE_HEIGHT mode, you can only change the width of label and the height is changed automatically.\n * !#zh 在 RESIZE_HEIGHT 模式下，只能更改文本的宽度，高度是自动改变的。\n * @property {Number} RESIZE_HEIGHT\n */\nconst Overflow = cc.Enum({\n    NONE: 0,\n    CLAMP: 1,\n    SHRINK: 2,\n    RESIZE_HEIGHT: 3\n});\n\n/**\n * !#en Enum for font type.\n * !#zh Type 类型\n * @enum Label.Type\n */\n/**\n * !#en The TTF font type.\n * !#zh TTF字体\n * @property {Number} TTF\n */\n/**\n * !#en The bitmap font type.\n * !#zh 位图字体\n * @property {Number} BMFont\n */\n/**\n * !#en The system font type.\n * !#zh 系统字体\n * @property {Number} SystemFont\n */\n\n/**\n * !#en Enum for cache mode.\n * !#zh CacheMode 类型\n * @enum Label.CacheMode\n */\n /**\n * !#en Do not do any caching.\n * !#zh 不做任何缓存。\n * @property {Number} NONE\n */\n/**\n * !#en In BITMAP mode, cache the label as a static image and add it to the dynamic atlas for batch rendering, and can batching with Sprites using broken images.\n * !#zh BITMAP 模式，将 label 缓存成静态图像并加入到动态图集，以便进行批次合并，可与使用碎图的 Sprite 进行合批（注：动态图集在 Chrome 以及微信小游戏暂时关闭，该功能无效）。\n * @property {Number} BITMAP\n */\n/**\n * !#en In CHAR mode, split text into characters and cache characters into a dynamic atlas which the size of 2048*2048. \n * !#zh CHAR 模式，将文本拆分为字符，并将字符缓存到一张单独的大小为 2048*2048 的图集中进行重复使用，不再使用动态图集（注：当图集满时将不再进行缓存，暂时不支持 SHRINK 自适应文本尺寸（后续完善））。\n * @property {Number} CHAR\n */\nconst CacheMode = cc.Enum({\n    NONE: 0,\n    BITMAP: 1,\n    CHAR: 2,\n});\n\nconst BOLD_FLAG = 1 << 0;\nconst ITALIC_FLAG = 1 << 1;\nconst UNDERLINE_FLAG = 1 << 2;\n\n/**\n * !#en The Label Component.\n * !#zh 文字标签组件\n * @class Label\n * @extends RenderComponent\n */\nlet Label = cc.Class({\n    name: 'cc.Label',\n    extends: RenderComponent,\n\n    ctor () {\n        if (CC_EDITOR) {\n            this._userDefinedFont = null;\n        }\n\n        this._actualFontSize = 0;\n        this._assemblerData = null;\n\n        this._frame = null;\n        this._ttfTexture = null;\n        this._letterTexture = null;\n\n        if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {\n            this._updateMaterial = this._updateMaterialCanvas;\n        }\n        else {\n            this._updateMaterial = this._updateMaterialWebgl;\n        }\n    },\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.renderers/Label',\n        help: 'i18n:COMPONENT.help_url.label',\n        inspector: 'packages://inspector/inspectors/comps/label.js',\n    },\n\n    properties: {\n        _useOriginalSize: true,\n        \n        /**\n         * !#en Content string of label.\n         * !#zh 标签显示的文本内容。\n         * @property {String} string\n         */\n        _string: {\n            default: '',\n            formerlySerializedAs: '_N$string',\n        },\n        string: {\n            get () {\n                return this._string;\n            },\n            set (value) {\n                let oldValue = this._string;\n                this._string = '' + value;\n\n                if (this.string !== oldValue) {\n                    this.setVertsDirty();\n                }\n\n                this._checkStringEmpty();\n            },\n            multiline: true,\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.string'\n        },\n\n        /**\n         * !#en Horizontal Alignment of label.\n         * !#zh 文本内容的水平对齐方式。\n         * @property {Label.HorizontalAlign} horizontalAlign\n         */\n        horizontalAlign: {\n            default: HorizontalAlign.LEFT,\n            type: HorizontalAlign,\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.horizontal_align',\n            notify  (oldValue) {\n                if (this.horizontalAlign === oldValue) return;\n                this.setVertsDirty();\n            },\n            animatable: false\n        },\n\n        /**\n         * !#en Vertical Alignment of label.\n         * !#zh 文本内容的垂直对齐方式。\n         * @property {Label.VerticalAlign} verticalAlign\n         */\n        verticalAlign: {\n            default: VerticalAlign.TOP,\n            type: VerticalAlign,\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.vertical_align',\n            notify (oldValue) {\n                if (this.verticalAlign === oldValue) return;\n                this.setVertsDirty();\n            },\n            animatable: false\n        },\n\n\n        /**\n         * !#en The actual rendering font size in shrink mode\n         * !#zh SHRINK 模式下面文本实际渲染的字体大小\n         * @property {Number} actualFontSize\n         */\n        actualFontSize: {\n            displayName: 'Actual Font Size',\n            animatable: false,\n            readonly: true,\n            get () {\n                return this._actualFontSize;\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.actualFontSize',\n        },\n\n        _fontSize: 40,\n        /**\n         * !#en Font size of label.\n         * !#zh 文本字体大小。\n         * @property {Number} fontSize\n         */\n        fontSize: {\n            get () {\n                return this._fontSize;\n            },\n            set (value) {\n                if (this._fontSize === value) return;\n\n                this._fontSize = value;\n                this.setVertsDirty();\n            },\n            range: [0, 512],\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.font_size',\n        },\n\n        /**\n         * !#en Font family of label, only take effect when useSystemFont property is true.\n         * !#zh 文本字体名称, 只在 useSystemFont 属性为 true 的时候生效。\n         * @property {String} fontFamily\n         */\n        fontFamily: {\n            default: \"Arial\",\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.font_family',\n            notify (oldValue) {\n                if (this.fontFamily === oldValue) return;\n                this.setVertsDirty();\n            },\n            animatable: false\n        },\n\n        _lineHeight: 40,\n        /**\n         * !#en Line Height of label.\n         * !#zh 文本行高。\n         * @property {Number} lineHeight\n         */\n        lineHeight: {\n            get () {\n                return this._lineHeight;\n            },\n            set (value) {\n                if (this._lineHeight === value) return;\n                this._lineHeight = value;\n                this.setVertsDirty();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.line_height',\n        },\n        /**\n         * !#en Overflow of label.\n         * !#zh 文字显示超出范围时的处理方式。\n         * @property {Label.Overflow} overflow\n         */\n        overflow: {\n            default: Overflow.NONE,\n            type: Overflow,\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.overflow',\n            notify (oldValue) {\n                if (this.overflow === oldValue) return;\n                this.setVertsDirty();\n            },\n            animatable: false\n        },\n\n        _enableWrapText: true,\n        /**\n         * !#en Whether auto wrap label when string width is large than label width.\n         * !#zh 是否自动换行。\n         * @property {Boolean} enableWrapText\n         */\n        enableWrapText: {\n            get () {\n                return this._enableWrapText;\n            },\n            set (value) {\n                if (this._enableWrapText === value) return;\n\n                this._enableWrapText = value;\n                this.setVertsDirty();\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.wrap',\n        },\n\n        // 这个保存了旧项目的 file 数据\n        _N$file: null,\n\n        /**\n         * !#en The font of label.\n         * !#zh 文本字体。\n         * @property {Font} font\n         */\n        font: {\n            get () {\n                return this._N$file;\n            },\n            set (value) {\n                if (this.font === value) return;\n                \n                //if delete the font, we should change isSystemFontUsed to true\n                if (!value) {\n                    this._isSystemFontUsed = true;\n                }\n\n                if (CC_EDITOR && value) {\n                    this._userDefinedFont = value;\n                }\n                this._N$file = value;\n                if (value && this._isSystemFontUsed)\n                    this._isSystemFontUsed = false;\n\n                if ( typeof value === 'string' ) {\n                    cc.warnID(4000);\n                }\n\n                if (!this.enabledInHierarchy) return;\n\n                this._forceUpdateRenderData();\n            },\n            type: cc.Font,\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.font',\n            animatable: false\n        },\n\n        _isSystemFontUsed: true,\n\n        /**\n         * !#en Whether use system font name or not.\n         * !#zh 是否使用系统字体。\n         * @property {Boolean} useSystemFont\n         */\n        useSystemFont: {\n            get () {\n                return this._isSystemFontUsed;\n            },\n            set (value) {\n                if (this._isSystemFontUsed === value) return;\n                this._isSystemFontUsed = !!value;\n                if (CC_EDITOR) {\n                    if (!value && this._userDefinedFont) {\n                        this.font = this._userDefinedFont;\n                        this.spacingX = this._spacingX;\n                        return;\n                    }\n                }\n\n                if (value) {\n                    this.font = null;\n\n                    if (!this.enabledInHierarchy) return;\n                    \n                    this._forceUpdateRenderData();\n                }\n                this.markForValidate();\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.system_font',\n        },\n\n        _bmFontOriginalSize: {\n            displayName: 'BMFont Original Size',\n            get () {\n                if (this._N$file instanceof cc.BitmapFont) {\n                    return this._N$file.fontSize;\n                }\n                else {\n                    return -1;\n                }\n            },\n            visible: true,\n            animatable: false\n        },\n\n        _spacingX: 0,\n\n        /**\n         * !#en The spacing of the x axis between characters.\n         * !#zh 文字之间 x 轴的间距。\n         * @property {Number} spacingX\n         */\n        spacingX: {\n            get () {\n                return this._spacingX;\n            },\n            set (value) {\n                this._spacingX = value;\n                this.setVertsDirty();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.spacingX',\n        },\n\n        //For compatibility with v2.0.x temporary reservation.\n        _batchAsBitmap: false,\n\n        /**\n         * !#en The cache mode of label. This mode only supports system fonts.\n         * !#zh 文本缓存模式, 该模式只支持系统字体。\n         * @property {Label.CacheMode} cacheMode\n         */\n        cacheMode: {\n            default: CacheMode.NONE,\n            type: CacheMode,\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.cacheMode',\n            notify (oldValue) {\n                if (this.cacheMode === oldValue) return;\n                \n                if (oldValue === CacheMode.BITMAP && !(this.font instanceof cc.BitmapFont)) {\n                    this._frame && this._frame._resetDynamicAtlasFrame();\n                }\n\n                if (oldValue === CacheMode.CHAR) {\n                    this._ttfTexture = null;\n                }\n\n                if (!this.enabledInHierarchy) return;\n\n                this._forceUpdateRenderData();\n            },\n            animatable: false\n        },\n\n        _styleFlags: 0,\n\n        /**\n         * !#en Whether enable bold.\n         * !#zh 是否启用黑体。\n         * @property {Boolean} enableBold\n         */\n        enableBold: {\n            get () {\n                return !!(this._styleFlags & BOLD_FLAG);\n            },\n            set (value) {\n                if (value) {\n                    this._styleFlags |= BOLD_FLAG;\n                } else {\n                    this._styleFlags &= ~BOLD_FLAG;\n                }\n\n                this.setVertsDirty();\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.bold'\n        },\n\n        /**\n         * !#en Whether enable italic.\n         * !#zh 是否启用黑体。\n         * @property {Boolean} enableItalic\n         */\n        enableItalic: {\n            get () {\n                return !!(this._styleFlags & ITALIC_FLAG);\n            },\n            set (value) {\n                if (value) {\n                    this._styleFlags |= ITALIC_FLAG;\n                } else {\n                    this._styleFlags &= ~ITALIC_FLAG;\n                }\n                \n                this.setVertsDirty();\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.italic'\n        },\n\n        /**\n         * !#en Whether enable underline.\n         * !#zh 是否启用下划线。\n         * @property {Boolean} enableUnderline\n         */\n        enableUnderline: {\n            get () {\n                return !!(this._styleFlags & UNDERLINE_FLAG);\n            },\n            set (value) {\n                if (value) {\n                    this._styleFlags |= UNDERLINE_FLAG;\n                } else {\n                    this._styleFlags &= ~UNDERLINE_FLAG;\n                }\n\n                this.setVertsDirty();\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.underline'\n        },\n\n        _underlineHeight: 0,\n        /**\n         * !#en The height of underline.\n         * !#zh 下划线高度。\n         * @property {Number} underlineHeight\n         */\n        underlineHeight: {\n            get () {\n                return this._underlineHeight;\n            },\n            set (value) {\n                if (this._underlineHeight === value) return;\n                \n                this._underlineHeight = value;\n                this.setVertsDirty();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.label.underline_height',\n        },\n    },\n\n    statics: {\n        HorizontalAlign: HorizontalAlign,\n        VerticalAlign: VerticalAlign,\n        Overflow: Overflow,\n        CacheMode: CacheMode,\n\n        _shareAtlas: null,\n        /**\n         * !#zh 需要保证当前场景中没有使用CHAR缓存的Label才可以清除，否则已渲染的文字没有重新绘制会不显示\n         * !#en It can be cleared that need to ensure there is not use the CHAR cache in the current scene. Otherwise, the rendered text will not be displayed without repainting.\n         * @method clearCharCache\n         * @static\n         */\n        clearCharCache () {\n            if (Label._shareAtlas) {\n                Label._shareAtlas.clearAllCache();\n            }\n        }\n    },\n\n    onLoad () {\n        // For compatibility with v2.0.x temporary reservation.\n        if (this._batchAsBitmap && this.cacheMode === CacheMode.NONE) {\n            this.cacheMode = CacheMode.BITMAP;\n            this._batchAsBitmap = false;\n        }\n\n        if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {\n            // CacheMode is not supported in Canvas.\n            this.cacheMode = CacheMode.NONE;\n        }\n    },\n\n    onEnable () {\n        this._super();\n\n        // Keep track of Node size\n        this.node.on(cc.Node.EventType.SIZE_CHANGED, this._nodeSizeChanged, this);\n        this.node.on(cc.Node.EventType.ANCHOR_CHANGED, this.setVertsDirty, this);\n\n        this._forceUpdateRenderData();\n    },\n\n    onDisable () {\n        this._super();\n        this.node.off(cc.Node.EventType.SIZE_CHANGED, this._nodeSizeChanged, this);\n        this.node.off(cc.Node.EventType.ANCHOR_CHANGED, this.setVertsDirty, this);\n    },\n\n    onDestroy () {\n        this._assembler && this._assembler._resetAssemblerData && this._assembler._resetAssemblerData(this._assemblerData);\n        this._assemblerData = null;\n        this._letterTexture = null;\n        if (this._ttfTexture) {\n            this._ttfTexture.destroy();\n            this._ttfTexture = null;\n        }\n        this._super();\n    },\n\n    _nodeSizeChanged () {\n        // Because the content size is automatically updated when overflow is NONE.\n        // And this will conflict with the alignment of the CCWidget.\n        if (CC_EDITOR || this.overflow !== Overflow.NONE) {\n            this.setVertsDirty();\n        }\n    },\n\n    _updateColor () {\n        if (!(this.font instanceof cc.BitmapFont)) {\n            this.setVertsDirty();\n        }\n       RenderComponent.prototype._updateColor.call(this);\n    },\n\n    _validateRender () {\n        if (!this.string) {\n            this.disableRender();\n            return;\n        }\n\n        if (this._materials[0]) {\n            let font = this.font;\n            if (font instanceof cc.BitmapFont) {\n                let spriteFrame = font.spriteFrame;\n                if (spriteFrame && \n                    spriteFrame.textureLoaded() &&\n                    font._fntConfig) {\n                    return;\n                }\n            }\n            else {\n                return;\n            }\n        }\n\n        this.disableRender();\n    },\n\n    _resetAssembler () {\n        this._frame = null;\n        RenderComponent.prototype._resetAssembler.call(this);\n    },\n\n    _checkStringEmpty () {\n        this.markForRender(!!this.string);\n    },\n\n    _on3DNodeChanged () {\n        this._resetAssembler();\n        this._applyFontTexture();\n    },\n\n    _onBMFontTextureLoaded () {\n        this._frame._texture = this.font.spriteFrame._texture;\n        this.markForRender(true);\n        this._updateMaterial();\n        this._assembler && this._assembler.updateRenderData(this);\n    },\n\n    _applyFontTexture () {\n        let font = this.font;\n        if (font instanceof cc.BitmapFont) {\n            let spriteFrame = font.spriteFrame;\n            this._frame = spriteFrame;\n            if (spriteFrame) {\n                spriteFrame.onTextureLoaded(this._onBMFontTextureLoaded, this);\n            }\n        }\n        else {\n            if (!this._frame) {\n                this._frame = new LabelFrame();\n            }\n \n            if (this.cacheMode === CacheMode.CHAR) {\n                this._letterTexture = this._assembler._getAssemblerData();\n                this._frame._refreshTexture(this._letterTexture);\n            } else if (!this._ttfTexture) {\n                this._ttfTexture = new cc.Texture2D();\n                this._assemblerData = this._assembler._getAssemblerData();\n                this._ttfTexture.initWithElement(this._assemblerData.canvas);\n            } \n\n            if (this.cacheMode !== CacheMode.CHAR) {\n                this._frame._resetDynamicAtlasFrame();\n                this._frame._refreshTexture(this._ttfTexture);\n            }\n            \n            this._updateMaterial();\n            this._assembler && this._assembler.updateRenderData(this);\n        }\n        this.markForValidate();\n    },\n\n    _updateMaterialCanvas () {\n        if (!this._frame) return;\n        this._frame._texture.url = this.uuid + '_texture';\n    },\n\n    _updateMaterialWebgl () {\n        if (!this._frame) return;\n        let material = this.getMaterial(0);\n        material && material.setProperty('texture', this._frame._texture);\n    },\n\n    _forceUpdateRenderData () {\n        this.setVertsDirty();\n        this._resetAssembler();\n        this._applyFontTexture();\n    },\n\n    /**\n     * @deprecated `label._enableBold` is deprecated, use `label.enableBold = true` instead please.\n     */\n    _enableBold (enabled) {\n        if (CC_DEBUG) {\n            cc.warn('`label._enableBold` is deprecated, use `label.enableBold = true` instead please');\n        }\n        this.enableBold = !!enabled;\n    },\n\n    /**\n     * @deprecated `label._enableItalics` is deprecated, use `label.enableItalics = true` instead please.\n     */\n    _enableItalics (enabled) {\n        if (CC_DEBUG) {\n            cc.warn('`label._enableItalics` is deprecated, use `label.enableItalics = true` instead please');\n        }\n        this.enableItalic = !!enabled;\n    },\n\n    /**\n     * @deprecated `label._enableUnderline` is deprecated, use `label.enableUnderline = true` instead please.\n     */\n    _enableUnderline (enabled) {\n        if (CC_DEBUG) {\n            cc.warn('`label._enableUnderline` is deprecated, use `label.enableUnderline = true` instead please');\n        }\n        this.enableUnderline = !!enabled;\n    },\n });\n\n cc.Label = module.exports = Label;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst NodeEvent = require('../CCNode').EventType;\n\n/**\n * !#en Enum for Layout type\n * !#zh 布局类型\n * @enum Layout.Type\n */\nvar Type = cc.Enum({\n    /**\n     * !#en None Layout\n     * !#zh 取消布局\n     *@property {Number} NONE\n     */\n    NONE: 0,\n    /**\n     * !#en Horizontal Layout\n     * !#zh 水平布局\n     * @property {Number} HORIZONTAL\n     */\n    HORIZONTAL: 1,\n\n    /**\n     * !#en Vertical Layout\n     * !#zh 垂直布局\n     * @property {Number} VERTICAL\n     */\n    VERTICAL: 2,\n    /**\n     * !#en Grid Layout\n     * !#zh 网格布局\n     * @property {Number} GRID\n     */\n    GRID: 3,\n});\n\n/**\n * !#en Enum for Layout Resize Mode\n * !#zh 缩放模式\n * @enum Layout.ResizeMode\n */\nvar ResizeMode = cc.Enum({\n    /**\n     * !#en Don't do any scale.\n     * !#zh 不做任何缩放\n     * @property {Number} NONE\n     */\n    NONE: 0,\n    /**\n     * !#en The container size will be expanded with its children's size.\n     * !#zh 容器的大小会根据子节点的大小自动缩放。\n     * @property {Number} CONTAINER\n     */\n    CONTAINER: 1,\n    /**\n     * !#en Child item size will be adjusted with the container's size.\n     * !#zh 子节点的大小会随着容器的大小自动缩放。\n     * @property {Number} CHILDREN\n     */\n    CHILDREN: 2\n});\n\n/**\n * !#en Enum for Grid Layout start axis direction.\n * The items in grid layout will be arranged in each axis at first.;\n * !#zh 布局轴向，只用于 GRID 布局。\n * @enum Layout.AxisDirection\n */\nvar AxisDirection = cc.Enum({\n    /**\n     * !#en The horizontal axis.\n     * !#zh 进行水平方向布局\n     * @property {Number} HORIZONTAL\n     */\n    HORIZONTAL: 0,\n    /**\n     * !#en The vertical axis.\n     * !#zh 进行垂直方向布局\n     * @property {Number} VERTICAL\n     */\n    VERTICAL: 1,\n});\n\n/**\n * !#en Enum for vertical layout direction.\n *  Used in Grid Layout together with AxisDirection is VERTICAL\n * !#zh 垂直方向布局方式\n * @enum Layout.VerticalDirection\n */\nvar VerticalDirection = cc.Enum({\n    /**\n     * !#en Items arranged from bottom to top.\n     * !#zh 从下到上排列\n     * @property {Number} BOTTOM_TO_TOP\n     */\n    BOTTOM_TO_TOP: 0,\n    /**\n     * !#en Items arranged from top to bottom.\n     * !#zh 从上到下排列\n     * @property {Number} TOP_TO_BOTTOM\n     */\n    TOP_TO_BOTTOM: 1,\n});\n\n/**\n * !#en Enum for horizontal layout direction.\n *  Used in Grid Layout together with AxisDirection is HORIZONTAL\n * !#zh 水平方向布局方式\n * @enum Layout.HorizontalDirection\n */\nvar HorizontalDirection = cc.Enum({\n    /**\n     * !#en Items arranged from left to right.\n     * !#zh 从左往右排列\n     * @property {Number} LEFT_TO_RIGHT\n     */\n    LEFT_TO_RIGHT: 0,\n    /**\n     * !#en Items arranged from right to left.\n     * !#zh 从右往左排列\n     *@property {Number} RIGHT_TO_LEFT\n     */\n    RIGHT_TO_LEFT: 1,\n});\n\n/**\n * !#en\n * The Layout is a container component, use it to arrange child elements easily.<br>\n * Note：<br>\n * 1.Scaling and rotation of child nodes are not considered.<br>\n * 2.After setting the Layout, the results need to be updated until the next frame,\n * unless you manually call {{#crossLink \"Layout/updateLayout:method\"}}{{/crossLink}}。\n * !#zh\n * Layout 组件相当于一个容器，能自动对它的所有子节点进行统一排版。<br>\n * 注意：<br>\n * 1.不会考虑子节点的缩放和旋转。<br>\n * 2.对 Layout 设置后结果需要到下一帧才会更新，除非你设置完以后手动调用 {{#crossLink \"Layout/updateLayout:method\"}}{{/crossLink}}。\n * @class Layout\n * @extends Component\n */\nvar Layout = cc.Class({\n    name: 'cc.Layout',\n    extends: require('./CCComponent'),\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.ui/Layout',\n        help: 'i18n:COMPONENT.help_url.layout',\n        inspector: 'packages://inspector/inspectors/comps/cclayout.js',\n        executeInEditMode: true,\n    },\n\n    properties: {\n        _layoutSize: cc.size(300, 200),\n        _layoutDirty: {\n            default: true,\n            serializable: false,\n        },\n\n        _resize: ResizeMode.NONE,\n\n        //TODO: refactoring this name after data upgrade machanism is out.\n        _N$layoutType: Type.NONE,\n        /**\n         * !#en The layout type.\n         * !#zh 布局类型\n         * @property {Layout.Type} type\n         * @default Layout.Type.NONE\n         */\n        type: {\n            type: Type,\n            get: function () {\n                return this._N$layoutType;\n            },\n            set: function (value) {\n                this._N$layoutType = value;\n\n                if (CC_EDITOR && this.type !== Type.NONE && this._resize === ResizeMode.CONTAINER && !cc.engine.isPlaying) {\n                    var reLayouted = _Scene.DetectConflict.checkConflict_Layout(this);\n                    if (reLayouted) {\n                        return;\n                    }\n                }\n                this._doLayoutDirty();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.layout_type',\n            animatable: false,\n        },\n\n\n        /**\n         * !#en\n         * The are three resize modes for Layout.\n         * None, resize Container and resize children.\n         * !#zh 缩放模式\n         * @property {Layout.ResizeMode} resizeMode\n         * @default ResizeMode.NONE\n         */\n        resizeMode: {\n            type: ResizeMode,\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.resize_mode',\n            animatable: false,\n            get: function () {\n                return this._resize;\n            },\n            set: function (value) {\n                if (this.type === Type.NONE && value === ResizeMode.CHILDREN) {\n                    return;\n                }\n\n                this._resize = value;\n                if (CC_EDITOR && value === ResizeMode.CONTAINER && !cc.engine.isPlaying) {\n                    var reLayouted = _Scene.DetectConflict.checkConflict_Layout(this);\n                    if (reLayouted) {\n                        return;\n                    }\n                }\n                this._doLayoutDirty();\n            },\n        },\n\n        /**\n         * !#en The cell size for grid layout.\n         * !#zh 每个格子的大小，只有布局类型为 GRID 的时候才有效。\n         * @property {Size} cellSize\n         * @default cc.size(40, 40)\n         */\n        cellSize: {\n            default: cc.size(40, 40),\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.cell_size',\n            type: cc.Size,\n            notify: function () {\n                this._doLayoutDirty();\n            },\n        },\n\n        /**\n         * !#en\n         * The start axis for grid layout. If you choose horizontal, then children will layout horizontally at first,\n         * and then break line on demand. Choose vertical if you want to layout vertically at first .\n         * !#zh 起始轴方向类型，可进行水平和垂直布局排列，只有布局类型为 GRID 的时候才有效。\n         * @property {Layout.AxisDirection} startAxis\n         */\n        startAxis: {\n            default: AxisDirection.HORIZONTAL,\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.start_axis',\n            type: AxisDirection,\n            notify: function () {\n                if (CC_EDITOR && this._resize === ResizeMode.CONTAINER && !cc.engine.isPlaying) {\n                    var reLayouted = _Scene.DetectConflict.checkConflict_Layout(this);\n                    if (reLayouted) {\n                        return;\n                    }\n                }\n                this._doLayoutDirty();\n            },\n            animatable: false\n        },\n\n        _N$padding: {\n            default: 0\n        },\n        /**\n         * !#en The left padding of layout, it only effect the layout in one direction.\n         * !#zh 容器内左边距，只会在一个布局方向上生效。\n         * @property {Number} paddingLeft\n         */\n        paddingLeft: {\n            default: 0,\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.padding_left',\n            notify: function () {\n                this._doLayoutDirty();\n            },\n        },\n\n        /**\n         * !#en The right padding of layout, it only effect the layout in one direction.\n         * !#zh 容器内右边距，只会在一个布局方向上生效。\n         * @property {Number} paddingRight\n         */\n        paddingRight: {\n            default: 0,\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.padding_right',\n            notify: function () {\n                this._doLayoutDirty();\n            },\n        },\n\n        /**\n         * !#en The top padding of layout, it only effect the layout in one direction.\n         * !#zh 容器内上边距，只会在一个布局方向上生效。\n         * @property {Number} paddingTop\n         */\n        paddingTop: {\n            default: 0,\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.padding_top',\n            notify: function () {\n                this._doLayoutDirty();\n            },\n        },\n\n        /**\n         * !#en The bottom padding of layout, it only effect the layout in one direction.\n         * !#zh 容器内下边距，只会在一个布局方向上生效。\n         * @property {Number} paddingBottom\n         */\n        paddingBottom: {\n            default: 0,\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.padding_bottom',\n            notify: function () {\n                this._doLayoutDirty();\n            },\n        },\n\n        /**\n         * !#en The distance in x-axis between each element in layout.\n         * !#zh 子节点之间的水平间距。\n         * @property {Number} spacingX\n         */\n        spacingX: {\n            default: 0,\n            notify: function () {\n                this._doLayoutDirty();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.space_x'\n        },\n\n        /**\n         * !#en The distance in y-axis between each element in layout.\n         * !#zh 子节点之间的垂直间距。\n         * @property {Number} spacingY\n         */\n        spacingY: {\n            default: 0,\n            notify: function () {\n                this._doLayoutDirty();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.space_y'\n        },\n\n        /**\n         * !#en\n         * Only take effect in Vertical layout mode.\n         * This option changes the start element's positioning.\n         * !#zh 垂直排列子节点的方向。\n         * @property {Layout.VerticalDirection} verticalDirection\n         */\n        verticalDirection: {\n            default: VerticalDirection.TOP_TO_BOTTOM,\n            type: VerticalDirection,\n            notify: function () {\n                this._doLayoutDirty();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.vertical_direction',\n            animatable: false\n        },\n\n        /**\n         * !#en\n         * Only take effect in Horizontal layout mode.\n         * This option changes the start element's positioning.\n         * !#zh 水平排列子节点的方向。\n         * @property {Layout.HorizontalDirection} horizontalDirection\n         */\n        horizontalDirection: {\n            default: HorizontalDirection.LEFT_TO_RIGHT,\n            type: HorizontalDirection,\n            notify: function () {\n                this._doLayoutDirty();\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.horizontal_direction',\n            animatable: false\n        },\n\n        /**\n         * !#en Adjust the layout if the children scaled.\n         * !#zh 子节点缩放比例是否影响布局。\n         * @property affectedByScale\n         * @type {Boolean}\n         * @default false\n         */\n        affectedByScale: {\n            default: false,\n            notify: function () {\n                // every time you switch this state, the layout will be calculated.\n                this._doLayoutDirty();\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.layout.affected_by_scale'\n        }\n    },\n\n    statics: {\n        Type: Type,\n        VerticalDirection: VerticalDirection,\n        HorizontalDirection: HorizontalDirection,\n        ResizeMode: ResizeMode,\n        AxisDirection: AxisDirection,\n    },\n\n    _migratePaddingData: function () {\n        this.paddingLeft = this._N$padding;\n        this.paddingRight = this._N$padding;\n        this.paddingTop = this._N$padding;\n        this.paddingBottom = this._N$padding;\n        this._N$padding = 0;\n    },\n\n    onEnable: function () {\n        this._addEventListeners();\n\n        if (this.node.getContentSize().equals(cc.size(0, 0))) {\n            this.node.setContentSize(this._layoutSize);\n        }\n\n        if (this._N$padding !== 0) {\n            this._migratePaddingData();\n        }\n\n        this._doLayoutDirty();\n    },\n\n    onDisable: function () {\n        this._removeEventListeners();\n    },\n\n    _doLayoutDirty: function () {\n        this._layoutDirty = true;\n    },\n\n    _doScaleDirty: function () {\n        this._layoutDirty = this._layoutDirty || this.affectedByScale;\n    },\n\n    _addEventListeners: function () {\n        cc.director.on(cc.Director.EVENT_AFTER_UPDATE, this.updateLayout, this);\n        this.node.on(NodeEvent.SIZE_CHANGED, this._resized, this);\n        this.node.on(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\n        this.node.on(NodeEvent.CHILD_ADDED, this._childAdded, this);\n        this.node.on(NodeEvent.CHILD_REMOVED, this._childRemoved, this);\n        this.node.on(NodeEvent.CHILD_REORDER, this._doLayoutDirty, this);\n        this._addChildrenEventListeners();\n    },\n\n    _removeEventListeners: function () {\n        cc.director.off(cc.Director.EVENT_AFTER_UPDATE, this.updateLayout, this);\n        this.node.off(NodeEvent.SIZE_CHANGED, this._resized, this);\n        this.node.off(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\n        this.node.off(NodeEvent.CHILD_ADDED, this._childAdded, this);\n        this.node.off(NodeEvent.CHILD_REMOVED, this._childRemoved, this);\n        this.node.off(NodeEvent.CHILD_REORDER, this._doLayoutDirty, this);\n        this._removeChildrenEventListeners();\n    },\n\n    _addChildrenEventListeners: function () {\n        var children = this.node.children;\n        for (var i = 0; i < children.length; ++i) {\n            var child = children[i];\n            child.on(NodeEvent.SCALE_CHANGED, this._doScaleDirty, this);\n            child.on(NodeEvent.SIZE_CHANGED, this._doLayoutDirty, this);\n            child.on(NodeEvent.POSITION_CHANGED, this._doLayoutDirty, this);\n            child.on(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\n            child.on('active-in-hierarchy-changed', this._doLayoutDirty, this);\n        }\n    },\n\n    _removeChildrenEventListeners: function () {\n        var children = this.node.children;\n        for (var i = 0; i < children.length; ++i) {\n            var child = children[i];\n            child.off(NodeEvent.SCALE_CHANGED, this._doScaleDirty, this);\n            child.off(NodeEvent.SIZE_CHANGED, this._doLayoutDirty, this);\n            child.off(NodeEvent.POSITION_CHANGED, this._doLayoutDirty, this);\n            child.off(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\n            child.off('active-in-hierarchy-changed', this._doLayoutDirty, this);\n        }\n    },\n\n    _childAdded: function (child) {\n        child.on(NodeEvent.SCALE_CHANGED, this._doScaleDirty, this);\n        child.on(NodeEvent.SIZE_CHANGED, this._doLayoutDirty, this);\n        child.on(NodeEvent.POSITION_CHANGED, this._doLayoutDirty, this);\n        child.on(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\n        child.on('active-in-hierarchy-changed', this._doLayoutDirty, this);\n\n        this._doLayoutDirty();\n    },\n\n    _childRemoved: function (child) {\n        child.off(NodeEvent.SCALE_CHANGED, this._doScaleDirty, this);\n        child.off(NodeEvent.SIZE_CHANGED, this._doLayoutDirty, this);\n        child.off(NodeEvent.POSITION_CHANGED, this._doLayoutDirty, this);\n        child.off(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\n        child.off('active-in-hierarchy-changed', this._doLayoutDirty, this);\n\n        this._doLayoutDirty();\n    },\n\n    _resized: function () {\n        this._layoutSize = this.node.getContentSize();\n        this._doLayoutDirty();\n    },\n\n    _doLayoutHorizontally: function (baseWidth, rowBreak, fnPositionY, applyChildren) {\n        var layoutAnchor = this.node.getAnchorPoint();\n        var children = this.node.children;\n\n        var sign = 1;\n        var paddingX = this.paddingLeft;\n        var leftBoundaryOfLayout = -layoutAnchor.x * baseWidth;\n        if (this.horizontalDirection === HorizontalDirection.RIGHT_TO_LEFT) {\n            sign = -1;\n            leftBoundaryOfLayout = (1 - layoutAnchor.x) * baseWidth;\n            paddingX = this.paddingRight;\n        }\n\n        var nextX = leftBoundaryOfLayout + sign * paddingX - sign * this.spacingX;\n        var rowMaxHeight = 0;\n        var tempMaxHeight = 0;\n        var secondMaxHeight = 0;\n        var row = 0;\n        var containerResizeBoundary = 0;\n\n        var maxHeightChildAnchorY = 0;\n\n        var activeChildCount = 0;\n        for (var i = 0; i < children.length; ++i) {\n            var child = children[i];\n            if (child.activeInHierarchy) {\n                activeChildCount++;\n            }\n        }\n\n        var newChildWidth = this.cellSize.width;\n        if (this.type !== Type.GRID && this.resizeMode === ResizeMode.CHILDREN) {\n            newChildWidth = (baseWidth - (this.paddingLeft + this.paddingRight) - (activeChildCount - 1) * this.spacingX) / activeChildCount;\n        }\n\n        for (var i = 0; i < children.length; ++i) {\n            var child = children[i];\n            let childScaleX = this._getUsedScaleValue(child.scaleX);\n            let childScaleY = this._getUsedScaleValue(child.scaleY);\n            if (!child.activeInHierarchy) {\n                continue;\n            }\n            //for resizing children\n            if (this._resize === ResizeMode.CHILDREN) {\n                child.width = newChildWidth / childScaleX;\n                if (this.type === Type.GRID) {\n                    child.height = this.cellSize.height / childScaleY;\n                }\n            }\n\n            var anchorX = child.anchorX;\n            var childBoundingBoxWidth = child.width * childScaleX;\n            var childBoundingBoxHeight = child.height * childScaleY;\n\n            if (secondMaxHeight > tempMaxHeight) {\n                tempMaxHeight = secondMaxHeight;\n            }\n\n            if (childBoundingBoxHeight >= tempMaxHeight) {\n                secondMaxHeight = tempMaxHeight;\n                tempMaxHeight = childBoundingBoxHeight;\n                maxHeightChildAnchorY = child.getAnchorPoint().y;\n            }\n\n            if (this.horizontalDirection === HorizontalDirection.RIGHT_TO_LEFT) {\n                anchorX = 1 - child.anchorX;\n            }\n            nextX = nextX + sign * anchorX * childBoundingBoxWidth + sign * this.spacingX;\n            var rightBoundaryOfChild = sign * (1 - anchorX) * childBoundingBoxWidth;\n\n            if (rowBreak) {\n                var rowBreakBoundary = nextX + rightBoundaryOfChild + sign * (sign > 0 ? this.paddingRight : this.paddingLeft);\n                var leftToRightRowBreak = this.horizontalDirection === HorizontalDirection.LEFT_TO_RIGHT && rowBreakBoundary > (1 - layoutAnchor.x) * baseWidth;\n                var rightToLeftRowBreak = this.horizontalDirection === HorizontalDirection.RIGHT_TO_LEFT && rowBreakBoundary < -layoutAnchor.x * baseWidth;\n\n                if (leftToRightRowBreak || rightToLeftRowBreak) {\n\n                    if (childBoundingBoxHeight >= tempMaxHeight) {\n                        if (secondMaxHeight === 0) {\n                            secondMaxHeight = tempMaxHeight;\n                        }\n                        rowMaxHeight += secondMaxHeight;\n                        secondMaxHeight = tempMaxHeight;\n                    }\n                    else {\n                        rowMaxHeight += tempMaxHeight;\n                        secondMaxHeight = childBoundingBoxHeight;\n                        tempMaxHeight = 0;\n                    }\n                    nextX = leftBoundaryOfLayout + sign * (paddingX + anchorX * childBoundingBoxWidth);\n                    row++;\n                }\n            }\n\n            var finalPositionY = fnPositionY(child, rowMaxHeight, row);\n            if (baseWidth >= (childBoundingBoxWidth + this.paddingLeft + this.paddingRight)) {\n                if (applyChildren) {\n                    child.setPosition(cc.v2(nextX, finalPositionY));\n                }\n            }\n\n            var signX = 1;\n            var tempFinalPositionY;\n            var topMarign = (tempMaxHeight === 0) ? childBoundingBoxHeight : tempMaxHeight;\n\n            if (this.verticalDirection === VerticalDirection.TOP_TO_BOTTOM) {\n                containerResizeBoundary = containerResizeBoundary || this.node._contentSize.height;\n                signX = -1;\n                tempFinalPositionY = finalPositionY + signX * (topMarign * maxHeightChildAnchorY + this.paddingBottom);\n                if (tempFinalPositionY < containerResizeBoundary) {\n                    containerResizeBoundary = tempFinalPositionY;\n                }\n            }\n            else {\n                containerResizeBoundary = containerResizeBoundary || -this.node._contentSize.height;\n                tempFinalPositionY = finalPositionY + signX * (topMarign * maxHeightChildAnchorY + this.paddingTop);\n                if (tempFinalPositionY > containerResizeBoundary) {\n                    containerResizeBoundary = tempFinalPositionY;\n                }\n            }\n\n            nextX += rightBoundaryOfChild;\n        }\n\n        return containerResizeBoundary;\n    },\n\n    _getVerticalBaseHeight: function (children) {\n        var newHeight = 0;\n        var activeChildCount = 0;\n        if (this.resizeMode === ResizeMode.CONTAINER) {\n            for (var i = 0; i < children.length; ++i) {\n                var child = children[i];\n                if (child.activeInHierarchy) {\n                    activeChildCount++;\n                    newHeight += child.height * this._getUsedScaleValue(child.scaleY);\n                }\n            }\n\n            newHeight += (activeChildCount - 1) * this.spacingY + this.paddingBottom + this.paddingTop;\n        }\n        else {\n            newHeight = this.node.getContentSize().height;\n        }\n        return newHeight;\n    },\n\n    _doLayoutVertically: function (baseHeight, columnBreak, fnPositionX, applyChildren) {\n        var layoutAnchor = this.node.getAnchorPoint();\n        var children = this.node.children;\n\n        var sign = 1;\n        var paddingY = this.paddingBottom;\n        var bottomBoundaryOfLayout = -layoutAnchor.y * baseHeight;\n        if (this.verticalDirection === VerticalDirection.TOP_TO_BOTTOM) {\n            sign = -1;\n            bottomBoundaryOfLayout = (1 - layoutAnchor.y) * baseHeight;\n            paddingY = this.paddingTop;\n        }\n\n        var nextY = bottomBoundaryOfLayout + sign * paddingY - sign * this.spacingY;\n        var columnMaxWidth = 0;\n        var tempMaxWidth = 0;\n        var secondMaxWidth = 0;\n        var column = 0;\n        var containerResizeBoundary = 0;\n        var maxWidthChildAnchorX = 0;\n\n        var activeChildCount = 0;\n        for (var i = 0; i < children.length; ++i) {\n            var child = children[i];\n            if (child.activeInHierarchy) {\n                activeChildCount++;\n            }\n        }\n\n        var newChildHeight = this.cellSize.height;\n        if (this.type !== Type.GRID && this.resizeMode === ResizeMode.CHILDREN) {\n            newChildHeight = (baseHeight - (this.paddingTop + this.paddingBottom) - (activeChildCount - 1) * this.spacingY) / activeChildCount;\n        }\n\n        for (var i = 0; i < children.length; ++i) {\n            var child = children[i];\n            let childScaleX = this._getUsedScaleValue(child.scaleX);\n            let childScaleY = this._getUsedScaleValue(child.scaleY);\n            if (!child.activeInHierarchy) {\n                continue;\n            }\n\n            //for resizing children\n            if (this.resizeMode === ResizeMode.CHILDREN) {\n                child.height = newChildHeight / childScaleY;\n                if (this.type === Type.GRID) {\n                    child.width = this.cellSize.width / childScaleX;\n                }\n            }\n\n            var anchorY = child.anchorY;\n            var childBoundingBoxWidth = child.width * childScaleX;\n            var childBoundingBoxHeight = child.height * childScaleY;\n\n            if (secondMaxWidth > tempMaxWidth) {\n                tempMaxWidth = secondMaxWidth;\n            }\n\n            if (childBoundingBoxWidth >= tempMaxWidth) {\n                secondMaxWidth = tempMaxWidth;\n                tempMaxWidth = childBoundingBoxWidth;\n                maxWidthChildAnchorX = child.getAnchorPoint().x;\n            }\n\n            if (this.verticalDirection === VerticalDirection.TOP_TO_BOTTOM) {\n                anchorY = 1 - child.anchorY;\n            }\n            nextY = nextY + sign * anchorY * childBoundingBoxHeight + sign * this.spacingY;\n            var topBoundaryOfChild = sign * (1 - anchorY) * childBoundingBoxHeight;\n\n            if (columnBreak) {\n                var columnBreakBoundary = nextY + topBoundaryOfChild + sign * (sign > 0 ? this.paddingTop : this.paddingBottom);\n                var bottomToTopColumnBreak = this.verticalDirection === VerticalDirection.BOTTOM_TO_TOP && columnBreakBoundary > (1 - layoutAnchor.y) * baseHeight;\n                var topToBottomColumnBreak = this.verticalDirection === VerticalDirection.TOP_TO_BOTTOM && columnBreakBoundary < -layoutAnchor.y * baseHeight;\n\n                if (bottomToTopColumnBreak || topToBottomColumnBreak) {\n                    if (childBoundingBoxWidth >= tempMaxWidth) {\n                        if (secondMaxWidth === 0) {\n                            secondMaxWidth = tempMaxWidth;\n                        }\n                        columnMaxWidth += secondMaxWidth;\n                        secondMaxWidth = tempMaxWidth;\n                    }\n                    else {\n                        columnMaxWidth += tempMaxWidth;\n                        secondMaxWidth = childBoundingBoxWidth;\n                        tempMaxWidth = 0;\n                    }\n                    nextY = bottomBoundaryOfLayout + sign * (paddingY + anchorY * childBoundingBoxHeight);\n                    column++;\n                }\n            }\n\n            var finalPositionX = fnPositionX(child, columnMaxWidth, column);\n            if (baseHeight >= (childBoundingBoxHeight + (this.paddingTop + this.paddingBottom))) {\n                if (applyChildren) {\n                    child.setPosition(cc.v2(finalPositionX, nextY));\n                }\n            }\n\n            var signX = 1;\n            var tempFinalPositionX;\n            //when the item is the last column break item, the tempMaxWidth will be 0.\n            var rightMarign = (tempMaxWidth === 0) ? childBoundingBoxWidth : tempMaxWidth;\n\n            if (this.horizontalDirection === HorizontalDirection.RIGHT_TO_LEFT) {\n                signX = -1;\n                containerResizeBoundary = containerResizeBoundary || this.node._contentSize.width;\n                tempFinalPositionX = finalPositionX + signX * (rightMarign * maxWidthChildAnchorX + this.paddingLeft);\n                if (tempFinalPositionX < containerResizeBoundary) {\n                    containerResizeBoundary = tempFinalPositionX;\n                }\n            }\n            else {\n                containerResizeBoundary = containerResizeBoundary || -this.node._contentSize.width;\n                tempFinalPositionX = finalPositionX + signX * (rightMarign * maxWidthChildAnchorX + this.paddingRight);\n                if (tempFinalPositionX > containerResizeBoundary) {\n                    containerResizeBoundary = tempFinalPositionX;\n                }\n\n            }\n\n            nextY += topBoundaryOfChild;\n        }\n\n        return containerResizeBoundary;\n    },\n\n    _doLayoutBasic: function () {\n        var children = this.node.children;\n\n        var allChildrenBoundingBox = null;\n\n        for (var i = 0; i < children.length; ++i) {\n            var child = children[i];\n            if (child.activeInHierarchy) {\n                if (!allChildrenBoundingBox) {\n                    allChildrenBoundingBox = child.getBoundingBoxToWorld();\n                } else {\n                    allChildrenBoundingBox.union(allChildrenBoundingBox, child.getBoundingBoxToWorld());\n                }\n            }\n        }\n\n        if (allChildrenBoundingBox) {\n            var leftBottomSpace = this.node.convertToNodeSpaceAR(cc.v2(allChildrenBoundingBox.x, allChildrenBoundingBox.y));\n            leftBottomSpace = cc.v2(leftBottomSpace.x - this.paddingLeft, leftBottomSpace.y - this.paddingBottom);\n\n            var rightTopSpace = this.node.convertToNodeSpaceAR(cc.v2(allChildrenBoundingBox.xMax, allChildrenBoundingBox.yMax));\n            rightTopSpace = cc.v2(rightTopSpace.x + this.paddingRight, rightTopSpace.y + this.paddingTop);\n\n            var newSize = rightTopSpace.sub(leftBottomSpace);\n            newSize = cc.size(parseFloat(newSize.x.toFixed(2)), parseFloat(newSize.y.toFixed(2)));\n\n            if (newSize.width !== 0) {\n                // Invert is to get the coordinate point of the child node in the parent coordinate system\n                var newAnchorX = (-leftBottomSpace.x) / newSize.width;\n                this.node.anchorX = parseFloat(newAnchorX.toFixed(2));\n            }\n            if (newSize.height !== 0) {\n                // Invert is to get the coordinate point of the child node in the parent coordinate system\n                var newAnchorY = (-leftBottomSpace.y) / newSize.height;\n                this.node.anchorY = parseFloat(newAnchorY.toFixed(2));\n            }\n            this.node.setContentSize(newSize);\n        }\n    },\n\n    _doLayoutGridAxisHorizontal: function (layoutAnchor, layoutSize) {\n        var baseWidth = layoutSize.width;\n\n        var sign = 1;\n        var bottomBoundaryOfLayout = -layoutAnchor.y * layoutSize.height;\n        var paddingY = this.paddingBottom;\n        if (this.verticalDirection === VerticalDirection.TOP_TO_BOTTOM) {\n            sign = -1;\n            bottomBoundaryOfLayout = (1 - layoutAnchor.y) * layoutSize.height;\n            paddingY = this.paddingTop;\n        }\n\n        var fnPositionY = function (child, topOffset, row) {\n            return bottomBoundaryOfLayout + sign * (topOffset + child.anchorY * child.height * this._getUsedScaleValue(child.scaleY) + paddingY + row * this.spacingY);\n        }.bind(this);\n\n\n        var newHeight = 0;\n        if (this.resizeMode === ResizeMode.CONTAINER) {\n            //calculate the new height of container, it won't change the position of it's children\n            var boundary = this._doLayoutHorizontally(baseWidth, true, fnPositionY, false);\n            newHeight = bottomBoundaryOfLayout - boundary;\n            if (newHeight < 0) {\n                newHeight *= -1;\n            }\n\n            bottomBoundaryOfLayout = -layoutAnchor.y * newHeight;\n\n            if (this.verticalDirection === VerticalDirection.TOP_TO_BOTTOM) {\n                sign = -1;\n                bottomBoundaryOfLayout = (1 - layoutAnchor.y) * newHeight;\n            }\n        }\n\n        this._doLayoutHorizontally(baseWidth, true, fnPositionY, true);\n\n        if (this.resizeMode === ResizeMode.CONTAINER) {\n            this.node.setContentSize(baseWidth, newHeight);\n        }\n    },\n\n    _doLayoutGridAxisVertical: function (layoutAnchor, layoutSize) {\n        var baseHeight = layoutSize.height;\n\n        var sign = 1;\n        var leftBoundaryOfLayout = -layoutAnchor.x * layoutSize.width;\n        var paddingX = this.paddingLeft;\n        if (this.horizontalDirection === HorizontalDirection.RIGHT_TO_LEFT) {\n            sign = -1;\n            leftBoundaryOfLayout = (1 - layoutAnchor.x) * layoutSize.width;\n            paddingX = this.paddingRight;\n        }\n\n        var fnPositionX = function (child, leftOffset, column) {\n            return leftBoundaryOfLayout + sign * (leftOffset + child.anchorX * child.width * this._getUsedScaleValue(child.scaleX) + paddingX + column * this.spacingX);\n        }.bind(this);\n\n        var newWidth = 0;\n        if (this.resizeMode === ResizeMode.CONTAINER) {\n            var boundary = this._doLayoutVertically(baseHeight, true, fnPositionX, false);\n            newWidth = leftBoundaryOfLayout - boundary;\n            if (newWidth < 0) {\n                newWidth *= -1;\n            }\n\n            leftBoundaryOfLayout = -layoutAnchor.x * newWidth;\n\n            if (this.horizontalDirection === HorizontalDirection.RIGHT_TO_LEFT) {\n                sign = -1;\n                leftBoundaryOfLayout = (1 - layoutAnchor.x) * newWidth;\n            }\n        }\n\n        this._doLayoutVertically(baseHeight, true, fnPositionX, true);\n\n        if (this.resizeMode === ResizeMode.CONTAINER) {\n            this.node.setContentSize(newWidth, baseHeight);\n        }\n    },\n\n    _doLayoutGrid: function () {\n        var layoutAnchor = this.node.getAnchorPoint();\n        var layoutSize = this.node.getContentSize();\n\n        if (this.startAxis === AxisDirection.HORIZONTAL) {\n            this._doLayoutGridAxisHorizontal(layoutAnchor, layoutSize);\n\n        }\n        else if (this.startAxis === AxisDirection.VERTICAL) {\n            this._doLayoutGridAxisVertical(layoutAnchor, layoutSize);\n        }\n\n    },\n\n    _getHorizontalBaseWidth: function (children) {\n        var newWidth = 0;\n        var activeChildCount = 0;\n        if (this.resizeMode === ResizeMode.CONTAINER) {\n            for (var i = 0; i < children.length; ++i) {\n                var child = children[i];\n                if (child.activeInHierarchy) {\n                    activeChildCount++;\n                    newWidth += child.width * this._getUsedScaleValue(child.scaleX);\n                }\n            }\n            newWidth += (activeChildCount - 1) * this.spacingX + this.paddingLeft + this.paddingRight;\n        }\n        else {\n            newWidth = this.node.getContentSize().width;\n        }\n        return newWidth;\n    },\n\n    _doLayout: function () {\n\n        if (this.type === Type.HORIZONTAL) {\n            var newWidth = this._getHorizontalBaseWidth(this.node.children);\n\n            var fnPositionY = function (child) {\n                return child.y;\n            };\n\n            this._doLayoutHorizontally(newWidth, false, fnPositionY, true);\n\n            this.node.width = newWidth;\n        }\n        else if (this.type === Type.VERTICAL) {\n            var newHeight = this._getVerticalBaseHeight(this.node.children);\n\n            var fnPositionX = function (child) {\n                return child.x;\n            };\n\n            this._doLayoutVertically(newHeight, false, fnPositionX, true);\n\n            this.node.height = newHeight;\n        }\n        else if (this.type === Type.NONE) {\n            if (this.resizeMode === ResizeMode.CONTAINER) {\n                this._doLayoutBasic();\n            }\n        }\n        else if (this.type === Type.GRID) {\n            this._doLayoutGrid();\n        }\n    },\n\n    _getUsedScaleValue (value) {\n        return this.affectedByScale ? Math.abs(value) : 1;\n    },\n\n    /**\n     * !#en Perform the layout update\n     * !#zh 立即执行更新布局\n     *\n     * @method updateLayout\n     *\n     * @example\n     * layout.type = cc.Layout.HORIZONTAL;\n     * layout.node.addChild(childNode);\n     * cc.log(childNode.x); // not yet changed\n     * layout.updateLayout();\n     * cc.log(childNode.x); // changed\n     */\n    updateLayout: function () {\n        if (this._layoutDirty && this.node.children.length > 0) {\n            this._doLayout();\n            this._layoutDirty = false;\n        }\n    }\n});\n\n/**\n * !#en The padding of layout, it effects the layout in four direction.\n * !#zh 容器内边距，该属性会在四个布局方向上生效。\n * @property {Number} padding\n */\nObject.defineProperty(Layout.prototype, \"padding\", {\n    get: function () {\n        cc.warnID(4100);\n        return this.paddingLeft;\n    },\n    set: function (value) {\n        this._N$padding = value;\n\n        this._migratePaddingData();\n        this._doLayoutDirty();\n    }\n});\n\ncc.Layout = module.exports = Layout;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport gfx from '../../renderer/gfx';\n\nconst misc = require('../utils/misc');\nconst RenderComponent = require('./CCRenderComponent');\nconst RenderFlow = require('../renderer/render-flow');\nconst Graphics = require('../graphics/graphics');\n\nimport Mat4 from '../value-types/mat4';\nimport Vec2 from '../value-types/vec2';\nimport MaterialVariant from '../assets/material/material-variant';\n\nlet _vec2_temp = new Vec2();\nlet _mat4_temp = new Mat4();\n\nlet _circlepoints =[];\nfunction _calculateCircle (center, radius, segements) {\n    _circlepoints.length = 0;\n    let anglePerStep = Math.PI * 2 / segements;\n    for (let step = 0; step < segements; ++step) {\n        _circlepoints.push(cc.v2(radius.x * Math.cos(anglePerStep * step) + center.x,\n            radius.y * Math.sin(anglePerStep * step) + center.y));\n    }\n\n    return _circlepoints;\n}\n\n/**\n * !#en the type for mask.\n * !#zh 遮罩组件类型\n * @enum Mask.Type\n */\nlet MaskType = cc.Enum({\n    /**\n     * !#en Rect mask.\n     * !#zh 使用矩形作为遮罩\n     * @property {Number} RECT\n     */\n    RECT: 0,\n    /**\n     * !#en Ellipse Mask.\n     * !#zh 使用椭圆作为遮罩\n     * @property {Number} ELLIPSE\n     */\n    ELLIPSE: 1,\n    /**\n     * !#en Image Stencil Mask.\n     * !#zh 使用图像模版作为遮罩\n     * @property {Number} IMAGE_STENCIL\n     */\n    IMAGE_STENCIL: 2,\n});\n\nconst SEGEMENTS_MIN = 3;\nconst SEGEMENTS_MAX = 10000;\n\n/**\n * !#en The Mask Component\n * !#zh 遮罩组件\n * @class Mask\n * @extends RenderComponent\n */\nlet Mask = cc.Class({\n    name: 'cc.Mask',\n    extends: RenderComponent,\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.renderers/Mask',\n        help: 'i18n:COMPONENT.help_url.mask',\n        inspector: 'packages://inspector/inspectors/comps/mask.js'\n    },\n\n    ctor () {\n        this._graphics = null;\n\n        this._enableMaterial = null;\n        this._exitMaterial = null;\n        this._clearMaterial = null;\n    },\n\n    properties: {\n        _spriteFrame: {\n            default: null,\n            type: cc.SpriteFrame\n        },\n\n        /**\n         * !#en The mask type.\n         * !#zh 遮罩类型\n         * @property type\n         * @type {Mask.Type}\n         * @example\n         * mask.type = cc.Mask.Type.RECT;\n         */\n        _type: MaskType.RECT,\n        type: {\n            get: function () {\n                return this._type;\n            },\n            set: function (value) {\n                if (this._type !== value) {\n                    this._resetAssembler();\n                }\n\n                this._type = value;\n                if (this._type !== MaskType.IMAGE_STENCIL) {\n                    this.spriteFrame = null;\n                    this.alphaThreshold = 0;\n                    this._updateGraphics();\n                }\n                \n                this._activateMaterial();\n            },\n            type: MaskType,\n            tooltip: CC_DEV && 'i18n:COMPONENT.mask.type',\n        },\n\n        /**\n         * !#en The mask image\n         * !#zh 遮罩所需要的贴图\n         * @property spriteFrame\n         * @type {SpriteFrame}\n         * @default null\n         * @example\n         * mask.spriteFrame = newSpriteFrame;\n         */\n        spriteFrame: {\n            type: cc.SpriteFrame,\n            tooltip: CC_DEV && 'i18n:COMPONENT.mask.spriteFrame',\n            get: function () {\n                return this._spriteFrame;\n            },\n            set: function (value) {\n                let lastSprite = this._spriteFrame;\n                if (CC_EDITOR) {\n                    if ((lastSprite && lastSprite._uuid) === (value && value._uuid)) {\n                        return;\n                    }\n                }\n                else {\n                    if (lastSprite === value) {\n                        return;\n                    }\n                }\n                this._spriteFrame = value;\n                \n                this.setVertsDirty();\n                this._updateMaterial();\n            },\n        },\n\n        /**\n         * !#en\n         * The alpha threshold.(Not supported Canvas Mode) <br/>\n         * The content is drawn only where the stencil have pixel with alpha greater than the alphaThreshold. <br/>\n         * Should be a float between 0 and 1. <br/>\n         * This default to 0.1.\n         * When it's set to 1, the stencil will discard all pixels, nothing will be shown.\n         * !#zh\n         * Alpha 阈值（不支持 Canvas 模式）<br/>\n         * 只有当模板的像素的 alpha 大于等于 alphaThreshold 时，才会绘制内容。<br/>\n         * 该数值 0 ~ 1 之间的浮点数，默认值为 0.1\n         * 当被设置为 1 时，会丢弃所有蒙版像素，所以不会显示任何内容\n         * @property alphaThreshold\n         * @type {Number}\n         * @default 0.1\n         */\n        alphaThreshold: {\n            default: 0.1,\n            type: cc.Float,\n            range: [0, 1, 0.1],\n            slide: true,\n            tooltip: CC_DEV && 'i18n:COMPONENT.mask.alphaThreshold',\n            notify: function () {\n                if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {\n                    cc.warnID(4201);\n                    return;\n                }\n                this._updateMaterial();\n            }\n        },\n\n        /**\n         * !#en Reverse mask (Not supported Canvas Mode)\n         * !#zh 反向遮罩（不支持 Canvas 模式）\n         * @property inverted\n         * @type {Boolean}\n         * @default false\n         */\n        inverted: {\n            default: false,\n            type: cc.Boolean,\n            tooltip: CC_DEV && 'i18n:COMPONENT.mask.inverted',\n            notify: function () {\n                if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {\n                    cc.warnID(4202);\n                }\n            }\n        },\n\n        /**\n         * TODO: remove segments, not supported by graphics\n         * !#en The segements for ellipse mask.\n         * !#zh 椭圆遮罩的曲线细分数\n         * @property segements\n         * @type {Number}\n         * @default 64\n         */\n        _segments: 64,\n        segements: {\n            get: function () {\n                return this._segments;\n            },\n            set: function (value) {\n                this._segments = misc.clampf(value, SEGEMENTS_MIN, SEGEMENTS_MAX);\n                this._updateGraphics();\n            },\n            type: cc.Integer,\n            tooltip: CC_DEV && 'i18n:COMPONENT.mask.segements',\n        },\n\n        _resizeToTarget: {\n            animatable: false,\n            set: function (value) {\n                if(value) {\n                    this._resizeNodeToTargetNode();\n                }\n            }\n        }\n    },\n\n    statics: {\n        Type: MaskType,\n    },\n\n    onRestore () {\n        this._activateMaterial();\n    },\n\n    onEnable () {\n        this._super();\n        if (this._type !== MaskType.IMAGE_STENCIL) {\n            this._updateGraphics();\n        }\n\n        this.node.on(cc.Node.EventType.POSITION_CHANGED, this._updateGraphics, this);\n        this.node.on(cc.Node.EventType.ROTATION_CHANGED, this._updateGraphics, this);\n        this.node.on(cc.Node.EventType.SCALE_CHANGED, this._updateGraphics, this);\n        this.node.on(cc.Node.EventType.SIZE_CHANGED, this._updateGraphics, this);\n        this.node.on(cc.Node.EventType.ANCHOR_CHANGED, this._updateGraphics, this);\n    },\n\n    onDisable () {\n        this._super();\n\n        this.node.off(cc.Node.EventType.POSITION_CHANGED, this._updateGraphics, this);\n        this.node.off(cc.Node.EventType.ROTATION_CHANGED, this._updateGraphics, this);\n        this.node.off(cc.Node.EventType.SCALE_CHANGED, this._updateGraphics, this);\n        this.node.off(cc.Node.EventType.SIZE_CHANGED, this._updateGraphics, this);\n        this.node.off(cc.Node.EventType.ANCHOR_CHANGED, this._updateGraphics, this);\n        \n        this.node._renderFlag &= ~RenderFlow.FLAG_POST_RENDER;\n    },\n\n    onDestroy () {\n        this._super();\n        this._removeGraphics();\n    },\n\n    _resizeNodeToTargetNode: CC_EDITOR && function () {\n        if(this.spriteFrame) {\n            let rect = this.spriteFrame.getRect();\n            this.node.setContentSize(rect.width, rect.height);\n        }\n    },\n\n    _validateRender () {\n        if (this._type !== MaskType.IMAGE_STENCIL) return;\n\n        let spriteFrame = this._spriteFrame;\n        if (spriteFrame && \n            spriteFrame.textureLoaded()) {\n            return;\n        }\n\n        this.disableRender();\n    },\n\n    _activateMaterial () {\n        this._createGraphics();\n        \n        // Init material\n        let material = this._materials[0];\n        if (!material) {\n            material = MaterialVariant.createWithBuiltin('2d-sprite', this);\n        }\n        else {\n            material = MaterialVariant.create(material, this);\n        }\n\n        material.define('USE_ALPHA_TEST', true);\n\n        // Reset material\n        if (this._type === MaskType.IMAGE_STENCIL) {\n            material.define('CC_USE_MODEL', false);\n            material.define('USE_TEXTURE', true);\n        }\n        else {\n            material.define('CC_USE_MODEL', true);\n            material.define('USE_TEXTURE', false);\n        }\n\n        if (!this._enableMaterial) {\n            this._enableMaterial = MaterialVariant.createWithBuiltin('2d-sprite', this);\n        }\n    \n        if (!this._exitMaterial) {\n            this._exitMaterial = MaterialVariant.createWithBuiltin('2d-sprite', this);\n            this._exitMaterial.setStencilEnabled(gfx.STENCIL_DISABLE);\n        }\n\n        if (!this._clearMaterial) {\n            this._clearMaterial = MaterialVariant.createWithBuiltin('clear-stencil', this);\n        }\n\n        this.setMaterial(0, material);\n\n        this._graphics._materials[0] = material;\n\n        this._updateMaterial();\n    },\n\n    _updateMaterial () {\n        let material = this._materials[0];\n        if (!material) return;\n\n        if (this._type === MaskType.IMAGE_STENCIL && this.spriteFrame) {\n            let texture = this.spriteFrame.getTexture();\n            material.setProperty('texture', texture);\n        }\n        material.setProperty('alphaThreshold', this.alphaThreshold);\n    },\n\n    _createGraphics () {\n        if (!this._graphics) {\n            this._graphics = new Graphics();\n            cc.Assembler.init(this._graphics);\n            this._graphics.node = this.node;\n            this._graphics.lineWidth = 0;\n            this._graphics.strokeColor = cc.color(0, 0, 0, 0);\n        }\n    },\n\n    _updateGraphics () {\n        let node = this.node;\n        let graphics = this._graphics;\n        // Share render data with graphics content\n        graphics.clear(false);\n        let width = node._contentSize.width;\n        let height = node._contentSize.height;\n        let x = -width * node._anchorPoint.x;\n        let y = -height * node._anchorPoint.y;\n        if (this._type === MaskType.RECT) {\n            graphics.rect(x, y, width, height);\n        }\n        else if (this._type === MaskType.ELLIPSE) {\n            let center = cc.v2(x + width / 2, y + height / 2);\n            let radius = {\n                x: width / 2,\n                y: height / 2\n            };\n            let points = _calculateCircle(center, radius, this._segments);\n            for (let i = 0; i < points.length; ++i) {\n                let point = points[i];\n                if (i === 0) {\n                    graphics.moveTo(point.x, point.y);\n                }\n                else {\n                    graphics.lineTo(point.x, point.y);\n                }\n            }\n            graphics.close();\n        }\n        if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {\n            graphics.stroke();\n        }\n        else {\n            graphics.fill();\n        }\n    },\n\n    _removeGraphics () {\n        if (this._graphics) {\n            this._graphics.destroy();\n            this._graphics._destroyImmediate(); // FIX: cocos-creator/2d-tasks#2511. TODO: cocos-creator/2d-tasks#2516\n            this._graphics = null;\n        }\n    },\n\n    _hitTest (cameraPt) {\n        let node = this.node;\n        let size = node.getContentSize(),\n            w = size.width,\n            h = size.height,\n            testPt = _vec2_temp;\n        \n        node._updateWorldMatrix();\n        // If scale is 0, it can't be hit.\n        if (!Mat4.invert(_mat4_temp, node._worldMatrix)) {\n            return false;\n        }\n        Vec2.transformMat4(testPt, cameraPt, _mat4_temp);\n        testPt.x += node._anchorPoint.x * w;\n        testPt.y += node._anchorPoint.y * h;\n\n        let result = false;\n        if (this.type === MaskType.RECT || this.type === MaskType.IMAGE_STENCIL) {\n            result = testPt.x >= 0 && testPt.y >= 0 && testPt.x <= w && testPt.y <= h;\n        }\n        else if (this.type === MaskType.ELLIPSE) {\n            let rx = w / 2, ry = h / 2;\n            let px = testPt.x - 0.5 * w, py = testPt.y - 0.5 * h;\n            result = px * px / (rx * rx) + py * py / (ry * ry) < 1;\n        }\n        if (this.inverted) {\n            result = !result;\n        }\n        return result;\n    },\n\n    markForRender (enable) {\n        let flag = RenderFlow.FLAG_RENDER | RenderFlow.FLAG_UPDATE_RENDER_DATA | RenderFlow.FLAG_POST_RENDER;\n        if (enable) {\n            this.node._renderFlag |= flag;\n            this.markForValidate();\n        }\n        else if (!enable) {\n            this.node._renderFlag &= ~flag;\n        }\n    },\n\n    disableRender () {\n        this.node._renderFlag &= ~(RenderFlow.FLAG_RENDER | RenderFlow.FLAG_UPDATE_RENDER_DATA | \n                                   RenderFlow.FLAG_POST_RENDER);\n    },\n});\n\ncc.Mask = module.exports = Mask;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst RenderComponent = require('../components/CCRenderComponent');\nconst BlendFunc = require('../../core/utils/blend-func');\n\n/**\n * !#en\n * cc.MotionStreak manages a Ribbon based on it's motion in absolute space.                 <br/>\n * You construct it with a fadeTime, minimum segment size, texture path, texture            <br/>\n * length and color. The fadeTime controls how long it takes each vertex in                 <br/>\n * the streak to fade out, the minimum segment size it how many pixels the                  <br/>\n * streak will move before adding a new ribbon segment, and the texture                     <br/>\n * length is the how many pixels the texture is stretched across. The texture               <br/>\n * is vertically aligned along the streak segment.\n * !#zh 运动轨迹，用于游戏对象的运动轨迹上实现拖尾渐隐效果。\n * @class MotionStreak\n * @extends Component\n * @uses BlendFunc\n */\nvar MotionStreak = cc.Class({\n    name: 'cc.MotionStreak',\n\n    // To avoid conflict with other render component, we haven't use ComponentUnderSG,\n    // its implementation also requires some different approach:\n    //   1.Needed a parent node to make motion streak's position global related.\n    //   2.Need to update the position in each frame by itself because we don't know\n    //     whether the global position have changed\n    extends: RenderComponent,\n    mixins: [BlendFunc],\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.others/MotionStreak',\n        help: 'i18n:COMPONENT.help_url.motionStreak',\n        playOnFocus: true,\n        executeInEditMode: true\n    },\n\n    ctor () {\n        this._points = [];\n    },\n\n    properties: {\n        /**\n         * !#en\n         * !#zh 在编辑器模式下预览拖尾效果。\n         * @property {Boolean} preview\n         * @default false\n         */\n        preview: {\n            default: false,\n            editorOnly: true,\n            notify: CC_EDITOR && function () {\n                this.reset();\n            },\n            animatable: false\n        },\n\n        /**\n         * !#en The fade time to fade.\n         * !#zh 拖尾的渐隐时间，以秒为单位。\n         * @property fadeTime\n         * @type {Number}\n         * @example\n         * motionStreak.fadeTime = 3;\n         */\n        _fadeTime: 1,\n        fadeTime: {\n            get () {\n                return this._fadeTime;\n            },\n            set (value) {\n                this._fadeTime = value;\n                this.reset();\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.motionStreak.fadeTime'\n        },\n\n        /**\n         * !#en The minimum segment size.\n         * !#zh 拖尾之间最小距离。\n         * @property minSeg\n         * @type {Number}\n         * @example\n         * motionStreak.minSeg = 3;\n         */\n        _minSeg: 1,\n        minSeg: {\n            get () {\n                return this._minSeg;\n            },\n            set (value) {\n                this._minSeg = value;\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.motionStreak.minSeg'\n        },\n\n        /**\n         * !#en The stroke's width.\n         * !#zh 拖尾的宽度。\n         * @property stroke\n         * @type {Number}\n         * @example\n         * motionStreak.stroke = 64;\n         */\n        _stroke: 64,\n        stroke: {\n            get () {\n                return this._stroke;\n            },\n            set (value) {\n                this._stroke = value;\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.motionStreak.stroke'\n        },\n\n        /**\n         * !#en The texture of the MotionStreak.\n         * !#zh 拖尾的贴图。\n         * @property texture\n         * @type {Texture2D}\n         * @example\n         * motionStreak.texture = newTexture;\n         */\n        _texture: {\n            default: null,\n            type: cc.Texture2D\n        },\n        texture: {\n            get () {\n                return this._texture;\n            },\n            set (value) {\n                if (this._texture === value) return;\n\n                this._texture = value;\n                this._updateMaterial();\n            },\n            type: cc.Texture2D,\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.motionStreak.texture'\n        },\n\n        /**\n         * !#en The color of the MotionStreak.\n         * !#zh 拖尾的颜色\n         * @property color\n         * @type {Color}\n         * @default cc.Color.WHITE\n         * @example\n         * motionStreak.color = new cc.Color(255, 255, 255);\n         */\n        _color: cc.Color.WHITE,\n        color: {\n            get () {\n                return this._color;\n            },\n            set (value) {\n                this._color = value;\n            },\n            type: cc.Color,\n            tooltip: CC_DEV && 'i18n:COMPONENT.motionStreak.color'\n        },\n\n        /**\n         * !#en The fast Mode.\n         * !#zh 是否启用了快速模式。当启用快速模式，新的点会被更快地添加，但精度较低。\n         * @property fastMode\n         * @type {Boolean}\n         * @default false\n         * @example\n         * motionStreak.fastMode = true;\n         */\n        _fastMode: false,\n        fastMode: {\n            get () {\n                return this._fastMode;\n            },\n            set (value) {\n                this._fastMode = value;\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.motionStreak.fastMode'\n        }\n    },\n\n    onEnable () {\n        this._super();\n        this.reset();\n    },\n\n    _updateMaterial () {\n        let material = this.getMaterial(0);\n        material && material.setProperty('texture', this._texture);\n\n        BlendFunc.prototype._updateMaterial.call(this);\n    },\n\n    onFocusInEditor: CC_EDITOR && function () {\n        if (this.preview) {\n            this.reset();\n        }\n    },\n\n    onLostFocusInEditor: CC_EDITOR && function () {\n        if (this.preview) {\n            this.reset();\n        }\n    },\n\n    /**\n     * !#en Remove all living segments of the ribbon.\n     * !#zh 删除当前所有的拖尾片段。\n     * @method reset\n     * @example\n     * // Remove all living segments of the ribbon.\n     * myMotionStreak.reset();\n     */\n    reset () {\n        this._points.length = 0;\n        this._assembler && this._assembler._renderData.clear();\n        if (CC_EDITOR) {\n            cc.engine.repaintInEditMode();\n        }\n    },\n\n    lateUpdate (dt) {\n        this._assembler && this._assembler.update(this, dt);\n    }\n});\n\ncc.MotionStreak = module.exports = MotionStreak;","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler from '../renderer/assembler';\nimport MaterialVariant from '../assets/material/material-variant';\n\nconst Component = require('./CCComponent');\nconst RenderFlow = require('../renderer/render-flow');\nconst Material = require('../assets/material/CCMaterial');\n\n/**\n * !#en\n * Base class for components which supports rendering features.\n * !#zh\n * 所有支持渲染的组件的基类\n *\n * @class RenderComponent\n * @extends Component\n */\nlet RenderComponent = cc.Class({\n    name: 'RenderComponent',\n    extends: Component,\n\n    editor: CC_EDITOR && {\n        executeInEditMode: true,\n        disallowMultiple: true\n    },\n\n    properties: {\n        _materials: {\n            default: [],\n            type: Material,\n        },\n\n        /**\n         * !#en The materials used by this render component.\n         * !#zh 渲染组件使用的材质。\n         * @property {[Material]} sharedMaterials\n         */\n        materials: {\n            get () {\n                return this._materials;\n            },\n            set (val) {\n                this._materials = val;\n                this._activateMaterial();\n            },\n            type: [Material],\n            displayName: 'Materials',\n            animatable: false\n        }\n    },\n    \n    ctor () {\n        this._vertsDirty = true;\n        this._assembler = null;\n    },\n\n    _resetAssembler () {\n        Assembler.init(this);\n        this._updateColor();\n    },\n\n    __preload () {\n        this._resetAssembler();\n        this._activateMaterial();\n    },\n\n    onEnable () {\n        if (this.node._renderComponent) {\n            this.node._renderComponent.enabled = false;\n        }\n        this.node._renderComponent = this;\n        this.node._renderFlag |= RenderFlow.FLAG_OPACITY_COLOR;\n        \n        this.setVertsDirty();\n    },\n\n    onDisable () {\n        this.node._renderComponent = null;\n        this.disableRender();\n    },\n\n    onDestroy () {\n        let materials = this._materials;\n        for (let i = 0; i < materials.length; i++) {\n            cc.pool.material.put(materials[i]);\n        }\n        materials.length = 0;\n\n        cc.pool.assembler.put(this._assembler);\n    },\n\n    setVertsDirty () {\n        this._vertsDirty = true;\n        this.markForRender(true);\n    },\n\n    _on3DNodeChanged () {\n        this._resetAssembler();\n    },\n    \n    _validateRender () {\n    },\n\n    markForValidate () {\n        cc.RenderFlow.registerValidate(this);\n    },\n\n    markForRender (enable) {\n        let flag = RenderFlow.FLAG_RENDER | RenderFlow.FLAG_UPDATE_RENDER_DATA;\n        if (enable) {\n            this.node._renderFlag |= flag;\n            this.markForValidate();\n        }\n        else {\n            this.node._renderFlag &= ~flag;\n        }\n    },\n\n    disableRender () {\n        this.node._renderFlag &= ~(RenderFlow.FLAG_RENDER | RenderFlow.FLAG_UPDATE_RENDER_DATA);\n    },\n\n    /**\n     * !#en Get the material by index.\n     * !#zh 根据指定索引获取材质\n     * @method getMaterial\n     * @param {Number} index \n     * @return {MaterialVariant}\n     */\n    getMaterial (index) {\n        if (index < 0 || index >= this._materials.length) {\n            return null;\n        }\n\n        let material = this._materials[index];\n        if (!material) return null;\n        \n        let instantiated = MaterialVariant.create(material, this);\n        if (instantiated !== material) {\n            this.setMaterial(index, instantiated);\n        }\n\n        return instantiated;\n    },\n\n    /**\n     * !#en Gets all the materials.\n     * !#zh 获取所有材质。\n     * @method getMaterials\n     * @return {[MaterialVariant]}\n     */\n    getMaterials () {\n        let materials = this._materials;\n        for (let i = 0; i < materials.length; i++) {\n            materials[i] = MaterialVariant.create(materials[i], this);\n        }\n        return materials;\n    },\n    \n    /**\n     * !#en Set the material by index.\n     * !#zh 根据指定索引设置材质\n     * @method setMaterial\n     * @param {Number} index \n     * @param {Material} material\n     * @return {Material}\n     */\n    setMaterial (index, material) {\n        if (material !== this._materials[index]) {\n            material = MaterialVariant.create(material, this);\n            this._materials[index] = material;\n        }\n        this._updateMaterial();\n        this.markForRender(true);\n        return material;\n    },\n\n    _getDefaultMaterial () {\n        return Material.getBuiltinMaterial('2d-sprite');\n    },\n\n    /**\n     * Init material.\n     */\n    _activateMaterial () {\n        let materials = this._materials;\n        if (!materials[0]) {\n            let material = this._getDefaultMaterial();\n            materials[0] = material;\n        }\n\n        for (let i = 0; i < materials.length; i++) {\n            materials[i] = MaterialVariant.create(materials[i], this);\n        }\n\n        this._updateMaterial();\n    },\n\n    /**\n     * Update material properties.\n     */\n    _updateMaterial () {\n\n    },\n\n    _updateColor () {\n        if (this._assembler.updateColor) {\n            this._assembler.updateColor(this);\n        }\n    },\n\n    _checkBacth (renderer, cullingMask) {\n        let material = this._materials[0];\n        if ((material && material.getHash() !== renderer.material.getHash()) || \n            renderer.cullingMask !== cullingMask) {\n            renderer._flush();\n    \n            renderer.node = material.getDefine('CC_USE_MODEL') ? this.node : renderer._dummyNode;\n            renderer.material = material;\n            renderer.cullingMask = cullingMask;\n        }\n    }\n});\n\ncc.RenderComponent = module.exports = RenderComponent;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst NodeEvent = require('../CCNode').EventType;\n\nconst NUMBER_OF_GATHERED_TOUCHES_FOR_MOVE_SPEED = 5;\nconst OUT_OF_BOUNDARY_BREAKING_FACTOR = 0.05;\nconst EPSILON = 1e-4;\nconst MOVEMENT_FACTOR = 0.7;\n\nlet _tempPoint = cc.v2();\nlet _tempPrevPoint = cc.v2();\n\nlet quintEaseOut = function(time) {\n    time -= 1;\n    return (time * time * time * time * time + 1);\n};\n\nlet getTimeInMilliseconds = function() {\n    let currentTime = new Date();\n    return currentTime.getMilliseconds();\n};\n\n/**\n * !#en Enum for ScrollView event type.\n * !#zh 滚动视图事件类型\n * @enum ScrollView.EventType\n */\nconst EventType = cc.Enum({\n    /**\n     * !#en The event emmitted when ScrollView scroll to the top boundary of inner container\n     * !#zh 滚动视图滚动到顶部边界事件\n     * @property {Number} SCROLL_TO_TOP\n     */\n    SCROLL_TO_TOP : 0,\n    /**\n     * !#en The event emmitted when ScrollView scroll to the bottom boundary of inner container\n     * !#zh 滚动视图滚动到底部边界事件\n     * @property {Number} SCROLL_TO_BOTTOM\n     */\n    SCROLL_TO_BOTTOM : 1,\n    /**\n     * !#en The event emmitted when ScrollView scroll to the left boundary of inner container\n     * !#zh 滚动视图滚动到左边界事件\n     * @property {Number} SCROLL_TO_LEFT\n     */\n    SCROLL_TO_LEFT : 2,\n    /**\n     * !#en The event emmitted when ScrollView scroll to the right boundary of inner container\n     * !#zh 滚动视图滚动到右边界事件\n     * @property {Number} SCROLL_TO_RIGHT\n     */\n    SCROLL_TO_RIGHT : 3,\n    /**\n     * !#en The event emmitted when ScrollView is scrolling\n     * !#zh 滚动视图正在滚动时发出的事件\n     * @property {Number} SCROLLING\n     */\n    SCROLLING : 4,\n    /**\n     * !#en The event emmitted when ScrollView scroll to the top boundary of inner container and start bounce\n     * !#zh 滚动视图滚动到顶部边界并且开始回弹时发出的事件\n     * @property {Number} BOUNCE_TOP\n     */\n    BOUNCE_TOP : 5,\n    /**\n     * !#en The event emmitted when ScrollView scroll to the bottom boundary of inner container and start bounce\n     * !#zh 滚动视图滚动到底部边界并且开始回弹时发出的事件\n     * @property {Number} BOUNCE_BOTTOM\n     */\n    BOUNCE_BOTTOM : 6,\n    /**\n     * !#en The event emmitted when ScrollView scroll to the left boundary of inner container and start bounce\n     * !#zh 滚动视图滚动到左边界并且开始回弹时发出的事件\n     * @property {Number} BOUNCE_LEFT\n     */\n    BOUNCE_LEFT : 7,\n    /**\n     * !#en The event emmitted when ScrollView scroll to the right boundary of inner container and start bounce\n     * !#zh 滚动视图滚动到右边界并且开始回弹时发出的事件\n     * @property {Number} BOUNCE_RIGHT\n     */\n    BOUNCE_RIGHT : 8,\n    /**\n     * !#en The event emmitted when ScrollView auto scroll ended\n     * !#zh 滚动视图滚动结束的时候发出的事件\n     * @property {Number} SCROLL_ENDED\n     */\n    SCROLL_ENDED : 9,\n    /**\n     * !#en The event emmitted when user release the touch\n     * !#zh 当用户松手的时候会发出一个事件\n     * @property {Number} TOUCH_UP\n     */\n    TOUCH_UP : 10,\n    /**\n     * !#en The event emmitted when ScrollView auto scroll ended with a threshold\n     * !#zh 滚动视图自动滚动快要结束的时候发出的事件\n     * @property {Number} AUTOSCROLL_ENDED_WITH_THRESHOLD\n     */\n    AUTOSCROLL_ENDED_WITH_THRESHOLD: 11,\n    /**\n     * !#en The event emmitted when ScrollView scroll began\n     * !#zh 滚动视图滚动开始时发出的事件\n     * @property {Number} SCROLL_BEGAN\n     */\n    SCROLL_BEGAN: 12\n});\n\nconst eventMap = {\n    'scroll-to-top' : EventType.SCROLL_TO_TOP,\n    'scroll-to-bottom': EventType.SCROLL_TO_BOTTOM,\n    'scroll-to-left' : EventType.SCROLL_TO_LEFT,\n    'scroll-to-right' : EventType.SCROLL_TO_RIGHT,\n    'scrolling' : EventType.SCROLLING,\n    'bounce-bottom' : EventType.BOUNCE_BOTTOM,\n    'bounce-left' : EventType.BOUNCE_LEFT,\n    'bounce-right' : EventType.BOUNCE_RIGHT,\n    'bounce-top' : EventType.BOUNCE_TOP,\n    'scroll-ended': EventType.SCROLL_ENDED,\n    'touch-up' : EventType.TOUCH_UP,\n    'scroll-ended-with-threshold' : EventType.AUTOSCROLL_ENDED_WITH_THRESHOLD,\n    'scroll-began': EventType.SCROLL_BEGAN\n};\n\n/**\n * !#en\n * Layout container for a view hierarchy that can be scrolled by the user,\n * allowing it to be larger than the physical display.\n *\n * !#zh\n * 滚动视图组件\n * @class ScrollView\n * @extends Component\n */\nlet ScrollView = cc.Class({\n    name: 'cc.ScrollView',\n    extends: require('./CCViewGroup'),\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.ui/ScrollView',\n        help: 'i18n:COMPONENT.help_url.scrollview',\n        inspector: 'packages://inspector/inspectors/comps/scrollview.js',\n        executeInEditMode: false,\n    },\n\n    ctor () {\n        this._topBoundary = 0;\n        this._bottomBoundary = 0;\n        this._leftBoundary = 0;\n        this._rightBoundary = 0;\n\n        this._touchMoveDisplacements = [];\n        this._touchMoveTimeDeltas = [];\n        this._touchMovePreviousTimestamp = 0;\n        this._touchMoved = false;\n\n        this._autoScrolling = false;\n        this._autoScrollAttenuate = false;\n        this._autoScrollStartPosition = cc.v2(0, 0);\n        this._autoScrollTargetDelta = cc.v2(0, 0);\n        this._autoScrollTotalTime = 0;\n        this._autoScrollAccumulatedTime = 0;\n        this._autoScrollCurrentlyOutOfBoundary = false;\n        this._autoScrollBraking = false;\n        this._autoScrollBrakingStartPosition = cc.v2(0, 0);\n\n        this._outOfBoundaryAmount = cc.v2(0, 0);\n        this._outOfBoundaryAmountDirty = true;\n        this._stopMouseWheel = false;\n        this._mouseWheelEventElapsedTime = 0.0;\n        this._isScrollEndedWithThresholdEventFired = false;\n        //use bit wise operations to indicate the direction\n        this._scrollEventEmitMask = 0;\n        this._isBouncing = false;\n        this._scrolling = false;\n    },\n\n    properties: {\n        /**\n         * !#en This is a reference to the UI element to be scrolled.\n         * !#zh 可滚动展示内容的节点。\n         * @property {Node} content\n         */\n        content: {\n            default: undefined,\n            type: cc.Node,\n            tooltip: CC_DEV && 'i18n:COMPONENT.scrollview.content',\n            formerlySerializedAs: 'content',\n            notify (oldValue) {\n                this._calculateBoundary();\n            }\n        },\n\n        /**\n         * !#en Enable horizontal scroll.\n         * !#zh 是否开启水平滚动。\n         * @property {Boolean} horizontal\n         */\n        horizontal: {\n            default: true,\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.scrollview.horizontal',\n        },\n\n        /**\n         * !#en Enable vertical scroll.\n         * !#zh 是否开启垂直滚动。\n         * @property {Boolean} vertical\n         */\n        vertical: {\n            default: true,\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.scrollview.vertical',\n        },\n\n        /**\n         * !#en When inertia is set, the content will continue to move when touch ended.\n         * !#zh 是否开启滚动惯性。\n         * @property {Boolean} inertia\n         */\n        inertia: {\n            default: true,\n            tooltip: CC_DEV && 'i18n:COMPONENT.scrollview.inertia',\n        },\n\n        /**\n         * !#en\n         * It determines how quickly the content stop moving. A value of 1 will stop the movement immediately.\n         * A value of 0 will never stop the movement until it reaches to the boundary of scrollview.\n         * !#zh\n         * 开启惯性后，在用户停止触摸后滚动多快停止，0表示永不停止，1表示立刻停止。\n         * @property {Number} brake\n         */\n        brake: {\n            default: 0.5,\n            type: cc.Float,\n            range: [0, 1, 0.1],\n            tooltip: CC_DEV && 'i18n:COMPONENT.scrollview.brake',\n        },\n\n        /**\n         * !#en When elastic is set, the content will be bounce back when move out of boundary.\n         * !#zh 是否允许滚动内容超过边界，并在停止触摸后回弹。\n         * @property {Boolean} elastic\n         */\n        elastic: {\n            default: true,\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.scrollview.elastic',\n        },\n\n        /**\n         * !#en The elapse time of bouncing back. A value of 0 will bounce back immediately.\n         * !#zh 回弹持续的时间，0 表示将立即反弹。\n         * @property {Number} bounceDuration\n         */\n        bounceDuration: {\n            default: 1,\n            range: [0, 10],\n            tooltip: CC_DEV && 'i18n:COMPONENT.scrollview.bounceDuration',\n        },\n\n        /**\n         * !#en The horizontal scrollbar reference.\n         * !#zh 水平滚动的 ScrollBar。\n         * @property {Scrollbar} horizontalScrollBar\n         */\n        horizontalScrollBar: {\n            default: undefined,\n            type: cc.Scrollbar,\n            tooltip: CC_DEV && 'i18n:COMPONENT.scrollview.horizontal_bar',\n            notify () {\n                if (this.horizontalScrollBar) {\n                    this.horizontalScrollBar.setTargetScrollView(this);\n                    this._updateScrollBar(0);\n                }\n            },\n            animatable: false\n        },\n\n        /**\n         * !#en The vertical scrollbar reference.\n         * !#zh 垂直滚动的 ScrollBar。\n         * @property {Scrollbar} verticalScrollBar\n         */\n        verticalScrollBar: {\n            default: undefined,\n            type: cc.Scrollbar,\n            tooltip: CC_DEV && 'i18n:COMPONENT.scrollview.vertical_bar',\n            notify () {\n                if (this.verticalScrollBar) {\n                    this.verticalScrollBar.setTargetScrollView(this);\n                    this._updateScrollBar(0);\n                }\n            },\n            animatable: false\n        },\n\n        /**\n         * !#en Scrollview events callback\n         * !#zh 滚动视图的事件回调函数\n         * @property {Component.EventHandler[]} scrollEvents\n         */\n        scrollEvents: {\n            default: [],\n            type: cc.Component.EventHandler,\n            tooltip: CC_DEV && 'i18n:COMPONENT.scrollview.scrollEvents'\n        },\n\n        /**\n         * !#en If cancelInnerEvents is set to true, the scroll behavior will cancel touch events on inner content nodes\n         * It's set to true by default.\n         * !#zh 如果这个属性被设置为 true，那么滚动行为会取消子节点上注册的触摸事件，默认被设置为 true。\n         * 注意，子节点上的 touchstart 事件仍然会触发，触点移动距离非常短的情况下 touchmove 和 touchend 也不会受影响。\n         * @property {Boolean} cancelInnerEvents\n         */\n        cancelInnerEvents: {\n            default: true,\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.scrollview.cancelInnerEvents'\n        },\n\n        // private object\n        _view: {\n            get: function () {\n                if (this.content) {\n                    return this.content.parent;\n                }\n            }\n        }\n    },\n\n    statics: {\n        EventType: EventType,\n    },\n\n    /**\n     * !#en Scroll the content to the bottom boundary of ScrollView.\n     * !#zh 视图内容将在规定时间内滚动到视图底部。\n     * @method scrollToBottom\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the bottom boundary immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * @example\n     * // Scroll to the bottom of the view.\n     * scrollView.scrollToBottom(0.1);\n     */\n    scrollToBottom (timeInSecond, attenuated) {\n        let moveDelta = this._calculateMovePercentDelta({\n            anchor: cc.v2(0, 0),\n            applyToHorizontal: false,\n            applyToVertical: true,\n        });\n\n        if (timeInSecond) {\n            this._startAutoScroll(moveDelta, timeInSecond, attenuated !== false);\n        } else {\n            this._moveContent(moveDelta, true);\n        }\n    },\n\n    /**\n     * !#en Scroll the content to the top boundary of ScrollView.\n     * !#zh 视图内容将在规定时间内滚动到视图顶部。\n     * @method scrollToTop\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the top boundary immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * @example\n     * // Scroll to the top of the view.\n     * scrollView.scrollToTop(0.1);\n     */\n    scrollToTop (timeInSecond, attenuated) {\n        let moveDelta = this._calculateMovePercentDelta({\n            anchor: cc.v2(0, 1),\n            applyToHorizontal: false,\n            applyToVertical: true,\n        });\n\n        if (timeInSecond) {\n            this._startAutoScroll(moveDelta, timeInSecond, attenuated !== false);\n        } else {\n            this._moveContent(moveDelta);\n        }\n    },\n\n    /**\n     * !#en Scroll the content to the left boundary of ScrollView.\n     * !#zh 视图内容将在规定时间内滚动到视图左边。\n     * @method scrollToLeft\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the left boundary immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * @example\n     * // Scroll to the left of the view.\n     * scrollView.scrollToLeft(0.1);\n     */\n    scrollToLeft (timeInSecond, attenuated) {\n        let moveDelta = this._calculateMovePercentDelta({\n            anchor: cc.v2(0, 0),\n            applyToHorizontal: true,\n            applyToVertical: false,\n        });\n\n        if (timeInSecond) {\n            this._startAutoScroll(moveDelta, timeInSecond, attenuated !== false);\n        } else {\n            this._moveContent(moveDelta);\n        }\n    },\n\n    /**\n     * !#en Scroll the content to the right boundary of ScrollView.\n     * !#zh 视图内容将在规定时间内滚动到视图右边。\n     * @method scrollToRight\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the right boundary immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * @example\n     * // Scroll to the right of the view.\n     * scrollView.scrollToRight(0.1);\n     */\n    scrollToRight (timeInSecond, attenuated) {\n        let moveDelta = this._calculateMovePercentDelta({\n            anchor: cc.v2(1, 0),\n            applyToHorizontal: true,\n            applyToVertical: false,\n        });\n\n        if (timeInSecond) {\n            this._startAutoScroll(moveDelta, timeInSecond, attenuated !== false);\n        } else {\n            this._moveContent(moveDelta);\n        }\n    },\n\n    /**\n     * !#en Scroll the content to the top left boundary of ScrollView.\n     * !#zh 视图内容将在规定时间内滚动到视图左上角。\n     * @method scrollToTopLeft\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the top left boundary immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * @example\n     * // Scroll to the upper left corner of the view.\n     * scrollView.scrollToTopLeft(0.1);\n     */\n    scrollToTopLeft (timeInSecond, attenuated) {\n        let moveDelta = this._calculateMovePercentDelta({\n            anchor: cc.v2(0, 1),\n            applyToHorizontal: true,\n            applyToVertical: true,\n        });\n\n        if (timeInSecond) {\n            this._startAutoScroll(moveDelta, timeInSecond, attenuated !== false);\n        } else {\n            this._moveContent(moveDelta);\n        }\n    },\n\n    /**\n     * !#en Scroll the content to the top right boundary of ScrollView.\n     * !#zh 视图内容将在规定时间内滚动到视图右上角。\n     * @method scrollToTopRight\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the top right boundary immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * @example\n     * // Scroll to the top right corner of the view.\n     * scrollView.scrollToTopRight(0.1);\n     */\n    scrollToTopRight (timeInSecond, attenuated) {\n        let moveDelta = this._calculateMovePercentDelta({\n            anchor: cc.v2(1, 1),\n            applyToHorizontal: true,\n            applyToVertical: true,\n        });\n\n        if (timeInSecond) {\n            this._startAutoScroll(moveDelta, timeInSecond, attenuated !== false);\n        } else {\n            this._moveContent(moveDelta);\n        }\n    },\n\n    /**\n     * !#en Scroll the content to the bottom left boundary of ScrollView.\n     * !#zh 视图内容将在规定时间内滚动到视图左下角。\n     * @method scrollToBottomLeft\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the bottom left boundary immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * @example\n     * // Scroll to the lower left corner of the view.\n     * scrollView.scrollToBottomLeft(0.1);\n     */\n    scrollToBottomLeft (timeInSecond, attenuated) {\n        let moveDelta = this._calculateMovePercentDelta({\n            anchor: cc.v2(0, 0),\n            applyToHorizontal: true,\n            applyToVertical: true,\n        });\n\n        if (timeInSecond) {\n            this._startAutoScroll(moveDelta, timeInSecond, attenuated !== false);\n        } else {\n            this._moveContent(moveDelta);\n        }\n    },\n\n    /**\n     * !#en Scroll the content to the bottom right boundary of ScrollView.\n     * !#zh 视图内容将在规定时间内滚动到视图右下角。\n     * @method scrollToBottomRight\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the bottom right boundary immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * @example\n     * // Scroll to the lower right corner of the view.\n     * scrollView.scrollToBottomRight(0.1);\n     */\n    scrollToBottomRight (timeInSecond, attenuated) {\n        let moveDelta = this._calculateMovePercentDelta({\n            anchor: cc.v2(1, 0),\n            applyToHorizontal: true,\n            applyToVertical: true,\n        });\n\n        if (timeInSecond) {\n            this._startAutoScroll(moveDelta, timeInSecond, attenuated !== false);\n        } else {\n            this._moveContent(moveDelta);\n        }\n    },\n\n\n    /**\n     * !#en Scroll with an offset related to the ScrollView's top left origin, if timeInSecond is omitted, then it will jump to the\n     *       specific offset immediately.\n     * !#zh 视图内容在规定时间内将滚动到 ScrollView 相对左上角原点的偏移位置, 如果 timeInSecond参数不传，则立即滚动到指定偏移位置。\n     * @method scrollToOffset\n     * @param {Vec2} offset - A Vec2, the value of which each axis between 0 and maxScrollOffset\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the specific offset of ScrollView immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * @example\n     * // Scroll to middle position in 0.1 second in x-axis\n     * let maxScrollOffset = this.getMaxScrollOffset();\n     * scrollView.scrollToOffset(cc.v2(maxScrollOffset.x / 2, 0), 0.1);\n     */\n    scrollToOffset (offset, timeInSecond, attenuated) {\n        let maxScrollOffset = this.getMaxScrollOffset();\n\n        let anchor = cc.v2(0, 0);\n        //if maxScrollOffset is 0, then always align the content's top left origin to the top left corner of its parent\n        if (maxScrollOffset.x === 0) {\n            anchor.x = 0;\n        } else {\n            anchor.x = offset.x / maxScrollOffset.x;\n        }\n\n        if (maxScrollOffset.y === 0) {\n            anchor.y = 1;\n        } else {\n            anchor.y = (maxScrollOffset.y - offset.y ) / maxScrollOffset.y;\n        }\n\n        this.scrollTo(anchor, timeInSecond, attenuated);\n    },\n\n    /**\n     * !#en  Get the positive offset value corresponds to the content's top left boundary.\n     * !#zh  获取滚动视图相对于左上角原点的当前滚动偏移\n     * @method getScrollOffset\n     * @return {Vec2}  - A Vec2 value indicate the current scroll offset.\n     */\n    getScrollOffset () {\n        let topDelta =  this._getContentTopBoundary() - this._topBoundary;\n        let leftDeta = this._getContentLeftBoundary() - this._leftBoundary;\n\n        return cc.v2(leftDeta, topDelta);\n    },\n\n    /**\n     * !#en Get the maximize available  scroll offset\n     * !#zh 获取滚动视图最大可以滚动的偏移量\n     * @method getMaxScrollOffset\n     * @return {Vec2} - A Vec2 value indicate the maximize scroll offset in x and y axis.\n     */\n    getMaxScrollOffset () {\n        let viewSize = this._view.getContentSize();\n        let contentSize = this.content.getContentSize();\n        let horizontalMaximizeOffset =  contentSize.width - viewSize.width;\n        let verticalMaximizeOffset = contentSize.height - viewSize.height;\n        horizontalMaximizeOffset = horizontalMaximizeOffset >= 0 ? horizontalMaximizeOffset : 0;\n        verticalMaximizeOffset = verticalMaximizeOffset >=0 ? verticalMaximizeOffset : 0;\n\n        return cc.v2(horizontalMaximizeOffset, verticalMaximizeOffset);\n    },\n\n    /**\n     * !#en Scroll the content to the horizontal percent position of ScrollView.\n     * !#zh 视图内容在规定时间内将滚动到 ScrollView 水平方向的百分比位置上。\n     * @method scrollToPercentHorizontal\n     * @param {Number} percent - A value between 0 and 1.\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the horizontal percent position of ScrollView immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * @example\n     * // Scroll to middle position.\n     * scrollView.scrollToBottomRight(0.5, 0.1);\n     */\n    scrollToPercentHorizontal (percent, timeInSecond, attenuated) {\n        let moveDelta = this._calculateMovePercentDelta({\n            anchor: cc.v2(percent, 0),\n            applyToHorizontal: true,\n            applyToVertical: false,\n        });\n\n        if (timeInSecond) {\n            this._startAutoScroll(moveDelta, timeInSecond, attenuated !== false);\n        } else {\n            this._moveContent(moveDelta);\n        }\n    },\n\n    /**\n     * !#en Scroll the content to the percent position of ScrollView in any direction.\n     * !#zh 视图内容在规定时间内进行垂直方向和水平方向的滚动，并且滚动到指定百分比位置上。\n     * @method scrollTo\n     * @param {Vec2} anchor - A point which will be clamp between cc.v2(0,0) and cc.v2(1,1).\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the percent position of ScrollView immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * @example\n     * // Vertical scroll to the bottom of the view.\n     * scrollView.scrollTo(cc.v2(0, 1), 0.1);\n     *\n     * // Horizontal scroll to view right.\n     * scrollView.scrollTo(cc.v2(1, 0), 0.1);\n     */\n    scrollTo (anchor, timeInSecond, attenuated) {\n        let moveDelta = this._calculateMovePercentDelta({\n            anchor: cc.v2(anchor),\n            applyToHorizontal: true,\n            applyToVertical: true,\n        });\n\n        if (timeInSecond) {\n            this._startAutoScroll(moveDelta, timeInSecond, attenuated !== false);\n        } else {\n            this._moveContent(moveDelta);\n        }\n    },\n\n    /**\n     * !#en Scroll the content to the vertical percent position of ScrollView.\n     * !#zh 视图内容在规定时间内滚动到 ScrollView 垂直方向的百分比位置上。\n     * @method scrollToPercentVertical\n     * @param {Number} percent - A value between 0 and 1.\n     * @param {Number} [timeInSecond=0] - Scroll time in second, if you don't pass timeInSecond,\n     * the content will jump to the vertical percent position of ScrollView immediately.\n     * @param {Boolean} [attenuated=true] - Whether the scroll acceleration attenuated, default is true.\n     * // Scroll to middle position.\n     * scrollView.scrollToPercentVertical(0.5, 0.1);\n     */\n    scrollToPercentVertical (percent, timeInSecond, attenuated) {\n        let moveDelta = this._calculateMovePercentDelta({\n            anchor: cc.v2(0, percent),\n            applyToHorizontal: false,\n            applyToVertical: true,\n        });\n\n        if (timeInSecond) {\n            this._startAutoScroll(moveDelta, timeInSecond, attenuated !== false);\n        } else {\n            this._moveContent(moveDelta);\n        }\n    },\n\n    /**\n     * !#en  Stop auto scroll immediately\n     * !#zh  停止自动滚动, 调用此 API 可以让 Scrollview 立即停止滚动\n     * @method stopAutoScroll\n     */\n    stopAutoScroll () {\n        this._autoScrolling = false;\n        this._autoScrollAccumulatedTime = this._autoScrollTotalTime;\n    },\n\n    /**\n     * !#en Modify the content position.\n     * !#zh 设置当前视图内容的坐标点。\n     * @method setContentPosition\n     * @param {Vec2} position - The position in content's parent space.\n     */\n    setContentPosition (position) {\n        if (position.fuzzyEquals(this.getContentPosition(), EPSILON)) {\n            return;\n        }\n\n        this.content.setPosition(position);\n        this._outOfBoundaryAmountDirty = true;\n    },\n\n    /**\n     * !#en Query the content's position in its parent space.\n     * !#zh 获取当前视图内容的坐标点。\n     * @method getContentPosition\n     * @returns {Vec2} - The content's position in its parent space.\n     */\n    getContentPosition () {\n        return this.content.getPosition();\n    },\n    \n    /**\n     * !#en Query whether the user is currently dragging the ScrollView to scroll it\n     * !#zh 用户是否在拖拽当前滚动视图\n     * @method isScrolling\n     * @returns {Boolean} - Whether the user is currently dragging the ScrollView to scroll it\n     */\n    isScrolling () {\n        return this._scrolling;\n    },\n\n    /**\n     * !#en Query whether the ScrollView is currently scrolling because of a bounceback or inertia slowdown.\n     * !#zh 当前滚动视图是否在惯性滚动\n     * @method isAutoScrolling\n     * @returns {Boolean} - Whether the ScrollView is currently scrolling because of a bounceback or inertia slowdown.\n     */\n    isAutoScrolling () {\n        return this._autoScrolling;\n    },\n    \n    //private methods\n    _registerEvent () {\n        this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this, true);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this, true);\n        this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this, true);\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancelled, this, true);\n        this.node.on(cc.Node.EventType.MOUSE_WHEEL, this._onMouseWheel, this, true);\n    },\n\n    _unregisterEvent () {\n        this.node.off(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this, true);\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this, true);\n        this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this, true);\n        this.node.off(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancelled, this, true);\n        this.node.off(cc.Node.EventType.MOUSE_WHEEL, this._onMouseWheel, this, true);\n    },\n\n    _onMouseWheel (event, captureListeners) {\n        if (!this.enabledInHierarchy) return;\n        if (this._hasNestedViewGroup(event, captureListeners)) return;\n\n        let deltaMove = cc.v2(0, 0);\n        let wheelPrecision = -0.1;\n        if(CC_JSB || CC_RUNTIME) {\n            wheelPrecision = -7;\n        }\n        if(this.vertical) {\n            deltaMove = cc.v2(0, event.getScrollY() * wheelPrecision);\n        }\n        else if(this.horizontal) {\n            deltaMove = cc.v2(event.getScrollY() * wheelPrecision, 0);\n        }\n\n        this._mouseWheelEventElapsedTime = 0;\n        this._processDeltaMove(deltaMove);\n\n        if(!this._stopMouseWheel) {\n            this._handlePressLogic();\n            this.schedule(this._checkMouseWheel, 1.0 / 60);\n            this._stopMouseWheel = true;\n        }\n\n        this._stopPropagationIfTargetIsMe(event);\n    },\n\n    _checkMouseWheel (dt) {\n        let currentOutOfBoundary = this._getHowMuchOutOfBoundary();\n        let maxElapsedTime = 0.1;\n\n        if (!currentOutOfBoundary.fuzzyEquals(cc.v2(0, 0), EPSILON)) {\n            this._processInertiaScroll();\n            this.unschedule(this._checkMouseWheel);\n            this._dispatchEvent('scroll-ended');\n            this._stopMouseWheel = false;\n            return;\n        }\n\n        this._mouseWheelEventElapsedTime += dt;\n\n        // mouse wheel event is ended\n        if (this._mouseWheelEventElapsedTime > maxElapsedTime) {\n            this._onScrollBarTouchEnded();\n            this.unschedule(this._checkMouseWheel);\n            this._dispatchEvent('scroll-ended');\n            this._stopMouseWheel = false;\n        }\n    },\n\n    _calculateMovePercentDelta (options) {\n        let anchor = options.anchor;\n        let applyToHorizontal = options.applyToHorizontal;\n        let applyToVertical = options.applyToVertical;\n        this._calculateBoundary();\n\n        anchor = anchor.clampf(cc.v2(0, 0), cc.v2(1, 1));\n\n        let scrollSize = this._view.getContentSize();\n        let contentSize = this.content.getContentSize();\n        let bottomDeta = this._getContentBottomBoundary() - this._bottomBoundary;\n        bottomDeta = -bottomDeta;\n\n        let leftDeta = this._getContentLeftBoundary() - this._leftBoundary;\n        leftDeta = -leftDeta;\n\n        let moveDelta = cc.v2(0, 0);\n        let totalScrollDelta = 0;\n        if (applyToHorizontal) {\n            totalScrollDelta = contentSize.width - scrollSize.width;\n            moveDelta.x = leftDeta - totalScrollDelta * anchor.x;\n        }\n\n        if (applyToVertical) {\n            totalScrollDelta = contentSize.height - scrollSize.height;\n            moveDelta.y = bottomDeta - totalScrollDelta * anchor.y;\n        }\n\n        return moveDelta;\n    },\n\n    _moveContentToTopLeft (scrollViewSize) {\n        let contentSize = this.content.getContentSize();\n\n        let bottomDeta = this._getContentBottomBoundary() - this._bottomBoundary;\n        bottomDeta = -bottomDeta;\n        let moveDelta = cc.v2(0, 0);\n        let totalScrollDelta = 0;\n\n        let leftDeta = this._getContentLeftBoundary() - this._leftBoundary;\n        leftDeta = -leftDeta;\n\n        if (contentSize.height < scrollViewSize.height) {\n            totalScrollDelta = contentSize.height - scrollViewSize.height;\n            moveDelta.y = bottomDeta - totalScrollDelta;\n        }\n\n        if (contentSize.width < scrollViewSize.width) {\n            totalScrollDelta = contentSize.width - scrollViewSize.width;\n            moveDelta.x = leftDeta;\n        }\n\n        this._updateScrollBarState();\n        this._moveContent(moveDelta);\n        this._adjustContentOutOfBoundary();\n    },\n\n    _calculateBoundary () {\n        if (this.content) {\n            //refresh content size\n            let layout = this.content.getComponent(cc.Layout);\n            if(layout && layout.enabledInHierarchy) {\n                layout.updateLayout();\n            }\n            let viewSize = this._view.getContentSize();\n\n            let anchorX = viewSize.width * this._view.anchorX;\n            let anchorY = viewSize.height * this._view.anchorY;\n\n            this._leftBoundary = -anchorX;\n            this._bottomBoundary = -anchorY;\n\n            this._rightBoundary = this._leftBoundary + viewSize.width;\n            this._topBoundary = this._bottomBoundary + viewSize.height;\n\n            this._moveContentToTopLeft(viewSize);\n        }\n    },\n\n    //this is for nested scrollview\n    _hasNestedViewGroup (event, captureListeners) {\n        if (event.eventPhase !== cc.Event.CAPTURING_PHASE) return;\n\n        if (captureListeners) {\n            //captureListeners are arranged from child to parent\n            for (let i = 0; i < captureListeners.length; ++i){\n                let item = captureListeners[i];\n\n                if (this.node === item) {\n                    if (event.target.getComponent(cc.ViewGroup)) {\n                        return true;\n                    }\n                    return false;\n                }\n\n                if(item.getComponent(cc.ViewGroup)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    },\n\n    //This is for Scrollview as children of a Button\n    _stopPropagationIfTargetIsMe (event) {\n        if (event.eventPhase === cc.Event.AT_TARGET && event.target === this.node) {\n            event.stopPropagation();\n        }\n    },\n\n    // touch event handler\n    _onTouchBegan (event, captureListeners) {\n        if (!this.enabledInHierarchy) return;\n        if (this._hasNestedViewGroup(event, captureListeners)) return;\n\n        let touch = event.touch;\n        if (this.content) {\n            this._handlePressLogic(touch);\n        }\n        this._touchMoved = false;\n        this._stopPropagationIfTargetIsMe(event);\n    },\n\n    _onTouchMoved (event, captureListeners) {\n        if (!this.enabledInHierarchy) return;\n        if (this._hasNestedViewGroup(event, captureListeners)) return;\n\n        let touch = event.touch;\n        if (this.content) {\n            this._handleMoveLogic(touch);\n        }\n        // Do not prevent touch events in inner nodes\n        if (!this.cancelInnerEvents) {\n            return;\n        }\n\n        let deltaMove = touch.getLocation().sub(touch.getStartLocation());\n        //FIXME: touch move delta should be calculated by DPI.\n        if (deltaMove.mag() > 7) {\n            if (!this._touchMoved && event.target !== this.node) {\n                // Simulate touch cancel for target node\n                let cancelEvent = new cc.Event.EventTouch(event.getTouches(), event.bubbles);\n                cancelEvent.type = cc.Node.EventType.TOUCH_CANCEL;\n                cancelEvent.touch = event.touch;\n                cancelEvent.simulate = true;\n                event.target.dispatchEvent(cancelEvent);\n                this._touchMoved = true;\n            }\n        }\n        this._stopPropagationIfTargetIsMe(event);\n    },\n\n    _onTouchEnded (event, captureListeners) {\n        if (!this.enabledInHierarchy) return;\n        if (this._hasNestedViewGroup(event, captureListeners)) return;\n\n        this._dispatchEvent('touch-up');\n\n        let touch = event.touch;\n        if (this.content) {\n            this._handleReleaseLogic(touch);\n        }\n        if (this._touchMoved) {\n            event.stopPropagation();\n        } else {\n            this._stopPropagationIfTargetIsMe(event);\n        }\n    },\n\n    _onTouchCancelled (event, captureListeners) {\n        if (!this.enabledInHierarchy) return;\n        if (this._hasNestedViewGroup(event, captureListeners)) return;\n\n        // Filte touch cancel event send from self\n        if (!event.simulate) {\n            let touch = event.touch;\n            if(this.content){\n                this._handleReleaseLogic(touch);\n            }\n        }\n        this._stopPropagationIfTargetIsMe(event);\n    },\n\n    _processDeltaMove (deltaMove) {\n        this._scrollChildren(deltaMove);\n        this._gatherTouchMove(deltaMove);\n    },\n\n    // Contains node angle calculations\n    _getLocalAxisAlignDelta (touch) {\n        this.node.convertToNodeSpaceAR(touch.getLocation(), _tempPoint);\n        this.node.convertToNodeSpaceAR(touch.getPreviousLocation(), _tempPrevPoint);\n        return _tempPoint.sub(_tempPrevPoint);\n    },\n\n    _handleMoveLogic (touch) {\n        let deltaMove = this._getLocalAxisAlignDelta(touch);\n        this._processDeltaMove(deltaMove);\n    },\n\n    _scrollChildren (deltaMove) {\n        deltaMove = this._clampDelta(deltaMove);\n\n        let realMove = deltaMove;\n        let outOfBoundary;\n        if (this.elastic) {\n            outOfBoundary = this._getHowMuchOutOfBoundary();\n            realMove.x *= (outOfBoundary.x === 0 ? 1 : 0.5);\n            realMove.y *= (outOfBoundary.y === 0 ? 1 : 0.5);\n        }\n\n        if (!this.elastic) {\n            outOfBoundary = this._getHowMuchOutOfBoundary(realMove);\n            realMove = realMove.add(outOfBoundary);\n        }\n\n        let scrollEventType = -1;\n\n        if (realMove.y > 0) { //up\n            let icBottomPos = this.content.y - this.content.anchorY * this.content.height;\n\n            if (icBottomPos + realMove.y >= this._bottomBoundary) {\n                scrollEventType = 'scroll-to-bottom';\n            }\n        }\n        else if (realMove.y < 0) { //down\n            let icTopPos = this.content.y - this.content.anchorY * this.content.height + this.content.height;\n\n            if (icTopPos + realMove.y <= this._topBoundary) {\n                scrollEventType = 'scroll-to-top';\n            }\n        }\n        if (realMove.x < 0) { //left\n            let icRightPos = this.content.x - this.content.anchorX * this.content.width + this.content.width;\n            if (icRightPos + realMove.x <= this._rightBoundary) {\n                scrollEventType = 'scroll-to-right';\n            }\n        }\n        else if (realMove.x > 0) { //right\n            let icLeftPos = this.content.x - this.content.anchorX * this.content.width;\n            if (icLeftPos + realMove.x >= this._leftBoundary) {\n                scrollEventType = 'scroll-to-left';\n            }\n        }\n\n        this._moveContent(realMove, false);\n\n        if (realMove.x !== 0 || realMove.y !== 0) {\n            if (!this._scrolling) {\n                this._scrolling = true;\n                this._dispatchEvent('scroll-began');\n            }\n            this._dispatchEvent('scrolling');\n        }\n\n        if (scrollEventType !== -1) {\n            this._dispatchEvent(scrollEventType);\n        }\n\n    },\n\n    _handlePressLogic () {\n        if (this._autoScrolling) {\n            this._dispatchEvent('scroll-ended');\n        }\n        this._autoScrolling = false;\n        this._isBouncing = false;\n\n        this._touchMovePreviousTimestamp = getTimeInMilliseconds();\n        this._touchMoveDisplacements.length = 0;\n        this._touchMoveTimeDeltas.length = 0;\n\n        this._onScrollBarTouchBegan();\n    },\n\n    _clampDelta (delta) {\n        let contentSize = this.content.getContentSize();\n        let scrollViewSize = this._view.getContentSize();\n        if (contentSize.width < scrollViewSize.width) {\n            delta.x = 0;\n        }\n        if (contentSize.height < scrollViewSize.height) {\n            delta.y = 0;\n        }\n\n        return delta;\n    },\n\n    _gatherTouchMove (delta) {\n        delta = this._clampDelta(delta);\n\n        while (this._touchMoveDisplacements.length >= NUMBER_OF_GATHERED_TOUCHES_FOR_MOVE_SPEED) {\n            this._touchMoveDisplacements.shift();\n            this._touchMoveTimeDeltas.shift();\n        }\n\n        this._touchMoveDisplacements.push(delta);\n\n        let timeStamp = getTimeInMilliseconds();\n        this._touchMoveTimeDeltas.push((timeStamp - this._touchMovePreviousTimestamp) / 1000);\n        this._touchMovePreviousTimestamp = timeStamp;\n    },\n\n    _startBounceBackIfNeeded () {\n        if (!this.elastic) {\n            return false;\n        }\n\n        let bounceBackAmount = this._getHowMuchOutOfBoundary();\n        bounceBackAmount = this._clampDelta(bounceBackAmount);\n\n        if (bounceBackAmount.fuzzyEquals(cc.v2(0, 0), EPSILON)) {\n            return false;\n        }\n\n        let bounceBackTime = Math.max(this.bounceDuration, 0);\n        this._startAutoScroll(bounceBackAmount, bounceBackTime, true);\n\n        if (!this._isBouncing) {\n            if (bounceBackAmount.y > 0) this._dispatchEvent('bounce-top');\n            if (bounceBackAmount.y < 0) this._dispatchEvent('bounce-bottom');\n            if (bounceBackAmount.x > 0) this._dispatchEvent('bounce-right');\n            if (bounceBackAmount.x < 0) this._dispatchEvent('bounce-left');\n            this._isBouncing = true;\n        }\n\n        return true;\n    },\n\n    _processInertiaScroll () {\n        let bounceBackStarted = this._startBounceBackIfNeeded();\n        if (!bounceBackStarted && this.inertia) {\n            let touchMoveVelocity = this._calculateTouchMoveVelocity();\n            if (!touchMoveVelocity.fuzzyEquals(cc.v2(0, 0), EPSILON) && this.brake < 1) {\n                this._startInertiaScroll(touchMoveVelocity);\n            }\n        }\n\n        this._onScrollBarTouchEnded();\n    },\n\n    _handleReleaseLogic (touch) {\n        let delta = this._getLocalAxisAlignDelta(touch);\n        this._gatherTouchMove(delta);\n        this._processInertiaScroll();\n        if (this._scrolling) {\n            this._scrolling = false;\n            if (!this._autoScrolling) {\n                this._dispatchEvent('scroll-ended');\n            }\n        }\n    },\n\n    _isOutOfBoundary () {\n        let outOfBoundary = this._getHowMuchOutOfBoundary();\n        return !outOfBoundary.fuzzyEquals(cc.v2(0, 0), EPSILON);\n    },\n\n    _isNecessaryAutoScrollBrake () {\n        if (this._autoScrollBraking) {\n            return true;\n        }\n\n        if (this._isOutOfBoundary()) {\n            if (!this._autoScrollCurrentlyOutOfBoundary) {\n                this._autoScrollCurrentlyOutOfBoundary = true;\n                this._autoScrollBraking = true;\n                this._autoScrollBrakingStartPosition = this.getContentPosition();\n                return true;\n            }\n\n        } else {\n            this._autoScrollCurrentlyOutOfBoundary = false;\n        }\n\n        return false;\n    },\n\n    getScrollEndedEventTiming () {\n        return EPSILON;\n    },\n\n    _processAutoScrolling (dt) {\n        let isAutoScrollBrake = this._isNecessaryAutoScrollBrake();\n        let brakingFactor = isAutoScrollBrake ? OUT_OF_BOUNDARY_BREAKING_FACTOR : 1;\n        this._autoScrollAccumulatedTime += dt * (1 / brakingFactor);\n\n        let percentage = Math.min(1, this._autoScrollAccumulatedTime / this._autoScrollTotalTime);\n        if (this._autoScrollAttenuate) {\n            percentage = quintEaseOut(percentage);\n        }\n\n        let newPosition = this._autoScrollStartPosition.add(this._autoScrollTargetDelta.mul(percentage));\n        let reachedEnd = Math.abs(percentage - 1) <= EPSILON;\n\n        let fireEvent = Math.abs(percentage - 1) <= this.getScrollEndedEventTiming();\n        if (fireEvent && !this._isScrollEndedWithThresholdEventFired) {\n            this._dispatchEvent('scroll-ended-with-threshold');\n            this._isScrollEndedWithThresholdEventFired = true;\n        }\n\n        if (this.elastic) {\n            let brakeOffsetPosition = newPosition.sub(this._autoScrollBrakingStartPosition);\n            if (isAutoScrollBrake) {\n                brakeOffsetPosition = brakeOffsetPosition.mul(brakingFactor);\n            }\n            newPosition = this._autoScrollBrakingStartPosition.add(brakeOffsetPosition);\n        } else {\n            let moveDelta = newPosition.sub(this.getContentPosition());\n            let outOfBoundary = this._getHowMuchOutOfBoundary(moveDelta);\n            if (!outOfBoundary.fuzzyEquals(cc.v2(0, 0), EPSILON)) {\n                newPosition = newPosition.add(outOfBoundary);\n                reachedEnd = true;\n            }\n        }\n\n        if (reachedEnd) {\n            this._autoScrolling = false;\n        }\n\n        let deltaMove = newPosition.sub(this.getContentPosition());\n        this._moveContent(this._clampDelta(deltaMove), reachedEnd);\n        this._dispatchEvent('scrolling');\n\n        // scollTo API controll move\n        if (!this._autoScrolling) {\n            this._isBouncing = false;\n            this._scrolling = false;\n            this._dispatchEvent('scroll-ended');\n        }\n    },\n\n    _startInertiaScroll (touchMoveVelocity) {\n        let inertiaTotalMovement = touchMoveVelocity.mul(MOVEMENT_FACTOR);\n        this._startAttenuatingAutoScroll(inertiaTotalMovement, touchMoveVelocity);\n    },\n\n    _calculateAttenuatedFactor (distance) {\n        if (this.brake <= 0){\n            return (1 - this.brake);\n        }\n\n        //attenuate formula from: http://learnopengl.com/#!Lighting/Light-casters\n        return (1 - this.brake) * (1 / (1 + distance * 0.000014 + distance * distance * 0.000000008));\n    },\n\n    _startAttenuatingAutoScroll (deltaMove, initialVelocity) {\n        let time = this._calculateAutoScrollTimeByInitalSpeed(initialVelocity.mag());\n\n\n        let targetDelta = deltaMove.normalize();\n        let contentSize = this.content.getContentSize();\n        let scrollviewSize = this._view.getContentSize();\n\n        let totalMoveWidth = (contentSize.width - scrollviewSize.width);\n        let totalMoveHeight = (contentSize.height - scrollviewSize.height);\n\n        let attenuatedFactorX = this._calculateAttenuatedFactor(totalMoveWidth);\n        let attenuatedFactorY = this._calculateAttenuatedFactor(totalMoveHeight);\n\n        targetDelta = cc.v2(targetDelta.x * totalMoveWidth * (1 - this.brake) * attenuatedFactorX, targetDelta.y * totalMoveHeight * attenuatedFactorY * (1 - this.brake));\n\n        let originalMoveLength = deltaMove.mag();\n        let factor = targetDelta.mag() / originalMoveLength;\n        targetDelta = targetDelta.add(deltaMove);\n\n        if (this.brake > 0 && factor > 7) {\n            factor = Math.sqrt(factor);\n            targetDelta = deltaMove.mul(factor).add(deltaMove);\n        }\n\n        if (this.brake > 0 && factor > 3) {\n            factor = 3;\n            time = time * factor;\n        }\n\n        if (this.brake === 0 && factor > 1) {\n            time = time * factor;\n        }\n\n        this._startAutoScroll(targetDelta, time, true);\n    },\n\n    _calculateAutoScrollTimeByInitalSpeed (initalSpeed) {\n        return Math.sqrt(Math.sqrt(initalSpeed / 5));\n    },\n\n    _startAutoScroll (deltaMove, timeInSecond, attenuated) {\n        let adjustedDeltaMove = this._flattenVectorByDirection(deltaMove);\n\n        this._autoScrolling = true;\n        this._autoScrollTargetDelta = adjustedDeltaMove;\n        this._autoScrollAttenuate = attenuated;\n        this._autoScrollStartPosition = this.getContentPosition();\n        this._autoScrollTotalTime = timeInSecond;\n        this._autoScrollAccumulatedTime = 0;\n        this._autoScrollBraking = false;\n        this._isScrollEndedWithThresholdEventFired = false;\n        this._autoScrollBrakingStartPosition = cc.v2(0, 0);\n\n        let currentOutOfBoundary = this._getHowMuchOutOfBoundary();\n        if (!currentOutOfBoundary.fuzzyEquals(cc.v2(0, 0), EPSILON)) {\n            this._autoScrollCurrentlyOutOfBoundary = true;\n        }\n    },\n\n    _calculateTouchMoveVelocity () {\n        let totalTime = 0;\n        totalTime = this._touchMoveTimeDeltas.reduce(function(a, b) {\n            return a + b;\n        }, totalTime);\n\n        if (totalTime <= 0 || totalTime >= 0.5) {\n            return cc.v2(0, 0);\n        }\n\n        let totalMovement = cc.v2(0, 0);\n        totalMovement = this._touchMoveDisplacements.reduce(function(a, b) {\n            return a.add(b);\n        }, totalMovement);\n\n        return cc.v2(totalMovement.x * (1 - this.brake) / totalTime,\n                    totalMovement.y * (1 - this.brake) / totalTime);\n    },\n\n    _flattenVectorByDirection (vector) {\n        let result = vector;\n        result.x = this.horizontal ? result.x : 0;\n        result.y = this.vertical ? result.y : 0;\n        return result;\n    },\n\n    _moveContent (deltaMove, canStartBounceBack) {\n        let adjustedMove = this._flattenVectorByDirection(deltaMove);\n        let newPosition = this.getContentPosition().add(adjustedMove);\n\n        this.setContentPosition(newPosition);\n\n        let outOfBoundary = this._getHowMuchOutOfBoundary();\n        this._updateScrollBar(outOfBoundary);\n\n        if (this.elastic && canStartBounceBack) {\n            this._startBounceBackIfNeeded();\n        }\n    },\n\n    _getContentLeftBoundary () {\n        let contentPos = this.getContentPosition();\n        return contentPos.x - this.content.getAnchorPoint().x * this.content.getContentSize().width;\n    },\n\n    _getContentRightBoundary () {\n        let contentSize = this.content.getContentSize();\n        return this._getContentLeftBoundary() + contentSize.width;\n    },\n\n    _getContentTopBoundary () {\n        let contentSize = this.content.getContentSize();\n        return this._getContentBottomBoundary() + contentSize.height;\n    },\n\n    _getContentBottomBoundary () {\n        let contentPos = this.getContentPosition();\n        return contentPos.y - this.content.getAnchorPoint().y * this.content.getContentSize().height;\n    },\n\n    _getHowMuchOutOfBoundary (addition) {\n        addition = addition || cc.v2(0, 0);\n        if (addition.fuzzyEquals(cc.v2(0, 0), EPSILON) && !this._outOfBoundaryAmountDirty) {\n            return this._outOfBoundaryAmount;\n        }\n\n        let outOfBoundaryAmount = cc.v2(0, 0);\n        if (this._getContentLeftBoundary() + addition.x > this._leftBoundary) {\n            outOfBoundaryAmount.x = this._leftBoundary - (this._getContentLeftBoundary() + addition.x);\n        } else if (this._getContentRightBoundary() + addition.x < this._rightBoundary) {\n            outOfBoundaryAmount.x = this._rightBoundary - (this._getContentRightBoundary() + addition.x);\n        }\n\n        if (this._getContentTopBoundary() + addition.y < this._topBoundary) {\n            outOfBoundaryAmount.y = this._topBoundary - (this._getContentTopBoundary() + addition.y);\n        } else if (this._getContentBottomBoundary() + addition.y > this._bottomBoundary) {\n            outOfBoundaryAmount.y = this._bottomBoundary - (this._getContentBottomBoundary() + addition.y);\n        }\n\n        if (addition.fuzzyEquals(cc.v2(0, 0), EPSILON)) {\n            this._outOfBoundaryAmount = outOfBoundaryAmount;\n            this._outOfBoundaryAmountDirty = false;\n        }\n\n        outOfBoundaryAmount = this._clampDelta(outOfBoundaryAmount);\n\n        return outOfBoundaryAmount;\n    },\n\n    _updateScrollBarState () {\n        if (!this.content) {\n            return;\n        }\n        let contentSize = this.content.getContentSize();\n        let scrollViewSize = this._view.getContentSize();\n        if (this.verticalScrollBar) {\n            if (contentSize.height < scrollViewSize.height) {\n                this.verticalScrollBar.hide();\n            } else {\n                this.verticalScrollBar.show();\n            }\n        }\n\n        if (this.horizontalScrollBar) {\n            if (contentSize.width < scrollViewSize.width) {\n                this.horizontalScrollBar.hide();\n            } else {\n                this.horizontalScrollBar.show();\n            }\n        }\n    },\n\n    _updateScrollBar (outOfBoundary) {\n        if (this.horizontalScrollBar) {\n            this.horizontalScrollBar._onScroll(outOfBoundary);\n        }\n\n        if (this.verticalScrollBar) {\n            this.verticalScrollBar._onScroll(outOfBoundary);\n        }\n    },\n\n    _onScrollBarTouchBegan () {\n        if (this.horizontalScrollBar) {\n            this.horizontalScrollBar._onTouchBegan();\n        }\n\n        if (this.verticalScrollBar) {\n            this.verticalScrollBar._onTouchBegan();\n        }\n    },\n\n    _onScrollBarTouchEnded () {\n        if (this.horizontalScrollBar) {\n            this.horizontalScrollBar._onTouchEnded();\n        }\n\n        if (this.verticalScrollBar) {\n            this.verticalScrollBar._onTouchEnded();\n        }\n    },\n\n    _dispatchEvent (event) {\n        if (event === 'scroll-ended') {\n            this._scrollEventEmitMask = 0;\n\n        } else if (event === 'scroll-to-top'\n                   || event === 'scroll-to-bottom'\n                   || event === 'scroll-to-left'\n                   || event === 'scroll-to-right') {\n\n            let flag = (1 << eventMap[event]);\n            if (this._scrollEventEmitMask & flag) {\n                return;\n            } else {\n                this._scrollEventEmitMask |= flag;\n            }\n        }\n\n        cc.Component.EventHandler.emitEvents(this.scrollEvents, this, eventMap[event]);\n        this.node.emit(event, this);\n    },\n\n    _adjustContentOutOfBoundary () {\n        this._outOfBoundaryAmountDirty = true;\n        if (this._isOutOfBoundary()) {\n            let outOfBoundary = this._getHowMuchOutOfBoundary(cc.v2(0, 0));\n            let newPosition = this.getContentPosition().add(outOfBoundary);\n            if (this.content) {\n                this.content.setPosition(newPosition);\n                this._updateScrollBar(0);\n            }\n        }\n    },\n\n    start () {\n        this._calculateBoundary();\n        //Because widget component will adjust content position and scrollview position is correct after visit\n        //So this event could make sure the content is on the correct position after loading.\n        if (this.content) {\n            cc.director.once(cc.Director.EVENT_BEFORE_DRAW, this._adjustContentOutOfBoundary, this);\n        }\n    },\n\n    _hideScrollbar () {\n        if (this.horizontalScrollBar) {\n            this.horizontalScrollBar.hide();\n        }\n\n        if (this.verticalScrollBar) {\n            this.verticalScrollBar.hide();\n        }\n    },\n\n    onDisable () {\n        if (!CC_EDITOR) {\n            this._unregisterEvent();\n            if (this.content) {\n                this.content.off(NodeEvent.SIZE_CHANGED, this._calculateBoundary, this);\n                this.content.off(NodeEvent.SCALE_CHANGED, this._calculateBoundary, this);\n                if (this._view) {\n                    this._view.off(NodeEvent.POSITION_CHANGED, this._calculateBoundary, this);\n                    this._view.off(NodeEvent.SCALE_CHANGED, this._calculateBoundary, this);\n                    this._view.off(NodeEvent.SIZE_CHANGED, this._calculateBoundary, this);\n                }\n            }\n        }\n        this._hideScrollbar();\n        this.stopAutoScroll();\n    },\n\n    onEnable () {\n        if (!CC_EDITOR) {\n            this._registerEvent();\n            if (this.content) {\n                this.content.on(NodeEvent.SIZE_CHANGED, this._calculateBoundary, this);\n                this.content.on(NodeEvent.SCALE_CHANGED, this._calculateBoundary, this);\n                if (this._view) {\n                    this._view.on(NodeEvent.POSITION_CHANGED, this._calculateBoundary, this);\n                    this._view.on(NodeEvent.SCALE_CHANGED, this._calculateBoundary, this);\n                    this._view.on(NodeEvent.SIZE_CHANGED, this._calculateBoundary, this);\n                }\n            }\n        }\n        this._updateScrollBarState();\n    },\n\n    update (dt) {\n        if (this._autoScrolling) {\n            this._processAutoScrolling(dt);\n        }\n    }\n});\n\ncc.ScrollView = module.exports = ScrollView;\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event scroll-to-top\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event scroll-to-bottom\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event scroll-to-left\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event scroll-to-right\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event scrolling\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event bounce-bottom\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event bounce-top\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event bounce-left\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event bounce-right\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event scroll-ended\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n\n/**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event touch-up\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n\n /**\n * !#en\n * Note: This event is emitted from the node to which the component belongs.\n * !#zh\n * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。\n * @event scroll-began\n * @param {Event.EventCustom} event\n * @param {ScrollView} scrollView - The ScrollView component.\n */\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst misc = require('../utils/misc');\nconst NodeEvent = require('../CCNode').EventType;\nconst RenderComponent = require('./CCRenderComponent');\nconst BlendFunc = require('../utils/blend-func');\n\n\n/**\n * !#en Enum for sprite type.\n * !#zh Sprite 类型\n * @enum Sprite.Type\n */\nvar SpriteType = cc.Enum({\n    /**\n     * !#en The simple type.\n     * !#zh 普通类型\n     * @property {Number} SIMPLE\n     */\n    SIMPLE: 0,\n    /**\n     * !#en The sliced type.\n     * !#zh 切片（九宫格）类型\n     * @property {Number} SLICED\n     */\n    SLICED: 1,\n    /**\n     * !#en The tiled type.\n     * !#zh 平铺类型\n     * @property {Number} TILED\n     */\n    TILED: 2,\n    /**\n     * !#en The filled type.\n     * !#zh 填充类型\n     * @property {Number} FILLED\n     */\n    FILLED: 3,\n    /**\n     * !#en The mesh type.\n     * !#zh 以 Mesh 三角形组成的类型\n     * @property {Number} MESH\n     */\n    MESH: 4\n});\n\n/**\n * !#en Enum for fill type.\n * !#zh 填充类型\n * @enum Sprite.FillType\n */\nvar FillType = cc.Enum({\n    /**\n     * !#en The horizontal fill.\n     * !#zh 水平方向填充\n     * @property {Number} HORIZONTAL\n     */\n    HORIZONTAL: 0,\n    /**\n     * !#en The vertical fill.\n     * !#zh 垂直方向填充\n     * @property {Number} VERTICAL\n     */\n    VERTICAL: 1,\n    /**\n     * !#en The radial fill.\n     * !#zh 径向填充\n     * @property {Number} RADIAL\n     */\n    RADIAL:2,\n});\n\n/**\n * !#en Sprite Size can track trimmed size, raw size or none.\n * !#zh 精灵尺寸调整模式\n * @enum Sprite.SizeMode\n */\nvar SizeMode = cc.Enum({\n    /**\n     * !#en Use the customized node size.\n     * !#zh 使用节点预设的尺寸\n     * @property {Number} CUSTOM\n     */\n    CUSTOM: 0,\n    /**\n     * !#en Match the trimmed size of the sprite frame automatically.\n     * !#zh 自动适配为精灵裁剪后的尺寸\n     * @property {Number} TRIMMED\n     */\n    TRIMMED: 1,\n    /**\n     * !#en Match the raw size of the sprite frame automatically.\n     * !#zh 自动适配为精灵原图尺寸\n     * @property {Number} RAW\n     */\n    RAW: 2\n});\n/**\n * !#en Sprite state can choice the normal or grayscale.\n * !#zh 精灵颜色通道模式。\n * @enum Sprite.State\n * @deprecated\n */\nvar State = cc.Enum({\n    /**\n     * !#en The normal state\n     * !#zh 正常状态\n     * @property {Number} NORMAL\n     */\n    NORMAL: 0,\n    /**\n     * !#en The gray state, all color will be modified to grayscale value.\n     * !#zh 灰色状态，所有颜色会被转换成灰度值\n     * @property {Number} GRAY\n     */\n    GRAY: 1\n});\n\n/**\n * !#en Renders a sprite in the scene.\n * !#zh 该组件用于在场景中渲染精灵。\n * @class Sprite\n * @extends RenderComponent\n * @uses BlendFunc\n * @example\n *  // Create a new node and add sprite components.\n *  var node = new cc.Node(\"New Sprite\");\n *  var sprite = node.addComponent(cc.Sprite);\n *  node.parent = this.node;\n */\nvar Sprite = cc.Class({\n    name: 'cc.Sprite',\n    extends: RenderComponent,\n    mixins: [BlendFunc],\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.renderers/Sprite',\n        help: 'i18n:COMPONENT.help_url.sprite',\n        inspector: 'packages://inspector/inspectors/comps/sprite.js',\n    },\n\n    properties: {\n        _spriteFrame: {\n            default: null,\n            type: cc.SpriteFrame\n        },\n        _type: SpriteType.SIMPLE,\n        _sizeMode: SizeMode.TRIMMED,\n        _fillType: 0,\n        _fillCenter: cc.v2(0,0),\n        _fillStart: 0,\n        _fillRange: 0,\n        _isTrimmedMode: true,\n        _atlas: {\n            default: null,\n            type: cc.SpriteAtlas,\n            tooltip: CC_DEV && 'i18n:COMPONENT.sprite.atlas',\n            editorOnly: true,\n            visible: true,\n            animatable: false\n        },\n\n        /**\n         * !#en The sprite frame of the sprite.\n         * !#zh 精灵的精灵帧\n         * @property spriteFrame\n         * @type {SpriteFrame}\n         * @example\n         * sprite.spriteFrame = newSpriteFrame;\n         */\n        spriteFrame: {\n            get () {\n                return this._spriteFrame;\n            },\n            set (value, force) {\n                var lastSprite = this._spriteFrame;\n                if (CC_EDITOR) {\n                    if (!force && ((lastSprite && lastSprite._uuid) === (value && value._uuid))) {\n                        return;\n                    }\n                }\n                else {\n                    if (lastSprite === value) {\n                        return;\n                    }\n                }\n                this._spriteFrame = value;\n                this._applySpriteFrame(lastSprite);\n                if (CC_EDITOR) {\n                    this.node.emit('spriteframe-changed', this);\n                }\n            },\n            type: cc.SpriteFrame,\n        },\n\n        /**\n         * !#en The sprite render type.\n         * !#zh 精灵渲染类型\n         * @property type\n         * @type {Sprite.Type}\n         * @example\n         * sprite.type = cc.Sprite.Type.SIMPLE;\n         */\n        type: {\n            get () {\n                return this._type;\n            },\n            set (value) {\n                if (this._type !== value) {\n                    this._type = value;\n                    this.setVertsDirty();\n                    this._resetAssembler();\n                }\n            },\n            type: SpriteType,\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.sprite.type',\n        },\n\n        /**\n         * !#en\n         * The fill type, This will only have any effect if the \"type\" is set to “cc.Sprite.Type.FILLED”.\n         * !#zh\n         * 精灵填充类型，仅渲染类型设置为 cc.Sprite.Type.FILLED 时有效。\n         * @property fillType\n         * @type {Sprite.FillType}\n         * @example\n         * sprite.fillType = cc.Sprite.FillType.HORIZONTAL;\n         */\n        fillType : {\n            get () {\n                return this._fillType;\n            },\n            set (value) {\n                if (value !== this._fillType) {\n                    this._fillType = value;\n                    this.setVertsDirty();\n                    this._resetAssembler();\n                }\n            },\n            type: FillType,\n            tooltip: CC_DEV && 'i18n:COMPONENT.sprite.fill_type'\n        },\n\n        /**\n         * !#en\n         * The fill Center, This will only have any effect if the \"type\" is set to “cc.Sprite.Type.FILLED”.\n         * !#zh\n         * 填充中心点，仅渲染类型设置为 cc.Sprite.Type.FILLED 时有效。\n         * @property fillCenter\n         * @type {Vec2}\n         * @example\n         * sprite.fillCenter = new cc.Vec2(0, 0);\n         */\n        fillCenter: {\n            get () {\n                return this._fillCenter;\n            },\n            set (value) {\n                this._fillCenter.x = value.x;\n                this._fillCenter.y = value.y;\n                if (this._type === SpriteType.FILLED) {\n                    this.setVertsDirty();\n                }\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.sprite.fill_center',\n        },\n\n        /**\n         * !#en\n         * The fill Start, This will only have any effect if the \"type\" is set to “cc.Sprite.Type.FILLED”.\n         * !#zh\n         * 填充起始点，仅渲染类型设置为 cc.Sprite.Type.FILLED 时有效。\n         * @property fillStart\n         * @type {Number}\n         * @example\n         * // -1 To 1 between the numbers\n         * sprite.fillStart = 0.5;\n         */\n        fillStart: {\n            get () {\n                return this._fillStart;\n            },\n            set (value) {\n                this._fillStart = misc.clampf(value, -1, 1);\n                if (this._type === SpriteType.FILLED) {\n                    this.setVertsDirty();\n                }\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.sprite.fill_start'\n        },\n\n        /**\n         * !#en\n         * The fill Range, This will only have any effect if the \"type\" is set to “cc.Sprite.Type.FILLED”.\n         * !#zh\n         * 填充范围，仅渲染类型设置为 cc.Sprite.Type.FILLED 时有效。\n         * @property fillRange\n         * @type {Number}\n         * @example\n         * // -1 To 1 between the numbers\n         * sprite.fillRange = 1;\n         */\n        fillRange: {\n            get () {\n                return this._fillRange;\n            },\n            set (value) {\n                this._fillRange = misc.clampf(value, -1, 1);\n                if (this._type === SpriteType.FILLED) {\n                    this.setVertsDirty();\n                }\n            },\n            tooltip: CC_DEV && 'i18n:COMPONENT.sprite.fill_range'\n        },\n        /**\n         * !#en specify the frame is trimmed or not.\n         * !#zh 是否使用裁剪模式\n         * @property trim\n         * @type {Boolean}\n         * @example\n         * sprite.trim = true;\n         */\n        trim: {\n            get () {\n                return this._isTrimmedMode;\n            },\n            set (value) {\n                if (this._isTrimmedMode !== value) {\n                    this._isTrimmedMode = value;\n                    if (this._type === SpriteType.SIMPLE || this._type === SpriteType.MESH) {\n                        this.setVertsDirty();\n                    }\n                }\n            },\n            animatable: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.sprite.trim'\n        },\n\n      \n        /**\n         * !#en specify the size tracing mode.\n         * !#zh 精灵尺寸调整模式\n         * @property sizeMode\n         * @type {Sprite.SizeMode}\n         * @example\n         * sprite.sizeMode = cc.Sprite.SizeMode.CUSTOM;\n         */\n        sizeMode: {\n            get () {\n                return this._sizeMode;\n            },\n            set (value) {\n                this._sizeMode = value;\n                if (value !== SizeMode.CUSTOM) {\n                    this._applySpriteSize();\n                }\n            },\n            animatable: false,\n            type: SizeMode,\n            tooltip: CC_DEV && 'i18n:COMPONENT.sprite.size_mode'\n        }\n    },\n\n    statics: {\n        FillType: FillType,\n        Type: SpriteType,\n        SizeMode: SizeMode,\n        State: State,\n    },\n\n    setVisible (visible) {\n        this.enabled = visible;\n    },\n\n    /**\n     * Change the state of sprite.\n     * @method setState\n     * @see `Sprite.State`\n     * @param state {Sprite.State} NORMAL or GRAY State.\n     * @deprecated\n     */\n    setState () {},\n\n    /**\n     * Gets the current state.\n     * @method getState\n     * @see `Sprite.State`\n     * @return {Sprite.State}\n     * @deprecated\n     */\n    getState () {},\n\n    onEnable () {\n        this._super();\n        this._applySpriteFrame();\n\n        this.node.on(cc.Node.EventType.SIZE_CHANGED, this.setVertsDirty, this);\n        this.node.on(cc.Node.EventType.ANCHOR_CHANGED, this.setVertsDirty, this);\n    },\n\n    onDisable () {\n        this._super();\n        \n        this.node.off(cc.Node.EventType.SIZE_CHANGED, this.setVertsDirty, this);\n        this.node.off(cc.Node.EventType.ANCHOR_CHANGED, this.setVertsDirty, this);\n    },\n\n    _updateMaterial () {\n        let texture = this._spriteFrame && this._spriteFrame.getTexture();\n        \n        // make sure material is belong to self.\n        let material = this.getMaterial(0);\n        material && material.setProperty('texture', texture);\n\n        BlendFunc.prototype._updateMaterial.call(this);\n    },\n\n    _applyAtlas: CC_EDITOR && function (spriteFrame) {\n        // Set atlas\n        if (spriteFrame && spriteFrame._atlasUuid) {\n            var self = this;\n            cc.AssetLibrary.loadAsset(spriteFrame._atlasUuid, function (err, asset) {\n                self._atlas = asset;\n            });\n        } else {\n            this._atlas = null;\n        }\n    },\n\n    _validateRender () {\n        let spriteFrame = this._spriteFrame;\n        if (this._materials[0] &&\n            spriteFrame && \n            spriteFrame.textureLoaded()) {\n            return;\n        }\n\n        this.disableRender();\n    },\n\n    _applySpriteSize () {\n        if (!this._spriteFrame || !this.isValid)  return;\n        \n        if (SizeMode.RAW === this._sizeMode) {\n            var size = this._spriteFrame._originalSize;\n            this.node.setContentSize(size);\n        } else if (SizeMode.TRIMMED === this._sizeMode) {\n            var rect = this._spriteFrame._rect;\n            this.node.setContentSize(rect.width, rect.height);\n        }\n        \n        this.setVertsDirty();\n    },\n\n    _applySpriteFrame (oldFrame) {\n        let oldTexture = oldFrame && oldFrame.getTexture();\n        if (oldTexture && !oldTexture.loaded) {\n            oldFrame.off('load', this._applySpriteSize, this);\n        }\n\n        let spriteFrame = this._spriteFrame;\n        if (spriteFrame) {\n            this._updateMaterial();\n            let newTexture = spriteFrame.getTexture();\n            if (oldTexture === newTexture && newTexture.loaded) {\n                this._applySpriteSize();\n            }\n            else {\n                this.disableRender();\n                spriteFrame.onTextureLoaded(this._applySpriteSize, this);\n            }\n        }\n        else {\n            this.disableRender();\n        }\n\n        if (CC_EDITOR) {\n            // Set atlas\n            this._applyAtlas(spriteFrame);\n        }\n    },\n});\n\nif (CC_EDITOR) {\n    Sprite.prototype._resizedInEditor = function () {\n        if (this._spriteFrame) {\n            var actualSize = this.node.getContentSize();\n            var expectedW = actualSize.width;\n            var expectedH = actualSize.height;\n            if (this._sizeMode === SizeMode.RAW) {\n                var size = this._spriteFrame.getOriginalSize();\n                expectedW = size.width;\n                expectedH = size.height;\n            } else if (this._sizeMode === SizeMode.TRIMMED) {\n                var rect = this._spriteFrame.getRect();\n                expectedW = rect.width;\n                expectedH = rect.height;\n\n            }\n\n            if (expectedW !== actualSize.width || expectedH !== actualSize.height) {\n                this._sizeMode = SizeMode.CUSTOM;\n            }\n        }\n    };\n\n    // override __preload\n    Sprite.prototype.__superPreload = cc.RenderComponent.prototype.__preload;\n    Sprite.prototype.__preload = function () {\n        if (this.__superPreload) this.__superPreload();\n        this.node.on(NodeEvent.SIZE_CHANGED, this._resizedInEditor, this);\n    };\n    // override onDestroy\n    Sprite.prototype.__superOnDestroy = cc.Component.prototype.onDestroy;\n    Sprite.prototype.onDestroy = function () {\n        if (this.__superOnDestroy) this.__superOnDestroy();\n        this.node.off(NodeEvent.SIZE_CHANGED, this._resizedInEditor, this);\n    };\n}\n\ncc.Sprite = module.exports = Sprite;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#en\n * Handling touch events in a ViewGroup takes special care,\n * because it's common for a ViewGroup to have children that are targets for different touch events than the ViewGroup itself.\n * To make sure that each view correctly receives the touch events intended for it,\n * ViewGroup should register capture phase event and handle the event propagation properly.\n * Please refer to Scrollview for more  information.\n *\n * !#zh\n * ViewGroup的事件处理比较特殊，因为 ViewGroup 里面的子节点关心的事件跟 ViewGroup 本身可能不一样。\n * 为了让子节点能够正确地处理事件，ViewGroup 需要注册 capture 阶段的事件，并且合理地处理 ViewGroup 之间的事件传递。\n * 请参考 ScrollView 的实现来获取更多信息。\n * @class ViewGroup\n * @extends Component\n */\nvar ViewGroup = cc.Class({\n    name: 'cc.ViewGroup',\n    extends: require('./CCComponent')\n\n});\n\n\ncc.ViewGroup = module.exports = ViewGroup;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('./CCComponent');\nrequire('./CCComponentEventHandler');\nrequire('./missing-script');\n\n// In case subContextView modules are excluded\nlet WXSubContextView = require('./WXSubContextView');\nlet SwanSubContextView = require('./SwanSubContextView');\n\nif (!WXSubContextView) {\n    WXSubContextView = cc.Class({\n        name: 'cc.WXSubContextView',\n        extends: cc.Component,\n    });\n}\n\nif (!SwanSubContextView) {\n    SwanSubContextView = cc.Class({\n        name: 'cc.SwanSubContextView',\n        extends: cc.Component,\n    });\n}\n\nvar components = [\n    require('./CCSprite'),\n    require('./CCWidget'),\n    require('./CCCanvas'),\n    require('./CCAudioSource'),\n    require('./CCAnimation'),\n    require('./CCButton'),\n    require('./CCLabel'),\n    require('./CCProgressBar'),\n    require('./CCMask'),\n    require('./CCScrollBar'),\n    require('./CCScrollView'),\n    require('./CCPageViewIndicator'),\n    require('./CCPageView'),\n    require('./CCSlider'),\n    require('./CCLayout'),\n    require('./editbox/CCEditBox'),\n    require('./CCLabelOutline'),\n    require('./CCLabelShadow'),\n    require('./CCRichText'),\n    require('./CCToggleContainer'),\n    require('./CCToggleGroup'),\n    require('./CCToggle'),\n    require('./CCBlockInputEvents'),\n    require('./CCMotionStreak'),\n    WXSubContextView,\n    SwanSubContextView,\n];\n\nmodule.exports = components;","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = cc.js;\nvar BUILTIN_CLASSID_RE = require('../utils/misc').BUILTIN_CLASSID_RE;\n\n/*\n * A temp fallback to contain the original serialized data which can not be loaded.\n */\nvar MissingClass = cc.Class({\n    name: 'cc.MissingClass',\n    properties: {\n        // the serialized data for original object\n        _$erialized: {\n            default: null,\n            visible: false,\n            editorOnly: true\n        }\n    },\n});\n\n/*\n * A temp fallback to contain the original component which can not be loaded.\n */\nvar MissingScript = cc.Class({\n    name: 'cc.MissingScript', \n    extends: cc.Component,\n    editor: {\n        inspector: 'packages://inspector/inspectors/comps/missing-script.js',\n    },\n    properties: {\n        //_scriptUuid: {\n        //    get: function () {\n        //        var id = this._$erialized.__type__;\n        //        if (Editor.Utils.UuidUtils.isUuid(id)) {\n        //            return Editor.Utils.UuidUtils.decompressUuid(id);\n        //        }\n        //        return '';\n        //    },\n        //    set: function (value) {\n        //        if ( !sandbox.compiled ) {\n        //            cc.error('Scripts not yet compiled, please fix script errors and compile first.');\n        //            return;\n        //        }\n        //        if (value && Editor.Utils.UuidUtils.isUuid(value._uuid)) {\n        //            var classId = Editor.Utils.UuidUtils.compressUuid(value);\n        //            if (cc.js._getClassById(classId)) {\n        //                this._$erialized.__type__ = classId;\n        //                Editor.Ipc.sendToWins('reload:window-scripts', sandbox.compiled);\n        //            }\n        //            else {\n        //                cc.error('Can not find a component in the script which uuid is \"%s\".', value);\n        //            }\n        //        }\n        //        else {\n        //            cc.error('invalid script');\n        //        }\n        //    }\n        //},\n        compiled: {\n            default: false,\n            serializable: false\n        },\n        // the serialized data for original script object\n        _$erialized: {\n            default: null,\n            visible: false,\n            editorOnly: true\n        }\n    },\n    ctor: CC_EDITOR && function () {\n        this.compiled = _Scene.Sandbox.compiled;\n    },\n    statics: {\n        /*\n         * @param {string} id\n         * @return {function} constructor\n         */\n        safeFindClass: function (id, data) {\n            var cls = js._getClassById(id);\n            if (cls) {\n                return cls;\n            }\n            if (id) {\n                cc.deserialize.reportMissingClass(id);\n                return MissingScript.getMissingWrapper(id, data);\n            }\n            return null;\n        },\n        getMissingWrapper: function (id, data) {\n            if (data.node && (/^[0-9a-zA-Z+/]{23}$/.test(id) || BUILTIN_CLASSID_RE.test(id))) {\n                // is component\n                return MissingScript;\n            }\n            else {\n                return MissingClass;\n            }\n        }\n    },\n    onLoad: function () {\n        cc.warnID(4600, this.node.name);\n    }\n});\n\ncc._MissingScript = module.exports = MissingScript;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = cc.js;\n\nrequire('../event/event');\n\n/**\n * !#en The mouse event\n * !#zh 鼠标事件类型\n * @class Event.EventMouse\n *\n * @extends Event\n * @param {Number} eventType - The mouse event type, UP, DOWN, MOVE, CANCELED\n * @param {Boolean} [bubbles=false] - A boolean indicating whether the event bubbles up through the tree or not\n */\nvar EventMouse = function (eventType, bubbles) {\n    cc.Event.call(this, cc.Event.MOUSE, bubbles);\n    this._eventType = eventType;\n    this._button = 0;\n    this._x = 0;\n    this._y = 0;\n    this._prevX = 0;\n    this._prevY = 0;\n    this._scrollX = 0;\n    this._scrollY = 0;\n};\n\njs.extend(EventMouse, cc.Event);\nvar proto = EventMouse.prototype;\n\n/**\n * !#en Sets scroll data.\n * !#zh 设置鼠标的滚动数据。\n * @method setScrollData\n * @param {Number} scrollX\n * @param {Number} scrollY\n */\nproto.setScrollData = function (scrollX, scrollY) {\n    this._scrollX = scrollX;\n    this._scrollY = scrollY;\n};\n\n/**\n * !#en Returns the x axis scroll value.\n * !#zh 获取鼠标滚动的X轴距离，只有滚动时才有效。\n * @method getScrollX\n * @returns {Number}\n */\nproto.getScrollX = function () {\n    return this._scrollX;\n};\n\n/**\n * !#en Returns the y axis scroll value.\n * !#zh 获取滚轮滚动的 Y 轴距离，只有滚动时才有效。\n * @method getScrollY\n * @returns {Number}\n */\nproto.getScrollY = function () {\n    return this._scrollY;\n};\n\n/**\n * !#en Sets cursor location.\n * !#zh 设置当前鼠标位置。\n * @method setLocation\n * @param {Number} x\n * @param {Number} y\n */\nproto.setLocation = function (x, y) {\n    this._x = x;\n    this._y = y;\n};\n\n/**\n * !#en Returns cursor location.\n * !#zh 获取鼠标位置对象，对象包含 x 和 y 属性。\n * @method getLocation\n * @return {Vec2} location\n */\nproto.getLocation = function () {\n    return cc.v2(this._x, this._y);\n};\n\n/**\n * !#en Returns the current cursor location in screen coordinates.\n * !#zh 获取当前事件在游戏窗口内的坐标位置对象，对象包含 x 和 y 属性。\n * @method getLocationInView\n * @return {Vec2}\n */\nproto.getLocationInView = function() {\n    return cc.v2(this._x, cc.view._designResolutionSize.height - this._y);\n};\n\nproto._setPrevCursor = function (x, y) {\n    this._prevX = x;\n    this._prevY = y;\n};\n\n/**\n * !#en Returns the previous touch location.\n * !#zh 获取鼠标点击在上一次事件时的位置对象，对象包含 x 和 y 属性。\n * @method getPreviousLocation\n * @return {Vec2}\n */\nproto.getPreviousLocation = function () {\n    return cc.v2(this._prevX, this._prevY);\n};\n\n/**\n * !#en Returns the delta distance from the previous location to current location.\n * !#zh 获取鼠标距离上一次事件移动的距离对象，对象包含 x 和 y 属性。\n * @method getDelta\n * @return {Vec2}\n */\nproto.getDelta = function () {\n    return cc.v2(this._x - this._prevX, this._y - this._prevY);\n};\n\n/**\n * !#en Returns the X axis delta distance from the previous location to current location.\n * !#zh 获取鼠标距离上一次事件移动的 X 轴距离。\n * @method getDeltaX\n * @return {Number}\n */\nproto.getDeltaX = function () {\n    return this._x - this._prevX;\n};\n\n/**\n * !#en Returns the Y axis delta distance from the previous location to current location.\n * !#zh 获取鼠标距离上一次事件移动的 Y 轴距离。\n * @method getDeltaY\n * @return {Number}\n */\nproto.getDeltaY = function () {\n    return this._y - this._prevY;\n};\n\n/**\n * !#en Sets mouse button.\n * !#zh 设置鼠标按键。\n * @method setButton\n * @param {Number} button\n */\nproto.setButton = function (button) {\n    this._button = button;\n};\n\n/**\n * !#en Returns mouse button.\n * !#zh 获取鼠标按键。\n * @method getButton\n * @returns {Number}\n */\nproto.getButton = function () {\n    return this._button;\n};\n\n/**\n * !#en Returns location X axis data.\n * !#zh 获取鼠标当前位置 X 轴。\n * @method getLocationX\n * @returns {Number}\n */\nproto.getLocationX = function () {\n    return this._x;\n};\n\n/**\n * !#en Returns location Y axis data.\n * !#zh 获取鼠标当前位置 Y 轴。\n * @method getLocationY\n * @returns {Number}\n */\nproto.getLocationY = function () {\n    return this._y;\n};\n\n//Inner event types of MouseEvent\n/**\n * !#en The none event code of mouse event.\n * !#zh 无。\n * @property NONE\n * @static\n * @type {Number}\n */\nEventMouse.NONE = 0;\n/**\n * !#en The event type code of mouse down event.\n * !#zh 鼠标按下事件。\n * @property DOWN\n * @static\n * @type {Number}\n */\nEventMouse.DOWN = 1;\n/**\n * !#en The event type code of mouse up event.\n * !#zh 鼠标按下后释放事件。\n * @property UP\n * @static\n * @type {Number}\n */\nEventMouse.UP = 2;\n/**\n * !#en The event type code of mouse move event.\n * !#zh 鼠标移动事件。\n * @property MOVE\n * @static\n * @type {Number}\n */\nEventMouse.MOVE = 3;\n/**\n * !#en The event type code of mouse scroll event.\n * !#zh 鼠标滚轮事件。\n * @property SCROLL\n * @static\n * @type {Number}\n */\nEventMouse.SCROLL = 4;\n\n/**\n * !#en The tag of Mouse left button.\n * !#zh 鼠标左键的标签。\n * @property BUTTON_LEFT\n * @static\n * @type {Number}\n */\nEventMouse.BUTTON_LEFT = 0;\n\n/**\n * !#en The tag of Mouse right button  (The right button number is 2 on browser).\n * !#zh 鼠标右键的标签。\n * @property BUTTON_RIGHT\n * @static\n * @type {Number}\n */\nEventMouse.BUTTON_RIGHT = 2;\n\n/**\n * !#en The tag of Mouse middle button  (The right button number is 1 on browser).\n * !#zh 鼠标中键的标签。\n * @property BUTTON_MIDDLE\n * @static\n * @type {Number}\n */\nEventMouse.BUTTON_MIDDLE = 1;\n\n/**\n * !#en The tag of Mouse button 4.\n * !#zh 鼠标按键 4 的标签。\n * @property BUTTON_4\n * @static\n * @type {Number}\n */\nEventMouse.BUTTON_4 = 3;\n\n/**\n * !#en The tag of Mouse button 5.\n * !#zh 鼠标按键 5 的标签。\n * @property BUTTON_5\n * @static\n * @type {Number}\n */\nEventMouse.BUTTON_5 = 4;\n\n/**\n * !#en The tag of Mouse button 6.\n * !#zh 鼠标按键 6 的标签。\n * @property BUTTON_6\n * @static\n * @type {Number}\n */\nEventMouse.BUTTON_6 = 5;\n\n/**\n * !#en The tag of Mouse button 7.\n * !#zh 鼠标按键 7 的标签。\n * @property BUTTON_7\n * @static\n * @type {Number}\n */\nEventMouse.BUTTON_7 = 6;\n\n/**\n * !#en The tag of Mouse button 8.\n * !#zh 鼠标按键 8 的标签。\n * @property BUTTON_8\n * @static\n * @type {Number}\n */\nEventMouse.BUTTON_8 = 7;\n\n/**\n * !#en The touch event\n * !#zh 触摸事件\n * @class Event.EventTouch\n * @constructor\n * @extends Event\n */\n/**\n * @method constructor\n * @param {Array} touchArr - The array of the touches\n * @param {Boolean} bubbles - A boolean indicating whether the event bubbles up through the tree or not\n */\nvar EventTouch = function (touchArr, bubbles) {\n    cc.Event.call(this, cc.Event.TOUCH, bubbles);\n    this._eventCode = 0;\n    this._touches = touchArr || [];\n    /**\n     * !#en The current touch object\n     * !#zh 当前触点对象\n     * @property touch\n     * @type {Touch}\n     */\n    this.touch = null;\n    // Actually duplicated, because of history issue, currentTouch was in the original design, touch was added in creator engine\n    // They should point to the same object\n    this.currentTouch = null;\n};\n\njs.extend(EventTouch, cc.Event);\nproto = EventTouch.prototype;\n\n/**\n * !#en Returns event code.\n * !#zh 获取事件类型。\n * @method getEventCode\n * @returns {Number}\n */\nproto.getEventCode = function () {\n    return this._eventCode;\n};\n\n/**\n * !#en Returns touches of event.\n * !#zh 获取触摸点的列表。\n * @method getTouches\n * @returns {Array}\n */\nproto.getTouches = function () {\n    return this._touches;\n};\n\nproto._setEventCode = function (eventCode) {\n    this._eventCode = eventCode;\n};\n\nproto._setTouches = function (touches) {\n    this._touches = touches;\n};\n\n/**\n * !#en Sets touch location.\n * !#zh 设置当前触点位置\n * @method setLocation\n * @param {Number} x\n * @param {Number} y\n */\nproto.setLocation = function (x, y) {\n    this.touch && this.touch.setTouchInfo(this.touch.getID(), x, y);\n};\n\n/**\n * !#en Returns touch location.\n * !#zh 获取触点位置。\n * @method getLocation\n * @return {Vec2} location\n */\nproto.getLocation = function () {\n    return this.touch ? this.touch.getLocation() : cc.v2();\n};\n\n/**\n * !#en Returns the current touch location in screen coordinates.\n * !#zh 获取当前触点在游戏窗口中的位置。\n * @method getLocationInView\n * @return {Vec2}\n */\nproto.getLocationInView = function() {\n    return this.touch ? this.touch.getLocationInView() : cc.v2();\n};\n\n/**\n * !#en Returns the previous touch location.\n * !#zh 获取触点在上一次事件时的位置对象，对象包含 x 和 y 属性。\n * @method getPreviousLocation\n * @return {Vec2}\n */\nproto.getPreviousLocation = function () {\n    return this.touch ? this.touch.getPreviousLocation() : cc.v2();\n};\n\n/**\n * !#en Returns the start touch location.\n * !#zh 获取触点落下时的位置对象，对象包含 x 和 y 属性。\n * @method getStartLocation\n * @returns {Vec2}\n */\nproto.getStartLocation = function() {\n    return this.touch ? this.touch.getStartLocation() : cc.v2();\n};\n\n/**\n * !#en Returns the id of cc.Touch.\n * !#zh 触点的标识 ID，可以用来在多点触摸中跟踪触点。\n * @method getID\n * @return {Number}\n */\nproto.getID = function () {\n    return this.touch ? this.touch.getID() : null;\n};\n\n/**\n * !#en Returns the delta distance from the previous location to current location.\n * !#zh 获取触点距离上一次事件移动的距离对象，对象包含 x 和 y 属性。\n * @method getDelta\n * @return {Vec2}\n */\nproto.getDelta = function () {\n    return this.touch ? this.touch.getDelta() : cc.v2();\n};\n\n/**\n * !#en Returns the X axis delta distance from the previous location to current location.\n * !#zh 获取触点距离上一次事件移动的 x 轴距离。\n * @method getDeltaX\n * @return {Number}\n */\nproto.getDeltaX = function () {\n    return this.touch ? this.touch.getDelta().x : 0;\n};\n\n/**\n * !#en Returns the Y axis delta distance from the previous location to current location.\n * !#zh 获取触点距离上一次事件移动的 y 轴距离。\n * @method getDeltaY\n * @return {Number}\n */\nproto.getDeltaY = function () {\n    return this.touch ? this.touch.getDelta().y : 0;\n};\n\n/**\n * !#en Returns location X axis data.\n * !#zh 获取当前触点 X 轴位置。\n * @method getLocationX\n * @returns {Number}\n */\nproto.getLocationX = function () {\n    return this.touch ? this.touch.getLocationX() : 0;\n};\n\n/**\n * !#en Returns location Y axis data.\n * !#zh 获取当前触点 Y 轴位置。\n * @method getLocationY\n * @returns {Number}\n */\nproto.getLocationY = function () {\n    return this.touch ? this.touch.getLocationY() : 0;\n};\n\n/**\n * !#en The maximum touch numbers\n * !#zh 最大触摸数量。\n * @constant\n * @type {Number}\n */\nEventTouch.MAX_TOUCHES = 5;\n\n/**\n * !#en The event type code of touch began event.\n * !#zh 开始触摸事件\n * @constant\n * @type {Number}\n */\nEventTouch.BEGAN = 0;\n/**\n * !#en The event type code of touch moved event.\n * !#zh 触摸后移动事件\n * @constant\n * @type {Number}\n */\nEventTouch.MOVED = 1;\n/**\n * !#en The event type code of touch ended event.\n * !#zh 结束触摸事件\n * @constant\n * @type {Number}\n */\nEventTouch.ENDED = 2;\n/**\n * !#en The event type code of touch cancelled event.\n * !#zh 取消触摸事件\n * @constant\n * @type {Number}\n */\nEventTouch.CANCELED = 3;\n\n/**\n * !#en The acceleration event\n * !#zh 加速度事件\n * @class Event.EventAcceleration\n * @extends Event\n *\n * @param {Object} acc - The acceleration\n * @param {Boolean} bubbles - A boolean indicating whether the event bubbles up through the tree or not\n */\nvar EventAcceleration = function (acc, bubbles) {\n    cc.Event.call(this, cc.Event.ACCELERATION, bubbles);\n    this.acc = acc;\n};\njs.extend(EventAcceleration, cc.Event);\n\n/**\n * !#en The keyboard event\n * !#zh 键盘事件\n * @class Event.EventKeyboard\n * @extends Event\n *\n * @param {Number} keyCode - The key code of which triggered this event\n * @param {Boolean} isPressed - A boolean indicating whether the key have been pressed\n * @param {Boolean} bubbles - A boolean indicating whether the event bubbles up through the tree or not\n */\nvar EventKeyboard = function (keyCode, isPressed, bubbles) {\n    cc.Event.call(this, cc.Event.KEYBOARD, bubbles);\n    /**\n     * !#en\n     * The keyCode read-only property represents a system and implementation dependent numerical code identifying the unmodified value of the pressed key.\n     * This is usually the decimal ASCII (RFC 20) or Windows 1252 code corresponding to the key.\n     * If the key can't be identified, this value is 0.\n     *\n     * !#zh\n     * keyCode 是只读属性它表示一个系统和依赖于实现的数字代码，可以识别按键的未修改值。\n     * 这通常是十进制 ASCII (RFC20) 或者 Windows 1252 代码，所对应的密钥。\n     * 如果无法识别该键，则该值为 0。\n     *\n     * @property keyCode\n     * @type {Number}\n     */\n    this.keyCode = keyCode;\n    this.isPressed = isPressed;\n};\njs.extend(EventKeyboard, cc.Event);\n\ncc.Event.EventMouse = EventMouse;\ncc.Event.EventTouch = EventTouch;\ncc.Event.EventAcceleration = EventAcceleration;\ncc.Event.EventKeyboard = EventKeyboard;\n\nmodule.exports = cc.Event;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require('../platform/js');\n\n/**\n * !#en\n * <p>\n *     The base class of event listener.                                                                        <br/>\n *     If you need custom listener which with different callback, you need to inherit this class.               <br/>\n *     For instance, you could refer to EventListenerAcceleration, EventListenerKeyboard,                       <br/>\n *      EventListenerTouchOneByOne, EventListenerCustom.\n * </p>\n *\n * !#zh\n * 封装用户的事件处理逻辑。\n * 注意：这是一个抽象类，开发者不应该直接实例化这个类，请参考 {{#crossLink \"EventListener/create:method\"}}cc.EventListener.create{{/crossLink}}。\n *\n * @class EventListener\n */\n\n/**\n * Constructor\n * @method constructor\n * @param {Number} type\n * @param {Number} listenerID\n * @param {Number} callback\n */\ncc.EventListener = function (type, listenerID, callback) {\n    this._onEvent = callback;   // Event callback function\n    this._type = type || 0;     // Event listener type\n    this._listenerID = listenerID || \"\";    // Event listener ID\n    this._registered = false;   // Whether the listener has been added to dispatcher.\n\n    this._fixedPriority = 0;    // The higher the number, the higher the priority, 0 is for scene graph base priority.\n    this._node = null;          // scene graph based priority\n    this._target = null;\n    this._paused = true;        // Whether the listener is paused\n    this._isEnabled = true;     // Whether the listener is enabled\n};\n\ncc.EventListener.prototype = {\n    constructor: cc.EventListener,\n    /*\n     * <p>\n     *     Sets paused state for the listener\n     *     The paused state is only used for scene graph priority listeners.\n     *     `EventDispatcher::resumeAllEventListenersForTarget(node)` will set the paused state to `true`,\n     *     while `EventDispatcher::pauseAllEventListenersForTarget(node)` will set it to `false`.\n     *     @note 1) Fixed priority listeners will never get paused. If a fixed priority doesn't want to receive events,\n     *              call `setEnabled(false)` instead.\n     *            2) In `Node`'s onEnter and onExit, the `paused state` of the listeners which associated with that node will be automatically updated.\n     * </p>\n     * @param {Boolean} paused\n     * @private\n     */\n    _setPaused: function (paused) {\n        this._paused = paused;\n    },\n\n    /*\n     * Checks whether the listener is paused.\n     * @returns {Boolean}\n     * @private\n     */\n    _isPaused: function () {\n        return this._paused;\n    },\n\n    /*\n     * Marks the listener was registered by EventDispatcher.\n     * @param {Boolean} registered\n     * @private\n     */\n    _setRegistered: function (registered) {\n        this._registered = registered;\n    },\n\n    /*\n     * Checks whether the listener was registered by EventDispatcher\n     * @returns {Boolean}\n     * @private\n     */\n    _isRegistered: function () {\n        return this._registered;\n    },\n\n    /*\n     * Gets the type of this listener\n     * @note It's different from `EventType`, e.g. TouchEvent has two kinds of event listeners - EventListenerOneByOne, EventListenerAllAtOnce\n     * @returns {Number}\n     * @private\n     */\n    _getType: function () {\n        return this._type;\n    },\n\n    /*\n     *  Gets the listener ID of this listener\n     *  When event is being dispatched, listener ID is used as key for searching listeners according to event type.\n     * @returns {String}\n     * @private\n     */\n    _getListenerID: function () {\n        return this._listenerID;\n    },\n\n    /*\n     * Sets the fixed priority for this listener\n     *  @note This method is only used for `fixed priority listeners`, it needs to access a non-zero value. 0 is reserved for scene graph priority listeners\n     * @param {Number} fixedPriority\n     * @private\n     */\n    _setFixedPriority: function (fixedPriority) {\n        this._fixedPriority = fixedPriority;\n    },\n\n    /*\n     * Gets the fixed priority of this listener\n     * @returns {Number} 0 if it's a scene graph priority listener, non-zero for fixed priority listener\n     * @private\n     */\n    _getFixedPriority: function () {\n        return this._fixedPriority;\n    },\n\n    /*\n     * Sets scene graph priority for this listener\n     * @param {cc.Node} node\n     * @private\n     */\n    _setSceneGraphPriority: function (node) {\n        this._target = node;\n        this._node = node;\n    },\n\n    /*\n     * Gets scene graph priority of this listener\n     * @returns {cc.Node} if it's a fixed priority listener, non-null for scene graph priority listener\n     * @private\n     */\n    _getSceneGraphPriority: function () {\n        return this._node;\n    },\n\n    /**\n     * !#en Checks whether the listener is available.\n     * !#zh 检测监听器是否有效\n     * @method checkAvailable\n     * @returns {Boolean}\n     */\n    checkAvailable: function () {\n        return this._onEvent !== null;\n    },\n\n    /**\n     * !#en Clones the listener, its subclasses have to override this method.\n     * !#zh 克隆监听器,它的子类必须重写此方法。\n     * @method clone\n     * @returns {EventListener}\n     */\n    clone: function () {\n        return null;\n    },\n\n    /**\n     *  !#en Enables or disables the listener\n     *  !#zh 启用或禁用监听器。\n     *  @method setEnabled\n     *  @param {Boolean} enabled\n     *  @note Only listeners with `enabled` state will be able to receive events.\n     *          When an listener was initialized, it's enabled by default.\n     *          An event listener can receive events when it is enabled and is not paused.\n     *          paused state is always false when it is a fixed priority listener.\n     */\n    setEnabled: function(enabled){\n        this._isEnabled = enabled;\n    },\n\n    /**\n     * !#en Checks whether the listener is enabled\n     * !#zh 检查监听器是否可用。\n     * @method isEnabled\n     * @returns {Boolean}\n     */\n    isEnabled: function(){\n        return this._isEnabled;\n    },\n\n    /*\n     * <p>Currently JavaScript Bindings (JSB), in some cases, needs to use retain and release. This is a bug in JSB,\n     * and the ugly workaround is to use retain/release. So, these 2 methods were added to be compatible with JSB.\n     * This is a hack, and should be removed once JSB fixes the retain/release bug<br/>\n     * You will need to retain an object if you created a listener and haven't added it any target node during the same frame.<br/>\n     * Otherwise, JSB's native autorelease pool will consider this object a useless one and release it directly,<br/>\n     * when you want to use it later, a \"Invalid Native Object\" error will be raised.<br/>\n     * The retain function can increase a reference count for the native object to avoid it being released,<br/>\n     * you need to manually invoke release function when you think this object is no longer needed, otherwise, there will be memory learks.<br/>\n     * retain and release function call should be paired in developer's game code.</p>\n     *\n     * @method retain\n     * @see cc.EventListener#release\n     */\n    retain:function () {\n    },\n    /*\n     * <p>Currently JavaScript Bindings (JSB), in some cases, needs to use retain and release. This is a bug in JSB,\n     * and the ugly workaround is to use retain/release. So, these 2 methods were added to be compatible with JSB.\n     * This is a hack, and should be removed once JSB fixes the retain/release bug<br/>\n     * You will need to retain an object if you created a listener and haven't added it any target node during the same frame.<br/>\n     * Otherwise, JSB's native autorelease pool will consider this object a useless one and release it directly,<br/>\n     * when you want to use it later, a \"Invalid Native Object\" error will be raised.<br/>\n     * The retain function can increase a reference count for the native object to avoid it being released,<br/>\n     * you need to manually invoke release function when you think this object is no longer needed, otherwise, there will be memory learks.<br/>\n     * retain and release function call should be paired in developer's game code.</p>\n     *\n     * @method release\n     * @see cc.EventListener#retain\n     */\n    release:function () {\n    }\n};\n\n// event listener type\n/**\n * !#en The type code of unknown event listener.\n * !#zh 未知的事件监听器类型\n * @property UNKNOWN\n * @type {Number}\n * @static\n */\ncc.EventListener.UNKNOWN = 0;\n/*\n * !#en The type code of one by one touch event listener.\n * !#zh 触摸事件监听器类型，触点会一个一个得分开被派发\n * @property TOUCH_ONE_BY_ONE\n * @type {Number}\n * @static\n */\ncc.EventListener.TOUCH_ONE_BY_ONE = 1;\n/*\n * !#en The type code of all at once touch event listener.\n * !#zh 触摸事件监听器类型，触点会被一次性全部派发\n * @property TOUCH_ALL_AT_ONCE\n * @type {Number}\n * @static\n */\ncc.EventListener.TOUCH_ALL_AT_ONCE = 2;\n/**\n * !#en The type code of keyboard event listener.\n * !#zh 键盘事件监听器类型\n * @property KEYBOARD\n * @type {Number}\n * @static\n */\ncc.EventListener.KEYBOARD = 3;\n/*\n * !#en The type code of mouse event listener.\n * !#zh 鼠标事件监听器类型\n * @property MOUSE\n * @type {Number}\n * @static\n */\ncc.EventListener.MOUSE = 4;\n/**\n * !#en The type code of acceleration event listener.\n * !#zh 加速器事件监听器类型\n * @property ACCELERATION\n * @type {Number}\n * @static\n */\ncc.EventListener.ACCELERATION = 6;\n/*\n * !#en The type code of custom event listener.\n * !#zh 自定义事件监听器类型\n * @property CUSTOM\n * @type {Number}\n * @static\n */\ncc.EventListener.CUSTOM = 8;\n\nvar ListenerID = cc.EventListener.ListenerID = {\n    MOUSE: '__cc_mouse',\n    TOUCH_ONE_BY_ONE: '__cc_touch_one_by_one',\n    TOUCH_ALL_AT_ONCE: '__cc_touch_all_at_once',\n    KEYBOARD: '__cc_keyboard',\n    ACCELERATION: '__cc_acceleration',\n};\n\nvar Custom = function (listenerId, callback) {\n    this._onCustomEvent = callback;\n    cc.EventListener.call(this, cc.EventListener.CUSTOM, listenerId, this._callback);\n};\njs.extend(Custom, cc.EventListener);\njs.mixin(Custom.prototype, {\n    _onCustomEvent: null,\n    \n    _callback: function (event) {\n        if (this._onCustomEvent !== null)\n            this._onCustomEvent(event);\n    },\n\n    checkAvailable: function () {\n        return (cc.EventListener.prototype.checkAvailable.call(this) && this._onCustomEvent !== null);\n    },\n\n    clone: function () {\n        return new Custom(this._listenerID, this._onCustomEvent);\n    }\n});\n\nvar Mouse = function () {\n    cc.EventListener.call(this, cc.EventListener.MOUSE, ListenerID.MOUSE, this._callback);\n};\njs.extend(Mouse, cc.EventListener);\njs.mixin(Mouse.prototype, {\n    onMouseDown: null,\n    onMouseUp: null,\n    onMouseMove: null,\n    onMouseScroll: null,\n\n    _callback: function (event) {\n        var eventType = cc.Event.EventMouse;\n        switch (event._eventType) {\n            case eventType.DOWN:\n                if (this.onMouseDown)\n                    this.onMouseDown(event);\n                break;\n            case eventType.UP:\n                if (this.onMouseUp)\n                    this.onMouseUp(event);\n                break;\n            case eventType.MOVE:\n                if (this.onMouseMove)\n                    this.onMouseMove(event);\n                break;\n            case eventType.SCROLL:\n                if (this.onMouseScroll)\n                    this.onMouseScroll(event);\n                break;\n            default:\n                break;\n        }\n    },\n\n    clone: function () {\n        var eventListener = new Mouse();\n        eventListener.onMouseDown = this.onMouseDown;\n        eventListener.onMouseUp = this.onMouseUp;\n        eventListener.onMouseMove = this.onMouseMove;\n        eventListener.onMouseScroll = this.onMouseScroll;\n        return eventListener;\n    },\n\n    checkAvailable: function () {\n        return true;\n    }\n});\n\nvar TouchOneByOne = function () {\n    cc.EventListener.call(this, cc.EventListener.TOUCH_ONE_BY_ONE, ListenerID.TOUCH_ONE_BY_ONE, null);\n    this._claimedTouches = [];\n};\njs.extend(TouchOneByOne, cc.EventListener);\njs.mixin(TouchOneByOne.prototype, {\n    constructor: TouchOneByOne,\n    _claimedTouches: null,\n    swallowTouches: false,\n    onTouchBegan: null,\n    onTouchMoved: null,\n    onTouchEnded: null,\n    onTouchCancelled: null,\n\n    setSwallowTouches: function (needSwallow) {\n        this.swallowTouches = needSwallow;\n    },\n\n    isSwallowTouches: function(){\n        return this.swallowTouches;\n    },\n\n    clone: function () {\n        var eventListener = new TouchOneByOne();\n        eventListener.onTouchBegan = this.onTouchBegan;\n        eventListener.onTouchMoved = this.onTouchMoved;\n        eventListener.onTouchEnded = this.onTouchEnded;\n        eventListener.onTouchCancelled = this.onTouchCancelled;\n        eventListener.swallowTouches = this.swallowTouches;\n        return eventListener;\n    },\n\n    checkAvailable: function () {\n        if(!this.onTouchBegan){\n            cc.logID(1801);\n            return false;\n        }\n        return true;\n    }\n});\n\nvar TouchAllAtOnce = function () {\n    cc.EventListener.call(this, cc.EventListener.TOUCH_ALL_AT_ONCE, ListenerID.TOUCH_ALL_AT_ONCE, null);\n};\njs.extend(TouchAllAtOnce, cc.EventListener);\njs.mixin(TouchAllAtOnce.prototype, {\n    constructor: TouchAllAtOnce,\n    onTouchesBegan: null,\n    onTouchesMoved: null,\n    onTouchesEnded: null,\n    onTouchesCancelled: null,\n\n    clone: function(){\n        var eventListener = new TouchAllAtOnce();\n        eventListener.onTouchesBegan = this.onTouchesBegan;\n        eventListener.onTouchesMoved = this.onTouchesMoved;\n        eventListener.onTouchesEnded = this.onTouchesEnded;\n        eventListener.onTouchesCancelled = this.onTouchesCancelled;\n        return eventListener;\n    },\n\n    checkAvailable: function(){\n        if (this.onTouchesBegan === null && this.onTouchesMoved === null\n            && this.onTouchesEnded === null && this.onTouchesCancelled === null) {\n            cc.logID(1802);\n            return false;\n        }\n        return true;\n    }\n});\n\n//Acceleration\nvar Acceleration = function (callback) {\n    this._onAccelerationEvent = callback;\n    cc.EventListener.call(this, cc.EventListener.ACCELERATION, ListenerID.ACCELERATION, this._callback);\n};\njs.extend(Acceleration, cc.EventListener);\njs.mixin(Acceleration.prototype, {\n    constructor: Acceleration,\n    _onAccelerationEvent: null,\n\n    _callback: function (event) {\n        this._onAccelerationEvent(event.acc, event);\n    },\n\n    checkAvailable: function () {\n        cc.assertID(this._onAccelerationEvent, 1803);\n\n        return true;\n    },\n\n    clone: function () {\n        return new Acceleration(this._onAccelerationEvent);\n    }\n});\n\n\n//Keyboard\nvar Keyboard = function () {\n    cc.EventListener.call(this, cc.EventListener.KEYBOARD, ListenerID.KEYBOARD, this._callback);\n};\njs.extend(Keyboard, cc.EventListener);\njs.mixin(Keyboard.prototype, {\n    constructor: Keyboard,\n    onKeyPressed: null,\n    onKeyReleased: null,\n\n    _callback: function (event) {\n        if (event.isPressed) {\n            if (this.onKeyPressed)\n                this.onKeyPressed(event.keyCode, event);\n        } else {\n            if (this.onKeyReleased)\n                this.onKeyReleased(event.keyCode, event);\n        }\n    },\n\n    clone: function () {\n        var eventListener = new Keyboard();\n        eventListener.onKeyPressed = this.onKeyPressed;\n        eventListener.onKeyReleased = this.onKeyReleased;\n        return eventListener;\n    },\n\n    checkAvailable: function () {\n        if (this.onKeyPressed === null && this.onKeyReleased === null) {\n            cc.logID(1800);\n            return false;\n        }\n        return true;\n    }\n});\n\n/**\n * !#en\n * Create a EventListener object with configuration including the event type, handlers and other parameters.\n * In handlers, this refer to the event listener object itself.\n * You can also pass custom parameters in the configuration object,\n * all custom parameters will be polyfilled into the event listener object and can be accessed in handlers.\n * !#zh 通过指定不同的 Event 对象来设置想要创建的事件监听器。\n * @method create\n * @param {Object} argObj a json object\n * @returns {EventListener}\n * @static\n * @example {@link cocos2d/core/event-manager/CCEventListener/create.js}\n */\ncc.EventListener.create = function (argObj) {\n    cc.assertID(argObj&&argObj.event, 1900);\n\n    var listenerType = argObj.event;\n    delete argObj.event;\n\n    var listener = null;\n    if(listenerType === cc.EventListener.TOUCH_ONE_BY_ONE)\n        listener = new TouchOneByOne();\n    else if(listenerType === cc.EventListener.TOUCH_ALL_AT_ONCE)\n        listener = new TouchAllAtOnce();\n    else if(listenerType === cc.EventListener.MOUSE)\n        listener = new Mouse();\n    else if(listenerType === cc.EventListener.CUSTOM){\n        listener = new Custom(argObj.eventName, argObj.callback);\n        delete argObj.eventName;\n        delete argObj.callback;\n    } else if(listenerType === cc.EventListener.KEYBOARD)\n        listener = new Keyboard();\n    else if(listenerType === cc.EventListener.ACCELERATION){\n        listener = new Acceleration(argObj.callback);\n        delete argObj.callback;\n    }\n\n    for(var key in argObj) {\n        listener[key] = argObj[key];\n    }\n    return listener;\n};\n\nmodule.exports = cc.EventListener;","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\nvar js = require('../platform/js');\nrequire('./CCEventListener');\nvar ListenerID = cc.EventListener.ListenerID;\n\nvar _EventListenerVector = function () {\n    this._fixedListeners = [];\n    this._sceneGraphListeners = [];\n    this.gt0Index = 0;\n};\n_EventListenerVector.prototype = {\n    constructor: _EventListenerVector,\n    size: function () {\n        return this._fixedListeners.length + this._sceneGraphListeners.length;\n    },\n\n    empty: function () {\n        return (this._fixedListeners.length === 0) && (this._sceneGraphListeners.length === 0);\n    },\n\n    push: function (listener) {\n        if (listener._getFixedPriority() === 0)\n            this._sceneGraphListeners.push(listener);\n        else\n            this._fixedListeners.push(listener);\n    },\n\n    clearSceneGraphListeners: function () {\n        this._sceneGraphListeners.length = 0;\n    },\n\n    clearFixedListeners: function () {\n        this._fixedListeners.length = 0;\n    },\n\n    clear: function () {\n        this._sceneGraphListeners.length = 0;\n        this._fixedListeners.length = 0;\n    },\n\n    getFixedPriorityListeners: function () {\n        return this._fixedListeners;\n    },\n\n    getSceneGraphPriorityListeners: function () {\n        return this._sceneGraphListeners;\n    }\n};\n\nvar __getListenerID = function (event) {\n    var eventType = cc.Event, type = event.type;\n    if (type === eventType.ACCELERATION)\n        return ListenerID.ACCELERATION;\n    if (type === eventType.KEYBOARD)\n        return ListenerID.KEYBOARD;\n    if (type.startsWith(eventType.MOUSE))\n        return ListenerID.MOUSE;\n    if (type.startsWith(eventType.TOUCH)){\n        // Touch listener is very special, it contains two kinds of listeners, EventListenerTouchOneByOne and EventListenerTouchAllAtOnce.\n        // return UNKNOWN instead.\n        cc.logID(2000);\n    }\n    return \"\";\n};\n\n/**\n * !#en\n * This class has been deprecated, please use cc.systemEvent or cc.EventTarget instead. See [Listen to and launch events](../../../manual/en/scripting/events.md) for details.<br>\n * <br>\n * cc.eventManager is a singleton object which manages event listener subscriptions and event dispatching.\n * The EventListener list is managed in such way so that event listeners can be added and removed\n * while events are being dispatched.\n *\n * !#zh\n * 该类已废弃，请使用 cc.systemEvent 或 cc.EventTarget 代替，详见 [监听和发射事件](../../../manual/zh/scripting/events.md)。<br>\n * <br>\n * 事件管理器，它主要管理事件监听器注册和派发系统事件。\n *\n * @class eventManager\n * @static\n * @example {@link cocos2d/core/event-manager/CCEventManager/addListener.js}\n * @deprecated\n */\nvar eventManager = {\n    //Priority dirty flag\n    DIRTY_NONE: 0,\n    DIRTY_FIXED_PRIORITY: 1 << 0,\n    DIRTY_SCENE_GRAPH_PRIORITY: 1 << 1,\n    DIRTY_ALL: 3,\n    \n    _listenersMap: {},\n    _priorityDirtyFlagMap: {},\n    _nodeListenersMap: {},\n    _toAddedListeners: [],\n    _toRemovedListeners: [],\n    _dirtyListeners: {},\n    _inDispatch: 0,\n    _isEnabled: false,\n    _currentTouch: null,\n\n    _internalCustomListenerIDs:[],\n\n    _setDirtyForNode: function (node) {\n        // Mark the node dirty only when there is an event listener associated with it.\n        let selListeners = this._nodeListenersMap[node._id];\n        if (selListeners !== undefined) {\n            for (let j = 0, len = selListeners.length; j < len; j++) {\n                let selListener = selListeners[j];\n                let listenerID = selListener._getListenerID();\n                if (this._dirtyListeners[listenerID] == null)\n                    this._dirtyListeners[listenerID] = true;\n            }\n        }\n        if (node.childrenCount > 0) {\n            let children = node._children;\n            for(let i = 0, len = children.length; i < len; i++)\n                this._setDirtyForNode(children[i]);\n        }\n    },\n\n    /**\n     * !#en Pauses all listeners which are associated the specified target.\n     * !#zh 暂停传入的 node 相关的所有监听器的事件响应。\n     * @method pauseTarget\n     * @param {Node} node\n     * @param {Boolean} [recursive=false]\n     */\n    pauseTarget: function (node, recursive) {\n        if (!(node instanceof cc._BaseNode)) {\n            cc.warnID(3506);\n            return;\n        }\n        var listeners = this._nodeListenersMap[node._id], i, len;\n        if (listeners) {\n            for (i = 0, len = listeners.length; i < len; i++)\n                listeners[i]._setPaused(true);\n        }\n        if (recursive === true) {\n            var locChildren = node._children;\n            for (i = 0, len = locChildren ? locChildren.length : 0; i < len; i++)\n                this.pauseTarget(locChildren[i], true);\n        }\n    },\n\n    /**\n     * !#en Resumes all listeners which are associated the specified target.\n     * !#zh 恢复传入的 node 相关的所有监听器的事件响应。\n     * @method resumeTarget\n     * @param {Node} node\n     * @param {Boolean} [recursive=false]\n     */\n    resumeTarget: function (node, recursive) {\n        if (!(node instanceof cc._BaseNode)) {\n            cc.warnID(3506);\n            return;\n        }\n        var listeners = this._nodeListenersMap[node._id], i, len;\n        if (listeners){\n            for ( i = 0, len = listeners.length; i < len; i++)\n                listeners[i]._setPaused(false);\n        }\n        this._setDirtyForNode(node);\n        if (recursive === true) {\n            var locChildren = node._children;\n            for (i = 0, len = locChildren ? locChildren.length : 0; i < len; i++)\n                this.resumeTarget(locChildren[i], true);\n        }\n    },\n\n    _addListener: function (listener) {\n        if (this._inDispatch === 0)\n            this._forceAddEventListener(listener);\n        else\n            this._toAddedListeners.push(listener);\n    },\n\n    _forceAddEventListener: function (listener) {\n        var listenerID = listener._getListenerID();\n        var listeners = this._listenersMap[listenerID];\n        if (!listeners) {\n            listeners = new _EventListenerVector();\n            this._listenersMap[listenerID] = listeners;\n        }\n        listeners.push(listener);\n\n        if (listener._getFixedPriority() === 0) {\n            this._setDirty(listenerID, this.DIRTY_SCENE_GRAPH_PRIORITY);\n\n            var node = listener._getSceneGraphPriority();\n            if (node === null)\n                cc.logID(3507);\n\n            this._associateNodeAndEventListener(node, listener);\n            if (node.activeInHierarchy)\n                this.resumeTarget(node);\n        } else\n            this._setDirty(listenerID, this.DIRTY_FIXED_PRIORITY);\n    },\n\n    _getListeners: function (listenerID) {\n        return this._listenersMap[listenerID];\n    },\n\n    _updateDirtyFlagForSceneGraph: function () {\n        let locDirtyListeners = this._dirtyListeners\n        for (var selKey in locDirtyListeners) {\n            this._setDirty(selKey, this.DIRTY_SCENE_GRAPH_PRIORITY);\n        }\n\n        this._dirtyListeners = {};\n    },\n\n    _removeAllListenersInVector: function (listenerVector) {\n        if (!listenerVector)\n            return;\n        var selListener;\n        for (var i = listenerVector.length - 1; i >= 0; i--) {\n            selListener = listenerVector[i];\n            selListener._setRegistered(false);\n            if (selListener._getSceneGraphPriority() != null) {\n                this._dissociateNodeAndEventListener(selListener._getSceneGraphPriority(), selListener);\n                selListener._setSceneGraphPriority(null);   // NULL out the node pointer so we don't have any dangling pointers to destroyed nodes.\n            }\n\n            if (this._inDispatch === 0)\n                cc.js.array.removeAt(listenerVector, i);\n        }\n    },\n\n    _removeListenersForListenerID: function (listenerID) {\n        var listeners = this._listenersMap[listenerID], i;\n        if (listeners) {\n            var fixedPriorityListeners = listeners.getFixedPriorityListeners();\n            var sceneGraphPriorityListeners = listeners.getSceneGraphPriorityListeners();\n\n            this._removeAllListenersInVector(sceneGraphPriorityListeners);\n            this._removeAllListenersInVector(fixedPriorityListeners);\n\n            // Remove the dirty flag according the 'listenerID'.\n            // No need to check whether the dispatcher is dispatching event.\n            delete this._priorityDirtyFlagMap[listenerID];\n\n            if (!this._inDispatch) {\n                listeners.clear();\n                delete this._listenersMap[listenerID];\n            }\n        }\n\n        var locToAddedListeners = this._toAddedListeners, listener;\n        for (i = locToAddedListeners.length - 1; i >= 0; i--) {\n            listener = locToAddedListeners[i];\n            if (listener && listener._getListenerID() === listenerID)\n                cc.js.array.removeAt(locToAddedListeners, i);\n        }\n    },\n\n    _sortEventListeners: function (listenerID) {\n        var dirtyFlag = this.DIRTY_NONE, locFlagMap = this._priorityDirtyFlagMap;\n        if (locFlagMap[listenerID])\n            dirtyFlag = locFlagMap[listenerID];\n        \n        if (dirtyFlag !== this.DIRTY_NONE) {\n            // Clear the dirty flag first, if `rootNode` is null, then set its dirty flag of scene graph priority\n            locFlagMap[listenerID] = this.DIRTY_NONE;\n\n            if (dirtyFlag & this.DIRTY_FIXED_PRIORITY)\n                this._sortListenersOfFixedPriority(listenerID);\n\n            if (dirtyFlag & this.DIRTY_SCENE_GRAPH_PRIORITY){\n                var rootEntity = cc.director.getScene();\n                if(rootEntity)\n                    this._sortListenersOfSceneGraphPriority(listenerID);\n            }\n        }\n    },\n\n    _sortListenersOfSceneGraphPriority: function (listenerID) {\n        var listeners = this._getListeners(listenerID);\n        if (!listeners)\n            return;\n\n        var sceneGraphListener = listeners.getSceneGraphPriorityListeners();\n        if (!sceneGraphListener || sceneGraphListener.length === 0)\n            return;\n\n        // After sort: priority < 0, > 0\n        listeners.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes);\n    },\n\n    _sortEventListenersOfSceneGraphPriorityDes: function (l1, l2) {\n        let node1 = l1._getSceneGraphPriority(),\n            node2 = l2._getSceneGraphPriority();\n\n        if (!l2 || !node2 || !node2._activeInHierarchy || node2._parent === null)\n            return -1;\n        else if (!l1 || !node1 || !node1._activeInHierarchy || node1._parent === null)\n            return 1;\n        \n        let p1 = node1, p2 = node2, ex = false;\n        while (p1._parent._id !== p2._parent._id) {\n            p1 = p1._parent._parent === null ? (ex = true) && node2 : p1._parent;\n            p2 = p2._parent._parent === null ? (ex = true) && node1 : p2._parent;\n        }\n\n        if (p1._id === p2._id) {\n            if (p1._id === node2._id) \n                return -1;\n            if (p1._id === node1._id)\n                return 1;\n        }\n\n        return ex ? p1._localZOrder - p2._localZOrder : p2._localZOrder - p1._localZOrder;\n    },\n\n    _sortListenersOfFixedPriority: function (listenerID) {\n        var listeners = this._listenersMap[listenerID];\n        if (!listeners)\n            return;\n\n        var fixedListeners = listeners.getFixedPriorityListeners();\n        if(!fixedListeners || fixedListeners.length === 0)\n            return;\n        // After sort: priority < 0, > 0\n        fixedListeners.sort(this._sortListenersOfFixedPriorityAsc);\n\n        // FIXME: Should use binary search\n        var index = 0;\n        for (var len = fixedListeners.length; index < len;) {\n            if (fixedListeners[index]._getFixedPriority() >= 0)\n                break;\n            ++index;\n        }\n        listeners.gt0Index = index;\n    },\n\n    _sortListenersOfFixedPriorityAsc: function (l1, l2) {\n        return l1._getFixedPriority() - l2._getFixedPriority();\n    },\n\n    _onUpdateListeners: function (listeners) {\n        var fixedPriorityListeners = listeners.getFixedPriorityListeners();\n        var sceneGraphPriorityListeners = listeners.getSceneGraphPriorityListeners();\n        var i, selListener, idx, toRemovedListeners = this._toRemovedListeners;\n\n        if (sceneGraphPriorityListeners) {\n            for (i = sceneGraphPriorityListeners.length - 1; i >= 0; i--) {\n                selListener = sceneGraphPriorityListeners[i];\n                if (!selListener._isRegistered()) {\n                    cc.js.array.removeAt(sceneGraphPriorityListeners, i);\n                    // if item in toRemove list, remove it from the list\n                    idx = toRemovedListeners.indexOf(selListener);\n                    if(idx !== -1)\n                        toRemovedListeners.splice(idx, 1);\n                }\n            }\n        }\n\n        if (fixedPriorityListeners) {\n            for (i = fixedPriorityListeners.length - 1; i >= 0; i--) {\n                selListener = fixedPriorityListeners[i];\n                if (!selListener._isRegistered()) {\n                    cc.js.array.removeAt(fixedPriorityListeners, i);\n                    // if item in toRemove list, remove it from the list\n                    idx = toRemovedListeners.indexOf(selListener);\n                    if(idx !== -1)\n                        toRemovedListeners.splice(idx, 1);\n                }\n            }\n        }\n\n        if (sceneGraphPriorityListeners && sceneGraphPriorityListeners.length === 0)\n            listeners.clearSceneGraphListeners();\n\n        if (fixedPriorityListeners && fixedPriorityListeners.length === 0)\n            listeners.clearFixedListeners();\n    },\n\n    frameUpdateListeners: function () {\n        var locListenersMap = this._listenersMap, locPriorityDirtyFlagMap = this._priorityDirtyFlagMap;\n        for (var selKey in locListenersMap) {\n            if (locListenersMap[selKey].empty()) {\n                delete locPriorityDirtyFlagMap[selKey];\n                delete locListenersMap[selKey];\n            }\n        }\n\n        var locToAddedListeners = this._toAddedListeners;\n        if (locToAddedListeners.length !== 0) {\n            for (var i = 0, len = locToAddedListeners.length; i < len; i++)\n                this._forceAddEventListener(locToAddedListeners[i]);\n            locToAddedListeners.length = 0;\n        }\n        if (this._toRemovedListeners.length !== 0) {\n            this._cleanToRemovedListeners();\n        }\n    },\n\n    _updateTouchListeners: function (event) {\n        var locInDispatch = this._inDispatch;\n        cc.assertID(locInDispatch > 0, 3508);\n\n        if (locInDispatch > 1)\n            return;\n\n        var listeners;\n        listeners = this._listenersMap[ListenerID.TOUCH_ONE_BY_ONE];\n        if (listeners) {\n            this._onUpdateListeners(listeners);\n        }\n        listeners = this._listenersMap[ListenerID.TOUCH_ALL_AT_ONCE];\n        if (listeners) {\n            this._onUpdateListeners(listeners);\n        }\n\n        cc.assertID(locInDispatch === 1, 3509);\n\n        var locToAddedListeners = this._toAddedListeners;\n        if (locToAddedListeners.length !== 0) {\n            for (var i = 0, len = locToAddedListeners.length; i < len; i++)\n                this._forceAddEventListener(locToAddedListeners[i]);\n            this._toAddedListeners.length = 0;\n        }\n\n        if (this._toRemovedListeners.length !== 0) {\n            this._cleanToRemovedListeners();\n        }\n    },\n\n    //Remove all listeners in _toRemoveListeners list and cleanup\n    _cleanToRemovedListeners: function () {\n        var toRemovedListeners = this._toRemovedListeners;\n        for (var i = 0; i < toRemovedListeners.length; i++) {\n            var selListener = toRemovedListeners[i];\n            var listeners = this._listenersMap[selListener._getListenerID()];\n            if (!listeners)\n                continue;\n\n            var idx, fixedPriorityListeners = listeners.getFixedPriorityListeners(),\n                sceneGraphPriorityListeners = listeners.getSceneGraphPriorityListeners();\n\n            if (sceneGraphPriorityListeners) {\n                idx = sceneGraphPriorityListeners.indexOf(selListener);\n                if (idx !== -1) {\n                    sceneGraphPriorityListeners.splice(idx, 1);\n                }\n            }\n            if (fixedPriorityListeners) {\n                idx = fixedPriorityListeners.indexOf(selListener);\n                if (idx !== -1) {\n                    fixedPriorityListeners.splice(idx, 1);\n                }\n            }\n        }\n        toRemovedListeners.length = 0;\n    },\n\n    _onTouchEventCallback: function (listener, argsObj) {\n        // Skip if the listener was removed.\n        if (!listener._isRegistered())\n            return false;\n\n        var event = argsObj.event, selTouch = event.currentTouch;\n        event.currentTarget = listener._node;\n\n        var isClaimed = false, removedIdx;\n        var getCode = event.getEventCode(), EventTouch = cc.Event.EventTouch;\n        if (getCode === EventTouch.BEGAN) {\n            if (!cc.macro.ENABLE_MULTI_TOUCH && eventManager._currentTouch) {\n                return false;\n            }\n\n            if (listener.onTouchBegan) {\n                isClaimed = listener.onTouchBegan(selTouch, event);\n                if (isClaimed && listener._registered) {\n                    listener._claimedTouches.push(selTouch);\n                    eventManager._currentTouch = selTouch;\n                }\n            }\n        } else if (listener._claimedTouches.length > 0\n            && ((removedIdx = listener._claimedTouches.indexOf(selTouch)) !== -1)) {\n            isClaimed = true;\n            \n            if (!cc.macro.ENABLE_MULTI_TOUCH && eventManager._currentTouch && eventManager._currentTouch !== selTouch) {\n                return false;\n            }\n\n            if (getCode === EventTouch.MOVED && listener.onTouchMoved) {\n                listener.onTouchMoved(selTouch, event);\n            } else if (getCode === EventTouch.ENDED) {\n                if (listener.onTouchEnded)\n                    listener.onTouchEnded(selTouch, event);\n                if (listener._registered)\n                    listener._claimedTouches.splice(removedIdx, 1);\n                eventManager._currentTouch = null;\n            } else if (getCode === EventTouch.CANCELLED) {\n                if (listener.onTouchCancelled)\n                    listener.onTouchCancelled(selTouch, event);\n                if (listener._registered)\n                    listener._claimedTouches.splice(removedIdx, 1);\n                eventManager._currentTouch = null;\n            }\n        }\n\n        // If the event was stopped, return directly.\n        if (event.isStopped()) {\n            eventManager._updateTouchListeners(event);\n            return true;\n        }\n\n        if (isClaimed && listener.swallowTouches) {\n            if (argsObj.needsMutableSet)\n                argsObj.touches.splice(selTouch, 1);\n            return true;\n        }\n        return false;\n    },\n\n    _dispatchTouchEvent: function (event) {\n        this._sortEventListeners(ListenerID.TOUCH_ONE_BY_ONE);\n        this._sortEventListeners(ListenerID.TOUCH_ALL_AT_ONCE);\n\n        var oneByOneListeners = this._getListeners(ListenerID.TOUCH_ONE_BY_ONE);\n        var allAtOnceListeners = this._getListeners(ListenerID.TOUCH_ALL_AT_ONCE);\n\n        // If there aren't any touch listeners, return directly.\n        if (null === oneByOneListeners && null === allAtOnceListeners)\n            return;\n\n        var originalTouches = event.getTouches(), mutableTouches = cc.js.array.copy(originalTouches);\n        var oneByOneArgsObj = {event: event, needsMutableSet: (oneByOneListeners && allAtOnceListeners), touches: mutableTouches, selTouch: null};\n\n        //\n        // process the target handlers 1st\n        //\n        if (oneByOneListeners) {\n            for (var i = 0; i < originalTouches.length; i++) {\n                event.currentTouch = originalTouches[i];\n                event._propagationStopped = event._propagationImmediateStopped = false;\n                this._dispatchEventToListeners(oneByOneListeners, this._onTouchEventCallback, oneByOneArgsObj);\n            }\n        }\n\n        //\n        // process standard handlers 2nd\n        //\n        if (allAtOnceListeners && mutableTouches.length > 0) {\n            this._dispatchEventToListeners(allAtOnceListeners, this._onTouchesEventCallback, {event: event, touches: mutableTouches});\n            if (event.isStopped())\n                return;\n        }\n        this._updateTouchListeners(event);\n    },\n\n    _onTouchesEventCallback: function (listener, callbackParams) {\n        // Skip if the listener was removed.\n        if (!listener._registered)\n            return false;\n\n        var EventTouch = cc.Event.EventTouch, event = callbackParams.event, touches = callbackParams.touches, getCode = event.getEventCode();\n        event.currentTarget = listener._node;\n        if (getCode === EventTouch.BEGAN && listener.onTouchesBegan)\n            listener.onTouchesBegan(touches, event);\n        else if (getCode === EventTouch.MOVED && listener.onTouchesMoved)\n            listener.onTouchesMoved(touches, event);\n        else if (getCode === EventTouch.ENDED && listener.onTouchesEnded)\n            listener.onTouchesEnded(touches, event);\n        else if (getCode === EventTouch.CANCELLED && listener.onTouchesCancelled)\n            listener.onTouchesCancelled(touches, event);\n\n        // If the event was stopped, return directly.\n        if (event.isStopped()) {\n            eventManager._updateTouchListeners(event);\n            return true;\n        }\n        return false;\n    },\n\n    _associateNodeAndEventListener: function (node, listener) {\n        var listeners = this._nodeListenersMap[node._id];\n        if (!listeners) {\n            listeners = [];\n            this._nodeListenersMap[node._id] = listeners;\n        }\n        listeners.push(listener);\n    },\n\n    _dissociateNodeAndEventListener: function (node, listener) {\n        var listeners = this._nodeListenersMap[node._id];\n        if (listeners) {\n            cc.js.array.remove(listeners, listener);\n            if (listeners.length === 0)\n                delete this._nodeListenersMap[node._id];\n        }\n    },\n\n    _dispatchEventToListeners: function (listeners, onEvent, eventOrArgs) {\n        var shouldStopPropagation = false;\n        var fixedPriorityListeners = listeners.getFixedPriorityListeners();\n        var sceneGraphPriorityListeners = listeners.getSceneGraphPriorityListeners();\n\n        var i = 0, j, selListener;\n        if (fixedPriorityListeners) {  // priority < 0\n            if (fixedPriorityListeners.length !== 0) {\n                for (; i < listeners.gt0Index; ++i) {\n                    selListener = fixedPriorityListeners[i];\n                    if (selListener.isEnabled() && !selListener._isPaused() && selListener._isRegistered() && onEvent(selListener, eventOrArgs)) {\n                        shouldStopPropagation = true;\n                        break;\n                    }\n                }\n            }\n        }\n\n        if (sceneGraphPriorityListeners && !shouldStopPropagation) {    // priority == 0, scene graph priority\n            for (j = 0; j < sceneGraphPriorityListeners.length; j++) {\n                selListener = sceneGraphPriorityListeners[j];\n                if (selListener.isEnabled() && !selListener._isPaused() && selListener._isRegistered() && onEvent(selListener, eventOrArgs)) {\n                    shouldStopPropagation = true;\n                    break;\n                }\n            }\n        }\n\n        if (fixedPriorityListeners && !shouldStopPropagation) {    // priority > 0\n            for (; i < fixedPriorityListeners.length; ++i) {\n                selListener = fixedPriorityListeners[i];\n                if (selListener.isEnabled() && !selListener._isPaused() && selListener._isRegistered() && onEvent(selListener, eventOrArgs)) {\n                    shouldStopPropagation = true;\n                    break;\n                }\n            }\n        }\n    },\n\n    _setDirty: function (listenerID, flag) {\n        var locDirtyFlagMap = this._priorityDirtyFlagMap;\n        if (locDirtyFlagMap[listenerID] == null)\n            locDirtyFlagMap[listenerID] = flag;\n        else\n            locDirtyFlagMap[listenerID] = flag | locDirtyFlagMap[listenerID];\n    },\n\n    _sortNumberAsc: function (a, b) {\n        return a - b;\n    },\n\n    /**\n     * !#en Query whether the specified event listener id has been added.\n     * !#zh 查询指定的事件 ID 是否存在\n     * @method hasEventListener\n     * @param {String|Number} listenerID - The listener id.\n     * @return {Boolean} true or false\n     */\n    hasEventListener: function (listenerID) {\n        return !!this._getListeners(listenerID);\n    },\n\n    /**\n     * !#en\n     * <p>\n     * Adds a event listener for a specified event.<br/>\n     * if the parameter \"nodeOrPriority\" is a node,\n     * it means to add a event listener for a specified event with the priority of scene graph.<br/>\n     * if the parameter \"nodeOrPriority\" is a Number,\n     * it means to add a event listener for a specified event with the fixed priority.<br/>\n     * </p>\n     * !#zh\n     * 将事件监听器添加到事件管理器中。<br/>\n     * 如果参数 “nodeOrPriority” 是节点，优先级由 node 的渲染顺序决定，显示在上层的节点将优先收到事件。<br/>\n     * 如果参数 “nodeOrPriority” 是数字，优先级则固定为该参数的数值，数字越小，优先级越高。<br/>\n     *\n     * @method addListener\n     * @param {EventListener|Object} listener - The listener of a specified event or a object of some event parameters.\n     * @param {Node|Number} nodeOrPriority - The priority of the listener is based on the draw order of this node or fixedPriority The fixed priority of the listener.\n     * @note  The priority of scene graph will be fixed value 0. So the order of listener item in the vector will be ' <0, scene graph (0 priority), >0'.\n     *         A lower priority will be called before the ones that have a higher value. 0 priority is forbidden for fixed priority since it's used for scene graph based priority.\n     *         The listener must be a cc.EventListener object when adding a fixed priority listener, because we can't remove a fixed priority listener without the listener handler,\n     *         except calls removeAllListeners().\n     * @return {EventListener} Return the listener. Needed in order to remove the event from the dispatcher.\n     */\n    addListener: function (listener, nodeOrPriority) {\n        cc.assertID(listener && nodeOrPriority, 3503);\n        if (!(cc.js.isNumber(nodeOrPriority) || nodeOrPriority instanceof cc._BaseNode)) {\n            cc.warnID(3506);\n            return;\n        }\n        if (!(listener instanceof cc.EventListener)) {\n            cc.assertID(!cc.js.isNumber(nodeOrPriority), 3504);\n            listener = cc.EventListener.create(listener);\n        } else {\n            if (listener._isRegistered()) {\n                cc.logID(3505);\n                return;\n            }\n        }\n\n        if (!listener.checkAvailable())\n            return;\n\n        if (cc.js.isNumber(nodeOrPriority)) {\n            if (nodeOrPriority === 0) {\n                cc.logID(3500);\n                return;\n            }\n\n            listener._setSceneGraphPriority(null);\n            listener._setFixedPriority(nodeOrPriority);\n            listener._setRegistered(true);\n            listener._setPaused(false);\n            this._addListener(listener);\n        } else {\n            listener._setSceneGraphPriority(nodeOrPriority);\n            listener._setFixedPriority(0);\n            listener._setRegistered(true);\n            this._addListener(listener);\n        }\n\n        return listener;\n    },\n\n    /*\n     * !#en Adds a Custom event listener. It will use a fixed priority of 1.\n     * !#zh 向事件管理器添加一个自定义事件监听器。\n     * @method addCustomListener\n     * @param {String} eventName\n     * @param {Function} callback\n     * @return {EventListener} the generated event. Needed in order to remove the event from the dispatcher\n     */\n    addCustomListener: function (eventName, callback) {\n        var listener = new cc.EventListener.create({\n            event: cc.EventListener.CUSTOM,\n            eventName: eventName, \n            callback: callback\n        });\n        this.addListener(listener, 1);\n        return listener;\n    },\n\n    /**\n     * !#en Remove a listener.\n     * !#zh 移除一个已添加的监听器。\n     * @method removeListener\n     * @param {EventListener} listener - an event listener or a registered node target\n     * @example {@link cocos2d/core/event-manager/CCEventManager/removeListener.js}\n     */\n    removeListener: function (listener) {\n        if (listener == null)\n            return;\n\n        var isFound, locListener = this._listenersMap;\n        for (var selKey in locListener) {\n            var listeners = locListener[selKey];\n            var fixedPriorityListeners = listeners.getFixedPriorityListeners(), sceneGraphPriorityListeners = listeners.getSceneGraphPriorityListeners();\n\n            isFound = this._removeListenerInVector(sceneGraphPriorityListeners, listener);\n            if (isFound){\n                // fixed #4160: Dirty flag need to be updated after listeners were removed.\n                this._setDirty(listener._getListenerID(), this.DIRTY_SCENE_GRAPH_PRIORITY);\n            }else{\n                isFound = this._removeListenerInVector(fixedPriorityListeners, listener);\n                if (isFound)\n                    this._setDirty(listener._getListenerID(), this.DIRTY_FIXED_PRIORITY);\n            }\n\n            if (listeners.empty()) {\n                delete this._priorityDirtyFlagMap[listener._getListenerID()];\n                delete locListener[selKey];\n            }\n\n            if (isFound)\n                break;\n        }\n\n        if (!isFound) {\n            var locToAddedListeners = this._toAddedListeners;\n            for (var i = locToAddedListeners.length - 1; i >= 0; i--) {\n                var selListener = locToAddedListeners[i];\n                if (selListener === listener) {\n                    cc.js.array.removeAt(locToAddedListeners, i);\n                    selListener._setRegistered(false);\n                    break;\n                }\n            }\n        }\n    },\n\n    _removeListenerInCallback: function(listeners, callback){\n        if (listeners == null)\n            return false;\n\n        for (var i = listeners.length - 1; i >= 0; i--) {\n            var selListener = listeners[i];\n            if (selListener._onCustomEvent === callback || selListener._onEvent === callback) {\n                selListener._setRegistered(false);\n                if (selListener._getSceneGraphPriority() != null){\n                    this._dissociateNodeAndEventListener(selListener._getSceneGraphPriority(), selListener);\n                    selListener._setSceneGraphPriority(null);         // NULL out the node pointer so we don't have any dangling pointers to destroyed nodes.\n                }\n\n                if (this._inDispatch === 0)\n                    cc.js.array.removeAt(listeners, i);\n                else\n                    this._toRemovedListeners.push(selListener);\n                return true;\n            }\n        }\n        return false;\n    },\n\n    _removeListenerInVector: function (listeners, listener) {\n        if (listeners == null)\n            return false;\n\n        for (var i = listeners.length - 1; i >= 0; i--) {\n            var selListener = listeners[i];\n            if (selListener === listener) {\n                selListener._setRegistered(false);\n                if (selListener._getSceneGraphPriority() != null) {\n                    this._dissociateNodeAndEventListener(selListener._getSceneGraphPriority(), selListener);\n                    selListener._setSceneGraphPriority(null);         // NULL out the node pointer so we don't have any dangling pointers to destroyed nodes.\n                }\n\n                if (this._inDispatch === 0)\n                    cc.js.array.removeAt(listeners, i);\n                else\n                    this._toRemovedListeners.push(selListener);\n                return true;\n            }\n        }\n        return false;\n    },\n\n    /**\n     * !#en Removes all listeners with the same event listener type or removes all listeners of a node.\n     * !#zh\n     * 移除注册到 eventManager 中指定类型的所有事件监听器。<br/>\n     * 1. 如果传入的第一个参数类型是 Node，那么事件管理器将移除与该对象相关的所有事件监听器。\n     * （如果第二参数 recursive 是 true 的话，就会连同该对象的子控件上所有的事件监听器也一并移除）<br/>\n     * 2. 如果传入的第一个参数类型是 Number（该类型 EventListener 中定义的事件类型），\n     * 那么事件管理器将移除该类型的所有事件监听器。<br/>\n     *\n     * 下列是目前存在监听器类型：       <br/>\n     * cc.EventListener.UNKNOWN       <br/>\n     * cc.EventListener.KEYBOARD      <br/>\n     * cc.EventListener.ACCELERATION，<br/>\n     *\n     * @method removeListeners\n     * @param {Number|Node} listenerType - listenerType or a node\n     * @param {Boolean} [recursive=false]\n     */\n    removeListeners: function (listenerType, recursive) {\n        var i, _t = this;\n        if (!(cc.js.isNumber(listenerType) || listenerType instanceof cc._BaseNode)) {\n            cc.warnID(3506);\n            return;\n        }\n        if (listenerType._id !== undefined) {\n            // Ensure the node is removed from these immediately also.\n            // Don't want any dangling pointers or the possibility of dealing with deleted objects..\n            var listeners = _t._nodeListenersMap[listenerType._id], i;\n            if (listeners) {\n                var listenersCopy = cc.js.array.copy(listeners);\n                for (i = 0; i < listenersCopy.length; i++)\n                    _t.removeListener(listenersCopy[i]);\n                delete _t._nodeListenersMap[listenerType._id];\n            }\n\n            // Bug fix: ensure there are no references to the node in the list of listeners to be added.\n            // If we find any listeners associated with the destroyed node in this list then remove them.\n            // This is to catch the scenario where the node gets destroyed before it's listener\n            // is added into the event dispatcher fully. This could happen if a node registers a listener\n            // and gets destroyed while we are dispatching an event (touch etc.)\n            var locToAddedListeners = _t._toAddedListeners;\n            for (i = 0; i < locToAddedListeners.length; ) {\n                var listener = locToAddedListeners[i];\n                if (listener._getSceneGraphPriority() === listenerType) {\n                    listener._setSceneGraphPriority(null);                      // Ensure no dangling ptr to the target node.\n                    listener._setRegistered(false);\n                    locToAddedListeners.splice(i, 1);\n                } else\n                    ++i;\n            }\n\n            if (recursive === true) {\n                var locChildren = listenerType.children, len;\n                for (i = 0, len = locChildren.length; i< len; i++)\n                    _t.removeListeners(locChildren[i], true);\n            }\n        } else {\n            if (listenerType === cc.EventListener.TOUCH_ONE_BY_ONE)\n                _t._removeListenersForListenerID(ListenerID.TOUCH_ONE_BY_ONE);\n            else if (listenerType === cc.EventListener.TOUCH_ALL_AT_ONCE)\n                _t._removeListenersForListenerID(ListenerID.TOUCH_ALL_AT_ONCE);\n            else if (listenerType === cc.EventListener.MOUSE)\n                _t._removeListenersForListenerID(ListenerID.MOUSE);\n            else if (listenerType === cc.EventListener.ACCELERATION)\n                _t._removeListenersForListenerID(ListenerID.ACCELERATION);\n            else if (listenerType === cc.EventListener.KEYBOARD)\n                _t._removeListenersForListenerID(ListenerID.KEYBOARD);\n            else\n                cc.logID(3501);\n        }\n    },\n\n    /*\n     * !#en Removes all custom listeners with the same event name.\n     * !#zh 移除同一事件名的自定义事件监听器。\n     * @method removeCustomListeners\n     * @param {String} customEventName\n     */\n    removeCustomListeners: function (customEventName) {\n        this._removeListenersForListenerID(customEventName);\n    },\n\n    /**\n     * !#en Removes all listeners\n     * !#zh 移除所有事件监听器。\n     * @method removeAllListeners\n     */\n    removeAllListeners: function () {\n        var locListeners = this._listenersMap, locInternalCustomEventIDs = this._internalCustomListenerIDs;\n        for (var selKey in locListeners){\n            if(locInternalCustomEventIDs.indexOf(selKey) === -1)\n                this._removeListenersForListenerID(selKey);\n        }\n    },\n\n    /**\n     * !#en Sets listener's priority with fixed value.\n     * !#zh 设置 FixedPriority 类型监听器的优先级。\n     * @method setPriority\n     * @param {EventListener} listener\n     * @param {Number} fixedPriority\n     */\n    setPriority: function (listener, fixedPriority) {\n        if (listener == null)\n            return;\n\n        var locListeners = this._listenersMap;\n        for (var selKey in locListeners) {\n            var selListeners = locListeners[selKey];\n            var fixedPriorityListeners = selListeners.getFixedPriorityListeners();\n            if (fixedPriorityListeners) {\n                var found = fixedPriorityListeners.indexOf(listener);\n                if (found !== -1) {\n                    if(listener._getSceneGraphPriority() != null)\n                        cc.logID(3502);\n                    if (listener._getFixedPriority() !== fixedPriority) {\n                        listener._setFixedPriority(fixedPriority);\n                        this._setDirty(listener._getListenerID(), this.DIRTY_FIXED_PRIORITY);\n                    }\n                    return;\n                }\n            }\n        }\n    },\n\n    /**\n     * !#en Whether to enable dispatching events\n     * !#zh 启用或禁用事件管理器，禁用后不会分发任何事件。\n     * @method setEnabled\n     * @param {Boolean} enabled\n     */\n    setEnabled: function (enabled) {\n        this._isEnabled = enabled;\n    },\n\n    /**\n     * !#en Checks whether dispatching events is enabled\n     * !#zh 检测事件管理器是否启用。\n     * @method isEnabled\n     * @returns {Boolean}\n     */\n    isEnabled: function () {\n        return this._isEnabled;\n    },\n\n    /*\n     * !#en Dispatches the event, also removes all EventListeners marked for deletion from the event dispatcher list.\n     * !#zh 分发事件。\n     * @method dispatchEvent\n     * @param {Event} event\n     */\n    dispatchEvent: function (event) {\n        if (!this._isEnabled)\n            return;\n\n        this._updateDirtyFlagForSceneGraph();\n        this._inDispatch++;\n        if (!event || !event.getType) {\n            cc.errorID(3511);\n            return;\n        }\n        if (event.getType().startsWith(cc.Event.TOUCH)) {\n            this._dispatchTouchEvent(event);\n            this._inDispatch--;\n            return;\n        }\n\n        var listenerID = __getListenerID(event);\n        this._sortEventListeners(listenerID);\n        var selListeners = this._listenersMap[listenerID];\n        if (selListeners != null) {\n            this._dispatchEventToListeners(selListeners, this._onListenerCallback, event);\n            this._onUpdateListeners(selListeners);\n        }\n\n        this._inDispatch--;\n    },\n\n    _onListenerCallback: function(listener, event){\n        event.currentTarget = listener._target;\n        listener._onEvent(event);\n        return event.isStopped();\n    },\n\n    /*\n     * !#en Dispatches a Custom Event with a event name an optional user data\n     * !#zh 分发自定义事件。\n     * @method dispatchCustomEvent\n     * @param {String} eventName\n     * @param {*} optionalUserData\n     */\n    dispatchCustomEvent: function (eventName, optionalUserData) {\n        var ev = new cc.Event.EventCustom(eventName);\n        ev.setUserData(optionalUserData);\n        this.dispatchEvent(ev);\n    }\n};\n\n\njs.get(cc, 'eventManager', function () {\n    cc.warnID(1405, 'cc.eventManager', 'cc.EventTarget or cc.systemEvent');\n    return eventManager;\n});\n\nmodule.exports = cc.internal.eventManager = eventManager;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#en The touch event class\n * !#zh 封装了触摸相关的信息。\n * @class Touch\n *\n * @param {Number} x\n * @param {Number} y\n * @param {Number} id\n */\ncc.Touch = function (x, y, id) {\n    this._lastModified = 0;\n    this.setTouchInfo(id, x, y);\n};\ncc.Touch.prototype = {\n    constructor: cc.Touch,\n    /**\n     * !#en Returns the current touch location in OpenGL coordinates.、\n     * !#zh 获取当前触点位置。\n     * @method getLocation\n     * @return {Vec2}\n     */\n    getLocation:function () {\n        return cc.v2(this._point.x, this._point.y);\n    },\n\n\t/**\n\t * !#en Returns X axis location value.\n     * !#zh 获取当前触点 X 轴位置。\n     * @method getLocationX\n\t * @returns {Number}\n\t */\n\tgetLocationX: function () {\n\t\treturn this._point.x;\n\t},\n\n\t/**\n     * !#en Returns Y axis location value.\n     * !#zh 获取当前触点 Y 轴位置。\n     * @method getLocationY\n\t * @returns {Number}\n\t */\n\tgetLocationY: function () {\n\t\treturn this._point.y;\n\t},\n\n    /**\n     * !#en Returns the previous touch location in OpenGL coordinates.\n     * !#zh 获取触点在上一次事件时的位置对象，对象包含 x 和 y 属性。\n     * @method getPreviousLocation\n     * @return {Vec2}\n     */\n    getPreviousLocation:function () {\n        return cc.v2(this._prevPoint.x, this._prevPoint.y);\n    },\n\n    /**\n     * !#en Returns the start touch location in OpenGL coordinates.\n     * !#zh 获取触点落下时的位置对象，对象包含 x 和 y 属性。\n     * @method getStartLocation\n     * @returns {Vec2}\n     */\n    getStartLocation: function() {\n        return cc.v2(this._startPoint.x, this._startPoint.y);\n    },\n\n    /**\n     * !#en Returns the delta distance from the previous touche to the current one in screen coordinates.\n     * !#zh 获取触点距离上一次事件移动的距离对象，对象包含 x 和 y 属性。\n     * @method getDelta\n     * @return {Vec2}\n     */\n    getDelta:function () {\n        return this._point.sub(this._prevPoint);\n    },\n\n    /**\n     * !#en Returns the current touch location in screen coordinates.\n     * !#zh 获取当前事件在游戏窗口内的坐标位置对象，对象包含 x 和 y 属性。\n     * @method getLocationInView\n     * @return {Vec2}\n     */\n    getLocationInView: function() {\n        return cc.v2(this._point.x, cc.view._designResolutionSize.height - this._point.y);\n    },\n\n    /**\n     * !#en Returns the previous touch location in screen coordinates.\n     * !#zh 获取触点在上一次事件时在游戏窗口中的位置对象，对象包含 x 和 y 属性。\n     * @method getPreviousLocationInView\n     * @return {Vec2}\n     */\n    getPreviousLocationInView: function(){\n        return cc.v2(this._prevPoint.x, cc.view._designResolutionSize.height - this._prevPoint.y);\n    },\n\n    /**\n     * !#en Returns the start touch location in screen coordinates.\n     * !#zh 获取触点落下时在游戏窗口中的位置对象，对象包含 x 和 y 属性。\n     * @method getStartLocationInView\n     * @return {Vec2}\n     */\n    getStartLocationInView: function(){\n        return cc.v2(this._startPoint.x, cc.view._designResolutionSize.height - this._startPoint.y);\n    },\n\n    /**\n     * !#en Returns the id of cc.Touch.\n     * !#zh 触点的标识 ID，可以用来在多点触摸中跟踪触点。\n     * @method getID\n     * @return {Number}\n     */\n    getID:function () {\n        return this._id;\n    },\n\n    /**\n     * !#en Sets information to touch.\n     * !#zh 设置触摸相关的信息。用于监控触摸事件。\n     * @method setTouchInfo\n     * @param {Number} id\n     * @param  {Number} x\n     * @param  {Number} y\n     */\n    setTouchInfo:function (id, x, y) {\n        this._prevPoint = this._point;\n        this._point = cc.v2(x || 0, y || 0);\n        this._id = id;\n        if(!this._startPointCaptured){\n            this._startPoint = cc.v2(this._point);\n            cc.view._convertPointWithScale(this._startPoint);\n            this._startPointCaptured = true;\n        }\n    },\n\n    _setPoint: function(x, y){\n        if(y === undefined){\n            this._point.x = x.x;\n            this._point.y = x.y;\n        }else{\n            this._point.x = x;\n            this._point.y = y;\n        }\n    },\n\n    _setPrevPoint:function (x, y) {\n        if(y === undefined)\n            this._prevPoint = cc.v2(x.x, x.y);\n        else\n            this._prevPoint = cc.v2(x || 0, y || 0);\n    }\n};","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('./CCEvent');\nrequire('./CCTouch');\nrequire('./CCEventListener');\n\nvar eventManager = require('./CCEventManager');;\n\nmodule.exports = eventManager;\n\nif (CC_TEST) {\n    cc._Test.eventManager = eventManager;\n}\n\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst js = cc.js;\nconst CallbacksInvoker = require('../platform/callbacks-invoker');\n\n// Extends CallbacksInvoker to handle and invoke event callbacks.\nfunction EventListeners () {\n    CallbacksInvoker.call(this);\n}\njs.extend(EventListeners, CallbacksInvoker);\n\nEventListeners.prototype.emit = function (event, captureListeners) {\n    let key = event.type;\n    const list = this._callbackTable[key];\n    if (list) {\n        let rootInvoker = !list.isInvoking;\n        list.isInvoking = true;\n\n        const infos = list.callbackInfos;\n        for (let i = 0, len = infos.length; i < len; ++i) {\n            const info = infos[i];\n            if (info && info.callback) {\n                info.callback.call(info.target, event, captureListeners);\n                if (event._propagationImmediateStopped) {\n                    break;\n                }\n            }\n        }\n\n        if (rootInvoker) {\n            list.isInvoking = false;\n            if (list.containCanceled) {\n                list.purgeCanceled();\n            }\n        }\n    }\n};\n\nmodule.exports = EventListeners;\nif (CC_TEST) {\n    cc._Test.EventListeners = EventListeners;\n}\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst js = require('../platform/js');\nconst CallbacksInvoker = require('../platform/callbacks-invoker');\n\nvar fastRemove = js.array.fastRemove;\n\n/**\n * !#en\n * EventTarget is an object to which an event is dispatched when something has occurred.\n * Entity are the most common event targets, but other objects can be event targets too.\n *\n * Event targets are an important part of the Fireball event model.\n * The event target serves as the focal point for how events flow through the scene graph.\n * When an event such as a mouse click or a keypress occurs, Fireball dispatches an event object\n * into the event flow from the root of the hierarchy. The event object then makes its way through\n * the scene graph until it reaches the event target, at which point it begins its return trip through\n * the scene graph. This round-trip journey to the event target is conceptually divided into three phases:\n * - The capture phase comprises the journey from the root to the last node before the event target's node\n * - The target phase comprises only the event target node\n * - The bubbling phase comprises any subsequent nodes encountered on the return trip to the root of the tree\n * See also: http://www.w3.org/TR/DOM-Level-3-Events/#event-flow\n *\n * Event targets can implement the following methods:\n *  - _getCapturingTargets\n *  - _getBubblingTargets\n *\n * !#zh\n * 事件目标是事件触发时，分派的事件对象，Node 是最常见的事件目标，\n * 但是其他对象也可以是事件目标。<br/>\n *\n * @class EventTarget\n * @extends CallbacksInvoker\n */\nfunction EventTarget () {\n    CallbacksInvoker.call(this);\n}\njs.extend(EventTarget, CallbacksInvoker);\n\nvar proto = EventTarget.prototype;\n\n/**\n * !#en Checks whether the EventTarget object has any callback registered for a specific type of event.\n * !#zh 检查事件目标对象是否有为特定类型的事件注册的回调。\n * @method hasEventListener\n * @param {String} type - The type of event.\n * @return {Boolean} True if a callback of the specified type is registered; false otherwise.\n */\n\n/**\n * !#en\n * Register an callback of a specific event type on the EventTarget.\n * This type of event should be triggered via `emit`.\n * !#zh\n * 注册事件目标的特定事件类型回调。这种类型的事件应该被 `emit` 触发。\n *\n * @method on\n * @param {String} type - A string representing the event type to listen for.\n * @param {Function} callback - The callback that will be invoked when the event is dispatched.\n *                              The callback is ignored if it is a duplicate (the callbacks are unique).\n * @param {any} [callback.arg1] arg1\n * @param {any} [callback.arg2] arg2\n * @param {any} [callback.arg3] arg3\n * @param {any} [callback.arg4] arg4\n * @param {any} [callback.arg5] arg5\n * @param {Object} [target] - The target (this object) to invoke the callback, can be null\n * @return {Function} - Just returns the incoming callback so you can save the anonymous function easier.\n * @typescript\n * on<T extends Function>(type: string, callback: T, target?: any, useCapture?: boolean): T\n * @example\n * eventTarget.on('fire', function () {\n *     cc.log(\"fire in the hole\");\n * }, node);\n */\nproto.__on = proto.on;\nproto.on = function (type, callback, target, once) {\n    if (!callback) {\n        cc.errorID(6800);\n        return;\n    }\n\n    if ( !this.hasEventListener(type, callback, target) ) {\n        this.__on(type, callback, target, once);\n\n        if (target && target.__eventTargets) {\n            target.__eventTargets.push(this);\n        }\n    }\n    return callback;\n};\n\n/**\n * !#en\n * Removes the listeners previously registered with the same type, callback, target and or useCapture,\n * if only type is passed as parameter, all listeners registered with that type will be removed.\n * !#zh\n * 删除之前用同类型，回调，目标或 useCapture 注册的事件监听器，如果只传递 type，将会删除 type 类型的所有事件监听器。\n *\n * @method off\n * @param {String} type - A string representing the event type being removed.\n * @param {Function} [callback] - The callback to remove.\n * @param {Object} [target] - The target (this object) to invoke the callback, if it's not given, only callback without target will be removed\n * @example\n * // register fire eventListener\n * var callback = eventTarget.on('fire', function () {\n *     cc.log(\"fire in the hole\");\n * }, target);\n * // remove fire event listener\n * eventTarget.off('fire', callback, target);\n * // remove all fire event listeners\n * eventTarget.off('fire');\n */\nproto.__off = proto.off;\nproto.off = function (type, callback, target) {\n    if (!callback) {\n        let list = this._callbackTable[type];\n        if (!list) return;\n        let infos = list.callbackInfos;\n        for (let i = 0; i < infos.length; ++i) {\n            let target = infos[i] && infos[i].target;\n            if (target && target.__eventTargets) {\n                fastRemove(target.__eventTargets, this);\n            }\n        }\n        this.removeAll(type);\n    }\n    else {\n        this.__off(type, callback, target);\n\n        if (target && target.__eventTargets) {\n            fastRemove(target.__eventTargets, this);\n        }\n    }\n};\n\n/**\n * !#en Removes all callbacks previously registered with the same target (passed as parameter).\n * This is not for removing all listeners in the current event target,\n * and this is not for removing all listeners the target parameter have registered.\n * It's only for removing all listeners (callback and target couple) registered on the current event target by the target parameter.\n * !#zh 在当前 EventTarget 上删除指定目标（target 参数）注册的所有事件监听器。\n * 这个函数无法删除当前 EventTarget 的所有事件监听器，也无法删除 target 参数所注册的所有事件监听器。\n * 这个函数只能删除 target 参数在当前 EventTarget 上注册的所有事件监听器。\n * @method targetOff\n * @param {Object} target - The target to be searched for all related listeners\n */\nproto.targetOff = function (target) {\n    this.removeAll(target);\n    \n    if (target && target.__eventTargets) {\n        fastRemove(target.__eventTargets, this);\n    }\n};\n\n/**\n * !#en\n * Register an callback of a specific event type on the EventTarget,\n * the callback will remove itself after the first time it is triggered.\n * !#zh\n * 注册事件目标的特定事件类型回调，回调会在第一时间被触发后删除自身。\n *\n * @method once\n * @param {String} type - A string representing the event type to listen for.\n * @param {Function} callback - The callback that will be invoked when the event is dispatched.\n *                              The callback is ignored if it is a duplicate (the callbacks are unique).\n * @param {any} [callback.arg1] arg1\n * @param {any} [callback.arg2] arg2\n * @param {any} [callback.arg3] arg3\n * @param {any} [callback.arg4] arg4\n * @param {any} [callback.arg5] arg5\n * @param {Object} [target] - The target (this object) to invoke the callback, can be null\n * @example\n * eventTarget.once('fire', function () {\n *     cc.log(\"this is the callback and will be invoked only once\");\n * }, node);\n */\nproto.once = function (type, callback, target) {\n    this.on(type, callback, target, true);\n};\n\n/**\n * !#en\n * Send an event with the event object.\n * !#zh\n * 通过事件对象派发事件\n *\n * @method dispatchEvent\n * @param {Event} event\n */\nproto.dispatchEvent = function (event) {\n    this.emit(event.type, event);\n};\n\ncc.EventTarget = module.exports = EventTarget;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require(\"../platform/js\");\n\n/**\n * !#en Base class of all kinds of events.\n * !#zh 包含事件相关信息的对象。\n * @class Event\n */\n\n/**\n * @method constructor\n * @param {String} type - The name of the event (case-sensitive), e.g. \"click\", \"fire\", or \"submit\"\n * @param {Boolean} bubbles - A boolean indicating whether the event bubbles up through the tree or not\n */\ncc.Event = function(type, bubbles) {\n    /**\n     * !#en The name of the event (case-sensitive), e.g. \"click\", \"fire\", or \"submit\".\n     * !#zh 事件类型。\n     * @property type\n     * @type {String}\n     */\n    this.type = type;\n\n    /**\n     * !#en Indicate whether the event bubbles up through the tree or not.\n     * !#zh 表示该事件是否进行冒泡。\n     * @property bubbles\n     * @type {Boolean}\n     */\n    this.bubbles = !!bubbles;\n\n    /**\n     * !#en A reference to the target to which the event was originally dispatched.\n     * !#zh 最初事件触发的目标\n     * @property target\n     * @type {Object}\n     */\n    this.target = null;\n\n    /**\n     * !#en A reference to the currently registered target for the event.\n     * !#zh 当前目标\n     * @property currentTarget\n     * @type {Object}\n     */\n    this.currentTarget = null;\n\n    /**\n     * !#en\n     * Indicates which phase of the event flow is currently being evaluated.\n     * Returns an integer value represented by 4 constants:\n     *  - Event.NONE = 0\n     *  - Event.CAPTURING_PHASE = 1\n     *  - Event.AT_TARGET = 2\n     *  - Event.BUBBLING_PHASE = 3\n     * The phases are explained in the [section 3.1, Event dispatch and DOM event flow]\n     * (http://www.w3.org/TR/DOM-Level-3-Events/#event-flow), of the DOM Level 3 Events specification.\n     * !#zh 事件阶段\n     * @property eventPhase\n     * @type {Number}\n     */\n    this.eventPhase = 0;\n\n    /*\n     * Indicates whether or not event.stopPropagation() has been called on the event.\n     * @property _propagationStopped\n     * @type {Boolean}\n     * @private\n     */\n    this._propagationStopped = false;\n\n    /*\n     * Indicates whether or not event.stopPropagationImmediate() has been called on the event.\n     * @property _propagationImmediateStopped\n     * @type {Boolean}\n     * @private\n     */\n    this._propagationImmediateStopped = false;\n};\ncc.Event.prototype = {\n    constructor: cc.Event,\n\n    /**\n     * !#en Reset the event for being stored in the object pool.\n     * !#zh 重置对象池中存储的事件。\n     * @method unuse\n     * @returns {String}\n     */\n    unuse: function () {\n        this.type = cc.Event.NO_TYPE;\n        this.target = null;\n        this.currentTarget = null;\n        this.eventPhase = cc.Event.NONE;\n        this._propagationStopped = false;\n        this._propagationImmediateStopped = false;\n    },\n\n    /**\n     * !#en Reuse the event for being used again by the object pool.\n     * !#zh 用于对象池再次使用的事件。\n     * @method reuse\n     * @returns {String}\n     */\n    reuse: function (type, bubbles) {\n        this.type = type;\n        this.bubbles = bubbles || false;\n    },\n\n    /**\n     * !#en Stops propagation for current event.\n     * !#zh 停止传递当前事件。\n     * @method stopPropagation\n     */\n    stopPropagation: function () {\n        this._propagationStopped = true;\n    },\n\n    /**\n     * !#en Stops propagation for current event immediately,\n     * the event won't even be dispatched to the listeners attached in the current target.\n     * !#zh 立即停止当前事件的传递，事件甚至不会被分派到所连接的当前目标。\n     * @method stopPropagationImmediate\n     */\n    stopPropagationImmediate: function () {\n        this._propagationImmediateStopped = true;\n    },\n\n    /**\n     * !#en Checks whether the event has been stopped.\n     * !#zh 检查该事件是否已经停止传递.\n     * @method isStopped\n     * @returns {Boolean}\n     */\n    isStopped: function () {\n        return this._propagationStopped || this._propagationImmediateStopped;\n    },\n\n    /**\n     * !#en\n     * <p>\n     *     Gets current target of the event                                                            <br/>\n     *     note: It only be available when the event listener is associated with node.                <br/>\n     *          It returns 0 when the listener is associated with fixed priority.\n     * </p>\n     * !#zh 获取当前目标节点\n     * @method getCurrentTarget\n     * @returns {Node}  The target with which the event associates.\n     */\n    getCurrentTarget: function () {\n        return this.currentTarget;\n    },\n\n    /**\n     * !#en Gets the event type.\n     * !#zh 获取事件类型\n     * @method getType\n     * @returns {String}\n     */\n    getType: function () {\n        return this.type;\n    }\n};\n\n//event type\n/**\n * !#en Code for event without type.\n * !#zh 没有类型的事件\n * @property NO_TYPE\n * @static\n * @type {string}\n */\ncc.Event.NO_TYPE = 'no_type';\n\n/**\n * !#en The type code of Touch event.\n * !#zh 触摸事件类型\n * @property TOUCH\n * @static\n * @type {String}\n */\ncc.Event.TOUCH = 'touch';\n/**\n * !#en The type code of Mouse event.\n * !#zh 鼠标事件类型\n * @property MOUSE\n * @static\n * @type {String}\n */\ncc.Event.MOUSE = 'mouse';\n/**\n * !#en The type code of Keyboard event.\n * !#zh 键盘事件类型\n * @property KEYBOARD\n * @static\n * @type {String}\n */\ncc.Event.KEYBOARD = 'keyboard';\n/**\n * !#en The type code of Acceleration event.\n * !#zh 加速器事件类型\n * @property ACCELERATION\n * @static\n * @type {String}\n */\ncc.Event.ACCELERATION = 'acceleration';\n\n//event phase\n/**\n * !#en Events not currently dispatched are in this phase\n * !#zh 尚未派发事件阶段\n * @property NONE\n * @type {Number}\n * @static\n */\ncc.Event.NONE = 0;\n/**\n * !#en\n * The capturing phase comprises the journey from the root to the last node before the event target's node\n * see http://www.w3.org/TR/DOM-Level-3-Events/#event-flow\n * !#zh 捕获阶段，包括事件目标节点之前从根节点到最后一个节点的过程。\n * @property CAPTURING_PHASE\n * @type {Number}\n * @static\n */\ncc.Event.CAPTURING_PHASE = 1;\n/**\n * !#en\n * The target phase comprises only the event target node\n * see http://www.w3.org/TR/DOM-Level-3-Events/#event-flow\n * !#zh 目标阶段仅包括事件目标节点。\n * @property AT_TARGET\n * @type {Number}\n * @static\n */\ncc.Event.AT_TARGET = 2;\n/**\n * !#en\n * The bubbling phase comprises any subsequent nodes encountered on the return trip to the root of the hierarchy\n * see http://www.w3.org/TR/DOM-Level-3-Events/#event-flow\n * !#zh 冒泡阶段， 包括回程遇到到层次根节点的任何后续节点。\n * @property BUBBLING_PHASE\n * @type {Number}\n * @static\n */\ncc.Event.BUBBLING_PHASE = 3;\n\n/**\n * !#en The Custom event\n * !#zh 自定义事件\n * @class Event.EventCustom\n *\n * @extends Event\n */\n\n/**\n * @method constructor\n * @param {String} type - The name of the event (case-sensitive), e.g. \"click\", \"fire\", or \"submit\"\n * @param {Boolean} bubbles - A boolean indicating whether the event bubbles up through the tree or not\n */\nvar EventCustom = function (type, bubbles) {\n    cc.Event.call(this, type, bubbles);\n\n    /**\n     * !#en A reference to the detailed data of the event\n     * !#zh 事件的详细数据\n     * @property detail\n     * @type {Object}\n     */\n    this.detail = null;\n};\n\njs.extend(EventCustom, cc.Event);\n\nEventCustom.prototype.reset = EventCustom;\n\n/**\n * !#en Sets user data\n * !#zh 设置用户数据\n * @method setUserData\n * @param {*} data\n */\nEventCustom.prototype.setUserData = function (data) {\n    this.detail = data;\n};\n\n/**\n * !#en Gets user data\n * !#zh 获取用户数据\n * @method getUserData\n * @returns {*}\n */\nEventCustom.prototype.getUserData = function () {\n    return this.detail;\n};\n\n/**\n * !#en Gets event name\n * !#zh 获取事件名称\n * @method getEventName\n * @returns {String}\n */\nEventCustom.prototype.getEventName = cc.Event.prototype.getType;\n\nvar MAX_POOL_SIZE = 10;\nvar _eventPool = new js.Pool(MAX_POOL_SIZE);\nEventCustom.put = function (event) {\n    _eventPool.put(event);\n};\nEventCustom.get = function (type, bubbles) {\n    var event = _eventPool._get();\n    if (event) {\n        event.reset(type, bubbles);\n    }\n    else {\n        event = new EventCustom(type, bubbles);\n    }\n    return event;\n};\n\ncc.Event.EventCustom = EventCustom;\n\nmodule.exports = cc.Event;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n \nrequire('./event');\nrequire('./event-listeners');\nrequire('./event-target');\nrequire('./system-event');\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar EventTarget = require('../event/event-target');\nvar eventManager = require('../event-manager');\nvar inputManger = require('../platform/CCInputManager');;\n\n/**\n * !#en The event type supported by SystemEvent\n * !#zh SystemEvent 支持的事件类型\n * @class SystemEvent.EventType\n * @static\n * @namespace SystemEvent\n */\nvar EventType = cc.Enum({\n    /**\n     * !#en The event type for press the key down event, you can use its value directly: 'keydown'\n     * !#zh 当按下按键时触发的事件\n     * @property KEY_DOWN\n     * @type {String}\n     * @static\n     */\n    KEY_DOWN: 'keydown',\n    /**\n     * !#en The event type for press the key up event, you can use its value directly: 'keyup'\n     * !#zh 当松开按键时触发的事件\n     * @property KEY_UP\n     * @type {String}\n     * @static\n     */\n    KEY_UP: 'keyup',\n    /**\n     * !#en The event type for press the devicemotion event, you can use its value directly: 'devicemotion'\n     * !#zh 重力感应\n     * @property DEVICEMOTION\n     * @type {String}\n     * @static\n     */\n    DEVICEMOTION: 'devicemotion'\n\n});\n\n/**\n * !#en\n * The System event, it currently supports keyboard events and accelerometer events.<br>\n * You can get the SystemEvent instance with cc.systemEvent.<br>\n * !#zh\n * 系统事件，它目前支持按键事件和重力感应事件。<br>\n * 你可以通过 cc.systemEvent 获取到 SystemEvent 的实例。<br>\n * @class SystemEvent\n * @extends EventTarget\n * @example\n * cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION, this.onDeviceMotionEvent, this);\n * cc.systemEvent.off(cc.SystemEvent.EventType.DEVICEMOTION, this.onDeviceMotionEvent, this);\n */\n\nvar keyboardListener = null;\nvar accelerationListener = null;\nvar SystemEvent = cc.Class({\n    name: 'SystemEvent',\n    extends: EventTarget,\n\n    statics: {\n        EventType: EventType\n    },\n\n    /**\n     * !#en whether enable accelerometer event\n     * !#zh 是否启用加速度计事件\n     * @method setAccelerometerEnabled\n     * @param {Boolean} isEnable\n     */\n    setAccelerometerEnabled: function (isEnable) {\n        if (CC_EDITOR) {\n            return;\n        }\n\n        // for iOS 13+\n        if (isEnable && window.DeviceMotionEvent && typeof DeviceMotionEvent.requestPermission === 'function') {\n            DeviceMotionEvent.requestPermission().then(response => {\n                console.log(`Device Motion Event request permission: ${response}`);\n                inputManger.setAccelerometerEnabled(response === 'granted');\n            });\n        } else {\n            inputManger.setAccelerometerEnabled(isEnable);\n        }\n    },\n\n    /**\n     * !#en set accelerometer interval value\n     * !#zh 设置加速度计间隔值\n     * @method setAccelerometerInterval\n     * @param {Number} interval\n     */\n    setAccelerometerInterval: function(interval) {\n        if (CC_EDITOR) {\n            return;\n        }\n        inputManger.setAccelerometerInterval(interval);\n    },\n\n    on: function (type, callback, target, once) {\n        if (CC_EDITOR) {\n            return;\n        }\n        this._super(type, callback, target, once);\n\n        // Keyboard\n        if (type === EventType.KEY_DOWN || type === EventType.KEY_UP) {\n            if (!keyboardListener) {\n                keyboardListener = cc.EventListener.create({\n                    event: cc.EventListener.KEYBOARD,\n                    onKeyPressed: function (keyCode, event) {\n                        event.type = EventType.KEY_DOWN;\n                        cc.systemEvent.dispatchEvent(event);\n                    },\n                    onKeyReleased: function (keyCode, event) {\n                        event.type = EventType.KEY_UP;\n                        cc.systemEvent.dispatchEvent(event);\n                    }\n                });\n            }\n            if (!eventManager.hasEventListener(cc.EventListener.ListenerID.KEYBOARD)) {\n                eventManager.addListener(keyboardListener, 1);\n            }\n        }\n\n        // Acceleration\n        if (type === EventType.DEVICEMOTION) {\n            if (!accelerationListener) {\n                accelerationListener = cc.EventListener.create({\n                    event: cc.EventListener.ACCELERATION,\n                    callback: function (acc, event) {\n                        event.type = EventType.DEVICEMOTION;\n                        cc.systemEvent.dispatchEvent(event);\n                    }\n                });\n            }\n            if (!eventManager.hasEventListener(cc.EventListener.ListenerID.ACCELERATION)) {\n                eventManager.addListener(accelerationListener, 1);\n            }\n        }\n    },\n\n\n    off: function (type, callback, target) {\n        if (CC_EDITOR) {\n            return;\n        }\n        this._super(type, callback, target);\n\n        // Keyboard\n        if (keyboardListener && (type === EventType.KEY_DOWN || type === EventType.KEY_UP)) {\n            var hasKeyDownEventListener = this.hasEventListener(EventType.KEY_DOWN);\n            var hasKeyUpEventListener = this.hasEventListener(EventType.KEY_UP);\n            if (!hasKeyDownEventListener && !hasKeyUpEventListener) {\n                eventManager.removeListener(keyboardListener);\n            }\n        }\n\n        // Acceleration\n        if (accelerationListener && type === EventType.DEVICEMOTION) {\n            eventManager.removeListener(accelerationListener);\n        }\n    }\n\n});\n\ncc.SystemEvent = module.exports = SystemEvent;\n/**\n * @module cc\n */\n\n/**\n * !#en The System event singleton for global usage\n * !#zh 系统事件单例，方便全局使用\n * @property systemEvent\n * @type {SystemEvent}\n */\ncc.systemEvent = new cc.SystemEvent();\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst RenderComponent = require('../components/CCRenderComponent');\nconst Material = require('../assets/material/CCMaterial');\n\nconst Types = require('./types');\nconst LineCap = Types.LineCap;\nconst LineJoin = Types.LineJoin;\n\n/**\n * @class Graphics\n * @extends RenderComponent\n */\nlet Graphics = cc.Class({\n    name: 'cc.Graphics',\n    extends: RenderComponent,\n\n    editor: CC_EDITOR && {\n        menu: 'i18n:MAIN_MENU.component.renderers/Graphics',\n    },\n\n    ctor () {\n        this._impl = new Graphics._Impl(this);\n    },\n\n    properties: {\n        _lineWidth: 1,\n        _strokeColor: cc.Color.BLACK,\n        _lineJoin: LineJoin.MITER,\n        _lineCap: LineCap.BUTT,\n        _fillColor: cc.Color.WHITE,\n        _miterLimit: 10,\n        \n        /**\n         * !#en\n         * Current line width.\n         * !#zh\n         * 当前线条宽度\n         * @property {Number} lineWidth\n         * @default 1\n         */\n        lineWidth: {\n            get () {\n                return this._lineWidth;\n            },\n            set (value) {\n                this._lineWidth = value;\n                this._impl.lineWidth = value;\n            }\n        },\n\n        /**\n         * !#en\n         * lineJoin determines how two connecting segments (of lines, arcs or curves) with non-zero lengths in a shape are joined together.\n         * !#zh\n         * lineJoin 用来设置2个长度不为0的相连部分（线段，圆弧，曲线）如何连接在一起的属性。\n         * @property {Graphics.LineJoin} lineJoin\n         * @default LineJoin.MITER\n         */\n        lineJoin: {\n            get () {\n                return this._lineJoin;\n            },\n            set (value) {\n                this._lineJoin = value;\n                this._impl.lineJoin = value;\n            },\n            type: LineJoin\n        },\n\n        /**\n         * !#en\n         * lineCap determines how the end points of every line are drawn.\n         * !#zh\n         * lineCap 指定如何绘制每一条线段末端。\n         * @property {Graphics.LineCap} lineCap\n         * @default LineCap.BUTT\n         */\n        lineCap: {\n            get () {\n                return this._lineCap;\n            },\n            set (value) {\n                this._lineCap = value;\n                this._impl.lineCap = value;\n            },\n            type: LineCap\n        },\n\n        /**\n         * !#en\n         * stroke color\n         * !#zh\n         * 线段颜色\n         * @property {Color} strokeColor\n         * @default Color.BLACK\n         */\n        strokeColor: {\n            get () {\n                return this._strokeColor;\n            },\n            set (value) {\n                this._impl.strokeColor = this._strokeColor = cc.color(value);\n            }\n        },\n\n        /**\n         * !#en\n         * fill color\n         * !#zh\n         * 填充颜色\n         * @property {Color} fillColor\n         * @default Color.WHITE\n         */\n        fillColor: {\n            get () {\n                return this._fillColor;\n            },\n            set (value) {\n                this._impl.fillColor = this._fillColor = cc.color(value);\n            }\n        },\n\n        /**\n         * !#en\n         * Sets the miter limit ratio\n         * !#zh\n         * 设置斜接面限制比例\n         * @property {Number} miterLimit\n         * @default 10\n         */\n        miterLimit: {\n            get () {\n                return this._miterLimit;\n            },\n            set (value) {\n                this._miterLimit = value;\n                this._impl.miterLimit = value;\n            }\n        }\n    },\n\n    statics: {\n        LineJoin: LineJoin,\n        LineCap: LineCap\n    },\n\n    onRestore () {\n        if (!this._impl) {\n            this._impl = new Graphics._Impl(this);\n        }\n    },\n\n    onDestroy () {\n        this.clear(true);\n        this._super();\n        this._impl = null;\n    },\n\n    _getDefaultMaterial () {\n        return Material.getBuiltinMaterial('2d-base');\n    },\n\n    _updateMaterial () {\n        let material = this._materials[0];\n        material && material.define('CC_USE_MODEL', true);\n    },\n\n    /**\n     * !#en Move path start point to (x,y).\n     * !#zh 移动路径起点到坐标(x, y)\n     * @method moveTo\n     * @param {Number} [x] The x axis of the coordinate for the end point.\n     * @param {Number} [y] The y axis of the coordinate for the end point.\n     */\n    moveTo (x, y) {\n        if (CC_DEBUG && x instanceof cc.Vec2) {\n            cc.warn('[moveTo] : Can not pass Vec2 as [x, y] value, please check it.');\n            return;\n        }\n        this._impl.moveTo(x, y);\n    },\n\n    /**\n     * !#en Adds a straight line to the path\n     * !#zh 绘制直线路径\n     * @method lineTo\n     * @param {Number} [x] The x axis of the coordinate for the end point.\n     * @param {Number} [y] The y axis of the coordinate for the end point.\n     */\n    lineTo (x, y) {\n        if (CC_DEBUG && x instanceof cc.Vec2) {\n            cc.warn('[moveTo] : Can not pass Vec2 as [x, y] value, please check it.');\n            return;\n        }\n        this._impl.lineTo(x, y);\n    },\n\n    /**\n     * !#en Adds a cubic Bézier curve to the path\n     * !#zh 绘制三次贝赛尔曲线路径\n     * @method bezierCurveTo\n     * @param {Number} [c1x] The x axis of the coordinate for the first control point.\n     * @param {Number} [c1y] The y axis of the coordinate for first control point.\n     * @param {Number} [c2x] The x axis of the coordinate for the second control point.\n     * @param {Number} [c2y] The y axis of the coordinate for the second control point.\n     * @param {Number} [x] The x axis of the coordinate for the end point.\n     * @param {Number} [y] The y axis of the coordinate for the end point.\n     */\n    bezierCurveTo (c1x, c1y, c2x, c2y, x, y) {\n        this._impl.bezierCurveTo(c1x, c1y, c2x, c2y, x, y);\n    },\n\n    /**\n     * !#en Adds a quadratic Bézier curve to the path\n     * !#zh 绘制二次贝赛尔曲线路径\n     * @method quadraticCurveTo\n     * @param {Number} [cx] The x axis of the coordinate for the control point.\n     * @param {Number} [cy] The y axis of the coordinate for the control point.\n     * @param {Number} [x] The x axis of the coordinate for the end point.\n     * @param {Number} [y] The y axis of the coordinate for the end point.\n     */\n    quadraticCurveTo (cx, cy, x, y) {\n        this._impl.quadraticCurveTo(cx, cy, x, y);\n    },\n\n    /**\n     * !#en Adds an arc to the path which is centered at (cx, cy) position with radius r starting at startAngle and ending at endAngle going in the given direction by counterclockwise (defaulting to false).\n     * !#zh 绘制圆弧路径。圆弧路径的圆心在 (cx, cy) 位置，半径为 r ，根据 counterclockwise （默认为false）指定的方向从 startAngle 开始绘制，到 endAngle 结束。\n     * @method arc\n     * @param {Number} [cx] The x axis of the coordinate for the center point.\n     * @param {Number} [cy] The y axis of the coordinate for the center point.\n     * @param {Number} [r] The arc's radius.\n     * @param {Number} [startAngle] The angle at which the arc starts, measured clockwise from the positive x axis and expressed in radians.\n     * @param {Number} [endAngle] The angle at which the arc ends, measured clockwise from the positive x axis and expressed in radians.\n     * @param {Boolean} [counterclockwise] An optional Boolean which, if true, causes the arc to be drawn counter-clockwise between the two angles. By default it is drawn clockwise.\n     */\n    arc (cx, cy, r, startAngle, endAngle, counterclockwise) {\n        this._impl.arc(cx, cy, r, startAngle, endAngle, counterclockwise);\n    },\n\n    /**\n     * !#en Adds an ellipse to the path.\n     * !#zh 绘制椭圆路径。\n     * @method ellipse\n     * @param {Number} [cx] The x axis of the coordinate for the center point.\n     * @param {Number} [cy] The y axis of the coordinate for the center point.\n     * @param {Number} [rx] The ellipse's x-axis radius.\n     * @param {Number} [ry] The ellipse's y-axis radius.\n     */\n    ellipse (cx, cy, rx, ry) {\n        this._impl.ellipse(cx, cy, rx, ry);\n    },\n\n    /**\n     * !#en Adds an circle to the path.\n     * !#zh 绘制圆形路径。\n     * @method circle\n     * @param {Number} [cx] The x axis of the coordinate for the center point.\n     * @param {Number} [cy] The y axis of the coordinate for the center point.\n     * @param {Number} [r] The circle's radius.\n     */\n    circle (cx, cy, r) {\n        this._impl.circle(cx, cy, r);\n    },\n\n    /**\n     * !#en Adds an rectangle to the path.\n     * !#zh 绘制矩形路径。\n     * @method rect\n     * @param {Number} [x] The x axis of the coordinate for the rectangle starting point.\n     * @param {Number} [y] The y axis of the coordinate for the rectangle starting point.\n     * @param {Number} [w] The rectangle's width.\n     * @param {Number} [h] The rectangle's height.\n     */\n    rect (x, y, w, h) {\n        this._impl.rect(x, y, w, h);\n    },\n\n    /**\n     * !#en Adds an round corner rectangle to the path. \n     * !#zh 绘制圆角矩形路径。\n     * @method roundRect\n     * @param {Number} [x] The x axis of the coordinate for the rectangle starting point.\n     * @param {Number} [y] The y axis of the coordinate for the rectangle starting point.\n     * @param {Number} [w] The rectangles width.\n     * @param {Number} [h] The rectangle's height.\n     * @param {Number} [r] The radius of the rectangle.\n     */\n    roundRect (x, y, w, h, r) {\n        this._impl.roundRect(x, y, w, h, r);\n    },\n\n    /**\n     * !#en Draws a filled rectangle.\n     * !#zh 绘制填充矩形。\n     * @method fillRect\n     * @param {Number} [x] The x axis of the coordinate for the rectangle starting point.\n     * @param {Number} [y] The y axis of the coordinate for the rectangle starting point.\n     * @param {Number} [w] The rectangle's width.\n     * @param {Number} [h] The rectangle's height.\n     */\n    fillRect (x, y, w, h) {\n        this.rect(x, y, w, h);\n        this.fill();\n    },\n\n    /**\n     * !#en Erasing any previously drawn content.\n     * !#zh 擦除之前绘制的所有内容的方法。\n     * @method clear\n     * @param {Boolean} [clean] Whether to clean the graphics inner cache.\n     */\n    clear (clean) {\n        this._impl.clear(clean);\n        if (this._assembler) {\n            this._assembler.clear(clean);\n        }\n    },\n\n    /**\n     * !#en Causes the point of the pen to move back to the start of the current path. It tries to add a straight line from the current point to the start.\n     * !#zh 将笔点返回到当前路径起始点的。它尝试从当前点到起始点绘制一条直线。\n     * @method close\n     */\n    close () {\n        this._impl.close();\n    },\n\n    /**\n     * !#en Strokes the current or given path with the current stroke style.\n     * !#zh 根据当前的画线样式，绘制当前或已经存在的路径。\n     * @method stroke\n     */\n    stroke () {\n        if (!this._assembler) {\n            this._resetAssembler();\n        }\n        this._assembler.stroke(this);\n    },\n\n    /**\n     * !#en Fills the current or given path with the current fill style.\n     * !#zh 根据当前的画线样式，填充当前或已经存在的路径。\n     * @method fill\n     */\n    fill () {\n        if (!this._assembler) {\n            this._resetAssembler();\n        }\n        this._assembler.fill(this);\n    }\n});\n\ncc.Graphics = module.exports = Graphics;\ncc.Graphics.Types = Types;\ncc.Graphics.Helper = require('./helper');\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst PointFlags = require('./types').PointFlags;\n\nvar PI      = Math.PI;\nvar min     = Math.min;\nvar max     = Math.max;\nvar cos     = Math.cos;\nvar sin     = Math.sin;\nvar abs     = Math.abs;\nvar sign    = Math.sign;\n\nvar KAPPA90 = 0.5522847493;\n\nfunction arc (ctx, cx, cy, r, startAngle, endAngle, counterclockwise) {\n    counterclockwise = counterclockwise || false;\n\n    var a = 0, da = 0, hda = 0, kappa = 0;\n    var dx = 0, dy = 0, x = 0, y = 0, tanx = 0, tany = 0;\n    var px = 0, py = 0, ptanx = 0, ptany = 0;\n    var i, ndivs;\n\n    // Clamp angles\n    da = endAngle - startAngle;\n    if (counterclockwise) {\n        if (abs(da) >= PI * 2) {\n            da = PI * 2;\n        } else {\n            while (da < 0) da += PI * 2;\n        }\n    } else {\n        if (abs(da) >= PI * 2) {\n            da = -PI * 2;\n        } else {\n            while (da > 0) da -= PI * 2;\n        }\n    }\n\n    // Split arc into max 90 degree segments.\n    ndivs = max(1, min(abs(da) / (PI * 0.5) + 0.5, 5)) | 0;\n    hda = da / ndivs / 2.0;\n    kappa = abs(4.0 / 3.0 * (1 - cos(hda)) / sin(hda));\n\n    if (!counterclockwise) kappa = -kappa;\n\n    for (i = 0; i <= ndivs; i++) {\n        a = startAngle + da * (i / ndivs);\n        dx = cos(a);\n        dy = sin(a);\n        x = cx + dx * r;\n        y = cy + dy * r;\n        tanx = -dy * r * kappa;\n        tany = dx * r * kappa;\n\n        if (i === 0) {\n            ctx.moveTo(x, y);\n        } else {\n            ctx.bezierCurveTo(px + ptanx, py + ptany, x - tanx, y - tany, x, y);\n        }\n        px = x;\n        py = y;\n        ptanx = tanx;\n        ptany = tany;\n    }\n}\n\nfunction ellipse (ctx, cx, cy, rx, ry) {\n    ctx.moveTo(cx - rx, cy);\n    ctx.bezierCurveTo(cx - rx, cy + ry * KAPPA90, cx - rx * KAPPA90, cy + ry, cx, cy + ry);\n    ctx.bezierCurveTo(cx + rx * KAPPA90, cy + ry, cx + rx, cy + ry * KAPPA90, cx + rx, cy);\n    ctx.bezierCurveTo(cx + rx, cy - ry * KAPPA90, cx + rx * KAPPA90, cy - ry, cx, cy - ry);\n    ctx.bezierCurveTo(cx - rx * KAPPA90, cy - ry, cx - rx, cy - ry * KAPPA90, cx - rx, cy);\n    ctx.close();\n}\n\nfunction roundRect (ctx, x, y, w, h, r) {\n    if (r < 0.1) {\n        ctx.rect(x, y, w, h);\n        return;\n    } else {\n        var rx = min(r, abs(w) * 0.5) * sign(w),\n            ry = min(r, abs(h) * 0.5) * sign(h);\n\n        ctx.moveTo(x, y + ry);\n        ctx.lineTo(x, y + h - ry);\n        ctx.bezierCurveTo(x, y + h - ry * (1 - KAPPA90), x + rx * (1 - KAPPA90), y + h, x + rx, y + h);\n        ctx.lineTo(x + w - rx, y + h);\n        ctx.bezierCurveTo(x + w - rx * (1 - KAPPA90), y + h, x + w, y + h - ry * (1 - KAPPA90), x + w, y + h - ry);\n        ctx.lineTo(x + w, y + ry);\n        ctx.bezierCurveTo(x + w, y + ry * (1 - KAPPA90), x + w - rx * (1 - KAPPA90), y, x + w - rx, y);\n        ctx.lineTo(x + rx, y);\n        ctx.bezierCurveTo(x + rx * (1 - KAPPA90), y, x, y + ry * (1 - KAPPA90), x, y + ry);\n        ctx.close();\n    }\n}\n\nfunction tesselateBezier (ctx, x1, y1, x2, y2, x3, y3, x4, y4, level, type) {\n    var x12, y12, x23, y23, x34, y34, x123, y123, x234, y234, x1234, y1234;\n    var dx, dy, d2, d3;\n\n    if (level > 10) return;\n\n    x12 = (x1 + x2) * 0.5;\n    y12 = (y1 + y2) * 0.5;\n    x23 = (x2 + x3) * 0.5;\n    y23 = (y2 + y3) * 0.5;\n    x34 = (x3 + x4) * 0.5;\n    y34 = (y3 + y4) * 0.5;\n    x123 = (x12 + x23) * 0.5;\n    y123 = (y12 + y23) * 0.5;\n\n    dx = x4 - x1;\n    dy = y4 - y1;\n    d2 = abs((x2 - x4) * dy - (y2 - y4) * dx);\n    d3 = abs((x3 - x4) * dy - (y3 - y4) * dx);\n\n    if ((d2 + d3) * (d2 + d3) < ctx._tessTol * (dx * dx + dy * dy)) {\n        ctx._addPoint(x4, y4, type === 0 ? type | PointFlags.PT_BEVEL : type);\n        return;\n    }\n\n    x234 = (x23 + x34) * 0.5;\n    y234 = (y23 + y34) * 0.5;\n    x1234 = (x123 + x234) * 0.5;\n    y1234 = (y123 + y234) * 0.5;\n\n    tesselateBezier(ctx, x1, y1, x12, y12, x123, y123, x1234, y1234, level + 1, 0);\n    tesselateBezier(ctx, x1234, y1234, x234, y234, x34, y34, x4, y4, level + 1, type);\n}\n\nmodule.exports =  {\n    arc: arc,\n    ellipse: ellipse,\n    roundRect: roundRect,\n    tesselateBezier: tesselateBezier\n};\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n'use strict';\n\nrequire('./graphics');\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n \n'use strict';\n\n/**\n * !#en Enum for LineCap.\n * !#zh 线段末端属性\n * @enum Graphics.LineCap\n */\nvar LineCap = cc.Enum({\n    /**\n     * !#en The ends of lines are squared off at the endpoints.\n     * !#zh 线段末端以方形结束。\n     * @property {Number} BUTT\n     */\n    BUTT: 0,\n\n    /**\n     * !#en The ends of lines are rounded.\n     * !#zh 线段末端以圆形结束。\n     * @property {Number} ROUND\n     */\n    ROUND: 1,\n\n    /**\n     * !#en The ends of lines are squared off by adding a box with an equal width and half the height of the line's thickness.\n     * !#zh 线段末端以方形结束，但是增加了一个宽度和线段相同，高度是线段厚度一半的矩形区域。\n     * @property {Number} SQUARE\n     */\n    SQUARE: 2,\n});\n\n/**\n * !#en Enum for LineJoin.\n * !#zh 线段拐角属性\n * @enum Graphics.LineJoin\n */\nvar LineJoin = cc.Enum({\n    /**\n     * !#en Fills an additional triangular area between the common endpoint of connected segments, and the separate outside rectangular corners of each segment.\n     * !#zh 在相连部分的末端填充一个额外的以三角形为底的区域， 每个部分都有各自独立的矩形拐角。\n     * @property {Number} BEVEL\n     */\n    BEVEL: 0,\n\n    /**\n     * !#en Rounds off the corners of a shape by filling an additional sector of disc centered at the common endpoint of connected segments. The radius for these rounded corners is equal to the line width.\n     * !#zh 通过填充一个额外的，圆心在相连部分末端的扇形，绘制拐角的形状。 圆角的半径是线段的宽度。\n     * @property {Number} ROUND\n     */\n    ROUND: 1,\n\n    /**\n     * !#en Connected segments are joined by extending their outside edges to connect at a single point, with the effect of filling an additional lozenge-shaped area.\n     * !#zh 通过延伸相连部分的外边缘，使其相交于一点，形成一个额外的菱形区域。\n     * @property {Number} MITER\n     */\n    MITER: 2\n});\n\n\n// PointFlags\nvar PointFlags =  cc.Enum({\n    PT_CORNER: 0x01,\n    PT_LEFT: 0x02,\n    PT_BEVEL: 0x04,\n    PT_INNERBEVEL: 0x08,\n});\n\nmodule.exports = {\n    LineCap:    LineCap,\n    LineJoin:   LineJoin,\n    PointFlags: PointFlags\n};\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('./platform');\nrequire('./assets');\n\nif (!CC_EDITOR || !Editor.isMainProcess) {\n    require('./CCNode');\n    require('./CCPrivateNode');\n    require('./CCScene');\n\n    require('./components');\n    require('./graphics');\n    require('./collider');\n    // CCIntersection can be used separately.\n    require('./collider/CCIntersection');\n    require('./physics');\n    require('./camera/CCCamera');\n    require('./geom-utils');\n}\n\nrequire('./mesh');\nrequire('./3d');\n\nrequire('./base-ui/CCWidgetManager');\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require('../platform/js');\nvar Pipeline = require('./pipeline');\nvar LoadingItems = require('./loading-items');\nvar AssetLoader = require('./asset-loader');\nvar Downloader = require('./downloader');\nvar Loader = require('./loader');\nvar AssetTable = require('./asset-table');\nvar callInNextTick = require('../platform/utils').callInNextTick;\nvar AutoReleaseUtils = require('./auto-release-utils');\n// var pushToMap = require('../utils/misc').pushToMap;\nvar ReleasedAssetChecker = CC_DEBUG && require('./released-asset-checker');\n\nvar assetTables = Object.create(null);\nassetTables.assets = new AssetTable();\nassetTables.internal = new AssetTable();\n\nfunction getXMLHttpRequest () {\n    return window.XMLHttpRequest ? new window.XMLHttpRequest() : new ActiveXObject('MSXML2.XMLHTTP');\n}\n\nvar _info = {url: null, raw: false};\n\n// Convert a resources by finding its real url with uuid, otherwise we will use the uuid or raw url as its url\n// So we gurantee there will be url in result\nfunction getResWithUrl (res) {\n    var id, result, isUuid;\n    if (typeof res === 'object') {\n        result = res;\n        if (res.url) {\n            return result;\n        }\n        else {\n            id = res.uuid;\n        }\n    }\n    else {\n        result = {};\n        id = res;\n    }\n    isUuid = result.type ? result.type === 'uuid' : cc.AssetLibrary._uuidInSettings(id);\n    cc.AssetLibrary._getAssetInfoInRuntime(id, _info);\n    result.url = !isUuid ? id : _info.url;\n    if (_info.url && result.type === 'uuid' && _info.raw) {\n        result.type = null;\n        result.isRawAsset = true;\n    }\n    else if (!isUuid) {\n        result.isRawAsset = true;\n    }\n    return result;\n}\n\nvar _sharedResources = [];\nvar _sharedList = [];\n\n/**\n * Loader for resource loading process. It's a singleton object.\n * @class loader\n * @extends Pipeline\n * @static\n */\nfunction CCLoader () {\n    var assetLoader = new AssetLoader();\n    var downloader = new Downloader();\n    var loader = new Loader();\n\n    Pipeline.call(this, [\n        assetLoader,\n        downloader,\n        loader\n    ]);\n\n    /**\n     * The asset loader in cc.loader's pipeline, it's by default the first pipe.\n     * It's used to identify an asset's type, and determine how to download it.\n     * @property assetLoader\n     * @type {Object}\n     */\n    this.assetLoader = assetLoader;\n\n    /**\n     * The md5 pipe in cc.loader's pipeline, it could be absent if the project isn't build with md5 option.\n     * It's used to modify the url to the real downloadable url with md5 suffix.\n     * @property md5Pipe\n     * @type {Object}\n     */\n    this.md5Pipe = null;\n\n    /**\n     * The downloader in cc.loader's pipeline, it's by default the second pipe.\n     * It's used to download files with several handlers: pure text, image, script, audio, font, uuid.\n     * You can add your own download function with addDownloadHandlers\n     * @property downloader\n     * @type {Object}\n     */\n    this.downloader = downloader;\n\n    /**\n     * The loader in cc.loader's pipeline, it's by default the third pipe.\n     * It's used to parse downloaded content with several handlers: JSON, image, plist, fnt, uuid.\n     * You can add your own download function with addLoadHandlers\n     * @property loader\n     * @type {Object}\n     */\n    this.loader = loader;\n\n    this.onProgress = null;\n\n    // assets to release automatically\n    this._autoReleaseSetting = js.createMap(true);\n\n    if (CC_DEBUG) {\n        this._releasedAssetChecker_DEBUG = new ReleasedAssetChecker();\n    }\n}\njs.extend(CCLoader, Pipeline);\nvar proto = CCLoader.prototype;\n\nproto.init = function (director) {\n    if (CC_DEBUG) {\n        var self = this;\n        director.on(cc.Director.EVENT_AFTER_UPDATE, function () {\n            self._releasedAssetChecker_DEBUG.checkCouldRelease(self._cache);\n        });\n    }\n};\n\n/**\n * Gets a new XMLHttpRequest instance.\n * @method getXMLHttpRequest\n * @returns {XMLHttpRequest}\n */\nproto.getXMLHttpRequest = getXMLHttpRequest;\n\n/**\n * Add custom supported types handler or modify existing type handler for download process.\n * @example\n *  cc.loader.addDownloadHandlers({\n *      // This will match all url with `.scene` extension or all url with `scene` type\n *      'scene' : function (url, callback) {}\n *  });\n * @method addDownloadHandlers\n * @param {Object} extMap Custom supported types with corresponded handler\n */\nproto.addDownloadHandlers = function (extMap) {\n    this.downloader.addHandlers(extMap);\n};\n\n/**\n * Add custom supported types handler or modify existing type handler for load process.\n * @example\n *  cc.loader.addLoadHandlers({\n *      // This will match all url with `.scene` extension or all url with `scene` type\n *      'scene' : function (url, callback) {}\n *  });\n * @method addLoadHandlers\n * @param {Object} extMap Custom supported types with corresponded handler\n */\nproto.addLoadHandlers = function (extMap) {\n    this.loader.addHandlers(extMap);\n};\n\n/**\n * Load resources with a progression callback and a complete callback.\n * The progression callback is the same as Pipeline's {{#crossLink \"LoadingItems/onProgress:method\"}}onProgress{{/crossLink}}\n * The complete callback is almost the same as Pipeline's {{#crossLink \"LoadingItems/onComplete:method\"}}onComplete{{/crossLink}}\n * The only difference is when user pass a single url as resources, the complete callback will set its result directly as the second parameter.\n *\n * @example\n * cc.loader.load('a.png', function (err, tex) {\n *     cc.log('Result should be a texture: ' + (tex instanceof cc.Texture2D));\n * });\n *\n * cc.loader.load('http://example.com/a.png', function (err, tex) {\n *     cc.log('Should load a texture from external url: ' + (tex instanceof cc.Texture2D));\n * });\n *\n * cc.loader.load({url: 'http://example.com/getImageREST?file=a.png', type: 'png'}, function (err, tex) {\n *     cc.log('Should load a texture from RESTful API by specify the type: ' + (tex instanceof cc.Texture2D));\n * });\n *\n * cc.loader.load(['a.png', 'b.json'], function (errors, results) {\n *     if (errors) {\n *         for (var i = 0; i < errors.length; i++) {\n *             cc.log('Error url [' + errors[i] + ']: ' + results.getError(errors[i]));\n *         }\n *     }\n *     var aTex = results.getContent('a.png');\n *     var bJsonObj = results.getContent('b.json');\n * });\n *\n * @method load\n * @param {String|String[]|Object} resources - Url list in an array\n * @param {Function} [progressCallback] - Callback invoked when progression change\n * @param {Number} progressCallback.completedCount - The number of the items that are already completed\n * @param {Number} progressCallback.totalCount - The total number of the items\n * @param {Object} progressCallback.item - The latest item which flow out the pipeline\n * @param {Function} [completeCallback] - Callback invoked when all resources loaded\n * @typescript\n * load(resources: string|string[]|{uuid?: string, url?: string, type?: string}, completeCallback?: Function): void\n * load(resources: string|string[]|{uuid?: string, url?: string, type?: string}, progressCallback: (completedCount: number, totalCount: number, item: any) => void, completeCallback: Function|null): void\n */\nproto.load = function(resources, progressCallback, completeCallback) {\n    if (CC_DEV && !resources) {\n        return cc.error(\"[cc.loader.load] resources must be non-nil.\");\n    }\n\n    if (completeCallback === undefined) {\n        completeCallback = progressCallback;\n        progressCallback = this.onProgress || null;\n    }\n\n    var self = this;\n    var singleRes = false;\n    var res;\n    if (!(resources instanceof Array)) {\n        if (resources) {\n            singleRes = true;\n            resources = [resources];\n        } else { \n            resources = [];\n        }\n    }\n\n    _sharedResources.length = 0;\n    for (var i = 0; i < resources.length; ++i) {\n        var resource = resources[i];\n        // Backward compatibility\n        if (resource && resource.id) {\n            cc.warnID(4920, resource.id);\n            if (!resource.uuid && !resource.url) {\n                resource.url = resource.id;\n            }\n        }\n        res = getResWithUrl(resource);\n        if (!res.url && !res.uuid)\n            continue;\n        var item = this._cache[res.url];\n        _sharedResources.push(item || res);\n    }\n\n    var queue = LoadingItems.create(this, progressCallback, function (errors, items) {\n        callInNextTick(function () {\n            if (completeCallback) {\n                if (singleRes) {\n                    let id = res.url;\n                    completeCallback.call(self, errors, items.getContent(id));\n                }\n                else {\n                    completeCallback.call(self, errors, items);\n                }\n                completeCallback = null;\n            }\n\n            if (CC_EDITOR) {\n                for (let id in self._cache) {\n                    if (self._cache[id].complete) {\n                        self.removeItem(id);\n                    }\n                }\n            }\n            items.destroy();\n        });\n    });\n    LoadingItems.initQueueDeps(queue);\n    queue.append(_sharedResources);\n    _sharedResources.length = 0;\n};\n\nproto.flowInDeps = function (owner, urlList, callback) {\n    _sharedList.length = 0;\n    for (var i = 0; i < urlList.length; ++i) {\n        var res = getResWithUrl(urlList[i]);\n        if (!res.url && ! res.uuid)\n            continue;\n        var item = this._cache[res.url];\n        if (item) {\n            _sharedList.push(item);\n        }\n        else {\n            _sharedList.push(res);\n        }\n    }\n\n    var queue = LoadingItems.create(this, owner ? function (completedCount, totalCount, item) {\n        if (this._ownerQueue && this._ownerQueue.onProgress) {\n            this._ownerQueue._childOnProgress(item);\n        }\n    } : null, function (errors, items) {\n        callback(errors, items);\n        // Clear deps because it's already done\n        // Each item will only flowInDeps once, so it's still safe here\n        owner && owner.deps && (owner.deps.length = 0);\n        items.destroy();\n    });\n    if (owner) {\n        var ownerQueue = LoadingItems.getQueue(owner);\n        // Set the root ownerQueue, if no ownerQueue defined in ownerQueue, it's the root\n        queue._ownerQueue = ownerQueue._ownerQueue || ownerQueue;\n    }\n    var accepted = queue.append(_sharedList, owner);\n    _sharedList.length = 0;\n    return accepted;\n};\n\nproto._assetTables = assetTables;\nproto._getResUuid = function (url, type, mount, quiet) {\n    mount = mount || 'assets';\n\n    var assetTable = assetTables[mount];\n    if (!url || !assetTable) {\n        return null;\n    }\n    \n    // Ignore parameter\n    var index = url.indexOf('?');\n    if (index !== -1)\n        url = url.substr(0, index);\n    var uuid = assetTable.getUuid(url, type);\n    if ( !uuid ) {\n        var extname = cc.path.extname(url);\n        if (extname) {\n            // strip extname\n            url = url.slice(0, - extname.length);\n            uuid = assetTable.getUuid(url, type);\n            if (uuid && !quiet) {\n                cc.warnID(4901, url, extname);\n            }\n        }\n    }\n    return uuid;\n};\n\n// Find the asset's reference id in loader, asset could be asset object, asset uuid or asset url\nproto._getReferenceKey = function (assetOrUrlOrUuid) {\n    var key;\n    if (typeof assetOrUrlOrUuid === 'object') {\n        key = assetOrUrlOrUuid._uuid || null;\n    }\n    else if (typeof assetOrUrlOrUuid === 'string') {\n        key = this._getResUuid(assetOrUrlOrUuid, null, null, true) || assetOrUrlOrUuid;\n    }\n    if (!key) {\n        cc.warnID(4800, assetOrUrlOrUuid);\n        return key;\n    }\n    cc.AssetLibrary._getAssetInfoInRuntime(key, _info);\n    return this._cache[_info.url] ? _info.url : key;\n};\n\nproto._urlNotFound = function (url, type, completeCallback) {\n    callInNextTick(function () {\n        url = cc.url.normalize(url);\n        var info = `${type ? js.getClassName(type) : 'Asset'} in \"resources/${url}\" does not exist.`;\n        if (completeCallback) {\n            completeCallback(new Error(info), []);\n        }\n    });\n};\n\n/**\n * @param {Function} [type]\n * @param {Function} [onProgress]\n * @param {Function} onComplete\n * @returns {Object} arguments\n * @returns {Function} arguments.type\n * @returns {Function} arguments.onProgress\n * @returns {Function} arguments.onComplete\n */\nproto._parseLoadResArgs = function (type, onProgress, onComplete) {\n    if (onComplete === undefined) {\n        var isValidType = (type instanceof Array) || js.isChildClassOf(type, cc.RawAsset);\n        if (onProgress) {\n            onComplete = onProgress;\n            if (isValidType) {\n                onProgress = this.onProgress || null;\n            }\n        }\n        else if (onProgress === undefined && !isValidType) {\n            onComplete = type;\n            onProgress = this.onProgress || null;\n            type = null;\n        }\n        if (onProgress !== undefined && !isValidType) {\n            onProgress = type;\n            type = null;\n        }\n    }\n    return {\n        type: type,\n        onProgress: onProgress,\n        onComplete: onComplete,\n    };\n};\n\n/**\n * Load resources from the \"resources\" folder inside the \"assets\" folder of your project.<br>\n * <br>\n * Note: All asset URLs in Creator use forward slashes, URLs using backslashes will not work.\n *\n * @method loadRes\n * @param {String} url - Url of the target resource.\n *                       The url is relative to the \"resources\" folder, extensions must be omitted.\n * @param {Function} [type] - Only asset of type will be loaded if this argument is supplied.\n * @param {Function} [progressCallback] - Callback invoked when progression change.\n * @param {Number} progressCallback.completedCount - The number of the items that are already completed.\n * @param {Number} progressCallback.totalCount - The total number of the items.\n * @param {Object} progressCallback.item - The latest item which flow out the pipeline.\n * @param {Function} [completeCallback] - Callback invoked when the resource loaded.\n * @param {Error} completeCallback.error - The error info or null if loaded successfully.\n * @param {Object} completeCallback.resource - The loaded resource if it can be found otherwise returns null.\n *\n * @example\n *\n * // load the prefab (project/assets/resources/misc/character/cocos) from resources folder\n * cc.loader.loadRes('misc/character/cocos', function (err, prefab) {\n *     if (err) {\n *         cc.error(err.message || err);\n *         return;\n *     }\n *     cc.log('Result should be a prefab: ' + (prefab instanceof cc.Prefab));\n * });\n *\n * // load the sprite frame of (project/assets/resources/imgs/cocos.png) from resources folder\n * cc.loader.loadRes('imgs/cocos', cc.SpriteFrame, function (err, spriteFrame) {\n *     if (err) {\n *         cc.error(err.message || err);\n *         return;\n *     }\n *     cc.log('Result should be a sprite frame: ' + (spriteFrame instanceof cc.SpriteFrame));\n * });\n * @typescript\n * loadRes(url: string, type: typeof cc.Asset, progressCallback: (completedCount: number, totalCount: number, item: any) => void, completeCallback: ((error: Error, resource: any) => void)|null): void\n * loadRes(url: string, type: typeof cc.Asset, completeCallback: (error: Error, resource: any) => void): void\n * loadRes(url: string, type: typeof cc.Asset): void\n * loadRes(url: string, progressCallback: (completedCount: number, totalCount: number, item: any) => void, completeCallback: ((error: Error, resource: any) => void)|null): void\n * loadRes(url: string, completeCallback: (error: Error, resource: any) => void): void\n * loadRes(url: string): void\n */\nproto.loadRes = function (url, type, mount, progressCallback, completeCallback) {\n    if (arguments.length !== 5) {\n        completeCallback = progressCallback;\n        progressCallback = mount;\n        mount = 'assets';\n    }\n\n    var args = this._parseLoadResArgs(type, progressCallback, completeCallback);\n    type = args.type;\n    progressCallback = args.onProgress;\n    completeCallback = args.onComplete;\n\n    var self = this;\n    var uuid = self._getResUuid(url, type, mount);\n    if (uuid) {\n        this.load(\n            {\n                type: 'uuid',\n                uuid: uuid\n            },\n            progressCallback,\n            function (err, asset) {\n                if (asset) {\n                    // should not release these assets, even if they are static referenced in the scene.\n                    self.setAutoReleaseRecursively(uuid, false);\n                }\n                if (completeCallback) {\n                    completeCallback(err, asset);\n                }\n            }\n        );\n    }\n    else {\n        self._urlNotFound(url, type, completeCallback);\n    }\n};\n\nproto._loadResUuids = function (uuids, progressCallback, completeCallback, urls) {\n    if (uuids.length > 0) {\n        var self = this;\n        var res = uuids.map(function (uuid) {\n            return {\n                type: 'uuid',\n                uuid: uuid\n            }\n        });\n        this.load(res, progressCallback, function (errors, items) {\n            if (completeCallback) {\n                var assetRes = [];\n                var urlRes = urls && [];\n                for (var i = 0; i < res.length; ++i) {\n                    var uuid = res[i].uuid;\n                    var id = this._getReferenceKey(uuid);\n                    var item = items.getContent(id);\n                    if (item) {\n                        // should not release these assets, even if they are static referenced in the scene.\n                        self.setAutoReleaseRecursively(uuid, false);\n                        assetRes.push(item);\n                        if (urlRes) {\n                            urlRes.push(urls[i]);\n                        }\n                    }\n                }\n                if (urls) {\n                    completeCallback(errors, assetRes, urlRes);\n                }\n                else {\n                    completeCallback(errors, assetRes);\n                }\n            }\n        });\n    }\n    else {\n        if (completeCallback) {\n            callInNextTick(function () {\n                if (urls) {\n                    completeCallback(null, [], []);\n                }\n                else {\n                    completeCallback(null, []);\n                }\n            });\n        }\n    }\n};\n\n/**\n * This method is like {{#crossLink \"loader/loadRes:method\"}}{{/crossLink}} except that it accepts array of url.\n *\n * @method loadResArray\n * @param {String[]} urls - Array of URLs of the target resource.\n *                          The url is relative to the \"resources\" folder, extensions must be omitted.\n * @param {Function} [type] - Only asset of type will be loaded if this argument is supplied.\n * @param {Function} [progressCallback] - Callback invoked when progression change.\n * @param {Number} progressCallback.completedCount - The number of the items that are already completed.\n * @param {Number} progressCallback.totalCount - The total number of the items.\n * @param {Object} progressCallback.item - The latest item which flow out the pipeline.\n * @param {Function} [completeCallback] - A callback which is called when all assets have been loaded, or an error occurs.\n * @param {Error} completeCallback.error - If one of the asset failed, the complete callback is immediately called\n *                                         with the error. If all assets are loaded successfully, error will be null.\n * @param {Asset[]|Array} completeCallback.assets - An array of all loaded assets.\n *                                                     If nothing to load, assets will be an empty array.\n * @example\n *\n * // load the SpriteFrames from resources folder\n * var spriteFrames;\n * var urls = ['misc/characters/character_01', 'misc/weapons/weapons_01'];\n * cc.loader.loadResArray(urls, cc.SpriteFrame, function (err, assets) {\n *     if (err) {\n *         cc.error(err);\n *         return;\n *     }\n *     spriteFrames = assets;\n *     // ...\n * });\n * @typescript\n * loadResArray(url: string[], type: typeof cc.Asset, progressCallback: (completedCount: number, totalCount: number, item: any) => void, completeCallback: ((error: Error, resource: any[]) => void)|null): void\n * loadResArray(url: string[], type: typeof cc.Asset, completeCallback: (error: Error, resource: any[]) => void): void\n * loadResArray(url: string[], type: typeof cc.Asset): void\n * loadResArray(url: string[], progressCallback: (completedCount: number, totalCount: number, item: any) => void, completeCallback: ((error: Error, resource: any[]) => void)|null): void\n * loadResArray(url: string[], completeCallback: (error: Error, resource: any[]) => void): void\n * loadResArray(url: string[]): void\n * loadResArray(url: string[], type: typeof cc.Asset[]): void\n */\nproto.loadResArray = function (urls, type, mount, progressCallback, completeCallback) {\n    if (arguments.length !== 5) {\n        completeCallback = progressCallback;\n        progressCallback = mount;\n        mount = 'assets';\n    }\n\n    var args = this._parseLoadResArgs(type, progressCallback, completeCallback);\n    type = args.type;\n    progressCallback = args.onProgress;\n    completeCallback = args.onComplete;\n\n    var uuids = [];\n    var isTypesArray = type instanceof Array;\n    for (var i = 0; i < urls.length; i++) {\n        var url = urls[i];\n        var assetType = isTypesArray ? type[i] : type;\n        var uuid = this._getResUuid(url, assetType, mount);\n        if (uuid) {\n            uuids.push(uuid);\n        }\n        else {\n            this._urlNotFound(url, assetType, completeCallback);\n            return;\n        }\n    }\n    this._loadResUuids(uuids, progressCallback, completeCallback);\n};\n\n/**\n * Load all assets in a folder inside the \"assets/resources\" folder of your project.<br>\n * <br>\n * Note: All asset URLs in Creator use forward slashes, URLs using backslashes will not work.\n *\n * @method loadResDir\n * @param {String} url - Url of the target folder.\n *                       The url is relative to the \"resources\" folder, extensions must be omitted.\n * @param {Function} [type] - Only asset of type will be loaded if this argument is supplied.\n * @param {Function} [progressCallback] - Callback invoked when progression change.\n * @param {Number} progressCallback.completedCount - The number of the items that are already completed.\n * @param {Number} progressCallback.totalCount - The total number of the items.\n * @param {Object} progressCallback.item - The latest item which flow out the pipeline.\n * @param {Function} [completeCallback] - A callback which is called when all assets have been loaded, or an error occurs.\n * @param {Error} completeCallback.error - If one of the asset failed, the complete callback is immediately called\n *                                         with the error. If all assets are loaded successfully, error will be null.\n * @param {Asset[]|Array} completeCallback.assets - An array of all loaded assets.\n *                                             If nothing to load, assets will be an empty array.\n * @param {String[]} completeCallback.urls - An array that lists all the URLs of loaded assets.\n *\n * @example\n *\n * // load the texture (resources/imgs/cocos.png) and the corresponding sprite frame\n * cc.loader.loadResDir('imgs/cocos', function (err, assets) {\n *     if (err) {\n *         cc.error(err);\n *         return;\n *     }\n *     var texture = assets[0];\n *     var spriteFrame = assets[1];\n * });\n *\n * // load all textures in \"resources/imgs/\"\n * cc.loader.loadResDir('imgs', cc.Texture2D, function (err, textures) {\n *     var texture1 = textures[0];\n *     var texture2 = textures[1];\n * });\n *\n * // load all JSONs in \"resources/data/\"\n * cc.loader.loadResDir('data', function (err, objects, urls) {\n *     var data = objects[0];\n *     var url = urls[0];\n * });\n * @typescript\n * loadResDir(url: string, type: typeof cc.Asset, progressCallback: (completedCount: number, totalCount: number, item: any) => void, completeCallback: ((error: Error, resource: any[], urls: string[]) => void)|null): void\n * loadResDir(url: string, type: typeof cc.Asset, completeCallback: (error: Error, resource: any[], urls: string[]) => void): void\n * loadResDir(url: string, type: typeof cc.Asset): void\n * loadResDir(url: string, progressCallback: (completedCount: number, totalCount: number, item: any) => void, completeCallback: ((error: Error, resource: any[], urls: string[]) => void)|null): void\n * loadResDir(url: string, completeCallback: (error: Error, resource: any[], urls: string[]) => void): void\n * loadResDir(url: string): void\n */\nproto.loadResDir = function (url, type, mount, progressCallback, completeCallback) {\n    if (arguments.length !== 5) {\n        completeCallback = progressCallback;\n        progressCallback = mount;\n        mount = 'assets';\n    }\n    \n    if (!assetTables[mount]) return; \n\n    var args = this._parseLoadResArgs(type, progressCallback, completeCallback);\n    \n    type = args.type;\n    progressCallback = args.onProgress;\n    completeCallback = args.onComplete;\n\n    var urls = [];\n    var uuids = assetTables[mount].getUuidArray(url, type, urls);\n    this._loadResUuids(uuids, progressCallback, completeCallback, urls);\n};\n\n/**\n * Get resource data by id. <br>\n * When you load resources with {{#crossLink \"loader/load:method\"}}{{/crossLink}} or {{#crossLink \"loader/loadRes:method\"}}{{/crossLink}},\n * the url will be the unique identity of the resource.\n * After loaded, you can acquire them by passing the url to this API.\n *\n * @method getRes\n * @param {String} url\n * @param {Function} [type] - Only asset of type will be returned if this argument is supplied.\n * @returns {*}\n */\nproto.getRes = function (url, type) {\n    var item = this._cache[url];\n    if (!item) {\n        var uuid = this._getResUuid(url, type, null, true);\n        if (uuid) {\n            var ref = this._getReferenceKey(uuid);\n            item = this._cache[ref];\n        }\n        else {\n            return null;\n        }\n    }\n    if (item && item.alias) {\n        item = item.alias;\n    }\n    return (item && item.complete) ? item.content : null;\n};\n\n/**\n * Get total resources count in loader.\n * @returns {Number}\n */\nproto.getResCount = function () {\n    return Object.keys(this._cache).length;\n};\n\n/**\n * !#en\n * Get all resource dependencies of the loaded asset in an array, including itself.\n * The owner parameter accept the following types: 1. The asset itself; 2. The resource url; 3. The asset's uuid.<br>\n * The returned array stores the dependencies with their uuids, after retrieve dependencies,\n * you can release them, access dependent assets by passing the uuid to {{#crossLink \"loader/getRes:method\"}}{{/crossLink}}, or other stuffs you want.<br>\n * For release all dependencies of an asset, please refer to {{#crossLink \"loader/release:method\"}}{{/crossLink}}\n * Here is some examples:\n * !#zh\n * 获取某个已经加载好的资源的所有依赖资源，包含它自身，并保存在数组中返回。owner 参数接收以下几种类型：1. 资源 asset 对象；2. 资源目录下的 url；3. 资源的 uuid。<br>\n * 返回的数组将仅保存依赖资源的 uuid，获取这些 uuid 后，你可以从 loader 释放这些资源；通过 {{#crossLink \"loader/getRes:method\"}}{{/crossLink}} 获取某个资源或者进行其他你需要的操作。<br>\n * 想要释放一个资源及其依赖资源，可以参考 {{#crossLink \"loader/release:method\"}}{{/crossLink}}。下面是一些示例代码：\n *\n * @example\n * // Release all dependencies of a loaded prefab\n * var deps = cc.loader.getDependsRecursively(prefab);\n * cc.loader.release(deps);\n * // Retrieve all dependent textures\n * var deps = cc.loader.getDependsRecursively('prefabs/sample');\n * var textures = [];\n * for (var i = 0; i < deps.length; ++i) {\n *     var item = cc.loader.getRes(deps[i]);\n *     if (item instanceof cc.Texture2D) {\n *         textures.push(item);\n *     }\n * }\n *\n * @method getDependsRecursively\n * @param {Asset|RawAsset|String} owner - The owner asset or the resource url or the asset's uuid\n * @returns {Array}\n */\nproto.getDependsRecursively = function (owner) {\n    if (owner) {\n        var key = this._getReferenceKey(owner);\n        var assets = AutoReleaseUtils.getDependsRecursively(key);\n        assets.push(key);\n        return assets;\n    }\n    else {\n        return [];\n    }\n};\n\n/**\n * !#en\n * Release the content of an asset or an array of assets by uuid.\n * Start from v1.3, this method will not only remove the cache of the asset in loader, but also clean up its content.\n * For example, if you release a texture, the texture asset and its gl texture data will be freed up.\n * In complexe project, you can use this function with {{#crossLink \"loader/getDependsRecursively:method\"}}{{/crossLink}} to free up memory in critical circumstances.\n * Notice, this method may cause the texture to be unusable, if there are still other nodes use the same texture, they may turn to black and report gl errors.\n * If you only want to remove the cache of an asset, please use {{#crossLink \"pipeline/removeItem:method\"}}{{/crossLink}}\n * !#zh\n * 通过 id（通常是资源 url）来释放一个资源或者一个资源数组。\n * 从 v1.3 开始，这个方法不仅会从 loader 中删除资源的缓存引用，还会清理它的资源内容。\n * 比如说，当你释放一个 texture 资源，这个 texture 和它的 gl 贴图数据都会被释放。\n * 在复杂项目中，我们建议你结合 {{#crossLink \"loader/getDependsRecursively:method\"}}{{/crossLink}} 来使用，便于在设备内存告急的情况下更快地释放不再需要的资源的内存。\n * 注意，这个函数可能会导致资源贴图或资源所依赖的贴图不可用，如果场景中存在节点仍然依赖同样的贴图，它们可能会变黑并报 GL 错误。\n * 如果你只想删除一个资源的缓存引用，请使用 {{#crossLink \"pipeline/removeItem:method\"}}{{/crossLink}}\n *\n * @example\n * // Release a texture which is no longer need\n * cc.loader.release(texture);\n * // Release all dependencies of a loaded prefab\n * var deps = cc.loader.getDependsRecursively('prefabs/sample');\n * cc.loader.release(deps);\n * // If there is no instance of this prefab in the scene, the prefab and its dependencies like textures, sprite frames, etc, will be freed up.\n * // If you have some other nodes share a texture in this prefab, you can skip it in two ways:\n * // 1. Forbid auto release a texture before release\n * cc.loader.setAutoRelease(texture2d, false);\n * // 2. Remove it from the dependencies array\n * var deps = cc.loader.getDependsRecursively('prefabs/sample');\n * var index = deps.indexOf(texture2d._uuid);\n * if (index !== -1)\n *     deps.splice(index, 1);\n * cc.loader.release(deps);\n *\n * @method release\n * @param {Asset|RawAsset|String|Array} asset\n */\nproto.release = function (asset) {\n    if (Array.isArray(asset)) {\n        for (let i = 0; i < asset.length; i++) {\n            var key = asset[i];\n            this.release(key);\n        }\n    }\n    else if (asset) {\n        var id = this._getReferenceKey(asset);\n        if (!CC_EDITOR && id && id in cc.AssetLibrary.getBuiltinDeps()) return;\n        var item = this.getItem(id);\n        if (item) {\n            var removed = this.removeItem(id);\n            asset = item.content;\n            if (CC_DEBUG && removed) {\n                this._releasedAssetChecker_DEBUG.setReleased(item, id);\n            }\n        }\n        if (asset instanceof cc.Asset) {\n            let nativeUrl = asset.nativeUrl;\n            if (nativeUrl) {\n                this.release(nativeUrl);  // uncache loading item of native asset\n            }\n            asset.destroy();\n        }\n    }\n};\n\n/**\n * !#en Release the asset by its object. Refer to {{#crossLink \"loader/release:method\"}}{{/crossLink}} for detailed informations.\n * !#zh 通过资源对象自身来释放资源。详细信息请参考 {{#crossLink \"loader/release:method\"}}{{/crossLink}}\n *\n * @method releaseAsset\n * @param {Asset} asset\n */\nproto.releaseAsset = function (asset) {\n    var uuid = asset._uuid;\n    if (uuid) {\n        this.release(uuid);\n    }\n};\n\n/**\n * !#en Release the asset loaded by {{#crossLink \"loader/loadRes:method\"}}{{/crossLink}}. Refer to {{#crossLink \"loader/release:method\"}}{{/crossLink}} for detailed informations.\n * !#zh 释放通过 {{#crossLink \"loader/loadRes:method\"}}{{/crossLink}} 加载的资源。详细信息请参考 {{#crossLink \"loader/release:method\"}}{{/crossLink}}\n *\n * @method releaseRes\n * @param {String} url\n * @param {Function} [type] - Only asset of type will be released if this argument is supplied.\n */\nproto.releaseRes = function (url, type, mount) {\n    var uuid = this._getResUuid(url, type, mount);\n    if (uuid) {\n        this.release(uuid);\n    }\n    else {\n        cc.errorID(4914, url);\n    }\n};\n\n/**\n * !#en Release the all assets loaded by {{#crossLink \"loader/loadResDir:method\"}}{{/crossLink}}. Refer to {{#crossLink \"loader/release:method\"}}{{/crossLink}} for detailed informations.\n * !#zh 释放通过 {{#crossLink \"loader/loadResDir:method\"}}{{/crossLink}} 加载的资源。详细信息请参考 {{#crossLink \"loader/release:method\"}}{{/crossLink}}\n *\n * @method releaseResDir\n * @param {String} url\n * @param {Function} [type] - Only asset of type will be released if this argument is supplied.\n */\nproto.releaseResDir = function (url, type, mount) {\n    mount = mount || 'assets';\n    if (!assetTables[mount]) return;\n    \n    var uuids = assetTables[mount].getUuidArray(url, type);\n    for (var i = 0; i < uuids.length; i++) {\n        var uuid = uuids[i];\n        this.release(uuid);\n    }\n};\n\n/**\n * !#en Resource all assets. Refer to {{#crossLink \"loader/release:method\"}}{{/crossLink}} for detailed informations.\n * !#zh 释放所有资源。详细信息请参考 {{#crossLink \"loader/release:method\"}}{{/crossLink}}\n *\n * @method releaseAll\n */\nproto.releaseAll = function () {\n    for (var id in this._cache) {\n        this.release(id);\n    }\n};\n\n// AUTO RELEASE\n\n// override\nproto.removeItem = function (key) {\n    var removed = Pipeline.prototype.removeItem.call(this, key);\n    delete this._autoReleaseSetting[key];\n    return removed;\n};\n\n/**\n * !#en\n * Indicates whether to release the asset when loading a new scene.<br>\n * By default, when loading a new scene, all assets in the previous scene will be released or preserved\n * according to whether the previous scene checked the \"Auto Release Assets\" option.\n * On the other hand, assets dynamically loaded by using `cc.loader.loadRes` or `cc.loader.loadResDir`\n * will not be affected by that option, remain not released by default.<br>\n * Use this API to change the default behavior on a single asset, to force preserve or release specified asset when scene switching.<br>\n * <br>\n * See: {{#crossLink \"loader/setAutoReleaseRecursively:method\"}}cc.loader.setAutoReleaseRecursively{{/crossLink}}, {{#crossLink \"loader/isAutoRelease:method\"}}cc.loader.isAutoRelease{{/crossLink}}\n * !#zh\n * 设置当场景切换时是否自动释放资源。<br>\n * 默认情况下，当加载新场景时，旧场景的资源根据旧场景是否勾选“Auto Release Assets”，将会被释放或者保留。\n * 而使用 `cc.loader.loadRes` 或 `cc.loader.loadResDir` 动态加载的资源，则不受场景设置的影响，默认不自动释放。<br>\n * 使用这个 API 可以在单个资源上改变这个默认行为，强制在切换场景时保留或者释放指定资源。<br>\n * <br>\n * 参考：{{#crossLink \"loader/setAutoReleaseRecursively:method\"}}cc.loader.setAutoReleaseRecursively{{/crossLink}}，{{#crossLink \"loader/isAutoRelease:method\"}}cc.loader.isAutoRelease{{/crossLink}}\n *\n * @example\n * // auto release the texture event if \"Auto Release Assets\" disabled in current scene\n * cc.loader.setAutoRelease(texture2d, true);\n * // don't release the texture even if \"Auto Release Assets\" enabled in current scene\n * cc.loader.setAutoRelease(texture2d, false);\n * // first parameter can be url\n * cc.loader.setAutoRelease(audioUrl, false);\n *\n * @method setAutoRelease\n * @param {Asset|String} assetOrUrlOrUuid - asset object or the raw asset's url or uuid\n * @param {Boolean} autoRelease - indicates whether should release automatically\n */\nproto.setAutoRelease = function (assetOrUrlOrUuid, autoRelease) {\n    var key = this._getReferenceKey(assetOrUrlOrUuid);\n    if (key) {\n        this._autoReleaseSetting[key] = !!autoRelease;\n    }\n    else if (CC_DEV) {\n        cc.warnID(4902);\n    }\n};\n\n/**\n * !#en\n * Indicates whether to release the asset and its referenced other assets when loading a new scene.<br>\n * By default, when loading a new scene, all assets in the previous scene will be released or preserved\n * according to whether the previous scene checked the \"Auto Release Assets\" option.\n * On the other hand, assets dynamically loaded by using `cc.loader.loadRes` or `cc.loader.loadResDir`\n * will not be affected by that option, remain not released by default.<br>\n * Use this API to change the default behavior on the specified asset and its recursively referenced assets, to force preserve or release specified asset when scene switching.<br>\n * <br>\n * See: {{#crossLink \"loader/setAutoRelease:method\"}}cc.loader.setAutoRelease{{/crossLink}}, {{#crossLink \"loader/isAutoRelease:method\"}}cc.loader.isAutoRelease{{/crossLink}}\n * !#zh\n * 设置当场景切换时是否自动释放资源及资源引用的其它资源。<br>\n * 默认情况下，当加载新场景时，旧场景的资源根据旧场景是否勾选“Auto Release Assets”，将会被释放或者保留。\n * 而使用 `cc.loader.loadRes` 或 `cc.loader.loadResDir` 动态加载的资源，则不受场景设置的影响，默认不自动释放。<br>\n * 使用这个 API 可以在指定资源及资源递归引用到的所有资源上改变这个默认行为，强制在切换场景时保留或者释放指定资源。<br>\n * <br>\n * 参考：{{#crossLink \"loader/setAutoRelease:method\"}}cc.loader.setAutoRelease{{/crossLink}}，{{#crossLink \"loader/isAutoRelease:method\"}}cc.loader.isAutoRelease{{/crossLink}}\n *\n * @example\n * // auto release the SpriteFrame and its Texture event if \"Auto Release Assets\" disabled in current scene\n * cc.loader.setAutoReleaseRecursively(spriteFrame, true);\n * // don't release the SpriteFrame and its Texture even if \"Auto Release Assets\" enabled in current scene\n * cc.loader.setAutoReleaseRecursively(spriteFrame, false);\n * // don't release the Prefab and all the referenced assets\n * cc.loader.setAutoReleaseRecursively(prefab, false);\n *\n * @method setAutoReleaseRecursively\n * @param {Asset|String} assetOrUrlOrUuid - asset object or the raw asset's url or uuid\n * @param {Boolean} autoRelease - indicates whether should release automatically\n */\nproto.setAutoReleaseRecursively = function (assetOrUrlOrUuid, autoRelease) {\n    autoRelease = !!autoRelease;\n    var key = this._getReferenceKey(assetOrUrlOrUuid);\n    if (key) {\n        this._autoReleaseSetting[key] = autoRelease;\n\n        var depends = AutoReleaseUtils.getDependsRecursively(key);\n        for (var i = 0; i < depends.length; i++) {\n            var depend = depends[i];\n            this._autoReleaseSetting[depend] = autoRelease;\n        }\n    }\n    else if (CC_DEV) {\n        cc.warnID(4902);\n    }\n};\n\n\n/**\n * !#en\n * Returns whether the asset is configured as auto released, despite how \"Auto Release Assets\" property is set on scene asset.<br>\n * <br>\n * See: {{#crossLink \"loader/setAutoRelease:method\"}}cc.loader.setAutoRelease{{/crossLink}}, {{#crossLink \"loader/setAutoReleaseRecursively:method\"}}cc.loader.setAutoReleaseRecursively{{/crossLink}}\n *\n * !#zh\n * 返回指定的资源是否有被设置为自动释放，不论场景的“Auto Release Assets”如何设置。<br>\n * <br>\n * 参考：{{#crossLink \"loader/setAutoRelease:method\"}}cc.loader.setAutoRelease{{/crossLink}}，{{#crossLink \"loader/setAutoReleaseRecursively:method\"}}cc.loader.setAutoReleaseRecursively{{/crossLink}}\n * @method isAutoRelease\n * @param {Asset|String} assetOrUrl - asset object or the raw asset's url\n * @returns {Boolean}\n */\nproto.isAutoRelease = function (assetOrUrl) {\n    var key = this._getReferenceKey(assetOrUrl);\n    if (key) {\n        return !!this._autoReleaseSetting[key];\n    }\n    return false;\n};\n\ncc.loader = new CCLoader();\n\nif (CC_EDITOR) {\n    cc.loader.refreshUrl = function (uuid, oldUrl, newUrl) {\n        var item = this._cache[uuid];\n        if (item) {\n            item.url = newUrl;\n        }\n\n        item = this._cache[oldUrl];\n        if (item) {\n            item.id = newUrl;\n            item.url = newUrl;\n            this._cache[newUrl] = item;\n            delete this._cache[oldUrl];\n        }\n    };\n}\n\nmodule.exports = cc.loader;\n","/****************************************************************************\n Copyright (c) 2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('../utils/CCPath');\nconst debug = require('../CCDebug');\nconst Pipeline = require('./pipeline');\nconst LoadingItems = require('./loading-items');\n\nvar ID = 'AssetLoader';\n\nvar AssetLoader = function (extMap) {\n    this.id = ID;\n    this.async = true;\n    this.pipeline = null;\n};\nAssetLoader.ID = ID;\n\nvar reusedArray = [];\nAssetLoader.prototype.handle = function (item, callback) {\n    var uuid = item.uuid;\n    if (!uuid) {\n        return item.content || null;\n    }\n\n    var self = this;\n    cc.AssetLibrary.queryAssetInfo(uuid, function (error, url, isRawAsset) {\n        if (error) {\n            callback(error);\n        }\n        else {\n            item.url = item.rawUrl = url;\n            item.isRawAsset = isRawAsset;\n            if (isRawAsset) {\n                var ext = cc.path.extname(url).toLowerCase();\n                if (!ext) {\n                    callback(new Error(debug.getError(4931, uuid, url)));\n                    return;\n                }\n                ext = ext.substr(1);\n                var queue = LoadingItems.getQueue(item);\n                reusedArray[0] = {\n                    queueId: item.queueId,\n                    id: url,\n                    url: url,\n                    type: ext,\n                    error: null,\n                    alias: item,\n                    complete: true\n                };\n                if (CC_EDITOR) {\n                    self.pipeline._cache[url] = reusedArray[0];\n                }\n                queue.append(reusedArray);\n                // Dispatch to other raw type downloader\n                item.type = ext;\n                callback(null, item.content);\n            }\n            else {\n                item.type = 'uuid';\n                callback(null, item.content);\n            }\n        }\n    });\n};\n\nPipeline.AssetLoader = module.exports = AssetLoader;","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar pushToMap = require('../utils/misc').pushToMap;\nvar js = require('../platform/js');\n\nfunction Entry (uuid, type) {\n    this.uuid = uuid;\n    this.type = type;\n}\n\n/*\n * !#en AssetTable is used to find asset's uuid by url.\n * !#zh AssetTable 用于查找资源的 uuid 和 url。\n * @class AssetTable\n *\n */\n\nfunction AssetTable () {\n    this._pathToUuid = js.createMap(true);\n}\n\nfunction isMatchByWord (path, test) {\n    if (path.length > test.length) {\n        var nextAscii = path.charCodeAt(test.length);\n        return (nextAscii === 46 || nextAscii === 47); // '.' or '/'\n    }\n    return true;\n}\n\nvar proto = AssetTable.prototype;\n\nproto.getUuid = function (path, type) {\n    path = cc.url.normalize(path);\n    var item = this._pathToUuid[path];\n    if (item) {\n        if (Array.isArray(item)) {\n            if (type) {\n                for (var i = 0; i < item.length; i++) {\n                    var entry = item[i];\n                    if (js.isChildClassOf(entry.type, type)) {\n                        return entry.uuid;\n                    }\n                }\n                // not found\n                if (CC_DEBUG && js.isChildClassOf(type, cc.SpriteFrame)) {\n                    for (let i = 0; i < item.length; i++) {\n                        let entry = item[i];\n                        if (js.isChildClassOf(entry.type, cc.SpriteAtlas)) {\n                            // not support sprite frame in atlas\n                            cc.errorID(4932, path);\n                            break;\n                        }\n                    }\n                }\n            }\n            else {\n                return item[0].uuid;\n            }\n        }\n        else if (!type || js.isChildClassOf(item.type, type)) {\n            return item.uuid;\n        }\n        else if (CC_DEBUG && js.isChildClassOf(type, cc.SpriteFrame) && js.isChildClassOf(item.type, cc.SpriteAtlas)) {\n            // not support sprite frame in atlas\n            cc.errorID(4932, path);\n        }\n    }\n    return '';\n};\n\nproto.getUuidArray = function (path, type, out_urls) {\n    path = cc.url.normalize(path);\n    if (path[path.length - 1] === '/') {\n        path = path.slice(0, -1);\n    }\n    var path2uuid = this._pathToUuid;\n    var uuids = [];\n    var isChildClassOf = js.isChildClassOf;\n    var _foundAtlasUrl;\n    for (var p in path2uuid) {\n        if ((p.startsWith(path) && isMatchByWord(p, path)) || !path) {\n            var item = path2uuid[p];\n            if (Array.isArray(item)) {\n                for (var i = 0; i < item.length; i++) {\n                    var entry = item[i];\n                    if (!type || isChildClassOf(entry.type, type)) {\n                        uuids.push(entry.uuid);\n                        if (out_urls) {\n                            out_urls.push(p);\n                        }\n                    }\n                    else if (CC_DEBUG && entry.type === cc.SpriteAtlas) {\n                        _foundAtlasUrl = p;\n                    }\n                }\n            }\n            else {\n                if (!type || isChildClassOf(item.type, type)) {\n                    uuids.push(item.uuid);\n                    if (out_urls) {\n                        out_urls.push(p);\n                    }\n                }\n                else if (CC_DEBUG && item.type === cc.SpriteAtlas) {\n                    _foundAtlasUrl = p;\n                }\n            }\n        }\n    }\n    if (CC_DEBUG && uuids.length === 0 && _foundAtlasUrl && js.isChildClassOf(type, cc.SpriteFrame)) {\n        // not support sprite frame in atlas\n        cc.errorID(4932, _foundAtlasUrl);\n    }\n    return uuids;\n};\n\n// /**\n//  * !#en Returns all asset paths in the table.\n//  * !#zh 返回表中的所有资源路径。\n//  * @method getAllPaths\n//  * @return {string[]}\n//  */\n// proto.getAllPaths = function () {\n//     return Object.keys(this._pathToUuid);\n// };\n\n/**\n * !#en TODO\n * !#zh 以路径为 key，uuid 为值添加到表中。\n * @method add\n * @param {String} path - the path to load, should NOT include filename extensions.\n * @param {String} uuid\n * @param {Function} type\n * @param {Boolean} isMainAsset\n * @private\n */\nproto.add = function (path, uuid, type, isMainAsset) {\n    // remove extname\n    // (can not use path.slice because length of extname maybe 0)\n    path = path.substring(0, path.length - cc.path.extname(path).length);\n    var newEntry = new Entry(uuid, type);\n    pushToMap(this._pathToUuid, path, newEntry, isMainAsset);\n};\n\nproto._getInfo_DEBUG = CC_DEBUG && function (uuid, out_info) {\n    var path2uuid = this._pathToUuid;\n    var paths = Object.keys(path2uuid);\n    for (var p = 0; p < paths.length; ++p) {\n        var path = paths[p];\n        var item = path2uuid[path];\n        if (Array.isArray(item)) {\n            for (var i = 0; i < item.length; i++) {\n                var entry = item[i];\n                if (entry.uuid === uuid) {\n                    out_info.path = path;\n                    out_info.type = entry.type;\n                    return true;\n                }\n            }\n        }\n        else if (item.uuid === uuid) {\n            out_info.path = path;\n            out_info.type = item.type;\n            return true;\n        }\n    }\n    return false;\n};\n\nproto.reset = function () {\n    this._pathToUuid = js.createMap(true);\n};\n\n\nmodule.exports = AssetTable;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst sys = require('../platform/CCSys');\nconst debug = require('../CCDebug');\n\nvar __audioSupport = sys.__audioSupport;\nvar formatSupport = __audioSupport.format;\nvar context = __audioSupport.context;\n\nfunction loadDomAudio (item, callback) {\n    var dom = document.createElement('audio');\n    dom.src = item.url;\n\n    var clearEvent = function () {\n        clearTimeout(timer);\n        dom.removeEventListener(\"canplaythrough\", success, false);\n        dom.removeEventListener(\"error\", failure, false);\n        if(__audioSupport.USE_LOADER_EVENT)\n            dom.removeEventListener(__audioSupport.USE_LOADER_EVENT, success, false);\n    };\n    var timer = setTimeout(function () {\n        if (dom.readyState === 0)\n            failure();\n        else\n            success();\n    }, 8000);\n    var success = function () {\n        clearEvent();\n        callback(null, dom);\n    };\n    var failure = function () {\n        clearEvent();\n        var message = 'load audio failure - ' + item.url;\n        cc.log(message);\n        callback(message);\n    };\n    dom.addEventListener(\"canplaythrough\", success, false);\n    dom.addEventListener(\"error\", failure, false);\n    if(__audioSupport.USE_LOADER_EVENT)\n        dom.addEventListener(__audioSupport.USE_LOADER_EVENT, success, false);\n}\n\nfunction loadWebAudio (item, callback) {\n    if (!context)\n        callback(new Error(debug.getError(4926)));\n\n    var request = cc.loader.getXMLHttpRequest();\n    request.open(\"GET\", item.url, true);\n    request.responseType = \"arraybuffer\";\n\n    // Our asynchronous callback\n    request.onload = function () {\n        context[\"decodeAudioData\"](request.response, function(buffer){\n            //success\n            callback(null, buffer);\n        }, function(){\n            //error\n            callback('decode error - ' + item.id, null);\n        });\n    };\n\n    request.onerror = function(){\n        callback('request error - ' + item.id, null);\n    };\n\n    request.send();\n}\n\nfunction downloadAudio (item, callback) {\n    if (formatSupport.length === 0) {\n        return new Error(debug.getError(4927));\n    }\n\n    var loader;\n    if (!__audioSupport.WEB_AUDIO) {\n        // If WebAudio is not supported, load using DOM mode\n        loader = loadDomAudio;\n    }\n    else {\n        var loadByDeserializedAudio = item._owner instanceof cc.AudioClip;\n        if (loadByDeserializedAudio) {\n            loader = (item._owner.loadMode === cc.AudioClip.LoadMode.WEB_AUDIO) ? loadWebAudio : loadDomAudio;\n        }\n        else {\n            loader = (item.urlParam && item.urlParam['useDom']) ? loadDomAudio : loadWebAudio;\n        }\n    }\n    loader(item, callback);\n}\n\nmodule.exports = downloadAudio;\n","/****************************************************************************\n Copyright (c) 2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require('../platform/js');\n\nfunction parseDepends (key, parsed) {\n    var item = cc.loader.getItem(key);\n    if (item) {\n        var depends = item.dependKeys;\n        if (depends) {\n            for (var i = 0; i < depends.length; i++) {\n                var depend = depends[i];\n                if ( !parsed[depend] ) {\n                    parsed[depend] = true;\n                    parseDepends(depend, parsed);\n                }\n            }\n        }\n    }\n}\n\nfunction visitAsset (asset, excludeMap) {\n    // Skip assets generated programmatically or by user (e.g. label texture)\n    if (!asset._uuid) {\n        return;\n    }\n    var key = cc.loader._getReferenceKey(asset);\n    if ( !excludeMap[key] ) {\n        excludeMap[key] = true;\n        parseDepends(key, excludeMap);\n    }\n}\n\nfunction visitComponent (comp, excludeMap) {\n    var props = Object.getOwnPropertyNames(comp);\n    for (var i = 0; i < props.length; i++) {\n        var value = comp[props[i]];\n        if (typeof value === 'object' && value) {\n            if (Array.isArray(value)) {\n                for (let j = 0; j < value.length; j++) {\n                    let val = value[j];\n                    if (val instanceof cc.RawAsset) {\n                        visitAsset(val, excludeMap);\n                    }\n                }\n            }\n            else if (!value.constructor || value.constructor === Object) {\n                let keys = Object.getOwnPropertyNames(value);\n                for (let j = 0; j < keys.length; j++) {\n                    let val = value[keys[j]];\n                    if (val instanceof cc.RawAsset) {\n                        visitAsset(val, excludeMap);\n                    }\n                }\n            }\n            else if (value instanceof cc.RawAsset) {\n                visitAsset(value, excludeMap);\n            }\n        }\n    }\n}\n\nfunction visitNode (node, excludeMap) {\n    for (let i = 0; i < node._components.length; i++) {\n        visitComponent(node._components[i], excludeMap);\n    }\n    for (let i = 0; i < node._children.length; i++) {\n        visitNode(node._children[i], excludeMap);\n    }\n}\n\nmodule.exports = {\n    // do auto release\n    autoRelease: function (oldSceneAssets, nextSceneAssets, persistNodes) {\n        var releaseSettings = cc.loader._autoReleaseSetting;\n        var excludeMap = js.createMap();\n\n        // collect next scene assets\n        if (nextSceneAssets) {\n            for (let i = 0; i < nextSceneAssets.length; i++) {\n                excludeMap[nextSceneAssets[i]] = true;\n            }\n        }\n\n        // collect assets used by persist nodes\n        for (let i = 0; i < persistNodes.length; i++) {\n            visitNode(persistNodes[i], excludeMap)\n        }\n\n        // remove ununsed scene assets\n        if (oldSceneAssets) {\n            for (let i = 0; i < oldSceneAssets.length; i++) {\n                let key = oldSceneAssets[i];\n                if (releaseSettings[key] !== false && !excludeMap[key]) {\n                    cc.loader.release(key);\n                }\n            }\n        }\n\n        // remove auto release assets\n        // (releasing asset will change _autoReleaseSetting, so don't use for-in)\n        var keys = Object.keys(releaseSettings);\n        for (let i = 0; i < keys.length; i++) {\n            let key = keys[i];\n            if (releaseSettings[key] === true && !excludeMap[key]) {\n                cc.loader.release(key);\n            }\n        }\n    },\n\n    // get dependencies not including self\n    getDependsRecursively: function (key) {\n        var depends = {};\n        parseDepends(key, depends);\n        return Object.keys(depends);\n    }\n};\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nfunction downloadBinary (item, callback) {\n    var url = item.url;\n    var xhr = cc.loader.getXMLHttpRequest(),\n        errInfo = 'Load binary data failed: ' + url + '';\n    xhr.open('GET', url, true);\n    xhr.responseType = \"arraybuffer\";\n    xhr.onload = function () {\n        var arrayBuffer = xhr.response;\n        if (arrayBuffer) {\n            var result = new Uint8Array(arrayBuffer);\n            callback(null, result);\n        }\n        else {\n            callback({status:xhr.status, errorMessage:errInfo + '(no response)'});\n        }\n    };\n    xhr.onerror = function(){\n        callback({status:xhr.status, errorMessage:errInfo + '(error)'});\n    };\n    xhr.ontimeout = function(){\n        callback({status:xhr.status, errorMessage:errInfo + '(time out)'});\n    };\n    xhr.send(null);\n}\n\nmodule.exports = downloadBinary;","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst js = require('../platform/js');\nconst debug = require('../CCDebug');\nrequire('../utils/CCPath');\nconst Pipeline = require('./pipeline');\nconst PackDownloader = require('./pack-downloader');\n\nlet downloadBinary = require('./binary-downloader');\nlet downloadText = require('./text-downloader');\nlet urlAppendTimestamp = require('./utils').urlAppendTimestamp;\n\nvar downloadAudio;\nif (!CC_EDITOR || !Editor.isMainProcess) {\n    downloadAudio = require('./audio-downloader');\n}\nelse {\n    downloadAudio = null;\n}\n\nfunction skip () {\n    return null;\n}\n\nfunction downloadScript (item, callback, isAsync) {\n    var url = item.url,\n        d = document,\n        s = document.createElement('script');\n\n    if (window.location.protocol !== 'file:') {\n        s.crossOrigin = 'anonymous';\n    }\n\n    s.async = isAsync;\n    s.src = urlAppendTimestamp(url);\n    function loadHandler () {\n        s.parentNode.removeChild(s);\n        s.removeEventListener('load', loadHandler, false);\n        s.removeEventListener('error', errorHandler, false);\n        callback(null, url);\n    }\n    function errorHandler() {\n        s.parentNode.removeChild(s);\n        s.removeEventListener('load', loadHandler, false);\n        s.removeEventListener('error', errorHandler, false);\n        callback(new Error(debug.getError(4928, url)));\n    }\n    s.addEventListener('load', loadHandler, false);\n    s.addEventListener('error', errorHandler, false);\n    d.body.appendChild(s);\n}\n\nfunction downloadImage (item, callback, isCrossOrigin, img) {\n    if (isCrossOrigin === undefined) {\n        isCrossOrigin = true;\n    }\n\n    var url = urlAppendTimestamp(item.url);\n    img = img || new Image();\n    if (isCrossOrigin && window.location.protocol !== 'file:') {\n        img.crossOrigin = 'anonymous';\n    }\n    else {\n        img.crossOrigin = null;\n    }\n\n    if (img.complete && img.naturalWidth > 0 && img.src === url) {\n        return img;\n    }\n    else {\n        function loadCallback () {\n            img.removeEventListener('load', loadCallback);\n            img.removeEventListener('error', errorCallback);\n\n            img.id = item.id;\n            callback(null, img);\n        }\n        function errorCallback () {\n            img.removeEventListener('load', loadCallback);\n            img.removeEventListener('error', errorCallback);\n\n            // Retry without crossOrigin mark if crossOrigin loading fails\n            // Do not retry if protocol is https, even if the image is loaded, cross origin image isn't renderable.\n            if (window.location.protocol !== 'https:' && img.crossOrigin && img.crossOrigin.toLowerCase() === 'anonymous') {\n                downloadImage(item, callback, false, img);\n            }\n            else {\n                callback(new Error(debug.getError(4930, url)));\n            }\n        }\n\n        img.addEventListener('load', loadCallback);\n        img.addEventListener('error', errorCallback);\n        img.src = url;\n    }\n}\n\nfunction downloadUuid (item, callback) {\n    var result = PackDownloader.load(item, callback);\n    if (result === undefined) {\n        return this.extMap['json'](item, callback);\n    }\n    return result || undefined;\n}\n\n\nvar defaultMap = {\n    // JS\n    'js' : downloadScript,\n\n    // Images\n    'png' : downloadImage,\n    'jpg' : downloadImage,\n    'bmp' : downloadImage,\n    'jpeg' : downloadImage,\n    'gif' : downloadImage,\n    'ico' : downloadImage,\n    'tiff' : downloadImage,\n    'webp' : downloadImage,\n    'image' : downloadImage,\n    'pvr': downloadBinary,\n    'pkm': downloadBinary,\n\n    // Audio\n    'mp3' : downloadAudio,\n    'ogg' : downloadAudio,\n    'wav' : downloadAudio,\n    'm4a' : downloadAudio,\n\n    // Txt\n    'txt' : downloadText,\n    'xml' : downloadText,\n    'vsh' : downloadText,\n    'fsh' : downloadText,\n    'atlas' : downloadText,\n\n    'tmx' : downloadText,\n    'tsx' : downloadText,\n\n    'json' : downloadText,\n    'ExportJson' : downloadText,\n    'plist' : downloadText,\n\n    'fnt' : downloadText,\n\n    // Font\n    'font' : skip,\n    'eot' : skip,\n    'ttf' : skip,\n    'woff' : skip,\n    'svg' : skip,\n    'ttc' : skip,\n\n    // Deserializer\n    'uuid' : downloadUuid,\n\n    // Binary\n    'binary' : downloadBinary,\n    'bin' : downloadBinary,\n    'dbbin' : downloadBinary,\n    'skel': downloadBinary,\n\n    'default' : downloadText\n};\n\nvar ID = 'Downloader';\n\n/**\n * The downloader pipe, it can download several types of files:\n * 1. Text\n * 2. Image\n * 3. Script\n * 4. Audio\n * 5. Assets\n * All unknown type will be downloaded as plain text.\n * You can pass custom supported types in the constructor.\n * @class Pipeline.Downloader\n */\n/**\n * Constructor of Downloader, you can pass custom supported types.\n *\n * @method constructor\n * @param {Object} extMap Custom supported types with corresponded handler\n * @example\n *  var downloader = new Downloader({\n *      // This will match all url with `.scene` extension or all url with `scene` type\n *      'scene' : function (url, callback) {}\n *  });\n */\nvar Downloader = function (extMap) {\n    this.id = ID;\n    this.async = true;\n    this.pipeline = null;\n    this._curConcurrent = 0;\n    this._loadQueue = [];\n\n    this._subpackages = {};\n\n    this.extMap = js.mixin(extMap, defaultMap);\n};\nDownloader.ID = ID;\nDownloader.PackDownloader = PackDownloader;\n\n/**\n * Add custom supported types handler or modify existing type handler.\n * @method addHandlers\n * @param {Object} extMap Custom supported types with corresponded handler\n */\nDownloader.prototype.addHandlers = function (extMap) {\n    js.mixin(this.extMap, extMap);\n};\n\nDownloader.prototype._handleLoadQueue = function () {\n    while (this._curConcurrent < cc.macro.DOWNLOAD_MAX_CONCURRENT) {\n        var nextOne = this._loadQueue.shift();\n        if (!nextOne) {\n            break;\n        }\n        var syncRet = this.handle(nextOne.item, nextOne.callback);\n        if (syncRet !== undefined) {\n            if (syncRet instanceof Error) {\n                nextOne.callback(syncRet);\n            }\n            else {\n                nextOne.callback(null, syncRet);\n            }\n        }\n    }\n};\n\nDownloader.prototype.handle = function (item, callback) {\n    var self = this;\n    var downloadFunc = this.extMap[item.type] || this.extMap['default'];\n    var syncRet = undefined;\n    if (this._curConcurrent < cc.macro.DOWNLOAD_MAX_CONCURRENT) {\n        this._curConcurrent++;\n        syncRet = downloadFunc.call(this, item, function (err, result) {\n            self._curConcurrent = Math.max(0, self._curConcurrent - 1);\n            self._handleLoadQueue();\n            callback && callback(err, result);\n        });\n        if (syncRet !== undefined) {\n            this._curConcurrent = Math.max(0, this._curConcurrent - 1);\n            this._handleLoadQueue();\n            return syncRet;\n        }\n    }\n    else if (item.ignoreMaxConcurrency) {\n        syncRet = downloadFunc.call(this, item, callback);\n        if (syncRet !== undefined) {\n            return syncRet;\n        }\n    }\n    else {\n        this._loadQueue.push({\n            item: item,\n            callback: callback\n        });\n    }\n};\n\n/**\n * !#en\n * Load subpackage with name.\n * !#zh\n * 通过子包名加载子包代码。\n * @method loadSubpackage\n * @param {String} name - Subpackage name\n * @param {Function} [progressCallback] - Callback when progress changed\n * @param {Function} [completeCallback] -  Callback invoked when subpackage loaded\n * @param {Error} completeCallback.error - error information\n */\nDownloader.prototype.loadSubpackage = function (name, progressCallback, completeCallback) {\n    if (!completeCallback && progressCallback) {\n        completeCallback = progressCallback;\n        progressCallback = null;\n    }\n    let pac = this._subpackages[name];\n    if (pac) {\n        if (pac.loaded) {\n            if (completeCallback) completeCallback();\n        }\n        else {\n            downloadScript({url: pac.path + 'index.js'}, function (err) {\n                if (!err) {\n                    pac.loaded = true;\n                }\n                if (completeCallback) completeCallback(err);\n            });\n        }\n    }\n    else if (completeCallback) {\n        completeCallback(new Error(`Can't find subpackage ${name}`));\n    }\n};\n\nPipeline.Downloader = module.exports = Downloader;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst textUtils = require('../utils/text-utils');\n\nlet _canvasContext = null;\n// letter symbol number CJK\nlet _testString = \"BES bswy:->@123\\u4E01\\u3041\\u1101\";\n\nlet _fontFaces = {};\nlet _intervalId = -1;\nlet _loadingFonts = [];\n// 3 seconds timeout\nlet _timeout = 3000;\n\n// Refer to https://github.com/typekit/webfontloader/blob/master/src/core/fontwatcher.js\nlet useNativeCheck = (function () {\n    var nativeCheck = undefined;\n    return function () {\n        if (nativeCheck === undefined) {\n            if (!!window.FontFace) {\n                var match = /Gecko.*Firefox\\/(\\d+)/.exec(window.navigator.userAgent);\n                var safari10Match = /OS X.*Version\\/10\\..*Safari/.exec(window.navigator.userAgent) && /Apple/.exec(window.navigator.vendor);\n        \n                if (match) {\n                    nativeCheck = parseInt(match[1], 10) > 42;\n                } \n                else if (safari10Match) {\n                    nativeCheck = false;\n                } \n                else {\n                    nativeCheck = true;\n                }\n        \n            } else {\n                nativeCheck = false;\n            }\n        }\n\n        return nativeCheck;\n        \n    }\n})();\n\nfunction _checkFontLoaded () {\n    let allFontsLoaded = true;\n    let now = Date.now();\n\n    for (let i = _loadingFonts.length - 1; i >= 0; i--) {\n        let fontLoadHandle = _loadingFonts[i];\n        let fontFamily = fontLoadHandle.fontFamilyName;\n        // load timeout\n        if (now - fontLoadHandle.startTime > _timeout) {\n            cc.warnID(4933, fontFamily);\n            fontLoadHandle.callback(null, fontFamily);\n            _loadingFonts.splice(i, 1);\n            continue;\n        }\n\n        let oldWidth = fontLoadHandle.refWidth;\n        let fontDesc = '40px ' + fontFamily;\n        _canvasContext.font = fontDesc;\n        let newWidth = textUtils.safeMeasureText(_canvasContext, _testString, fontDesc);\n        // loaded successfully\n        if (oldWidth !== newWidth) {\n            _loadingFonts.splice(i, 1);\n            fontLoadHandle.callback(null, fontFamily);\n        }\n        else {\n            allFontsLoaded = false;\n        }\n    }\n\n    if (allFontsLoaded) {\n        clearInterval(_intervalId);\n        _intervalId = -1;\n    }\n}\n\n// refer to https://github.com/typekit/webfontloader/blob/master/src/core/nativefontwatchrunner.js\nfunction nativeCheckFontLoaded (start, font, callback) {\n    var loader = new Promise(function (resolve, reject) {\n        var check = function () {\n            var now = Date.now();\n\n            if (now - start >= _timeout) {\n                reject();\n            } \n            else {\n                document.fonts.load('40px ' + font).then(function (fonts) {\n                    if (fonts.length >= 1) {\n                        resolve();\n                    } \n                    else {\n                        setTimeout(check, 100);\n                    }\n                }, function () {\n                    reject();\n                });\n            }\n        };\n\n        check();\n    });\n  \n    var timeoutId = null,\n    timer = new Promise(function (resolve, reject) {\n        timeoutId = setTimeout(reject, _timeout);\n    });\n  \n    Promise.race([timer, loader]).then(function () {\n        if (timeoutId) {\n            clearTimeout(timeoutId);\n            timeoutId = null;\n        }\n        \n        callback(null, font);\n    }, function () {\n        cc.warnID(4933, font);\n        callback(null, font);\n    });\n}\n\nvar fontLoader = {\n    loadFont: function (item, callback) {\n        let url = item.url;\n        let fontFamilyName = fontLoader._getFontFamily(url);\n\n        // Already loaded fonts\n        if (_fontFaces[fontFamilyName]) {\n            return fontFamilyName;\n        }\n\n        if (!_canvasContext) {\n            let labelCanvas = document.createElement('canvas');\n            labelCanvas.width = 100;\n            labelCanvas.height = 100;\n            _canvasContext = labelCanvas.getContext('2d');\n        }\n        \n        // Default width reference to test whether new font is loaded correctly\n        let fontDesc = '40px ' + fontFamilyName;\n        _canvasContext.font = fontDesc;\n        let refWidth = textUtils.safeMeasureText(_canvasContext, _testString, fontDesc);\n\n        // Setup font face style\n        let fontStyle = document.createElement(\"style\");\n        fontStyle.type = \"text/css\";\n        let fontStr = \"\";\n        if (isNaN(fontFamilyName - 0))\n            fontStr += \"@font-face { font-family:\" + fontFamilyName + \"; src:\";\n        else\n            fontStr += \"@font-face { font-family:'\" + fontFamilyName + \"'; src:\";\n        fontStr += \"url('\" + url + \"');\";\n        fontStyle.textContent = fontStr + \"}\";\n        document.body.appendChild(fontStyle);\n\n        // Preload font with div\n        let preloadDiv = document.createElement(\"div\");\n        let divStyle = preloadDiv.style;\n        divStyle.fontFamily = fontFamilyName;\n        preloadDiv.innerHTML = \".\";\n        divStyle.position = \"absolute\";\n        divStyle.left = \"-100px\";\n        divStyle.top = \"-100px\";\n        document.body.appendChild(preloadDiv);\n\n        if (useNativeCheck()) {\n            nativeCheckFontLoaded(Date.now(), fontFamilyName, callback);\n        }\n        else {\n            // Save loading font\n            let fontLoadHandle = {\n                fontFamilyName,\n                refWidth,\n                callback,\n                startTime: Date.now()\n            }\n            _loadingFonts.push(fontLoadHandle);\n            if (_intervalId === -1) {\n                _intervalId = setInterval(_checkFontLoaded, 100);\n            }\n        }\n        _fontFaces[fontFamilyName] = fontStyle;\n        \n    },\n\n    _getFontFamily: function (fontHandle) {\n        var ttfIndex = fontHandle.lastIndexOf(\".ttf\");\n        if (ttfIndex === -1) return fontHandle;\n\n        var slashPos = fontHandle.lastIndexOf(\"/\");\n        var fontFamilyName;\n        if (slashPos === -1) {\n            fontFamilyName = fontHandle.substring(0, ttfIndex) + \"_LABEL\";\n        } else {\n            fontFamilyName = fontHandle.substring(slashPos + 1, ttfIndex) + \"_LABEL\";\n        }\n        if (fontFamilyName.indexOf(' ') !== -1) {\n            fontFamilyName = '\"' + fontFamilyName + '\"';\n        }\n        return fontFamilyName;\n    }\n};\n\nmodule.exports = fontLoader","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('./downloader');\nrequire('./loader');\n\nrequire('./loading-items');\nrequire('./pipeline');\n\nrequire('./CCLoader');\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst js = require('../platform/js');\nconst plistParser = require('../platform/CCSAXParser').plistParser;\nconst Pipeline = require('./pipeline');\nconst Texture2D = require('../assets/CCTexture2D');\nconst loadUuid = require('./uuid-loader');\nconst fontLoader = require('./font-loader');\n\nfunction loadNothing () {\n    return null;\n}\n\nfunction loadJSON (item) {\n    if (typeof item.content !== 'string') {\n        return new Error('JSON Loader: Input item doesn\\'t contain string content');\n    }\n\n    try {\n        var result = JSON.parse(item.content);\n        return result;\n    }\n    catch (e) {\n        return new Error('JSON Loader: Parse json [' + item.id + '] failed : ' + e);\n    }\n}\n\nfunction loadImage (item) {\n    var loadByDeserializedAsset = (item._owner instanceof cc.Asset);\n    if (loadByDeserializedAsset) {\n        // already has cc.Asset\n        return null;\n    }\n\n    var image = item.content;\n    if (cc.sys.platform !== cc.sys.FB_PLAYABLE_ADS && !(image instanceof Image)) {\n        return new Error('Image Loader: Input item doesn\\'t contain Image content');\n    } \n\n    // load cc.Texture2D\n    var tex = item.texture || new Texture2D();\n    tex._uuid = item.uuid;\n    tex.url = item.url;\n    tex._setRawAsset(item.rawUrl, false);\n    tex._nativeAsset = image;\n    return tex;\n}\n\n// If audio is loaded by url directly, than this loader will wrap it into a new cc.AudioClip object.\n// If audio is loaded by deserialized AudioClip, than this loader will be skipped.\nfunction loadAudioAsAsset (item, callback) {\n    var loadByDeserializedAsset = (item._owner instanceof cc.Asset);\n    if (loadByDeserializedAsset) {\n        // already has cc.Asset\n        return null;\n    }\n\n    var audioClip = new cc.AudioClip();\n    audioClip._setRawAsset(item.rawUrl, false);\n    audioClip._nativeAsset = item.content;\n    audioClip.url = item.url;\n    return audioClip;\n}\n\nfunction loadPlist (item) {\n    if (typeof item.content !== 'string') {\n        return new Error('Plist Loader: Input item doesn\\'t contain string content');\n    }\n    var result = plistParser.parse(item.content);\n    if (result) {\n        return result;\n    }\n    else {\n        return new Error('Plist Loader: Parse [' + item.id + '] failed');\n    }\n}\n\nfunction loadBinary (item) {\n    // Invoke custom handle\n    if (item.load) {\n        return item.load(item.content);\n    }\n    else {\n        return null;\n    }\n}\n\n//===============//\n// PVR constants //\n//===============//\n// https://github.com/toji/texture-tester/blob/master/js/webgl-texture-util.js#L424\nconst PVR_HEADER_LENGTH = 13; // The header length in 32 bit ints.\nconst PVR_MAGIC = 0x03525650; //0x50565203;\n\n// Offsets into the header array.\nconst PVR_HEADER_MAGIC = 0;\nconst PVR_HEADER_FORMAT = 2;\nconst PVR_HEADER_HEIGHT = 6;\nconst PVR_HEADER_WIDTH = 7;\nconst PVR_HEADER_MIPMAPCOUNT = 11;\nconst PVR_HEADER_METADATA = 12;\n\nfunction loadPVRTex (item) {\n    let buffer = item.content instanceof ArrayBuffer ? item.content : item.content.buffer;\n    // Get a view of the arrayBuffer that represents the DDS header.\n    let header = new Int32Array(buffer, 0, PVR_HEADER_LENGTH);\n\n    // Do some sanity checks to make sure this is a valid DDS file.\n    if(header[PVR_HEADER_MAGIC] != PVR_MAGIC) {\n      return new Error(\"Invalid magic number in PVR header\");\n    }\n\n    // Gather other basic metrics and a view of the raw the DXT data.\n    let width = header[PVR_HEADER_WIDTH];\n    let height = header[PVR_HEADER_HEIGHT];\n    let dataOffset = header[PVR_HEADER_METADATA] + 52;\n    let pvrtcData = new Uint8Array(buffer, dataOffset);\n\n    let pvrAsset = {\n        _data: pvrtcData,\n        _compressed: true,\n\n        width: width,\n        height: height,\n    };\n\n    return pvrAsset;\n}\n\n//===============//\n// ETC constants //\n//===============//\n\nconst ETC_PKM_HEADER_SIZE = 16;\n\nconst ETC_PKM_FORMAT_OFFSET = 6;\nconst ETC_PKM_ENCODED_WIDTH_OFFSET = 8;\nconst ETC_PKM_ENCODED_HEIGHT_OFFSET = 10;\nconst ETC_PKM_WIDTH_OFFSET = 12;\nconst ETC_PKM_HEIGHT_OFFSET = 14;\n\nconst ETC1_RGB_NO_MIPMAPS   = 0;\nconst ETC2_RGB_NO_MIPMAPS   = 1;\nconst ETC2_RGBA_NO_MIPMAPS  = 3;\n\n\nfunction readBEUint16(header, offset) {\n    return (header[offset] << 8) | header[offset+1];\n}\nfunction loadPKMTex(item) {\n    let buffer = item.content instanceof ArrayBuffer ? item.content : item.content.buffer;\n    let header = new Uint8Array(buffer);\n    let format = readBEUint16(header, ETC_PKM_FORMAT_OFFSET);\n    if (format !== ETC1_RGB_NO_MIPMAPS && format !== ETC2_RGB_NO_MIPMAPS && format !== ETC2_RGBA_NO_MIPMAPS) {\n        return new Error(\"Invalid magic number in ETC header\");\n    }\n    let width = readBEUint16(header, ETC_PKM_WIDTH_OFFSET);\n    let height = readBEUint16(header, ETC_PKM_HEIGHT_OFFSET);\n    let encodedWidth = readBEUint16(header, ETC_PKM_ENCODED_WIDTH_OFFSET);\n    let encodedHeight = readBEUint16(header, ETC_PKM_ENCODED_HEIGHT_OFFSET);\n    let etcData = new Uint8Array(buffer, ETC_PKM_HEADER_SIZE);\n    let etcAsset = {\n        _data: etcData,\n        _compressed: true,\n        width: width,\n        height: height\n    };\n    return etcAsset;\n}\n\nvar defaultMap = {\n    // Images\n    'png' : loadImage,\n    'jpg' : loadImage,\n    'bmp' : loadImage,\n    'jpeg' : loadImage,\n    'gif' : loadImage,\n    'ico' : loadImage,\n    'tiff' : loadImage,\n    'webp' : loadImage,\n    'image' : loadImage,\n    'pvr' : loadPVRTex,\n    'pkm' : loadPKMTex,\n\n    // Audio\n    'mp3' : loadAudioAsAsset,\n    'ogg' : loadAudioAsAsset,\n    'wav' : loadAudioAsAsset,\n    'm4a' : loadAudioAsAsset,\n\n    // json\n    'json' : loadJSON,\n    'ExportJson' : loadJSON,\n\n    // plist\n    'plist' : loadPlist,\n\n    // asset\n    'uuid' : loadUuid,\n    'prefab' : loadUuid,\n    'fire' : loadUuid,\n    'scene' : loadUuid,\n\n    // binary\n    'binary' : loadBinary,\n    'dbbin' : loadBinary,\n    'bin' : loadBinary,\n    'skel' : loadBinary,\n\n    // Font\n    'font' : fontLoader.loadFont,\n    'eot' : fontLoader.loadFont,\n    'ttf' : fontLoader.loadFont,\n    'woff' : fontLoader.loadFont,\n    'svg' : fontLoader.loadFont,\n    'ttc' : fontLoader.loadFont,\n\n    'default' : loadNothing\n};\n\nvar ID = 'Loader';\n\n/**\n * The loader pipe, it can load several types of files:\n * 1. Images\n * 2. JSON\n * 3. Plist\n * 4. Audio\n * 5. Font\n * 6. Cocos Creator scene\n * It will not interfere with items of unknown type.\n * You can pass custom supported types in the constructor.\n * @class Pipeline.Loader\n */\n/**\n * Constructor of Loader, you can pass custom supported types.\n *\n * @method constructor\n * @param {Object} extMap Custom supported types with corresponded handler\n * @example\n *var loader = new Loader({\n *    // This will match all url with `.scene` extension or all url with `scene` type\n *    'scene' : function (url, callback) {}\n *});\n */\nvar Loader = function (extMap) {\n    this.id = ID;\n    this.async = true;\n    this.pipeline = null;\n\n    this.extMap = js.mixin(extMap, defaultMap);\n};\nLoader.ID = ID;\n\n/**\n * Add custom supported types handler or modify existing type handler.\n * @method addHandlers\n * @param {Object} extMap Custom supported types with corresponded handler\n */\nLoader.prototype.addHandlers = function (extMap) {\n    this.extMap = js.mixin(this.extMap, extMap);\n};\n\nLoader.prototype.handle = function (item, callback) {\n    var loadFunc = this.extMap[item.type] || this.extMap['default'];\n    return loadFunc.call(this, item, callback);\n};\n\nPipeline.Loader = module.exports = Loader;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar CallbacksInvoker = require('../platform/callbacks-invoker');\nrequire('../utils/CCPath');\nvar js = require('../platform/js');\n\nvar _qid = (0|(Math.random()*998));\nvar _queues = js.createMap(true);\nvar _pool = [];\nvar _POOL_MAX_LENGTH = 10;\n\nvar ItemState = {\n    WORKING: 1,\n    COMPLETE: 2,\n    ERROR: 3\n};\n\nvar _queueDeps = js.createMap(true);\n\nfunction isIdValid (id) {\n    var realId = id.url || id;\n    return (typeof realId === 'string');\n}\n\nfunction _parseUrlParam (url) {\n    if (!url) return undefined;\n    var split = url.split('?');\n    if (!split || !split[0] || !split[1]) {\n        return undefined;\n    }\n    var urlParam = {};\n    var queries = split[1].split('&');\n    queries.forEach(function (item) {\n        var itemSplit = item.split('=');\n        urlParam[itemSplit[0]] = itemSplit[1];\n    });\n    return urlParam;\n}\nfunction createItem (id, queueId) {\n    var url = (typeof id === 'object') ? id.url : id;\n    var result = {\n        queueId: queueId,\n        id: url,\n        url: url, // real download url, maybe changed\n        rawUrl: undefined, // url used in scripts\n        urlParam: _parseUrlParam(url),\n        type: \"\",\n        error: null,\n        content: null,\n        complete: false,\n        states: {},\n        deps: null\n    };\n\n    if (typeof id === 'object') {\n        js.mixin(result, id);\n        if (id.skips) {\n            for (var i = 0; i < id.skips.length; i++) {\n                var skip = id.skips[i];\n                result.states[skip] = ItemState.COMPLETE;\n            }\n        }\n    }\n    result.rawUrl = result.url;\n    if (url && !result.type) {\n        result.type = cc.path.extname(url).toLowerCase().substr(1);\n    }\n    return result;\n}\n\nvar checkedIds = [];\nfunction checkCircleReference(owner, item, recursiveCall) {\n    if (!owner || !item) {\n        return false;\n    }\n    var result = false;\n    checkedIds.push(item.id);\n    if (item.deps) {\n        var i, deps = item.deps, subDep;\n        for (i = 0; i < deps.length; i++) {\n            subDep = deps[i];\n            if (subDep.id === owner.id) {\n                result = true;\n                break;\n            }\n            else if (checkedIds.indexOf(subDep.id) >= 0) {\n                continue;\n            }\n            else if (subDep.deps && checkCircleReference(owner, subDep, true)) {\n                result = true;\n                break;\n            }\n        }\n    }\n    if (!recursiveCall) {\n        checkedIds.length = 0;\n    }\n    return result;\n}\n\n/**\n * !#en\n * LoadingItems is the queue of items which can flow them into the loading pipeline.<br/>\n * Please don't construct it directly, use {{#crossLink \"LoadingItems.create\"}}cc.LoadingItems.create{{/crossLink}} instead, because we use an internal pool to recycle the queues.<br/>\n * It hold a map of items, each entry in the map is a url to object key value pair.<br/>\n * Each item always contains the following property:<br/>\n * - id: The identification of the item, usually it's identical to url<br/>\n * - url: The url <br/>\n * - type: The type, it's the extension name of the url by default, could be specified manually too.<br/>\n * - error: The error happened in pipeline will be stored in this property.<br/>\n * - content: The content processed by the pipeline, the final result will also be stored in this property.<br/>\n * - complete: The flag indicate whether the item is completed by the pipeline.<br/>\n * - states: An object stores the states of each pipe the item go through, the state can be: Pipeline.ItemState.WORKING | Pipeline.ItemState.ERROR | Pipeline.ItemState.COMPLETE<br/>\n * <br/>\n * Item can hold other custom properties.<br/>\n * Each LoadingItems object will be destroyed for recycle after onComplete callback<br/>\n * So please don't hold its reference for later usage, you can copy properties in it though.\n * !#zh\n * LoadingItems 是一个加载对象队列，可以用来输送加载对象到加载管线中。<br/>\n * 请不要直接使用 new 构造这个类的对象，你可以使用 {{#crossLink \"LoadingItems.create\"}}cc.LoadingItems.create{{/crossLink}} 来创建一个新的加载队列，这样可以允许我们的内部对象池回收并重利用加载队列。\n * 它有一个 map 属性用来存放加载项，在 map 对象中以 url 为 key 值。<br/>\n * 每个对象都会包含下列属性：<br/>\n * - id：该对象的标识，通常与 url 相同。<br/>\n * - url：路径 <br/>\n * - type: 类型，它这是默认的 URL 的扩展名，可以手动指定赋值。<br/>\n * - error：pipeline 中发生的错误将被保存在这个属性中。<br/>\n * - content: pipeline 中处理的临时结果，最终的结果也将被存储在这个属性中。<br/>\n * - complete：该标志表明该对象是否通过 pipeline 完成。<br/>\n * - states：该对象存储每个管道中对象经历的状态，状态可以是 Pipeline.ItemState.WORKING | Pipeline.ItemState.ERROR | Pipeline.ItemState.COMPLETE<br/>\n * <br/>\n * 对象可容纳其他自定义属性。<br/>\n * 每个 LoadingItems 对象都会在 onComplete 回调之后被销毁，所以请不要持有它的引用并在结束回调之后依赖它的内容执行任何逻辑，有这种需求的话你可以提前复制它的内容。\n *\n * @class LoadingItems\n * @extends CallbacksInvoker\n */\nvar LoadingItems = function (pipeline, urlList, onProgress, onComplete) {\n    CallbacksInvoker.call(this);\n\n    this._id = ++_qid;\n\n    _queues[this._id] = this;\n\n    this._pipeline = pipeline;\n\n    this._errorUrls = js.createMap(true);\n\n    this._appending = false;\n\n    this._ownerQueue = null;\n\n    /**\n     * !#en This is a callback which will be invoked while an item flow out the pipeline.\n     * You can pass the callback function in LoadingItems.create or set it later.\n     * !#zh 这个回调函数将在 item 加载结束后被调用。你可以在构造时传递这个回调函数或者是在构造之后直接设置。\n     * @method onProgress\n     * @param {Number} completedCount The number of the items that are already completed.\n     * @param {Number} totalCount The total number of the items.\n     * @param {Object} item The latest item which flow out the pipeline.\n     * @example\n     *  loadingItems.onProgress = function (completedCount, totalCount, item) {\n     *      var progress = (100 * completedCount / totalCount).toFixed(2);\n     *      cc.log(progress + '%');\n     *  }\n     */\n    this.onProgress = onProgress;\n\n    /**\n     * !#en This is a callback which will be invoked while all items is completed,\n     * You can pass the callback function in LoadingItems.create or set it later.\n     * !#zh 该函数将在加载队列全部完成时被调用。你可以在构造时传递这个回调函数或者是在构造之后直接设置。\n     * @method onComplete\n     * @param {Array} errors All errored urls will be stored in this array, if no error happened, then it will be null\n     * @param {LoadingItems} items All items.\n     * @example\n     *  loadingItems.onComplete = function (errors, items) {\n     *      if (error)\n     *          cc.log('Completed with ' + errors.length + ' errors');\n     *      else\n     *          cc.log('Completed ' + items.totalCount + ' items');\n     *  }\n     */\n    this.onComplete = onComplete;\n\n    /**\n     * !#en The map of all items.\n     * !#zh 存储所有加载项的对象。\n     * @property map\n     * @type {Object}\n     */\n    this.map = js.createMap(true);\n\n    /**\n     * !#en The map of completed items.\n     * !#zh 存储已经完成的加载项。\n     * @property completed\n     * @type {Object}\n     */\n    this.completed = {};\n\n    /**\n     * !#en Total count of all items.\n     * !#zh 所有加载项的总数。\n     * @property totalCount\n     * @type {Number}\n     */\n    this.totalCount = 0;\n\n    /**\n     * !#en Total count of completed items.\n     * !#zh 所有完成加载项的总数。\n     * @property completedCount\n     * @type {Number}\n     */\n    this.completedCount = 0;\n\n    /**\n     * !#en Activated or not.\n     * !#zh 是否启用。\n     * @property active\n     * @type {Boolean}\n     */\n    if (this._pipeline) {\n        this.active = true;\n    }\n    else {\n        this.active = false;\n    }\n\n    if (urlList) {\n        if (urlList.length > 0) {\n            this.append(urlList);\n        }\n        else {\n            this.allComplete();\n        }\n    }\n};\n\n/**\n * !#en The item states of the LoadingItems, its value could be LoadingItems.ItemState.WORKING | LoadingItems.ItemState.COMPLETET | LoadingItems.ItemState.ERROR\n * !#zh LoadingItems 队列中的加载项状态，状态的值可能是 LoadingItems.ItemState.WORKING | LoadingItems.ItemState.COMPLETET | LoadingItems.ItemState.ERROR\n * @enum LoadingItems.ItemState\n */\n\n/**\n * @property {Number} WORKING\n */\n\n/**\n * @property {Number} COMPLETET\n */\n\n/**\n * @property {Number} ERROR\n */\n\nLoadingItems.ItemState = new cc.Enum(ItemState);\n\n/**\n * @class LoadingItems\n * @extends CallbacksInvoker\n*/\n\n/**\n * !#en The constructor function of LoadingItems, this will use recycled LoadingItems in the internal pool if possible.\n * You can pass onProgress and onComplete callbacks to visualize the loading process.\n * !#zh LoadingItems 的构造函数，这种构造方式会重用内部对象缓冲池中的 LoadingItems 队列，以尽量避免对象创建。\n * 你可以传递 onProgress 和 onComplete 回调函数来获知加载进度信息。\n * @method create\n * @static\n * @param {Pipeline} pipeline The pipeline to process the queue.\n * @param {Array} urlList The items array.\n * @param {Function} onProgress The progression callback, refer to {{#crossLink \"LoadingItems.onProgress\"}}{{/crossLink}}\n * @param {Function} onComplete The completion callback, refer to {{#crossLink \"LoadingItems.onComplete\"}}{{/crossLink}}\n * @return {LoadingItems} The LoadingItems queue object\n * @example\n *  cc.LoadingItems.create(cc.loader, ['a.png', 'b.plist'], function (completedCount, totalCount, item) {\n *      var progress = (100 * completedCount / totalCount).toFixed(2);\n *      cc.log(progress + '%');\n *  }, function (errors, items) {\n *      if (errors) {\n *          for (var i = 0; i < errors.length; ++i) {\n *              cc.log('Error url: ' + errors[i] + ', error: ' + items.getError(errors[i]));\n *          }\n *      }\n *      else {\n *          var result_a = items.getContent('a.png');\n *          // ...\n *      }\n *  })\n */\nLoadingItems.create = function (pipeline, urlList, onProgress, onComplete) {\n    if (onProgress === undefined) {\n        if (typeof urlList === 'function') {\n            onComplete = urlList;\n            urlList = onProgress = null;\n        }\n    }\n    else if (onComplete === undefined) {\n        if (typeof urlList === 'function') {\n            onComplete = onProgress;\n            onProgress = urlList;\n            urlList = null;\n        }\n        else {\n            onComplete = onProgress;\n            onProgress = null;\n        }\n    }\n\n    var queue = _pool.pop();\n    if (queue) {\n        queue._pipeline = pipeline;\n        queue.onProgress = onProgress;\n        queue.onComplete = onComplete;\n        _queues[queue._id] = queue;\n        if (queue._pipeline) {\n            queue.active = true;\n        }\n        if (urlList) {\n            queue.append(urlList);\n        }\n    }\n    else {\n        queue = new LoadingItems(pipeline, urlList, onProgress, onComplete);\n    }\n\n    return queue;\n};\n\n/**\n * !#en Retrieve the LoadingItems queue object for an item.\n * !#zh 通过 item 对象获取它的 LoadingItems 队列。\n * @method getQueue\n * @static\n * @param {Object} item The item to query\n * @return {LoadingItems} The LoadingItems queue object\n */\nLoadingItems.getQueue = function (item) {\n    return item.queueId ? _queues[item.queueId] : null;\n};\n\n/**\n * !#en Complete an item in the LoadingItems queue, please do not call this method unless you know what's happening.\n * !#zh 通知 LoadingItems 队列一个 item 对象已完成，请不要调用这个函数，除非你知道自己在做什么。\n * @method itemComplete\n * @static\n * @param {Object} item The item which has completed\n */\nLoadingItems.itemComplete = function (item) {\n    var queue = _queues[item.queueId];\n    if (queue) {\n        // console.log('----- Completed by pipeline ' + item.id + ', rest: ' + (queue.totalCount - queue.completedCount-1));\n        queue.itemComplete(item.id);\n    }\n};\n\nLoadingItems.initQueueDeps = function (queue) {\n    var dep = _queueDeps[queue._id];\n    if (!dep) {\n        dep = _queueDeps[queue._id] = {\n            completed: [],\n            deps: []\n        };\n    }\n    else {\n        dep.completed.length = 0;\n        dep.deps.length = 0;\n    }\n};\n\nLoadingItems.registerQueueDep = function (owner, depId) {\n    var queueId = owner.queueId || owner;\n    if (!queueId) {\n        return false;\n    }\n    var queueDepList = _queueDeps[queueId];\n    // Owner is root queue\n    if (queueDepList) {\n        if (queueDepList.deps.indexOf(depId) === -1) {\n            queueDepList.deps.push(depId);\n        }\n    }\n    // Owner is an item in the intermediate queue\n    else if (owner.id) {\n        for (var id in _queueDeps) {\n            var queue = _queueDeps[id];\n            // Found root queue\n            if (queue.deps.indexOf(owner.id) !== -1) {\n                if (queue.deps.indexOf(depId) === -1) {\n                    queue.deps.push(depId);\n                }\n            }\n        }\n    }\n};\n\nLoadingItems.finishDep = function (depId) {\n    for (var id in _queueDeps) {\n        var queue = _queueDeps[id];\n        // Found root queue\n        if (queue.deps.indexOf(depId) !== -1 && queue.completed.indexOf(depId) === -1) {\n            queue.completed.push(depId);\n        }\n    }\n};\n\nvar proto = LoadingItems.prototype;\njs.mixin(proto, CallbacksInvoker.prototype);\n\n/**\n * !#en Add urls to the LoadingItems queue.\n * !#zh 向一个 LoadingItems 队列添加加载项。\n * @method append\n * @param {Array} urlList The url list to be appended, the url can be object or string\n * @return {Array} The accepted url list, some invalid items could be refused.\n */\nproto.append = function (urlList, owner) {\n    if (!this.active) {\n        return [];\n    }\n    if (owner && !owner.deps) {\n        owner.deps = [];\n    }\n\n    this._appending = true;\n    var accepted = [], i, url, item;\n    for (i = 0; i < urlList.length; ++i) {\n        url = urlList[i];\n\n        // Already queued in another items queue, url is actually the item\n        if (url.queueId && !this.map[url.id]) {\n            this.map[url.id] = url;\n            // Register item deps for circle reference check\n            owner && owner.deps.push(url);\n            // Queued and completed or Owner circle referenced by dependency\n            if (url.complete || checkCircleReference(owner, url)) {\n                this.totalCount++;\n                // console.log('----- Completed already or circle referenced ' + url.id + ', rest: ' + (this.totalCount - this.completedCount-1));\n                this.itemComplete(url.id);\n                continue;\n            }\n            // Not completed yet, should wait it\n            else {\n                var self = this;\n                var queue = _queues[url.queueId];\n                if (queue) {\n                    this.totalCount++;\n                    LoadingItems.registerQueueDep(owner || this._id, url.id);\n                    // console.log('+++++ Waited ' + url.id);\n                    queue.addListener(url.id, function (item) {\n                        // console.log('----- Completed by waiting ' + item.id + ', rest: ' + (self.totalCount - self.completedCount-1));\n                        self.itemComplete(item.id);\n                    });\n                }\n                continue;\n            }\n        }\n        // Queue new items\n        if (isIdValid(url)) {\n            item = createItem(url, this._id);\n            var key = item.id;\n            // No duplicated url\n            if (!this.map[key]) {\n                this.map[key] = item;\n                this.totalCount++;\n                // Register item deps for circle reference check\n                owner && owner.deps.push(item);\n                LoadingItems.registerQueueDep(owner || this._id, key);\n                accepted.push(item);\n                // console.log('+++++ Appended ' + item.id);\n            }\n        }\n    }\n    this._appending = false;\n\n    // Manually complete\n    if (this.completedCount === this.totalCount) {\n        // console.log('===== All Completed ');\n        this.allComplete();\n    }\n    else {\n        this._pipeline.flowIn(accepted);\n    }\n    return accepted;\n};\n\nproto._childOnProgress = function (item) {\n    if (this.onProgress) {\n        var dep = _queueDeps[this._id];\n        this.onProgress(dep ? dep.completed.length : this.completedCount, dep ? dep.deps.length : this.totalCount, item);\n    }\n};\n\n/**\n * !#en Complete a LoadingItems queue, please do not call this method unless you know what's happening.\n * !#zh 完成一个 LoadingItems 队列，请不要调用这个函数，除非你知道自己在做什么。\n * @method allComplete\n */\nproto.allComplete = function () {\n    var errors = js.isEmptyObject(this._errorUrls) ? null : this._errorUrls;\n\n    if (this.onComplete) {\n        this.onComplete(errors, this);\n    }\n};\n\n/**\n * !#en Check whether all items are completed.\n * !#zh 检查是否所有加载项都已经完成。\n * @method isCompleted\n * @return {Boolean}\n */\nproto.isCompleted = function () {\n    return this.completedCount >= this.totalCount;\n};\n\n/**\n * !#en Check whether an item is completed.\n * !#zh 通过 id 检查指定加载项是否已经加载完成。\n * @method isItemCompleted\n * @param {String} id The item's id.\n * @return {Boolean}\n */\nproto.isItemCompleted = function (id) {\n    return !!this.completed[id];\n};\n\n/**\n * !#en Check whether an item exists.\n * !#zh 通过 id 检查加载项是否存在。\n * @method exists\n * @param {String} id The item's id.\n * @return {Boolean}\n */\nproto.exists = function (id) {\n    return !!this.map[id];\n};\n\n/**\n * !#en Returns the content of an internal item.\n * !#zh 通过 id 获取指定对象的内容。\n * @method getContent\n * @param {String} id The item's id.\n * @return {Object}\n */\nproto.getContent = function (id) {\n    var item = this.map[id];\n    var ret = null;\n    if (item) {\n        if (item.content) {\n            ret = item.content;\n        }\n        else if (item.alias) {\n            ret = item.alias.content;\n        }\n    }\n\n    return ret;\n};\n\n/**\n * !#en Returns the error of an internal item.\n * !#zh 通过 id 获取指定对象的错误信息。\n * @method getError\n * @param {String} id The item's id.\n * @return {Object}\n */\nproto.getError = function (id) {\n    var item = this.map[id];\n    var ret = null;\n    if (item) {\n        if (item.error) {\n            ret = item.error;\n        } else if (item.alias) {\n            ret = item.alias.error;\n        }\n    }\n\n    return ret;\n};\n\n/**\n * !#en Add a listener for an item, the callback will be invoked when the item is completed.\n * !#zh 监听加载项（通过 key 指定）的完成事件。\n * @method addListener\n * @param {String} key\n * @param {Function} callback - can be null\n * @param {Object} target - can be null\n * @return {Boolean} whether the key is new\n */\nproto.addListener = CallbacksInvoker.prototype.on;\n\n/**\n * !#en\n * Check if the specified key has any registered callback. \n * If a callback is also specified, it will only return true if the callback is registered.\n * !#zh\n * 检查指定的加载项是否有完成事件监听器。\n * 如果同时还指定了一个回调方法，并且回调有注册，它只会返回 true。\n * @method hasListener\n * @param {String} key\n * @param {Function} [callback]\n * @param {Object} [target]\n * @return {Boolean}\n */\nproto.hasListener = CallbacksInvoker.prototype.hasEventListener;\n\n/**\n * !#en\n * Removes a listener. \n * It will only remove when key, callback, target all match correctly.\n * !#zh\n * 移除指定加载项已经注册的完成事件监听器。\n * 只会删除 key, callback, target 均匹配的监听器。\n * @method remove\n * @param {String} key\n * @param {Function} callback\n * @param {Object} target\n * @return {Boolean} removed\n */\nproto.removeListener = CallbacksInvoker.prototype.off;\n\n/**\n * !#en\n * Removes all callbacks registered in a certain event\n * type or all callbacks registered with a certain target.\n * !#zh 删除指定目标的所有完成事件监听器。\n * @method removeAllListeners\n * @param {String|Object} key - The event key to be removed or the target to be removed\n */\nproto.removeAllListeners = CallbacksInvoker.prototype.removeAll;\n\n/**\n * !#en Remove an item, can only remove completed item, ongoing item can not be removed.\n * !#zh 移除加载项，这里只会移除已经完成的加载项，正在进行的加载项将不能被删除。\n * @param {String} url\n */\nproto.removeItem = function (url) {\n    var item = this.map[url];\n    if (!item) return;\n\n    if (!this.completed[item.alias || url]) return;\n\n    delete this.completed[url];\n    delete this.map[url];\n    if (item.alias) {\n        delete this.completed[item.alias.id];\n        delete this.map[item.alias.id];\n    }\n\n    this.completedCount--;\n    this.totalCount--;\n};\n\n/**\n * !#en Complete an item in the LoadingItems queue, please do not call this method unless you know what's happening.\n * !#zh 通知 LoadingItems 队列一个 item 对象已完成，请不要调用这个函数，除非你知道自己在做什么。\n * @method itemComplete\n * @param {String} id The item url\n */\nproto.itemComplete = function (id) {\n    var item = this.map[id];\n    if (!item) {\n        return;\n    }\n\n    // Register or unregister errors\n    \n    var errorListId = id in this._errorUrls;\n    if (item.error instanceof Error || js.isString(item.error)) {\n        this._errorUrls[id] = item.error;\n    }\n    else if (item.error) {\n        js.mixin(this._errorUrls, item.error);\n    }\n    else if (!item.error && errorListId) {\n        delete this._errorUrls[id] \n    }\n\n    this.completed[id] = item;\n    this.completedCount++;\n\n    LoadingItems.finishDep(item.id);\n    if (this.onProgress) {\n        var dep = _queueDeps[this._id];\n        this.onProgress(dep ? dep.completed.length : this.completedCount, dep ? dep.deps.length : this.totalCount, item);\n    }\n\n    this.emit(id, item);\n    this.removeAll(id);\n\n    // All completed\n    if (!this._appending && this.completedCount >= this.totalCount) {\n        // console.log('===== All Completed ');\n        this.allComplete();\n    }\n};\n\n/**\n * !#en Destroy the LoadingItems queue, the queue object won't be garbage collected, it will be recycled, so every after destroy is not reliable.\n * !#zh 销毁一个 LoadingItems 队列，这个队列对象会被内部缓冲池回收，所以销毁后的所有内部信息都是不可依赖的。\n * @method destroy\n */\nproto.destroy = function () {\n    this.active = false;\n    this._appending = false;\n    this._pipeline = null;\n    this._ownerQueue = null;\n    js.clear(this._errorUrls);\n    this.onProgress = null;\n    this.onComplete = null;\n\n    this.map = js.createMap(true);\n    this.completed = {};\n\n    this.totalCount = 0;\n    this.completedCount = 0;\n\n    // Reinitialize CallbacksInvoker, generate three new objects, could be improved\n    CallbacksInvoker.call(this);\n    \n    if (_queueDeps[this._id]) {\n        _queueDeps[this._id].completed.length = 0;\n        _queueDeps[this._id].deps.length = 0;\n    }\n    delete _queues[this._id];\n    delete _queueDeps[this._id];\n\n    if (_pool.indexOf(this) === -1 && _pool.length < _POOL_MAX_LENGTH) {\n        _pool.push(this);\n    }\n};\n\ncc.LoadingItems = module.exports = LoadingItems;\n","/****************************************************************************\n Copyright (c) 2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar Pipeline = require('./pipeline');\n\nconst ID = 'MD5Pipe';\nconst UuidRegex = /.*[/\\\\][0-9a-fA-F]{2}[/\\\\]([0-9a-fA-F-]{8,})/;\n\nvar MD5Pipe = function (md5AssetsMap, md5NativeAssetsMap, libraryBase) {\n    this.id = ID;\n    this.async = false;\n    this.pipeline = null;\n    this.md5AssetsMap = md5AssetsMap;\n    this.md5NativeAssetsMap = md5NativeAssetsMap;\n    this.libraryBase = libraryBase;\n};\nMD5Pipe.ID = ID;\n\nMD5Pipe.prototype.handle = function(item) {\n    item.url = this.transformURL(item.url);\n    return null;\n};\n\nMD5Pipe.prototype.transformURL = function (url) {\n    let isNativeAsset = !url.startsWith(this.libraryBase);\n    let map = isNativeAsset ? this.md5NativeAssetsMap : this.md5AssetsMap;\n    url = url.replace(UuidRegex, function (match, uuid) {\n        let hashValue = map[uuid];\n        return hashValue ? match + '.' + hashValue : match;\n    });\n    return url;\n};\n\n\nPipeline.MD5Pipe = module.exports = MD5Pipe;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar Unpackers = require('./unpackers');\nvar pushToMap = require('../utils/misc').pushToMap;\n\n// when more than one package contains the required asset,\n// choose to load from the package with the largest state value.\nvar PackState = {\n    Invalid: 0,\n    Removed: 1,\n    Downloading: 2,\n    Loaded: 3,\n};\n\nfunction UnpackerData () {\n    this.unpacker = null;\n    this.state = PackState.Invalid;\n    this.duration = 0;\n}\n\n// {assetUuid: packUuid|[packUuid]}\n// If value is array of packUuid, then the first one will be prioritized for download,\n// so the smallest pack must be at the beginning of the array.\nvar uuidToPack = {};\n\n// {packUuid: assetIndices}\nvar packIndices = {};\n\n// {packUuid: UnpackerData}\n// We have to cache all packs in global because for now there's no operation context in loader.\nvar globalUnpackers = {};\n\nvar toBeChecked = [];\n\nvar timer = null;\nvar checkPeriod = 5000;\n\nfunction error (uuid, packUuid) {\n    return new Error('Can not retrieve ' + uuid + ' from packer ' + packUuid);\n}\n\nmodule.exports = {\n    // two minutes\n    msToRelease: 2 * 60 * 1000,\n\n    initPacks: function (packs) {\n        packIndices = packs;\n        uuidToPack = {};\n        for (var packUuid in packs) {\n            var uuids = packs[packUuid];\n            for (var i = 0; i < uuids.length; i++) {\n                var uuid = uuids[i];\n                // the smallest pack must be at the beginning of the array to download more first\n                var pushFront = uuids.length === 1;\n                pushToMap(uuidToPack, uuid, packUuid, pushFront);\n            }\n        }\n    },\n\n    _loadNewPack: function (uuid, packUuid, callback) {\n        var self = this;\n        var packUrl = cc.AssetLibrary.getLibUrlNoExt(packUuid) + '.json';\n        cc.loader.load({ url: packUrl, ignoreMaxConcurrency: true }, function (err, packJson) {\n            if (err) {\n                cc.errorID(4916, uuid);\n                return callback(err);\n            }\n            globalUnpackers[packUuid].url = packUrl;\n            var res = self._doLoadNewPack(uuid, packUuid, packJson);\n            if (res) {\n                callback(null, res);\n            }\n            else {\n                callback(error(uuid, packUuid));\n            }\n        });\n    },\n\n    _doPreload (packUuid, packJson) {\n        var unpackerData = globalUnpackers[packUuid];\n        if (!unpackerData) {\n            unpackerData = globalUnpackers[packUuid] = new UnpackerData();\n            unpackerData.state = PackState.Downloading;\n        }\n        if (unpackerData.state !== PackState.Loaded) {\n            unpackerData.unpacker = new Unpackers.JsonUnpacker();\n            unpackerData.unpacker.load(packIndices[packUuid], packJson);\n            unpackerData.state = PackState.Loaded;\n        }\n        // can not release subdomain packed json because it would not be reloaded. \n    },\n\n    _doLoadNewPack: function (uuid, packUuid, packedJson) {\n        var unpackerData = globalUnpackers[packUuid];\n        // double check cache after load\n        if (unpackerData.state !== PackState.Loaded) {\n            // init unpacker\n            if (typeof packedJson === 'string') {\n                packedJson = JSON.parse(packedJson);\n            }\n            if (Array.isArray(packedJson)) {\n                unpackerData.unpacker = new Unpackers.JsonUnpacker();\n            }\n            else if (packedJson.type === Unpackers.TextureUnpacker.ID) {\n                unpackerData.unpacker = new Unpackers.TextureUnpacker();\n            }\n            unpackerData.unpacker.load(packIndices[packUuid], packedJson);\n            unpackerData.state = PackState.Loaded;\n            unpackerData.duration = 0;\n            toBeChecked.push(packUuid);\n            var self = this;\n            if (!timer) timer = setInterval(function () {\n                var maxDuration = self.msToRelease / checkPeriod;\n                for (var i = toBeChecked.length - 1; i >= 0; i--) {\n                    var id = toBeChecked[i];\n                    var pack = globalUnpackers[id];\n                    if (++pack.duration > maxDuration) {\n                        self.release(id);\n                    }\n                }\n                if (toBeChecked.length === 0) { \n                    clearInterval(timer);\n                    timer = null;\n                }\n            }, checkPeriod);\n        }\n\n        return unpackerData.unpacker.retrieve(uuid);\n    },\n\n    _selectLoadedPack: function (packUuids) {\n        var existsPackState = PackState.Invalid;\n        var existsPackUuid = '';\n        for (var i = 0; i < packUuids.length; i++) {\n            var packUuid = packUuids[i];\n            var unpackerData = globalUnpackers[packUuid];\n            if (unpackerData) {\n                var state = unpackerData.state;\n                if (state === PackState.Loaded) {\n                    return packUuid;\n                }\n                else if (state > existsPackState) {     // load from the package with the largest state value,\n                    existsPackState = state;\n                    existsPackUuid = packUuid;\n                }\n            }\n        }\n                                                        // otherwise the first one (smallest one) will be load\n        return existsPackState !== PackState.Invalid ? existsPackUuid : packUuids[0];\n    },\n\n    /**\n     * @returns {Object} When returns undefined, the requested item is not in any pack, when returns null, the item is in a loading pack, when item json exists, it will return the result directly.\n     */\n    load: function (item, callback) {\n        var uuid = item.uuid;\n        var packUuid = uuidToPack[uuid];\n        if (!packUuid) {\n            // Return undefined to let caller know it's not recognized.\n            // We don't use false here because changing return value type may cause jit fail, \n            // though return undefined may have the same issue.\n            return;\n        }\n\n        if (Array.isArray(packUuid)) {\n            packUuid = this._selectLoadedPack(packUuid);\n        }\n\n        var unpackerData = globalUnpackers[packUuid];\n        if (unpackerData && unpackerData.state === PackState.Loaded) {\n            // update duration\n            unpackerData.duration = 0;\n            // ensure async\n            var json = unpackerData.unpacker.retrieve(uuid);\n            if (json) {\n                return json;\n            }\n            else {\n                return error(uuid, packUuid);\n            }\n        }\n        else {\n            if (!unpackerData) {\n                if (!CC_TEST) {\n                    console.log('Create unpacker %s for %s', packUuid, uuid);\n                }\n                unpackerData = globalUnpackers[packUuid] = new UnpackerData();\n                unpackerData.state = PackState.Downloading;\n            }\n            this._loadNewPack(uuid, packUuid, callback);\n        }\n        // Return null to let caller know it's loading asynchronously\n        return null;\n    },\n\n    release (packUuid) {\n        var unpackerData = globalUnpackers[packUuid];\n        if (unpackerData) {\n            cc.loader.release(unpackerData.url);\n            delete globalUnpackers[packUuid];\n            cc.js.array.fastRemove(toBeChecked, packUuid);\n        }\n    }\n};\n\nif (CC_TEST) {\n    cc._Test.PackDownloader = module.exports;\n    cc._Test.PackDownloader.reset = function () {\n        uuidToPack = {};\n        packIndices = {};\n        globalUnpackers = {};\n    };\n}\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require('../platform/js');\nvar LoadingItems = require('./loading-items');\nvar ItemState = LoadingItems.ItemState;\n\nfunction flow (pipe, item) {\n    var pipeId = pipe.id;\n    var itemState = item.states[pipeId];\n    var next = pipe.next;\n    var pipeline = pipe.pipeline;\n\n    if (item.error || itemState === ItemState.WORKING || itemState === ItemState.ERROR) {\n        return;\n    }\n    else if (itemState === ItemState.COMPLETE) {\n        if (next) {\n            flow(next, item);\n        }\n        else {\n            pipeline.flowOut(item);\n        }\n    }\n    else {\n        item.states[pipeId] = ItemState.WORKING;\n        // Pass async callback in case it's a async call\n        var result = pipe.handle(item, function (err, result) {\n            if (err) {\n                item.error = err;\n                item.states[pipeId] = ItemState.ERROR;\n                pipeline.flowOut(item);\n            }\n            else {\n                // Result can be null, then it means no result for this pipe\n                if (result) {\n                    item.content = result;\n                }\n                item.states[pipeId] = ItemState.COMPLETE;\n                if (next) {\n                    flow(next, item);\n                }\n                else {\n                    pipeline.flowOut(item);\n                }\n            }\n        });\n        // If result exists (not undefined, null is ok), then we go with sync call flow\n        if (result instanceof Error) {\n            item.error = result;\n            item.states[pipeId] = ItemState.ERROR;\n            pipeline.flowOut(item);\n        }\n        else if (result !== undefined) {\n            // Result can be null, then it means no result for this pipe\n            if (result !== null) {\n                item.content = result;\n            }\n            item.states[pipeId] = ItemState.COMPLETE;\n            if (next) {\n                flow(next, item);\n            }\n            else {\n                pipeline.flowOut(item);\n            }\n        }\n    }\n}\n\n/**\n * !#en\n * A pipeline describes a sequence of manipulations, each manipulation is called a pipe.<br/>\n * It's designed for loading process. so items should be urls, and the url will be the identity of each item during the process.<br/>\n * A list of items can flow in the pipeline and it will output the results of all pipes.<br/>\n * They flow in the pipeline like water in tubes, they go through pipe by pipe separately.<br/>\n * Finally all items will flow out the pipeline and the process is finished.\n *\n * !#zh\n * pipeline 描述了一系列的操作，每个操作都被称为 pipe。<br/>\n * 它被设计来做加载过程的流程管理。所以 item 应该是 url，并且该 url 将是在处理中的每个 item 的身份标识。<br/>\n * 一个 item 列表可以在 pipeline 中流动，它将输出加载项经过所有 pipe 之后的结果。<br/>\n * 它们穿过 pipeline 就像水在管子里流动，将会按顺序流过每个 pipe。<br/>\n * 最后当所有加载项都流出 pipeline 时，整个加载流程就结束了。\n * @class Pipeline\n */\n/**\n * !#en\n * Constructor, pass an array of pipes to construct a new Pipeline,\n * the pipes will be chained in the given order.<br/>\n * A pipe is an object which must contain an `id` in string and a `handle` function,\n * the id must be unique in the pipeline.<br/>\n * It can also include `async` property to identify whether it's an asynchronous process.\n * !#zh\n * 构造函数，通过一系列的 pipe 来构造一个新的 pipeline，pipes 将会在给定的顺序中被锁定。<br/>\n * 一个 pipe 就是一个对象，它包含了字符串类型的 ‘id’ 和 ‘handle’ 函数，在 pipeline 中 id 必须是唯一的。<br/>\n * 它还可以包括 ‘async’ 属性以确定它是否是一个异步过程。\n *\n * @method constructor\n * @param {Array} pipes\n * @example\n *  var pipeline = new Pipeline([\n *      {\n *          id: 'Downloader',\n *          handle: function (item, callback) {},\n *          async: true\n *      },\n *      {id: 'Parser', handle: function (item) {}, async: false}\n *  ]);\n */\nvar Pipeline = function (pipes) {\n    this._pipes = pipes;\n    this._cache = js.createMap(true);\n\n    for (var i = 0; i < pipes.length; ++i) {\n        var pipe = pipes[i];\n        // Must have handle and id, handle for flow, id for state flag\n        if (!pipe.handle || !pipe.id) {\n            continue;\n        }\n\n        pipe.pipeline = this;\n        pipe.next = i < pipes.length - 1 ? pipes[i+1] : null;\n    }\n};\n\nPipeline.ItemState = ItemState;\n\nvar proto = Pipeline.prototype;\n\n/**\n * !#en\n * Insert a new pipe at the given index of the pipeline. <br/>\n * A pipe must contain an `id` in string and a `handle` function, the id must be unique in the pipeline.\n * !#zh\n * 在给定的索引位置插入一个新的 pipe。<br/>\n * 一个 pipe 必须包含一个字符串类型的 ‘id’ 和 ‘handle’ 函数，该 id 在 pipeline 必须是唯一标识。\n * @method insertPipe\n * @param {Object} pipe The pipe to be inserted\n * @param {Number} index The index to insert\n */\nproto.insertPipe = function (pipe, index) {\n    // Must have handle and id, handle for flow, id for state flag\n    if (!pipe.handle || !pipe.id || index > this._pipes.length) {\n        cc.warnID(4921);\n        return;\n    }\n\n    if (this._pipes.indexOf(pipe) > 0) {\n        cc.warnID(4922);\n        return;\n    }\n\n    pipe.pipeline = this;\n\n    var nextPipe = null;\n    if (index < this._pipes.length) {\n        nextPipe = this._pipes[index];\n    }\n\n    var previousPipe = null;\n    if (index > 0) {\n        previousPipe = this._pipes[index-1];\n    }\n\n    if (previousPipe) {\n        previousPipe.next = pipe;\n    }\n    pipe.next = nextPipe;\n\n    this._pipes.splice(index, 0, pipe);\n};\n\n/**\n * !#en\n * Insert a pipe to the end of an existing pipe. The existing pipe must be a valid pipe in the pipeline.\n * !#zh\n * 在当前 pipeline 的一个已知 pipe 后面插入一个新的 pipe。\n * @method insertPipeAfter\n * @param {Object} refPipe An existing pipe in the pipeline.\n * @param {Object} newPipe The pipe to be inserted.\n */\nproto.insertPipeAfter = function (refPipe, newPipe)  {\n    var index = this._pipes.indexOf(refPipe);\n    if (index < 0) {\n        return;\n    }\n    this.insertPipe(newPipe, index+1);\n};\n\n/**\n * !#en\n * Add a new pipe at the end of the pipeline. <br/>\n * A pipe must contain an `id` in string and a `handle` function, the id must be unique in the pipeline.\n * !#zh\n * 添加一个新的 pipe 到 pipeline 尾部。 <br/>\n * 该 pipe 必须包含一个字符串类型 ‘id’ 和 ‘handle’ 函数，该 id 在 pipeline 必须是唯一标识。\n * @method appendPipe\n * @param {Object} pipe The pipe to be appended\n */\nproto.appendPipe = function (pipe) {\n    // Must have handle and id, handle for flow, id for state flag\n    if (!pipe.handle || !pipe.id) {\n        return;\n    }\n\n    pipe.pipeline = this;\n    pipe.next = null;\n    if (this._pipes.length > 0) {\n        this._pipes[this._pipes.length - 1].next = pipe;\n    }\n    this._pipes.push(pipe);\n};\n\n/**\n * !#en\n * Let new items flow into the pipeline. <br/>\n * Each item can be a simple url string or an object,\n * if it's an object, it must contain `id` property. <br/>\n * You can specify its type by `type` property, by default, the type is the extension name in url. <br/>\n * By adding a `skips` property including pipe ids, you can skip these pipe. <br/>\n * The object can contain any supplementary property as you want. <br/>\n * !#zh\n * 让新的 item 流入 pipeline 中。<br/>\n * 这里的每个 item 可以是一个简单字符串类型的 url 或者是一个对象,\n * 如果它是一个对象的话，他必须要包含 ‘id’ 属性。<br/>\n * 你也可以指定它的 ‘type’ 属性类型，默认情况下，该类型是 ‘url’ 的后缀名。<br/>\n * 也通过添加一个 包含 ‘skips’ 属性的 item 对象，你就可以跳过 skips 中包含的 pipe。<br/>\n * 该对象可以包含任何附加属性。\n * @method flowIn\n * @param {Array} items\n * @example\n *  pipeline.flowIn([\n *      'res/Background.png',\n *      {\n *          id: 'res/scene.json',\n *          type: 'scene',\n *          name: 'scene',\n *          skips: ['Downloader']\n *      }\n *  ]);\n */\nproto.flowIn = function (items) {\n    var i, pipe = this._pipes[0], item;\n    if (pipe) {\n        // Cache all items first, in case synchronous loading flow same item repeatly\n        for (i = 0; i < items.length; i++) {\n            item = items[i];\n            this._cache[item.id] = item;\n        }\n        for (i = 0; i < items.length; i++) {\n            item = items[i];\n            flow(pipe, item);\n        }\n    }\n    else {\n        for (i = 0; i < items.length; i++) {\n            this.flowOut(items[i]);\n        }\n    }\n};\n\n/*\n * !#en\n * Let new items flow into the pipeline and give a callback when the list of items are all completed. <br/>\n * This is for loading dependencies for an existing item in flow, usually used in a pipe logic. <br/>\n * For example, we have a loader for scene configuration file in JSON, the scene will only be fully loaded  <br/>\n * after all its dependencies are loaded, then you will need to use function to flow in all dependencies  <br/>\n * found in the configuration file, and finish the loader pipe only after all dependencies are loaded (in the callback).\n * !#zh\n * 让新 items 流入 pipeline 并且当 item 列表完成时进行回调函数。<br/>\n * 这个 API 的使用通常是为了加载依赖项。<br/>\n * 例如：<br/>\n * 我们需要加载一个场景配置的 JSON 文件，该场景会将所有的依赖项全部都加载完毕以后，进行回调表示加载完毕。\n * @method flowInDeps\n * @deprecated since v1.3\n * @param {Array} urlList\n * @param {Function} callback\n * @return {Array} Items accepted by the pipeline\n */\nproto.flowInDeps = function (owner, urlList, callback) {\n    var deps = LoadingItems.create(this, function (errors, items) {\n        callback(errors, items);\n        items.destroy();\n    });\n    return deps.append(urlList, owner);\n};\n\nproto.flowOut = function (item) {\n    if (item.error) {\n        delete this._cache[item.id];\n    }\n    else if (!this._cache[item.id]) {\n        this._cache[item.id] = item;\n    }\n    item.complete = true;\n    LoadingItems.itemComplete(item);\n};\n\n/**\n * !#en\n * Copy the item states from one source item to all destination items. <br/>\n * It's quite useful when a pipe generate new items from one source item,<br/>\n * then you should flowIn these generated items into pipeline, <br/>\n * but you probably want them to skip all pipes the source item already go through,<br/>\n * you can achieve it with this API. <br/>\n * <br/>\n * For example, an unzip pipe will generate more items, but you won't want them to pass unzip or download pipe again.\n * !#zh\n * 从一个源 item 向所有目标 item 复制它的 pipe 状态，用于避免重复通过部分 pipe。<br/>\n * 当一个源 item 生成了一系列新的 items 时很有用，<br/>\n * 你希望让这些新的依赖项进入 pipeline，但是又不希望它们通过源 item 已经经过的 pipe，<br/>\n * 但是你可能希望他们源 item 已经通过并跳过所有 pipes，<br/>\n * 这个时候就可以使用这个 API。\n * @method copyItemStates\n * @param {Object} srcItem The source item\n * @param {Array|Object} dstItems A single destination item or an array of destination items\n */\nproto.copyItemStates = function (srcItem, dstItems) {\n    if (!(dstItems instanceof Array)) {\n        dstItems.states = srcItem.states;\n        return;\n    }\n    for (var i = 0; i < dstItems.length; ++i) {\n        dstItems[i].states = srcItem.states;\n    }\n};\n\n/**\n * !#en Returns an item in pipeline.\n * !#zh 根据 id 获取一个 item\n * @method getItem\n * @param {Object} id The id of the item\n * @return {Object}\n */\nproto.getItem = function (id) {\n    var item = this._cache[id];\n\n    if (!item)\n        return item;\n\n    // downloader.js downloadUuid\n    if (item.alias)\n        item = item.alias;\n\n    return item;\n};\n\n/**\n * !#en Removes an completed item in pipeline.\n * It will only remove the cache in the pipeline or loader, its dependencies won't be released.\n * cc.loader provided another method to completely cleanup the resource and its dependencies,\n * please refer to {{#crossLink \"loader/release:method\"}}cc.loader.release{{/crossLink}}\n * !#zh 移除指定的已完成 item。\n * 这将仅仅从 pipeline 或者 loader 中删除其缓存，并不会释放它所依赖的资源。\n * cc.loader 中提供了另一种删除资源及其依赖的清理方法，请参考 {{#crossLink \"loader/release:method\"}}cc.loader.release{{/crossLink}}\n * @method removeItem\n * @param {Object} id The id of the item\n * @return {Boolean} succeed or not\n */\nproto.removeItem = function (id) {\n    var removed = this._cache[id];\n    if (removed && removed.complete) {\n        delete this._cache[id];\n    }\n    return removed;\n};\n\n/**\n * !#en Clear the current pipeline, this function will clean up the items.\n * !#zh 清空当前 pipeline，该函数将清理 items。\n * @method clear\n */\nproto.clear = function () {\n    for (var id in this._cache) {\n        var item = this._cache[id];\n        delete this._cache[id];\n        if (!item.complete) {\n            item.error = new Error('Canceled manually');\n            this.flowOut(item);\n        }\n    }\n};\n\ncc.Pipeline = module.exports = Pipeline;\n","/****************************************************************************\n Copyright (c) 2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n https://www.cocos.com/\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\nvar Pipeline = require('./pipeline');\n\nconst ID = 'SubPackPipe';\nconst UuidRegex = /.*[/\\\\][0-9a-fA-F]{2}[/\\\\]([0-9a-fA-F-]{8,})/;\n\nfunction getUuidFromURL(url) {\n    var matches = url.match(UuidRegex);\n    if (matches) {\n        return matches[1];\n    }\n    return \"\";\n}\n\nvar _uuidToSubPack = Object.create(null);\n\nvar SubPackPipe = function (subpackage) {\n    this.id = ID;\n    this.async = false;\n    this.pipeline = null;\n    for (var packName in subpackage) {\n        var pack = subpackage[packName];\n        pack.uuids && pack.uuids.forEach(function (val) {\n            _uuidToSubPack[val] = pack.path;\n        });\n    }\n};\n\nSubPackPipe.ID = ID;\n\nSubPackPipe.prototype.handle = function (item) {\n    item.url = this.transformURL(item.url);\n    return null;\n};\n\nSubPackPipe.prototype.transformURL = function (url) {\n    var uuid = getUuidFromURL(url);\n    if (uuid) {\n        var subpackage = _uuidToSubPack[uuid];\n        if (subpackage) {\n            // only replace url of native assets\n            return url.replace('res/raw-assets/', subpackage + 'raw-assets/');\n        }\n    }\n    return url;\n};\n\nPipeline.SubPackPipe = module.exports = SubPackPipe;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar urlAppendTimestamp = require('./utils').urlAppendTimestamp;\n\nmodule.exports = function (item, callback) {\n    var url = item.url;\n    url = urlAppendTimestamp(url);\n\n    var xhr = cc.loader.getXMLHttpRequest(),\n        errInfo = 'Load text file failed: ' + url;\n    xhr.open('GET', url, true);\n    if (xhr.overrideMimeType) xhr.overrideMimeType('text\\/plain; charset=utf-8');\n    xhr.onload = function () {\n        if (xhr.readyState === 4) {\n            if (xhr.status === 200 || xhr.status === 0) {\n                callback(null, xhr.responseText);\n            }\n            else {\n                callback({status:xhr.status, errorMessage:errInfo + '(wrong status)'});\n            }\n        }\n        else {\n            callback({status:xhr.status, errorMessage:errInfo + '(wrong readyState)'});\n        }\n    };\n    xhr.onerror = function(){\n        callback({status:xhr.status, errorMessage:errInfo + '(error)'});\n    };\n    xhr.ontimeout = function(){\n        callback({status:xhr.status, errorMessage:errInfo + '(time out)'});\n    };\n    xhr.send(null);\n};","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar Texture2D = require('../assets/CCTexture2D');\nvar js = require('../platform/js');\n\nfunction JsonUnpacker () {\n    this.jsons = {};\n}\n\n/**\n * @param {String[]} indices\n * @param {Object[]} packedJson\n */\nJsonUnpacker.prototype.load = function (indices, packedJson) {\n    if (packedJson.length !== indices.length) {\n        cc.errorID(4915);\n    }\n    for (var i = 0; i < indices.length; i++) {\n        var key = indices[i];\n        var json = packedJson[i];\n        this.jsons[key] = json;\n    }\n};\n\nJsonUnpacker.prototype.retrieve = function (key) {\n    return this.jsons[key] || null;\n};\n\n\nfunction TextureUnpacker () {\n    this.contents = {};\n}\nTextureUnpacker.ID = js._getClassId(Texture2D);\n\n/**\n * @param {String[]} indices\n * @param {Object[]} packedJson\n */\nTextureUnpacker.prototype.load = function (indices, packedJson) {\n    var datas = packedJson.data.split('|');\n    if (datas.length !== indices.length) {\n        cc.errorID(4915);\n    }\n    for (var i = 0; i < indices.length; i++) {\n        this.contents[indices[i]] = datas[i];\n    }\n};\n\nTextureUnpacker.prototype.retrieve = function (key) {\n    var content = this.contents[key];\n    if (content) {\n        return {\n            __type__: TextureUnpacker.ID,\n            content: content\n        };\n    }\n    else {\n        return null;\n    }\n};\n\nif (CC_TEST) {\n    cc._Test.JsonUnpacker = JsonUnpacker;\n    cc._Test.TextureUnpacker = TextureUnpacker;\n}\n\nmodule.exports = {\n    JsonUnpacker,\n    TextureUnpacker,\n};\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar _noCacheRex = /\\?/;\n\nmodule.exports = {\n    //isUrlCrossOrigin: function (url) {\n    //    if (!url) {\n    //        cc.log('invalid URL');\n    //        return false;\n    //    }\n    //    var startIndex = url.indexOf('://');\n    //    if (startIndex === -1)\n    //        return false;\n    //\n    //    var endIndex = url.indexOf('/', startIndex + 3);\n    //    var urlOrigin = (endIndex === -1) ? url : url.substring(0, endIndex);\n    //    return urlOrigin !== location.origin;\n    //},\n    urlAppendTimestamp: function (url) {\n        if (cc.game.config['noCache'] && typeof url === 'string') {\n            if (_noCacheRex.test(url))\n                url += '&_t=' + (new Date() - 0);\n            else\n                url += '?_t=' + (new Date() - 0);\n        }\n        return url;\n    }\n};\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst MissingClass = CC_EDITOR && Editor.require('app://editor/page/scene-utils/missing-class-reporter').MissingClass;\nconst js = require('../platform/js');\nconst debug = require('../CCDebug');\nrequire('../platform/deserialize');\nconst LoadingItems = require('./loading-items');\n\nfunction isSceneObj (json) {\n    var SCENE_ID = 'cc.Scene';\n    var PREFAB_ID = 'cc.Prefab';\n    return json && (\n               (json[0] && json[0].__type__ === SCENE_ID) ||\n               (json[1] && json[1].__type__ === SCENE_ID) ||\n               (json[0] && json[0].__type__ === PREFAB_ID)\n           );\n}\n\nfunction parseDepends (item, asset, tdInfo, deferredLoadRawAssetsInRuntime) {\n    var uuidList = tdInfo.uuidList;\n    var objList = tdInfo.uuidObjList;\n    var propList = tdInfo.uuidPropList;\n    var stillUseUrl = tdInfo._stillUseUrl;\n    var depends;\n    var i, dependUuid;\n    // cache dependencies for auto release\n    var dependKeys = item.dependKeys = [];\n\n    if (deferredLoadRawAssetsInRuntime) {\n        depends = [];\n        // parse depends assets\n        for (i = 0; i < uuidList.length; i++) {\n            dependUuid = uuidList[i];\n            var obj = objList[i];\n            var prop = propList[i];\n            var info = cc.AssetLibrary._getAssetInfoInRuntime(dependUuid);\n            if (info.raw) {\n                // skip preloading raw assets\n                var url = info.url;\n                obj[prop] = url;\n                dependKeys.push(url);\n            }\n            else {\n                // declare depends assets\n                depends.push({\n                    type: 'uuid',\n                    uuid: dependUuid,\n                    deferredLoadRaw: true,\n                    _owner: obj,\n                    _ownerProp: prop,\n                    _stillUseUrl: stillUseUrl[i]\n                });\n            }\n        }\n    }\n    else {\n        depends = new Array(uuidList.length);\n\n        // declare depends assets\n        for (i = 0; i < uuidList.length; i++) {\n            dependUuid = uuidList[i];\n            depends[i] = {\n                type: 'uuid',\n                uuid: dependUuid,\n                _owner: objList[i],\n                _ownerProp: propList[i],\n                _stillUseUrl: stillUseUrl[i]\n            };\n        }\n\n        // load native object (Image/Audio) as depends\n        if (asset._native && !asset.constructor.preventPreloadNativeObject) {\n            depends.push({\n                url: asset.nativeUrl,\n                _owner: asset,\n                _ownerProp: '_nativeAsset',\n            });\n        }\n    }\n\n    return depends;\n}\n\nfunction loadDepends (pipeline, item, asset, depends, callback) {\n    // Predefine content for dependencies usage\n    item.content = asset;\n    var dependKeys = item.dependKeys;\n    pipeline.flowInDeps(item, depends, function (errors, items) {\n        var item, missingAssetReporter;\n        var itemsMap = items.map;\n        for (var src in itemsMap) {\n            item = itemsMap[src];\n            if (item.uuid && item.content) {\n                item.content._uuid = item.uuid;\n            }\n        }\n\n        function loadCallback (item) {\n            var value = item.content;\n            if (this._stillUseUrl) {\n                value = (value && cc.RawAsset.wasRawAssetType(value.constructor)) ? value.nativeUrl : item.rawUrl;\n            }\n            if (this._ownerProp === '_nativeAsset') {\n                this._owner.url = item.url;\n            }\n            this._owner[this._ownerProp] = value;\n            if (item.uuid !== asset._uuid && dependKeys.indexOf(item.id) < 0) {\n                dependKeys.push(item.id);\n            }\n        }\n        \n        for (var i = 0; i < depends.length; i++) {\n            var dep = depends[i];\n            var dependSrc = dep.uuid;\n            var dependUrl = dep.url;\n            var dependObj = dep._owner;\n            var dependProp = dep._ownerProp;\n            item = itemsMap[dependUrl];\n            if (!item) {\n                continue;\n            }\n\n            var loadCallbackCtx = dep;\n\n            if (item.complete || item.content) {\n                if (item.error) {\n                    if (CC_EDITOR && item.error.errorCode === 'db.NOTFOUND') {\n                        if (!missingAssetReporter) {\n                            var MissingObjectReporter = Editor.require('app://editor/page/scene-utils/missing-object-reporter');\n                            missingAssetReporter = new MissingObjectReporter(asset);\n                        }\n                        missingAssetReporter.stashByOwner(dependObj, dependProp, Editor.serialize.asAsset(dependSrc));\n                    }\n                    else {\n                        cc._throw(item.error.message || item.error.errorMessage || item.error);\n                    }\n                }\n                else {\n                    loadCallback.call(loadCallbackCtx, item);\n                }\n            }\n            else {\n                // item was removed from cache, but ready in pipeline actually\n                var queue = LoadingItems.getQueue(item);\n                // Hack to get a better behavior\n                var list = queue._callbackTable[dependSrc];\n                if (list) {\n                    list.unshift(loadCallback, loadCallbackCtx);\n                }\n                else {\n                    queue.addListener(dependSrc, loadCallback, loadCallbackCtx);\n                }\n            }\n        }\n        // Emit dependency errors in runtime, but not in editor,\n        // because editor need to open the scene / prefab to let user fix missing asset issues\n        if (CC_EDITOR && missingAssetReporter) {\n            missingAssetReporter.reportByOwner();\n            callback(null, asset);\n        }\n        else {\n            if (!errors && asset.onLoad) {\n                try {\n                    asset.onLoad();\n                }\n                catch (e) {\n                    cc._throw(e);\n                } \n            }\n            callback(errors, asset);\n        }\n    });\n}\n\n// can deferred load raw assets in runtime\nfunction canDeferredLoad (asset, item, isScene) {\n    if (CC_EDITOR) {\n        return false;\n    }\n    var res = item.deferredLoadRaw;\n    if (res) {\n        // check if asset support deferred\n        if ((asset instanceof cc.Asset) && asset.constructor.preventDeferredLoadDependents) {\n            res = false;\n        }\n    }\n    else if (isScene) {\n        if (asset instanceof cc.SceneAsset || asset instanceof cc.Prefab) {\n            res = asset.asyncLoadAssets;\n            //if (res) {\n            //    cc.log('deferred load raw assets for ' + item.id);\n            //}\n        }\n    }\n    return res;\n}\n\nfunction loadUuid (item, callback) {\n    var json;\n    if (typeof item.content === 'string') {\n        try {\n            json = JSON.parse(item.content);\n        }\n        catch (e) {\n            return new Error(debug.getError(4923, item.id, e.stack));\n        }\n    }\n    else if (typeof item.content === 'object') {\n        json = item.content;\n    }\n    else {\n        return new Error(debug.getError(4924));\n    }\n\n    var classFinder, missingClass;\n    var isScene = isSceneObj(json);\n    if (isScene) {\n        if (CC_EDITOR) {\n            missingClass = MissingClass;\n            classFinder = function (type, data, owner, propName) {\n                var res = missingClass.classFinder(type, data, owner, propName);\n                if (res) {\n                    return res;\n                }\n                return cc._MissingScript.getMissingWrapper(type, data);\n            };\n            classFinder.onDereferenced = missingClass.classFinder.onDereferenced;\n        }\n        else {\n            classFinder = cc._MissingScript.safeFindClass;\n        }\n    }\n    else {\n        classFinder = function (id) {\n            var cls = js._getClassById(id);\n            if (cls) {\n                return cls;\n            }\n            cc.warnID(4903, id);\n            return Object;\n        };\n    }\n\n    var tdInfo = cc.deserialize.Details.pool.get();\n\n    var asset;\n    try {\n        asset = cc.deserialize(json, tdInfo, {\n            classFinder: classFinder,\n            target: item.existingAsset,\n            customEnv: item\n        });\n    }\n    catch (e) {\n        cc.deserialize.Details.pool.put(tdInfo);\n        var err = CC_JSB || CC_RUNTIME ? (e + '\\n' + e.stack) : e.stack;\n        return new Error(debug.getError(4925, item.id, err));\n    }\n\n    asset._uuid = item.uuid;\n    asset.url = asset.nativeUrl;\n\n    if (CC_EDITOR && missingClass) {\n        missingClass.reportMissingClass(asset);\n        missingClass.reset();\n    }\n\n    var deferredLoad = canDeferredLoad(asset, item, isScene);\n    var depends = parseDepends(item, asset, tdInfo, deferredLoad);\n\n    cc.deserialize.Details.pool.put(tdInfo);\n\n    if (depends.length === 0) {\n        if (asset.onLoad) asset.onLoad();\n        return callback(null, asset);\n    }\n    loadDepends(this.pipeline, item, asset, depends, callback);\n}\n\nmodule.exports = loadUuid;\nloadUuid.isSceneObj = isSceneObj;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar CompScheduler = require('./component-scheduler');\nvar Flags = require('./platform/CCObject').Flags;\nvar js = require('./platform/js');\nvar callerFunctor = CC_EDITOR && require('./utils/misc').tryCatchFunctor_EDITOR;\n\nvar MAX_POOL_SIZE = 4;\n\nvar IsPreloadStarted = Flags.IsPreloadStarted;\nvar IsOnLoadStarted = Flags.IsOnLoadStarted;\nvar IsOnLoadCalled = Flags.IsOnLoadCalled;\nvar Deactivating = Flags.Deactivating;\n\nvar callPreloadInTryCatch = CC_EDITOR && callerFunctor('__preload');\nvar callOnLoadInTryCatch = CC_EDITOR && function (c) {\n    try {\n        c.onLoad();\n    }\n    catch (e) {\n        cc._throw(e);\n    }\n    c._objFlags |= IsOnLoadCalled;\n    _onLoadInEditor(c);\n};\nvar callOnDestroyInTryCatch = CC_EDITOR && callerFunctor('onDestroy');\nvar callResetInTryCatch = CC_EDITOR && callerFunctor('resetInEditor');\nvar callOnFocusInTryCatch = CC_EDITOR && callerFunctor('onFocusInEditor');\nvar callOnLostFocusInTryCatch = CC_EDITOR && callerFunctor('onLostFocusInEditor');\n\n// for __preload: use internally, no sort\nvar UnsortedInvoker = cc.Class({\n    extends: CompScheduler.LifeCycleInvoker,\n    add (comp) {\n        this._zero.array.push(comp);\n    },\n    remove (comp) {\n        this._zero.fastRemove(comp);\n    },\n    cancelInactive (flagToClear) {\n        CompScheduler.LifeCycleInvoker.stableRemoveInactive(this._zero, flagToClear);\n    },\n    invoke () {\n        this._invoke(this._zero);\n        this._zero.array.length = 0;\n    },\n});\n\nvar invokePreload = CC_SUPPORT_JIT ?\n    CompScheduler.createInvokeImpl('c.__preload();') :\n    CompScheduler.createInvokeImpl(function (c) { c.__preload(); }, false, undefined, function (iterator) {\n        var array = iterator.array;\n        for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n            array[iterator.i].__preload();\n        }\n    });\nvar invokeOnLoad = CC_SUPPORT_JIT ?\n    CompScheduler.createInvokeImpl('c.onLoad();c._objFlags|=' + IsOnLoadCalled, false, IsOnLoadCalled) :\n    CompScheduler.createInvokeImpl(function (c) {\n            c.onLoad();\n            c._objFlags |= IsOnLoadCalled;\n        },\n        false,\n        IsOnLoadCalled,\n        function (iterator) {\n            var array = iterator.array;\n            for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n                let comp = array[iterator.i];\n                comp.onLoad();\n                comp._objFlags |= IsOnLoadCalled;\n            }\n        }\n    );\n\n\nvar activateTasksPool = new js.Pool(MAX_POOL_SIZE);\nactivateTasksPool.get = function getActivateTask () {\n    var task = this._get() || {\n        preload: new UnsortedInvoker(invokePreload),\n        onLoad: new CompScheduler.OneOffInvoker(invokeOnLoad),\n        onEnable: new CompScheduler.OneOffInvoker(CompScheduler.invokeOnEnable)\n    };\n\n    // reset index to -1 so we can skip invoked component in cancelInactive\n    task.preload._zero.i = -1;\n    var invoker = task.onLoad;\n    invoker._zero.i = -1;\n    invoker._neg.i = -1;\n    invoker._pos.i = -1;\n    invoker = task.onEnable;\n    invoker._zero.i = -1;\n    invoker._neg.i = -1;\n    invoker._pos.i = -1;\n\n    return task;\n};\n\nfunction _componentCorrupted (node, comp, index) {\n    if (CC_DEV) {\n        cc.errorID(3817, node.name, index);\n        console.log('Corrupted component value:', comp);\n    }\n    if (comp) {\n        node._removeComponent(comp);\n    }\n    else {\n        js.array.removeAt(node._components, index);\n    }\n}\n\nfunction _onLoadInEditor (comp) {\n    if (comp.onLoad && !cc.engine._isPlaying) {\n        var focused = Editor.Selection.curActivate('node') === comp.node.uuid;\n        if (focused) {\n            comp.onFocusInEditor && callOnFocusInTryCatch(comp);\n        }\n        else {\n            comp.onLostFocusInEditor && callOnLostFocusInTryCatch(comp);\n        }\n    }\n    if ( !CC_TEST ) {\n        _Scene.AssetsWatcher.start(comp);\n    }\n}\n\n/**\n * The class used to perform activating and deactivating operations of node and component.\n */\nfunction ctor () {\n    // a stack of node's activating tasks\n    this._activatingStack = [];\n}\nvar NodeActivator = cc.Class({\n    ctor: ctor,\n    reset: ctor,\n\n    _activateNodeRecursively (node, preloadInvoker, onLoadInvoker, onEnableInvoker) {\n        if (node._objFlags & Deactivating) {\n            // en:\n            // Forbid reactive the same node during its deactivating procedure\n            // to avoid endless loop and simplify the implementation.\n            // zh:\n            // 对相同节点而言，无法撤销反激活，防止反激活 - 激活 - 反激活的死循环发生。\n            // 这样设计简化了一些引擎的实现，而且对调用者来说能保证反激活操作都能成功。\n            cc.errorID(3816, node.name);\n            return;\n        }\n\n        node._activeInHierarchy = true;\n\n        // component maybe added during onEnable, and the onEnable of new component is already called\n        // so we should record the origin length\n        var originCount = node._components.length;\n        // activate components\n        for (let i = 0; i < originCount; ++i) {\n            let component = node._components[i];\n            if (component instanceof cc.Component) {\n                this.activateComp(component, preloadInvoker, onLoadInvoker, onEnableInvoker);\n            }\n            else {\n                _componentCorrupted(node, component, i);\n                --i;\n                --originCount;\n            }\n        }\n\n        node._childArrivalOrder = node._children.length;\n        \n        // activate children recursively\n        for (let i = 0, len = node._children.length; i < len; ++i) {\n            let child = node._children[i];\n            child._localZOrder = (child._localZOrder & 0xffff0000) | (i + 1);\n            if (child._active) {\n                this._activateNodeRecursively(child, preloadInvoker, onLoadInvoker, onEnableInvoker);\n            }\n        }\n        node._onPostActivated(true);\n    },\n\n    _deactivateNodeRecursively (node) {\n        if (CC_DEV) {\n            cc.assert(!(node._objFlags & Deactivating), 'node should not deactivating');\n            // ensures _activeInHierarchy is always changing when Deactivating flagged\n            cc.assert(node._activeInHierarchy, 'node should not deactivated');\n        }\n        node._objFlags |= Deactivating;\n        node._activeInHierarchy = false;\n\n        // component maybe added during onEnable, and the onEnable of new component is already called\n        // so we should record the origin length\n        var originCount = node._components.length;\n        for (let c = 0; c < originCount; ++c) {\n            let component = node._components[c];\n            if (component._enabled) {\n                cc.director._compScheduler.disableComp(component);\n\n                if (node._activeInHierarchy) {\n                    // reactivated from root\n                    node._objFlags &= ~Deactivating;\n                    return;\n                }\n            }\n        }\n        for (let i = 0, len = node._children.length; i < len; ++i) {\n            let child = node._children[i];\n            if (child._activeInHierarchy) {\n                this._deactivateNodeRecursively(child);\n\n                if (node._activeInHierarchy) {\n                    // reactivated from root\n                    node._objFlags &= ~Deactivating;\n                    return;\n                }\n            }\n        }\n\n        node._onPostActivated(false);\n        node._objFlags &= ~Deactivating;\n    },\n\n    activateNode (node, active) {\n        if (active) {\n            var task = activateTasksPool.get();\n            this._activatingStack.push(task);\n\n            this._activateNodeRecursively(node, task.preload, task.onLoad, task.onEnable);\n            task.preload.invoke();\n            task.onLoad.invoke();\n            task.onEnable.invoke();\n\n            this._activatingStack.pop();\n            activateTasksPool.put(task);\n        }\n        else {\n            this._deactivateNodeRecursively(node);\n\n            // remove children of this node from previous activating tasks to debounce\n            // (this is an inefficient operation but it ensures general case could be implemented in a efficient way)\n            var stack = this._activatingStack;\n            for (var i = 0; i < stack.length; i++) {\n                var lastTask = stack[i];\n                lastTask.preload.cancelInactive(IsPreloadStarted);\n                lastTask.onLoad.cancelInactive(IsOnLoadStarted);\n                lastTask.onEnable.cancelInactive();\n            }\n        }\n        node.emit('active-in-hierarchy-changed', node);\n    },\n\n    activateComp: CC_EDITOR ? function (comp, preloadInvoker, onLoadInvoker, onEnableInvoker) {\n        if (!cc.isValid(comp, true)) {\n            // destroyed before activating\n            return;\n        }\n        if (cc.engine._isPlaying || comp.constructor._executeInEditMode) {\n            if (!(comp._objFlags & IsPreloadStarted)) {\n                comp._objFlags |= IsPreloadStarted;\n                if (comp.__preload) {\n                    if (preloadInvoker) {\n                        preloadInvoker.add(comp);\n                    }\n                    else {\n                        callPreloadInTryCatch(comp);\n                    }\n                }\n            }\n            if (!(comp._objFlags & IsOnLoadStarted)) {\n                comp._objFlags |= IsOnLoadStarted;\n                if (comp.onLoad) {\n                    if (onLoadInvoker) {\n                        onLoadInvoker.add(comp);\n                    }\n                    else {\n                        callOnLoadInTryCatch(comp);\n                    }\n                }\n                else {\n                    comp._objFlags |= IsOnLoadCalled;\n                    _onLoadInEditor(comp);\n                }\n            }\n        }\n        if (comp._enabled) {\n            var deactivatedOnLoading = !comp.node._activeInHierarchy;\n            if (deactivatedOnLoading) {\n                return;\n            }\n            cc.director._compScheduler.enableComp(comp, onEnableInvoker);\n        }\n    } : function (comp, preloadInvoker, onLoadInvoker, onEnableInvoker) {\n        if (!cc.isValid(comp, true)) {\n            // destroyed before activating\n            return;\n        }\n        if (!(comp._objFlags & IsPreloadStarted)) {\n            comp._objFlags |= IsPreloadStarted;\n            if (comp.__preload) {\n                if (preloadInvoker) {\n                    preloadInvoker.add(comp);\n                }\n                else {\n                    comp.__preload();\n                }\n            }\n        }\n        if (!(comp._objFlags & IsOnLoadStarted)) {\n            comp._objFlags |= IsOnLoadStarted;\n            if (comp.onLoad) {\n                if (onLoadInvoker) {\n                    onLoadInvoker.add(comp);\n                }\n                else {\n                    comp.onLoad();\n                    comp._objFlags |= IsOnLoadCalled;\n                }\n            }\n            else {\n                comp._objFlags |= IsOnLoadCalled;\n            }\n        }\n        if (comp._enabled) {\n            var deactivatedOnLoading = !comp.node._activeInHierarchy;\n            if (deactivatedOnLoading) {\n                return;\n            }\n            cc.director._compScheduler.enableComp(comp, onEnableInvoker);\n        }\n    },\n\n    destroyComp: CC_EDITOR ? function (comp) {\n        // ensure onDisable called\n        cc.director._compScheduler.disableComp(comp);\n\n        if (comp.onDestroy && (comp._objFlags & IsOnLoadCalled)) {\n            if (cc.engine._isPlaying || comp.constructor._executeInEditMode) {\n                callOnDestroyInTryCatch(comp);\n                comp._objFlags &= ~IsOnLoadCalled;  // In case call onDestroy twice in undo operation\n            }\n        }\n    } : function (comp) {\n        // ensure onDisable called\n        cc.director._compScheduler.disableComp(comp);\n\n        if (comp.onDestroy && (comp._objFlags & IsOnLoadCalled)) {\n            comp.onDestroy();\n        }\n    },\n\n    resetComp: CC_EDITOR && function (comp) {\n        if (comp.resetInEditor) {\n            callResetInTryCatch(comp);\n        }\n    }\n});\n\nmodule.exports = NodeActivator;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar Asset = require('../assets/CCAsset');\nvar callInNextTick = require('./utils').callInNextTick;\nvar Loader = require('../load-pipeline/CCLoader');\nvar AssetTable = require('../load-pipeline/asset-table');\nvar PackDownloader = require('../load-pipeline/pack-downloader');\nvar AutoReleaseUtils = require('../load-pipeline/auto-release-utils');\nvar decodeUuid = require('../utils/decode-uuid');\nvar MD5Pipe = require('../load-pipeline/md5-pipe');\nvar SubPackPipe = require('../load-pipeline/subpackage-pipe');\nvar js = require('./js');\n\n/**\n * The asset library which managing loading/unloading assets in project.\n *\n * @class AssetLibrary\n * @static\n */\n\n// configs\n\nvar _libraryBase = '';\nvar _rawAssetsBase = '';     // The base dir for raw assets in runtime\nvar _uuidToRawAsset = js.createMap(true);\n\nfunction isScene (asset) {\n    return asset && (asset.constructor === cc.SceneAsset || asset instanceof cc.Scene);\n}\n\n// types\n\nfunction RawAssetEntry (url, type) {\n    this.url = url;\n    this.type = type;\n}\n\n// publics\n\nvar AssetLibrary = {\n    /**\n     * @callback loadCallback\n     * @param {String} error - null or the error info\n     * @param {Asset} data - the loaded asset or null\n     */\n\n    /**\n     * @method loadAsset\n     * @param {String} uuid\n     * @param {loadCallback} callback - the callback function once load finished\n     * @param {Object} options\n     * @param {Boolean} options.readMainCache - Default is true. If false, the asset and all its depends assets will reload and create new instances from library.\n     * @param {Boolean} options.writeMainCache - Default is true. If true, the result will cache to AssetLibrary, and MUST be unload by user manually.\n     * @param {Asset} options.existingAsset - load to existing asset, this argument is only available in editor\n     * @private\n     */\n    loadAsset: function (uuid, callback, options) {\n        if (typeof uuid !== 'string') {\n            return callInNextTick(callback, new Error('[AssetLibrary] uuid must be string'), null);\n        }\n        // var readMainCache = typeof (options && options.readMainCache) !== 'undefined' ? readMainCache : true;\n        // var writeMainCache = typeof (options && options.writeMainCache) !== 'undefined' ? writeMainCache : true;\n        var item = {\n            uuid: uuid,\n            type: 'uuid'\n        };\n        if (options && options.existingAsset) {\n            item.existingAsset = options.existingAsset;\n        }\n        Loader.load(item, function (error, asset) {\n            if (error || !asset) {\n                let errorInfo = typeof error === 'string' ? error : (error ? (error.message || error.errorMessage || JSON.stringify(error)) : 'Unknown error');\n                error = new Error('[AssetLibrary] loading JSON or dependencies failed:' + errorInfo);\n            }\n            else {\n                if (asset.constructor === cc.SceneAsset) {\n                    if (CC_EDITOR && !asset.scene) {\n                        Editor.error('Sorry, the scene data of \"%s\" is corrupted!', uuid);\n                    }\n                    else {\n                        var key = cc.loader._getReferenceKey(uuid);\n                        asset.scene.dependAssets = AutoReleaseUtils.getDependsRecursively(key);\n                    }\n                }\n                if (CC_EDITOR || isScene(asset)) {\n                    var id = cc.loader._getReferenceKey(uuid);\n                    Loader.removeItem(id);\n                }\n            }\n            if (callback) {\n                callback(error, asset);\n            }\n        });\n    },\n\n    getLibUrlNoExt: function (uuid, inRawAssetsDir) {\n        if (CC_BUILD) {\n            uuid = decodeUuid(uuid);\n        }\n        var base = (CC_BUILD && inRawAssetsDir) ? (_rawAssetsBase + 'assets/') : _libraryBase;\n        return base + uuid.slice(0, 2) + '/' + uuid;\n    },\n\n    _queryAssetInfoInEditor: function (uuid, callback) {\n        if (CC_EDITOR) {\n            Editor.Ipc.sendToMain('scene:query-asset-info-by-uuid', uuid, function (err, info) {\n                if (info) {\n                    Editor.Utils.UuidCache.cache(info.url, uuid);\n                    var ctor = Editor.assets[info.type];\n                    if (ctor) {\n                        var isRawAsset = !js.isChildClassOf(ctor, Asset);\n                        callback(null, info.url, isRawAsset, ctor);\n                    }\n                    else {\n                        callback(new Error('Can not find asset type ' + info.type));\n                    }\n                }\n                else {\n                    var error = new Error('Can not get asset url by uuid \"' + uuid + '\", the asset may be deleted.');\n                    error.errorCode = 'db.NOTFOUND';\n                    callback(error);\n                }\n            }, -1);\n        }\n    },\n\n    _getAssetInfoInRuntime: function (uuid, result) {\n        result = result || {url: null, raw: false};\n        var info = _uuidToRawAsset[uuid];\n        if (info && !js.isChildClassOf(info.type, cc.Asset)) {\n            // backward compatibility since 1.10\n            result.url = _rawAssetsBase + info.url;\n            result.raw = true;\n        }\n        else {\n            result.url = this.getLibUrlNoExt(uuid) + '.json';\n            result.raw = false;\n        }\n        return result;\n    },\n\n    _uuidInSettings: function (uuid) {\n        return uuid in _uuidToRawAsset;\n    },\n\n    /**\n     * @method queryAssetInfo\n     * @param {String} uuid\n     * @param {Function} callback\n     * @param {Error} callback.error\n     * @param {String} callback.url - the url of raw asset or imported asset\n     * @param {Boolean} callback.raw - indicates whether the asset is raw asset\n     * @param {Function} callback.ctorInEditor - the actual type of asset, used in editor only\n     */\n    queryAssetInfo: function (uuid, callback) {\n        if (CC_EDITOR && !CC_TEST) {\n            this._queryAssetInfoInEditor(uuid, callback);\n        }\n        else {\n            var info = this._getAssetInfoInRuntime(uuid);\n            callback(null, info.url, info.raw);\n        }\n    },\n\n    // parse uuid out of url\n    parseUuidInEditor: function (url) {\n        if (CC_EDITOR) {\n            var uuid = '';\n            var isImported = url.startsWith(_libraryBase);\n            if (isImported) {\n                var dir = cc.path.dirname(url);\n                var dirBasename = cc.path.basename(dir);\n\n                var isAssetUrl = dirBasename.length === 2;\n                if (isAssetUrl) {\n                    uuid = cc.path.basename(url);\n                    var index = uuid.indexOf('.');\n                    if (index !== -1) {\n                        uuid = uuid.slice(0, index);\n                    }\n                }\n                else {\n                    // raw file url\n                    uuid = dirBasename;\n                }\n            }\n            // If url is not in the library, just return \"\"\n            return uuid;\n        }\n    },\n\n    /**\n     * @method loadJson\n     * @param {String} json\n     * @param {loadCallback} callback\n     * @return {LoadingHandle}\n     * @private\n     */\n    loadJson: function (json, callback) {\n        var randomUuid = '' + ((new Date()).getTime() + Math.random());\n        var item = {\n            uuid: randomUuid,\n            type: 'uuid',\n            content: json,\n            skips: [ Loader.assetLoader.id, Loader.downloader.id ]\n        };\n        Loader.load(item, function (error, asset) {\n            if (error) {\n                error = new Error('[AssetLibrary] loading JSON or dependencies failed: ' + error.message);\n            }\n            else {\n                if (asset.constructor === cc.SceneAsset) {\n                    var key = cc.loader._getReferenceKey(randomUuid);\n                    asset.scene.dependAssets = AutoReleaseUtils.getDependsRecursively(key);\n                }\n                if (CC_EDITOR || isScene(asset)) {\n                    var id = cc.loader._getReferenceKey(randomUuid);\n                    Loader.removeItem(id);\n                }\n            }\n            asset._uuid = '';\n            if (callback) {\n                callback(error, asset);\n            }\n        });\n    },\n\n    /**\n     * Get the exists asset by uuid.\n     *\n     * @method getAssetByUuid\n     * @param {String} uuid\n     * @return {Asset} - the existing asset, if not loaded, just returns null.\n     * @private\n     */\n    getAssetByUuid: function (uuid) {\n        return AssetLibrary._uuidToAsset[uuid] || null;\n    },\n\n    /**\n     * init the asset library\n     *\n     * @method init\n     * @param {Object} options\n     * @param {String} options.libraryPath - 能接收的任意类型的路径，通常在编辑器里使用绝对的，在网页里使用相对的。\n     * @param {Object} options.mountPaths - mount point of actual urls for raw assets (only used in editor)\n     * @param {Object} [options.rawAssets] - uuid to raw asset's urls (only used in runtime)\n     * @param {String} [options.rawAssetsBase] - base of raw asset's urls (only used in runtime)\n     * @param {String} [options.packedAssets] - packed assets (only used in runtime)\n     */\n    init: function (options) {\n        if (CC_EDITOR && _libraryBase) {\n            cc.errorID(6402);\n            return;\n        }\n\n\n        // 这里将路径转 url，不使用路径的原因是有的 runtime 不能解析 \"\\\" 符号。\n        // 不使用 url.format 的原因是 windows 不支持 file:// 和 /// 开头的协议，所以只能用 replace 操作直接把路径转成 URL。\n        var libraryPath = options.libraryPath;\n        libraryPath = libraryPath.replace(/\\\\/g, '/');\n        _libraryBase = cc.path.stripSep(libraryPath) + '/';\n\n        _rawAssetsBase = options.rawAssetsBase;\n\n        if (options.subpackages) {\n            var subPackPipe = new SubPackPipe(options.subpackages);\n            cc.loader.insertPipeAfter(cc.loader.assetLoader, subPackPipe);\n            cc.loader.subPackPipe = subPackPipe;\n        }\n        \n        var md5AssetsMap = options.md5AssetsMap;\n        if (md5AssetsMap && md5AssetsMap.import) {\n            // decode uuid\n            var i = 0, uuid = 0;\n            var md5ImportMap = js.createMap(true);\n            var md5Entries = md5AssetsMap.import;\n            for (i = 0; i < md5Entries.length; i += 2) {\n                uuid = decodeUuid(md5Entries[i]);\n                md5ImportMap[uuid] = md5Entries[i + 1];\n            }\n\n            var md5RawAssetsMap = js.createMap(true);\n            md5Entries = md5AssetsMap['raw-assets'];\n            for (i = 0; i < md5Entries.length; i += 2) {\n                uuid = decodeUuid(md5Entries[i]);\n                md5RawAssetsMap[uuid] = md5Entries[i + 1];\n            }\n\n            var md5Pipe = new MD5Pipe(md5ImportMap, md5RawAssetsMap, _libraryBase);\n            cc.loader.insertPipeAfter(cc.loader.assetLoader, md5Pipe);\n            cc.loader.md5Pipe = md5Pipe;\n        }\n\n        // init raw assets\n\n        var assetTables = Loader._assetTables;\n        for (var mount in assetTables) {\n            assetTables[mount].reset();\n        }\n        \n        var rawAssets = options.rawAssets;\n        if (rawAssets) {\n            for (var mountPoint in rawAssets) {\n                var assets = rawAssets[mountPoint];\n                for (var uuid in assets) {\n                    var info = assets[uuid];\n                    var url = info[0];\n                    var typeId = info[1];\n                    var type = cc.js._getClassById(typeId);\n                    if (!type) {\n                        cc.error('Cannot get', typeId);\n                        continue;\n                    }\n                    // backward compatibility since 1.10\n                    _uuidToRawAsset[uuid] = new RawAssetEntry(mountPoint + '/' + url, type);\n                    // init resources\n                    var ext = cc.path.extname(url);\n                    if (ext) {\n                        // trim base dir and extname\n                        url = url.slice(0, - ext.length);\n                    }\n\n                    var isSubAsset = info[2] === 1;\n                    if (!assetTables[mountPoint]) {\n                        assetTables[mountPoint] = new AssetTable();\n                    } \n\n                    assetTables[mountPoint].add(url, uuid, type, !isSubAsset);\n                }\n            }\n        }\n\n        if (options.packedAssets) {\n            PackDownloader.initPacks(options.packedAssets);\n        }\n\n        // init cc.url\n        cc.url._init((options.mountPaths && options.mountPaths.assets) || _rawAssetsBase + 'assets');\n    }\n\n};\n\n// unload asset if it is destoryed\n\n/**\n * !#en Caches uuid to all loaded assets in scenes.\n *\n * !#zh 这里保存所有已经加载的场景资源，防止同一个资源在内存中加载出多份拷贝。\n *\n * 这里用不了WeakMap，在浏览器中所有加载过的资源都只能手工调用 unloadAsset 释放。\n *\n * 参考：\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap\n * https://github.com/TooTallNate/node-weak\n *\n * @property {object} _uuidToAsset\n * @private\n */\nAssetLibrary._uuidToAsset = {};\n\n//暂时屏蔽，因为目前没有缓存任何asset\n//if (CC_DEV && Asset.prototype._onPreDestroy) {\n//    cc.error('_onPreDestroy of Asset has already defined');\n//}\n//Asset.prototype._onPreDestroy = function () {\n//    if (AssetLibrary._uuidToAsset[this._uuid] === this) {\n//        AssetLibrary.unloadAsset(this);\n//    }\n//};\n\n\n// TODO: Add BuiltinManager to handle builtin logic\nlet _builtins = {\n    effect: {},\n    material: {}\n};\n\nlet _builtinDeps = {};\n\nfunction loadBuiltins (name, type, cb) {\n    let dirname = name  + 's';\n    let builtin = _builtins[name] = {};\n    let internalMountPath = 'internal';\n    // internal path will be changed when run simulator\n    if (CC_PREVIEW && CC_JSB) {\n        internalMountPath = 'temp/internal';\n    }\n    cc.loader.loadResDir(dirname, type, internalMountPath, () => { }, (err, assets) => {\n        if (err) {\n            cc.error(err);\n        }\n        else {\n            for (let i = 0; i < assets.length; i++) {\n                var asset = assets[i];\n                var deps = cc.loader.getDependsRecursively(asset);\n                deps.forEach(uuid => _builtinDeps[uuid] = true);\n                builtin[`${asset.name}`] = asset;\n            }\n        }\n\n        cb();\n    });\n}\n\nAssetLibrary._loadBuiltins = function (cb) {\n    if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {\n        return cb && cb();\n    }\n\n    loadBuiltins('effect', cc.EffectAsset, () => {\n        loadBuiltins('material', cc.Material, cb);\n    });\n};\n\nAssetLibrary.getBuiltin = function (type, name) {\n    return _builtins[type][name];\n};\n\nAssetLibrary.getBuiltins = function (type) {\n    if (!type) return _builtins;\n    return _builtins[type];\n};\nAssetLibrary.resetBuiltins = function () {\n    _builtins = {\n        effect: {},\n        material: {}\n    };\n    _builtinDeps = {};\n};\nAssetLibrary.getBuiltinDeps = function () {\n    return _builtinDeps;\n}\n\nmodule.exports = cc.AssetLibrary = AssetLibrary;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require('./js');\nvar Enum = require('./CCEnum');\nvar utils = require('./utils');\nvar _isPlainEmptyObj_DEV = utils.isPlainEmptyObj_DEV;\nvar _cloneable_DEV = utils.cloneable_DEV;\nvar Attr = require('./attribute');\nvar DELIMETER = Attr.DELIMETER;\nvar preprocess = require('./preprocess-class');\nrequire('./requiring-frame');\n\nvar BUILTIN_ENTRIES = ['name', 'extends', 'mixins', 'ctor', '__ctor__', 'properties', 'statics', 'editor', '__ES6__'];\n\nvar INVALID_STATICS_DEV = CC_DEV && ['name', '__ctors__', '__props__', 'arguments', 'call', 'apply', 'caller',\n                       'length', 'prototype'];\n\nfunction pushUnique (array, item) {\n    if (array.indexOf(item) < 0) {\n        array.push(item);\n    }\n}\n\nvar deferredInitializer = {\n\n    // Configs for classes which needs deferred initialization\n    datas: null,\n\n    // register new class\n    // data - {cls: cls, cb: properties, mixins: options.mixins}\n    push: function (data) {\n        if (this.datas) {\n            this.datas.push(data);\n        }\n        else {\n            this.datas = [data];\n            // start a new timer to initialize\n            var self = this;\n            setTimeout(function () {\n                self.init();\n            }, 0);\n        }\n    },\n\n    init: function () {\n        var datas = this.datas;\n        if (datas) {\n            for (var i = 0; i < datas.length; ++i) {\n                var data = datas[i];\n                var cls = data.cls;\n                var properties = data.props;\n                if (typeof properties === 'function') {\n                    properties = properties();\n                }\n                var name = js.getClassName(cls);\n                if (properties) {\n                    declareProperties(cls, name, properties, cls.$super, data.mixins);\n                }\n                else {\n                    cc.errorID(3633, name);\n                }\n            }\n            this.datas = null;\n        }\n    }\n};\n\n// both getter and prop must register the name into __props__ array\nfunction appendProp (cls, name) {\n    if (CC_DEV) {\n        //if (!IDENTIFIER_RE.test(name)) {\n        //    cc.error('The property name \"' + name + '\" is not compliant with JavaScript naming standards');\n        //    return;\n        //}\n        if (name.indexOf('.') !== -1) {\n            cc.errorID(3634);\n            return;\n        }\n    }\n    pushUnique(cls.__props__, name);\n}\n\nfunction defineProp (cls, className, propName, val, es6) {\n    var defaultValue = val.default;\n\n    if (CC_DEV) {\n        if (!es6) {\n            // check default object value\n            if (typeof defaultValue === 'object' && defaultValue) {\n                if (Array.isArray(defaultValue)) {\n                    // check array empty\n                    if (defaultValue.length > 0) {\n                        cc.errorID(3635, className, propName, propName);\n                        return;\n                    }\n                }\n                else if (!_isPlainEmptyObj_DEV(defaultValue)) {\n                    // check cloneable\n                    if (!_cloneable_DEV(defaultValue)) {\n                        cc.errorID(3636, className, propName, propName);\n                        return;\n                    }\n                }\n            }\n        }\n\n        // check base prototype to avoid name collision\n        if (CCClass.getInheritanceChain(cls)\n                   .some(function (x) { return x.prototype.hasOwnProperty(propName); }))\n        {\n            cc.errorID(3637, className, propName, className);\n            return;\n        }\n    }\n\n    // set default value\n    Attr.setClassAttr(cls, propName, 'default', defaultValue);\n\n    appendProp(cls, propName);\n\n    // apply attributes\n    parseAttributes(cls, val, className, propName, false);\n    if ((CC_EDITOR && !Editor.isBuilder) || CC_TEST) {\n        for (let i = 0; i < onAfterProps_ET.length; i++) {\n            onAfterProps_ET[i](cls, propName);\n        }\n        onAfterProps_ET.length = 0;\n    }\n}\n\nfunction defineGetSet (cls, name, propName, val, es6) {\n    var getter = val.get;\n    var setter = val.set;\n    var proto = cls.prototype;\n    var d = Object.getOwnPropertyDescriptor(proto, propName);\n    var setterUndefined = !d;\n\n    if (getter) {\n        if (CC_DEV && !es6 && d && d.get) {\n            cc.errorID(3638, name, propName);\n            return;\n        }\n\n        parseAttributes(cls, val, name, propName, true);\n        if ((CC_EDITOR && !Editor.isBuilder) || CC_TEST) {\n            onAfterProps_ET.length = 0;\n        }\n\n        Attr.setClassAttr(cls, propName, 'serializable', false);\n\n        if (CC_DEV) {\n            // 不论是否 visible 都要添加到 props，否则 asset watcher 不能正常工作\n            appendProp(cls, propName);\n        }\n\n        if (!es6) {\n            js.get(proto, propName, getter, setterUndefined, setterUndefined);\n        }\n\n        if (CC_EDITOR || CC_DEV) {\n            Attr.setClassAttr(cls, propName, 'hasGetter', true); // 方便 editor 做判断\n        }\n    }\n\n    if (setter) {\n        if (!es6) {\n            if (CC_DEV && d && d.set) {\n                return cc.errorID(3640, name, propName);\n            }\n            js.set(proto, propName, setter, setterUndefined, setterUndefined);\n        }\n        if (CC_EDITOR || CC_DEV) {\n            Attr.setClassAttr(cls, propName, 'hasSetter', true); // 方便 editor 做判断\n        }\n    }\n}\n\nfunction getDefault (defaultVal) {\n    if (typeof defaultVal === 'function') {\n        if (CC_EDITOR) {\n            try {\n                return defaultVal();\n            }\n            catch (e) {\n                cc._throw(e);\n                return undefined;\n            }\n        }\n        else {\n            return defaultVal();\n        }\n    }\n    return defaultVal;\n}\n\nfunction mixinWithInherited (dest, src, filter) {\n    for (var prop in src) {\n        if (!dest.hasOwnProperty(prop) && (!filter || filter(prop))) {\n            Object.defineProperty(dest, prop, js.getPropertyDescriptor(src, prop));\n        }\n    }\n}\n\nfunction doDefine (className, baseClass, mixins, options) {\n    var shouldAddProtoCtor;\n    var __ctor__ = options.__ctor__;\n    var ctor = options.ctor;\n    var __es6__ = options.__ES6__;\n\n    if (CC_DEV) {\n        // check ctor\n        var ctorToUse = __ctor__ || ctor;\n        if (ctorToUse) {\n            if (CCClass._isCCClass(ctorToUse)) {\n                cc.errorID(3618, className);\n            }\n            else if (typeof ctorToUse !== 'function') {\n                cc.errorID(3619, className);\n            }\n            else {\n                if (baseClass && /\\bprototype.ctor\\b/.test(ctorToUse)) {\n                    if (__es6__) {\n                        cc.errorID(3651, className || \"\");\n                    }\n                    else {\n                        cc.warnID(3600, className || \"\");\n                        shouldAddProtoCtor = true;\n                    }\n                }\n            }\n            if (ctor) {\n                if (__ctor__) {\n                    cc.errorID(3649, className);\n                }\n                else {\n                    ctor = options.ctor = _validateCtor_DEV(ctor, baseClass, className, options);\n                }\n            }\n        }\n    }\n\n    var ctors;\n    var fireClass;\n    if (__es6__) {\n        ctors = [ctor];\n        fireClass = ctor;\n    }\n    else {\n        ctors = __ctor__ ? [__ctor__] : _getAllCtors(baseClass, mixins, options);\n        fireClass = _createCtor(ctors, baseClass, className, options);\n\n        // extend - Create a new Class that inherits from this Class\n        js.value(fireClass, 'extend', function (options) {\n            options.extends = this;\n            return CCClass(options);\n        }, true);\n    }\n\n    js.value(fireClass, '__ctors__', ctors.length > 0 ? ctors : null, true);\n\n\n    var prototype = fireClass.prototype;\n    if (baseClass) {\n        if (!__es6__) {\n            js.extend(fireClass, baseClass);        // 这里会把父类的 __props__ 复制给子类\n            prototype = fireClass.prototype;        // get extended prototype\n        }\n        fireClass.$super = baseClass;\n        if (CC_DEV && shouldAddProtoCtor) {\n            prototype.ctor = function () {};\n        }\n    }\n\n    if (mixins) {\n        for (var m = mixins.length - 1; m >= 0; m--) {\n            var mixin = mixins[m];\n            mixinWithInherited(prototype, mixin.prototype);\n\n            // mixin statics (this will also copy editor attributes for component)\n            mixinWithInherited(fireClass, mixin, function (prop) {\n                return mixin.hasOwnProperty(prop) && (!CC_DEV || INVALID_STATICS_DEV.indexOf(prop) < 0);\n            });\n\n            // mixin attributes\n            if (CCClass._isCCClass(mixin)) {\n                mixinWithInherited(Attr.getClassAttrs(fireClass), Attr.getClassAttrs(mixin));\n            }\n        }\n        // restore constuctor overridden by mixin\n        prototype.constructor = fireClass;\n    }\n\n    if (!__es6__) {\n        prototype.__initProps__ = compileProps;\n    }\n\n    js.setClassName(className, fireClass);\n    return fireClass;\n}\n\nfunction define (className, baseClass, mixins, options) {\n    var Component = cc.Component;\n    var frame = cc._RF.peek();\n    if (frame && js.isChildClassOf(baseClass, Component)) {\n        // project component\n        if (js.isChildClassOf(frame.cls, Component)) {\n            cc.errorID(3615);\n            return null;\n        }\n        if (CC_DEV && frame.uuid && className) {\n            cc.warnID(3616, className);\n        }\n        className = className || frame.script;\n    }\n\n    var cls = doDefine(className, baseClass, mixins, options);\n\n    if (frame) {\n        if (js.isChildClassOf(baseClass, Component)) {\n            var uuid = frame.uuid;\n            if (uuid) {\n                js._setClassId(uuid, cls);\n                if (CC_EDITOR) {\n                    Component._addMenuItem(cls, 'i18n:MAIN_MENU.component.scripts/' + className, -1);\n                    cls.prototype.__scriptUuid = Editor.Utils.UuidUtils.decompressUuid(uuid);\n                }\n            }\n            frame.cls = cls;\n        }\n        else if (!js.isChildClassOf(frame.cls, Component)) {\n            frame.cls = cls;\n        }\n    }\n    return cls;\n}\n\nfunction normalizeClassName_DEV (className) {\n    var DefaultName = 'CCClass';\n    if (className) {\n        className = className.replace(/^[^$A-Za-z_]/, '_').replace(/[^0-9A-Za-z_$]/g, '_');\n        try {\n            // validate name\n            Function('function ' + className + '(){}')();\n            return className;\n        }\n        catch (e) {\n            ;\n        }\n    }\n    return DefaultName;\n}\n\nfunction getNewValueTypeCodeJit (value) {\n    var clsName = js.getClassName(value);\n    var type = value.constructor;\n    var res = 'new ' + clsName + '(';\n    for (var i = 0; i < type.__props__.length; i++) {\n        var prop = type.__props__[i];\n        var propVal = value[prop];\n        if (CC_DEV && typeof propVal === 'object') {\n            cc.errorID(3641, clsName);\n            return 'new ' + clsName + '()';\n        }\n        res += propVal;\n        if (i < type.__props__.length - 1) {\n            res += ',';\n        }\n    }\n    return res + ')';\n}\n\n// TODO - move escapeForJS, IDENTIFIER_RE, getNewValueTypeCodeJit to misc.js or a new source file\n\n// convert a normal string including newlines, quotes and unicode characters into a string literal\n// ready to use in JavaScript source\nfunction escapeForJS (s) {\n    return JSON.stringify(s).\n        // see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify\n        replace(/\\u2028/g, '\\\\u2028').\n        replace(/\\u2029/g, '\\\\u2029');\n}\n\nfunction getInitPropsJit (attrs, propList) {\n    // functions for generated code\n    var F = [];\n    var func = '';\n\n    for (var i = 0; i < propList.length; i++) {\n        var prop = propList[i];\n        var attrKey = prop + DELIMETER + 'default';\n        if (attrKey in attrs) {  // getter does not have default\n            var statement;\n            if (IDENTIFIER_RE.test(prop)) {\n                statement = 'this.' + prop + '=';\n            }\n            else {\n                statement = 'this[' + escapeForJS(prop) + ']=';\n            }\n            var expression;\n            var def = attrs[attrKey];\n            if (typeof def === 'object' && def) {\n                if (def instanceof cc.ValueType) {\n                    expression = getNewValueTypeCodeJit(def);\n                }\n                else if (Array.isArray(def)) {\n                    expression = '[]';\n                }\n                else {\n                    expression = '{}';\n                }\n            }\n            else if (typeof def === 'function') {\n                var index = F.length;\n                F.push(def);\n                expression = 'F[' + index + ']()';\n                if (CC_EDITOR) {\n                    func += 'try {\\n' + statement + expression + ';\\n}\\ncatch(e) {\\ncc._throw(e);\\n' + statement + 'undefined;\\n}\\n';\n                    continue;\n                }\n            }\n            else if (typeof def === 'string') {\n                expression = escapeForJS(def);\n            }\n            else {\n                // number, boolean, null, undefined\n                expression = def;\n            }\n            statement = statement + expression + ';\\n';\n            func += statement;\n        }\n    }\n\n    // if (CC_TEST && !isPhantomJS) {\n    //     console.log(func);\n    // }\n\n    var initProps;\n    if (F.length === 0) {\n        initProps = Function(func);\n    }\n    else {\n        initProps = Function('F', 'return (function(){\\n' + func + '})')(F);\n    }\n\n    return initProps;\n}\n\nfunction getInitProps (attrs, propList) {\n    var advancedProps = [];\n    var advancedValues = [];\n    var simpleProps = [];\n    var simpleValues = [];\n\n    for (var i = 0; i < propList.length; ++i) {\n        var prop = propList[i];\n        var attrKey = prop + DELIMETER + 'default';\n        if (attrKey in attrs) { // getter does not have default\n            var def = attrs[attrKey];\n            if ((typeof def === 'object' && def) || typeof def === 'function') {\n                advancedProps.push(prop);\n                advancedValues.push(def);\n            }\n            else {\n                // number, boolean, null, undefined, string\n                simpleProps.push(prop);\n                simpleValues.push(def);\n            }\n        }\n    }\n\n    return function () {\n        for (let i = 0; i < simpleProps.length; ++i) {\n            this[simpleProps[i]] = simpleValues[i];\n        }\n        for (let i = 0; i < advancedProps.length; i++) {\n            let prop = advancedProps[i];\n            var expression;\n            var def = advancedValues[i];\n            if (typeof def === 'object') {\n                if (def instanceof cc.ValueType) {\n                    expression = def.clone();\n                }\n                else if (Array.isArray(def)) {\n                    expression = [];\n                }\n                else {\n                    expression = {};\n                }\n            }\n            else {\n                // def is function\n                if (CC_EDITOR) {\n                    try {\n                        expression = def();\n                    }\n                    catch (err) {\n                        cc._throw(e);\n                        continue;\n                    }\n                }\n                else {\n                    expression = def();\n                }\n            }\n            this[prop] = expression;\n        }\n    };\n}\n\n// simple test variable name\nvar IDENTIFIER_RE = /^[A-Za-z_$][0-9A-Za-z_$]*$/;\nfunction compileProps (actualClass) {\n    // init deferred properties\n    var attrs = Attr.getClassAttrs(actualClass);\n    var propList = actualClass.__props__;\n    if (propList === null) {\n        deferredInitializer.init();\n        propList = actualClass.__props__;\n    }\n\n    // Overwite __initProps__ to avoid compile again.\n    var initProps = CC_SUPPORT_JIT ? getInitPropsJit(attrs, propList) : getInitProps(attrs, propList);\n    actualClass.prototype.__initProps__ = initProps;\n\n    // call instantiateProps immediately, no need to pass actualClass into it anymore\n    // (use call to manually bind `this` because `this` may not instanceof actualClass)\n    initProps.call(this);\n}\n\nvar _createCtor = CC_SUPPORT_JIT ? function (ctors, baseClass, className, options) {\n    var superCallBounded = baseClass && boundSuperCalls(baseClass, options, className);\n\n    var ctorName = CC_DEV ? normalizeClassName_DEV(className) : 'CCClass';\n    var body = 'return function ' + ctorName + '(){\\n';\n\n    if (superCallBounded) {\n        body += 'this._super=null;\\n';\n    }\n\n    // instantiate props\n    body += 'this.__initProps__(' + ctorName + ');\\n';\n\n    // call user constructors\n    var ctorLen = ctors.length;\n    if (ctorLen > 0) {\n        var useTryCatch = CC_DEV && ! (className && className.startsWith('cc.'));\n        if (useTryCatch) {\n            body += 'try{\\n';\n        }\n        var SNIPPET = '].apply(this,arguments);\\n';\n        if (ctorLen === 1) {\n            body += ctorName + '.__ctors__[0' + SNIPPET;\n        }\n        else {\n            body += 'var cs=' + ctorName + '.__ctors__;\\n';\n            for (var i = 0; i < ctorLen; i++) {\n                body += 'cs[' + i + SNIPPET;\n            }\n        }\n        if (useTryCatch) {\n            body += '}catch(e){\\n' +\n                        'cc._throw(e);\\n' +\n                    '}\\n';\n        }\n    }\n    body += '}';\n\n    return Function(body)();\n} : function (ctors, baseClass, className, options) {\n    var superCallBounded = baseClass && boundSuperCalls(baseClass, options, className);\n    var ctorLen = ctors.length;\n\n    var Class;\n\n    if (ctorLen > 0) {\n        if (superCallBounded) {\n            if (ctorLen === 2) {\n                // User Component\n                Class = function () {\n                    this._super = null;\n                    this.__initProps__(Class);\n                    ctors[0].apply(this, arguments);\n                    ctors[1].apply(this, arguments);\n                };\n            }\n            else {\n                Class = function () {\n                    this._super = null;\n                    this.__initProps__(Class);\n                    for (let i = 0; i < ctors.length; ++i) {\n                        ctors[i].apply(this, arguments);\n                    }\n                };\n            }\n        }\n        else {\n            if (ctorLen === 3) {\n                // Node\n                Class = function () {\n                    this.__initProps__(Class);\n                    ctors[0].apply(this, arguments);\n                    ctors[1].apply(this, arguments);\n                    ctors[2].apply(this, arguments);\n                };\n            }\n            else {\n                Class = function () {\n                    this.__initProps__(Class);\n                    var ctors = Class.__ctors__;\n                    for (let i = 0; i < ctors.length; ++i) {\n                        ctors[i].apply(this, arguments);\n                    }\n                };\n            }\n        }\n    }\n    else {\n        Class = function () {\n            if (superCallBounded) {\n                this._super = null;\n            }\n            this.__initProps__(Class);\n        };\n    }\n    return Class;\n};\n\nfunction _validateCtor_DEV (ctor, baseClass, className, options) {\n    if (CC_EDITOR && baseClass) {\n        // check super call in constructor\n        var originCtor = ctor;\n        if (SuperCallReg.test(ctor)) {\n            if (options.__ES6__) {\n                cc.errorID(3651, className);\n            }\n            else {\n                cc.warnID(3600, className);\n                // suppresss super call\n                ctor = function () {\n                    this._super = function () {};\n                    var ret = originCtor.apply(this, arguments);\n                    this._super = null;\n                    return ret;\n                };\n            }\n        }\n    }\n\n    // check ctor\n    if (ctor.length > 0 && (!className || !className.startsWith('cc.'))) {\n        // To make a unified CCClass serialization process,\n        // we don't allow parameters for constructor when creating instances of CCClass.\n        // For advanced user, construct arguments can still get from 'arguments'.\n        cc.warnID(3617, className);\n    }\n\n    return ctor;\n}\n\nfunction _getAllCtors (baseClass, mixins, options) {\n    // get base user constructors\n    function getCtors (cls) {\n        if (CCClass._isCCClass(cls)) {\n            return cls.__ctors__ || [];\n        }\n        else {\n            return [cls];\n        }\n    }\n\n    var ctors = [];\n    // if (options.__ES6__) {\n    //     if (mixins) {\n    //         let baseOrMixins = getCtors(baseClass);\n    //         for (let b = 0; b < mixins.length; b++) {\n    //             let mixin = mixins[b];\n    //             if (mixin) {\n    //                 let baseCtors = getCtors(mixin);\n    //                 for (let c = 0; c < baseCtors.length; c++) {\n    //                     if (baseOrMixins.indexOf(baseCtors[c]) < 0) {\n    //                         pushUnique(ctors, baseCtors[c]);\n    //                     }\n    //                 }\n    //             }\n    //         }\n    //     }\n    // }\n    // else {\n    let baseOrMixins = [baseClass].concat(mixins);\n    for (let b = 0; b < baseOrMixins.length; b++) {\n        let baseOrMixin = baseOrMixins[b];\n        if (baseOrMixin) {\n            let baseCtors = getCtors(baseOrMixin);\n            for (let c = 0; c < baseCtors.length; c++) {\n                pushUnique(ctors, baseCtors[c]);\n            }\n        }\n    }\n    // }\n\n    // append subclass user constructors\n    var ctor = options.ctor;\n    if (ctor) {\n        ctors.push(ctor);\n    }\n\n    return ctors;\n}\n\nvar SuperCallReg = /xyz/.test(function(){xyz}) ? /\\b\\._super\\b/ : /.*/;\nvar SuperCallRegStrict = /xyz/.test(function(){xyz}) ? /this\\._super\\s*\\(/ : /(NONE){99}/;\nfunction boundSuperCalls (baseClass, options, className) {\n    var hasSuperCall = false;\n    for (var funcName in options) {\n        if (BUILTIN_ENTRIES.indexOf(funcName) >= 0) {\n            continue;\n        }\n        var func = options[funcName];\n        if (typeof func !== 'function') {\n            continue;\n        }\n        var pd = js.getPropertyDescriptor(baseClass.prototype, funcName);\n        if (pd) {\n            var superFunc = pd.value;\n            // ignore pd.get, assume that function defined by getter is just for warnings\n            if (typeof superFunc === 'function') {\n                if (SuperCallReg.test(func)) {\n                    hasSuperCall = true;\n                    // boundSuperCall\n                    options[funcName] = (function (superFunc, func) {\n                        return function () {\n                            var tmp = this._super;\n\n                            // Add a new ._super() method that is the same method but on the super-Class\n                            this._super = superFunc;\n\n                            var ret = func.apply(this, arguments);\n\n                            // The method only need to be bound temporarily, so we remove it when we're done executing\n                            this._super = tmp;\n\n                            return ret;\n                        };\n                    })(superFunc, func);\n                }\n                continue;\n            }\n        }\n        if (CC_DEV && SuperCallRegStrict.test(func)) {\n            cc.warnID(3620, className, funcName);\n        }\n    }\n    return hasSuperCall;\n}\n\nfunction declareProperties (cls, className, properties, baseClass, mixins, es6) {\n    cls.__props__ = [];\n\n    if (baseClass && baseClass.__props__) {\n        cls.__props__ = baseClass.__props__.slice();\n    }\n\n    if (mixins) {\n        for (var m = 0; m < mixins.length; ++m) {\n            var mixin = mixins[m];\n            if (mixin.__props__) {\n                cls.__props__ = cls.__props__.concat(mixin.__props__.filter(function (x) {\n                    return cls.__props__.indexOf(x) < 0;\n                }));\n            }\n        }\n    }\n\n    if (properties) {\n        // 预处理属性\n        preprocess.preprocessAttrs(properties, className, cls, es6);\n\n        for (var propName in properties) {\n            var val = properties[propName];\n            if ('default' in val) {\n                defineProp(cls, className, propName, val, es6);\n            }\n            else {\n                defineGetSet(cls, className, propName, val, es6);\n            }\n        }\n    }\n\n    var attrs = Attr.getClassAttrs(cls);\n    cls.__values__ = cls.__props__.filter(function (prop) {\n        return attrs[prop + DELIMETER + 'serializable'] !== false;\n    });\n}\n\n/**\n * @module cc\n */\n\n/**\n * !#en Defines a CCClass using the given specification, please see [Class](/docs/editors_and_tools/creator-chapters/scripting/class.html) for details.\n * !#zh 定义一个 CCClass，传入参数必须是一个包含类型参数的字面量对象，具体用法请查阅[类型定义](/docs/creator/scripting/class.html)。\n *\n * @method Class\n *\n * @param {Object} [options]\n * @param {String} [options.name] - The class name used for serialization.\n * @param {Function} [options.extends] - The base class.\n * @param {Function} [options.ctor] - The constructor.\n * @param {Function} [options.__ctor__] - The same as ctor, but less encapsulated.\n * @param {Object} [options.properties] - The property definitions.\n * @param {Object} [options.statics] - The static members.\n * @param {Function[]} [options.mixins]\n *\n * @param {Object} [options.editor] - attributes for Component listed below.\n * @param {Boolean} [options.editor.executeInEditMode=false] - Allows the current component to run in edit mode. By default, all components are executed only at runtime, meaning that they will not have their callback functions executed while the Editor is in edit mode.\n * @param {Function} [options.editor.requireComponent] - Automatically add required component as a dependency.\n * @param {String} [options.editor.menu] - The menu path to register a component to the editors \"Component\" menu. Eg. \"Rendering/Camera\".\n * @param {Number} [options.editor.executionOrder=0] - The execution order of lifecycle methods for Component. Those less than 0 will execute before while those greater than 0 will execute after. The order will only affect onLoad, onEnable, start, update and lateUpdate while onDisable and onDestroy will not be affected.\n * @param {Boolean} [options.editor.disallowMultiple] - If specified to a type, prevents Component of the same type (or subtype) to be added more than once to a Node.\n * @param {Boolean} [options.editor.playOnFocus=false] - This property is only available when executeInEditMode is set. If specified, the editor's scene view will keep updating this node in 60 fps when it is selected, otherwise, it will update only if necessary.\n * @param {String} [options.editor.inspector] - Customize the page url used by the current component to render in the Properties.\n * @param {String} [options.editor.icon] - Customize the icon that the current component displays in the editor.\n * @param {String} [options.editor.help] - The custom documentation URL\n *\n * @param {Function} [options.update] - lifecycle method for Component, see {{#crossLink \"Component/update:method\"}}{{/crossLink}}\n * @param {Function} [options.lateUpdate] - lifecycle method for Component, see {{#crossLink \"Component/lateUpdate:method\"}}{{/crossLink}}\n * @param {Function} [options.onLoad] - lifecycle method for Component, see {{#crossLink \"Component/onLoad:method\"}}{{/crossLink}}\n * @param {Function} [options.start] - lifecycle method for Component, see {{#crossLink \"Component/start:method\"}}{{/crossLink}}\n * @param {Function} [options.onEnable] - lifecycle method for Component, see {{#crossLink \"Component/onEnable:method\"}}{{/crossLink}}\n * @param {Function} [options.onDisable] - lifecycle method for Component, see {{#crossLink \"Component/onDisable:method\"}}{{/crossLink}}\n * @param {Function} [options.onDestroy] - lifecycle method for Component, see {{#crossLink \"Component/onDestroy:method\"}}{{/crossLink}}\n * @param {Function} [options.onFocusInEditor] - lifecycle method for Component, see {{#crossLink \"Component/onFocusInEditor:method\"}}{{/crossLink}}\n * @param {Function} [options.onLostFocusInEditor] - lifecycle method for Component, see {{#crossLink \"Component/onLostFocusInEditor:method\"}}{{/crossLink}}\n * @param {Function} [options.resetInEditor] - lifecycle method for Component, see {{#crossLink \"Component/resetInEditor:method\"}}{{/crossLink}}\n * @param {Function} [options.onRestore] - for Component only, see {{#crossLink \"Component/onRestore:method\"}}{{/crossLink}}\n * @param {Function} [options._getLocalBounds] - for Component only, see {{#crossLink \"Component/_getLocalBounds:method\"}}{{/crossLink}}\n *\n * @return {Function} - the created class\n *\n * @example\n\n // define base class\n var Node = cc.Class();\n\n // define sub class\n var Sprite = cc.Class({\n     name: 'Sprite',\n     extends: Node,\n\n     ctor: function () {\n         this.url = \"\";\n         this.id = 0;\n     },\n\n     statics: {\n         // define static members\n         count: 0,\n         getBounds: function (spriteList) {\n             // compute bounds...\n         }\n     },\n\n     properties {\n         width: {\n             default: 128,\n             type: cc.Integer,\n             tooltip: 'The width of sprite'\n         },\n         height: 128,\n         size: {\n             get: function () {\n                 return cc.v2(this.width, this.height);\n             }\n         }\n     },\n\n     load: function () {\n         // load this.url...\n     };\n });\n\n // instantiate\n\n var obj = new Sprite();\n obj.url = 'sprite.png';\n obj.load();\n */\nfunction CCClass (options) {\n    options = options || {};\n\n    var name = options.name;\n    var base = options.extends/* || CCObject*/;\n    var mixins = options.mixins;\n\n    // create constructor\n    var cls = define(name, base, mixins, options);\n    if (!name) {\n        name = cc.js.getClassName(cls);\n    }\n\n    cls._sealed = true;\n    if (base) {\n        base._sealed = false;\n    }\n\n    // define Properties\n    var properties = options.properties;\n    if (typeof properties === 'function' ||\n        (base && base.__props__ === null) ||\n        (mixins && mixins.some(function (x) {\n            return x.__props__ === null;\n        }))\n    ) {\n        if (CC_DEV && options.__ES6__) {\n            cc.error('not yet implement deferred properties for ES6 Classes');\n        }\n        else {\n            deferredInitializer.push({cls: cls, props: properties, mixins: mixins});\n            cls.__props__ = cls.__values__ = null;\n        }\n    }\n    else {\n        declareProperties(cls, name, properties, base, options.mixins, options.__ES6__);\n    }\n\n    // define statics\n    var statics = options.statics;\n    if (statics) {\n        var staticPropName;\n        if (CC_DEV) {\n            for (staticPropName in statics) {\n                if (INVALID_STATICS_DEV.indexOf(staticPropName) !== -1) {\n                    cc.errorID(3642, name, staticPropName,\n                        staticPropName);\n                }\n            }\n        }\n        for (staticPropName in statics) {\n            cls[staticPropName] = statics[staticPropName];\n        }\n    }\n\n    // define functions\n    for (var funcName in options) {\n        if (BUILTIN_ENTRIES.indexOf(funcName) >= 0) {\n            continue;\n        }\n        var func = options[funcName];\n        if (!preprocess.validateMethodWithProps(func, funcName, name, cls, base)) {\n            continue;\n        }\n        // use value to redefine some super method defined as getter\n        js.value(cls.prototype, funcName, func, true, true);\n    }\n\n\n    var editor = options.editor;\n    if (editor) {\n        if (js.isChildClassOf(base, cc.Component)) {\n            cc.Component._registerEditorProps(cls, editor);\n        }\n        else if (CC_DEV) {\n            cc.warnID(3623, name);\n        }\n    }\n\n    return cls;\n}\n\n/**\n * Checks whether the constructor is created by cc.Class\n *\n * @method _isCCClass\n * @param {Function} constructor\n * @return {Boolean}\n * @private\n */\nCCClass._isCCClass = function (constructor) {\n    return constructor &&\n           constructor.hasOwnProperty('__ctors__');     // is not inherited __ctors__\n};\n\n//\n// Optimized define function only for internal classes\n//\n// @method _fastDefine\n// @param {String} className\n// @param {Function} constructor\n// @param {Object} serializableFields\n// @private\n//\nCCClass._fastDefine = function (className, constructor, serializableFields) {\n    js.setClassName(className, constructor);\n    //constructor.__ctors__ = constructor.__ctors__ || null;\n    var props = constructor.__props__ = constructor.__values__ = Object.keys(serializableFields);\n    var attrs = Attr.getClassAttrs(constructor);\n    for (var i = 0; i < props.length; i++) {\n        var key = props[i];\n        attrs[key + DELIMETER + 'visible'] = false;\n        attrs[key + DELIMETER + 'default'] = serializableFields[key];\n    }\n};\n\nCCClass.Attr = Attr;\nCCClass.attr = Attr.attr;\n\n/*\n * Return all super classes\n * @method getInheritanceChain\n * @param {Function} constructor\n * @return {Function[]}\n */\nCCClass.getInheritanceChain = function (klass) {\n    var chain = [];\n    for (;;) {\n        klass = js.getSuper(klass);\n        if (!klass) {\n            break;\n        }\n        if (klass !== Object) {\n            chain.push(klass);\n        }\n    }\n    return chain;\n};\n\nvar PrimitiveTypes = {\n    // Specify that the input value must be integer in Properties.\n    // Also used to indicates that the type of elements in array or the type of value in dictionary is integer.\n    Integer: 'Number',\n    // Indicates that the type of elements in array or the type of value in dictionary is double.\n    Float: 'Number',\n    Boolean: 'Boolean',\n    String: 'String',\n};\nvar onAfterProps_ET = [];\nfunction parseAttributes (cls, attributes, className, propName, usedInGetter) {\n    var ERR_Type = CC_DEV ? 'The %s of %s must be type %s' : '';\n\n    var attrs = null;\n    var propNamePrefix = '';\n    function initAttrs () {\n        propNamePrefix = propName + DELIMETER;\n        return attrs = Attr.getClassAttrs(cls);\n    }\n\n    if ((CC_EDITOR && !Editor.isBuilder) || CC_TEST) {\n        onAfterProps_ET.length = 0;\n    }\n\n    var type = attributes.type;\n    if (type) {\n        var primitiveType = PrimitiveTypes[type];\n        if (primitiveType) {\n            (attrs || initAttrs())[propNamePrefix + 'type'] = type;\n            if (((CC_EDITOR && !Editor.isBuilder) || CC_TEST) && !attributes._short) {\n                onAfterProps_ET.push(Attr.getTypeChecker_ET(primitiveType, 'cc.' + type));\n            }\n        }\n        else if (type === 'Object') {\n            if (CC_DEV) {\n                cc.errorID(3644, className, propName);\n            }\n        }\n        else {\n            if (type === Attr.ScriptUuid) {\n                (attrs || initAttrs())[propNamePrefix + 'type'] = 'Script';\n                attrs[propNamePrefix + 'ctor'] = cc.ScriptAsset;\n            }\n            else {\n                if (typeof type === 'object') {\n                    if (Enum.isEnum(type)) {\n                        (attrs || initAttrs())[propNamePrefix + 'type'] = 'Enum';\n                        attrs[propNamePrefix + 'enumList'] = Enum.getList(type);\n                    }\n                    else if (CC_DEV) {\n                        cc.errorID(3645, className, propName, type);\n                    }\n                }\n                else if (typeof type === 'function') {\n                    (attrs || initAttrs())[propNamePrefix + 'type'] = 'Object';\n                    attrs[propNamePrefix + 'ctor'] = type;\n                    if (((CC_EDITOR && !Editor.isBuilder) || CC_TEST) && !attributes._short) {\n                        onAfterProps_ET.push(attributes.url ? Attr.getTypeChecker_ET('String', 'cc.String') : Attr.getObjTypeChecker_ET(type));\n                    }\n                }\n                else if (CC_DEV) {\n                    cc.errorID(3646, className, propName, type);\n                }\n            }\n        }\n    }\n\n    function parseSimpleAttr (attrName, expectType) {\n        if (attrName in attributes) {\n            var val = attributes[attrName];\n            if (typeof val === expectType) {\n                (attrs || initAttrs())[propNamePrefix + attrName] = val;\n            }\n            else if (CC_DEV) {\n                cc.error(ERR_Type, attrName, className, propName, expectType);\n            }\n        }\n    }\n\n    if (attributes.editorOnly) {\n        if (CC_DEV && usedInGetter) {\n            cc.errorID(3613, \"editorOnly\", name, propName);\n        }\n        else {\n            (attrs || initAttrs())[propNamePrefix + 'editorOnly'] = true;\n        }\n    }\n    //parseSimpleAttr('preventDeferredLoad', 'boolean');\n    if (CC_DEV) {\n        parseSimpleAttr('displayName', 'string');\n        parseSimpleAttr('multiline', 'boolean');\n        if (attributes.readonly) {\n            (attrs || initAttrs())[propNamePrefix + 'readonly'] = true;\n        }\n        parseSimpleAttr('tooltip', 'string');\n        parseSimpleAttr('slide', 'boolean');\n    }\n\n    if (attributes.url) {\n        (attrs || initAttrs())[propNamePrefix + 'saveUrlAsAsset'] = true;\n    }\n    if (attributes.serializable === false) {\n        if (CC_DEV && usedInGetter) {\n            cc.errorID(3613, \"serializable\", name, propName);\n        }\n        else {\n            (attrs || initAttrs())[propNamePrefix + 'serializable'] = false;\n        }\n    }\n    parseSimpleAttr('formerlySerializedAs', 'string');\n\n    if (CC_EDITOR) {\n        parseSimpleAttr('notifyFor', 'string');\n\n        if ('animatable' in attributes) {\n            (attrs || initAttrs())[propNamePrefix + 'animatable'] = !!attributes.animatable;\n        }\n    }\n\n    if (CC_DEV) {\n        var visible = attributes.visible;\n        if (typeof visible !== 'undefined') {\n            if (!visible) {\n                (attrs || initAttrs())[propNamePrefix + 'visible'] = false;\n            }\n            else if (typeof visible === 'function') {\n                (attrs || initAttrs())[propNamePrefix + 'visible'] = visible;\n            }\n        }\n        else {\n            var startsWithUS = (propName.charCodeAt(0) === 95);\n            if (startsWithUS) {\n                (attrs || initAttrs())[propNamePrefix + 'visible'] = false;\n            }\n        }\n    }\n\n    var range = attributes.range;\n    if (range) {\n        if (Array.isArray(range)) {\n            if (range.length >= 2) {\n                (attrs || initAttrs())[propNamePrefix + 'min'] = range[0];\n                attrs[propNamePrefix + 'max'] = range[1];\n                if (range.length > 2) {\n                    attrs[propNamePrefix + 'step'] = range[2];\n                }\n            }\n            else if (CC_DEV) {\n                cc.errorID(3647);\n            }\n        }\n        else if (CC_DEV) {\n            cc.error(ERR_Type, 'range', className, propName, 'array');\n        }\n    }\n    parseSimpleAttr('min', 'number');\n    parseSimpleAttr('max', 'number');\n    parseSimpleAttr('step', 'number');\n}\n\ncc.Class = CCClass;\n\nmodule.exports = {\n    isArray: function (defaultVal) {\n        defaultVal = getDefault(defaultVal);\n        return Array.isArray(defaultVal);\n    },\n    fastDefine: CCClass._fastDefine,\n    getNewValueTypeCode: CC_SUPPORT_JIT && getNewValueTypeCodeJit,\n    IDENTIFIER_RE,\n    escapeForJS,\n    getDefault: getDefault\n};\n\nif (CC_TEST) {\n    js.mixin(CCClass, module.exports);\n}\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n// const FIX_BABEL6 = true;\n\n/**\n * !#en Some JavaScript decorators which can be accessed with \"cc._decorator\".\n * !#zh 一些 JavaScript 装饰器，目前可以通过 \"cc._decorator\" 来访问。\n * （这些 API 仍不完全稳定，有可能随着 JavaScript 装饰器的标准实现而调整）\n *\n * @submodule _decorator\n * @module _decorator\n * @main\n */\n\n// inspired by toddlxt (https://github.com/toddlxt/Creator-TypeScript-Boilerplate)\n\nrequire('./CCClass');\nconst Preprocess = require('./preprocess-class');\nconst js = require('./js');\nconst isPlainEmptyObj_DEV = CC_DEV && require('./utils').isPlainEmptyObj_DEV;\n\n// caches for class construction\nconst CACHE_KEY = '__ccclassCache__';\n\nfunction fNOP (ctor) {\n    return ctor;\n}\n\nfunction getSubDict (obj, key) {\n    return obj[key] || (obj[key] = {});\n}\n\nfunction checkCtorArgument (decorate) {\n    return function (target) {\n        if (typeof target === 'function') {\n            // no parameter, target is ctor\n            return decorate(target);\n        }\n        return function (ctor) {\n            return decorate(ctor, target);\n        };\n    };\n}\n\nfunction _checkNormalArgument (validator_DEV, decorate, decoratorName) {\n    return function (target) {\n        if (CC_DEV && validator_DEV(target, decoratorName) === false) {\n            return function () {\n                return fNOP;\n            };\n        }\n        return function (ctor) {\n            return decorate(ctor, target);\n        };\n    };\n}\n\nvar checkCompArgument = _checkNormalArgument.bind(null, CC_DEV && function (arg, decoratorName) {\n    if (!cc.Class._isCCClass(arg)) {\n        cc.error('The parameter for %s is missing.', decoratorName);\n        return false;\n    }\n});\n\nfunction _argumentChecker (type) {\n    return _checkNormalArgument.bind(null, CC_DEV && function (arg, decoratorName) {\n        if (arg instanceof cc.Component || arg === undefined) {\n            cc.error('The parameter for %s is missing.', decoratorName);\n            return false;\n        }\n        else if (typeof arg !== type) {\n            cc.error('The parameter for %s must be type %s.', decoratorName, type);\n            return false;\n        }\n    });\n}\nvar checkStringArgument = _argumentChecker('string');\nvar checkNumberArgument = _argumentChecker('number');\n// var checkBooleanArgument = _argumentChecker('boolean');\n\n\nfunction getClassCache (ctor, decoratorName) {\n    if (CC_DEV && cc.Class._isCCClass(ctor)) {\n        cc.error('`@%s` should be used after @ccclass for class \"%s\"', decoratorName, js.getClassName(ctor));\n        return null;\n    }\n    return getSubDict(ctor, CACHE_KEY);\n}\n\nfunction getDefaultFromInitializer (initializer) {\n    var value;\n    try {\n        value = initializer();\n    }\n    catch (e) {\n        // just lazy initialize by CCClass\n        return initializer;\n    }\n    if (typeof value !== 'object' || value === null) {\n        // string boolean number function undefined null\n        return value;\n    }\n    else {\n        // The default attribute will not be used in ES6 constructor actually,\n        // so we dont need to simplify into `{}` or `[]` or vec2 completely.\n        return initializer;\n    }\n}\n\n\nfunction extractActualDefaultValues (ctor) {\n    var dummyObj;\n    try {\n        dummyObj = new ctor();\n    }\n    catch (e) {\n        if (CC_DEV) {\n            cc.warnID(3652, js.getClassName(ctor), e);\n        }\n        return {};\n    }\n    return dummyObj;\n}\n\nfunction genProperty (ctor, properties, propName, options, desc, cache) {\n    var fullOptions;\n    if (options) {\n        fullOptions = CC_DEV ? Preprocess.getFullFormOfProperty(options, propName, js.getClassName(ctor)) :\n                               Preprocess.getFullFormOfProperty(options);\n    }\n    var existsProperty = properties[propName];\n    var prop = js.mixin(existsProperty || {}, fullOptions || options || {});\n\n    var isGetset = desc && (desc.get || desc.set);\n    if (isGetset) {\n        // typescript or babel\n        if (CC_DEV && options && (options.get || options.set)) {\n            var errorProps = getSubDict(cache, 'errorProps');\n            if (!errorProps[propName]) {\n                errorProps[propName] = true;\n                cc.warnID(3655, propName, js.getClassName(ctor), propName, propName);\n            }\n        }\n        if (desc.get) {\n            prop.get = desc.get;\n        }\n        if (desc.set) {\n            prop.set = desc.set;\n        }\n    }\n    else {\n        if (CC_DEV && (prop.get || prop.set)) {\n            // @property({\n            //     get () { ... },\n            //     set (...) { ... },\n            // })\n            // value;\n            cc.errorID(3655, propName, js.getClassName(ctor), propName, propName);\n            return;\n        }\n        // member variables\n        var defaultValue = undefined;\n        var isDefaultValueSpecified = false;\n        if (desc) {\n            // babel\n            if (desc.initializer) {\n                // @property(...)\n                // value = null;\n                defaultValue = getDefaultFromInitializer(desc.initializer);\n                isDefaultValueSpecified = true;\n            }\n            else {\n                // @property(...)\n                // value;\n            }\n        }\n        else {\n            // typescript\n            var actualDefaultValues = cache.default || (cache.default = extractActualDefaultValues(ctor));\n            if (actualDefaultValues.hasOwnProperty(propName)) {\n                // @property(...)\n                // value = null;\n                defaultValue = actualDefaultValues[propName];\n                isDefaultValueSpecified = true;\n            }\n            else {\n                // @property(...)\n                // value;\n            }\n        }\n\n        if ((CC_EDITOR && !Editor.isBuilder) || CC_TEST) {\n            if (!fullOptions && options && options.hasOwnProperty('default')) {\n                cc.warnID(3653, propName, js.getClassName(ctor));\n                // prop.default = options.default;\n            }\n            else if (!isDefaultValueSpecified) {\n                cc.warnID(3654, js.getClassName(ctor), propName);\n                // prop.default = fullOptions.hasOwnProperty('default') ? fullOptions.default : undefined;\n            }\n            if (cc.RawAsset.wasRawAssetType(prop.url) &&\n                prop._short &&\n                isDefaultValueSpecified &&\n                defaultValue == null\n            ) {\n                // Avoid excessive warning when the ts decorator format is wrong\n                if (typeof options !== 'function' || cc.RawAsset.isRawAssetType(options)) {\n                    cc.warnID(3656, js.getClassName(ctor), propName);\n                }\n            }\n        }\n        prop.default = defaultValue;\n    }\n\n    properties[propName] = prop;\n}\n\n/**\n * !#en\n * Declare the standard [ES6 Class](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes)\n * as CCClass, please see [Class](../../../manual/en/scripting/class.html) for details.\n * !#zh\n * 将标准写法的 [ES6 Class](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes) 声明为 CCClass，具体用法请参阅[类型定义](../../../manual/zh/scripting/class.html)。\n *\n * @method ccclass\n * @param {String} [name] - The class name used for serialization.\n * @example\n * const {ccclass} = cc._decorator;\n *\n * // define a CCClass, omit the name\n * &#64;ccclass\n * class NewScript extends cc.Component {\n *     // ...\n * }\n *\n * // define a CCClass with a name\n * &#64;ccclass('LoginData')\n * class LoginData {\n *     // ...\n * }\n * @typescript\n * ccclass(name?: string): Function\n * ccclass(_class?: Function): void\n */\nvar ccclass = checkCtorArgument(function (ctor, name) {\n    // if (FIX_BABEL6) {\n    //     eval('if(typeof _classCallCheck===\"function\"){_classCallCheck=function(){};}');\n    // }\n    var base = js.getSuper(ctor);\n    if (base === Object) {\n        base = null;\n    }\n\n    var proto = {\n        name,\n        extends: base,\n        ctor,\n        __ES6__: true,\n    };\n    var cache = ctor[CACHE_KEY];\n    if (cache) {\n        var decoratedProto = cache.proto;\n        if (decoratedProto) {\n            // decoratedProto.properties = createProperties(ctor, decoratedProto.properties);\n            js.mixin(proto, decoratedProto);\n        }\n        ctor[CACHE_KEY] = undefined;\n    }\n\n    var res = cc.Class(proto);\n\n    // validate methods\n    if (CC_DEV) {\n        var propNames = Object.getOwnPropertyNames(ctor.prototype);\n        for (var i = 0; i < propNames.length; ++i) {\n            var prop = propNames[i];\n            if (prop !== 'constructor') {\n                var desc = Object.getOwnPropertyDescriptor(ctor.prototype, prop);\n                var func = desc && desc.value;\n                if (typeof func === 'function') {\n                    Preprocess.doValidateMethodWithProps_DEV(func, prop, js.getClassName(ctor), ctor, base);\n                }\n            }\n        }\n    }\n\n    return res;\n});\n\n/**\n * !#en\n * Declare property for [CCClass](../../../manual/en/scripting/reference/attributes.html).\n * !#zh\n * 定义 [CCClass](../../../manual/zh/scripting/reference/attributes.html) 所用的属性。\n *\n * @method property\n * @param {Object} [options] - an object with some property attributes\n * @param {Any} [options.type]\n * @param {Boolean|Function} [options.visible]\n * @param {String} [options.displayName]\n * @param {String} [options.tooltip]\n * @param {Boolean} [options.multiline]\n * @param {Boolean} [options.readonly]\n * @param {Number} [options.min]\n * @param {Number} [options.max]\n * @param {Number} [options.step]\n * @param {Number[]} [options.range]\n * @param {Boolean} [options.slide]\n * @param {Boolean} [options.serializable]\n * @param {Boolean} [options.editorOnly]\n * @param {Boolean} [options.override]\n * @param {Boolean} [options.animatable]\n * @param {String} [options.formerlySerializedAs]\n * @example\n * const {ccclass, property} = cc._decorator;\n *\n * &#64;ccclass\n * class NewScript extends cc.Component {\n *     &#64;property({\n *         type: cc.Node\n *     })\n *     targetNode1 = null;\n *\n *     &#64;property(cc.Node)\n *     targetNode2 = null;\n *\n *     &#64;property(cc.Button)\n *     targetButton = null;\n *\n *     &#64;property\n *     _width = 100;\n *\n *     &#64;property\n *     get width () {\n *         return this._width;\n *     }\n *\n *     &#64;property\n *     set width (value) {\n *         this._width = value;\n *     }\n *\n *     &#64;property\n *     offset = new cc.Vec2(100, 100);\n *\n *     &#64;property(cc.Vec2)\n *     offsets = [];\n *\n *     &#64;property(cc.SpriteFrame)\n *     frame = null;\n * }\n *\n * // above is equivalent to (上面的代码相当于):\n *\n * var NewScript = cc.Class({\n *     properties: {\n *         targetNode1: {\n *             default: null,\n *             type: cc.Node\n *         },\n *\n *         targetNode2: {\n *             default: null,\n *             type: cc.Node\n *         },\n *\n *         targetButton: {\n *             default: null,\n *             type: cc.Button\n *         },\n *\n *         _width: 100,\n *\n *         width: {\n *             get () {\n *                 return this._width;\n *             },\n *             set (value) {\n *                 this._width = value;\n *             }\n *         },\n *\n *         offset: new cc.Vec2(100, 100)\n *\n *         offsets: {\n *             default: [],\n *             type: cc.Vec2\n *         }\n *\n *         frame: {\n *             default: null,\n *             type: cc.SpriteFrame\n *         },\n *     }\n * });\n * @typescript\n * property(options?: {type?: any; visible?: boolean|(() => boolean); displayName?: string; tooltip?: string; multiline?: boolean; readonly?: boolean; min?: number; max?: number; step?: number; range?: number[]; slide?: boolean; serializable?: boolean; formerlySerializedAs?: string; editorOnly?: boolean; override?: boolean; animatable?: boolean} | any[]|Function|cc.ValueType|number|string|boolean): Function\n * property(_target: Object, _key: any, _desc?: any): void\n */\nfunction property (ctorProtoOrOptions, propName, desc) {\n    var options = null;\n    function normalized (ctorProto, propName, desc) {\n        var cache = getClassCache(ctorProto.constructor);\n        if (cache) {\n            var ccclassProto = getSubDict(cache, 'proto');\n            var properties = getSubDict(ccclassProto, 'properties');\n            genProperty(ctorProto.constructor, properties, propName, options, desc, cache);\n        }\n    }\n    if (typeof propName === 'undefined') {\n        options = ctorProtoOrOptions;\n        return normalized;\n    }\n    else {\n        normalized(ctorProtoOrOptions, propName, desc);\n    }\n}\n\n// Editor Decorators\n\nfunction createEditorDecorator (argCheckFunc, editorPropName, staticValue) {\n    return argCheckFunc(function (ctor, decoratedValue) {\n        var cache = getClassCache(ctor, editorPropName);\n        if (cache) {\n            var value = (staticValue !== undefined) ? staticValue : decoratedValue;\n            var proto = getSubDict(cache, 'proto');\n            getSubDict(proto, 'editor')[editorPropName] = value;\n        }\n    }, editorPropName);\n}\n\nfunction createDummyDecorator (argCheckFunc) {\n    return argCheckFunc(fNOP);\n}\n\n/**\n * !#en\n * Makes a CCClass that inherit from component execute in edit mode.<br>\n * By default, all components are only executed in play mode,\n * which means they will not have their callback functions executed while the Editor is in edit mode.\n * !#zh\n * 允许继承自 Component 的 CCClass 在编辑器里执行。<br>\n * 默认情况下，所有 Component 都只会在运行时才会执行，也就是说它们的生命周期回调不会在编辑器里触发。\n *\n * @method executeInEditMode\n * @example\n * const {ccclass, executeInEditMode} = cc._decorator;\n *\n * &#64;ccclass\n * &#64;executeInEditMode\n * class NewScript extends cc.Component {\n *     // ...\n * }\n * @typescript\n * executeInEditMode(): Function\n * executeInEditMode(_class: Function): void\n */\nvar executeInEditMode = (CC_DEV ? createEditorDecorator : createDummyDecorator)(checkCtorArgument, 'executeInEditMode', true);\n\n/**\n * !#en\n * Automatically add required component as a dependency for the CCClass that inherit from component.\n * !#zh\n * 为声明为 CCClass 的组件添加依赖的其它组件。当组件添加到节点上时，如果依赖的组件不存在，引擎将会自动将依赖组件添加到同一个节点，防止脚本出错。该设置在运行时同样有效。\n *\n * @method requireComponent\n * @param {Component} requiredComponent\n * @example\n * const {ccclass, requireComponent} = cc._decorator;\n *\n * &#64;ccclass\n * &#64;requireComponent(cc.Sprite)\n * class SpriteCtrl extends cc.Component {\n *     // ...\n * }\n * @typescript\n * requireComponent(requiredComponent: typeof cc.Component): Function\n */\nvar requireComponent = createEditorDecorator(checkCompArgument, 'requireComponent');\n\n/**\n * !#en\n * The menu path to register a component to the editors \"Component\" menu. Eg. \"Rendering/CameraCtrl\".\n * !#zh\n * 将当前组件添加到组件菜单中，方便用户查找。例如 \"Rendering/CameraCtrl\"。\n *\n * @method menu\n * @param {String} path - The path is the menu represented like a pathname.\n *                        For example the menu could be \"Rendering/CameraCtrl\".\n * @example\n * const {ccclass, menu} = cc._decorator;\n *\n * &#64;ccclass\n * &#64;menu(\"Rendering/CameraCtrl\")\n * class NewScript extends cc.Component {\n *     // ...\n * }\n * @typescript\n * menu(path: string): Function\n */\nvar menu = (CC_DEV ? createEditorDecorator : createDummyDecorator)(checkStringArgument, 'menu');\n\n/**\n * !#en\n * The execution order of lifecycle methods for Component.\n * Those less than 0 will execute before while those greater than 0 will execute after.\n * The order will only affect onLoad, onEnable, start, update and lateUpdate while onDisable and onDestroy will not be affected.\n * !#zh\n * 设置脚本生命周期方法调用的优先级。优先级小于 0 的组件将会优先执行，优先级大于 0 的组件将会延后执行。优先级仅会影响 onLoad, onEnable, start, update 和 lateUpdate，而 onDisable 和 onDestroy 不受影响。\n *\n * @method executionOrder\n * @param {Number} order - The execution order of lifecycle methods for Component. Those less than 0 will execute before while those greater than 0 will execute after.\n * @example\n * const {ccclass, executionOrder} = cc._decorator;\n *\n * &#64;ccclass\n * &#64;executionOrder(1)\n * class CameraCtrl extends cc.Component {\n *     // ...\n * }\n * @typescript\n * executionOrder(order: number): Function\n */\nvar executionOrder = createEditorDecorator(checkNumberArgument, 'executionOrder');\n\n/**\n * !#en\n * Prevents Component of the same type (or subtype) to be added more than once to a Node.\n * !#zh\n * 防止多个相同类型（或子类型）的组件被添加到同一个节点。\n *\n * @method disallowMultiple\n * @example\n * const {ccclass, disallowMultiple} = cc._decorator;\n *\n * &#64;ccclass\n * &#64;disallowMultiple\n * class CameraCtrl extends cc.Component {\n *     // ...\n * }\n * @typescript\n * disallowMultiple(): Function\n * disallowMultiple(_class: Function): void\n */\nvar disallowMultiple = (CC_DEV ? createEditorDecorator : createDummyDecorator)(checkCtorArgument, 'disallowMultiple');\n\n/**\n * !#en\n * If specified, the editor's scene view will keep updating this node in 60 fps when it is selected, otherwise, it will update only if necessary.<br>\n * This property is only available if executeInEditMode is true.\n * !#zh\n * 当指定了 \"executeInEditMode\" 以后，playOnFocus 可以在选中当前组件所在的节点时，提高编辑器的场景刷新频率到 60 FPS，否则场景就只会在必要的时候进行重绘。\n *\n * @method playOnFocus\n * @example\n * const {ccclass, playOnFocus, executeInEditMode} = cc._decorator;\n *\n * &#64;ccclass\n * &#64;executeInEditMode\n * &#64;playOnFocus\n * class CameraCtrl extends cc.Component {\n *     // ...\n * }\n * @typescript\n * playOnFocus(): Function\n * playOnFocus(_class: Function): void\n */\nvar playOnFocus = (CC_DEV ? createEditorDecorator : createDummyDecorator)(checkCtorArgument, 'playOnFocus', true);\n\n/**\n * !#en\n * Specifying the url of the custom html to draw the component in **Properties**.\n * !#zh\n * 自定义当前组件在 **属性检查器** 中渲染时所用的网页 url。\n *\n * @method inspector\n * @param {String} url\n * @example\n * const {ccclass, inspector} = cc._decorator;\n *\n * &#64;ccclass\n * &#64;inspector(\"packages://inspector/inspectors/comps/camera-ctrl.js\")\n * class NewScript extends cc.Component {\n *     // ...\n * }\n * @typescript\n * inspector(path: string): Function\n */\nvar inspector = (CC_DEV ? createEditorDecorator : createDummyDecorator)(checkStringArgument, 'inspector');\n\n/**\n * !#en\n * Specifying the url of the icon to display in the editor.\n * !#zh\n * 自定义当前组件在编辑器中显示的图标 url。\n *\n * @method icon\n * @param {String} url\n * @private\n * @example\n * const {ccclass, icon} = cc._decorator;\n *\n * &#64;ccclass\n * &#64;icon(\"xxxx.png\")\n * class NewScript extends cc.Component {\n *     // ...\n * }\n * @typescript\n * icon(path: string): Function\n */\nvar icon = (CC_DEV ? createEditorDecorator : createDummyDecorator)(checkStringArgument, 'icon');\n\n/**\n * !#en\n * The custom documentation URL.\n * !#zh\n * 指定当前组件的帮助文档的 url，设置过后，在 **属性检查器** 中就会出现一个帮助图标，用户点击将打开指定的网页。\n *\n * @method help\n * @param {String} url\n * @example\n * const {ccclass, help} = cc._decorator;\n *\n * &#64;ccclass\n * &#64;help(\"app://docs/html/components/spine.html\")\n * class NewScript extends cc.Component {\n *     // ...\n * }\n * @typescript\n * help(path: string): Function\n */\nvar help = (CC_DEV ? createEditorDecorator : createDummyDecorator)(checkStringArgument, 'help');\n\n// Other Decorators\n\n/**\n * NOTE:<br>\n * The old mixins implemented in cc.Class(ES5) behaves exact the same as multiple inheritance.\n * But since ES6, class constructor can't be function-called and class methods become non-enumerable,\n * so we can not mix in ES6 Classes.<br>\n * See:<br>\n * [https://esdiscuss.org/topic/traits-are-now-impossible-in-es6-until-es7-since-rev32](https://esdiscuss.org/topic/traits-are-now-impossible-in-es6-until-es7-since-rev32)<br>\n * One possible solution (but IDE unfriendly):<br>\n * [http://justinfagnani.com/2015/12/21/real-mixins-with-javascript-classes](http://justinfagnani.com/2015/12/21/real-mixins-with-javascript-classes/)<br>\n * <br>\n * NOTE:<br>\n * You must manually call mixins constructor, this is different from cc.Class(ES5).\n *\n * @method mixins\n * @param {Function} ...ctor - constructors to mix, only support ES5 constructors or classes defined by using `cc.Class`,\n *                             not support ES6 Classes.\n * @example\n * const {ccclass, mixins} = cc._decorator;\n *\n * class Animal { ... }\n *\n * const Fly = cc.Class({\n *     constructor () { ... }\n * });\n *\n * &#64;ccclass\n * &#64;mixins(cc.EventTarget, Fly)\n * class Bird extends Animal {\n *     constructor () {\n *         super();\n *\n *         // You must manually call mixins constructor, this is different from cc.Class(ES5)\n *         cc.EventTarget.call(this);\n *         Fly.call(this);\n *     }\n *     // ...\n * }\n * @typescript\n * mixins(ctor: Function, ...rest: Function[]): Function\n */\nfunction mixins () {\n    var mixins = [];\n    for (var i = 0; i < arguments.length; i++) {\n        mixins[i] = arguments[i];\n    }\n    return function (ctor) {\n        var cache = getClassCache(ctor, 'mixins');\n        if (cache) {\n            getSubDict(cache, 'proto').mixins = mixins;\n        }\n    }\n}\n\ncc._decorator = module.exports = {\n    ccclass,\n    property,\n    executeInEditMode,\n    requireComponent,\n    menu,\n    executionOrder,\n    disallowMultiple,\n    playOnFocus,\n    inspector,\n    icon,\n    help,\n    mixins,\n};\n\n// fix submodule pollute ...\n/**\n * @submodule cc\n */\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require('./js');\n\n// enum\n\n/**\n * !#en\n * Define an enum type. <br/>\n * If a enum item has a value of -1, it will be given an Integer number according to it's order in the list.<br/>\n * Otherwise it will use the value specified by user who writes the enum definition.\n *\n * !#zh\n * 定义一个枚举类型。<br/>\n * 用户可以把枚举值设为任意的整数，如果设为 -1，系统将会分配为上一个枚举值 + 1。\n *\n * @method Enum\n * @param {object} obj - a JavaScript literal object containing enum names and values, or a TypeScript enum type\n * @return {object} the defined enum type\n * @example {@link cocos2d/core/platform/CCEnum/Enum.js}\n * @typescript Enum<T>(obj: T): T\n */\nfunction Enum (obj) {\n    if ('__enums__' in obj) {\n        return obj;\n    }\n    js.value(obj, '__enums__', null, true);\n\n    var lastIndex = -1;\n    var keys = Object.keys(obj);\n    for (var i = 0; i < keys.length; i++) {\n        var key = keys[i];\n        var val = obj[key];\n\n        if (val === -1) {\n            val = ++lastIndex;\n            obj[key] = val;\n        }\n        else {\n            if (typeof val === 'number') {\n                lastIndex = val;\n            }\n            else if (typeof val === 'string' && Number.isInteger(parseFloat(key))) {\n                continue;\n            }\n        }\n        var reverseKey = '' + val;\n        if (key !== reverseKey) {\n            if ((CC_EDITOR || CC_TEST) && reverseKey in obj && obj[reverseKey] !== key) {\n                cc.errorID(7100, reverseKey);\n                continue;\n            }\n            js.value(obj, reverseKey, key);\n        }\n    }\n    return obj;\n}\n\nEnum.isEnum = function (enumType) {\n    return enumType && enumType.hasOwnProperty('__enums__');\n};\n\n/**\n * @method getList\n * @param {Object} enumDef - the enum type defined from cc.Enum\n * @return {Object[]}\n * @private\n */\nEnum.getList = function (enumDef) {\n    if (enumDef.__enums__)\n        return enumDef.__enums__;\n\n    var enums = enumDef.__enums__ = [];\n    for (var name in enumDef) {\n        var value = enumDef[name];\n        if (Number.isInteger(value)) {\n            enums.push({ name, value });\n        }\n    }\n    enums.sort( function ( a, b ) { return a.value - b.value; } );\n    return enums;\n};\n\nif (CC_DEV) {\n    // check key order in object literal\n    var _TestEnum = Enum({\n        ZERO: -1,\n        ONE: -1,\n        TWO: -1,\n        THREE: -1\n    });\n    if (_TestEnum.ZERO !== 0 || _TestEnum.ONE !== 1 || _TestEnum.THREE !== 3) {\n        cc.errorID(7101);\n    }\n}\n\nmodule.exports = cc.Enum = Enum;\n","/****************************************************************************\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst eventManager = require('../event-manager');\nconst inputManager = require(\"./CCInputManager\");\n\nconst PORTRAIT = 0;\nconst LANDSCAPE_LEFT = -90;\nconst PORTRAIT_UPSIDE_DOWN = 180;\nconst LANDSCAPE_RIGHT = 90;\n\nlet _didAccelerateFun;\n\n/**\n * !#en the device accelerometer reports values for each axis in units of g-force.\n * !#zh 设备重力传感器传递的各个轴的数据。\n * @class Acceleration\n * @method constructor\n * @param {Number} x\n * @param {Number} y\n * @param {Number} z\n * @param {Number} timestamp\n */\ncc.Acceleration = function (x, y, z, timestamp) {\n    this.x = x || 0;\n    this.y = y || 0;\n    this.z = z || 0;\n    this.timestamp = timestamp || 0;\n};\n\n/**\n * whether enable accelerometer event\n * @method setAccelerometerEnabled\n * @param {Boolean} isEnable\n */\ninputManager.setAccelerometerEnabled = function (isEnable) {\n    let _t = this;\n    if(_t._accelEnabled === isEnable)\n        return;\n\n    _t._accelEnabled = isEnable;\n    let scheduler = cc.director.getScheduler();\n    scheduler.enableForTarget(_t);\n    if (_t._accelEnabled) {\n        _t._registerAccelerometerEvent();\n        _t._accelCurTime = 0;\n        scheduler.scheduleUpdate(_t);\n    } else {\n        _t._unregisterAccelerometerEvent();\n        _t._accelCurTime = 0;\n        scheduler.unscheduleUpdate(_t);\n    }\n\n    if (CC_JSB || CC_RUNTIME) {\n        jsb.device.setMotionEnabled(isEnable);\n    }\n};\n\n/**\n * set accelerometer interval value\n * @method setAccelerometerInterval\n * @param {Number} interval\n */\ninputManager.setAccelerometerInterval = function (interval) {\n    if (this._accelInterval !== interval) {\n        this._accelInterval = interval;\n\n        if (CC_JSB || CC_RUNTIME) {\n            jsb.device.setMotionInterval(interval);\n        }\n    }\n};\n\ninputManager._registerKeyboardEvent = function () {\n    cc.game.canvas.addEventListener(\"keydown\", function (e) {\n        eventManager.dispatchEvent(new cc.Event.EventKeyboard(e.keyCode, true));\n        e.stopPropagation();\n        e.preventDefault();\n    }, false);\n    cc.game.canvas.addEventListener(\"keyup\", function (e) {\n        eventManager.dispatchEvent(new cc.Event.EventKeyboard(e.keyCode, false));\n        e.stopPropagation();\n        e.preventDefault();\n    }, false);\n};\n\ninputManager._registerAccelerometerEvent = function () {\n    let w = window, _t = this;\n    _t._acceleration = new cc.Acceleration();\n    _t._accelDeviceEvent = w.DeviceMotionEvent || w.DeviceOrientationEvent;\n\n    //TODO fix DeviceMotionEvent bug on QQ Browser version 4.1 and below.\n    if (cc.sys.browserType === cc.sys.BROWSER_TYPE_MOBILE_QQ)\n        _t._accelDeviceEvent = window.DeviceOrientationEvent;\n\n    let _deviceEventType = (_t._accelDeviceEvent === w.DeviceMotionEvent) ? \"devicemotion\" : \"deviceorientation\";\n    let ua = navigator.userAgent;\n    if (/Android/.test(ua) || (/Adr/.test(ua) && cc.sys.browserType === cc.BROWSER_TYPE_UC)) {\n        _t._minus = -1;\n    }\n\n    _didAccelerateFun = _t.didAccelerate.bind(_t);\n    w.addEventListener(_deviceEventType, _didAccelerateFun, false);\n};\n\ninputManager._unregisterAccelerometerEvent = function () {\n    let w = window, _t = this;\n    let _deviceEventType = (_t._accelDeviceEvent === w.DeviceMotionEvent) ? \"devicemotion\" : \"deviceorientation\";\n    if (_didAccelerateFun) {\n        w.removeEventListener(_deviceEventType, _didAccelerateFun, false);\n    }\n};\n\ninputManager.didAccelerate = function (eventData) {\n    let _t = this, w = window;\n    if (!_t._accelEnabled)\n        return;\n\n    let mAcceleration = _t._acceleration;\n\n    let x, y, z;\n\n    if (_t._accelDeviceEvent === window.DeviceMotionEvent) {\n        let eventAcceleration = eventData[\"accelerationIncludingGravity\"];\n        x = _t._accelMinus * eventAcceleration.x * 0.1;\n        y = _t._accelMinus * eventAcceleration.y * 0.1;\n        z = eventAcceleration.z * 0.1;\n    } else {\n        x = (eventData[\"gamma\"] / 90) * 0.981;\n        y = -(eventData[\"beta\"] / 90) * 0.981;\n        z = (eventData[\"alpha\"] / 90) * 0.981;\n    }\n\n    if (cc.view._isRotated) {\n        let tmp = x;\n        x = -y;\n        y = tmp;\n    }\n    mAcceleration.x = x;\n    mAcceleration.y = y;\n    mAcceleration.z = z;\n\n    mAcceleration.timestamp = eventData.timeStamp || Date.now();\n\n    let tmpX = mAcceleration.x;\n    if (w.orientation === LANDSCAPE_RIGHT) {\n        mAcceleration.x = -mAcceleration.y;\n        mAcceleration.y = tmpX;\n    } else if (w.orientation === LANDSCAPE_LEFT) {\n        mAcceleration.x = mAcceleration.y;\n        mAcceleration.y = -tmpX;\n    } else if (w.orientation === PORTRAIT_UPSIDE_DOWN) {\n        mAcceleration.x = -mAcceleration.x;\n        mAcceleration.y = -mAcceleration.y;\n    }\n    // fix android acc values are opposite\n    if (cc.sys.os === cc.sys.OS_ANDROID &&\n        cc.sys.browserType !== cc.sys.BROWSER_TYPE_MOBILE_QQ) {\n        mAcceleration.x = -mAcceleration.x;\n        mAcceleration.y = -mAcceleration.y;\n    }\n};","/****************************************************************************\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst macro = require('./CCMacro');\nconst sys = require('./CCSys');\nconst eventManager = require('../event-manager');\n\nconst TOUCH_TIMEOUT = macro.TOUCH_TIMEOUT;\n\nlet _vec2 = cc.v2();\n\n/**\n *  This class manages all events of input. include: touch, mouse, accelerometer, keyboard\n */\nlet inputManager = {\n    _mousePressed: false,\n\n    _isRegisterEvent: false,\n\n    _preTouchPoint: cc.v2(0,0),\n    _prevMousePoint: cc.v2(0,0),\n\n    _preTouchPool: [],\n    _preTouchPoolPointer: 0,\n\n    _touches: [],\n    _touchesIntegerDict:{},\n\n    _indexBitsUsed: 0,\n    _maxTouches: 8,\n\n    _accelEnabled: false,\n    _accelInterval: 1/5,\n    _accelMinus: 1,\n    _accelCurTime: 0,\n    _acceleration: null,\n    _accelDeviceEvent: null,\n\n    _canvasBoundingRect: {\n        left: 0,\n        top: 0,\n        adjustedLeft: 0,\n        adjustedTop: 0,\n        width: 0,\n        height: 0,\n    },\n\n    _getUnUsedIndex () {\n        let temp = this._indexBitsUsed;\n        let now = cc.sys.now();\n\n        for (let i = 0; i < this._maxTouches; i++) {\n            if (!(temp & 0x00000001)) {\n                this._indexBitsUsed |= (1 << i);\n                return i;\n            }\n            else {\n                let touch = this._touches[i];\n                if (now - touch._lastModified > TOUCH_TIMEOUT) {\n                    this._removeUsedIndexBit(i);\n                    delete this._touchesIntegerDict[touch.getID()];\n                    return i;\n                }\n            }\n            temp >>= 1;\n        }\n\n        // all bits are used\n        return -1;\n    },\n\n    _removeUsedIndexBit (index) {\n        if (index < 0 || index >= this._maxTouches)\n            return;\n\n        let temp = 1 << index;\n        temp = ~temp;\n        this._indexBitsUsed &= temp;\n    },\n\n    _glView: null,\n\n    _updateCanvasBoundingRect () {\n        let element = cc.game.canvas;\n        let canvasBoundingRect = this._canvasBoundingRect;\n\n        let docElem = document.documentElement;\n        let leftOffset = window.pageXOffset - docElem.clientLeft;\n        let topOffset = window.pageYOffset - docElem.clientTop;\n        if (element.getBoundingClientRect) {\n            let box = element.getBoundingClientRect();\n            canvasBoundingRect.left = box.left + leftOffset;\n            canvasBoundingRect.top = box.top + topOffset;\n            canvasBoundingRect.width = box.width;\n            canvasBoundingRect.height = box.height;\n        }\n        else if (element instanceof HTMLCanvasElement) {\n            canvasBoundingRect.left = leftOffset;\n            canvasBoundingRect.top = topOffset;\n            canvasBoundingRect.width = element.width;\n            canvasBoundingRect.height = element.height;\n        }\n        else {\n            canvasBoundingRect.left = leftOffset;\n            canvasBoundingRect.top = topOffset;\n            canvasBoundingRect.width = parseInt(element.style.width);\n            canvasBoundingRect.height = parseInt(element.style.height);\n        }\n    },\n\n    /**\n     * @method handleTouchesBegin\n     * @param {Array} touches\n     */\n    handleTouchesBegin (touches) {\n        let selTouch, index, curTouch, touchID,\n            handleTouches = [], locTouchIntDict = this._touchesIntegerDict,\n            now = sys.now();\n        for (let i = 0, len = touches.length; i < len; i ++) {\n            selTouch = touches[i];\n            touchID = selTouch.getID();\n            index = locTouchIntDict[touchID];\n\n            if (index == null) {\n                let unusedIndex = this._getUnUsedIndex();\n                if (unusedIndex === -1) {\n                    cc.logID(2300, unusedIndex);\n                    continue;\n                }\n                //curTouch = this._touches[unusedIndex] = selTouch;\n                curTouch = this._touches[unusedIndex] = new cc.Touch(selTouch._point.x, selTouch._point.y, selTouch.getID());\n                curTouch._lastModified = now;\n                curTouch._setPrevPoint(selTouch._prevPoint);\n                locTouchIntDict[touchID] = unusedIndex;\n                handleTouches.push(curTouch);\n            }\n        }\n        if (handleTouches.length > 0) {\n            this._glView._convertTouchesWithScale(handleTouches);\n            let touchEvent = new cc.Event.EventTouch(handleTouches);\n            touchEvent._eventCode = cc.Event.EventTouch.BEGAN;\n            eventManager.dispatchEvent(touchEvent);\n        }\n    },\n\n    /**\n     * @method handleTouchesMove\n     * @param {Array} touches\n     */\n    handleTouchesMove (touches) {\n        let selTouch, index, touchID,\n            handleTouches = [], locTouches = this._touches,\n            now = sys.now();\n        for (let i = 0, len = touches.length; i < len; i++) {\n            selTouch = touches[i];\n            touchID = selTouch.getID();\n            index = this._touchesIntegerDict[touchID];\n\n            if (index == null) {\n                //cc.log(\"if the index doesn't exist, it is an error\");\n                continue;\n            }\n            if (locTouches[index]) {\n                locTouches[index]._setPoint(selTouch._point);\n                locTouches[index]._setPrevPoint(selTouch._prevPoint);\n                locTouches[index]._lastModified = now;\n                handleTouches.push(locTouches[index]);\n            }\n        }\n        if (handleTouches.length > 0) {\n            this._glView._convertTouchesWithScale(handleTouches);\n            let touchEvent = new cc.Event.EventTouch(handleTouches);\n            touchEvent._eventCode = cc.Event.EventTouch.MOVED;\n            eventManager.dispatchEvent(touchEvent);\n        }\n    },\n\n    /**\n     * @method handleTouchesEnd\n     * @param {Array} touches\n     */\n    handleTouchesEnd (touches) {\n        let handleTouches = this.getSetOfTouchesEndOrCancel(touches);\n        if (handleTouches.length > 0) {\n            this._glView._convertTouchesWithScale(handleTouches);\n            let touchEvent = new cc.Event.EventTouch(handleTouches);\n            touchEvent._eventCode = cc.Event.EventTouch.ENDED;\n            eventManager.dispatchEvent(touchEvent);\n        }\n        this._preTouchPool.length = 0;\n    },\n\n    /**\n     * @method handleTouchesCancel\n     * @param {Array} touches\n     */\n    handleTouchesCancel (touches) {\n        let handleTouches = this.getSetOfTouchesEndOrCancel(touches);\n        if (handleTouches.length > 0) {\n            this._glView._convertTouchesWithScale(handleTouches);\n            let touchEvent = new cc.Event.EventTouch(handleTouches);\n            touchEvent._eventCode = cc.Event.EventTouch.CANCELLED;\n            eventManager.dispatchEvent(touchEvent);\n        }\n        this._preTouchPool.length = 0;\n    },\n\n    /**\n     * @method getSetOfTouchesEndOrCancel\n     * @param {Array} touches\n     * @returns {Array}\n     */\n    getSetOfTouchesEndOrCancel (touches) {\n        let selTouch, index, touchID, handleTouches = [], locTouches = this._touches, locTouchesIntDict = this._touchesIntegerDict;\n        for (let i = 0, len = touches.length; i< len; i ++) {\n            selTouch = touches[i];\n            touchID = selTouch.getID();\n            index = locTouchesIntDict[touchID];\n\n            if (index == null) {\n                continue;  //cc.log(\"if the index doesn't exist, it is an error\");\n            }\n            if (locTouches[index]) {\n                locTouches[index]._setPoint(selTouch._point);\n                locTouches[index]._setPrevPoint(selTouch._prevPoint);\n                handleTouches.push(locTouches[index]);\n                this._removeUsedIndexBit(index);\n                delete locTouchesIntDict[touchID];\n            }\n        }\n        return handleTouches;\n    },\n\n    /**\n     * @method getPreTouch\n     * @param {Touch} touch\n     * @return {Touch}\n     */\n    getPreTouch (touch) {\n        let preTouch = null;\n        let locPreTouchPool = this._preTouchPool;\n        let id = touch.getID();\n        for (let i = locPreTouchPool.length - 1; i >= 0; i--) {\n            if (locPreTouchPool[i].getID() === id) {\n                preTouch = locPreTouchPool[i];\n                break;\n            }\n        }\n        if (!preTouch)\n            preTouch = touch;\n        return preTouch;\n    },\n\n    /**\n     * @method setPreTouch\n     * @param {Touch} touch\n     */\n    setPreTouch (touch) {\n        let find = false;\n        let locPreTouchPool = this._preTouchPool;\n        let id = touch.getID();\n        for (let i = locPreTouchPool.length - 1; i >= 0; i--) {\n            if (locPreTouchPool[i].getID() === id) {\n                locPreTouchPool[i] = touch;\n                find = true;\n                break;\n            }\n        }\n        if (!find) {\n            if (locPreTouchPool.length <= 50) {\n                locPreTouchPool.push(touch);\n            } else {\n                locPreTouchPool[this._preTouchPoolPointer] = touch;\n                this._preTouchPoolPointer = (this._preTouchPoolPointer + 1) % 50;\n            }\n        }\n    },\n\n    /**\n     * @method getTouchByXY\n     * @param {Number} tx\n     * @param {Number} ty\n     * @param {Vec2} pos\n     * @return {Touch}\n     */\n    getTouchByXY (tx, ty, pos) {\n        let locPreTouch = this._preTouchPoint;\n        let location = this._glView.convertToLocationInView(tx, ty, pos);\n        let touch = new cc.Touch(location.x, location.y, 0);\n        touch._setPrevPoint(locPreTouch.x, locPreTouch.y);\n        locPreTouch.x = location.x;\n        locPreTouch.y = location.y;\n        return touch;\n    },\n\n    /**\n     * @method getMouseEvent\n     * @param {Vec2} location\n     * @param {Vec2} pos\n     * @param {Number} eventType\n     * @returns {Event.EventMouse}\n     */\n    getMouseEvent (location, pos, eventType) {\n        let locPreMouse = this._prevMousePoint;\n        let mouseEvent = new cc.Event.EventMouse(eventType);\n        mouseEvent._setPrevCursor(locPreMouse.x, locPreMouse.y);\n        locPreMouse.x = location.x;\n        locPreMouse.y = location.y;\n        this._glView._convertMouseToLocationInView(locPreMouse, pos);\n        mouseEvent.setLocation(locPreMouse.x, locPreMouse.y);\n        return mouseEvent;\n    },\n\n    /**\n     * @method getPointByEvent\n     * @param {Touch} event\n     * @param {Vec2} pos\n     * @return {Vec2}\n     */\n    getPointByEvent (event, pos) {\n        // qq , uc and safari browser can't calculate pageY correctly, need to refresh canvas bounding rect\n        if (cc.sys.browserType === cc.sys.BROWSER_TYPE_QQ \n            || cc.sys.browserType === cc.sys.BROWSER_TYPE_UC\n            || cc.sys.browserType === cc.sys.BROWSER_TYPE_SAFARI) {\n            this._updateCanvasBoundingRect();\n        }\n        \n        if (event.pageX != null)  //not avalable in <= IE8\n            return {x: event.pageX, y: event.pageY};\n\n        pos.left -= document.body.scrollLeft;\n        pos.top -= document.body.scrollTop;\n\n        return {x: event.clientX, y: event.clientY};\n    },\n\n    /**\n     * @method getTouchesByEvent\n     * @param {Touch} event\n     * @param {Vec2} pos\n     * @returns {Array}\n     */\n    getTouchesByEvent (event, pos) {\n        let touchArr = [], locView = this._glView;\n        let touch_event, touch, preLocation;\n        let locPreTouch = this._preTouchPoint;\n\n        let length = event.changedTouches.length;\n        for (let i = 0; i < length; i++) {\n            touch_event = event.changedTouches[i];\n            if (touch_event) {\n                let location;\n                if (sys.BROWSER_TYPE_FIREFOX === sys.browserType)\n                    location = locView.convertToLocationInView(touch_event.pageX, touch_event.pageY, pos, _vec2);\n                else\n                    location = locView.convertToLocationInView(touch_event.clientX, touch_event.clientY, pos, _vec2);\n                if (touch_event.identifier != null) {\n                    touch = new cc.Touch(location.x, location.y, touch_event.identifier);\n                    //use Touch Pool\n                    preLocation = this.getPreTouch(touch).getLocation();\n                    touch._setPrevPoint(preLocation.x, preLocation.y);\n                    this.setPreTouch(touch);\n                } else {\n                    touch = new cc.Touch(location.x, location.y);\n                    touch._setPrevPoint(locPreTouch.x, locPreTouch.y);\n                }\n                locPreTouch.x = location.x;\n                locPreTouch.y = location.y;\n                touchArr.push(touch);\n            }\n        }\n        return touchArr;\n    },\n\n    /**\n     * @method registerSystemEvent\n     * @param {HTMLElement} element\n     */\n    registerSystemEvent (element) {\n        if(this._isRegisterEvent) return;\n\n        this._glView = cc.view;\n        let selfPointer = this;\n        let canvasBoundingRect = this._canvasBoundingRect;\n\n        window.addEventListener('resize', this._updateCanvasBoundingRect.bind(this));\n\n        let prohibition = sys.isMobile;\n        let supportMouse = ('mouse' in sys.capabilities);\n        let supportTouches = ('touches' in sys.capabilities);\n\n        if (supportMouse) {\n            //HACK\n            //  - At the same time to trigger the ontouch event and onmouse event\n            //  - The function will execute 2 times\n            //The known browser:\n            //  liebiao\n            //  miui\n            //  WECHAT\n            if (!prohibition) {\n                window.addEventListener('mousedown', function () {\n                    selfPointer._mousePressed = true;\n                }, false);\n\n                window.addEventListener('mouseup', function (event) {\n                    if (!selfPointer._mousePressed)\n                        return;\n                    \n                    selfPointer._mousePressed = false;\n\n                    let location = selfPointer.getPointByEvent(event, canvasBoundingRect);\n                    if (!cc.rect(canvasBoundingRect.left, canvasBoundingRect.top, canvasBoundingRect.width, canvasBoundingRect.height).contains(location)){\n                        selfPointer.handleTouchesEnd([selfPointer.getTouchByXY(location.x, location.y, canvasBoundingRect)]);\n\n                        let mouseEvent = selfPointer.getMouseEvent(location, canvasBoundingRect, cc.Event.EventMouse.UP);\n                        mouseEvent.setButton(event.button);\n                        eventManager.dispatchEvent(mouseEvent);\n                    }\n                }, false);\n            }\n\n            // register canvas mouse event\n            let EventMouse = cc.Event.EventMouse;\n            let _mouseEventsOnElement = [\n                !prohibition && [\"mousedown\", EventMouse.DOWN, function (event, mouseEvent, location, canvasBoundingRect) {\n                    selfPointer._mousePressed = true;\n                    selfPointer.handleTouchesBegin([selfPointer.getTouchByXY(location.x, location.y, canvasBoundingRect)]);\n                    element.focus();\n                }],\n                !prohibition && [\"mouseup\", EventMouse.UP, function (event, mouseEvent, location, canvasBoundingRect) {\n                    selfPointer._mousePressed = false;\n                    selfPointer.handleTouchesEnd([selfPointer.getTouchByXY(location.x, location.y, canvasBoundingRect)]);\n                }],\n                !prohibition && [\"mousemove\", EventMouse.MOVE, function (event, mouseEvent, location, canvasBoundingRect) {\n                    selfPointer.handleTouchesMove([selfPointer.getTouchByXY(location.x, location.y, canvasBoundingRect)]);\n                    if (!selfPointer._mousePressed) {\n                        mouseEvent.setButton(null);\n                    }\n                }],\n                [\"mousewheel\", EventMouse.SCROLL, function (event, mouseEvent) {\n                    mouseEvent.setScrollData(0, event.wheelDelta);\n                }],\n                /* firefox fix */\n                [\"DOMMouseScroll\", EventMouse.SCROLL, function (event, mouseEvent) {\n                    mouseEvent.setScrollData(0, event.detail * -120);\n                }]\n            ];\n            for (let i = 0; i < _mouseEventsOnElement.length; ++i) {\n                let entry = _mouseEventsOnElement[i];\n                if (entry) {\n                    let name = entry[0];\n                    let type = entry[1];\n                    let handler = entry[2];\n                    element.addEventListener(name, function (event) {\n                        let location = selfPointer.getPointByEvent(event, canvasBoundingRect);\n                        let mouseEvent = selfPointer.getMouseEvent(location, canvasBoundingRect, type);\n                        mouseEvent.setButton(event.button);\n\n                        handler(event, mouseEvent, location, canvasBoundingRect);\n\n                        eventManager.dispatchEvent(mouseEvent);\n                        event.stopPropagation();\n                        event.preventDefault();\n                    }, false);\n                }\n            }\n        }\n\n        if (window.navigator.msPointerEnabled) {\n            let _pointerEventsMap = {\n                \"MSPointerDown\"     : selfPointer.handleTouchesBegin,\n                \"MSPointerMove\"     : selfPointer.handleTouchesMove,\n                \"MSPointerUp\"       : selfPointer.handleTouchesEnd,\n                \"MSPointerCancel\"   : selfPointer.handleTouchesCancel\n            };\n            for (let eventName in _pointerEventsMap) {\n                let touchEvent = _pointerEventsMap[eventName];\n                element.addEventListener(eventName, function (event){\n                    let documentElement = document.documentElement;\n                    canvasBoundingRect.adjustedLeft = canvasBoundingRect.left - documentElement.scrollLeft;\n                    canvasBoundingRect.adjustedTop = canvasBoundingRect.top - documentElement.scrollTop;\n\n                    touchEvent.call(selfPointer, [selfPointer.getTouchByXY(event.clientX, event.clientY, canvasBoundingRect)]);\n                    event.stopPropagation();\n                }, false);\n            }\n        }\n\n        //register touch event\n        if (supportTouches) {\n            let _touchEventsMap = {\n                \"touchstart\": function (touchesToHandle) {\n                    selfPointer.handleTouchesBegin(touchesToHandle);\n                    element.focus();\n                },\n                \"touchmove\": function (touchesToHandle) {\n                    selfPointer.handleTouchesMove(touchesToHandle);\n                },\n                \"touchend\": function (touchesToHandle) {\n                    selfPointer.handleTouchesEnd(touchesToHandle);\n                },\n                \"touchcancel\": function (touchesToHandle) {\n                    selfPointer.handleTouchesCancel(touchesToHandle);\n                }\n            };\n\n            let registerTouchEvent = function (eventName) {\n                let handler = _touchEventsMap[eventName];\n                element.addEventListener(eventName, (function(event) {\n                    if (!event.changedTouches) return;\n                    let body = document.body;\n\n                    canvasBoundingRect.adjustedLeft = canvasBoundingRect.left - (body.scrollLeft || 0);\n                    canvasBoundingRect.adjustedTop = canvasBoundingRect.top - (body.scrollTop || 0);\n                    handler(selfPointer.getTouchesByEvent(event, canvasBoundingRect));\n                    event.stopPropagation();\n                    event.preventDefault();\n                }), false);\n            };\n            for (let eventName in _touchEventsMap) {\n                registerTouchEvent(eventName);\n            }\n        }\n\n        this._registerKeyboardEvent();\n\n        this._isRegisterEvent = true;\n    },\n\n    _registerKeyboardEvent () {},\n\n    _registerAccelerometerEvent () {},\n\n    /**\n     * @method update\n     * @param {Number} dt\n     */\n    update (dt) {\n        if (this._accelCurTime > this._accelInterval) {\n            this._accelCurTime -= this._accelInterval;\n            eventManager.dispatchEvent(new cc.Event.EventAcceleration(this._acceleration));\n        }\n        this._accelCurTime += dt;\n    }\n};\n\nmodule.exports = cc.internal.inputManager = inputManager;\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * Predefined constants\n * @class macro\n * @static\n */\ncc.macro = {\n    /**\n     * PI / 180\n     * @property RAD\n     * @type {Number}\n     */\n    RAD: Math.PI / 180,\n\n    /**\n     * One degree\n     * @property DEG\n     * @type {Number}\n     */\n    DEG: 180 / Math.PI,\n\n    /**\n     * @property REPEAT_FOREVER\n     * @type {Number}\n     */\n    REPEAT_FOREVER: (Number.MAX_VALUE - 1),\n\n    /**\n     * @property FLT_EPSILON\n     * @type {Number}\n     */\n    FLT_EPSILON: 0.0000001192092896,\n\n    /**\n     * Minimum z index value for node\n     * @property MIN_ZINDEX\n     * @type {Number}\n     */\n    MIN_ZINDEX: -Math.pow(2, 15),\n\n    /**\n     * Maximum z index value for node\n     * @property MAX_ZINDEX\n     * @type {Number}\n     */\n    MAX_ZINDEX: Math.pow(2, 15) - 1,\n\n    //some gl constant variable\n    /**\n     * @property ONE\n     * @type {Number}\n     */\n    ONE: 1,\n\n    /**\n     * @property ZERO\n     * @type {Number}\n     */\n    ZERO: 0,\n\n    /**\n     * @property SRC_ALPHA\n     * @type {Number}\n     */\n    SRC_ALPHA: 0x0302,\n\n    /**\n     * @property SRC_ALPHA_SATURATE\n     * @type {Number}\n     */\n    SRC_ALPHA_SATURATE: 0x308,\n\n    /**\n     * @property SRC_COLOR\n     * @type {Number}\n     */\n    SRC_COLOR: 0x300,\n\n    /**\n     * @property DST_ALPHA\n     * @type {Number}\n     */\n    DST_ALPHA: 0x304,\n\n    /**\n     * @property DST_COLOR\n     * @type {Number}\n     */\n    DST_COLOR: 0x306,\n\n    /**\n     * @property ONE_MINUS_SRC_ALPHA\n     * @type {Number}\n     */\n    ONE_MINUS_SRC_ALPHA: 0x0303,\n\n    /**\n     * @property ONE_MINUS_SRC_COLOR\n     * @type {Number}\n     */\n    ONE_MINUS_SRC_COLOR: 0x301,\n\n    /**\n     * @property ONE_MINUS_DST_ALPHA\n     * @type {Number}\n     */\n    ONE_MINUS_DST_ALPHA: 0x305,\n\n    /**\n     * @property ONE_MINUS_DST_COLOR\n     * @type {Number}\n     */\n    ONE_MINUS_DST_COLOR: 0x0307,\n\n    /**\n     * @property ONE_MINUS_CONSTANT_ALPHA\n     * @type {Number}\n     */\n    ONE_MINUS_CONSTANT_ALPHA: 0x8004,\n\n    /**\n     * @property ONE_MINUS_CONSTANT_COLOR\n     * @type {Number}\n     */\n    ONE_MINUS_CONSTANT_COLOR: 0x8002,\n\n    //Possible device orientations\n    /**\n     * Oriented vertically\n     * @property ORIENTATION_PORTRAIT\n     * @type {Number}\n     */\n    ORIENTATION_PORTRAIT: 1,\n\n    /**\n     * Oriented horizontally\n     * @property ORIENTATION_LANDSCAPE\n     * @type {Number}\n     */\n    ORIENTATION_LANDSCAPE: 2,\n\n    /**\n     * Oriented automatically\n     * @property ORIENTATION_AUTO\n     * @type {Number}\n     */\n    ORIENTATION_AUTO: 3,\n\n    DENSITYDPI_DEVICE: 'device-dpi',\n    DENSITYDPI_HIGH: 'high-dpi',\n    DENSITYDPI_MEDIUM: 'medium-dpi',\n    DENSITYDPI_LOW: 'low-dpi',\n\n    // General configurations\n\n    /**\n     * <p>\n     *   If enabled, the texture coordinates will be calculated by using this formula: <br/>\n     *      - texCoord.left = (rect.x*2+1) / (texture.wide*2);                  <br/>\n     *      - texCoord.right = texCoord.left + (rect.width*2-2)/(texture.wide*2); <br/>\n     *                                                                                 <br/>\n     *  The same for bottom and top.                                                   <br/>\n     *                                                                                 <br/>\n     *  This formula prevents artifacts by using 99% of the texture.                   <br/>\n     *  The \"correct\" way to prevent artifacts is by expand the texture's border with the same color by 1 pixel<br/>\n     *                                                                                  <br/>\n     *  Affected component:                                                                 <br/>\n     *      - cc.TMXLayer                                                       <br/>\n     *                                                                                  <br/>\n     *  Enabled by default. To disabled set it to 0. <br/>\n     *  To modify it, in Web engine please refer to CCMacro.js, in JSB please refer to CCConfig.h\n     * </p>\n     *\n     * @property {Number} FIX_ARTIFACTS_BY_STRECHING_TEXEL_TMX\n     */\n    FIX_ARTIFACTS_BY_STRECHING_TEXEL_TMX: true,\n\n    /**\n     * Position of the FPS (Default: 0,0 (bottom-left corner))<br/>\n     * To modify it, in Web engine please refer to CCMacro.js, in JSB please refer to CCConfig.h\n     * @property {Vec2} DIRECTOR_STATS_POSITION\n     */\n    DIRECTOR_STATS_POSITION: cc.v2(0, 0),\n\n    /**\n     * <p>\n     *    If enabled, actions that alter the position property (eg: CCMoveBy, CCJumpBy, CCBezierBy, etc..) will be stacked.                  <br/>\n     *    If you run 2 or more 'position' actions at the same time on a node, then end position will be the sum of all the positions.        <br/>\n     *    If disabled, only the last run action will take effect.\n     * </p>\n     * @property {Number} ENABLE_STACKABLE_ACTIONS\n     */\n    ENABLE_STACKABLE_ACTIONS: true,\n\n    /**\n     * !#en \n     * The timeout to determine whether a touch is no longer active and should be removed.\n     * The reason to add this timeout is due to an issue in X5 browser core, \n     * when X5 is presented in wechat on Android, if a touch is glissed from the bottom up, and leave the page area,\n     * no touch cancel event is triggered, and the touch will be considered active forever. \n     * After multiple times of this action, our maximum touches number will be reached and all new touches will be ignored.\n     * So this new mechanism can remove the touch that should be inactive if it's not updated during the last 5000 milliseconds.\n     * Though it might remove a real touch if it's just not moving for the last 5 seconds which is not easy with the sensibility of mobile touch screen.\n     * You can modify this value to have a better behavior if you find it's not enough.\n     * !#zh\n     * 用于甄别一个触点对象是否已经失效并且可以被移除的延时时长\n     * 添加这个时长的原因是 X5 内核在微信浏览器中出现的一个 bug。\n     * 在这个环境下，如果用户将一个触点从底向上移出页面区域，将不会触发任何 touch cancel 或 touch end 事件，而这个触点会被永远当作停留在页面上的有效触点。\n     * 重复这样操作几次之后，屏幕上的触点数量将达到我们的事件系统所支持的最高触点数量，之后所有的触摸事件都将被忽略。\n     * 所以这个新的机制可以在触点在一定时间内没有任何更新的情况下视为失效触点并从事件系统中移除。\n     * 当然，这也可能移除一个真实的触点，如果用户的触点真的在一定时间段内完全没有移动（这在当前手机屏幕的灵敏度下会很难）。\n     * 你可以修改这个值来获得你需要的效果，默认值是 5000 毫秒。\n     * @property {Number} TOUCH_TIMEOUT\n     */\n    TOUCH_TIMEOUT: 5000,\n\n    /**\n     * !#en \n     * The maximum vertex count for a single batched draw call.\n     * !#zh\n     * 最大可以被单次批处理渲染的顶点数量。\n     * @property {Number} BATCH_VERTEX_COUNT\n     */\n    BATCH_VERTEX_COUNT: 20000,\n\n    /**\n     * !#en \n     * Whether or not enabled tiled map auto culling. If you set the TiledMap skew or rotation, then need to manually disable this, otherwise, the rendering will be wrong.\n     * !#zh\n     * 是否开启瓦片地图的自动裁减功能。瓦片地图如果设置了 skew, rotation 的话，需要手动关闭，否则渲染会出错。\n     * @property {Boolean} ENABLE_TILEDMAP_CULLING\n     * @default true\n     */\n    ENABLE_TILEDMAP_CULLING: true,\n\n    /**\n     * !#en \n     * The max concurrent task number for the downloader\n     * !#zh\n     * 下载任务的最大并发数限制，在安卓平台部分机型或版本上可能需要限制在较低的水平\n     * @property {Number} DOWNLOAD_MAX_CONCURRENT\n     * @default 64\n     */\n    DOWNLOAD_MAX_CONCURRENT: 64,\n\n    /**\n     * !#en \n     * Boolean that indicates if the canvas contains an alpha channel, default sets to false for better performance.\n     * Though if you want to make your canvas background transparent and show other dom elements at the background, \n     * you can set it to true before `cc.game.run`.\n     * Web only.\n     * !#zh\n     * 用于设置 Canvas 背景是否支持 alpha 通道，默认为 false，这样可以有更高的性能表现。\n     * 如果你希望 Canvas 背景是透明的，并显示背后的其他 DOM 元素，你可以在 `cc.game.run` 之前将这个值设为 true。\n     * 仅支持 Web\n     * @property {Boolean} ENABLE_TRANSPARENT_CANVAS\n     * @default false\n     */\n    ENABLE_TRANSPARENT_CANVAS: false,\n\n    /**\n     * !#en\n     * Boolean that indicates if the WebGL context is created with `antialias` option turned on, default value is false.\n     * Set it to true could make your game graphics slightly smoother, like texture hard edges when rotated.\n     * Whether to use this really depend on your game design and targeted platform, \n     * device with retina display usually have good detail on graphics with or without this option, \n     * you probably don't want antialias if your game style is pixel art based.\n     * Also, it could have great performance impact with some browser / device using software MSAA.\n     * You can set it to true before `cc.game.run`.\n     * Web only.\n     * !#zh\n     * 用于设置在创建 WebGL Context 时是否开启抗锯齿选项，默认值是 false。\n     * 将这个选项设置为 true 会让你的游戏画面稍稍平滑一些，比如旋转硬边贴图时的锯齿。是否开启这个选项很大程度上取决于你的游戏和面向的平台。\n     * 在大多数拥有 retina 级别屏幕的设备上用户往往无法区分这个选项带来的变化；如果你的游戏选择像素艺术风格，你也多半不会想开启这个选项。\n     * 同时，在少部分使用软件级别抗锯齿算法的设备或浏览器上，这个选项会对性能产生比较大的影响。\n     * 你可以在 `cc.game.run` 之前设置这个值，否则它不会生效。\n     * 仅支持 Web\n     * @property {Boolean} ENABLE_WEBGL_ANTIALIAS\n     * @default false\n     */\n    ENABLE_WEBGL_ANTIALIAS: false,\n\n    /**\n     * !#en\n     * Whether or not enable auto culling.\n     * This feature have been removed in v2.0 new renderer due to overall performance consumption.\n     * We have no plan currently to re-enable auto culling.\n     * If your game have more dynamic objects, we suggest to disable auto culling.\n     * If your game have more static objects, we suggest to enable auto culling.\n     * !#zh\n     * 是否开启自动裁减功能，开启裁减功能将会把在屏幕外的物体从渲染队列中去除掉。\n     * 这个功能在 v2.0 的新渲染器中被移除了，因为它在大多数游戏中所带来的损耗要高于性能的提升，目前我们没有计划重新支持自动裁剪。\n     * 如果游戏中的动态物体比较多的话，建议将此选项关闭。\n     * 如果游戏中的静态物体比较多的话，建议将此选项打开。\n     * @property {Boolean} ENABLE_CULLING\n     * @deprecated since v2.0\n     * @default false\n     */\n    ENABLE_CULLING: false,\n\n    /**\n     * !#en\n     * Whether to clear the original image cache after uploaded a texture to GPU. If cleared, [Dynamic Atlas](https://docs.cocos.com/creator/manual/en/advanced-topics/dynamic-atlas.html) will not be supported.\n     * Normally you don't need to enable this option on the web platform, because Image object doesn't consume too much memory.\n     * But on WeChat Game platform, the current version cache decoded data in Image object, which has high memory usage.\n     * So we enabled this option by default on WeChat, so that we can release Image cache immediately after uploaded to GPU.\n     * !#zh\n     * 是否在将贴图上传至 GPU 之后删除原始图片缓存，删除之后图片将无法进行 [动态合图](https://docs.cocos.com/creator/manual/zh/advanced-topics/dynamic-atlas.html)。\n     * 在 Web 平台，你通常不需要开启这个选项，因为在 Web 平台 Image 对象所占用的内存很小。\n     * 但是在微信小游戏平台的当前版本，Image 对象会缓存解码后的图片数据，它所占用的内存空间很大。\n     * 所以我们在微信平台默认开启了这个选项，这样我们就可以在上传 GL 贴图之后立即释放 Image 对象的内存，避免过高的内存占用。\n     * @property {Boolean} CLEANUP_IMAGE_CACHE\n     * @default false\n     */\n    CLEANUP_IMAGE_CACHE: false,\n\n    /**\n     * !#en\n     * Whether or not show mesh wire frame.\n     * !#zh\n     * 是否显示网格的线框。\n     * @property {Boolean} SHOW_MESH_WIREFRAME\n     * @default false\n     */\n    SHOW_MESH_WIREFRAME: false,\n\n    /**\n     * !#en\n     * Whether or not show mesh normal.\n     * !#zh\n     * 是否显示网格的法线。\n     * @property {Boolean} SHOW_MESH_NORMAL\n     * @default false\n     */\n    SHOW_MESH_NORMAL: false,\n\n    /**\n     * !#en\n     * Set cc.RotateTo/cc.RotateBy rotate direction.\n     * If need set rotate positive direction to counterclockwise, please change setting to: `cc.macro.ROTATE_ACTION_CCW = true;`\n     * !#zh\n     * 设置 cc.RotateTo/cc.RotateBy 的旋转方向。\n     * 如果需要设置旋转的正方向为逆时针方向，请设置选项为：`cc.macro.ROTATE_ACTION_CCW = true;`\n     * @property {Boolean} ROTATE_ACTION_CCW\n     * @default false\n     */\n    ROTATE_ACTION_CCW: false,\n\n    /**\n     * !#en\n     * Whether to enable multi-touch.\n     * !#zh\n     * 是否开启多点触摸\n     * @property {Boolean} ENABLE_MULTI_TOUCH\n     * @default true\n     */\n    ENABLE_MULTI_TOUCH: true\n};\n\n\nlet SUPPORT_TEXTURE_FORMATS = ['.pkm', '.pvr', '.webp', '.jpg', '.jpeg', '.bmp', '.png'];\n\n/**\n * !#en\n * The image format supported by the engine defaults, and the supported formats may differ in different build platforms and device types.\n * Currently all platform and device support ['.webp', '.jpg', '.jpeg', '.bmp', '.png'], The iOS mobile platform also supports the PVR format。\n * !#zh\n * 引擎默认支持的图片格式，支持的格式可能在不同的构建平台和设备类型上有所差别。\n * 目前所有平台和设备支持的格式有 ['.webp', '.jpg', '.jpeg', '.bmp', '.png']. 另外 Ios 手机平台还额外支持了 PVR 格式。\n * @property {String[]} SUPPORT_TEXTURE_FORMATS\n */\ncc.macro.SUPPORT_TEXTURE_FORMATS = SUPPORT_TEXTURE_FORMATS;\n\n\n/**\n * !#en Key map for keyboard event\n * !#zh 键盘事件的按键值\n * @enum macro.KEY\n * @example {@link cocos2d/core/platform/CCCommon/KEY.js}\n */\ncc.macro.KEY = {\n    /**\n     * !#en None\n     * !#zh 没有分配\n     * @property none\n     * @type {Number}\n     * @readonly\n     */\n    none:0,\n\n    // android\n    /**\n     * !#en The back key\n     * !#zh 返回键\n     * @property back\n     * @type {Number}\n     * @readonly\n     */\n    back:6,\n    /**\n     * !#en The menu key\n     * !#zh 菜单键\n     * @property menu\n     * @type {Number}\n     * @readonly\n     */\n    menu:18,\n\n    /**\n     * !#en The backspace key\n     * !#zh 退格键\n     * @property backspace\n     * @type {Number}\n     * @readonly\n     */\n    backspace:8,\n\n    /**\n     * !#en The tab key\n     * !#zh Tab 键\n     * @property tab\n     * @type {Number}\n     * @readonly\n     */\n    tab:9,\n\n    /**\n     * !#en The enter key\n     * !#zh 回车键\n     * @property enter\n     * @type {Number}\n     * @readonly\n     */\n    enter:13,\n\n    /**\n     * !#en The shift key\n     * !#zh Shift 键\n     * @property shift\n     * @type {Number}\n     * @readonly\n     */\n    shift:16, //should use shiftkey instead\n\n    /**\n     * !#en The ctrl key\n     * !#zh Ctrl 键\n     * @property ctrl\n     * @type {Number}\n     * @readonly\n     */\n    ctrl:17, //should use ctrlkey\n\n    /**\n     * !#en The alt key\n     * !#zh Alt 键\n     * @property alt\n     * @type {Number}\n     * @readonly\n     */\n    alt:18, //should use altkey\n\n    /**\n     * !#en The pause key\n     * !#zh 暂停键\n     * @property pause\n     * @type {Number}\n     * @readonly\n     */\n    pause:19,\n\n    /**\n     * !#en The caps lock key\n     * !#zh 大写锁定键\n     * @property capslock\n     * @type {Number}\n     * @readonly\n     */\n    capslock:20,\n\n    /**\n     * !#en The esc key\n     * !#zh ESC 键\n     * @property escape\n     * @type {Number}\n     * @readonly\n     */\n    escape:27,\n\n    /**\n     * !#en The space key\n     * !#zh 空格键\n     * @property space\n     * @type {Number}\n     * @readonly\n     */\n    space:32,\n\n    /**\n     * !#en The page up key\n     * !#zh 向上翻页键\n     * @property pageup\n     * @type {Number}\n     * @readonly\n     */\n    pageup:33,\n\n    /**\n     * !#en The page down key\n     * !#zh 向下翻页键\n     * @property pagedown\n     * @type {Number}\n     * @readonly\n     */\n    pagedown:34,\n\n    /**\n     * !#en The end key\n     * !#zh 结束键\n     * @property end\n     * @type {Number}\n     * @readonly\n     */\n    end:35,\n\n    /**\n     * !#en The home key\n     * !#zh 主菜单键\n     * @property home\n     * @type {Number}\n     * @readonly\n     */\n    home:36,\n\n    /**\n     * !#en The left key\n     * !#zh 向左箭头键\n     * @property left\n     * @type {Number}\n     * @readonly\n     */\n    left:37,\n\n    /**\n     * !#en The up key\n     * !#zh 向上箭头键\n     * @property up\n     * @type {Number}\n     * @readonly\n     */\n    up:38,\n\n    /**\n     * !#en The right key\n     * !#zh 向右箭头键\n     * @property right\n     * @type {Number}\n     * @readonly\n     */\n    right:39,\n\n    /**\n     * !#en The down key\n     * !#zh 向下箭头键\n     * @property down\n     * @type {Number}\n     * @readonly\n     */\n    down:40,\n\n    /**\n     * !#en The select key\n     * !#zh Select 键\n     * @property select\n     * @type {Number}\n     * @readonly\n     */\n    select:41,\n\n    /**\n     * !#en The insert key\n     * !#zh 插入键\n     * @property insert\n     * @type {Number}\n     * @readonly\n     */\n    insert:45,\n\n    /**\n     * !#en The Delete key\n     * !#zh 删除键\n     * @property Delete\n     * @type {Number}\n     * @readonly\n     */\n    Delete:46,\n\n    /**\n     * !#en The '0' key on the top of the alphanumeric keyboard.\n     * !#zh 字母键盘上的 0 键\n     * @property 0\n     * @type {Number}\n     * @readonly\n     */\n    0:48,\n\n    /**\n     * !#en The '1' key on the top of the alphanumeric keyboard.\n     * !#zh 字母键盘上的 1 键\n     * @property 1\n     * @type {Number}\n     * @readonly\n     */\n    1:49,\n\n    /**\n     * !#en The '2' key on the top of the alphanumeric keyboard.\n     * !#zh 字母键盘上的 2 键\n     * @property 2\n     * @type {Number}\n     * @readonly\n     */\n    2:50,\n\n    /**\n     * !#en The '3' key on the top of the alphanumeric keyboard.\n     * !#zh 字母键盘上的 3 键\n     * @property 3\n     * @type {Number}\n     * @readonly\n     */\n    3:51,\n\n    /**\n     * !#en The '4' key on the top of the alphanumeric keyboard.\n     * !#zh 字母键盘上的 4 键\n     * @property 4\n     * @type {Number}\n     * @readonly\n     */\n    4:52,\n\n    /**\n     * !#en The '5' key on the top of the alphanumeric keyboard.\n     * !#zh 字母键盘上的 5 键\n     * @property 5\n     * @type {Number}\n     * @readonly\n     */\n    5:53,\n\n    /**\n     * !#en The '6' key on the top of the alphanumeric keyboard.\n     * !#zh 字母键盘上的 6 键\n     * @property 6\n     * @type {Number}\n     * @readonly\n     */\n    6:54,\n\n    /**\n     * !#en The '7' key on the top of the alphanumeric keyboard.\n     * !#zh 字母键盘上的 7 键\n     * @property 7\n     * @type {Number}\n     * @readonly\n     */\n    7:55,\n\n    /**\n     * !#en The '8' key on the top of the alphanumeric keyboard.\n     * !#zh 字母键盘上的 8 键\n     * @property 8\n     * @type {Number}\n     * @readonly\n     */\n    8:56,\n\n    /**\n     * !#en The '9' key on the top of the alphanumeric keyboard.\n     * !#zh 字母键盘上的 9 键\n     * @property 9\n     * @type {Number}\n     * @readonly\n     */\n    9:57,\n\n    /**\n     * !#en The a key\n     * !#zh A 键\n     * @property a\n     * @type {Number}\n     * @readonly\n     */\n    a:65,\n\n    /**\n     * !#en The b key\n     * !#zh B 键\n     * @property b\n     * @type {Number}\n     * @readonly\n     */\n    b:66,\n\n    /**\n     * !#en The c key\n     * !#zh C 键\n     * @property c\n     * @type {Number}\n     * @readonly\n     */\n    c:67,\n\n    /**\n     * !#en The d key\n     * !#zh D 键\n     * @property d\n     * @type {Number}\n     * @readonly\n     */\n    d:68,\n\n    /**\n     * !#en The e key\n     * !#zh E 键\n     * @property e\n     * @type {Number}\n     * @readonly\n     */\n    e:69,\n\n    /**\n     * !#en The f key\n     * !#zh F 键\n     * @property f\n     * @type {Number}\n     * @readonly\n     */\n    f:70,\n\n    /**\n     * !#en The g key\n     * !#zh G 键\n     * @property g\n     * @type {Number}\n     * @readonly\n     */\n    g:71,\n\n    /**\n     * !#en The h key\n     * !#zh H 键\n     * @property h\n     * @type {Number}\n     * @readonly\n     */\n    h:72,\n\n    /**\n     * !#en The i key\n     * !#zh I 键\n     * @property i\n     * @type {Number}\n     * @readonly\n     */\n    i:73,\n\n    /**\n     * !#en The j key\n     * !#zh J 键\n     * @property j\n     * @type {Number}\n     * @readonly\n     */\n    j:74,\n\n    /**\n     * !#en The k key\n     * !#zh K 键\n     * @property k\n     * @type {Number}\n     * @readonly\n     */\n    k:75,\n\n    /**\n     * !#en The l key\n     * !#zh L 键\n     * @property l\n     * @type {Number}\n     * @readonly\n     */\n    l:76,\n\n    /**\n     * !#en The m key\n     * !#zh M 键\n     * @property m\n     * @type {Number}\n     * @readonly\n     */\n    m:77,\n\n    /**\n     * !#en The n key\n     * !#zh N 键\n     * @property n\n     * @type {Number}\n     * @readonly\n     */\n    n:78,\n\n    /**\n     * !#en The o key\n     * !#zh O 键\n     * @property o\n     * @type {Number}\n     * @readonly\n     */\n    o:79,\n\n    /**\n     * !#en The p key\n     * !#zh P 键\n     * @property p\n     * @type {Number}\n     * @readonly\n     */\n    p:80,\n\n    /**\n     * !#en The q key\n     * !#zh Q 键\n     * @property q\n     * @type {Number}\n     * @readonly\n     */\n    q:81,\n\n    /**\n     * !#en The r key\n     * !#zh R 键\n     * @property r\n     * @type {Number}\n     * @readonly\n     */\n    r:82,\n\n    /**\n     * !#en The s key\n     * !#zh S 键\n     * @property s\n     * @type {Number}\n     * @readonly\n     */\n    s:83,\n\n    /**\n     * !#en The t key\n     * !#zh T 键\n     * @property t\n     * @type {Number}\n     * @readonly\n     */\n    t:84,\n\n    /**\n     * !#en The u key\n     * !#zh U 键\n     * @property u\n     * @type {Number}\n     * @readonly\n     */\n    u:85,\n\n    /**\n     * !#en The v key\n     * !#zh V 键\n     * @property v\n     * @type {Number}\n     * @readonly\n     */\n    v:86,\n\n    /**\n     * !#en The w key\n     * !#zh W 键\n     * @property w\n     * @type {Number}\n     * @readonly\n     */\n    w:87,\n\n    /**\n     * !#en The x key\n     * !#zh X 键\n     * @property x\n     * @type {Number}\n     * @readonly\n     */\n    x:88,\n\n    /**\n     * !#en The y key\n     * !#zh Y 键\n     * @property y\n     * @type {Number}\n     * @readonly\n     */\n    y:89,\n\n    /**\n     * !#en The z key\n     * !#zh Z 键\n     * @property z\n     * @type {Number}\n     * @readonly\n     */\n    z:90,\n\n    /**\n     * !#en The numeric keypad 0\n     * !#zh 数字键盘 0\n     * @property num0\n     * @type {Number}\n     * @readonly\n     */\n    num0:96,\n\n    /**\n     * !#en The numeric keypad 1\n     * !#zh 数字键盘 1\n     * @property num1\n     * @type {Number}\n     * @readonly\n     */\n    num1:97,\n\n    /**\n     * !#en The numeric keypad 2\n     * !#zh 数字键盘 2\n     * @property num2\n     * @type {Number}\n     * @readonly\n     */\n    num2:98,\n\n    /**\n     * !#en The numeric keypad 3\n     * !#zh 数字键盘 3\n     * @property num3\n     * @type {Number}\n     * @readonly\n     */\n    num3:99,\n\n    /**\n     * !#en The numeric keypad 4\n     * !#zh 数字键盘 4\n     * @property num4\n     * @type {Number}\n     * @readonly\n     */\n    num4:100,\n\n    /**\n     * !#en The numeric keypad 5\n     * !#zh 数字键盘 5\n     * @property num5\n     * @type {Number}\n     * @readonly\n     */\n    num5:101,\n\n    /**\n     * !#en The numeric keypad 6\n     * !#zh 数字键盘 6\n     * @property num6\n     * @type {Number}\n     * @readonly\n     */\n    num6:102,\n\n    /**\n     * !#en The numeric keypad 7\n     * !#zh 数字键盘 7\n     * @property num7\n     * @type {Number}\n     * @readonly\n     */\n    num7:103,\n\n    /**\n     * !#en The numeric keypad 8\n     * !#zh 数字键盘 8\n     * @property num8\n     * @type {Number}\n     * @readonly\n     */\n    num8:104,\n\n    /**\n     * !#en The numeric keypad 9\n     * !#zh 数字键盘 9\n     * @property num9\n     * @type {Number}\n     * @readonly\n     */\n    num9:105,\n\n    /**\n     * !#en The numeric keypad '*'\n     * !#zh 数字键盘 *\n     * @property *\n     * @type {Number}\n     * @readonly\n     */\n    '*':106,\n\n    /**\n     * !#en The numeric keypad '+'\n     * !#zh 数字键盘 +\n     * @property +\n     * @type {Number}\n     * @readonly\n     */\n    '+':107,\n\n    /**\n     * !#en The numeric keypad '-'\n     * !#zh 数字键盘 -\n     * @property -\n     * @type {Number}\n     * @readonly\n     */\n    '-':109,\n\n    /**\n     * !#en The numeric keypad 'delete'\n     * !#zh 数字键盘删除键\n     * @property numdel\n     * @type {Number}\n     * @readonly\n     */\n    'numdel':110,\n\n    /**\n     * !#en The numeric keypad '/'\n     * !#zh 数字键盘 /\n     * @property /\n     * @type {Number}\n     * @readonly\n     */\n    '/':111,\n\n    /**\n     * !#en The F1 function key\n     * !#zh F1 功能键\n     * @property f1\n     * @type {Number}\n     * @readonly\n     */\n    f1:112, //f1-f12 dont work on ie\n\n    /**\n     * !#en The F2 function key\n     * !#zh F2 功能键\n     * @property f2\n     * @type {Number}\n     * @readonly\n     */\n    f2:113,\n\n    /**\n     * !#en The F3 function key\n     * !#zh F3 功能键\n     * @property f3\n     * @type {Number}\n     * @readonly\n     */\n    f3:114,\n\n    /**\n     * !#en The F4 function key\n     * !#zh F4 功能键\n     * @property f4\n     * @type {Number}\n     * @readonly\n     */\n    f4:115,\n\n    /**\n     * !#en The F5 function key\n     * !#zh F5 功能键\n     * @property f5\n     * @type {Number}\n     * @readonly\n     */\n    f5:116,\n\n    /**\n     * !#en The F6 function key\n     * !#zh F6 功能键\n     * @property f6\n     * @type {Number}\n     * @readonly\n     */\n    f6:117,\n\n    /**\n     * !#en The F7 function key\n     * !#zh F7 功能键\n     * @property f7\n     * @type {Number}\n     * @readonly\n     */\n    f7:118,\n\n    /**\n     * !#en The F8 function key\n     * !#zh F8 功能键\n     * @property f8\n     * @type {Number}\n     * @readonly\n     */\n    f8:119,\n\n    /**\n     * !#en The F9 function key\n     * !#zh F9 功能键\n     * @property f9\n     * @type {Number}\n     * @readonly\n     */\n    f9:120,\n\n    /**\n     * !#en The F10 function key\n     * !#zh F10 功能键\n     * @property f10\n     * @type {Number}\n     * @readonly\n     */\n    f10:121,\n\n    /**\n     * !#en The F11 function key\n     * !#zh F11 功能键\n     * @property f11\n     * @type {Number}\n     * @readonly\n     */\n    f11:122,\n\n    /**\n     * !#en The F12 function key\n     * !#zh F12 功能键\n     * @property f12\n     * @type {Number}\n     * @readonly\n     */\n    f12:123,\n\n    /**\n     * !#en The numlock key\n     * !#zh 数字锁定键\n     * @property numlock\n     * @type {Number}\n     * @readonly\n     */\n    numlock:144,\n\n    /**\n     * !#en The scroll lock key\n     * !#zh 滚动锁定键\n     * @property scrolllock\n     * @type {Number}\n     * @readonly\n     */\n    scrolllock:145,\n\n    /**\n     * !#en The ';' key.\n     * !#zh 分号键\n     * @property ;\n     * @type {Number}\n     * @readonly\n     */\n    ';':186,\n\n    /**\n     * !#en The ';' key.\n     * !#zh 分号键\n     * @property semicolon\n     * @type {Number}\n     * @readonly\n     */\n    semicolon:186,\n\n    /**\n     * !#en The '=' key.\n     * !#zh 等于号键\n     * @property equal\n     * @type {Number}\n     * @readonly\n     */\n    equal:187,\n\n    /**\n     * !#en The '=' key.\n     * !#zh 等于号键\n     * @property =\n     * @type {Number}\n     * @readonly\n     */\n    '=':187,\n\n    /**\n     * !#en The ',' key.\n     * !#zh 逗号键\n     * @property ,\n     * @type {Number}\n     * @readonly\n     */\n    ',':188,\n\n    /**\n     * !#en The ',' key.\n     * !#zh 逗号键\n     * @property comma\n     * @type {Number}\n     * @readonly\n     */\n    comma:188,\n\n    /**\n     * !#en The dash '-' key.\n     * !#zh 中划线键\n     * @property dash\n     * @type {Number}\n     * @readonly\n     */\n    dash:189,\n\n    /**\n     * !#en The '.' key.\n     * !#zh 句号键\n     * @property .\n     * @type {Number}\n     * @readonly\n     */\n    '.':190,\n\n    /**\n     * !#en The '.' key\n     * !#zh 句号键\n     * @property period\n     * @type {Number}\n     * @readonly\n     */\n    period:190,\n\n    /**\n     * !#en The forward slash key\n     * !#zh 正斜杠键\n     * @property forwardslash\n     * @type {Number}\n     * @readonly\n     */\n    forwardslash:191,\n\n    /**\n     * !#en The grave key\n     * !#zh 按键 `\n     * @property grave\n     * @type {Number}\n     * @readonly\n     */\n    grave:192,\n\n    /**\n     * !#en The '[' key\n     * !#zh 按键 [\n     * @property [\n     * @type {Number}\n     * @readonly\n     */\n    '[':219,\n\n    /**\n     * !#en The '[' key\n     * !#zh 按键 [\n     * @property openbracket\n     * @type {Number}\n     * @readonly\n     */\n    openbracket:219,\n\n    /**\n     * !#en The '\\' key\n     * !#zh 反斜杠键\n     * @property backslash\n     * @type {Number}\n     * @readonly\n     */\n    backslash:220,\n\n    /**\n     * !#en The ']' key\n     * !#zh 按键 ]\n     * @property ]\n     * @type {Number}\n     * @readonly\n     */\n    ']':221,\n\n    /**\n     * !#en The ']' key\n     * !#zh 按键 ]\n     * @property closebracket\n     * @type {Number}\n     * @readonly\n     */\n    closebracket:221,\n\n    /**\n     * !#en The quote key\n     * !#zh 单引号键\n     * @property quote\n     * @type {Number}\n     * @readonly\n     */\n    quote:222,\n\n    // gamepad controll\n\n    /**\n     * !#en The dpad left key\n     * !#zh 导航键 向左\n     * @property dpadLeft\n     * @type {Number}\n     * @readonly\n     */\n    dpadLeft:1000,\n\n    /**\n     * !#en The dpad right key\n     * !#zh 导航键 向右\n     * @property dpadRight\n     * @type {Number}\n     * @readonly\n     */\n    dpadRight:1001,\n\n    /**\n     * !#en The dpad up key\n     * !#zh 导航键 向上\n     * @property dpadUp\n     * @type {Number}\n     * @readonly\n     */\n    dpadUp:1003,\n\n    /**\n     * !#en The dpad down key\n     * !#zh 导航键 向下\n     * @property dpadDown\n     * @type {Number}\n     * @readonly\n     */\n    dpadDown:1004,\n\n    /**\n     * !#en The dpad center key\n     * !#zh 导航键 确定键\n     * @property dpadCenter\n     * @type {Number}\n     * @readonly\n     */\n    dpadCenter:1005\n};\n\n/**\n * Image formats\n * @enum macro.ImageFormat\n */\ncc.macro.ImageFormat = cc.Enum({\n    /**\n     * Image Format:JPG\n     * @property JPG\n     * @type {Number}\n     */\n    JPG: 0,\n    /**\n     * Image Format:PNG\n     * @property PNG\n     * @type {Number}\n     */\n    PNG: 1,\n    /**\n     * Image Format:TIFF\n     * @property TIFF\n     * @type {Number}\n     */\n    TIFF: 2,\n    /**\n     * Image Format:WEBP\n     * @property WEBP\n     * @type {Number}\n     */\n    WEBP: 3,\n    /**\n     * Image Format:PVR\n     * @property PVR\n     * @type {Number}\n     */\n    PVR: 4,\n    /**\n     * Image Format:ETC\n     * @property ETC\n     * @type {Number}\n     */\n    ETC: 5,\n    /**\n     * Image Format:S3TC\n     * @property S3TC\n     * @type {Number}\n     */\n    S3TC: 6,\n    /**\n     * Image Format:ATITC\n     * @property ATITC\n     * @type {Number}\n     */\n    ATITC: 7,\n    /**\n     * Image Format:TGA\n     * @property TGA\n     * @type {Number}\n     */\n    TGA: 8,\n    /**\n     * Image Format:RAWDATA\n     * @property RAWDATA\n     * @type {Number}\n     */\n    RAWDATA: 9,\n    /**\n     * Image Format:UNKNOWN\n     * @property UNKNOWN\n     * @type {Number}\n     */\n    UNKNOWN: 10\n});\n\n/**\n * !#en\n * Enum for blend factor\n * Refer to: http://www.andersriggelsen.dk/glblendfunc.php\n * !#zh\n * 混合因子\n * 可参考: http://www.andersriggelsen.dk/glblendfunc.php\n * @enum macro.BlendFactor\n */\ncc.macro.BlendFactor = cc.Enum({\n    /**\n     * !#en All use\n     * !#zh 全部使用\n     * @property {Number} ONE\n     */\n    ONE:                    1,  //cc.macro.ONE\n    /**\n     * !#en Not all\n     * !#zh 全部不用\n     * @property {Number} ZERO\n     */\n    ZERO:                   0,      //cc.ZERO\n    /**\n     * !#en Using the source alpha\n     * !#zh 使用源颜色的透明度\n     * @property {Number} SRC_ALPHA\n     */\n    SRC_ALPHA:              0x302,  //cc.SRC_ALPHA\n    /**\n     * !#en Using the source color\n     * !#zh 使用源颜色\n     * @property {Number} SRC_COLOR\n     */\n    SRC_COLOR:              0x300,  //cc.SRC_COLOR\n    /**\n     * !#en Using the target alpha\n     * !#zh 使用目标颜色的透明度\n     * @property {Number} DST_ALPHA\n     */\n    DST_ALPHA:              0x304,  //cc.DST_ALPHA\n    /**\n     * !#en Using the target color\n     * !#zh 使用目标颜色\n     * @property {Number} DST_COLOR\n     */\n    DST_COLOR:              0x306,  //cc.DST_COLOR\n    /**\n     * !#en Minus the source alpha\n     * !#zh 减去源颜色的透明度\n     * @property {Number} ONE_MINUS_SRC_ALPHA\n     */\n    ONE_MINUS_SRC_ALPHA:    0x303,  //cc.ONE_MINUS_SRC_ALPHA\n    /**\n     * !#en Minus the source color\n     * !#zh 减去源颜色\n     * @property {Number} ONE_MINUS_SRC_COLOR\n     */\n    ONE_MINUS_SRC_COLOR:    0x301,  //cc.ONE_MINUS_SRC_COLOR\n    /**\n     * !#en Minus the target alpha\n     * !#zh 减去目标颜色的透明度\n     * @property {Number} ONE_MINUS_DST_ALPHA\n     */\n    ONE_MINUS_DST_ALPHA:    0x305,  //cc.ONE_MINUS_DST_ALPHA\n    /**\n     * !#en Minus the target color\n     * !#zh 减去目标颜色\n     * @property {Number} ONE_MINUS_DST_COLOR\n     */\n    ONE_MINUS_DST_COLOR:    0x307,  //cc.ONE_MINUS_DST_COLOR\n});\n\n/**\n * @enum macro.TextAlignment\n */\ncc.macro.TextAlignment = cc.Enum({\n    /**\n     * @property {Number} LEFT\n     */\n    LEFT: 0,\n    /**\n     * @property {Number} CENTER\n     */\n    CENTER: 1,\n    /**\n     * @property {Number} RIGHT\n     */\n    RIGHT: 2\n});\n\n/**\n * @enum VerticalTextAlignment\n */\ncc.macro.VerticalTextAlignment = cc.Enum({\n    /**\n     * @property {Number} TOP\n     */\n    TOP: 0,\n    /**\n     * @property {Number} CENTER\n     */\n    CENTER: 1,\n    /**\n     * @property {Number} BOTTOM\n     */\n    BOTTOM: 2\n});\n\nmodule.exports = cc.macro;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require('./js');\nvar CCClass = require('./CCClass');\n\n// definitions for CCObject.Flags\n\nvar Destroyed = 1 << 0;\nvar RealDestroyed = 1 << 1;\nvar ToDestroy = 1 << 2;\nvar DontSave = 1 << 3;\nvar EditorOnly = 1 << 4;\nvar Dirty = 1 << 5;\nvar DontDestroy = 1 << 6;\nvar Destroying = 1 << 7;\nvar Deactivating = 1 << 8;\nvar LockedInEditor = 1 << 9;\n//var HideInGame = 1 << 9;\nvar HideInHierarchy = 1 << 10;\n\nvar IsOnEnableCalled = 1 << 11;\nvar IsEditorOnEnableCalled = 1 << 12;\nvar IsPreloadStarted = 1 << 13;\nvar IsOnLoadCalled = 1 << 14;\nvar IsOnLoadStarted = 1 << 15;\nvar IsStartCalled = 1 << 16;\n\nvar IsRotationLocked = 1 << 17;\nvar IsScaleLocked = 1 << 18;\nvar IsAnchorLocked = 1 << 19;\nvar IsSizeLocked = 1 << 20;\nvar IsPositionLocked = 1 << 21;\n\n//var Hide = HideInGame | HideInHierarchy;\n// should not clone or serialize these flags\nvar PersistentMask = ~(ToDestroy | Dirty | Destroying | DontDestroy | Deactivating |\n                       IsPreloadStarted | IsOnLoadStarted | IsOnLoadCalled | IsStartCalled |\n                       IsOnEnableCalled | IsEditorOnEnableCalled |\n                       IsRotationLocked | IsScaleLocked | IsAnchorLocked | IsSizeLocked | IsPositionLocked\n                       /*RegisteredInEditor*/);\n\n/**\n * The base class of most of all the objects in Fireball.\n * @class Object\n *\n * @main\n * @private\n */\nfunction CCObject () {\n    /**\n     * @property {String} _name\n     * @default \"\"\n     * @private\n     */\n    this._name = '';\n\n    /**\n     * @property {Number} _objFlags\n     * @default 0\n     * @private\n     */\n    this._objFlags = 0;\n}\nCCClass.fastDefine('cc.Object', CCObject, { _name: '', _objFlags: 0 });\n\n/**\n * Bit mask that controls object states.\n * @enum Flags\n * @static\n * @private\n */\njs.value(CCObject, 'Flags', {\n\n    Destroyed,\n    //ToDestroy: ToDestroy,\n\n    /**\n     * !#en The object will not be saved.\n     * !#zh 该对象将不会被保存。\n     * @property {Number} DontSave\n     */\n    DontSave,\n\n    /**\n     * !#en The object will not be saved when building a player.\n     * !#zh 构建项目时，该对象将不会被保存。\n     * @property {Number} EditorOnly\n     */\n    EditorOnly,\n\n    Dirty,\n\n    /**\n     * !#en Dont destroy automatically when loading a new scene.\n     * !#zh 加载一个新场景时，不自动删除该对象。\n     * @property DontDestroy\n     * @private\n     */\n    DontDestroy,\n\n    PersistentMask,\n\n    // FLAGS FOR ENGINE\n\n    Destroying,\n\n    /**\n     * !#en The node is deactivating.\n     * !#zh 节点正在反激活的过程中。\n     * @property Deactivating\n     * @private\n     */\n    Deactivating,\n\n    /**\n     * !#en The lock node, when the node is locked, cannot be clicked in the scene.\n     * !#zh 锁定节点，锁定后场景内不能点击。\n     * \n     * @property LockedInEditor\n     * @private\n     */\n    LockedInEditor,\n\n    ///**\n    // * !#en\n    // * Hide in game and hierarchy.\n    // * This flag is readonly, it can only be used as an argument of scene.addEntity() or Entity.createWithFlags().\n    // * !#zh\n    // * 在游戏和层级中隐藏该对象。<br/>\n    // * 该标记只读，它只能被用作 scene.addEntity()的一个参数。\n    // * @property {Number} HideInGame\n    // */\n    //HideInGame: HideInGame,\n\n    // FLAGS FOR EDITOR\n\n    /**\n     * !#en Hide the object in editor.\n     * !#zh 在编辑器中隐藏该对象。\n     * @property {Number} HideInHierarchy\n     */\n    HideInHierarchy: HideInHierarchy,\n\n    ///**\n    // * !#en\n    // * Hide in game view, hierarchy, and scene view... etc.\n    // * This flag is readonly, it can only be used as an argument of scene.addEntity() or Entity.createWithFlags().\n    // * !#zh\n    // * 在游戏视图，层级，场景视图等等...中隐藏该对象。\n    // * 该标记只读，它只能被用作 scene.addEntity()的一个参数。\n    // * @property {Number} Hide\n    // */\n    //Hide: Hide,\n\n    // FLAGS FOR COMPONENT\n\n    IsPreloadStarted,\n    IsOnLoadStarted,\n    IsOnLoadCalled,\n    IsOnEnableCalled,\n    IsStartCalled,\n    IsEditorOnEnableCalled,\n\n    IsPositionLocked,\n    IsRotationLocked,\n    IsScaleLocked,\n    IsAnchorLocked,\n    IsSizeLocked,\n});\n\nvar objectsToDestroy = [];\n\nfunction deferredDestroy () {\n    var deleteCount = objectsToDestroy.length;\n    for (var i = 0; i < deleteCount; ++i) {\n        var obj = objectsToDestroy[i];\n        if (!(obj._objFlags & Destroyed)) {\n            obj._destroyImmediate();\n        }\n    }\n    // if we called b.destory() in a.onDestroy(), objectsToDestroy will be resized,\n    // but we only destroy the objects which called destory in this frame.\n    if (deleteCount === objectsToDestroy.length) {\n        objectsToDestroy.length = 0;\n    }\n    else {\n        objectsToDestroy.splice(0, deleteCount);\n    }\n\n    if (CC_EDITOR) {\n        deferredDestroyTimer = null;\n    }\n}\n\njs.value(CCObject, '_deferredDestroy', deferredDestroy);\n\nif (CC_EDITOR) {\n    js.value(CCObject, '_clearDeferredDestroyTimer', function () {\n        if (deferredDestroyTimer !== null) {\n            clearImmediate(deferredDestroyTimer);\n            deferredDestroyTimer = null;\n        }\n    });\n}\n\n// MEMBER\n\n/**\n * @class Object\n */\n\nvar prototype = CCObject.prototype;\n\n/**\n * !#en The name of the object.\n * !#zh 该对象的名称。\n * @property {String} name\n * @default \"\"\n * @example\n * obj.name = \"New Obj\";\n */\njs.getset(prototype, 'name',\n    function () {\n        return this._name;\n    },\n    function (value) {\n        this._name = value;\n    },\n    true\n);\n\n/**\n * !#en\n * Indicates whether the object is not yet destroyed. (It will not be available after being destroyed)<br>\n * When an object's `destroy` is called, it is actually destroyed after the end of this frame.\n * So `isValid` will return false from the next frame, while `isValid` in the current frame will still be true.\n * If you want to determine whether the current frame has called `destroy`, use `cc.isValid(obj, true)`,\n * but this is often caused by a particular logical requirements, which is not normally required.\n *\n * !#zh\n * 表示该对象是否可用（被 destroy 后将不可用）。<br>\n * 当一个对象的 `destroy` 调用以后，会在这一帧结束后才真正销毁。因此从下一帧开始 `isValid` 就会返回 false，而当前帧内 `isValid` 仍然会是 true。如果希望判断当前帧是否调用过 `destroy`，请使用 `cc.isValid(obj, true)`，不过这往往是特殊的业务需求引起的，通常情况下不需要这样。\n *\n * @property {Boolean} isValid\n * @default true\n * @readOnly\n * @example\n * var node = new cc.Node();\n * cc.log(node.isValid);    // true\n * node.destroy();\n * cc.log(node.isValid);    // true, still valid in this frame\n * // after a frame...\n * cc.log(node.isValid);    // false, destroyed in the end of last frame\n */\njs.get(prototype, 'isValid', function () {\n    return !(this._objFlags & Destroyed);\n}, true);\n\nif (CC_EDITOR || CC_TEST) {\n    js.get(prototype, 'isRealValid', function () {\n        return !(this._objFlags & RealDestroyed);\n    });\n}\n\nvar deferredDestroyTimer = null;\n\n/**\n * !#en\n * Destroy this Object, and release all its own references to other objects.<br/>\n * Actual object destruction will delayed until before rendering.\n * From the next frame, this object is not usable any more.\n * You can use cc.isValid(obj) to check whether the object is destroyed before accessing it.\n * !#zh\n * 销毁该对象，并释放所有它对其它对象的引用。<br/>\n * 实际销毁操作会延迟到当前帧渲染前执行。从下一帧开始，该对象将不再可用。\n * 您可以在访问对象之前使用 cc.isValid(obj) 来检查对象是否已被销毁。\n * @method destroy\n * @return {Boolean} whether it is the first time the destroy being called\n * @example\n * obj.destroy();\n */\nprototype.destroy = function () {\n    if (this._objFlags & Destroyed) {\n        cc.warnID(5000);\n        return false;\n    }\n    if (this._objFlags & ToDestroy) {\n        return false;\n    }\n    this._objFlags |= ToDestroy;\n    objectsToDestroy.push(this);\n\n    if (CC_EDITOR && deferredDestroyTimer === null && cc.engine && ! cc.engine._isUpdating) {\n        // auto destroy immediate in edit mode\n        deferredDestroyTimer = setImmediate(deferredDestroy);\n    }\n    return true;\n};\n\nif (CC_EDITOR || CC_TEST) {\n    /*\n     * !#en\n     * In fact, Object's \"destroy\" will not trigger the destruct operation in Firebal Editor.\n     * The destruct operation will be executed by Undo system later.\n     * !#zh\n     * 事实上，对象的 “destroy” 不会在编辑器中触发析构操作，\n     * 析构操作将在 Undo 系统中**延后**执行。\n     * @method realDestroyInEditor\n     * @private\n     */\n    prototype.realDestroyInEditor = function () {\n        if ( !(this._objFlags & Destroyed) ) {\n            cc.warnID(5001);\n            return;\n        }\n        if (this._objFlags & RealDestroyed) {\n            cc.warnID(5000);\n            return;\n        }\n        this._destruct();\n        this._objFlags |= RealDestroyed;\n    };\n}\n\nfunction compileDestruct (obj, ctor) {\n    var shouldSkipId = obj instanceof cc._BaseNode || obj instanceof cc.Component;\n    var idToSkip = shouldSkipId ? '_id' : null;\n\n    var key, propsToReset = {};\n    for (key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            if (key === idToSkip) {\n                continue;\n            }\n            switch (typeof obj[key]) {\n                case 'string':\n                    propsToReset[key] = '';\n                    break;\n                case 'object':\n                case 'function':\n                    propsToReset[key] = null;\n                    break;\n            }\n        }\n    }\n    // Overwrite propsToReset according to Class\n    if (cc.Class._isCCClass(ctor)) {\n        var attrs = cc.Class.Attr.getClassAttrs(ctor);\n        var propList = ctor.__props__;\n        for (var i = 0; i < propList.length; i++) {\n            key = propList[i];\n            var attrKey = key + cc.Class.Attr.DELIMETER + 'default';\n            if (attrKey in attrs) {\n                if (shouldSkipId && key === '_id') {\n                    continue;\n                }\n                switch (typeof attrs[attrKey]) {\n                    case 'string':\n                        propsToReset[key] = '';\n                        break;\n                    case 'object':\n                    case 'function':\n                        propsToReset[key] = null;\n                        break;\n                    case 'undefined':\n                        propsToReset[key] = undefined;\n                        break;\n                }\n            }\n        }\n    }\n\n    if (CC_SUPPORT_JIT) {\n        // compile code\n        var func = '';\n        for (key in propsToReset) {\n            var statement;\n            if (CCClass.IDENTIFIER_RE.test(key)) {\n                statement = 'o.' + key + '=';\n            }\n            else {\n                statement = 'o[' + CCClass.escapeForJS(key) + ']=';\n            }\n            var val = propsToReset[key];\n            if (val === '') {\n                val = '\"\"';\n            }\n            func += (statement + val + ';\\n');\n        }\n        return Function('o', func);\n    }\n    else {\n        return function (o) {\n            for (var key in propsToReset) {\n                o[key] = propsToReset[key];\n            }\n        };\n    }\n}\n\n/**\n * Clear all references in the instance.\n *\n * NOTE: this method will not clear the getter or setter functions which defined in the instance of CCObject.\n *       You can override the _destruct method if you need, for example:\n *       _destruct: function () {\n *           for (var key in this) {\n *               if (this.hasOwnProperty(key)) {\n *                   switch (typeof this[key]) {\n *                       case 'string':\n *                           this[key] = '';\n *                           break;\n *                       case 'object':\n *                       case 'function':\n *                           this[key] = null;\n *                           break;\n *               }\n *           }\n *       }\n *\n * @method _destruct\n * @private\n */\nprototype._destruct = function () {\n    var ctor = this.constructor;\n    var destruct = ctor.__destruct__;\n    if (!destruct) {\n        destruct = compileDestruct(this, ctor);\n        js.value(ctor, '__destruct__', destruct, true);\n    }\n    destruct(this);\n};\n\n/**\n * Called before the object being destroyed.\n * @method _onPreDestroy\n * @private\n */\nprototype._onPreDestroy = null;\n\nprototype._destroyImmediate = function () {\n    if (this._objFlags & Destroyed) {\n        cc.errorID(5000);\n        return;\n    }\n    // engine internal callback\n    if (this._onPreDestroy) {\n        this._onPreDestroy();\n    }\n\n    if ((CC_TEST ? (/* make CC_EDITOR mockable*/ Function('return !CC_EDITOR'))() : !CC_EDITOR) || cc.engine._isPlaying) {\n        this._destruct();\n    }\n\n    this._objFlags |= Destroyed;\n};\n\nif (CC_EDITOR) {\n    /**\n     * The customized serialization for this object. (Editor Only)\n     * @method _serialize\n     * @param {Boolean} exporting\n     * @return {object} the serialized json data object\n     * @private\n     */\n    prototype._serialize = null;\n}\n\n/**\n * Init this object from the custom serialized data.\n * @method _deserialize\n * @param {Object} data - the serialized json data\n * @param {_Deserializer} ctx\n * @private\n */\nprototype._deserialize = null;\n\n/**\n * @module cc\n */\n\n/**\n * !#en\n * Checks whether the object is non-nil and not yet destroyed.<br>\n * When an object's `destroy` is called, it is actually destroyed after the end of this frame.\n * So `isValid` will return false from the next frame, while `isValid` in the current frame will still be true.\n * If you want to determine whether the current frame has called `destroy`, use `cc.isValid(obj, true)`,\n * but this is often caused by a particular logical requirements, which is not normally required.\n *\n * !#zh\n * 检查该对象是否不为 null 并且尚未销毁。<br>\n * 当一个对象的 `destroy` 调用以后，会在这一帧结束后才真正销毁。因此从下一帧开始 `isValid` 就会返回 false，而当前帧内 `isValid` 仍然会是 true。如果希望判断当前帧是否调用过 `destroy`，请使用 `cc.isValid(obj, true)`，不过这往往是特殊的业务需求引起的，通常情况下不需要这样。\n *\n * @method isValid\n * @param {any} value\n * @param {Boolean} [strictMode=false] - If true, Object called destroy() in this frame will also treated as invalid.\n * @return {Boolean} whether is valid\n * @example\n * var node = new cc.Node();\n * cc.log(cc.isValid(node));    // true\n * node.destroy();\n * cc.log(cc.isValid(node));    // true, still valid in this frame\n * // after a frame...\n * cc.log(cc.isValid(node));    // false, destroyed in the end of last frame\n */\ncc.isValid = function (value, strictMode) {\n    if (typeof value === 'object') {\n        return !!value && !(value._objFlags & (strictMode ? (Destroyed | ToDestroy) : Destroyed));\n    }\n    else {\n        return typeof value !== 'undefined';\n    }\n};\n\nif (CC_EDITOR || CC_TEST) {\n    js.value(CCObject, '_willDestroy', function (obj) {\n        return !(obj._objFlags & Destroyed) && (obj._objFlags & ToDestroy) > 0;\n    });\n    js.value(CCObject, '_cancelDestroy', function (obj) {\n        obj._objFlags &= ~ToDestroy;\n        js.array.fastRemove(objectsToDestroy, obj);\n    });\n}\n\ncc.Object = module.exports = CCObject;\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require('../platform/js');\n\n/**\n * A SAX Parser\n * @class saxParser\n */\ncc.SAXParser = function () {\n    if (!(CC_EDITOR && Editor.isMainProcess) && window.DOMParser) {\n        this._isSupportDOMParser = true;\n        this._parser = new DOMParser();\n    } else {\n        this._isSupportDOMParser = false;\n        this._parser = null;\n    }\n};\ncc.SAXParser.prototype = {\n    constructor: cc.SAXParser,\n    /**\n     * @method parse\n     * @param {String} xmlTxt\n     * @return {Document}\n     */\n    parse : function(xmlTxt){\n        return this._parseXML(xmlTxt);\n    },\n\n    _parseXML: function (textxml) {\n        // get a reference to the requested corresponding xml file\n        var xmlDoc;\n        if (this._isSupportDOMParser) {\n            xmlDoc = this._parser.parseFromString(textxml, \"text/xml\");\n        } else {\n            // Internet Explorer (untested!)\n            xmlDoc = new ActiveXObject(\"Microsoft.XMLDOM\");\n            xmlDoc.async = \"false\";\n            xmlDoc.loadXML(textxml);\n        }\n        return xmlDoc;\n    }\n};\n\n/**\n *\n * cc.plistParser is a singleton object for parsing plist files\n * @class plistParser\n * @extends SAXParser\n */\ncc.PlistParser = function () {\n    cc.SAXParser.call(this);\n};\njs.extend(cc.PlistParser, cc.SAXParser);\njs.mixin(cc.PlistParser.prototype, {\n    /**\n     * parse a xml string as plist object.\n     * @param {String} xmlTxt - plist xml contents\n     * @return {*} plist object\n     */\n    parse : function (xmlTxt) {\n        var xmlDoc = this._parseXML(xmlTxt);\n        var plist = xmlDoc.documentElement;\n        if (plist.tagName !== 'plist') {\n            cc.warnID(5100);\n            return {};\n        }\n\n        // Get first real node\n        var node = null;\n        for (var i = 0, len = plist.childNodes.length; i < len; i++) {\n            node = plist.childNodes[i];\n            if (node.nodeType === 1)\n                break;\n        }\n        xmlDoc = null;\n        return this._parseNode(node);\n    },\n\n    _parseNode: function (node) {\n        var data = null, tagName = node.tagName;\n        if(tagName === \"dict\"){\n            data = this._parseDict(node);\n        }else if(tagName === \"array\"){\n            data = this._parseArray(node);\n        }else if(tagName === \"string\"){\n            if (node.childNodes.length === 1)\n                data = node.firstChild.nodeValue;\n            else {\n                //handle Firefox's 4KB nodeValue limit\n                data = \"\";\n                for (var i = 0; i < node.childNodes.length; i++)\n                    data += node.childNodes[i].nodeValue;\n            }\n        }else if(tagName === \"false\"){\n            data = false;\n        }else if(tagName === \"true\"){\n            data = true;\n        }else if(tagName === \"real\"){\n            data = parseFloat(node.firstChild.nodeValue);\n        }else if(tagName === \"integer\"){\n            data = parseInt(node.firstChild.nodeValue, 10);\n        }\n        return data;\n    },\n\n    _parseArray: function (node) {\n        var data = [];\n        for (var i = 0, len = node.childNodes.length; i < len; i++) {\n            var child = node.childNodes[i];\n            if (child.nodeType !== 1)\n                continue;\n            data.push(this._parseNode(child));\n        }\n        return data;\n    },\n\n    _parseDict: function (node) {\n        var data = {};\n        var key = null;\n        for (var i = 0, len = node.childNodes.length; i < len; i++) {\n            var child = node.childNodes[i];\n            if (child.nodeType !== 1)\n                continue;\n\n            // Grab the key, next noe should be the value\n            if (child.tagName === 'key')\n                key = child.firstChild.nodeValue;\n            else\n                data[key] = this._parseNode(child);                 // Parse the value node\n        }\n        return data;\n    }\n});\n\ncc.saxParser = new cc.SAXParser();\n/**\n * @type {PlistParser}\n * @name plistParser\n * A Plist Parser\n */\ncc.plistParser = new cc.PlistParser();\n\nmodule.exports = {\n    saxParser: cc.saxParser,\n    plistParser: cc.plistParser\n}\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n \n http://www.cocos2d-x.org\n \n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n \n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n \n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * The fullscreen API provides an easy way for web content to be presented using the user's entire screen.\n * It's invalid on safari, QQbrowser and android browser\n * @class screen\n */\ncc.screen = /** @lends cc.screen# */{\n    _supportsFullScreen: false,\n    _onfullscreenchange: null,\n    _onfullscreenerror: null,\n    // the pre fullscreenchange function\n    _preOnFullScreenChange: null,\n    _preOnFullScreenError: null,\n    _preOnTouch: null,\n    _touchEvent: \"\",\n    _fn: null,\n    // Function mapping for cross browser support\n    _fnMap: [\n        [\n            'requestFullscreen',\n            'exitFullscreen',\n            'fullscreenchange',\n            'fullscreenEnabled',\n            'fullscreenElement',\n            'fullscreenerror',\n        ],\n        [\n            'requestFullScreen',\n            'exitFullScreen',\n            'fullScreenchange',\n            'fullScreenEnabled',\n            'fullScreenElement',\n            'fullscreenerror',\n        ],\n        [\n            'webkitRequestFullScreen',\n            'webkitCancelFullScreen',\n            'webkitfullscreenchange',\n            'webkitIsFullScreen',\n            'webkitCurrentFullScreenElement',\n            'webkitfullscreenerror',\n        ],\n        [\n            'mozRequestFullScreen',\n            'mozCancelFullScreen',\n            'mozfullscreenchange',\n            'mozFullScreen',\n            'mozFullScreenElement',\n            'mozfullscreenerror',\n        ],\n        [\n            'msRequestFullscreen',\n            'msExitFullscreen',\n            'MSFullscreenChange',\n            'msFullscreenEnabled',\n            'msFullscreenElement',\n            'msfullscreenerror',\n        ]\n    ],\n    \n    /**\n     * initialize\n     * @method init\n     */\n    init: function () {\n        this._fn = {};\n        var i, l, val, map = this._fnMap, valL;\n        for (i = 0, l = map.length; i < l; i++) {\n            val = map[i];\n            if (val && (typeof document[val[1]] !== 'undefined')) {\n                for (i = 0, valL = val.length; i < valL; i++) {\n                    this._fn[map[0][i]] = val[i];\n                }\n                break;\n            }\n        }\n\n        this._supportsFullScreen = (this._fn.requestFullscreen !== undefined);\n\n        // Bug fix only for v2.1, don't merge into v2.0\n        // In v2.0, screen touchend events conflict with editBox touchend events if it's not stayOnTop.\n        // While in v2.1, editBox always keep stayOnTop and it doesn't support touchend events.\n        this._touchEvent = ('ontouchend' in window) ? 'touchend' : 'mousedown';\n    },\n    \n    /**\n     * return true if it's full now.\n     * @method fullScreen\n     * @returns {Boolean}\n     */\n    fullScreen: function () {\n        if (!this._supportsFullScreen) return false;\n        else if (!document[this._fn.fullscreenElement] && !document[this._fn.webkitFullscreenElement] && !document[this._fn.mozFullScreenElement]) {\n            return false;\n        }\n        else {\n            return true;\n        }\n    },\n    \n    /**\n     * change the screen to full mode.\n     * @method requestFullScreen\n     * @param {Element} element\n     * @param {Function} onFullScreenChange\n     * @param {Function} onFullScreenError\n     */\n    requestFullScreen: function (element, onFullScreenChange, onFullScreenError) {\n        if (element && element.tagName.toLowerCase() === \"video\") {\n            if (cc.sys.os === cc.sys.OS_IOS && cc.sys.isBrowser && element.readyState > 0) {\n                element.webkitEnterFullscreen && element.webkitEnterFullscreen();\n                return;\n            }\n            else {\n                element.setAttribute(\"x5-video-player-fullscreen\", \"true\");\n            }\n        }\n\n        if (!this._supportsFullScreen) {\n            return;\n        }\n\n        element = element || document.documentElement;\n\n        if (onFullScreenChange) {\n            let eventName = this._fn.fullscreenchange;\n            if (this._onfullscreenchange) {\n                document.removeEventListener(eventName, this._onfullscreenchange);\n            }\n            this._onfullscreenchange = onFullScreenChange;\n            document.addEventListener(eventName, onFullScreenChange, false);\n        }\n        if (onFullScreenError) {\n            let eventName = this._fn.fullscreenerror;\n            if (this._onfullscreenerror) {\n                document.removeEventListener(eventName, this._onfullscreenerror);\n            }\n            this._onfullscreenerror = onFullScreenError;\n            document.addEventListener(eventName, onFullScreenError, { once: true });\n        }\n\n        element[this._fn.requestFullscreen]();\n    },\n    \n    /**\n     * exit the full mode.\n     * @method exitFullScreen\n     * @return {Boolean}\n     */\n    exitFullScreen: function (element) {\n        if (element && element.tagName.toLowerCase() === \"video\") {\n            if (cc.sys.os === cc.sys.OS_IOS && cc.sys.isBrowser) {\n                element.webkitExitFullscreen && element.webkitExitFullscreen();\n                return;\n            }\n            else {\n                element.setAttribute(\"x5-video-player-fullscreen\", \"false\");\n            }\n        }\n        return this._supportsFullScreen ? document[this._fn.exitFullscreen]() : true;\n    },\n    \n    /**\n     * Automatically request full screen with a touch/click event\n     * @method autoFullScreen\n     * @param {Element} element\n     * @param {Function} onFullScreenChange\n     */\n    autoFullScreen: function (element, onFullScreenChange) {\n        element = element || document.body;\n\n        this._ensureFullScreen(element, onFullScreenChange);\n        this.requestFullScreen(element, onFullScreenChange);\n    },\n\n    disableAutoFullScreen (element) {\n        let touchTarget = cc.game.canvas || element;\n        let touchEventName = this._touchEvent;\n        if (this._preOnTouch) {\n            touchTarget.removeEventListener(touchEventName, this._preOnTouch);\n            this._preOnTouch = null;\n        }\n    },\n\n    // Register touch event if request full screen failed\n    _ensureFullScreen (element, onFullScreenChange) {\n        let self = this;\n        let touchTarget = cc.game.canvas || element;\n        let fullScreenErrorEventName = this._fn.fullscreenerror;\n        if (typeof document[fullScreenErrorEventName] === \"undefined\") return;\n        let touchEventName = this._touchEvent;\n        \n        function onFullScreenError () {\n            self._preOnFullScreenError = null;\n\n            // handle touch event listener\n            function onTouch() {\n                self._preOnTouch = null;\n                self.requestFullScreen(element, onFullScreenChange);\n            }\n            if (self._preOnTouch) {\n                touchTarget.removeEventListener(touchEventName, self._preOnTouch);\n            }\n            self._preOnTouch = onTouch;\n            touchTarget.addEventListener(touchEventName, self._preOnTouch, { once: true });\n        }\n\n        // handle full screen error\n        if (this._preOnFullScreenError) {\n            element.removeEventListener(fullScreenErrorEventName, this._preOnFullScreenError);\n        }\n        this._preOnFullScreenError = onFullScreenError;\n        element.addEventListener(fullScreenErrorEventName, onFullScreenError, { once: true });\n    },\n};\ncc.screen.init();\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nlet settingPlatform;\n if (!CC_EDITOR) {\n    settingPlatform = window._CCSettings ? _CCSettings.platform: undefined;\n }\nconst isVivoGame = (settingPlatform === 'qgame');\nconst isOppoGame = (settingPlatform === 'quickgame');\nconst isHuaweiGame = (settingPlatform === 'huawei');\nconst isJKWGame = (settingPlatform === 'jkw-game');\nconst isQttGame = (settingPlatform === 'qtt-game');\n\nconst _global = typeof window === 'undefined' ? global : window;\n \nfunction initSys () {\n    /**\n     * System variables\n     * @class sys\n     * @main\n     * @static\n     */\n    cc.sys = {};\n    var sys = cc.sys;\n\n    /**\n     * English language code\n     * @property {String} LANGUAGE_ENGLISH\n     * @readOnly\n     */\n    sys.LANGUAGE_ENGLISH = \"en\";\n\n    /**\n     * Chinese language code\n     * @property {String} LANGUAGE_CHINESE\n     * @readOnly\n     */\n    sys.LANGUAGE_CHINESE = \"zh\";\n\n    /**\n     * French language code\n     * @property {String} LANGUAGE_FRENCH\n     * @readOnly\n     */\n    sys.LANGUAGE_FRENCH = \"fr\";\n\n    /**\n     * Italian language code\n     * @property {String} LANGUAGE_ITALIAN\n     * @readOnly\n     */\n    sys.LANGUAGE_ITALIAN = \"it\";\n\n    /**\n     * German language code\n     * @property {String} LANGUAGE_GERMAN\n     * @readOnly\n     */\n    sys.LANGUAGE_GERMAN = \"de\";\n\n    /**\n     * Spanish language code\n     * @property {String} LANGUAGE_SPANISH\n     * @readOnly\n     */\n    sys.LANGUAGE_SPANISH = \"es\";\n\n    /**\n     * Spanish language code\n     * @property {String} LANGUAGE_DUTCH\n     * @readOnly\n     */\n    sys.LANGUAGE_DUTCH = \"du\";\n\n    /**\n     * Russian language code\n     * @property {String} LANGUAGE_RUSSIAN\n     * @readOnly\n     */\n    sys.LANGUAGE_RUSSIAN = \"ru\";\n\n    /**\n     * Korean language code\n     * @property {String} LANGUAGE_KOREAN\n     * @readOnly\n     */\n    sys.LANGUAGE_KOREAN = \"ko\";\n\n    /**\n     * Japanese language code\n     * @property {String} LANGUAGE_JAPANESE\n     * @readOnly\n     */\n    sys.LANGUAGE_JAPANESE = \"ja\";\n\n    /**\n     * Hungarian language code\n     * @property {String} LANGUAGE_HUNGARIAN\n     * @readonly\n     */\n    sys.LANGUAGE_HUNGARIAN = \"hu\";\n\n    /**\n     * Portuguese language code\n     * @property {String} LANGUAGE_PORTUGUESE\n     * @readOnly\n     */\n    sys.LANGUAGE_PORTUGUESE = \"pt\";\n\n    /**\n     * Arabic language code\n     * @property {String} LANGUAGE_ARABIC\n     * @readOnly\n     */\n    sys.LANGUAGE_ARABIC = \"ar\";\n\n    /**\n     * Norwegian language code\n     * @property {String} LANGUAGE_NORWEGIAN\n     * @readOnly\n     */\n    sys.LANGUAGE_NORWEGIAN = \"no\";\n\n    /**\n     * Polish language code\n     * @property {String} LANGUAGE_POLISH\n     * @readOnly\n     */\n    sys.LANGUAGE_POLISH = \"pl\";\n\n    /**\n     * Turkish language code\n     * @property {String} LANGUAGE_TURKISH\n     * @readOnly\n     */\n    sys.LANGUAGE_TURKISH = \"tr\";\n\n    /**\n     * Ukrainian language code\n     * @property {String} LANGUAGE_UKRAINIAN\n     * @readOnly\n     */\n    sys.LANGUAGE_UKRAINIAN = \"uk\";\n\n    /**\n     * Romanian language code\n     * @property {String} LANGUAGE_ROMANIAN\n     * @readOnly\n     */\n    sys.LANGUAGE_ROMANIAN = \"ro\";\n\n    /**\n     * Bulgarian language code\n     * @property {String} LANGUAGE_BULGARIAN\n     * @readOnly\n     */\n    sys.LANGUAGE_BULGARIAN = \"bg\";\n\n    /**\n     * Unknown language code\n     * @property {String} LANGUAGE_UNKNOWN\n     * @readOnly\n     */\n    sys.LANGUAGE_UNKNOWN = \"unknown\";\n\n    /**\n     * @property {String} OS_IOS\n     * @readOnly\n     */\n    sys.OS_IOS = \"iOS\";\n    /**\n     * @property {String} OS_ANDROID\n     * @readOnly\n     */\n    sys.OS_ANDROID = \"Android\";\n    /**\n     * @property {String} OS_WINDOWS\n     * @readOnly\n     */\n    sys.OS_WINDOWS = \"Windows\";\n    /**\n     * @property {String} OS_MARMALADE\n     * @readOnly\n     */\n    sys.OS_MARMALADE = \"Marmalade\";\n    /**\n     * @property {String} OS_LINUX\n     * @readOnly\n     */\n    sys.OS_LINUX = \"Linux\";\n    /**\n     * @property {String} OS_BADA\n     * @readOnly\n     */\n    sys.OS_BADA = \"Bada\";\n    /**\n     * @property {String} OS_BLACKBERRY\n     * @readOnly\n     */\n    sys.OS_BLACKBERRY = \"Blackberry\";\n    /**\n     * @property {String} OS_OSX\n     * @readOnly\n     */\n    sys.OS_OSX = \"OS X\";\n    /**\n     * @property {String} OS_WP8\n     * @readOnly\n     */\n    sys.OS_WP8 = \"WP8\";\n    /**\n     * @property {String} OS_WINRT\n     * @readOnly\n     */\n    sys.OS_WINRT = \"WINRT\";\n    /**\n     * @property {String} OS_UNKNOWN\n     * @readOnly\n     */\n    sys.OS_UNKNOWN = \"Unknown\";\n\n    /**\n     * @property {Number} UNKNOWN\n     * @readOnly\n     * @default -1\n     */\n    sys.UNKNOWN = -1;\n    /**\n     * @property {Number} WIN32\n     * @readOnly\n     * @default 0\n     */\n    sys.WIN32 = 0;\n    /**\n     * @property {Number} LINUX\n     * @readOnly\n     * @default 1\n     */\n    sys.LINUX = 1;\n    /**\n     * @property {Number} MACOS\n     * @readOnly\n     * @default 2\n     */\n    sys.MACOS = 2;\n    /**\n     * @property {Number} ANDROID\n     * @readOnly\n     * @default 3\n     */\n    sys.ANDROID = 3;\n    /**\n     * @property {Number} IPHONE\n     * @readOnly\n     * @default 4\n     */\n    sys.IPHONE = 4;\n    /**\n     * @property {Number} IPAD\n     * @readOnly\n     * @default 5\n     */\n    sys.IPAD = 5;\n    /**\n     * @property {Number} BLACKBERRY\n     * @readOnly\n     * @default 6\n     */\n    sys.BLACKBERRY = 6;\n    /**\n     * @property {Number} NACL\n     * @readOnly\n     * @default 7\n     */\n    sys.NACL = 7;\n    /**\n     * @property {Number} EMSCRIPTEN\n     * @readOnly\n     * @default 8\n     */\n    sys.EMSCRIPTEN = 8;\n    /**\n     * @property {Number} TIZEN\n     * @readOnly\n     * @default 9\n     */\n    sys.TIZEN = 9;\n    /**\n     * @property {Number} WINRT\n     * @readOnly\n     * @default 10\n     */\n    sys.WINRT = 10;\n    /**\n     * @property {Number} WP8\n     * @readOnly\n     * @default 11\n     */\n    sys.WP8 = 11;\n    /**\n     * @property {Number} MOBILE_BROWSER\n     * @readOnly\n     * @default 100\n     */\n    sys.MOBILE_BROWSER = 100;\n    /**\n     * @property {Number} DESKTOP_BROWSER\n     * @readOnly\n     * @default 101\n     */\n    sys.DESKTOP_BROWSER = 101;\n\n    /**\n     * Indicates whether executes in editor's window process (Electron's renderer context)\n     * @property {Number} EDITOR_PAGE\n     * @readOnly\n     * @default 102\n     */\n    sys.EDITOR_PAGE = 102;\n    /**\n     * Indicates whether executes in editor's main process (Electron's browser context)\n     * @property {Number} EDITOR_CORE\n     * @readOnly\n     * @default 103\n     */\n    sys.EDITOR_CORE = 103;\n    /**\n     * @property {Number} WECHAT_GAME\n     * @readOnly\n     * @default 104\n     */\n    sys.WECHAT_GAME = 104;\n    /**\n     * @property {Number} QQ_PLAY\n     * @readOnly\n     * @default 105\n     */\n    sys.QQ_PLAY = 105;\n    /**\n     * @property {Number} FB_PLAYABLE_ADS\n     * @readOnly\n     * @default 106\n     */\n    sys.FB_PLAYABLE_ADS = 106;\n    /**\n     * @property {Number} BAIDU_GAME\n     * @readOnly\n     * @default 107\n     */\n    sys.BAIDU_GAME = 107;\n    /**\n     * @property {Number} VIVO_GAME\n     * @readOnly\n     * @default 108\n     */\n    sys.VIVO_GAME = 108;\n    /**\n     * @property {Number} OPPO_GAME\n     * @readOnly\n     * @default 109\n     */\n    sys.OPPO_GAME = 109;\n    /**\n     * @property {Number} HUAWEI_GAME\n     * @readOnly\n     * @default 110\n     */\n    sys.HUAWEI_GAME = 110;\n    /**\n     * @property {Number} XIAOMI_GAME\n     * @readOnly\n     * @default 111\n     */\n    sys.XIAOMI_GAME = 111;\n    /**\n     * @property {Number} JKW_GAME\n     * @readOnly\n     * @default 112\n     */\n    sys.JKW_GAME = 112;\n    /**\n     * @property {Number} ALIPAY_GAME\n     * @readOnly\n     * @default 113\n     */\n    sys.ALIPAY_GAME = 113;\n    /**\n     * @property {Number} WECHAT_GAME_SUB\n     * @readOnly\n     * @default 114\n     */\n    sys.WECHAT_GAME_SUB = 114;\n    /**\n     * @property {Number} BAIDU_GAME_SUB\n     * @readOnly\n     * @default 115\n     */\n    sys.BAIDU_GAME_SUB = 115;\n    /**\n     * @property {Number} QTT_GAME\n     * @readOnly\n     * @default 116\n     */\n    sys.QTT_GAME = 116;\n    /**\n     * BROWSER_TYPE_WECHAT\n     * @property {String} BROWSER_TYPE_WECHAT\n     * @readOnly\n     * @default \"wechat\"\n     */\n    sys.BROWSER_TYPE_WECHAT = \"wechat\";\n    /**\n     * BROWSER_TYPE_WECHAT_GAME\n     * @property {String} BROWSER_TYPE_WECHAT_GAME\n     * @readOnly\n     * @default \"wechatgame\"\n     */\n    sys.BROWSER_TYPE_WECHAT_GAME = \"wechatgame\";\n    /**\n     * BROWSER_TYPE_WECHAT_GAME_SUB\n     * @property {String} BROWSER_TYPE_WECHAT_GAME_SUB\n     * @readOnly\n     * @default \"wechatgamesub\"\n     */\n    sys.BROWSER_TYPE_WECHAT_GAME_SUB = \"wechatgamesub\";\n    /**\n     * BROWSER_TYPE_BAIDU_GAME\n     * @property {String} BROWSER_TYPE_BAIDU_GAME\n     * @readOnly\n     * @default \"baidugame\"\n     */\n    sys.BROWSER_TYPE_BAIDU_GAME = \"baidugame\";\n    /**\n     * BROWSER_TYPE_BAIDU_GAME_SUB\n     * @property {String} BROWSER_TYPE_BAIDU_GAME_SUB\n     * @readOnly\n     * @default \"baidugamesub\"\n     */\n    sys.BROWSER_TYPE_BAIDU_GAME_SUB = \"baidugamesub\";\n    /**\n     * BROWSER_TYPE_XIAOMI_GAME\n     * @property {String} BROWSER_TYPE_XIAOMI_GAME\n     * @readOnly\n     * @default \"xiaomigame\"\n     */\n    sys.BROWSER_TYPE_XIAOMI_GAME = \"xiaomigame\";\n    /**\n     * BROWSER_TYPE_ALIPAY_GAME\n     * @property {String} BROWSER_TYPE_ALIPAY_GAME\n     * @readOnly\n     * @default \"alipaygame\"\n     */\n    sys.BROWSER_TYPE_ALIPAY_GAME = \"alipaygame\";\n    /**\n     * BROWSER_TYPE_QQ_PLAY\n     * @property {String} BROWSER_TYPE_QQ_PLAY\n     * @readOnly\n     * @default \"qqplay\"\n     */\n    sys.BROWSER_TYPE_QQ_PLAY = \"qqplay\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_ANDROID\n     * @readOnly\n     * @default \"androidbrowser\"\n     */\n    sys.BROWSER_TYPE_ANDROID = \"androidbrowser\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_IE\n     * @readOnly\n     * @default \"ie\"\n     */\n    sys.BROWSER_TYPE_IE = \"ie\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_EDGE\n     * @readOnly\n     * @default \"edge\"\n     */\n    sys.BROWSER_TYPE_EDGE = \"edge\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_QQ\n     * @readOnly\n     * @default \"qqbrowser\"\n     */\n    sys.BROWSER_TYPE_QQ = \"qqbrowser\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_MOBILE_QQ\n     * @readOnly\n     * @default \"mqqbrowser\"\n     */\n    sys.BROWSER_TYPE_MOBILE_QQ = \"mqqbrowser\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_UC\n     * @readOnly\n     * @default \"ucbrowser\"\n     */\n    sys.BROWSER_TYPE_UC = \"ucbrowser\";\n    /**\n     * uc third party integration.\n     * @property {String} BROWSER_TYPE_UCBS\n     * @readOnly\n     * @default \"ucbs\"\n     */\n    sys.BROWSER_TYPE_UCBS = \"ucbs\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_360\n     * @readOnly\n     * @default \"360browser\"\n     */\n    sys.BROWSER_TYPE_360 = \"360browser\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_BAIDU_APP\n     * @readOnly\n     * @default \"baiduboxapp\"\n     */\n    sys.BROWSER_TYPE_BAIDU_APP = \"baiduboxapp\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_BAIDU\n     * @readOnly\n     * @default \"baidubrowser\"\n     */\n    sys.BROWSER_TYPE_BAIDU = \"baidubrowser\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_MAXTHON\n     * @readOnly\n     * @default \"maxthon\"\n     */\n    sys.BROWSER_TYPE_MAXTHON = \"maxthon\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_OPERA\n     * @readOnly\n     * @default \"opera\"\n     */\n    sys.BROWSER_TYPE_OPERA = \"opera\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_OUPENG\n     * @readOnly\n     * @default \"oupeng\"\n     */\n    sys.BROWSER_TYPE_OUPENG = \"oupeng\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_MIUI\n     * @readOnly\n     * @default \"miuibrowser\"\n     */\n    sys.BROWSER_TYPE_MIUI = \"miuibrowser\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_FIREFOX\n     * @readOnly\n     * @default \"firefox\"\n     */\n    sys.BROWSER_TYPE_FIREFOX = \"firefox\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_SAFARI\n     * @readOnly\n     * @default \"safari\"\n     */\n    sys.BROWSER_TYPE_SAFARI = \"safari\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_CHROME\n     * @readOnly\n     * @default \"chrome\"\n     */\n    sys.BROWSER_TYPE_CHROME = \"chrome\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_LIEBAO\n     * @readOnly\n     * @default \"liebao\"\n     */\n    sys.BROWSER_TYPE_LIEBAO = \"liebao\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_QZONE\n     * @readOnly\n     * @default \"qzone\"\n     */\n    sys.BROWSER_TYPE_QZONE = \"qzone\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_SOUGOU\n     * @readOnly\n     * @default \"sogou\"\n     */\n    sys.BROWSER_TYPE_SOUGOU = \"sogou\";\n    /**\n     *\n     * @property {String} BROWSER_TYPE_UNKNOWN\n     * @readOnly\n     * @default \"unknown\"\n     */\n    sys.BROWSER_TYPE_UNKNOWN = \"unknown\";\n\n    /**\n     * Is native ? This is set to be true in jsb auto.\n     * @property {Boolean} isNative\n     */\n    sys.isNative = CC_JSB || CC_RUNTIME;\n\n\n    /**\n     * Is web browser ?\n     * @property {Boolean} isBrowser\n     */\n    sys.isBrowser = typeof window === 'object' && typeof document === 'object' && !CC_JSB && !CC_RUNTIME;\n\n    /**\n     * Is webgl extension support?\n     * @method glExtension\n     * @param name\n     */\n    sys.glExtension = function (name) {\n        return !!cc.renderer.device.ext(name);\n    }\n\n    /**\n     * Get max joint matrix size for skinned mesh renderer.\n     * @method getMaxJointMatrixSize\n     */\n    sys.getMaxJointMatrixSize = function () {\n        if (!sys._maxJointMatrixSize) {\n            const JOINT_MATRICES_SIZE = 50;\n            const LEFT_UNIFORM_SIZE = 10;\n\n            let gl = cc.game._renderContext;\n            let maxUniforms = Math.floor(gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS) / 4) - LEFT_UNIFORM_SIZE;\n            if (maxUniforms < JOINT_MATRICES_SIZE) {\n                sys._maxJointMatrixSize = 0;\n            }\n            else {\n                sys._maxJointMatrixSize = JOINT_MATRICES_SIZE;\n            }\n        }\n        return sys._maxJointMatrixSize;\n    }\n\n    if (_global.__globalAdapter && _global.__globalAdapter.adaptSys) {\n        // init sys info in adapter\n        _global.__globalAdapter.adaptSys(sys);\n    }\n    else if (CC_EDITOR && Editor.isMainProcess) {\n        sys.isMobile = false;\n        sys.platform = sys.EDITOR_CORE;\n        sys.language = sys.LANGUAGE_UNKNOWN;\n        sys.languageCode = undefined;\n        sys.os = ({\n            darwin: sys.OS_OSX,\n            win32: sys.OS_WINDOWS,\n            linux: sys.OS_LINUX\n        })[process.platform] || sys.OS_UNKNOWN;\n        sys.browserType = null;\n        sys.browserVersion = null;\n        sys.windowPixelResolution = {\n            width: 0,\n            height: 0\n        };\n        sys.__audioSupport = {};\n    }\n    else if (CC_JSB || CC_RUNTIME) {\n        let platform;\n        if (isVivoGame) {\n            platform = sys.VIVO_GAME;\n        } else if (isOppoGame) {\n            platform = sys.OPPO_GAME;\n        } else if (isHuaweiGame) {\n            platform = sys.HUAWEI_GAME;\n        } else if (isJKWGame) {\n            platform = sys.JKW_GAME;\n        } else if (isQttGame) {\n            platform = sys.QTT_GAME;\n        }\n        else {\n            platform = __getPlatform();\n        }\n        sys.platform = platform;\n        sys.isMobile = (platform === sys.ANDROID ||\n                        platform === sys.IPAD ||\n                        platform === sys.IPHONE ||\n                        platform === sys.WP8 ||\n                        platform === sys.TIZEN ||\n                        platform === sys.BLACKBERRY ||\n                        platform === sys.XIAOMI_GAME ||\n                        isVivoGame ||\n                        isOppoGame ||\n                        isHuaweiGame ||\n                        isJKWGame ||\n                        isQttGame);\n\n        sys.os = __getOS();\n        sys.language = __getCurrentLanguage();\n        var languageCode; \n        if (CC_JSB) {\n            languageCode = __getCurrentLanguageCode();\n        }\n        sys.languageCode = languageCode ? languageCode.toLowerCase() : undefined;\n        sys.osVersion = __getOSVersion();\n        sys.osMainVersion = parseInt(sys.osVersion);\n        sys.browserType = null;\n        sys.browserVersion = null;\n\n        var w = window.innerWidth;\n        var h = window.innerHeight;\n        var ratio = window.devicePixelRatio || 1;\n        sys.windowPixelResolution = {\n            width: ratio * w,\n            height: ratio * h\n        };\n\n        sys.localStorage = window.localStorage;\n\n        var capabilities;\n        capabilities = sys.capabilities = {\n            \"canvas\": false,\n            \"opengl\": true,\n            \"webp\": true,\n        };\n\n       if (sys.isMobile) {\n            capabilities[\"accelerometer\"] = true;\n            capabilities[\"touches\"] = true;\n        } else {\n            // desktop\n            capabilities[\"keyboard\"] = true;\n            capabilities[\"mouse\"] = true;\n            capabilities[\"touches\"] = false;\n        }\n\n        sys.__audioSupport = {\n            ONLY_ONE: false,\n            WEB_AUDIO: false,\n            DELAY_CREATE_CTX: false,\n            format: ['.mp3']\n        };\n    }\n    else {\n        // browser or runtime\n        var win = window, nav = win.navigator, doc = document, docEle = doc.documentElement;\n        var ua = nav.userAgent.toLowerCase();\n\n        if (CC_EDITOR) {\n            sys.isMobile = false;\n            sys.platform = sys.EDITOR_PAGE;\n        }\n        else {\n            /**\n             * Indicate whether system is mobile system\n             * @property {Boolean} isMobile\n             */\n            sys.isMobile = /mobile|android|iphone|ipad/.test(ua);\n\n            /**\n             * Indicate the running platform\n             * @property {Number} platform\n             */\n            if (typeof FbPlayableAd !== \"undefined\") {\n                sys.platform = sys.FB_PLAYABLE_ADS;\n            }\n            else {\n                sys.platform = sys.isMobile ? sys.MOBILE_BROWSER : sys.DESKTOP_BROWSER;\n            }\n        }\n\n        var currLanguage = nav.language;\n        currLanguage = currLanguage ? currLanguage : nav.browserLanguage;\n\n        /**\n         * Get current language iso 639-1 code.\n         * Examples of valid language codes include \"zh-tw\", \"en\", \"en-us\", \"fr\", \"fr-fr\", \"es-es\", etc.\n         * The actual value totally depends on results provided by destination platform.\n         * @property {String} languageCode\n         */\n        sys.languageCode = currLanguage.toLowerCase();\n\n        currLanguage = currLanguage ? currLanguage.split(\"-\")[0] : sys.LANGUAGE_ENGLISH;\n\n        /**\n         * Indicate the current language of the running system\n         * @property {String} language\n         */\n        sys.language = currLanguage;\n\n        // Get the os of system\n        var isAndroid = false, iOS = false, osVersion = '', osMainVersion = 0;\n        var uaResult = /android (\\d+(?:\\.\\d+)*)/i.exec(ua) || /android (\\d+(?:\\.\\d+)*)/i.exec(nav.platform);\n        if (uaResult) {\n            isAndroid = true;\n            osVersion = uaResult[1] || '';\n            osMainVersion = parseInt(osVersion) || 0;\n        }\n        uaResult = /(iPad|iPhone|iPod).*OS ((\\d+_?){2,3})/i.exec(ua);\n        if (uaResult) {\n            iOS = true;\n            osVersion = uaResult[2] || '';\n            osMainVersion = parseInt(osVersion) || 0;\n        }\n        // refer to https://github.com/cocos-creator/engine/pull/5542 , thanks for contribition from @krapnikkk\n        // ipad OS 13 safari identifies itself as \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15) AppleWebKit/605.1.15 (KHTML, like Gecko)\" \n        // so use maxTouchPoints to check whether it's desktop safari or not. \n        // reference: https://stackoverflow.com/questions/58019463/how-to-detect-device-name-in-safari-on-ios-13-while-it-doesnt-show-the-correct\n        // FIXME: should remove it when touch-enabled macs are available\n        else if (/(iPhone|iPad|iPod)/.exec(nav.platform) || (nav.platform === 'MacIntel' && nav.maxTouchPoints && nav.maxTouchPoints > 1)) { \n            iOS = true;\n            osVersion = '';\n            osMainVersion = 0;\n        }\n\n        var osName = sys.OS_UNKNOWN;\n        if (nav.appVersion.indexOf(\"Win\") !== -1) osName = sys.OS_WINDOWS;\n        else if (iOS) osName = sys.OS_IOS;\n        else if (nav.appVersion.indexOf(\"Mac\") !== -1) osName = sys.OS_OSX;\n        else if (nav.appVersion.indexOf(\"X11\") !== -1 && nav.appVersion.indexOf(\"Linux\") === -1) osName = sys.OS_UNIX;\n        else if (isAndroid) osName = sys.OS_ANDROID;\n        else if (nav.appVersion.indexOf(\"Linux\") !== -1 || ua.indexOf(\"ubuntu\") !== -1) osName = sys.OS_LINUX;\n\n        /**\n         * Indicate the running os name\n         * @property {String} os\n         */\n        sys.os = osName;\n        /**\n         * Indicate the running os version\n         * @property {String} osVersion\n         */\n        sys.osVersion = osVersion;\n        /**\n         * Indicate the running os main version\n         * @property {Number} osMainVersion\n         */\n        sys.osMainVersion = osMainVersion;\n\n        /**\n         * Indicate the running browser type\n         * @property {String} browserType\n         */\n        sys.browserType = sys.BROWSER_TYPE_UNKNOWN;\n        /* Determine the browser type */\n        (function(){\n            var typeReg1 = /mqqbrowser|micromessenger|qqbrowser|sogou|qzone|liebao|maxthon|ucbs|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|miuibrowser/i;\n            var typeReg2 = /qq|ucbrowser|ubrowser|edge/i;\n            var typeReg3 = /chrome|safari|firefox|trident|opera|opr\\/|oupeng/i;\n            var browserTypes = typeReg1.exec(ua) || typeReg2.exec(ua) || typeReg3.exec(ua);\n\n            var browserType = browserTypes ? browserTypes[0].toLowerCase() : sys.BROWSER_TYPE_UNKNOWN;\n\n            if (browserType === \"safari\" && isAndroid)\n                browserType = sys.BROWSER_TYPE_ANDROID;\n            else if (browserType === \"qq\" && ua.match(/android.*applewebkit/i))\n                browserType = sys.BROWSER_TYPE_ANDROID;\n            let typeMap = {\n                'micromessenger': sys.BROWSER_TYPE_WECHAT,\n                'trident': sys.BROWSER_TYPE_IE,\n                'edge': sys.BROWSER_TYPE_EDGE,\n                '360 aphone': sys.BROWSER_TYPE_360,\n                'mxbrowser': sys.BROWSER_TYPE_MAXTHON,\n                'opr/': sys.BROWSER_TYPE_OPERA,\n                'ubrowser': sys.BROWSER_TYPE_UC\n            };\n            \n            sys.browserType = typeMap[browserType] || browserType;\n        })();\n\n        /**\n         * Indicate the running browser version\n         * @property {String} browserVersion\n         */\n        sys.browserVersion = \"\";\n        /* Determine the browser version number */\n        (function(){\n            var versionReg1 = /(mqqbrowser|micromessenger|qqbrowser|sogou|qzone|liebao|maxthon|uc|ucbs|360 aphone|360|baiduboxapp|baidu|maxthon|mxbrowser|miui(?:.hybrid)?)(mobile)?(browser)?\\/?([\\d.]+)/i;\n            var versionReg2 = /(qq|chrome|safari|firefox|trident|opera|opr\\/|oupeng)(mobile)?(browser)?\\/?([\\d.]+)/i;\n            var tmp = ua.match(versionReg1);\n            if(!tmp) tmp = ua.match(versionReg2);\n            sys.browserVersion = tmp ? tmp[4] : \"\";\n        })();\n\n        var w = window.innerWidth || document.documentElement.clientWidth;\n        var h = window.innerHeight || document.documentElement.clientHeight;\n        var ratio = window.devicePixelRatio || 1;\n\n        /**\n         * Indicate the real pixel resolution of the whole game window\n         * @property {Size} windowPixelResolution\n         */\n        sys.windowPixelResolution = {\n            width: ratio * w,\n            height: ratio * h\n        };\n\n        sys._checkWebGLRenderMode = function () {\n            if (cc.game.renderType !== cc.game.RENDER_TYPE_WEBGL)\n                throw new Error(\"This feature supports WebGL render mode only.\");\n        };\n\n        var _tmpCanvas1 = document.createElement(\"canvas\");\n\n        var create3DContext = function (canvas, opt_attribs, opt_contextType) {\n            if (opt_contextType) {\n                try {\n                    return canvas.getContext(opt_contextType, opt_attribs);\n                } catch (e) {\n                    return null;\n                }\n            }\n            else {\n                return create3DContext(canvas, opt_attribs, \"webgl\") ||\n                    create3DContext(canvas, opt_attribs, \"experimental-webgl\") ||\n                    create3DContext(canvas, opt_attribs, \"webkit-3d\") ||\n                    create3DContext(canvas, opt_attribs, \"moz-webgl\") ||\n                    null;\n            }\n        };\n\n        /**\n         * cc.sys.localStorage is a local storage component.\n         * @property {Object} localStorage\n         */\n        try {\n            var localStorage = sys.localStorage = win.localStorage;\n            localStorage.setItem(\"storage\", \"\");\n            localStorage.removeItem(\"storage\");\n            localStorage = null;\n        } catch (e) {\n            var warn = function () {\n                cc.warnID(5200);\n            };\n            sys.localStorage = {\n                getItem : warn,\n                setItem : warn,\n                removeItem : warn,\n                clear : warn\n            };\n        }\n\n        var _supportWebp = _tmpCanvas1.toDataURL('image/webp').startsWith('data:image/webp');\n        var _supportCanvas = !!_tmpCanvas1.getContext(\"2d\");\n        var _supportWebGL = false;\n        if (CC_TEST) {\n            _supportWebGL = false;\n        }\n        else if (win.WebGLRenderingContext) {\n            _supportWebGL = true;\n        }\n\n        /**\n         * The capabilities of the current platform\n         * @property {Object} capabilities\n         */\n        var capabilities = sys.capabilities = {\n            \"canvas\": _supportCanvas,\n            \"opengl\": _supportWebGL,\n            \"webp\": _supportWebp,\n        };\n        if (docEle['ontouchstart'] !== undefined || doc['ontouchstart'] !== undefined || nav.msPointerEnabled)\n            capabilities[\"touches\"] = true;\n        if (docEle['onmouseup'] !== undefined)\n            capabilities[\"mouse\"] = true;\n        if (docEle['onkeyup'] !== undefined)\n            capabilities[\"keyboard\"] = true;\n        if (win.DeviceMotionEvent || win.DeviceOrientationEvent)\n            capabilities[\"accelerometer\"] = true;\n\n        var __audioSupport;\n\n        /**\n         * Audio support in the browser\n         *\n         * MULTI_CHANNEL        : Multiple audio while playing - If it doesn't, you can only play background music\n         * WEB_AUDIO            : Support for WebAudio - Support W3C WebAudio standards, all of the audio can be played\n         * AUTOPLAY             : Supports auto-play audio - if Don‘t support it, On a touch detecting background music canvas, and then replay\n         * REPLAY_AFTER_TOUCH   : The first music will fail, must be replay after touchstart\n         * USE_EMPTIED_EVENT    : Whether to use the emptied event to replace load callback\n         * DELAY_CREATE_CTX     : delay created the context object - only webAudio\n         * NEED_MANUAL_LOOP     : loop attribute failure, need to perform loop manually\n         *\n         * May be modifications for a few browser version\n         */\n        (function(){\n\n            var DEBUG = false;\n\n            var version = sys.browserVersion;\n\n            // check if browser supports Web Audio\n            // check Web Audio's context\n            var supportWebAudio = !!(window.AudioContext || window.webkitAudioContext || window.mozAudioContext);\n\n            __audioSupport = { ONLY_ONE: false, WEB_AUDIO: supportWebAudio, DELAY_CREATE_CTX: false };\n\n            if (sys.os === sys.OS_IOS) {\n                // IOS no event that used to parse completed callback\n                // this time is not complete, can not play\n                //\n                __audioSupport.USE_LOADER_EVENT = 'loadedmetadata';\n            }\n\n            if (sys.browserType === sys.BROWSER_TYPE_FIREFOX) {\n                __audioSupport.DELAY_CREATE_CTX = true;\n                __audioSupport.USE_LOADER_EVENT = 'canplay';\n            }\n\n            if (sys.os === sys.OS_ANDROID) {\n                if (sys.browserType === sys.BROWSER_TYPE_UC) {\n                    __audioSupport.ONE_SOURCE = true;\n                }\n            }\n\n            if(DEBUG){\n                setTimeout(function(){\n                    cc.log('browse type: ' + sys.browserType);\n                    cc.log('browse version: ' + version);\n                    cc.log('MULTI_CHANNEL: ' + __audioSupport.MULTI_CHANNEL);\n                    cc.log('WEB_AUDIO: ' + __audioSupport.WEB_AUDIO);\n                    cc.log('AUTOPLAY: ' + __audioSupport.AUTOPLAY);\n                }, 0);\n            }\n        })();\n\n        try {\n            if (__audioSupport.WEB_AUDIO) {\n                __audioSupport.context = new (window.AudioContext || window.webkitAudioContext || window.mozAudioContext)();\n                if(__audioSupport.DELAY_CREATE_CTX) {\n                    setTimeout(function(){ __audioSupport.context = new (window.AudioContext || window.webkitAudioContext || window.mozAudioContext)(); }, 0);\n                }\n            }\n        } catch(error) {\n            __audioSupport.WEB_AUDIO = false;\n            cc.logID(5201);\n        }\n\n        var formatSupport = [];\n\n        (function(){\n            var audio = document.createElement('audio');\n            if(audio.canPlayType) {\n                var ogg = audio.canPlayType('audio/ogg; codecs=\"vorbis\"');\n                if (ogg) formatSupport.push('.ogg');\n                var mp3 = audio.canPlayType('audio/mpeg');\n                if (mp3) formatSupport.push('.mp3');\n                var wav = audio.canPlayType('audio/wav; codecs=\"1\"');\n                if (wav) formatSupport.push('.wav');\n                var mp4 = audio.canPlayType('audio/mp4');\n                if (mp4) formatSupport.push('.mp4');\n                var m4a = audio.canPlayType('audio/x-m4a');\n                if (m4a) formatSupport.push('.m4a');\n            }\n        })();\n        __audioSupport.format = formatSupport;\n\n        sys.__audioSupport = __audioSupport;\n    }\n\n    /**\n     * !#en\n     * Network type enumeration\n     * !#zh\n     * 网络类型枚举\n     *\n     * @enum sys.NetworkType\n     */\n    sys.NetworkType = {\n        /**\n         * !#en\n         * Network is unreachable.\n         * !#zh\n         * 网络不通\n         *\n         * @property {Number} NONE\n         */\n        NONE: 0,\n        /**\n         * !#en\n         * Network is reachable via WiFi or cable.\n         * !#zh\n         * 通过无线或者有线本地网络连接因特网\n         *\n         * @property {Number} LAN\n         */\n        LAN: 1,\n        /**\n         * !#en\n         * Network is reachable via Wireless Wide Area Network\n         * !#zh\n         * 通过蜂窝移动网络连接因特网\n         *\n         * @property {Number} WWAN\n         */\n        WWAN: 2\n    };\n\n    /**\n     * @class sys\n     */\n\n    /**\n     * !#en\n     * Get the network type of current device, return cc.sys.NetworkType.LAN if failure.\n     * !#zh\n     * 获取当前设备的网络类型, 如果网络类型无法获取，默认将返回 cc.sys.NetworkType.LAN\n     *\n     * @method getNetworkType\n     * @return {NetworkType}\n     */\n    sys.getNetworkType = function() {\n        // TODO: need to implement this for mobile phones.\n        return sys.NetworkType.LAN;\n    };\n\n    /**\n     * !#en\n     * Get the battery level of current device, return 1.0 if failure.\n     * !#zh\n     * 获取当前设备的电池电量，如果电量无法获取，默认将返回 1\n     *\n     * @method getBatteryLevel\n     * @return {Number} - 0.0 ~ 1.0\n     */\n    sys.getBatteryLevel = function() {\n        // TODO: need to implement this for mobile phones.\n        return 1.0;\n    };\n\n    /**\n     * Forces the garbage collection, only available in JSB\n     * @method garbageCollect\n     */\n    sys.garbageCollect = function () {\n        // N/A in web\n    };\n\n    /**\n     * Restart the JS VM, only available in JSB\n     * @method restartVM\n     */\n    sys.restartVM = function () {\n        // N/A in web\n    };\n\n    /**\n     * !#en\n     * Return the safe area rect. <br/>\n     * only available on the iOS native platform, otherwise it will return a rect with design resolution size.\n     * !#zh\n     * 返回手机屏幕安全区域，目前仅在 iOS 原生平台有效。其它平台将默认返回设计分辨率尺寸。\n     * @method getSafeAreaRect\n     * @return {Rect}\n    */\n    sys.getSafeAreaRect = function () {\n        let visibleSize = cc.view.getVisibleSize();\n        return cc.rect(0, 0, visibleSize.width, visibleSize.height);\n    };\n\n    /**\n     * Check whether an object is valid,\n     * In web engine, it will return true if the object exist\n     * In native engine, it will return true if the JS object and the correspond native object are both valid\n     * @method isObjectValid\n     * @param {Object} obj\n     * @return {Boolean} Validity of the object\n     */\n    sys.isObjectValid = function (obj) {\n        if (obj) {\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * Dump system informations\n     * @method dump\n     */\n    sys.dump = function () {\n        var self = this;\n        var str = \"\";\n        str += \"isMobile : \" + self.isMobile + \"\\r\\n\";\n        str += \"language : \" + self.language + \"\\r\\n\";\n        str += \"browserType : \" + self.browserType + \"\\r\\n\";\n        str += \"browserVersion : \" + self.browserVersion + \"\\r\\n\";\n        str += \"capabilities : \" + JSON.stringify(self.capabilities) + \"\\r\\n\";\n        str += \"os : \" + self.os + \"\\r\\n\";\n        str += \"osVersion : \" + self.osVersion + \"\\r\\n\";\n        str += \"platform : \" + self.platform + \"\\r\\n\";\n        str += \"Using \" + (cc.game.renderType === cc.game.RENDER_TYPE_WEBGL ? \"WEBGL\" : \"CANVAS\") + \" renderer.\" + \"\\r\\n\";\n        cc.log(str);\n    };\n\n    /**\n     * Open a url in browser\n     * @method openURL\n     * @param {String} url\n     */\n    sys.openURL = function (url) {\n        if (CC_JSB || CC_RUNTIME) {\n            jsb.openURL(url);\n        }\n        else {\n            window.open(url);\n        }\n    };\n\n    /**\n     * Get the number of milliseconds elapsed since 1 January 1970 00:00:00 UTC.\n     * @method now\n     * @return {Number}\n     */\n    sys.now = function () {\n        if (Date.now) {\n            return Date.now();\n        }\n        else {\n            return +(new Date);\n        }\n    };\n\n    return sys;\n}\n\nvar sys = cc && cc.sys ? cc.sys : initSys();\n\nmodule.exports = sys;\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst EventTarget = require('../event/event-target');\nconst js = require('../platform/js');\nconst renderer = require('../renderer');\nrequire('../platform/CCClass');\n\nvar __BrowserGetter = {\n    init: function(){\n        this.html = document.getElementsByTagName(\"html\")[0];\n    },\n    availWidth: function(frame){\n        if (!frame || frame === this.html)\n            return window.innerWidth;\n        else\n            return frame.clientWidth;\n    },\n    availHeight: function(frame){\n        if (!frame || frame === this.html)\n            return window.innerHeight;\n        else\n            return frame.clientHeight;\n    },\n    meta: {\n        \"width\": \"device-width\"\n    },\n    adaptationType: cc.sys.browserType\n};\n\nif (cc.sys.os === cc.sys.OS_IOS) // All browsers are WebView\n    __BrowserGetter.adaptationType = cc.sys.BROWSER_TYPE_SAFARI;\n\nswitch (__BrowserGetter.adaptationType) {\n    case cc.sys.BROWSER_TYPE_SAFARI:\n        __BrowserGetter.meta[\"minimal-ui\"] = \"true\";\n        __BrowserGetter.availWidth = cc.sys.isMobile ? function (frame){\n            // bug fix for navigation bar on Safari\n            return window.innerWidth;\n        } : function (frame) {\n            return frame.clientWidth;\n        }\n        __BrowserGetter.availHeight = cc.sys.isMobile ? function (frame){\n            // bug fix for navigation bar on Safari\n            return window.innerHeight;\n        } : function (frame) {\n            return frame.clientHeight;\n        }\n        break;\n    case cc.sys.BROWSER_TYPE_SOUGOU:\n    case cc.sys.BROWSER_TYPE_UC:\n        __BrowserGetter.meta[\"minimal-ui\"] = \"true\";\n        __BrowserGetter.availWidth = function(frame){\n            return frame.clientWidth;\n        };\n        __BrowserGetter.availHeight = function(frame){\n            return frame.clientHeight;\n        };\n        break;\n}\n\nvar _scissorRect = null;\n\n/**\n * cc.view is the singleton object which represents the game window.<br/>\n * It's main task include: <br/>\n *  - Apply the design resolution policy<br/>\n *  - Provide interaction with the window, like resize event on web, retina display support, etc...<br/>\n *  - Manage the game view port which can be different with the window<br/>\n *  - Manage the content scale and translation<br/>\n * <br/>\n * Since the cc.view is a singleton, you don't need to call any constructor or create functions,<br/>\n * the standard way to use it is by calling:<br/>\n *  - cc.view.methodName(); <br/>\n *\n * @class View\n * @extends EventTarget\n */\nvar View = function () {\n    EventTarget.call(this);\n\n    var _t = this, _strategyer = cc.ContainerStrategy, _strategy = cc.ContentStrategy;\n\n    __BrowserGetter.init(this);\n\n    // Size of parent node that contains cc.game.container and cc.game.canvas\n    _t._frameSize = cc.size(0, 0);\n\n    // resolution size, it is the size appropriate for the app resources.\n    _t._designResolutionSize = cc.size(0, 0);\n    _t._originalDesignResolutionSize = cc.size(0, 0);\n    _t._scaleX = 1;\n    _t._scaleY = 1;\n    // Viewport is the container's rect related to content's coordinates in pixel\n    _t._viewportRect = cc.rect(0, 0, 0, 0);\n    // The visible rect in content's coordinate in point\n    _t._visibleRect = cc.rect(0, 0, 0, 0);\n    // Auto full screen disabled by default\n    _t._autoFullScreen = false;\n    // The device's pixel ratio (for retina displays)\n    _t._devicePixelRatio = 1;\n    if(CC_JSB) {\n        _t._maxPixelRatio = 4;\n    } else {\n        _t._maxPixelRatio = 2;\n    }\n    // Retina disabled by default\n    _t._retinaEnabled = false;\n    // Custom callback for resize event\n    _t._resizeCallback = null;\n    _t._resizing = false;\n    _t._resizeWithBrowserSize = false;\n    _t._orientationChanging = true;\n    _t._isRotated = false;\n    _t._orientation = cc.macro.ORIENTATION_AUTO;\n    _t._isAdjustViewport = true;\n    _t._antiAliasEnabled = false;\n\n    // Setup system default resolution policies\n    _t._resolutionPolicy = null;\n    _t._rpExactFit = new cc.ResolutionPolicy(_strategyer.EQUAL_TO_FRAME, _strategy.EXACT_FIT);\n    _t._rpShowAll = new cc.ResolutionPolicy(_strategyer.EQUAL_TO_FRAME, _strategy.SHOW_ALL);\n    _t._rpNoBorder = new cc.ResolutionPolicy(_strategyer.EQUAL_TO_FRAME, _strategy.NO_BORDER);\n    _t._rpFixedHeight = new cc.ResolutionPolicy(_strategyer.EQUAL_TO_FRAME, _strategy.FIXED_HEIGHT);\n    _t._rpFixedWidth = new cc.ResolutionPolicy(_strategyer.EQUAL_TO_FRAME, _strategy.FIXED_WIDTH);\n\n    cc.game.once(cc.game.EVENT_ENGINE_INITED, this.init, this);\n};\n\ncc.js.extend(View, EventTarget);\n\ncc.js.mixin(View.prototype, {\n    init () {\n        this._initFrameSize();\n\n        var w = cc.game.canvas.width, h = cc.game.canvas.height;\n        this._designResolutionSize.width = w;\n        this._designResolutionSize.height = h;\n        this._originalDesignResolutionSize.width = w;\n        this._originalDesignResolutionSize.height = h;\n        this._viewportRect.width = w;\n        this._viewportRect.height = h;\n        this._visibleRect.width = w;\n        this._visibleRect.height = h;\n\n        cc.winSize.width = this._visibleRect.width;\n        cc.winSize.height = this._visibleRect.height;\n        cc.visibleRect && cc.visibleRect.init(this._visibleRect);\n    },\n\n    // Resize helper functions\n    _resizeEvent: function (forceOrEvent) {\n        var view;\n        if (this.setDesignResolutionSize) {\n            view = this;\n        } else {\n            view = cc.view;\n        }\n\n        // Check frame size changed or not\n        var prevFrameW = view._frameSize.width, prevFrameH = view._frameSize.height, prevRotated = view._isRotated;\n        if (cc.sys.isMobile) {\n            var containerStyle = cc.game.container.style,\n                margin = containerStyle.margin;\n            containerStyle.margin = '0';\n            containerStyle.display = 'none';\n            view._initFrameSize();\n            containerStyle.margin = margin;\n            containerStyle.display = 'block';\n        }\n        else {\n            view._initFrameSize();\n        }\n        if (forceOrEvent !== true && view._isRotated === prevRotated && view._frameSize.width === prevFrameW && view._frameSize.height === prevFrameH)\n            return;\n\n        // Frame size changed, do resize works\n        var width = view._originalDesignResolutionSize.width;\n        var height = view._originalDesignResolutionSize.height;\n        view._resizing = true;\n        if (width > 0)\n            view.setDesignResolutionSize(width, height, view._resolutionPolicy);\n        view._resizing = false;\n\n        view.emit('canvas-resize');\n        if (view._resizeCallback) {\n            view._resizeCallback.call();\n        }\n    },\n\n    _orientationChange: function () {\n        cc.view._orientationChanging = true;\n        cc.view._resizeEvent();\n        // HACK: show nav bar on iOS safari\n        // safari will enter fullscreen when rotate to landscape\n        // need to exit fullscreen when rotate back to portrait, scrollTo(0, 1) works.\n        if (cc.sys.browserType === cc.sys.BROWSER_TYPE_SAFARI && cc.sys.isMobile) {\n            setTimeout(() => {\n                if (window.innerHeight > window.innerWidth) {\n                    window.scrollTo(0, 1);\n                }\n            }, 500);\n        }\n    },\n\n    /**\n     * !#en\n     * Sets view's target-densitydpi for android mobile browser. it can be set to:           <br/>\n     *   1. cc.macro.DENSITYDPI_DEVICE, value is \"device-dpi\"                                      <br/>\n     *   2. cc.macro.DENSITYDPI_HIGH, value is \"high-dpi\"  (default value)                         <br/>\n     *   3. cc.macro.DENSITYDPI_MEDIUM, value is \"medium-dpi\" (browser's default value)            <br/>\n     *   4. cc.macro.DENSITYDPI_LOW, value is \"low-dpi\"                                            <br/>\n     *   5. Custom value, e.g: \"480\"                                                         <br/>\n     * !#zh 设置目标内容的每英寸像素点密度。\n     *\n     * @method setTargetDensityDPI\n     * @param {String} densityDPI\n     * @deprecated since v2.0\n     */\n\n    /**\n     * !#en\n     * Returns the current target-densitydpi value of cc.view.\n     * !#zh 获取目标内容的每英寸像素点密度。\n     * @method getTargetDensityDPI\n     * @returns {String}\n     * @deprecated since v2.0\n     */\n\n    /**\n     * !#en\n     * Sets whether resize canvas automatically when browser's size changed.<br/>\n     * Useful only on web.\n     * !#zh 设置当发现浏览器的尺寸改变时，是否自动调整 canvas 尺寸大小。\n     * 仅在 Web 模式下有效。\n     * @method resizeWithBrowserSize\n     * @param {Boolean} enabled - Whether enable automatic resize with browser's resize event\n     */\n    resizeWithBrowserSize: function (enabled) {\n        if (enabled) {\n            //enable\n            if (!this._resizeWithBrowserSize) {\n                this._resizeWithBrowserSize = true;\n                window.addEventListener('resize', this._resizeEvent);\n                window.addEventListener('orientationchange', this._orientationChange);\n            }\n        } else {\n            //disable\n            if (this._resizeWithBrowserSize) {\n                this._resizeWithBrowserSize = false;\n                window.removeEventListener('resize', this._resizeEvent);\n                window.removeEventListener('orientationchange', this._orientationChange);\n            }\n        }\n    },\n\n    /**\n     * !#en\n     * Sets the callback function for cc.view's resize action,<br/>\n     * this callback will be invoked before applying resolution policy, <br/>\n     * so you can do any additional modifications within the callback.<br/>\n     * Useful only on web.\n     * !#zh 设置 cc.view 调整视窗尺寸行为的回调函数，\n     * 这个回调函数会在应用适配模式之前被调用，\n     * 因此你可以在这个回调函数内添加任意附加改变，\n     * 仅在 Web 平台下有效。\n     * @method setResizeCallback\n     * @param {Function|Null} callback - The callback function\n     */\n    setResizeCallback: function (callback) {\n        if (CC_EDITOR) return;\n        if (typeof callback === 'function' || callback == null) {\n            this._resizeCallback = callback;\n        }\n    },\n\n    /**\n     * !#en\n     * Sets the orientation of the game, it can be landscape, portrait or auto.\n     * When set it to landscape or portrait, and screen w/h ratio doesn't fit, \n     * cc.view will automatically rotate the game canvas using CSS.\n     * Note that this function doesn't have any effect in native, \n     * in native, you need to set the application orientation in native project settings\n     * !#zh 设置游戏屏幕朝向，它能够是横版，竖版或自动。\n     * 当设置为横版或竖版，并且屏幕的宽高比例不匹配时，\n     * cc.view 会自动用 CSS 旋转游戏场景的 canvas，\n     * 这个方法不会对 native 部分产生任何影响，对于 native 而言，你需要在应用设置中的设置排版。\n     * @method setOrientation\n     * @param {Number} orientation - Possible values: cc.macro.ORIENTATION_LANDSCAPE | cc.macro.ORIENTATION_PORTRAIT | cc.macro.ORIENTATION_AUTO\n     */\n    setOrientation: function (orientation) {\n        orientation = orientation & cc.macro.ORIENTATION_AUTO;\n        if (orientation && this._orientation !== orientation) {\n            this._orientation = orientation;\n            var designWidth = this._originalDesignResolutionSize.width;\n            var designHeight = this._originalDesignResolutionSize.height;\n            this.setDesignResolutionSize(designWidth, designHeight, this._resolutionPolicy);\n        }\n    },\n\n    _initFrameSize: function () {\n        var locFrameSize = this._frameSize;\n        var w = __BrowserGetter.availWidth(cc.game.frame);\n        var h = __BrowserGetter.availHeight(cc.game.frame);\n        var isLandscape = w >= h;\n\n        if (CC_EDITOR || !cc.sys.isMobile ||\n            (isLandscape && this._orientation & cc.macro.ORIENTATION_LANDSCAPE) || \n            (!isLandscape && this._orientation & cc.macro.ORIENTATION_PORTRAIT)) {\n            locFrameSize.width = w;\n            locFrameSize.height = h;\n            cc.game.container.style['-webkit-transform'] = 'rotate(0deg)';\n            cc.game.container.style.transform = 'rotate(0deg)';\n            this._isRotated = false;\n        }\n        else {\n            locFrameSize.width = h;\n            locFrameSize.height = w;\n            cc.game.container.style['-webkit-transform'] = 'rotate(90deg)';\n            cc.game.container.style.transform = 'rotate(90deg)';\n            cc.game.container.style['-webkit-transform-origin'] = '0px 0px 0px';\n            cc.game.container.style.transformOrigin = '0px 0px 0px';\n            this._isRotated = true;\n        }\n        if (this._orientationChanging) {\n            setTimeout(function () {\n                cc.view._orientationChanging = false;\n            }, 1000);\n        }\n    },\n\n    _setViewportMeta: function (metas, overwrite) {\n        var vp = document.getElementById(\"cocosMetaElement\");\n        if(vp && overwrite){\n            document.head.removeChild(vp);\n        }\n\n        var elems = document.getElementsByName(\"viewport\"),\n            currentVP = elems ? elems[0] : null,\n            content, key, pattern;\n\n        content = currentVP ? currentVP.content : \"\";\n        vp = vp || document.createElement(\"meta\");\n        vp.id = \"cocosMetaElement\";\n        vp.name = \"viewport\";\n        vp.content = \"\";\n\n        for (key in metas) {\n            if (content.indexOf(key) == -1) {\n                content += \",\" + key + \"=\" + metas[key];\n            }\n            else if (overwrite) {\n                pattern = new RegExp(key+\"\\s*=\\s*[^,]+\");\n                content.replace(pattern, key + \"=\" + metas[key]);\n            }\n        }\n        if(/^,/.test(content))\n            content = content.substr(1);\n\n        vp.content = content;\n        // For adopting certain android devices which don't support second viewport\n        if (currentVP)\n            currentVP.content = content;\n\n        document.head.appendChild(vp);\n    },\n\n    _adjustViewportMeta: function () {\n        if (this._isAdjustViewport && !CC_JSB && !CC_RUNTIME) {\n            this._setViewportMeta(__BrowserGetter.meta, false);\n            this._isAdjustViewport = false;\n        }\n    },\n\n    /**\n     * !#en\n     * Sets whether the engine modify the \"viewport\" meta in your web page.<br/>\n     * It's enabled by default, we strongly suggest you not to disable it.<br/>\n     * And even when it's enabled, you can still set your own \"viewport\" meta, it won't be overridden<br/>\n     * Only useful on web\n     * !#zh 设置引擎是否调整 viewport meta 来配合屏幕适配。\n     * 默认设置为启动，我们强烈建议你不要将它设置为关闭。\n     * 即使当它启动时，你仍然能够设置你的 viewport meta，它不会被覆盖。\n     * 仅在 Web 模式下有效\n     * @method adjustViewportMeta\n     * @param {Boolean} enabled - Enable automatic modification to \"viewport\" meta\n     */\n    adjustViewportMeta: function (enabled) {\n        this._isAdjustViewport = enabled;\n    },\n\n    /**\n     * !#en\n     * Retina support is enabled by default for Apple device but disabled for other devices,<br/>\n     * it takes effect only when you called setDesignResolutionPolicy<br/>\n     * Only useful on web\n     * !#zh 对于 Apple 这种支持 Retina 显示的设备上默认进行优化而其他类型设备默认不进行优化，\n     * 它仅会在你调用 setDesignResolutionPolicy 方法时有影响。\n     * 仅在 Web 模式下有效。\n     * @method enableRetina\n     * @param {Boolean} enabled - Enable or disable retina display\n     */\n    enableRetina: function(enabled) {\n        if (CC_EDITOR && enabled) {\n            cc.warn('Can not enable retina in Editor.');\n            return;\n        }\n        this._retinaEnabled = !!enabled;\n    },\n\n    /**\n     * !#en\n     * Check whether retina display is enabled.<br/>\n     * Only useful on web\n     * !#zh 检查是否对 Retina 显示设备进行优化。\n     * 仅在 Web 模式下有效。\n     * @method isRetinaEnabled\n     * @return {Boolean}\n     */\n    isRetinaEnabled: function() {\n        if (CC_EDITOR) {\n            return false;\n        }\n        return this._retinaEnabled;\n    },\n\n    /**\n     * !#en Whether to Enable on anti-alias\n     * !#zh 控制抗锯齿是否开启\n     * @method enableAntiAlias\n     * @param {Boolean} enabled - Enable or not anti-alias\n     * @deprecated cc.view.enableAntiAlias is deprecated now, please use cc.Texture2D.setFilters instead\n     * @since v2.3.0\n     */\n    enableAntiAlias: function (enabled) {\n        cc.warnID(9200);\n        if (this._antiAliasEnabled === enabled) {\n            return;\n        }\n        this._antiAliasEnabled = enabled;\n        if(cc.game.renderType === cc.game.RENDER_TYPE_WEBGL) {\n            var cache = cc.loader._cache;\n            for (var key in cache) {\n                var item = cache[key];\n                var tex = item && item.content instanceof cc.Texture2D ? item.content : null;\n                if (tex) {\n                    var Filter = cc.Texture2D.Filter;\n                    if (enabled) {\n                        tex.setFilters(Filter.LINEAR, Filter.LINEAR);\n                    }\n                    else {\n                        tex.setFilters(Filter.NEAREST, Filter.NEAREST);\n                    }\n                }\n            }\n        }\n        else if(cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {\n            var ctx = cc.game.canvas.getContext('2d');\n            ctx.imageSmoothingEnabled = enabled;\n            ctx.mozImageSmoothingEnabled = enabled;\n        }\n    },\n\n    /**\n     * !#en Returns whether the current enable on anti-alias\n     * !#zh 返回当前是否抗锯齿\n     * @method isAntiAliasEnabled\n     * @return {Boolean}\n     */\n    isAntiAliasEnabled: function () {\n        return this._antiAliasEnabled;\n    },\n    /**\n     * !#en\n     * If enabled, the application will try automatically to enter full screen mode on mobile devices<br/>\n     * You can pass true as parameter to enable it and disable it by passing false.<br/>\n     * Only useful on web\n     * !#zh 启动时，移动端游戏会在移动端自动尝试进入全屏模式。\n     * 你能够传入 true 为参数去启动它，用 false 参数来关闭它。\n     * @method enableAutoFullScreen\n     * @param {Boolean} enabled - Enable or disable auto full screen on mobile devices\n     */\n    enableAutoFullScreen: function(enabled) {\n        if (enabled && \n            enabled !== this._autoFullScreen && \n            cc.sys.isMobile) {\n            // Automatically full screen when user touches on mobile version\n            this._autoFullScreen = true;\n            cc.screen.autoFullScreen(cc.game.frame);\n        }\n        else {\n            this._autoFullScreen = false;\n            cc.screen.disableAutoFullScreen(cc.game.frame);\n        }\n    },\n\n    /**\n     * !#en\n     * Check whether auto full screen is enabled.<br/>\n     * Only useful on web\n     * !#zh 检查自动进入全屏模式是否启动。\n     * 仅在 Web 模式下有效。\n     * @method isAutoFullScreenEnabled\n     * @return {Boolean} Auto full screen enabled or not\n     */\n    isAutoFullScreenEnabled: function() {\n        return this._autoFullScreen;\n    },\n\n    /*\n     * Not support on native.<br/>\n     * On web, it sets the size of the canvas.\n     * !#zh 这个方法并不支持 native 平台，在 Web 平台下，可以用来设置 canvas 尺寸。\n     * @method setCanvasSize\n     * @param {Number} width\n     * @param {Number} height\n     */\n    setCanvasSize: function (width, height) {\n        var canvas = cc.game.canvas;\n        var container = cc.game.container;\n\n        canvas.width = width * this._devicePixelRatio;\n        canvas.height = height * this._devicePixelRatio;\n\n        canvas.style.width = width + 'px';\n        canvas.style.height = height + 'px';\n\n        container.style.width = width + 'px';\n        container.style.height = height + 'px';\n\n        this._resizeEvent();\n    },\n\n    /**\n     * !#en\n     * Returns the canvas size of the view.<br/>\n     * On native platforms, it returns the screen size since the view is a fullscreen view.<br/>\n     * On web, it returns the size of the canvas element.\n     * !#zh 返回视图中 canvas 的尺寸。\n     * 在 native 平台下，它返回全屏视图下屏幕的尺寸。\n     * 在 Web 平台下，它返回 canvas 元素尺寸。\n     * @method getCanvasSize\n     * @return {Size}\n     */\n    getCanvasSize: function () {\n        return cc.size(cc.game.canvas.width, cc.game.canvas.height);\n    },\n\n    /**\n     * !#en\n     * Returns the frame size of the view.<br/>\n     * On native platforms, it returns the screen size since the view is a fullscreen view.<br/>\n     * On web, it returns the size of the canvas's outer DOM element.\n     * !#zh 返回视图中边框尺寸。\n     * 在 native 平台下，它返回全屏视图下屏幕的尺寸。\n     * 在 web 平台下，它返回 canvas 元素的外层 DOM 元素尺寸。\n     * @method getFrameSize\n     * @return {Size}\n     */\n    getFrameSize: function () {\n        return cc.size(this._frameSize.width, this._frameSize.height);\n    },\n\n    /**\n     * !#en\n     * On native, it sets the frame size of view.<br/>\n     * On web, it sets the size of the canvas's outer DOM element.\n     * !#zh 在 native 平台下，设置视图框架尺寸。\n     * 在 web 平台下，设置 canvas 外层 DOM 元素尺寸。\n     * @method setFrameSize\n     * @param {Number} width\n     * @param {Number} height\n     */\n    setFrameSize: function (width, height) {\n        this._frameSize.width = width;\n        this._frameSize.height = height;\n        cc.game.frame.style.width = width + \"px\";\n        cc.game.frame.style.height = height + \"px\";\n        this._resizeEvent(true);\n    },\n\n    /**\n     * !#en\n     * Returns the visible area size of the view port.\n     * !#zh 返回视图窗口可见区域尺寸。\n     * @method getVisibleSize\n     * @return {Size}\n     */\n    getVisibleSize: function () {\n        return cc.size(this._visibleRect.width,this._visibleRect.height);\n    },\n\n    /**\n     * !#en\n     * Returns the visible area size of the view port.\n     * !#zh 返回视图窗口可见区域像素尺寸。\n     * @method getVisibleSizeInPixel\n     * @return {Size}\n     */\n    getVisibleSizeInPixel: function () {\n        return cc.size( this._visibleRect.width * this._scaleX,\n                        this._visibleRect.height * this._scaleY );\n    },\n\n    /**\n     * !#en\n     * Returns the visible origin of the view port.\n     * !#zh 返回视图窗口可见区域原点。\n     * @method getVisibleOrigin\n     * @return {Vec2}\n     */\n    getVisibleOrigin: function () {\n        return cc.v2(this._visibleRect.x,this._visibleRect.y);\n    },\n\n    /**\n     * !#en\n     * Returns the visible origin of the view port.\n     * !#zh 返回视图窗口可见区域像素原点。\n     * @method getVisibleOriginInPixel\n     * @return {Vec2}\n     */\n    getVisibleOriginInPixel: function () {\n        return cc.v2(this._visibleRect.x * this._scaleX,\n                    this._visibleRect.y * this._scaleY);\n    },\n\n    /**\n     * !#en\n     * Returns the current resolution policy\n     * !#zh 返回当前分辨率方案\n     * @see cc.ResolutionPolicy\n     * @method getResolutionPolicy\n     * @return {ResolutionPolicy}\n     */\n    getResolutionPolicy: function () {\n        return this._resolutionPolicy;\n    },\n\n    /**\n     * !#en\n     * Sets the current resolution policy\n     * !#zh 设置当前分辨率模式\n     * @see cc.ResolutionPolicy\n     * @method setResolutionPolicy\n     * @param {ResolutionPolicy|Number} resolutionPolicy\n     */\n    setResolutionPolicy: function (resolutionPolicy) {\n        var _t = this;\n        if (resolutionPolicy instanceof cc.ResolutionPolicy) {\n            _t._resolutionPolicy = resolutionPolicy;\n        }\n        // Ensure compatibility with JSB\n        else {\n            var _locPolicy = cc.ResolutionPolicy;\n            if(resolutionPolicy === _locPolicy.EXACT_FIT)\n                _t._resolutionPolicy = _t._rpExactFit;\n            if(resolutionPolicy === _locPolicy.SHOW_ALL)\n                _t._resolutionPolicy = _t._rpShowAll;\n            if(resolutionPolicy === _locPolicy.NO_BORDER)\n                _t._resolutionPolicy = _t._rpNoBorder;\n            if(resolutionPolicy === _locPolicy.FIXED_HEIGHT)\n                _t._resolutionPolicy = _t._rpFixedHeight;\n            if(resolutionPolicy === _locPolicy.FIXED_WIDTH)\n                _t._resolutionPolicy = _t._rpFixedWidth;\n        }\n    },\n\n    /**\n     * !#en\n     * Sets the resolution policy with designed view size in points.<br/>\n     * The resolution policy include: <br/>\n     * [1] ResolutionExactFit       Fill screen by stretch-to-fit: if the design resolution ratio of width to height is different from the screen resolution ratio, your game view will be stretched.<br/>\n     * [2] ResolutionNoBorder       Full screen without black border: if the design resolution ratio of width to height is different from the screen resolution ratio, two areas of your game view will be cut.<br/>\n     * [3] ResolutionShowAll        Full screen with black border: if the design resolution ratio of width to height is different from the screen resolution ratio, two black borders will be shown.<br/>\n     * [4] ResolutionFixedHeight    Scale the content's height to screen's height and proportionally scale its width<br/>\n     * [5] ResolutionFixedWidth     Scale the content's width to screen's width and proportionally scale its height<br/>\n     * [cc.ResolutionPolicy]        [Web only feature] Custom resolution policy, constructed by cc.ResolutionPolicy<br/>\n     * !#zh 通过设置设计分辨率和匹配模式来进行游戏画面的屏幕适配。\n     * @method setDesignResolutionSize\n     * @param {Number} width Design resolution width.\n     * @param {Number} height Design resolution height.\n     * @param {ResolutionPolicy|Number} resolutionPolicy The resolution policy desired\n     */\n    setDesignResolutionSize: function (width, height, resolutionPolicy) {\n        // Defensive code\n        if( !(width > 0 || height > 0) ){\n            cc.logID(2200);\n            return;\n        }\n\n        this.setResolutionPolicy(resolutionPolicy);\n        var policy = this._resolutionPolicy;\n        if (policy) {\n            policy.preApply(this);\n        }\n\n        // Reinit frame size\n        if (cc.sys.isMobile)\n            this._adjustViewportMeta();\n\n        // Permit to re-detect the orientation of device.\n        this._orientationChanging = true;\n        // If resizing, then frame size is already initialized, this logic should be improved\n        if (!this._resizing)\n            this._initFrameSize();\n\n        if (!policy) {\n            cc.logID(2201);\n            return;\n        }\n\n        this._originalDesignResolutionSize.width = this._designResolutionSize.width = width;\n        this._originalDesignResolutionSize.height = this._designResolutionSize.height = height;\n\n        var result = policy.apply(this, this._designResolutionSize);\n\n        if(result.scale && result.scale.length === 2){\n            this._scaleX = result.scale[0];\n            this._scaleY = result.scale[1];\n        }\n\n        if(result.viewport){\n            var vp = this._viewportRect,\n                vb = this._visibleRect,\n                rv = result.viewport;\n\n            vp.x = rv.x;\n            vp.y = rv.y;\n            vp.width = rv.width;\n            vp.height = rv.height;\n\n            vb.x = 0;\n            vb.y = 0;\n            vb.width = rv.width / this._scaleX;\n            vb.height = rv.height / this._scaleY;\n        }\n\n        policy.postApply(this);\n        cc.winSize.width = this._visibleRect.width;\n        cc.winSize.height = this._visibleRect.height;\n\n        cc.visibleRect && cc.visibleRect.init(this._visibleRect);\n\n        renderer.updateCameraViewport();\n        cc.internal.inputManager._updateCanvasBoundingRect();\n        this.emit('design-resolution-changed');\n    },\n\n    /**\n     * !#en\n     * Returns the designed size for the view.\n     * Default resolution size is the same as 'getFrameSize'.\n     * !#zh 返回视图的设计分辨率。\n     * 默认下分辨率尺寸同 `getFrameSize` 方法相同\n     * @method getDesignResolutionSize\n     * @return {Size}\n     */\n    getDesignResolutionSize: function () {\n        return cc.size(this._designResolutionSize.width, this._designResolutionSize.height);\n    },\n\n    /**\n     * !#en\n     * Sets the container to desired pixel resolution and fit the game content to it.\n     * This function is very useful for adaptation in mobile browsers.\n     * In some HD android devices, the resolution is very high, but its browser performance may not be very good.\n     * In this case, enabling retina display is very costy and not suggested, and if retina is disabled, the image may be blurry.\n     * But this API can be helpful to set a desired pixel resolution which is in between.\n     * This API will do the following:\n     *     1. Set viewport's width to the desired width in pixel\n     *     2. Set body width to the exact pixel resolution\n     *     3. The resolution policy will be reset with designed view size in points.\n     * !#zh 设置容器（container）需要的像素分辨率并且适配相应分辨率的游戏内容。\n     * @method setRealPixelResolution\n     * @param {Number} width Design resolution width.\n     * @param {Number} height Design resolution height.\n     * @param {ResolutionPolicy|Number} resolutionPolicy The resolution policy desired\n     */\n    setRealPixelResolution: function (width, height, resolutionPolicy) {\n        if (!CC_JSB && !CC_RUNTIME) {\n            // Set viewport's width\n            this._setViewportMeta({\"width\": width}, true);\n\n            // Set body width to the exact pixel resolution\n            document.documentElement.style.width = width + \"px\";\n            document.body.style.width = width + \"px\";\n            document.body.style.left = \"0px\";\n            document.body.style.top = \"0px\";\n        }\n\n        // Reset the resolution size and policy\n        this.setDesignResolutionSize(width, height, resolutionPolicy);\n    },\n\n    /**\n     * !#en\n     * Sets view port rectangle with points.\n     * !#zh 用设计分辨率下的点尺寸来设置视窗。\n     * @method setViewportInPoints\n     * @deprecated since v2.0\n     * @param {Number} x\n     * @param {Number} y\n     * @param {Number} w width\n     * @param {Number} h height\n     */\n    setViewportInPoints: function (x, y, w, h) {\n        var locScaleX = this._scaleX, locScaleY = this._scaleY;\n        cc.game._renderContext.viewport((x * locScaleX + this._viewportRect.x),\n            (y * locScaleY + this._viewportRect.y),\n            (w * locScaleX),\n            (h * locScaleY));\n    },\n\n    /**\n     * !#en\n     * Sets Scissor rectangle with points.\n     * !#zh 用设计分辨率下的点的尺寸来设置 scissor 剪裁区域。\n     * @method setScissorInPoints\n     * @deprecated since v2.0\n     * @param {Number} x\n     * @param {Number} y\n     * @param {Number} w\n     * @param {Number} h\n     */\n    setScissorInPoints: function (x, y, w, h) {\n        let scaleX = this._scaleX, scaleY = this._scaleY;\n        let sx = Math.ceil(x * scaleX + this._viewportRect.x);\n        let sy = Math.ceil(y * scaleY + this._viewportRect.y);\n        let sw = Math.ceil(w * scaleX);\n        let sh = Math.ceil(h * scaleY);\n        let gl = cc.game._renderContext;\n\n        if (!_scissorRect) {\n            var boxArr = gl.getParameter(gl.SCISSOR_BOX);\n            _scissorRect = cc.rect(boxArr[0], boxArr[1], boxArr[2], boxArr[3]);\n        }\n\n        if (_scissorRect.x !== sx || _scissorRect.y !== sy || _scissorRect.width !== sw || _scissorRect.height !== sh) {\n            _scissorRect.x = sx;\n            _scissorRect.y = sy;\n            _scissorRect.width = sw;\n            _scissorRect.height = sh;\n            gl.scissor(sx, sy, sw, sh);\n        }\n    },\n\n    /**\n     * !#en\n     * Returns whether GL_SCISSOR_TEST is enable\n     * !#zh 检查 scissor 是否生效。\n     * @method isScissorEnabled\n     * @deprecated since v2.0\n     * @return {Boolean}\n     */\n    isScissorEnabled: function () {\n        return cc.game._renderContext.isEnabled(gl.SCISSOR_TEST);\n    },\n\n    /**\n     * !#en\n     * Returns the current scissor rectangle\n     * !#zh 返回当前的 scissor 剪裁区域。\n     * @method getScissorRect\n     * @deprecated since v2.0\n     * @return {Rect}\n     */\n    getScissorRect: function () {\n        if (!_scissorRect) {\n            var boxArr = gl.getParameter(gl.SCISSOR_BOX);\n            _scissorRect = cc.rect(boxArr[0], boxArr[1], boxArr[2], boxArr[3]);\n        }\n        var scaleXFactor = 1 / this._scaleX;\n        var scaleYFactor = 1 / this._scaleY;\n        return cc.rect(\n            (_scissorRect.x - this._viewportRect.x) * scaleXFactor,\n            (_scissorRect.y - this._viewportRect.y) * scaleYFactor,\n            _scissorRect.width * scaleXFactor,\n            _scissorRect.height * scaleYFactor\n        );\n    },\n\n    /**\n     * !#en\n     * Returns the view port rectangle.\n     * !#zh 返回视窗剪裁区域。\n     * @method getViewportRect\n     * @return {Rect}\n     */\n    getViewportRect: function () {\n        return this._viewportRect;\n    },\n\n    /**\n     * !#en\n     * Returns scale factor of the horizontal direction (X axis).\n     * !#zh 返回横轴的缩放比，这个缩放比是将画布像素分辨率放到设计分辨率的比例。\n     * @method getScaleX\n     * @return {Number}\n     */\n    getScaleX: function () {\n        return this._scaleX;\n    },\n\n    /**\n     * !#en\n     * Returns scale factor of the vertical direction (Y axis).\n     * !#zh 返回纵轴的缩放比，这个缩放比是将画布像素分辨率缩放到设计分辨率的比例。\n     * @method getScaleY\n     * @return {Number}\n     */\n    getScaleY: function () {\n        return this._scaleY;\n    },\n\n    /**\n     * !#en\n     * Returns device pixel ratio for retina display.\n     * !#zh 返回设备或浏览器像素比例。\n     * @method getDevicePixelRatio\n     * @return {Number}\n     */\n    getDevicePixelRatio: function() {\n        return this._devicePixelRatio;\n    },\n\n    /**\n     * !#en\n     * Returns the real location in view for a translation based on a related position\n     * !#zh 将屏幕坐标转换为游戏视图下的坐标。\n     * @method convertToLocationInView\n     * @param {Number} tx - The X axis translation\n     * @param {Number} ty - The Y axis translation\n     * @param {Object} relatedPos - The related position object including \"left\", \"top\", \"width\", \"height\" informations\n     * @return {Vec2}\n     */\n    convertToLocationInView: function (tx, ty, relatedPos, out) {\n        let result = out || cc.v2();\n        let posLeft = relatedPos.adjustedLeft ? relatedPos.adjustedLeft : relatedPos.left;\n        let posTop = relatedPos.adjustedTop ? relatedPos.adjustedTop : relatedPos.top;\n        let x = this._devicePixelRatio * (tx - posLeft);\n        let y = this._devicePixelRatio * (posTop + relatedPos.height - ty);\n        if (this._isRotated) {\n            result.x = cc.game.canvas.width - y;\n            result.y = x;\n        }\n        else {\n            result.x = x;\n            result.y = y;\n        }\n        return result;\n    },\n\n    _convertMouseToLocationInView: function (in_out_point, relatedPos) {\n        var viewport = this._viewportRect, _t = this;\n        in_out_point.x = ((_t._devicePixelRatio * (in_out_point.x - relatedPos.left)) - viewport.x) / _t._scaleX;\n        in_out_point.y = (_t._devicePixelRatio * (relatedPos.top + relatedPos.height - in_out_point.y) - viewport.y) / _t._scaleY;\n    },\n\n    _convertPointWithScale: function (point) {\n        var viewport = this._viewportRect;\n        point.x = (point.x - viewport.x) / this._scaleX;\n        point.y = (point.y - viewport.y) / this._scaleY;\n    },\n\n    _convertTouchesWithScale: function (touches) {\n        var viewport = this._viewportRect, scaleX = this._scaleX, scaleY = this._scaleY,\n            selTouch, selPoint, selPrePoint;\n        for (var i = 0; i < touches.length; i++) {\n            selTouch = touches[i];\n            selPoint = selTouch._point;\n            selPrePoint = selTouch._prevPoint;\n\n            selPoint.x = (selPoint.x - viewport.x) / scaleX;\n            selPoint.y = (selPoint.y - viewport.y) / scaleY;\n            selPrePoint.x = (selPrePoint.x - viewport.x) / scaleX;\n            selPrePoint.y = (selPrePoint.y - viewport.y) / scaleY;\n        }\n    }\n});\n\n/**\n * !#en\n * Emit when design resolution changed.\n * !#zh\n * 当设计分辨率改变时发送。\n * @event design-resolution-changed\n */\n /**\n * !#en\n * Emit when canvas resize.\n * !#zh\n * 当画布大小改变时发送。\n * @event canvas-resize\n */\n\n\n/**\n * <p>cc.game.containerStrategy class is the root strategy class of container's scale strategy,\n * it controls the behavior of how to scale the cc.game.container and cc.game.canvas object</p>\n *\n * @class ContainerStrategy\n */\ncc.ContainerStrategy = cc.Class({\n    name: \"ContainerStrategy\",\n    /**\n     * !#en\n     * Manipulation before appling the strategy\n     * !#zh 在应用策略之前的操作\n     * @method preApply\n     * @param {View} view - The target view\n     */\n    preApply: function (view) {\n    },\n\n    /**\n     * !#en\n     * Function to apply this strategy\n     * !#zh 策略应用方法\n     * @method apply\n     * @param {View} view\n     * @param {Size} designedResolution\n     */\n    apply: function (view, designedResolution) {\n    },\n\n    /**\n     * !#en\n     * Manipulation after applying the strategy\n     * !#zh 策略调用之后的操作\n     * @method postApply\n     * @param {View} view  The target view\n     */\n    postApply: function (view) {\n\n    },\n\n    _setupContainer: function (view, w, h) {\n        var locCanvas = cc.game.canvas;\n\n        this._setupStyle(view, w, h);\n        \n        // Setup pixel ratio for retina display\n        var devicePixelRatio = view._devicePixelRatio = 1;\n        if(CC_JSB){\n            // view.isRetinaEnabled only work on web. \n            devicePixelRatio = view._devicePixelRatio = window.devicePixelRatio;\n        }else if (view.isRetinaEnabled()) {\n            devicePixelRatio = view._devicePixelRatio = Math.min(view._maxPixelRatio, window.devicePixelRatio || 1);\n        }\n        // Setup canvas\n        locCanvas.width = w * devicePixelRatio;\n        locCanvas.height = h * devicePixelRatio;\n    },\n\n    _setupStyle: function (view, w, h) {\n        let locCanvas = cc.game.canvas;\n        let locContainer = cc.game.container;\n        if (cc.sys.os === cc.sys.OS_ANDROID) {\n            document.body.style.width = (view._isRotated ? h : w) + 'px';\n            document.body.style.height = (view._isRotated ? w : h) + 'px';\n        }\n        // Setup style\n        locContainer.style.width = locCanvas.style.width = w + 'px';\n        locContainer.style.height = locCanvas.style.height = h + 'px';\n    },\n\n    _fixContainer: function () {\n        // Add container to document body\n        document.body.insertBefore(cc.game.container, document.body.firstChild);\n        // Set body's width height to window's size, and forbid overflow, so that game will be centered\n        var bs = document.body.style;\n        bs.width = window.innerWidth + \"px\";\n        bs.height = window.innerHeight + \"px\";\n        bs.overflow = \"hidden\";\n        // Body size solution doesn't work on all mobile browser so this is the aleternative: fixed container\n        var contStyle = cc.game.container.style;\n        contStyle.position = \"fixed\";\n        contStyle.left = contStyle.top = \"0px\";\n        // Reposition body\n        document.body.scrollTop = 0;\n    }\n});\n\n/**\n * <p>cc.ContentStrategy class is the root strategy class of content's scale strategy,\n * it controls the behavior of how to scale the scene and setup the viewport for the game</p>\n *\n * @class ContentStrategy\n */\ncc.ContentStrategy = cc.Class({\n    name: \"ContentStrategy\",\n\n    ctor: function () {\n        this._result = {\n            scale: [1, 1],\n            viewport: null\n        };\n    },\n\n    _buildResult: function (containerW, containerH, contentW, contentH, scaleX, scaleY) {\n        // Makes content fit better the canvas\n        Math.abs(containerW - contentW) < 2 && (contentW = containerW);\n        Math.abs(containerH - contentH) < 2 && (contentH = containerH);\n\n        var viewport = cc.rect((containerW - contentW) / 2, (containerH - contentH) / 2, contentW, contentH);\n\n        // Translate the content\n        if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS){\n            //TODO: modify something for setTransform\n            //cc.game._renderContext.translate(viewport.x, viewport.y + contentH);\n        }\n\n        this._result.scale = [scaleX, scaleY];\n        this._result.viewport = viewport;\n        return this._result;\n    },\n\n    /**\n     * !#en\n     * Manipulation before applying the strategy\n     * !#zh 策略应用前的操作\n     * @method preApply\n     * @param {View} view - The target view\n     */\n    preApply: function (view) {\n    },\n\n    /**\n     * !#en Function to apply this strategy\n     * The return value is {scale: [scaleX, scaleY], viewport: {cc.Rect}},\n     * The target view can then apply these value to itself, it's preferred not to modify directly its private variables\n     * !#zh 调用策略方法\n     * @method apply\n     * @param {View} view\n     * @param {Size} designedResolution\n     * @return {Object} scaleAndViewportRect\n     */\n    apply: function (view, designedResolution) {\n        return {\"scale\": [1, 1]};\n    },\n\n    /**\n     * !#en\n     * Manipulation after applying the strategy\n     * !#zh 策略调用之后的操作\n     * @method postApply\n     * @param {View} view - The target view\n     */\n    postApply: function (view) {\n    }\n});\n\n(function () {\n\n// Container scale strategys\n    /**\n     * @class EqualToFrame\n     * @extends ContainerStrategy\n     */\n    var EqualToFrame = cc.Class({\n        name: \"EqualToFrame\",\n        extends: cc.ContainerStrategy,\n        apply: function (view) {\n            var frameH = view._frameSize.height, containerStyle = cc.game.container.style;\n            this._setupContainer(view, view._frameSize.width, view._frameSize.height);\n            // Setup container's margin and padding\n            if (view._isRotated) {\n                containerStyle.margin = '0 0 0 ' + frameH + 'px';\n            }\n            else {\n                containerStyle.margin = '0px';\n            }\n            containerStyle.padding = \"0px\";\n        }\n    });\n\n    /**\n     * @class ProportionalToFrame\n     * @extends ContainerStrategy\n     */\n    var ProportionalToFrame = cc.Class({\n        name: \"ProportionalToFrame\",\n        extends: cc.ContainerStrategy,\n        apply: function (view, designedResolution) {\n            var frameW = view._frameSize.width, frameH = view._frameSize.height, containerStyle = cc.game.container.style,\n                designW = designedResolution.width, designH = designedResolution.height,\n                scaleX = frameW / designW, scaleY = frameH / designH,\n                containerW, containerH;\n\n            scaleX < scaleY ? (containerW = frameW, containerH = designH * scaleX) : (containerW = designW * scaleY, containerH = frameH);\n\n            // Adjust container size with integer value\n            var offx = Math.round((frameW - containerW) / 2);\n            var offy = Math.round((frameH - containerH) / 2);\n            containerW = frameW - 2 * offx;\n            containerH = frameH - 2 * offy;\n\n            this._setupContainer(view, containerW, containerH);\n            if (!CC_EDITOR) {\n                // Setup container's margin and padding\n                if (view._isRotated) {\n                    containerStyle.margin = '0 0 0 ' + frameH + 'px';\n                }\n                else {\n                    containerStyle.margin = '0px';\n                }\n                containerStyle.paddingLeft = offx + \"px\";\n                containerStyle.paddingRight = offx + \"px\";\n                containerStyle.paddingTop = offy + \"px\";\n                containerStyle.paddingBottom = offy + \"px\";\n            }\n        }\n    });\n\n    /**\n     * @class EqualToWindow\n     * @extends EqualToFrame\n     */\n    var EqualToWindow = cc.Class({\n        name: \"EqualToWindow\",\n        extends: EqualToFrame,\n        preApply: function (view) {\n            this._super(view);\n            cc.game.frame = document.documentElement;\n        },\n\n        apply: function (view) {\n            this._super(view);\n            this._fixContainer();\n        }\n    });\n\n    /**\n     * @class ProportionalToWindow\n     * @extends ProportionalToFrame\n     */\n    var ProportionalToWindow = cc.Class({\n        name: \"ProportionalToWindow\",\n        extends: ProportionalToFrame,\n        preApply: function (view) {\n            this._super(view);\n            cc.game.frame = document.documentElement;\n        },\n\n        apply: function (view, designedResolution) {\n            this._super(view, designedResolution);\n            this._fixContainer();\n        }\n    });\n\n    /**\n     * @class OriginalContainer\n     * @extends ContainerStrategy\n     */\n    var OriginalContainer = cc.Class({\n        name: \"OriginalContainer\",\n        extends: cc.ContainerStrategy,\n        apply: function (view) {\n            this._setupContainer(view, cc.game.canvas.width, cc.game.canvas.height);\n        }\n    });\n\n    // need to adapt prototype before instantiating\n    let _global = typeof window === 'undefined' ? global : window;\n    let globalAdapter = _global.__globalAdapter;\n    if (globalAdapter) {\n        if (globalAdapter.adaptContainerStrategy) {\n            globalAdapter.adaptContainerStrategy(cc.ContainerStrategy.prototype);\n        }\n        if (globalAdapter.adaptView) {\n            globalAdapter.adaptView(View.prototype);\n        }\n    }\n\n// #NOT STABLE on Android# Alias: Strategy that makes the container's size equals to the window's size\n//    cc.ContainerStrategy.EQUAL_TO_WINDOW = new EqualToWindow();\n// #NOT STABLE on Android# Alias: Strategy that scale proportionally the container's size to window's size\n//    cc.ContainerStrategy.PROPORTION_TO_WINDOW = new ProportionalToWindow();\n// Alias: Strategy that makes the container's size equals to the frame's size\n    cc.ContainerStrategy.EQUAL_TO_FRAME = new EqualToFrame();\n// Alias: Strategy that scale proportionally the container's size to frame's size\n    cc.ContainerStrategy.PROPORTION_TO_FRAME = new ProportionalToFrame();\n// Alias: Strategy that keeps the original container's size\n    cc.ContainerStrategy.ORIGINAL_CONTAINER = new OriginalContainer();\n\n// Content scale strategys\n    var ExactFit = cc.Class({\n        name: \"ExactFit\",\n        extends: cc.ContentStrategy,\n        apply: function (view, designedResolution) {\n            var containerW = cc.game.canvas.width, containerH = cc.game.canvas.height,\n                scaleX = containerW / designedResolution.width, scaleY = containerH / designedResolution.height;\n\n            return this._buildResult(containerW, containerH, containerW, containerH, scaleX, scaleY);\n        }\n    });\n\n    var ShowAll = cc.Class({\n        name: \"ShowAll\",\n        extends: cc.ContentStrategy,\n        apply: function (view, designedResolution) {\n            var containerW = cc.game.canvas.width, containerH = cc.game.canvas.height,\n                designW = designedResolution.width, designH = designedResolution.height,\n                scaleX = containerW / designW, scaleY = containerH / designH, scale = 0,\n                contentW, contentH;\n\n            scaleX < scaleY ? (scale = scaleX, contentW = containerW, contentH = designH * scale)\n                : (scale = scaleY, contentW = designW * scale, contentH = containerH);\n\n            return this._buildResult(containerW, containerH, contentW, contentH, scale, scale);\n        }\n    });\n\n    var NoBorder = cc.Class({\n        name: \"NoBorder\",\n        extends: cc.ContentStrategy,\n        apply: function (view, designedResolution) {\n            var containerW = cc.game.canvas.width, containerH = cc.game.canvas.height,\n                designW = designedResolution.width, designH = designedResolution.height,\n                scaleX = containerW / designW, scaleY = containerH / designH, scale,\n                contentW, contentH;\n\n            scaleX < scaleY ? (scale = scaleY, contentW = designW * scale, contentH = containerH)\n                : (scale = scaleX, contentW = containerW, contentH = designH * scale);\n\n            return this._buildResult(containerW, containerH, contentW, contentH, scale, scale);\n        }\n    });\n\n    var FixedHeight = cc.Class({\n        name: \"FixedHeight\",\n        extends: cc.ContentStrategy,\n        apply: function (view, designedResolution) {\n            var containerW = cc.game.canvas.width, containerH = cc.game.canvas.height,\n                designH = designedResolution.height, scale = containerH / designH,\n                contentW = containerW, contentH = containerH;\n\n            return this._buildResult(containerW, containerH, contentW, contentH, scale, scale);\n        }\n    });\n\n    var FixedWidth = cc.Class({\n        name: \"FixedWidth\",\n        extends: cc.ContentStrategy,\n        apply: function (view, designedResolution) {\n            var containerW = cc.game.canvas.width, containerH = cc.game.canvas.height,\n                designW = designedResolution.width, scale = containerW / designW,\n                contentW = containerW, contentH = containerH;\n\n            return this._buildResult(containerW, containerH, contentW, contentH, scale, scale);\n        }\n    });\n\n// Alias: Strategy to scale the content's size to container's size, non proportional\n    cc.ContentStrategy.EXACT_FIT = new ExactFit();\n// Alias: Strategy to scale the content's size proportionally to maximum size and keeps the whole content area to be visible\n    cc.ContentStrategy.SHOW_ALL = new ShowAll();\n// Alias: Strategy to scale the content's size proportionally to fill the whole container area\n    cc.ContentStrategy.NO_BORDER = new NoBorder();\n// Alias: Strategy to scale the content's height to container's height and proportionally scale its width\n    cc.ContentStrategy.FIXED_HEIGHT = new FixedHeight();\n// Alias: Strategy to scale the content's width to container's width and proportionally scale its height\n    cc.ContentStrategy.FIXED_WIDTH = new FixedWidth();\n\n})();\n\n/**\n * <p>cc.ResolutionPolicy class is the root strategy class of scale strategy,\n * its main task is to maintain the compatibility with Cocos2d-x</p>\n *\n * @class ResolutionPolicy\n */\n/**\n * @method constructor\n * @param {ContainerStrategy} containerStg The container strategy\n * @param {ContentStrategy} contentStg The content strategy\n */\ncc.ResolutionPolicy = cc.Class({\n    name: \"cc.ResolutionPolicy\",\n    /**\n     * Constructor of cc.ResolutionPolicy\n     * @param {ContainerStrategy} containerStg\n     * @param {ContentStrategy} contentStg\n     */\n    ctor: function (containerStg, contentStg) {\n        this._containerStrategy = null;\n        this._contentStrategy = null;\n        this.setContainerStrategy(containerStg);\n        this.setContentStrategy(contentStg);\n    },\n\n    /**\n     * !#en Manipulation before applying the resolution policy\n     * !#zh 策略应用前的操作\n     * @method preApply\n     * @param {View} view The target view\n     */\n    preApply: function (view) {\n        this._containerStrategy.preApply(view);\n        this._contentStrategy.preApply(view);\n    },\n\n    /**\n     * !#en Function to apply this resolution policy\n     * The return value is {scale: [scaleX, scaleY], viewport: {cc.Rect}},\n     * The target view can then apply these value to itself, it's preferred not to modify directly its private variables\n     * !#zh 调用策略方法\n     * @method apply\n     * @param {View} view - The target view\n     * @param {Size} designedResolution - The user defined design resolution\n     * @return {Object} An object contains the scale X/Y values and the viewport rect\n     */\n    apply: function (view, designedResolution) {\n        this._containerStrategy.apply(view, designedResolution);\n        return this._contentStrategy.apply(view, designedResolution);\n    },\n\n    /**\n     * !#en Manipulation after appyling the strategy\n     * !#zh 策略应用之后的操作\n     * @method postApply\n     * @param {View} view - The target view\n     */\n    postApply: function (view) {\n        this._containerStrategy.postApply(view);\n        this._contentStrategy.postApply(view);\n    },\n\n    /**\n     * !#en\n     * Setup the container's scale strategy\n     * !#zh 设置容器的适配策略\n     * @method setContainerStrategy\n     * @param {ContainerStrategy} containerStg\n     */\n    setContainerStrategy: function (containerStg) {\n        if (containerStg instanceof cc.ContainerStrategy)\n            this._containerStrategy = containerStg;\n    },\n\n    /**\n     * !#en\n     * Setup the content's scale strategy\n     * !#zh 设置内容的适配策略\n     * @method setContentStrategy\n     * @param {ContentStrategy} contentStg\n     */\n    setContentStrategy: function (contentStg) {\n        if (contentStg instanceof cc.ContentStrategy)\n            this._contentStrategy = contentStg;\n    }\n});\n\njs.get(cc.ResolutionPolicy.prototype, \"canvasSize\", function () {\n    return cc.v2(cc.game.canvas.width, cc.game.canvas.height);\n});\n\n/**\n * The entire application is visible in the specified area without trying to preserve the original aspect ratio.<br/>\n * Distortion can occur, and the application may appear stretched or compressed.\n * @property {Number} EXACT_FIT\n * @readonly\n * @static\n */\ncc.ResolutionPolicy.EXACT_FIT = 0;\n\n/**\n * The entire application fills the specified area, without distortion but possibly with some cropping,<br/>\n * while maintaining the original aspect ratio of the application.\n * @property {Number} NO_BORDER\n * @readonly\n * @static\n */\ncc.ResolutionPolicy.NO_BORDER = 1;\n\n/**\n * The entire application is visible in the specified area without distortion while maintaining the original<br/>\n * aspect ratio of the application. Borders can appear on two sides of the application.\n * @property {Number} SHOW_ALL\n * @readonly\n * @static\n */\ncc.ResolutionPolicy.SHOW_ALL = 2;\n\n/**\n * The application takes the height of the design resolution size and modifies the width of the internal<br/>\n * canvas so that it fits the aspect ratio of the device<br/>\n * no distortion will occur however you must make sure your application works on different<br/>\n * aspect ratios\n * @property {Number} FIXED_HEIGHT\n * @readonly\n * @static\n */\ncc.ResolutionPolicy.FIXED_HEIGHT = 3;\n\n/**\n * The application takes the width of the design resolution size and modifies the height of the internal<br/>\n * canvas so that it fits the aspect ratio of the device<br/>\n * no distortion will occur however you must make sure your application works on different<br/>\n * aspect ratios\n * @property {Number} FIXED_WIDTH\n * @readonly\n * @static\n */\ncc.ResolutionPolicy.FIXED_WIDTH = 4;\n\n/**\n * Unknow policy\n * @property {Number} UNKNOWN\n * @readonly\n * @static\n */\ncc.ResolutionPolicy.UNKNOWN = 5;\n\n/**\n * @module cc\n */\n\n/**\n * !#en cc.view is the shared view object.\n * !#zh cc.view 是全局的视图对象。\n * @property view\n * @static\n * @type {View}\n */\ncc.view = new View();\n\n/**\n * !#en cc.winSize is the alias object for the size of the current game window.\n * !#zh cc.winSize 为当前的游戏窗口的大小。\n * @property winSize\n * @type Size\n */\ncc.winSize = cc.size();\n\nmodule.exports = cc.view;\n","/****************************************************************************\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * cc.visibleRect is a singleton object which defines the actual visible rect of the current view,\n * it should represent the same rect as cc.view.getViewportRect()\n *\n * @class visibleRect\n */\ncc.visibleRect = {\n    topLeft:cc.v2(0,0),\n    topRight:cc.v2(0,0),\n    top:cc.v2(0,0),\n    bottomLeft:cc.v2(0,0),\n    bottomRight:cc.v2(0,0),\n    bottom:cc.v2(0,0),\n    center:cc.v2(0,0),\n    left:cc.v2(0,0),\n    right:cc.v2(0,0),\n    width:0,\n    height:0,\n\n    /**\n     * initialize\n     * @method init\n     * @param {Rect} visibleRect\n     */\n    init:function(visibleRect){\n\n        var w = this.width = visibleRect.width;\n        var h = this.height = visibleRect.height;\n        var l = visibleRect.x,\n            b = visibleRect.y,\n            t = b + h,\n            r = l + w;\n\n        //top\n        this.topLeft.x = l;\n        this.topLeft.y = t;\n        this.topRight.x = r;\n        this.topRight.y = t;\n        this.top.x = l + w/2;\n        this.top.y = t;\n\n        //bottom\n        this.bottomLeft.x = l;\n        this.bottomLeft.y = b;\n        this.bottomRight.x = r;\n        this.bottomRight.y = b;\n        this.bottom.x = l + w/2;\n        this.bottom.y = b;\n\n        //center\n        this.center.x = l + w/2;\n        this.center.y = b + h/2;\n\n        //left\n        this.left.x = l;\n        this.left.y = b + h/2;\n\n        //right\n        this.right.x = r;\n        this.right.y = b + h/2;\n    }\n};\n\n/**\n * Top left coordinate of the screen related to the game scene.\n * @property {Vec2} topLeft\n */\n\n/**\n * Top right coordinate of the screen related to the game scene.\n * @property {Vec2} topRight\n */\n\n/**\n * Top center coordinate of the screen related to the game scene.\n * @property {Vec2} top\n */\n\n/**\n * Bottom left coordinate of the screen related to the game scene.\n * @property {Vec2} bottomLeft\n */\n\n/**\n * Bottom right coordinate of the screen related to the game scene.\n * @property {Vec2} bottomRight\n */\n\n/**\n * Bottom center coordinate of the screen related to the game scene.\n * @property {Vec2} bottom\n */\n\n/**\n * Center coordinate of the screen related to the game scene.\n * @property {Vec2} center\n */\n\n/**\n * Left center coordinate of the screen related to the game scene.\n * @property {Vec2} left\n */\n\n/**\n * Right center coordinate of the screen related to the game scene.\n * @property {Vec2} right\n */\n\n/**\n * Width of the screen.\n * @property {Number} width\n */\n\n/**\n * Height of the screen.\n * @property {Number} height\n */\n\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require('./js');\nvar isPlainEmptyObj = require('./utils').isPlainEmptyObj_DEV;\n\nconst DELIMETER = '$_$';\n\nfunction createAttrsSingle (owner, superAttrs) {\n    var attrs = superAttrs ? Object.create(superAttrs) : {};\n    js.value(owner, '__attrs__', attrs);\n    return attrs;\n}\n\n// subclass should not have __attrs__\nfunction createAttrs (subclass) {\n    if (typeof subclass !== 'function') {\n        // attributes only in instance\n        let instance = subclass;\n        return createAttrsSingle(instance, getClassAttrs(instance.constructor));\n    }\n    var superClass;\n    var chains = cc.Class.getInheritanceChain(subclass);\n    for (var i = chains.length - 1; i >= 0; i--) {\n        var cls = chains[i];\n        var attrs = cls.hasOwnProperty('__attrs__') && cls.__attrs__;\n        if (!attrs) {\n            superClass = chains[i + 1];\n            createAttrsSingle(cls, superClass && superClass.__attrs__);\n        }\n    }\n    superClass = chains[0];\n    createAttrsSingle(subclass, superClass && superClass.__attrs__);\n    return subclass.__attrs__;\n}\n\n// /**\n//  * @class Class\n//  */\n\n//  *\n//  * Tag the class with any meta attributes, then return all current attributes assigned to it.\n//  * This function holds only the attributes, not their implementations.\n//  *\n//  * @method attr\n//  * @param {Function|Object} ctor - the class or instance. If instance, the attribute will be dynamic and only available for the specified instance.\n//  * @param {String} propName - the name of property or function, used to retrieve the attributes\n//  * @param {Object} [newAttrs] - the attribute table to mark, new attributes will merged with existed attributes. Attribute whose key starts with '_' will be ignored.\n//  * @static\n//  * @private\nfunction attr (ctor, propName, newAttrs) {\n    var attrs = getClassAttrs(ctor);\n    if (!CC_DEV || typeof newAttrs === 'undefined') {\n        // get\n        var prefix = propName + DELIMETER;\n        var ret = {};\n        for (let key in attrs) {\n            if (key.startsWith(prefix)) {\n                ret[key.slice(prefix.length)] = attrs[key];\n            }\n        }\n        return ret;\n    }\n    else if (CC_DEV && typeof newAttrs === 'object') {\n        // set\n        cc.warn(`\\`cc.Class.attr(obj, prop, { key: value });\\` is deprecated, use \\`cc.Class.Attr.setClassAttr(obj, prop, 'key', value);\\` instead please.`);\n        for (let key in newAttrs) {\n            attrs[propName + DELIMETER + key] = newAttrs[key];\n        }\n    }\n}\n\n// returns a readonly meta object\nfunction getClassAttrs (ctor) {\n    return (ctor.hasOwnProperty('__attrs__') && ctor.__attrs__) || createAttrs(ctor);\n}\n\nfunction setClassAttr (ctor, propName, key, value) {\n    getClassAttrs(ctor)[propName + DELIMETER + key] = value;\n}\n\n/**\n * @module cc\n */\n\nfunction PrimitiveType (name, def) {\n    this.name = name;\n    this.default = def;\n}\nPrimitiveType.prototype.toString = function () {\n    return this.name;\n};\n\n/**\n * Specify that the input value must be integer in Inspector.\n * Also used to indicates that the elements in array should be type integer.\n * @property {string} Integer\n * @readonly\n * @example\n * // in cc.Class\n * member: {\n *     default: [],\n *     type: cc.Integer\n * }\n * // ES6 ccclass\n * @cc._decorator.property({\n *     type: cc.Integer\n * })\n * member = [];\n */\ncc.Integer = new PrimitiveType('Integer', 0);\n\n/**\n * Indicates that the elements in array should be type double.\n * @property {string} Float\n * @readonly\n * @example\n * // in cc.Class\n * member: {\n *     default: [],\n *     type: cc.Float\n * }\n * // ES6 ccclass\n * @cc._decorator.property({\n *     type: cc.Float\n * })\n * member = [];\n */\ncc.Float = new PrimitiveType('Float', 0);\n\nif (CC_EDITOR) {\n    js.get(cc, 'Number', function () {\n        cc.warnID(3603);\n        return cc.Float;\n    });\n}\n\n/**\n * Indicates that the elements in array should be type boolean.\n * @property {string} Boolean\n * @readonly\n * @example\n * // in cc.Class\n * member: {\n *     default: [],\n *     type: cc.Boolean\n * }\n * // ES6 ccclass\n * @cc._decorator.property({\n *     type: cc.Boolean\n * })\n * member = [];\n */\ncc.Boolean = new PrimitiveType('Boolean', false);\n\n/**\n * Indicates that the elements in array should be type string.\n * @property {string} String\n * @readonly\n * @example\n * // in cc.Class\n * member: {\n *     default: [],\n *     type: cc.String\n * }\n * // ES6 ccclass\n * @cc._decorator.property({\n *     type: cc.String\n * })\n * member = [];\n */\ncc.String = new PrimitiveType('String', '');\n\n// Ensures the type matches its default value\nfunction getTypeChecker (type, attrName) {\n    return function (constructor, mainPropName) {\n        var propInfo = '\"' + js.getClassName(constructor) + '.' + mainPropName + '\"';\n        var mainPropAttrs = attr(constructor, mainPropName);\n        if (!mainPropAttrs.saveUrlAsAsset) {\n            var mainPropAttrsType = mainPropAttrs.type;\n            if (mainPropAttrsType === cc.Integer || mainPropAttrsType === cc.Float) {\n                mainPropAttrsType = 'Number';\n            }\n            else if (mainPropAttrsType === cc.String || mainPropAttrsType === cc.Boolean) {\n                mainPropAttrsType = '' + mainPropAttrsType;\n            }\n            if (mainPropAttrsType !== type) {\n                cc.warnID(3604, propInfo);\n                return;\n            }\n        }\n        if (!mainPropAttrs.hasOwnProperty('default')) {\n            return;\n        }\n        var defaultVal = mainPropAttrs.default;\n        if (typeof defaultVal === 'undefined') {\n            return;\n        }\n        var isContainer = Array.isArray(defaultVal) || isPlainEmptyObj(defaultVal);\n        if (isContainer) {\n            return;\n        }\n        var defaultType = typeof defaultVal;\n        var type_lowerCase = type.toLowerCase();\n        if (defaultType === type_lowerCase) {\n            if (!mainPropAttrs.saveUrlAsAsset) {\n                if (type_lowerCase === 'object') {\n                    if (defaultVal && !(defaultVal instanceof mainPropAttrs.ctor)) {\n                        cc.warnID(3605, propInfo, js.getClassName(mainPropAttrs.ctor));\n                    }\n                    else {\n                        return;\n                    }\n                }\n                else if (type !== 'Number') {\n                    cc.warnID(3606, attrName, propInfo, type);\n                }\n            }\n        }\n        else if (defaultType !== 'function') {\n            if (type === cc.String && defaultVal == null) {\n                if (!js.isChildClassOf(mainPropAttrs.ctor, cc.RawAsset)) {\n                    cc.warnID(3607, propInfo);\n                }\n            }\n            else {\n                cc.warnID(3611, attrName, propInfo, defaultType);\n            }\n        }\n        else {\n            return;\n        }\n        delete mainPropAttrs.type;\n    };\n}\n\n// Ensures the type matches its default value\nfunction getObjTypeChecker (typeCtor) {\n    return function (classCtor, mainPropName) {\n        getTypeChecker('Object', 'type')(classCtor, mainPropName);\n        // check ValueType\n        var defaultDef = getClassAttrs(classCtor)[mainPropName + DELIMETER + 'default'];\n        var defaultVal = require('./CCClass').getDefault(defaultDef);\n        if (!Array.isArray(defaultVal) && js.isChildClassOf(typeCtor, cc.ValueType)) {\n            var typename = js.getClassName(typeCtor);\n            var info = cc.js.formatStr('No need to specify the \"type\" of \"%s.%s\" because %s is a child class of ValueType.',\n                js.getClassName(classCtor), mainPropName, typename);\n            if (defaultDef) {\n                cc.log(info);\n            }\n            else {\n                cc.warnID(3612, info, typename, js.getClassName(classCtor), mainPropName, typename);\n            }\n        }\n    };\n}\n\nmodule.exports = {\n    PrimitiveType,\n    attr: attr,\n    getClassAttrs: getClassAttrs,\n    setClassAttr: setClassAttr,\n    DELIMETER: DELIMETER,\n    getTypeChecker_ET: ((CC_EDITOR && !Editor.isBuilder) || CC_TEST) && getTypeChecker,\n    getObjTypeChecker_ET: ((CC_EDITOR && !Editor.isBuilder) || CC_TEST) && getObjTypeChecker,\n    ScriptUuid: {},      // the value will be represented as a uuid string\n};\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst js = require('./js');\nconst fastRemoveAt = js.array.fastRemoveAt;\n\nfunction empty () {}\n\nfunction CallbackInfo () {\n    this.callback = empty;\n    this.target = undefined;\n    this.once = false;\n}\n\nCallbackInfo.prototype.set = function (callback, target, once) {\n    this.callback = callback;\n    this.target = target;\n    this.once = !!once;\n};\n\nlet callbackInfoPool = new js.Pool(function (info) {\n    info.callback = empty;\n    info.target = undefined;\n    info.once = false;\n    return true;\n}, 32);\n\ncallbackInfoPool.get = function () {\n    return this._get() || new CallbackInfo();\n};\n\nfunction CallbackList () {\n    this.callbackInfos = [];\n    this.isInvoking = false;\n    this.containCanceled = false;\n}\n\nlet proto = CallbackList.prototype;\n\n/**\n * !#zh\n * 从列表中移除与指定目标相同回调函数的事件。\n * @param cb\n */\nproto.removeByCallback = function (cb) {\n    for (let i = 0; i < this.callbackInfos.length; ++i) {\n        let info = this.callbackInfos[i];\n        if (info && info.callback === cb) {\n            callbackInfoPool.put(info);\n            fastRemoveAt(this.callbackInfos, i);\n            --i;\n        }\n    }\n};\n\n/**\n * !#zh\n * 从列表中移除与指定目标相同调用者的事件。\n * @param target\n */\nproto.removeByTarget = function (target) {\n    for (let i = 0; i < this.callbackInfos.length; ++i) {\n        const info = this.callbackInfos[i];\n        if (info && info.target === target) {\n            callbackInfoPool.put(info);\n            fastRemoveAt(this.callbackInfos, i);\n            --i;\n        }\n    }\n};\n\n/**\n * !#zh\n * 移除指定编号事件。\n *\n * @param index\n */\nproto.cancel = function (index) {\n    const info = this.callbackInfos[index];\n    if (info) {\n        callbackInfoPool.put(info);\n        this.callbackInfos[index] = null;\n    }\n    this.containCanceled = true;\n};\n\n/**\n * !#zh\n * 注销所有事件。\n */\nproto.cancelAll = function () {\n    for (let i = 0; i < this.callbackInfos.length; i++) {\n        const info = this.callbackInfos[i];\n        if (info) {\n            callbackInfoPool.put(info);\n            this.callbackInfos[i] = null;\n        }\n    }\n    this.containCanceled = true;\n};\n\n// filter all removed callbacks and compact array\nproto.purgeCanceled = function () {\n    for (let i = this.callbackInfos.length - 1; i >= 0; --i) {\n        const info = this.callbackInfos[i];\n        if (!info) {\n            fastRemoveAt(this.callbackInfos, i);\n        }\n    }\n    this.containCanceled = false;\n};\n\nproto.clear = function () {\n    this.cancelAll();\n    this.callbackInfos.length = 0;\n    this.isInvoking = false;\n    this.containCanceled = false;\n};\n\nconst MAX_SIZE = 16;\nlet callbackListPool = new js.Pool(function (info) {\n    info.callbackInfos = [];\n    info.isInvoking = false;\n    info.containCanceled = false;\n    return true;\n}, MAX_SIZE);\n\ncallbackListPool.get = function () {\n    return this._get() || new CallbackList();\n};\n\n/**\n * !#en The callbacks invoker to handle and invoke callbacks by key.\n * !#zh CallbacksInvoker 用来根据 Key 管理并调用回调方法。\n * @class CallbacksInvoker\n */\nfunction CallbacksInvoker () {\n    this._callbackTable = js.createMap(true);\n}\n\nproto = CallbacksInvoker.prototype;\n\n/**\n * !#zh\n * 事件添加管理\n *\n * @param key\n * @param callback\n * @param target\n * @param once\n */\nproto.on = function (key, callback, target, once) {\n    let list = this._callbackTable[key];\n    if (!list) {\n        list = this._callbackTable[key] = callbackListPool.get();\n    }\n    let info = callbackInfoPool.get();\n    info.set(callback, target, once);\n    list.callbackInfos.push(info);\n};\n\n/**\n *\n * !#zh\n * 检查指定事件是否已注册回调。\n *\n * !#en\n * Check if the specified key has any registered callback. If a callback is also specified,\n * it will only return true if the callback is registered.\n *\n * @method hasEventListener\n * @param {String} key\n * @param {Function} [callback]\n * @param {Object} [target]\n * @return {Boolean}\n */\nproto.hasEventListener = function (key, callback, target) {\n    const list = this._callbackTable[key];\n    if (!list) {\n        return false;\n    }\n\n    // check any valid callback\n    const infos = list.callbackInfos;\n    if (!callback) {\n        // Make sure no cancelled callbacks\n        if (list.isInvoking) {\n            for (let i = 0; i < infos.length; ++i) {\n                if (infos[i]) {\n                    return true;\n                }\n            }\n            return false;\n        }\n        else {\n            return infos.length > 0;\n        }\n    }\n\n    for (let i = 0; i < infos.length; ++i) {\n        const info = infos[i];\n        if (info && info.callback === callback && info.target === target) {\n            return true;\n        }\n    }\n    return false;\n};\n\n/**\n * !#zh\n * 移除在特定事件类型中注册的所有回调或在某个目标中注册的所有回调。\n *\n * !#en\n * Removes all callbacks registered in a certain event type or all callbacks registered with a certain target\n * @method removeAll\n * @param {String|Object} keyOrTarget - The event key to be removed or the target to be removed\n */\nproto.removeAll = function (keyOrTarget) {\n    if (typeof keyOrTarget === 'string') {\n        // remove by key\n        const list = this._callbackTable[keyOrTarget];\n        if (list) {\n            if (list.isInvoking) {\n                list.cancelAll();\n            }\n            else {\n                list.clear();\n                callbackListPool.put(list);\n                delete this._callbackTable[keyOrTarget];\n            }\n        }\n    }\n    else if (keyOrTarget) {\n        // remove by target\n        for (const key in this._callbackTable) {\n            const list = this._callbackTable[key];\n            if (list.isInvoking) {\n                const infos = list.callbackInfos;\n                for (let i = 0; i < infos.length; ++i) {\n                    const info = infos[i];\n                    if (info && info.target === keyOrTarget) {\n                        list.cancel(i);\n                    }\n                }\n            }\n            else {\n                list.removeByTarget(keyOrTarget);\n            }\n        }\n    }\n};\n\n/**\n * !#zh\n * 删除之前与同类型，回调，目标注册的回调。\n *\n * @method off\n * @param {String} key\n * @param {Function} callback\n * @param {Object} [target]\n */\nproto.off = function (key, callback, target) {\n    const list = this._callbackTable[key];\n    if (list) {\n        const infos = list.callbackInfos;\n        for (let i = 0; i < infos.length; ++i) {\n            const info = infos[i];\n            if (info && info.callback === callback && info.target === target) {\n                if (list.isInvoking) {\n                    list.cancel(i);\n                }\n                else {\n                    fastRemoveAt(infos, i);\n                    callbackInfoPool.put(info);\n                }\n                break;\n            }\n        }\n    }\n};\n\n\n/**\n * !#en\n * Trigger an event directly with the event name and necessary arguments.\n * !#zh\n * 通过事件名发送自定义事件\n *\n * @method emit\n * @param {String} key - event type\n * @param {*} [arg1] - First argument\n * @param {*} [arg2] - Second argument\n * @param {*} [arg3] - Third argument\n * @param {*} [arg4] - Fourth argument\n * @param {*} [arg5] - Fifth argument\n * @example\n *\n * eventTarget.emit('fire', event);\n * eventTarget.emit('fire', message, emitter);\n */\nproto.emit = function (key, arg1, arg2, arg3, arg4, arg5) {\n    const list = this._callbackTable[key];\n    if (list) {\n        const rootInvoker = !list.isInvoking;\n        list.isInvoking = true;\n\n        const infos = list.callbackInfos;\n        for (let i = 0, len = infos.length; i < len; ++i) {\n            const info = infos[i];\n            if (info) {\n                let target = info.target;\n                let callback = info.callback;\n                if (info.once) {\n                    this.off(key, callback, target);\n                }\n\n                if (target) {\n                    callback.call(target, arg1, arg2, arg3, arg4, arg5);\n                }\n                else {\n                    callback(arg1, arg2, arg3, arg4, arg5);\n                }\n            }\n        }\n\n        if (rootInvoker) {\n            list.isInvoking = false;\n            if (list.containCanceled) {\n                list.purgeCanceled();\n            }\n        }\n    }\n};\n\nif (CC_TEST) {\n    cc._Test.CallbacksInvoker = CallbacksInvoker;\n}\n\nmodule.exports = CallbacksInvoker;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nfunction deepFlatten (strList, array) {\n    for (var i = 0; i < array.length; i++) {\n        var item = array[i];\n        if (Array.isArray(item)) {\n            deepFlatten(strList, item);\n        }\n        // else if (item instanceof Declaration) {\n        //     strList.push(item.toString());\n        // }\n        else {\n            strList.push(item);\n        }\n    }\n}\n\nfunction flattenCodeArray (array) {\n    var separator = CC_DEV ? '\\n' : '';\n    var strList = [];\n    deepFlatten(strList, array);\n    return strList.join(separator);\n}\n\nmodule.exports = {\n    flattenCodeArray\n};\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require('./js');\nvar Attr = require('./attribute');\nvar CCClass = require('./CCClass');\nvar misc = require('../utils/misc');\n\n// HELPERS\n\n/**\n * !#en Contains information collected during deserialization\n * !#zh 包含反序列化时的一些信息\n * @class Details\n *\n */\nvar Details = function () {\n    /**\n     * list of the depends assets' uuid\n     * @property {String[]} uuidList\n     */\n    this.uuidList = [];\n    /**\n     * the obj list whose field needs to load asset by uuid\n     * @property {Object[]} uuidObjList\n     */\n    this.uuidObjList = [];\n    /**\n     * the corresponding field name which referenced to the asset\n     * @property {String[]} uuidPropList\n     */\n    this.uuidPropList = [];\n\n    // TODO - DELME since 2.0\n    this._stillUseUrl = js.createMap(true);\n};\n/**\n * @method reset\n */\nDetails.prototype.reset = function () {\n    this.uuidList.length = 0;\n    this.uuidObjList.length = 0;\n    this.uuidPropList.length = 0;\n    js.clear(this._stillUseUrl);\n};\nif (CC_EDITOR || CC_TEST) {\n    Details.prototype.assignAssetsBy = function (getter) {\n        // ignore this._stillUseUrl\n        for (var i = 0, len = this.uuidList.length; i < len; i++) {\n            var uuid = this.uuidList[i];\n            var obj = this.uuidObjList[i];\n            var prop = this.uuidPropList[i];\n            obj[prop] = getter(uuid);\n        }\n    };\n}\n// /**\n//  * @method getUuidOf\n//  * @param {Object} obj\n//  * @param {String} propName\n//  * @return {String}\n//  */\n// Details.prototype.getUuidOf = function (obj, propName) {\n//     for (var i = 0; i < this.uuidObjList.length; i++) {\n//         if (this.uuidObjList[i] === obj && this.uuidPropList[i] === propName) {\n//             return this.uuidList[i];\n//         }\n//     }\n//     return \"\";\n// };\n/**\n * @method push\n * @param {Object} obj\n * @param {String} propName\n * @param {String} uuid\n */\nDetails.prototype.push = function (obj, propName, uuid, _stillUseUrl) {\n    if (_stillUseUrl) {\n        this._stillUseUrl[this.uuidList.length] = true;\n    }\n    this.uuidList.push(uuid);\n    this.uuidObjList.push(obj);\n    this.uuidPropList.push(propName);\n};\n\nDetails.pool = new js.Pool(function (obj) {\n    obj.reset();\n}, 10);\n\nDetails.pool.get = function () {\n    return this._get() || new Details();\n};\n\n// IMPLEMENT OF DESERIALIZATION\n\nvar _Deserializer = (function () {\n    function _Deserializer(result, target, classFinder, customEnv, ignoreEditorOnly) {\n        this.result = result;\n        this.customEnv = customEnv;\n        this.deserializedList = [];\n        this.deserializedData = null;\n        this._classFinder = classFinder;\n        if (CC_DEV) {\n            this._target = target;\n            this._ignoreEditorOnly = ignoreEditorOnly;\n        }\n        this._idList = [];\n        this._idObjList = [];\n        this._idPropList = [];\n    }\n\n    function _dereference (self) {\n        // 这里不采用遍历反序列化结果的方式，因为反序列化的结果如果引用到复杂的外部库，很容易堆栈溢出。\n        var deserializedList = self.deserializedList;\n        var idPropList = self._idPropList;\n        var idList = self._idList;\n        var idObjList = self._idObjList;\n        var onDereferenced = self._classFinder && self._classFinder.onDereferenced;\n        var i, propName, id;\n        if (CC_EDITOR && onDereferenced) {\n            for (i = 0; i < idList.length; i++) {\n                propName = idPropList[i];\n                id = idList[i];\n                idObjList[i][propName] = deserializedList[id];\n                onDereferenced(deserializedList, id, idObjList[i], propName);\n            }\n        }\n        else {\n            for (i = 0; i < idList.length; i++) {\n                propName = idPropList[i];\n                id = idList[i];\n                idObjList[i][propName] = deserializedList[id];\n            }\n        }\n    }\n\n    var prototype = _Deserializer.prototype;\n\n    prototype.deserialize = function (jsonObj) {\n        if (Array.isArray(jsonObj)) {\n            var jsonArray = jsonObj;\n            var refCount = jsonArray.length;\n            this.deserializedList.length = refCount;\n            // deserialize\n            for (var i = 0; i < refCount; i++) {\n                if (jsonArray[i]) {\n                    if (CC_EDITOR || CC_TEST) {\n                        var mainTarget = (i === 0 && this._target);\n                        this.deserializedList[i] = this._deserializeObject(jsonArray[i], false, mainTarget, this.deserializedList, '' + i);\n                    }\n                    else {\n                        this.deserializedList[i] = this._deserializeObject(jsonArray[i], false);\n                    }\n                }\n            }\n            this.deserializedData = refCount > 0 ? this.deserializedList[0] : [];\n\n            //// callback\n            //for (var j = 0; j < refCount; j++) {\n            //    if (referencedList[j].onAfterDeserialize) {\n            //        referencedList[j].onAfterDeserialize();\n            //    }\n            //}\n        }\n        else {\n            this.deserializedList.length = 1;\n            if (CC_EDITOR || CC_TEST) {\n                this.deserializedData = jsonObj ? this._deserializeObject(jsonObj, false, this._target, this.deserializedList, '0') : null;\n            }\n            else {\n                this.deserializedData = jsonObj ? this._deserializeObject(jsonObj, false) : null;\n            }\n            this.deserializedList[0] = this.deserializedData;\n\n            //// callback\n            //if (deserializedData.onAfterDeserialize) {\n            //    deserializedData.onAfterDeserialize();\n            //}\n        }\n\n        // dereference\n        _dereference(this);\n\n        return this.deserializedData;\n    };\n\n    ///**\n    // * @param {Object} serialized - The obj to deserialize, must be non-nil\n    // * @param {Boolean} _stillUseUrl\n    // * @param {Object} [target=null] - editor only\n    // * @param {Object} [owner] - debug only\n    // * @param {String} [propName] - debug only\n    // */\n    prototype._deserializeObject = function (serialized, _stillUseUrl, target, owner, propName) {\n        var prop;\n        var obj = null;     // the obj to return\n        var klass = null;\n        var type = serialized.__type__;\n        if (type === 'TypedArray') {\n            var array = serialized.array;\n            obj = new window[serialized.ctor](array.length);\n            for (let i = 0; i < array.length; ++i) {\n                obj[i] = array[i];\n            }\n            return obj;\n        }\n        else if (type) {\n\n            // Type Object (including CCClass)\n\n            klass = this._classFinder(type, serialized, owner, propName);\n            if (!klass) {\n                var notReported = this._classFinder === js._getClassById;\n                if (notReported) {\n                    cc.deserialize.reportMissingClass(type);\n                }\n                return null;\n            }\n\n            if ((CC_EDITOR || CC_TEST) && target) {\n                // use target\n                if ( !(target instanceof klass) ) {\n                    cc.warnID(5300, js.getClassName(target), klass);\n                }\n                obj = target;\n            }\n            else {\n                // instantiate a new object\n                obj = new klass();\n            }\n\n            if (obj._deserialize) {\n                obj._deserialize(serialized.content, this);\n                return obj;\n            }\n            if (cc.Class._isCCClass(klass)) {\n                _deserializeFireClass(this, obj, serialized, klass, target);\n            }\n            else {\n                this._deserializeTypedObject(obj, serialized, klass);\n            }\n        }\n        else if ( !Array.isArray(serialized) ) {\n\n            // embedded primitive javascript object\n\n            obj = ((CC_EDITOR || CC_TEST) && target) || {};\n            this._deserializePrimitiveObject(obj, serialized);\n        }\n        else {\n\n            // Array\n\n            if ((CC_EDITOR || CC_TEST) && target) {\n                target.length = serialized.length;\n                obj = target;\n            }\n            else {\n                obj = new Array(serialized.length);\n            }\n\n            for (let i = 0; i < serialized.length; i++) {\n                prop = serialized[i];\n                if (typeof prop === 'object' && prop) {\n                    if (CC_EDITOR || CC_TEST) {\n                        this._deserializeObjField(obj, prop, '' + i, target && obj, _stillUseUrl);\n                    }\n                    else {\n                        this._deserializeObjField(obj, prop, '' + i, null, _stillUseUrl);\n                    }\n                }\n                else {\n                    obj[i] = prop;\n                }\n            }\n        }\n        return obj;\n    };\n\n    // 和 _deserializeObject 不同的地方在于会判断 id 和 uuid\n    prototype._deserializeObjField = function (obj, jsonObj, propName, target, _stillUseUrl) {\n        var id = jsonObj.__id__;\n        if (id === undefined) {\n            var uuid = jsonObj.__uuid__;\n            if (uuid) {\n                //if (ENABLE_TARGET) {\n                    //这里不做任何操作，因为有可能调用者需要知道依赖哪些 asset。\n                    //调用者使用 uuidList 时，可以判断 obj[propName] 是否为空，为空则表示待进一步加载，\n                    //不为空则只是表明依赖关系。\n                //    if (target && target[propName] && target[propName]._uuid === uuid) {\n                //        console.assert(obj[propName] === target[propName]);\n                //        return;\n                //    }\n                // }\n                this.result.push(obj, propName, uuid, _stillUseUrl);\n            }\n            else {\n                if (CC_EDITOR || CC_TEST) {\n                    obj[propName] = this._deserializeObject(jsonObj, _stillUseUrl, target && target[propName], obj, propName);\n                }\n                else {\n                    obj[propName] = this._deserializeObject(jsonObj, _stillUseUrl);\n                }\n            }\n        }\n        else {\n            var dObj = this.deserializedList[id];\n            if (dObj) {\n                obj[propName] = dObj;\n            }\n            else {\n                this._idList.push(id);\n                this._idObjList.push(obj);\n                this._idPropList.push(propName);\n            }\n        }\n    };\n\n    prototype._deserializePrimitiveObject = function (instance, serialized) {\n        var self = this;\n        for (var propName in serialized) {\n            if (serialized.hasOwnProperty(propName)) {\n                var prop = serialized[propName];\n                if (typeof prop !== 'object') {\n                    if (propName !== '__type__'/* && k != '__id__'*/) {\n                        instance[propName] = prop;\n                    }\n                }\n                else {\n                    if (prop) {\n                        if (CC_EDITOR || CC_TEST) {\n                            self._deserializeObjField(instance, prop, propName, self._target && instance);\n                        }\n                        else {\n                            self._deserializeObjField(instance, prop, propName);\n                        }\n                    }\n                    else {\n                        instance[propName] = null;\n                    }\n                }\n\n            }\n        }\n    };\n\n    // function _compileTypedObject (accessor, klass, ctorCode) {\n    //     if (klass === cc.Vec2) {\n    //         return `{` +\n    //                     `o${accessor}.x=prop.x||0;` +\n    //                     `o${accessor}.y=prop.y||0;` +\n    //                `}`;\n    //     }\n    //     else if (klass === cc.Color) {\n    //         return `{` +\n    //                    `o${accessor}.r=prop.r||0;` +\n    //                    `o${accessor}.g=prop.g||0;` +\n    //                    `o${accessor}.b=prop.b||0;` +\n    //                    `o${accessor}.a=(prop.a===undefined?255:prop.a);` +\n    //                `}`;\n    //     }\n    //     else if (klass === cc.Size) {\n    //         return `{` +\n    //                    `o${accessor}.width=prop.width||0;` +\n    //                    `o${accessor}.height=prop.height||0;` +\n    //                `}`;\n    //     }\n    //     else {\n    //         return `s._deserializeTypedObject(o${accessor},prop,${ctorCode});`;\n    //     }\n    // }\n\n    // deserialize ValueType\n    prototype._deserializeTypedObject = function (instance, serialized, klass) {\n        if (klass === cc.Vec2) {\n            instance.x = serialized.x || 0;\n            instance.y = serialized.y || 0;\n            return;\n        }\n        else if (klass === cc.Vec3) {\n            instance.x = serialized.x || 0;\n            instance.y = serialized.y || 0;\n            instance.z = serialized.z || 0;\n            return;\n        }\n        else if (klass === cc.Color) {\n            instance.r = serialized.r || 0;\n            instance.g = serialized.g || 0;\n            instance.b = serialized.b || 0;\n            var a = serialized.a;\n            instance.a = (a === undefined ? 255 : a);\n            return;\n        }\n        else if (klass === cc.Size) {\n            instance.width = serialized.width || 0;\n            instance.height = serialized.height || 0;\n            return;\n        }\n\n        var DEFAULT = Attr.DELIMETER + 'default';\n        var attrs = Attr.getClassAttrs(klass);\n        var fastDefinedProps = klass.__props__ ||\n                               Object.keys(instance);    // 遍历 instance，如果具有类型，才不会把 __type__ 也读进来\n        for (var i = 0; i < fastDefinedProps.length; i++) {\n            var propName = fastDefinedProps[i];\n            var value = serialized[propName];\n            if (value === undefined || !serialized.hasOwnProperty(propName)) {\n                // not serialized,\n                // recover to default value in ValueType, because eliminated properties equals to\n                // its default value in ValueType, not default value in user class\n                value = CCClass.getDefault(attrs[propName + DEFAULT]);\n            }\n\n            if (typeof value !== 'object') {\n                instance[propName] = value;\n            }\n            else if (value) {\n                if (CC_EDITOR || CC_TEST) {\n                    this._deserializeObjField(instance, value, propName, this._target && instance);\n                }\n                else {\n                    this._deserializeObjField(instance, value, propName);\n                }\n            }\n            else {\n                instance[propName] = null;\n            }\n        }\n    };\n\n    function compileObjectTypeJit (sources, defaultValue, accessorToSet, propNameLiteralToSet, assumeHavePropIfIsValue, stillUseUrl) {\n        if (defaultValue instanceof cc.ValueType) {\n            // fast case\n            if (!assumeHavePropIfIsValue) {\n                sources.push('if(prop){');\n            }\n            var ctorCode = js.getClassName(defaultValue);\n            sources.push(`s._deserializeTypedObject(o${accessorToSet},prop,${ctorCode});`);\n            if (!assumeHavePropIfIsValue) {\n                sources.push('}else o' + accessorToSet + '=null;');\n            }\n        }\n        else {\n            sources.push('if(prop){');\n                sources.push('s._deserializeObjField(o,prop,' +\n                                 propNameLiteralToSet +\n                                 ((CC_EDITOR || CC_TEST) ? ',t&&o,' : ',null,') +\n                                 !!stillUseUrl +\n                             ');');\n            sources.push('}else o' + accessorToSet + '=null;');\n        }\n    }\n\n    var compileDeserialize = CC_SUPPORT_JIT ? function (self, klass) {\n        var TYPE = Attr.DELIMETER + 'type';\n        var EDITOR_ONLY = Attr.DELIMETER + 'editorOnly';\n        var DEFAULT = Attr.DELIMETER + 'default';\n        var SAVE_URL_AS_ASSET = Attr.DELIMETER + 'saveUrlAsAsset';\n        var FORMERLY_SERIALIZED_AS = Attr.DELIMETER + 'formerlySerializedAs';\n        var attrs = Attr.getClassAttrs(klass);\n\n        var props = klass.__values__;\n        // self, obj, serializedData, klass, target\n        var sources = [\n            'var prop;'\n        ];\n        var fastMode = misc.BUILTIN_CLASSID_RE.test(js._getClassId(klass));\n        // sources.push('var vb,vn,vs,vo,vu,vf;');    // boolean, number, string, object, undefined, function\n        for (var p = 0; p < props.length; p++) {\n            var propName = props[p];\n            if ((CC_PREVIEW || (CC_EDITOR && self._ignoreEditorOnly)) && attrs[propName + EDITOR_ONLY]) {\n                continue;   // skip editor only if in preview\n            }\n\n            var accessorToSet, propNameLiteralToSet;\n            if (CCClass.IDENTIFIER_RE.test(propName)) {\n                propNameLiteralToSet = '\"' + propName + '\"';\n                accessorToSet = '.' + propName;\n            }\n            else {\n                propNameLiteralToSet = CCClass.escapeForJS(propName);\n                accessorToSet = '[' + propNameLiteralToSet + ']';\n            }\n\n            var accessorToGet = accessorToSet;\n            if (attrs[propName + FORMERLY_SERIALIZED_AS]) {\n                var propNameToRead = attrs[propName + FORMERLY_SERIALIZED_AS];\n                if (CCClass.IDENTIFIER_RE.test(propNameToRead)) {\n                    accessorToGet = '.' + propNameToRead;\n                }\n                else {\n                    accessorToGet = '[' + CCClass.escapeForJS(propNameToRead) + ']';\n                }\n            }\n\n            sources.push('prop=d' + accessorToGet + ';');\n            sources.push(`if(typeof ${CC_JSB || CC_RUNTIME ? '(prop)' : 'prop'}!==\"undefined\"){`);\n\n            var stillUseUrl = attrs[propName + SAVE_URL_AS_ASSET];\n            // function undefined object(null) string boolean number\n            var defaultValue = CCClass.getDefault(attrs[propName + DEFAULT]);\n            if (fastMode) {\n                var isPrimitiveType;\n                var userType = attrs[propName + TYPE];\n                if (defaultValue === undefined && userType) {\n                    isPrimitiveType = userType instanceof Attr.PrimitiveType;\n                }\n                else {\n                    var defaultType = typeof defaultValue;\n                    isPrimitiveType = (defaultType === 'string' && !stillUseUrl) ||\n                                      defaultType === 'number' ||\n                                      defaultType === 'boolean';\n                }\n\n                if (isPrimitiveType) {\n                    sources.push(`o${accessorToSet}=prop;`);\n                }\n                else {\n                    compileObjectTypeJit(sources, defaultValue, accessorToSet, propNameLiteralToSet, true, stillUseUrl);\n                }\n            }\n            else {\n                sources.push(`if(typeof ${CC_JSB || CC_RUNTIME ? '(prop)' : 'prop'}!==\"object\"){` +\n                                 'o' + accessorToSet + '=prop;' +\n                             '}else{');\n                compileObjectTypeJit(sources, defaultValue, accessorToSet, propNameLiteralToSet, false, stillUseUrl);\n                sources.push('}');\n            }\n            sources.push('}');\n        }\n        if (cc.js.isChildClassOf(klass, cc._BaseNode) || cc.js.isChildClassOf(klass, cc.Component)) {\n            if (CC_PREVIEW || (CC_EDITOR && self._ignoreEditorOnly)) {\n                var mayUsedInPersistRoot = js.isChildClassOf(klass, cc.Node);\n                if (mayUsedInPersistRoot) {\n                    sources.push('d._id&&(o._id=d._id);');\n                }\n            }\n            else {\n                sources.push('d._id&&(o._id=d._id);');\n            }\n        }\n        if (props[props.length - 1] === '_$erialized') {\n            // deep copy original serialized data\n            sources.push('o._$erialized=JSON.parse(JSON.stringify(d));');\n            // parse the serialized data as primitive javascript object, so its __id__ will be dereferenced\n            sources.push('s._deserializePrimitiveObject(o._$erialized,d);');\n        }\n        return Function('s', 'o', 'd', 'k', 't', sources.join(''));\n    } : function (self, klass) {\n        var fastMode = misc.BUILTIN_CLASSID_RE.test(js._getClassId(klass));\n        var shouldCopyId = cc.js.isChildClassOf(klass, cc._BaseNode) || cc.js.isChildClassOf(klass, cc.Component);\n        var shouldCopyRawData;\n\n        var simpleProps = [];\n        var simplePropsToRead = simpleProps;\n        var advancedProps = [];\n        var advancedPropsToRead = advancedProps;\n        var advancedPropsUseUrl = [];\n        var advancedPropsValueType = [];\n\n        (function () {\n            var props = klass.__values__;\n            shouldCopyRawData = props[props.length - 1] === '_$erialized';\n\n            var attrs = Attr.getClassAttrs(klass);\n            var TYPE = Attr.DELIMETER + 'type';\n            var DEFAULT = Attr.DELIMETER + 'default';\n            var SAVE_URL_AS_ASSET = Attr.DELIMETER + 'saveUrlAsAsset';\n            var FORMERLY_SERIALIZED_AS = Attr.DELIMETER + 'formerlySerializedAs';\n\n            for (var p = 0; p < props.length; p++) {\n                var propName = props[p];\n                var propNameToRead = propName;\n                if (attrs[propName + FORMERLY_SERIALIZED_AS]) {\n                    propNameToRead = attrs[propName + FORMERLY_SERIALIZED_AS];\n                }\n                var stillUseUrl = attrs[propName + SAVE_URL_AS_ASSET];\n                // function undefined object(null) string boolean number\n                var defaultValue = CCClass.getDefault(attrs[propName + DEFAULT]);\n                var isPrimitiveType = false;\n                if (fastMode) {\n                    var userType = attrs[propName + TYPE];\n                    if (defaultValue === undefined && userType) {\n                        isPrimitiveType = userType instanceof Attr.PrimitiveType;\n                    }\n                    else {\n                        var defaultType = typeof defaultValue;\n                        isPrimitiveType = (defaultType === 'string' && !stillUseUrl) ||\n                                          defaultType === 'number' ||\n                                          defaultType === 'boolean';\n                    }\n                }\n                if (fastMode && isPrimitiveType) {\n                    if (propNameToRead !== propName && simplePropsToRead === simpleProps) {\n                        simplePropsToRead = simpleProps.slice();\n                    }\n                    simpleProps.push(propName);\n                    if (simplePropsToRead !== simpleProps) {\n                        simplePropsToRead.push(propNameToRead);\n                    }\n                }\n                else {\n                    if (propNameToRead !== propName && advancedPropsToRead === advancedProps) {\n                        advancedPropsToRead = advancedProps.slice();\n                    }\n                    advancedProps.push(propName);\n                    if (advancedPropsToRead !== advancedProps) {\n                        advancedPropsToRead.push(propNameToRead);\n                    }\n                    advancedPropsUseUrl.push(stillUseUrl);\n                    advancedPropsValueType.push((defaultValue instanceof cc.ValueType) && defaultValue.constructor);\n                }\n            }\n        })();\n\n        return function (s, o, d, k, t) {\n            for (let i = 0; i < simpleProps.length; ++i) {\n                let prop = d[simplePropsToRead[i]];\n                if (prop !== undefined) {\n                    o[simpleProps[i]] = prop;\n                }\n            }\n            for (let i = 0; i < advancedProps.length; ++i) {\n                let propName = advancedProps[i];\n                var prop = d[advancedPropsToRead[i]];\n                if (prop === undefined) {\n                    continue;\n                }\n                if (!fastMode && typeof prop !== 'object') {\n                    o[propName] = prop;\n                }\n                else {\n                    // fastMode (so will not simpleProp) or object\n                    var valueTypeCtor = advancedPropsValueType[i];\n                    if (valueTypeCtor) {\n                        if (fastMode || prop) {\n                            s._deserializeTypedObject(o[propName], prop, valueTypeCtor);\n                        }\n                        else {\n                            o[propName] = null;\n                        }\n                    }\n                    else {\n                        if (prop) {\n                            s._deserializeObjField(\n                                o,\n                                prop,\n                                propName,\n                                (CC_EDITOR || CC_TEST) ? (t && o) : null,\n                                advancedPropsUseUrl[i],\n                            );\n                        }\n                        else {\n                            o[propName] = null;\n                        }\n                    }\n                }\n            }\n            if (shouldCopyId && d._id) {\n                o._id = d._id;\n            }\n            if (shouldCopyRawData) {\n                // deep copy original serialized data\n                o._$erialized = JSON.parse(JSON.stringify(d));\n                // parse the serialized data as primitive javascript object, so its __id__ will be dereferenced\n                s._deserializePrimitiveObject(o._$erialized, d);\n            }\n        }\n    };\n\n    function unlinkUnusedPrefab (self, serialized, obj) {\n        var uuid = serialized['asset'] && serialized['asset'].__uuid__;\n        if (uuid) {\n            var last = self.result.uuidList.length - 1;\n            if (self.result.uuidList[last] === uuid &&\n                self.result.uuidObjList[last] === obj &&\n                self.result.uuidPropList[last] === 'asset') {\n                self.result.uuidList.pop();\n                self.result.uuidObjList.pop();\n                self.result.uuidPropList.pop();\n            }\n            else {\n                var debugEnvOnlyInfo = 'Failed to skip prefab asset while deserializing PrefabInfo';\n                cc.warn(debugEnvOnlyInfo);\n            }\n        }\n    }\n\n    function _deserializeFireClass (self, obj, serialized, klass, target) {\n        var deserialize;\n        if (klass.hasOwnProperty('__deserialize__')) {\n            deserialize = klass.__deserialize__;\n        }\n        else {\n            deserialize = compileDeserialize(self, klass);\n            // if (CC_TEST && !isPhantomJS) {\n            //     cc.log(deserialize);\n            // }\n            js.value(klass, '__deserialize__', deserialize, true);\n        }\n        deserialize(self, obj, serialized, klass, target);\n        // if preview or build worker\n        if (CC_PREVIEW || (CC_EDITOR && self._ignoreEditorOnly)) {\n            if (klass === cc._PrefabInfo && !obj.sync) {\n                unlinkUnusedPrefab(self, serialized, obj);\n            }\n        }\n    }\n\n    _Deserializer.pool = new js.Pool(function (obj) {\n        obj.result = null;\n        obj.customEnv = null;\n        obj.deserializedList.length = 0;\n        obj.deserializedData = null;\n        obj._classFinder = null;\n        if (CC_DEV) {\n            obj._target = null;\n        }\n        obj._idList.length = 0;\n        obj._idObjList.length = 0;\n        obj._idPropList.length = 0;\n    }, 1);\n\n    _Deserializer.pool.get = function (result, target, classFinder, customEnv, ignoreEditorOnly) {\n        var cache = this._get();\n        if (cache) {\n            cache.result = result;\n            cache.customEnv = customEnv;\n            cache._classFinder = classFinder;\n            if (CC_DEV) {\n                cache._target = target;\n                cache._ignoreEditorOnly = ignoreEditorOnly;\n            }\n            return cache;\n        }\n        else {\n            return new _Deserializer(result, target, classFinder, customEnv, ignoreEditorOnly);\n        }\n    };\n\n    return _Deserializer;\n})();\n\n/**\n * @module cc\n */\n\n/**\n * !#en Deserialize json to cc.Asset\n * !#zh 将 JSON 反序列化为对象实例。\n *\n * 当指定了 target 选项时，如果 target 引用的其它 asset 的 uuid 不变，则不会改变 target 对 asset 的引用，\n * 也不会将 uuid 保存到 result 对象中。\n *\n * @method deserialize\n * @param {String|Object} data - the serialized cc.Asset json string or json object.\n * @param {Details} [details] - additional loading result\n * @param {Object} [options]\n * @return {object} the main data(asset)\n */\ncc.deserialize = function (data, details, options) {\n    options = options || {};\n    var classFinder = options.classFinder || js._getClassById;\n    // 启用 createAssetRefs 后，如果有 url 属性则会被统一强制设置为 { uuid: 'xxx' }，必须后面再特殊处理\n    var createAssetRefs = options.createAssetRefs || cc.sys.platform === cc.sys.EDITOR_CORE;\n    var target = (CC_EDITOR || CC_TEST) && options.target;\n    var customEnv = options.customEnv;\n    var ignoreEditorOnly = options.ignoreEditorOnly;\n\n    if (CC_EDITOR && Buffer.isBuffer(data)) {\n        data = data.toString();\n    }\n\n    if (typeof data === 'string') {\n        data = JSON.parse(data);\n    }\n\n    //var oldJson = JSON.stringify(data, null, 2);\n\n    var tempDetails = !details;\n    details = details || Details.pool.get();\n    var deserializer = _Deserializer.pool.get(details, target, classFinder, customEnv, ignoreEditorOnly);\n\n    cc.game._isCloning = true;\n    var res = deserializer.deserialize(data);\n    cc.game._isCloning = false;\n\n    _Deserializer.pool.put(deserializer);\n    if (createAssetRefs) {\n        details.assignAssetsBy(Editor.serialize.asAsset);\n    }\n    if (tempDetails) {\n        Details.pool.put(details);\n    }\n\n    //var afterJson = JSON.stringify(data, null, 2);\n    //if (oldJson !== afterJson) {\n    //    throw new Error('JSON SHOULD not changed');\n    //}\n\n    return res;\n};\n\ncc.deserialize.Details = Details;\ncc.deserialize.reportMissingClass = function (id) {\n    if (CC_EDITOR && Editor.Utils.UuidUtils.isUuid(id)) {\n        id = Editor.Utils.UuidUtils.decompressUuid(id);\n        cc.warnID(5301, id);\n    }\n    else {\n        cc.warnID(5302, id);\n    }\n};","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n// ID generater for runtime\n\nvar NonUuidMark = '.';\n\n/*\n * @param {string} [category] - You can specify a unique category to avoid id collision with other instance of IdGenerater\n */\nfunction IdGenerater (category) {\n    // init with a random id to emphasize that the returns id should not be stored in persistence data\n    this.id = 0 | (Math.random() * 998);\n    \n    this.prefix = category ? (category + NonUuidMark) : '';\n}\n\n/*\n * @method getNewId\n * @return {string}\n */\nIdGenerater.prototype.getNewId = function () {\n    return this.prefix + (++this.id);\n};\n\n/*\n * The global id generater might have a conflict problem once every 365 days,\n * if the game runs at 60 FPS and each frame 4760273 counts of new id are requested.\n */\nIdGenerater.global = new IdGenerater('global');\n\nmodule.exports = IdGenerater;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('./js');\nrequire('./CCClass');\nrequire('./CCClassDecorator');\nrequire('./CCEnum');\nrequire('./CCObject');\nrequire('./callbacks-invoker');\nrequire('./url');\nrequire('./deserialize');\nrequire('./instantiate');\nrequire('./instantiate-jit');\nrequire('./requiring-frame');\nrequire('./CCSys');\nrequire('./CCMacro');\n\nif (!(CC_EDITOR && Editor.isMainProcess)) {\n    require('./CCAssetLibrary');\n    require('./CCVisibleRect');\n}","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n// Some helper methods for compile instantiation code\n\nvar CCObject = require('./CCObject');\nvar Destroyed = CCObject.Flags.Destroyed;\nvar PersistentMask = CCObject.Flags.PersistentMask;\nvar Attr = require('./attribute');\nvar js = require('./js');\nvar CCClass = require('./CCClass');\nvar Compiler = require('./compiler');\n\nvar DEFAULT = Attr.DELIMETER + 'default';\nvar IDENTIFIER_RE = CCClass.IDENTIFIER_RE;\nvar escapeForJS = CCClass.escapeForJS;\n\nconst VAR = 'var ';\nconst LOCAL_OBJ = 'o';\nconst LOCAL_TEMP_OBJ = 't';\nconst LOCAL_ARRAY = 'a';\nconst LINE_INDEX_OF_NEW_OBJ = 0;\n\nconst DEFAULT_MODULE_CACHE = {\n    'cc.Node': 'cc.Node',\n    'cc.Sprite': 'cc.Sprite',\n    'cc.Label': 'cc.Label',\n    'cc.Button': 'cc.Button',\n    'cc.Widget': 'cc.Widget',\n    'cc.Animation': 'cc.Animation',\n    'cc.ClickEvent': false,\n    'cc.PrefabInfo': false\n};\n\ntry {\n    // compatible for IE\n    !Float32Array.name && (Float32Array.name = 'Float32Array');\n    !Float64Array.name && (Float64Array.name = 'Float64Array');\n\n    !Int8Array.name && (Int8Array.name = 'Int8Array');\n    !Int16Array.name && (Int16Array.name = 'Int16Array');\n    !Int32Array.name && (Int32Array.name = 'Int32Array');\n\n    !Uint8Array.name && (Uint8Array.name = 'Uint8Array');\n    !Uint16Array.name && (Uint16Array.name = 'Uint16Array');\n    !Uint32Array.name && (Uint32Array.name = 'Uint32Array');\n}\ncatch (e) {}\n\n// compatible for iOS 9\nfunction getTypedArrayName (constructor) {\n    if (constructor === Float32Array) { return 'Float32Array'; }\n    else if (constructor === Float64Array) { return 'Float64Array'; }\n\n    else if (constructor === Int8Array) { return 'Int8Array'; }\n    else if (constructor === Int16Array) { return 'Int16Array'; }\n    else if (constructor === Int32Array) { return 'Int32Array'; }\n\n    else if (constructor === Uint8Array) { return 'Uint8Array'; }\n    else if (constructor === Uint16Array) { return 'Uint16Array'; }\n    else if (constructor === Uint32Array) { return 'Uint32Array'; }\n    else {\n        throw new Error(`Unknown TypedArray could not be instantiated: ${constructor}`);\n    }\n}\n\n// HELPER CLASSES\n\n// ('foo', 'bar')\n// -> 'var foo = bar;'\nfunction Declaration (varName, expression) {\n    this.varName = varName;\n    this.expression = expression;\n}\nDeclaration.prototype.toString = function () {\n    return VAR + this.varName + '=' + this.expression + ';';\n};\n\n// ('a =', 'var b = x')\n// -> 'var b = a = x';\n// ('a =', 'x')\n// -> 'a = x';\nfunction mergeDeclaration (statement, expression) {\n    if (expression instanceof Declaration) {\n        return new Declaration(expression.varName, statement + expression.expression);\n    }\n    else {\n        return statement + expression;\n    }\n}\n\n// ('a', ['var b = x', 'b.foo = bar'])\n// -> 'var b = a = x;'\n// -> 'b.foo = bar;'\n// ('a', 'var b = x')\n// -> 'var b = a = x;'\n// ('a', 'x')\n// -> 'a = x;'\nfunction writeAssignment (codeArray, statement, expression) {\n    if (Array.isArray(expression)) {\n        expression[0] = mergeDeclaration(statement, expression[0]);\n        codeArray.push(expression);\n    }\n    else {\n        codeArray.push(mergeDeclaration(statement, expression) + ';');\n    }\n}\n\n// ('foo', 'bar')\n// -> 'targetExpression.foo = bar'\n// ('foo1', 'bar1')\n// ('foo2', 'bar2')\n// -> 't = targetExpression;'\n// -> 't.foo1 = bar1;'\n// -> 't.foo2 = bar2;'\nfunction Assignments (targetExpression) {\n    this._exps = [];\n    this._targetExp = targetExpression;\n}\nAssignments.prototype.append = function (key, expression) {\n    this._exps.push([key, expression]);\n};\nAssignments.prototype.writeCode = function (codeArray) {\n    var targetVar;\n    if (this._exps.length > 1) {\n        codeArray.push(LOCAL_TEMP_OBJ + '=' + this._targetExp + ';');\n        targetVar = LOCAL_TEMP_OBJ;\n    }\n    else if (this._exps.length === 1) {\n        targetVar = this._targetExp;\n    }\n    else {\n        return;\n    }\n    for (var i = 0; i < this._exps.length; i++) {\n        var pair = this._exps[i];\n        writeAssignment(codeArray, targetVar + getPropAccessor(pair[0]) + '=', pair[1]);\n    }\n};\n\nAssignments.pool = new js.Pool(function (obj) {\n                                obj._exps.length = 0;\n                                obj._targetExp = null;\n                            }, 1);\nAssignments.pool.get = function (targetExpression) {\n    var cache = this._get() || new Assignments();\n    cache._targetExp = targetExpression;\n    return cache;\n};\n\n// HELPER FUNCTIONS\n\nfunction equalsToDefault (def, value) {\n    if (typeof def === 'function') {\n        try {\n            def = def();\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    if (def === value) {\n        return true;\n    }\n    if (def && value) {\n        if (def instanceof cc.ValueType && def.equals(value)) {\n            return true;\n        }\n        if ((Array.isArray(def) && Array.isArray(value)) ||\n            (def.constructor === Object && value.constructor === Object)\n        ) {\n            try {\n                return Array.isArray(def) && Array.isArray(value) && def.length === 0 && value.length === 0;\n            }\n            catch (e) {\n            }\n        }\n    }\n    return false;\n}\n\nfunction getPropAccessor (key) {\n    return IDENTIFIER_RE.test(key) ? ('.' + key) : ('[' + escapeForJS(key) + ']');\n}\n\n//\n\n/*\n * Variables:\n * {Object[]} O - objs list\n * {Function[]} F - constructor list\n * {Node} [R] - specify an instantiated prefabRoot that all references to prefabRoot in prefab will redirect to\n * {Object} o - current creating object\n */\n\n/*\n * @param {Object} obj - the object to parse\n * @param {Node} [parent]\n */\nfunction Parser (obj, parent) {\n    this.parent = parent;\n\n    this.objsToClear_iN$t = [];   // used to reset _iN$t variable\n    this.codeArray = [];\n\n    // datas for generated code\n    this.objs = [];\n    this.funcs = [];\n\n    this.funcModuleCache = js.createMap();\n    js.mixin(this.funcModuleCache, DEFAULT_MODULE_CACHE);\n\n    // {String[]} - variable names for circular references,\n    //              not really global, just local variables shared between sub functions\n    this.globalVariables = [];\n    // incremental id for new global variables\n    this.globalVariableId = 0;\n    // incremental id for new local variables\n    this.localVariableId = 0;\n\n    // generate codeArray\n    //if (Array.isArray(obj)) {\n    //    this.codeArray.push(this.instantiateArray(obj));\n    //}\n    //else {\n        this.codeArray.push(VAR + LOCAL_OBJ + ',' + LOCAL_TEMP_OBJ + ';',\n                           'if(R){',\n                                LOCAL_OBJ + '=R;',\n                           '}else{',\n                                LOCAL_OBJ + '=R=new ' + this.getFuncModule(obj.constructor, true) + '();',\n                           '}');\n        js.value(obj, '_iN$t', { globalVar: 'R' }, true);\n        this.objsToClear_iN$t.push(obj);\n        this.enumerateObject(this.codeArray, obj);\n    //}\n\n    // generate code\n    var globalVariablesDeclaration;\n    if (this.globalVariables.length > 0) {\n        globalVariablesDeclaration = VAR + this.globalVariables.join(',') + ';';\n    }\n    var code = Compiler.flattenCodeArray(['return (function(R){',\n                                    globalVariablesDeclaration || [],\n                                    this.codeArray,\n                                    'return o;',\n                                 '})']);\n\n    // generate method and bind with objs\n    this.result = Function('O', 'F', code)(this.objs, this.funcs);\n\n    // if (CC_TEST && !isPhantomJS) {\n    //     console.log(code);\n    // }\n\n    // cleanup\n    for (var i = 0, len = this.objsToClear_iN$t.length; i < len; ++i) {\n        this.objsToClear_iN$t[i]._iN$t = null;\n    }\n    this.objsToClear_iN$t.length = 0;\n}\n\nvar proto = Parser.prototype;\n\nproto.getFuncModule = function (func, usedInNew) {\n    var clsName = js.getClassName(func);\n    if (clsName) {\n        var cache = this.funcModuleCache[clsName];\n        if (cache) {\n            return cache;\n        }\n        else if (cache === undefined) {\n            var clsNameIsModule = clsName.indexOf('.') !== -1;\n            if (clsNameIsModule) {\n                try {\n                    // ensure is module\n                    clsNameIsModule = (func === Function('return ' + clsName)());\n                    if (clsNameIsModule) {\n                        this.funcModuleCache[clsName] = clsName;\n                        return clsName;\n                    }\n                }\n                catch (e) {}\n            }\n        }\n    }\n    var index = this.funcs.indexOf(func);\n    if (index < 0) {\n        index = this.funcs.length;\n        this.funcs.push(func);\n    }\n    var res = 'F[' + index + ']';\n    if (usedInNew) {\n        res = '(' + res + ')';\n    }\n    this.funcModuleCache[clsName] = res;\n    return res;\n};\n\nproto.getObjRef = function (obj) {\n    var index = this.objs.indexOf(obj);\n    if (index < 0) {\n        index = this.objs.length;\n        this.objs.push(obj);\n    }\n    return 'O[' + index + ']';\n};\n\nproto.setValueType = function (codeArray, defaultValue, srcValue, targetExpression) {\n    var assignments = Assignments.pool.get(targetExpression);\n    var fastDefinedProps = defaultValue.constructor.__props__;\n    if (!fastDefinedProps) {\n        fastDefinedProps = Object.keys(defaultValue);\n    }\n    for (var i = 0; i < fastDefinedProps.length; i++) {\n        var propName = fastDefinedProps[i];\n        var prop = srcValue[propName];\n        if (defaultValue[propName] === prop) {\n            continue;\n        }\n        var expression = this.enumerateField(srcValue, propName, prop);\n        assignments.append(propName, expression);\n    }\n    assignments.writeCode(codeArray);\n    Assignments.pool.put(assignments);\n};\n\nproto.enumerateCCClass = function (codeArray, obj, klass) {\n    var props = klass.__values__;\n    var attrs = Attr.getClassAttrs(klass);\n    for (var p = 0; p < props.length; p++) {\n        var key = props[p];\n        var val = obj[key];\n        var defaultValue = attrs[key + DEFAULT];\n        if (equalsToDefault(defaultValue, val)) {\n            continue;\n        }\n        if (typeof val === 'object' && val instanceof cc.ValueType) {\n            defaultValue = CCClass.getDefault(defaultValue);\n            if (defaultValue && defaultValue.constructor === val.constructor) {\n                // fast case\n                var targetExpression = LOCAL_OBJ + getPropAccessor(key);\n                this.setValueType(codeArray, defaultValue, val, targetExpression);\n                continue;\n            }\n        }\n        this.setObjProp(codeArray, obj, key, val);\n    }\n};\n\nproto.instantiateArray = function (value) {\n    if (value.length === 0) {\n        return '[]';\n    }\n\n    var arrayVar = LOCAL_ARRAY + (++this.localVariableId);\n    var declaration = new Declaration(arrayVar, 'new Array(' + value.length + ')');\n    var codeArray = [declaration];\n\n    // assign a _iN$t flag to indicate that this object has been parsed.\n    js.value(value, '_iN$t', {\n        globalVar: '',      // the name of declared global variable used to access this object\n        source: codeArray,  // the source code array for this object\n    }, true);\n    this.objsToClear_iN$t.push(value);\n\n    for (var i = 0; i < value.length; ++i) {\n        var statement = arrayVar + '[' + i + ']=';\n        var expression = this.enumerateField(value, i, value[i]);\n        writeAssignment(codeArray, statement, expression);\n    }\n    return codeArray;\n};\n\nproto.instantiateTypedArray = function (value) {\n    let type = value.constructor.name || getTypedArrayName(value.constructor);\n    if (value.length === 0) {\n        return 'new ' + type;\n    }\n\n    let arrayVar = LOCAL_ARRAY + (++this.localVariableId);\n    let declaration = new Declaration(arrayVar, 'new ' + type + '(' + value.length + ')');\n    let codeArray = [declaration];\n\n    // assign a _iN$t flag to indicate that this object has been parsed.\n    value._iN$t = {\n        globalVar: '',      // the name of declared global variable used to access this object\n        source: codeArray,  // the source code array for this object\n    };\n    this.objsToClear_iN$t.push(value);\n\n    for (var i = 0; i < value.length; ++i) {\n        if (value[i] !== 0) {\n            var statement = arrayVar + '[' + i + ']=';\n            writeAssignment(codeArray, statement, value[i]);\n        }\n    }\n    return codeArray;\n};\n\nproto.enumerateField = function (obj, key, value) {\n    if (typeof value === 'object' && value) {\n        var _iN$t = value._iN$t;\n        if (_iN$t) {\n            // parsed\n            var globalVar = _iN$t.globalVar;\n            if (!globalVar) {\n                // declare a global var\n                globalVar = _iN$t.globalVar = 'v' + (++this.globalVariableId);\n                this.globalVariables.push(globalVar);\n                // insert assignment statement to assign to global var\n                var line = _iN$t.source[LINE_INDEX_OF_NEW_OBJ];\n                _iN$t.source[LINE_INDEX_OF_NEW_OBJ] = mergeDeclaration(globalVar + '=', line);\n                // if (typeof line ==='string' && line.startsWith(VAR)) {\n                //     // var o=xxx -> var o=global=xxx\n                //     var LEN_OF_VAR_O = 5;\n                //     _iN$t.source[LINE_INDEX_OF_NEW_OBJ] = line.slice(0, LEN_OF_VAR_O) + '=' + globalVar + line.slice(LEN_OF_VAR_O);\n                // }\n            }\n            return globalVar;\n        }\n        else if (ArrayBuffer.isView(value)) {\n            return this.instantiateTypedArray(value);\n        }\n        else if (Array.isArray(value)) {\n            return this.instantiateArray(value);\n        }\n        else {\n            return this.instantiateObj(value);\n        }\n    }\n    else if (typeof value === 'function') {\n        return this.getFuncModule(value);\n    }\n    else if (typeof value === 'string') {\n        return escapeForJS(value);\n    }\n    else {\n        if (key === '_objFlags' && (obj instanceof CCObject)) {\n            value &= PersistentMask;\n        }\n        return value;\n    }\n};\n\nproto.setObjProp = function (codeArray, obj, key, value) {\n    var statement = LOCAL_OBJ + getPropAccessor(key) + '=';\n    var expression = this.enumerateField(obj, key, value);\n    writeAssignment(codeArray, statement, expression);\n};\n\n// codeArray - the source code array for this object\nproto.enumerateObject = function (codeArray, obj) {\n    var klass = obj.constructor;\n    if (cc.Class._isCCClass(klass)) {\n        this.enumerateCCClass(codeArray, obj, klass);\n    }\n    else {\n        // primitive javascript object\n        for (var key in obj) {\n            if (!obj.hasOwnProperty(key) ||\n                (key.charCodeAt(0) === 95 && key.charCodeAt(1) === 95 &&   // starts with \"__\"\n                 key !== '__type__')\n            ) {\n                continue;\n            }\n            var value = obj[key];\n            if (typeof value === 'object' && value && value === obj._iN$t) {\n                continue;\n            }\n            this.setObjProp(codeArray, obj, key, value);\n        }\n    }\n};\n\nproto.instantiateObj = function (obj) {\n    if (obj instanceof cc.ValueType) {\n        return CCClass.getNewValueTypeCode(obj);\n    }\n    if (obj instanceof cc.Asset) {\n        // register to asset list and just return the reference.\n        return this.getObjRef(obj);\n    }\n    if (obj._objFlags & Destroyed) {\n        // the same as cc.isValid(obj)\n        return null;\n    }\n\n    var createCode;\n    var ctor = obj.constructor;\n    if (cc.Class._isCCClass(ctor)) {\n        if (this.parent) {\n            if (this.parent instanceof cc.Component) {\n                if (obj instanceof cc._BaseNode || obj instanceof cc.Component) {\n                    return this.getObjRef(obj);\n                }\n            }\n            else if (this.parent instanceof cc._BaseNode) {\n                if (obj instanceof cc._BaseNode) {\n                    if (!obj.isChildOf(this.parent)) {\n                        // should not clone other nodes if not descendant\n                        return this.getObjRef(obj);\n                    }\n                }\n                else if (obj instanceof cc.Component) {\n                    if (!obj.node.isChildOf(this.parent)) {\n                        // should not clone other component if not descendant\n                        return this.getObjRef(obj);\n                    }\n                }\n            }\n        }\n        createCode = new Declaration(LOCAL_OBJ, 'new ' + this.getFuncModule(ctor, true) + '()');\n    }\n    else if (ctor === Object) {\n        createCode = new Declaration(LOCAL_OBJ, '{}');\n    }\n    else if (!ctor) {\n        createCode = new Declaration(LOCAL_OBJ, 'Object.create(null)');\n    }\n    else {\n        // do not clone unknown type\n        return this.getObjRef(obj);\n    }\n\n    var codeArray = [createCode];\n\n    // assign a _iN$t flag to indicate that this object has been parsed.\n    js.value(obj, '_iN$t', {\n        globalVar: '',      // the name of declared global variable used to access this object\n        source: codeArray,  // the source code array for this object\n        //propName: '',     // the propName this object defined in its source code,\n        //                  // if defined, use LOCAL_OBJ.propName to access the obj, else just use o\n    }, true);\n    this.objsToClear_iN$t.push(obj);\n\n    this.enumerateObject(codeArray, obj);\n    return ['(function(){',\n                codeArray,\n            'return o;})();'];\n};\n\n\nfunction compile (node) {\n    var root = (node instanceof cc._BaseNode) && node;\n    var parser = new Parser(node, root);\n    return parser.result;\n}\n\nmodule.exports = {\n    compile: compile,\n    equalsToDefault: equalsToDefault\n};\n\nif (CC_TEST) {\n    cc._Test.IntantiateJit = module.exports;\n}\n","/****************************************************************************\r\n Copyright (c) 2013-2016 Chukong Technologies Inc.\r\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated engine source code (the \"Software\"), a limited,\r\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\r\n to use Cocos Creator solely to develop games on your target platforms. You shall\r\n  not use Cocos Creator software for developing other software or tools that's\r\n  used for developing games. You are not granted to publish, distribute,\r\n  sublicense, and/or sell copies of Cocos Creator.\r\n\r\n The software or tools in this License Agreement are licensed, not sold.\r\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n ****************************************************************************/\r\n\r\nvar CCObject = require('./CCObject');\r\nvar CCValueType = require('../value-types/value-type');\r\nvar Destroyed = CCObject.Flags.Destroyed;\r\nvar PersistentMask = CCObject.Flags.PersistentMask;\r\nvar _isDomNode = require('./utils').isDomNode;\r\nvar js = require('./js');\r\n\r\n/**\r\n * !#en Clones the object `original` and returns the clone, or instantiate a node from the Prefab.\r\n * !#zh 克隆指定的任意类型的对象，或者从 Prefab 实例化出新节点。\r\n *\r\n * （Instantiate 时，function 和 dom 等非可序列化对象会直接保留原有引用，Asset 会直接进行浅拷贝，可序列化类型会进行深拷贝。）\r\n *\r\n * @method instantiate\r\n * @param {Prefab|Node|Object} original - An existing object that you want to make a copy of.\r\n * @return {Node|Object} the newly instantiated object\r\n * @typescript\r\n * instantiate(original: Prefab): Node\r\n * instantiate<T>(original: T): T\r\n * @example\r\n * // instantiate node from prefab\r\n * var scene = cc.director.getScene();\r\n * var node = cc.instantiate(prefabAsset);\r\n * node.parent = scene;\r\n * // clone node\r\n * var scene = cc.director.getScene();\r\n * var node = cc.instantiate(targetNode);\r\n * node.parent = scene;\r\n */\r\nfunction instantiate (original, internal_force) {\r\n    if (!internal_force) {\r\n        if (typeof original !== 'object' || Array.isArray(original)) {\r\n            if (CC_DEV) {\r\n                cc.errorID(6900);\r\n            }\r\n            return null;\r\n        }\r\n        if (!original) {\r\n            if (CC_DEV) {\r\n                cc.errorID(6901);\r\n            }\r\n            return null;\r\n        }\r\n        if (!cc.isValid(original)) {\r\n            if (CC_DEV) {\r\n                cc.errorID(6902);\r\n            }\r\n            return null;\r\n        }\r\n        if (CC_DEV && original instanceof cc.Component) {\r\n            cc.warn('Should not instantiate a single cc.Component directly, you must instantiate the entire node.');\r\n        }\r\n    }\r\n\r\n    var clone;\r\n    if (original instanceof CCObject) {\r\n        // Invoke _instantiate method if supplied.\r\n        // The _instantiate callback will be called only on the root object, its associated object will not be called.\r\n        // @callback associated\r\n        // @param {Object} [instantiated] - If supplied, _instantiate just need to initialize the instantiated object,\r\n        //                                  no need to create new object by itself.\r\n        // @returns {Object} - the instantiated object\r\n        if (original._instantiate) {\r\n            cc.game._isCloning = true;\r\n            clone = original._instantiate();\r\n            cc.game._isCloning = false;\r\n            return clone;\r\n        }\r\n        else if (original instanceof cc.Asset) {\r\n            // 不允许用通用方案实例化资源\r\n            if (CC_DEV) {\r\n                cc.errorID(6903);\r\n            }\r\n            return null;\r\n        }\r\n    }\r\n\r\n    cc.game._isCloning = true;\r\n    clone = doInstantiate(original);\r\n    cc.game._isCloning = false;\r\n    return clone;\r\n}\r\n\r\nvar objsToClearTmpVar = [];   // used to reset _iN$t variable\r\n\r\n///**\r\n// * Do instantiate object, the object to instantiate must be non-nil.\r\n// * 这是一个通用的 instantiate 方法，可能效率比较低。\r\n// * 之后可以给各种类型重写快速实例化的特殊实现，但应该在单元测试中将结果和这个方法的结果进行对比。\r\n// * 值得注意的是，这个方法不可重入。\r\n// *\r\n// * @param {Object} obj - 该方法仅供内部使用，用户需负责保证参数合法。什么参数是合法的请参考 cc.instantiate 的实现。\r\n// * @param {Node} [parent] - 只有在该对象下的场景物体会被克隆。\r\n// * @return {Object}\r\n// * @private\r\n// */\r\nfunction doInstantiate (obj, parent) {\r\n    if (Array.isArray(obj)) {\r\n        if (CC_DEV) {\r\n            cc.errorID(6904);\r\n        }\r\n        return null;\r\n    }\r\n    if (_isDomNode && _isDomNode(obj)) {\r\n        if (CC_DEV) {\r\n            cc.errorID(6905);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    var clone;\r\n    if (obj._iN$t) {\r\n        // User can specify an existing object by assigning the \"_iN$t\" property.\r\n        // enumerateObject will always push obj to objsToClearTmpVar\r\n        clone = obj._iN$t;\r\n    }\r\n    else if (obj.constructor) {\r\n        var klass = obj.constructor;\r\n        clone = new klass();\r\n    }\r\n    else {\r\n        clone = Object.create(null);\r\n    }\r\n\r\n    enumerateObject(obj, clone, parent);\r\n\r\n    for (var i = 0, len = objsToClearTmpVar.length; i < len; ++i) {\r\n        objsToClearTmpVar[i]._iN$t = null;\r\n    }\r\n    objsToClearTmpVar.length = 0;\r\n\r\n    return clone;\r\n}\r\n\r\n// @param {Object} obj - The object to instantiate, typeof must be 'object' and should not be an array.\r\n\r\nfunction enumerateCCClass (klass, obj, clone, parent) {\r\n    var props = klass.__values__;\r\n    for (var p = 0; p < props.length; p++) {\r\n        var key = props[p];\r\n        var value = obj[key];\r\n        if (typeof value === 'object' && value) {\r\n            var initValue = clone[key];\r\n            if (initValue instanceof CCValueType &&\r\n                initValue.constructor === value.constructor) {\r\n                initValue.set(value);\r\n            }\r\n            else {\r\n                clone[key] = value._iN$t || instantiateObj(value, parent);\r\n            }\r\n        }\r\n        else {\r\n            clone[key] = value;\r\n        }\r\n    }\r\n}\r\n\r\nfunction enumerateObject (obj, clone, parent) {\r\n    // 目前使用“_iN$t”这个特殊字段来存实例化后的对象，这样做主要是为了防止循环引用\r\n    // 注意，为了避免循环引用，所有新创建的实例，必须在赋值前被设为源对象的_iN$t\r\n    js.value(obj, '_iN$t', clone, true);\r\n    objsToClearTmpVar.push(obj);\r\n    var klass = obj.constructor;\r\n    if (cc.Class._isCCClass(klass)) {\r\n        enumerateCCClass(klass, obj, clone, parent);\r\n    }\r\n    else {\r\n        // primitive javascript object\r\n        for (var key in obj) {\r\n            if (!obj.hasOwnProperty(key) ||\r\n                (key.charCodeAt(0) === 95 && key.charCodeAt(1) === 95 &&   // starts with \"__\"\r\n                 key !== '__type__')\r\n            ) {\r\n                continue;\r\n            }\r\n            var value = obj[key];\r\n            if (typeof value === 'object' && value) {\r\n                if (value === clone) {\r\n                    continue;   // value is obj._iN$t\r\n                }\r\n                clone[key] = value._iN$t || instantiateObj(value, parent);\r\n            }\r\n            else {\r\n                clone[key] = value;\r\n            }\r\n        }\r\n    }\r\n    if (obj instanceof CCObject) {\r\n        clone._objFlags &= PersistentMask;\r\n    }\r\n}\r\n\r\n/*\r\n * @param {Object|Array} obj - the original non-nil object, typeof must be 'object'\r\n * @return {Object|Array} - the original non-nil object, typeof must be 'object'\r\n */\r\nfunction instantiateObj (obj, parent) {\r\n    if (obj instanceof CCValueType) {\r\n        return obj.clone();\r\n    }\r\n    if (obj instanceof cc.Asset) {\r\n        // 所有资源直接引用，不需要拷贝\r\n        return obj;\r\n    }\r\n    var clone;\r\n    if (ArrayBuffer.isView(obj)) {\r\n        let len = obj.length;\r\n        clone = new (obj.constructor)(len);\r\n        obj._iN$t = clone;\r\n        objsToClearTmpVar.push(obj);\r\n        for (let i = 0; i < len; ++i) {\r\n            clone[i] = obj[i];\r\n        }\r\n        return clone;\r\n    }\r\n    if (Array.isArray(obj)) {\r\n        let len = obj.length;\r\n        clone = new Array(len);\r\n        js.value(obj, '_iN$t', clone, true);\r\n        objsToClearTmpVar.push(obj);\r\n        for (let i = 0; i < len; ++i) {\r\n            var value = obj[i];\r\n            if (typeof value === 'object' && value) {\r\n                clone[i] = value._iN$t || instantiateObj(value, parent);\r\n            }\r\n            else {\r\n                clone[i] = value;\r\n            }\r\n        }\r\n        return clone;\r\n    }\r\n    else if (obj._objFlags & Destroyed) {\r\n        // the same as cc.isValid(obj)\r\n        return null;\r\n    }\r\n\r\n    var ctor = obj.constructor;\r\n    if (cc.Class._isCCClass(ctor)) {\r\n        if (parent) {\r\n            if (parent instanceof cc.Component) {\r\n                if (obj instanceof cc._BaseNode || obj instanceof cc.Component) {\r\n                    return obj;\r\n                }\r\n            }\r\n            else if (parent instanceof cc._BaseNode) {\r\n                if (obj instanceof cc._BaseNode) {\r\n                    if (!obj.isChildOf(parent)) {\r\n                        // should not clone other nodes if not descendant\r\n                        return obj;\r\n                    }\r\n                }\r\n                else if (obj instanceof cc.Component) {\r\n                    if (!obj.node.isChildOf(parent)) {\r\n                        // should not clone other component if not descendant\r\n                        return obj;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        clone = new ctor();\r\n    }\r\n    else if (ctor === Object) {\r\n        clone = {};\r\n    }\r\n    else if (!ctor) {\r\n        clone = Object.create(null);\r\n    }\r\n    else {\r\n        // unknown type\r\n        return obj;\r\n    }\r\n    enumerateObject(obj, clone, parent);\r\n    return clone;\r\n}\r\n\r\ninstantiate._clone = doInstantiate;\r\ncc.instantiate = instantiate;\r\nmodule.exports = instantiate;\r\n","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst tempCIDGenerater = new (require('./id-generater'))('TmpCId.');\n\n\nfunction _getPropertyDescriptor (obj, name) {\n    while (obj) {\n        var pd = Object.getOwnPropertyDescriptor(obj, name);\n        if (pd) {\n            return pd;\n        }\n        obj = Object.getPrototypeOf(obj);\n    }\n    return null;\n}\n\nfunction _copyprop(name, source, target) {\n    var pd = _getPropertyDescriptor(source, name);\n    Object.defineProperty(target, name, pd);\n}\n\n/**\n * !#en This module provides some JavaScript utilities. All members can be accessed with `cc.js`.\n * !#zh 这个模块封装了 JavaScript 相关的一些实用函数，你可以通过 `cc.js` 来访问这个模块。\n * @submodule js\n * @module js\n */\nvar js = {\n\n    /**\n     * Check the obj whether is number or not\n     * If a number is created by using 'new Number(10086)', the typeof it will be \"object\"...\n     * Then you can use this function if you care about this case.\n     * @method isNumber\n     * @param {*} obj\n     * @returns {Boolean}\n     */\n    isNumber: function(obj) {\n        return typeof obj === 'number' || obj instanceof Number;\n    },\n\n    /**\n     * Check the obj whether is string or not.\n     * If a string is created by using 'new String(\"blabla\")', the typeof it will be \"object\"...\n     * Then you can use this function if you care about this case.\n     * @method isString\n     * @param {*} obj\n     * @returns {Boolean}\n     */\n    isString: function(obj) {\n        return typeof obj === 'string' || obj instanceof String;\n    },\n\n    /**\n     * Copy all properties not defined in obj from arguments[1...n]\n     * @method addon\n     * @param {Object} obj object to extend its properties\n     * @param {Object} ...sourceObj source object to copy properties from\n     * @return {Object} the result obj\n     */\n    addon: function (obj) {\n        'use strict';\n        obj = obj || {};\n        for (var i = 1, length = arguments.length; i < length; i++) {\n            var source = arguments[i];\n            if (source) {\n                if (typeof source !== 'object') {\n                    cc.errorID(5402, source);\n                    continue;\n                }\n                for ( var name in source) {\n                    if ( !(name in obj) ) {\n                        _copyprop( name, source, obj);\n                    }\n                }\n            }\n        }\n        return obj;\n    },\n\n    /**\n     * copy all properties from arguments[1...n] to obj\n     * @method mixin\n     * @param {Object} obj\n     * @param {Object} ...sourceObj\n     * @return {Object} the result obj\n     */\n    mixin: function (obj) {\n        'use strict';\n        obj = obj || {};\n        for (var i = 1, length = arguments.length; i < length; i++) {\n            var source = arguments[i];\n            if (source) {\n                if (typeof source !== 'object') {\n                    cc.errorID(5403, source);\n                    continue;\n                }\n                for ( var name in source) {\n                    _copyprop( name, source, obj);\n                }\n            }\n        }\n        return obj;\n    },\n\n    /**\n     * Derive the class from the supplied base class.\n     * Both classes are just native javascript constructors, not created by cc.Class, so\n     * usually you will want to inherit using {{#crossLink \"cc/Class:method\"}}cc.Class {{/crossLink}} instead.\n     * @method extend\n     * @param {Function} cls\n     * @param {Function} base - the baseclass to inherit\n     * @return {Function} the result class\n     */\n    extend: function (cls, base) {\n        if (CC_DEV) {\n            if (!base) {\n                cc.errorID(5404);\n                return;\n            }\n            if (!cls) {\n                cc.errorID(5405);\n                return;\n            }\n            if (Object.keys(cls.prototype).length > 0) {\n                cc.errorID(5406);\n            }\n        }\n        for (var p in base) if (base.hasOwnProperty(p)) cls[p] = base[p];\n        cls.prototype = Object.create(base.prototype, {\n            constructor: {\n                value: cls,\n                writable: true,\n                configurable: true\n            }\n        });\n        return cls;\n    },\n\n    /**\n     * Get super class\n     * @method getSuper\n     * @param {Function} ctor - the constructor of subclass\n     * @return {Function}\n     */\n    getSuper (ctor) {\n        var proto = ctor.prototype; // binded function do not have prototype\n        var dunderProto = proto && Object.getPrototypeOf(proto);\n        return dunderProto && dunderProto.constructor;\n    },\n\n    /**\n     * Checks whether subclass is child of superclass or equals to superclass\n     *\n     * @method isChildClassOf\n     * @param {Function} subclass\n     * @param {Function} superclass\n     * @return {Boolean}\n     */\n    isChildClassOf (subclass, superclass) {\n        if (subclass && superclass) {\n            if (typeof subclass !== 'function') {\n                return false;\n            }\n            if (typeof superclass !== 'function') {\n                if (CC_DEV) {\n                    cc.warnID(3625, superclass);\n                }\n                return false;\n            }\n            if (subclass === superclass) {\n                return true;\n            }\n            for (;;) {\n                subclass = js.getSuper(subclass);\n                if (!subclass) {\n                    return false;\n                }\n                if (subclass === superclass) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    },\n\n    /**\n     * Removes all enumerable properties from object\n     * @method clear\n     * @param {any} obj\n     */\n    clear: function (obj) {\n        var keys = Object.keys(obj);\n        for (var i = 0; i < keys.length; i++) {\n            delete obj[keys[i]];\n        }\n    },\n\n    /**\n     * Checks whether obj is an empty object\n     * @method isEmptyObject\n     * @param {any} obj \n     * @returns {Boolean}\n     */\n    isEmptyObject: function (obj) {\n        for (var key in obj) {\n            return false;\n        }\n        return true;\n    },\n\n    /**\n     * Get property descriptor in object and all its ancestors\n     * @method getPropertyDescriptor\n     * @param {Object} obj\n     * @param {String} name\n     * @return {Object}\n     */\n    getPropertyDescriptor: _getPropertyDescriptor\n};\n\n\nvar tmpValueDesc = {\n    value: undefined,\n    enumerable: false,\n    writable: false,\n    configurable: true\n};\n\n/**\n * Define value, just help to call Object.defineProperty.<br>\n * The configurable will be true.\n * @method value\n * @param {Object} obj\n * @param {String} prop\n * @param {any} value\n * @param {Boolean} [writable=false]\n * @param {Boolean} [enumerable=false]\n */\njs.value = function (obj, prop, value, writable, enumerable) {\n    tmpValueDesc.value = value;\n    tmpValueDesc.writable = writable;\n    tmpValueDesc.enumerable = enumerable;\n    Object.defineProperty(obj, prop, tmpValueDesc);\n    tmpValueDesc.value = undefined;\n};\n\nvar tmpGetSetDesc = {\n    get: null,\n    set: null,\n    enumerable: false,\n};\n\n/**\n * Define get set accessor, just help to call Object.defineProperty(...)\n * @method getset\n * @param {Object} obj\n * @param {String} prop\n * @param {Function} getter\n * @param {Function} [setter=null]\n * @param {Boolean} [enumerable=false]\n * @param {Boolean} [configurable=false]\n */\njs.getset = function (obj, prop, getter, setter, enumerable, configurable) {\n    if (typeof setter !== 'function') {\n        enumerable = setter;\n        setter = undefined;\n    }\n    tmpGetSetDesc.get = getter;\n    tmpGetSetDesc.set = setter;\n    tmpGetSetDesc.enumerable = enumerable;\n    tmpGetSetDesc.configurable = configurable;\n    Object.defineProperty(obj, prop, tmpGetSetDesc);\n    tmpGetSetDesc.get = null;\n    tmpGetSetDesc.set = null;\n};\n\nvar tmpGetDesc = {\n    get: null,\n    enumerable: false,\n    configurable: false\n};\n\n/**\n * Define get accessor, just help to call Object.defineProperty(...)\n * @method get\n * @param {Object} obj\n * @param {String} prop\n * @param {Function} getter\n * @param {Boolean} [enumerable=false]\n * @param {Boolean} [configurable=false]\n */\njs.get = function (obj, prop, getter, enumerable, configurable) {\n    tmpGetDesc.get = getter;\n    tmpGetDesc.enumerable = enumerable;\n    tmpGetDesc.configurable = configurable;\n    Object.defineProperty(obj, prop, tmpGetDesc);\n    tmpGetDesc.get = null;\n};\n\nvar tmpSetDesc = {\n    set: null,\n    enumerable: false,\n    configurable: false\n};\n\n/**\n * Define set accessor, just help to call Object.defineProperty(...)\n * @method set\n * @param {Object} obj\n * @param {String} prop\n * @param {Function} setter\n * @param {Boolean} [enumerable=false]\n * @param {Boolean} [configurable=false]\n */\njs.set = function (obj, prop, setter, enumerable, configurable) {\n    tmpSetDesc.set = setter;\n    tmpSetDesc.enumerable = enumerable;\n    tmpSetDesc.configurable = configurable;\n    Object.defineProperty(obj, prop, tmpSetDesc);\n    tmpSetDesc.set = null;\n};\n\n/**\n * Get class name of the object, if object is just a {} (and which class named 'Object'), it will return \"\".\n * (modified from <a href=\"http://stackoverflow.com/questions/1249531/how-to-get-a-javascript-objects-class\">the code from this stackoverflow post</a>)\n * @method getClassName\n * @param {Object|Function} objOrCtor - instance or constructor\n * @return {String}\n */\njs.getClassName = function (objOrCtor) {\n    if (typeof objOrCtor === 'function') {\n        var prototype = objOrCtor.prototype;\n        if (prototype && prototype.hasOwnProperty('__classname__') && prototype.__classname__) {\n            return prototype.__classname__;\n        }\n        var retval = '';\n        //  for browsers which have name property in the constructor of the object, such as chrome\n        if (objOrCtor.name) {\n            retval = objOrCtor.name;\n        }\n        if (objOrCtor.toString) {\n            var arr, str = objOrCtor.toString();\n            if (str.charAt(0) === '[') {\n                // str is \"[object objectClass]\"\n                arr = str.match(/\\[\\w+\\s*(\\w+)\\]/);\n            }\n            else {\n                // str is function objectClass () {} for IE Firefox\n                arr = str.match(/function\\s*(\\w+)/);\n            }\n            if (arr && arr.length === 2) {\n                retval = arr[1];\n            }\n        }\n        return retval !== 'Object' ? retval : '';\n    }\n    else if (objOrCtor && objOrCtor.constructor) {\n        return js.getClassName(objOrCtor.constructor);\n    }\n    return '';\n};\n\nfunction isTempClassId (id) {\n    return typeof id !== 'string' || id.startsWith(tempCIDGenerater.prefix);\n}\n\n// id 注册\n(function () {\n    var _idToClass = {};\n    var _nameToClass = {};\n\n    function setup (key, publicName, table) {\n        js.getset(js, publicName,\n            function () {\n                return Object.assign({}, table);\n            },\n            function (value) {\n                js.clear(table);\n                Object.assign(table, value);\n            }\n        );\n        return function (id, constructor) {\n            // deregister old\n            if (constructor.prototype.hasOwnProperty(key)) {\n                delete table[constructor.prototype[key]];\n            }\n            js.value(constructor.prototype, key, id);\n            // register class\n            if (id) {\n                var registered = table[id];\n                if (registered && registered !== constructor) {\n                    var error = 'A Class already exists with the same ' + key + ' : \"' + id + '\".';\n                    if (CC_TEST) {\n                        error += ' (This may be caused by error of unit test.) \\\nIf you dont need serialization, you can set class id to \"\". You can also call \\\ncc.js.unregisterClass to remove the id of unused class';\n                    }\n                    cc.error(error);\n                }\n                else {\n                    table[id] = constructor;\n                }\n                //if (id === \"\") {\n                //    console.trace(\"\", table === _nameToClass);\n                //}\n            }\n        };\n    }\n\n    /**\n     * Register the class by specified id, if its classname is not defined, the class name will also be set.\n     * @method _setClassId\n     * @param {String} classId\n     * @param {Function} constructor\n     * @private\n     */\n    /**\n     * !#en All classes registered in the engine, indexed by ID.\n     * !#zh 引擎中已注册的所有类型，通过 ID 进行索引。\n     * @property _registeredClassIds\n     * @example\n     * // save all registered classes before loading scripts\n     * let builtinClassIds = cc.js._registeredClassIds;\n     * let builtinClassNames = cc.js._registeredClassNames;\n     * // load some scripts that contain CCClass\n     * ...\n     * // clear all loaded classes\n     * cc.js._registeredClassIds = builtinClassIds;\n     * cc.js._registeredClassNames = builtinClassNames;\n     */\n    js._setClassId = setup('__cid__', '_registeredClassIds', _idToClass);\n\n    /**\n     * !#en All classes registered in the engine, indexed by name.\n     * !#zh 引擎中已注册的所有类型，通过名称进行索引。\n     * @property _registeredClassNames\n     * @example\n     * // save all registered classes before loading scripts\n     * let builtinClassIds = cc.js._registeredClassIds;\n     * let builtinClassNames = cc.js._registeredClassNames;\n     * // load some scripts that contain CCClass\n     * ...\n     * // clear all loaded classes\n     * cc.js._registeredClassIds = builtinClassIds;\n     * cc.js._registeredClassNames = builtinClassNames;\n     */\n    var doSetClassName = setup('__classname__', '_registeredClassNames', _nameToClass);\n\n    /**\n     * Register the class by specified name manually\n     * @method setClassName\n     * @param {String} className\n     * @param {Function} constructor\n     */\n    js.setClassName = function (className, constructor) {\n        doSetClassName(className, constructor);\n        // auto set class id\n        if (!constructor.prototype.hasOwnProperty('__cid__')) {\n            var id = className || tempCIDGenerater.getNewId();\n            if (id) {\n                js._setClassId(id, constructor);\n            }\n        }\n    };\n\n    /**\n     * Unregister a class from fireball.\n     *\n     * If you dont need a registered class anymore, you should unregister the class so that Fireball will not keep its reference anymore.\n     * Please note that its still your responsibility to free other references to the class.\n     *\n     * @method unregisterClass\n     * @param {Function} ...constructor - the class you will want to unregister, any number of classes can be added\n     */\n    js.unregisterClass = function () {\n        for (var i = 0; i < arguments.length; i++) {\n            var p = arguments[i].prototype;\n            var classId = p.__cid__;\n            if (classId) {\n                delete _idToClass[classId];\n            }\n            var classname = p.__classname__;\n            if (classname) {\n                delete _nameToClass[classname];\n            }\n        }\n    };\n\n    /**\n     * Get the registered class by id\n     * @method _getClassById\n     * @param {String} classId\n     * @return {Function} constructor\n     * @private\n     */\n    js._getClassById = function (classId) {\n        return _idToClass[classId];\n    };\n\n    /**\n     * Get the registered class by name\n     * @method getClassByName\n     * @param {String} classname\n     * @return {Function} constructor\n     */\n    js.getClassByName = function (classname) {\n        return _nameToClass[classname];\n    };\n\n    /**\n     * Get class id of the object\n     * @method _getClassId\n     * @param {Object|Function} obj - instance or constructor\n     * @param {Boolean} [allowTempId=true] - can return temp id in editor\n     * @return {String}\n     * @private\n     */\n    js._getClassId = function (obj, allowTempId) {\n        allowTempId = (typeof allowTempId !== 'undefined' ? allowTempId: true);\n\n        var res;\n        if (typeof obj === 'function' && obj.prototype.hasOwnProperty('__cid__')) {\n            res = obj.prototype.__cid__;\n            if (!allowTempId && (CC_DEV || CC_EDITOR) && isTempClassId(res)) {\n                return '';\n            }\n            return res;\n        }\n        if (obj && obj.constructor) {\n            var prototype = obj.constructor.prototype;\n            if (prototype && prototype.hasOwnProperty('__cid__')) {\n                res = obj.__cid__;\n                if (!allowTempId && (CC_DEV || CC_EDITOR) && isTempClassId(res)) {\n                    return '';\n                }\n                return res;\n            }\n        }\n        return '';\n    };\n})();\n\n/**\n * Defines a polyfill field for obsoleted codes.\n * @method obsolete\n * @param {any} obj - YourObject or YourClass.prototype\n * @param {String} obsoleted - \"OldParam\" or \"YourClass.OldParam\"\n * @param {String} newExpr - \"NewParam\" or \"YourClass.NewParam\"\n * @param {Boolean} [writable=false]\n */\njs.obsolete = function (obj, obsoleted, newExpr, writable) {\n    var extractPropName = /([^.]+)$/;\n    var oldProp = extractPropName.exec(obsoleted)[0];\n    var newProp = extractPropName.exec(newExpr)[0];\n    function get () {\n        if (CC_DEV) {\n            cc.warnID(5400, obsoleted, newExpr);\n        }\n        return this[newProp];\n    }\n    if (writable) {\n        js.getset(obj, oldProp,\n            get,\n            function (value) {\n                if (CC_DEV) {\n                    cc.warnID(5401, obsoleted, newExpr);\n                }\n                this[newProp] = value;\n            }\n        );\n    }\n    else {\n        js.get(obj, oldProp, get);\n    }\n};\n\n/**\n * Defines all polyfill fields for obsoleted codes corresponding to the enumerable properties of props.\n * @method obsoletes\n * @param {any} obj - YourObject or YourClass.prototype\n * @param {any} objName - \"YourObject\" or \"YourClass\"\n * @param {Object} props\n * @param {Boolean} [writable=false]\n */\njs.obsoletes = function (obj, objName, props, writable) {\n    for (var obsoleted in props) {\n        var newName = props[obsoleted];\n        js.obsolete(obj, objName + '.' + obsoleted, newName, writable);\n    }\n};\n\nvar REGEXP_NUM_OR_STR = /(%d)|(%s)/;\nvar REGEXP_STR = /%s/;\n\n/**\n * A string tool to construct a string with format string.\n * @method formatStr\n * @param {String|any} msg - A JavaScript string containing zero or more substitution strings (%s).\n * @param {any} ...subst - JavaScript objects with which to replace substitution strings within msg. This gives you additional control over the format of the output.\n * @returns {String}\n * @example\n * cc.js.formatStr(\"a: %s, b: %s\", a, b);\n * cc.js.formatStr(a, b, c);\n */\njs.formatStr = function () {\n    var argLen = arguments.length;\n    if (argLen === 0) {\n        return '';\n    }\n    var msg = arguments[0];\n    if (argLen === 1) {\n        return '' + msg;\n    }\n\n    var hasSubstitution = typeof msg === 'string' && REGEXP_NUM_OR_STR.test(msg);\n    if (hasSubstitution) {\n        for (let i = 1; i < argLen; ++i) {\n            var arg = arguments[i];\n            var regExpToTest = typeof arg === 'number' ? REGEXP_NUM_OR_STR : REGEXP_STR;\n            if (regExpToTest.test(msg))\n                msg = msg.replace(regExpToTest, arg);\n            else\n                msg += ' ' + arg;\n        }\n    }\n    else {\n        for (let i = 1; i < argLen; ++i) {\n            msg += ' ' + arguments[i];\n        }\n    }\n    return msg;\n};\n\n// see https://github.com/petkaantonov/bluebird/issues/1389\njs.shiftArguments = function () {\n    var len = arguments.length - 1;\n    var args = new Array(len);\n    for(var i = 0; i < len; ++i) {\n        args[i] = arguments[i + 1];\n    }\n    return args;\n};\n\n/**\n * !#en\n * A simple wrapper of `Object.create(null)` which ensures the return object have no prototype (and thus no inherited members). So we can skip `hasOwnProperty` calls on property lookups. It is a worthwhile optimization than the `{}` literal when `hasOwnProperty` calls are necessary.\n * !#zh\n * 该方法是对 `Object.create(null)` 的简单封装。`Object.create(null)` 用于创建无 prototype （也就无继承）的空对象。这样我们在该对象上查找属性时，就不用进行 `hasOwnProperty` 判断。在需要频繁判断 `hasOwnProperty` 时，使用这个方法性能会比 `{}` 更高。\n *\n * @method createMap\n * @param {Boolean} [forceDictMode=false] - Apply the delete operator to newly created map object. This causes V8 to put the object in \"dictionary mode\" and disables creation of hidden classes which are very expensive for objects that are constantly changing shape.\n * @return {Object}\n */\njs.createMap = function (forceDictMode) {\n    var map = Object.create(null);\n    if (forceDictMode) {\n        const INVALID_IDENTIFIER_1 = '.';\n        const INVALID_IDENTIFIER_2 = '/';\n        map[INVALID_IDENTIFIER_1] = true;\n        map[INVALID_IDENTIFIER_2] = true;\n        delete map[INVALID_IDENTIFIER_1];\n        delete map[INVALID_IDENTIFIER_2];\n    }\n    return map;\n};\n\n/**\n * @class array\n * @static\n */\n\n/**\n * Removes the array item at the specified index.\n * @method removeAt\n * @param {any[]} array\n * @param {Number} index\n */\nfunction removeAt (array, index) {\n    array.splice(index, 1);\n}\n\n/**\n * Removes the array item at the specified index.\n * It's faster but the order of the array will be changed.\n * @method fastRemoveAt\n * @param {any[]} array\n * @param {Number} index\n */\nfunction fastRemoveAt (array, index) {\n    var length = array.length;\n    if (index < 0 || index >= length) {\n        return;\n    }\n    array[index] = array[length - 1];\n    array.length = length - 1;\n}\n\n/**\n * Removes the first occurrence of a specific object from the array.\n * @method remove\n * @param {any[]} array\n * @param {any} value\n * @return {Boolean}\n */\nfunction remove (array, value) {\n    var index = array.indexOf(value);\n    if (index >= 0) {\n        removeAt(array, index);\n        return true;\n    }\n    else {\n        return false;\n    }\n}\n\n/**\n * Removes the first occurrence of a specific object from the array.\n * It's faster but the order of the array will be changed.\n * @method fastRemove\n * @param {any[]} array\n * @param {Number} value\n */\nfunction fastRemove (array, value) {\n    var index = array.indexOf(value);\n    if (index >= 0) {\n        array[index] = array[array.length - 1];\n        --array.length;\n    }\n}\n\n/**\n * Verify array's Type\n * @method verifyType\n * @param {array} array\n * @param {Function} type\n * @return {Boolean}\n */\nfunction verifyType (array, type) {\n    if (array && array.length > 0) {\n        for (var i = 0; i < array.length; i++) {\n            if (!(array[i] instanceof  type)) {\n                cc.logID(1300);\n                return false;\n            }\n        }\n    }\n    return true;\n}\n\n/**\n * Removes from array all values in minusArr. For each Value in minusArr, the first matching instance in array will be removed.\n * @method removeArray\n * @param {Array} array Source Array\n * @param {Array} minusArr minus Array\n */\nfunction removeArray (array, minusArr) {\n    for (var i = 0, l = minusArr.length; i < l; i++) {\n        remove(array, minusArr[i]);\n    }\n}\n\n/**\n * Inserts some objects at index\n * @method appendObjectsAt\n * @param {Array} array\n * @param {Array} addObjs\n * @param {Number} index\n * @return {Array}\n */\nfunction appendObjectsAt (array, addObjs, index) {\n    array.splice.apply(array, [index, 0].concat(addObjs));\n    return array;\n}\n\n/**\n * Exact same function as Array.prototype.indexOf.<br>\n * HACK: ugliy hack for Baidu mobile browser compatibility, stupid Baidu guys modify Array.prototype.indexOf for all pages loaded, their version changes strict comparison to non-strict comparison, it also ignores the second parameter of the original API, and this will cause event handler enter infinite loop.<br>\n * Baidu developers, if you ever see this documentation, here is the standard: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf, Seriously!\n *\n * @method indexOf\n * @param {any} searchElement - Element to locate in the array.\n * @param {Number} [fromIndex=0] - The index to start the search at\n * @return {Number} - the first index at which a given element can be found in the array, or -1 if it is not present.\n */\nvar indexOf = Array.prototype.indexOf;\n\n/**\n * Determines whether the array contains a specific value.\n * @method contains\n * @param {any[]} array\n * @param {any} value\n * @return {Boolean}\n */\nfunction contains (array, value) {\n    return array.indexOf(value) >= 0;\n}\n\n/**\n * Copy an array's item to a new array (its performance is better than Array.slice)\n * @method copy\n * @param {Array} array\n * @return {Array}\n */\nfunction copy (array) {\n    var i, len = array.length, arr_clone = new Array(len);\n    for (i = 0; i < len; i += 1)\n        arr_clone[i] = array[i];\n    return arr_clone;\n}\n\njs.array = {\n    remove,\n    fastRemove,\n    removeAt,\n    fastRemoveAt,\n    contains,\n    verifyType,\n    removeArray,\n    appendObjectsAt,\n    copy,\n    indexOf,\n    MutableForwardIterator: require('../utils/mutable-forward-iterator')\n};\n\n// OBJECT POOL\n\n/**\n * !#en\n * A fixed-length object pool designed for general type.<br>\n * The implementation of this object pool is very simple,\n * it can helps you to improve your game performance for objects which need frequent release and recreate operations<br/>\n * !#zh\n * 长度固定的对象缓存池，可以用来缓存各种对象类型。<br/>\n * 这个对象池的实现非常精简，它可以帮助您提高游戏性能，适用于优化对象的反复创建和销毁。\n * @class Pool\n * @example\n *\n *Example 1:\n *\n *function Details () {\n *    this.uuidList = [];\n *};\n *Details.prototype.reset = function () {\n *    this.uuidList.length = 0;\n *};\n *Details.pool = new js.Pool(function (obj) {\n *    obj.reset();\n *}, 5);\n *Details.pool.get = function () {\n *    return this._get() || new Details();\n *};\n *\n *var detail = Details.pool.get();\n *...\n *Details.pool.put(detail);\n *\n *Example 2:\n *\n *function Details (buffer) {\n *    this.uuidList = buffer;\n *};\n *...\n *Details.pool.get = function (buffer) {\n *    var cached = this._get();\n *    if (cached) {\n *        cached.uuidList = buffer;\n *        return cached;\n *    }\n *    else {\n *        return new Details(buffer);\n *    }\n *};\n *\n *var detail = Details.pool.get( [] );\n *...\n */\n/**\n * !#en\n * Constructor for creating an object pool for the specific object type.\n * You can pass a callback argument for process the cleanup logic when the object is recycled.\n * !#zh\n * 使用构造函数来创建一个指定对象类型的对象池，您可以传递一个回调函数，用于处理对象回收时的清理逻辑。\n * @method constructor\n * @param {Function} [cleanupFunc] - the callback method used to process the cleanup logic when the object is recycled.\n * @param {Object} cleanupFunc.obj\n * @param {Number} size - initializes the length of the array\n * @typescript\n * constructor(cleanupFunc: (obj: any) => void, size: number)\n * constructor(size: number)\n */\nfunction Pool (cleanupFunc, size) {\n    if (size === undefined) {\n        size = cleanupFunc;\n        cleanupFunc = null;\n    }\n    this.get = null;\n    this.count = 0;\n    this._pool = new Array(size);\n    this._cleanup = cleanupFunc;\n}\n\n/**\n * !#en\n * Get and initialize an object from pool. This method defaults to null and requires the user to implement it.\n * !#zh\n * 获取并初始化对象池中的对象。这个方法默认为空，需要用户自己实现。\n * @method get\n * @param {any} ...params - parameters to used to initialize the object\n * @returns {Object}\n */\n\n/**\n * !#en\n * The current number of available objects, the default is 0, it will gradually increase with the recycle of the object,\n * the maximum will not exceed the size specified when the constructor is called.\n * !#zh\n * 当前可用对象数量，一开始默认是 0，随着对象的回收会逐渐增大，最大不会超过调用构造函数时指定的 size。\n * @property {Number} count\n * @default 0\n */\n\n/**\n * !#en\n * Get an object from pool, if no available object in the pool, null will be returned.\n * !#zh\n * 获取对象池中的对象，如果对象池没有可用对象，则返回空。\n * @method _get\n * @returns {Object|null}\n */\nPool.prototype._get = function () {\n    if (this.count > 0) {\n        --this.count;\n        var cache = this._pool[this.count];\n        this._pool[this.count] = null;\n        return cache;\n    }\n    return null;\n};\n\n/**\n * !#en Put an object into the pool.\n * !#zh 向对象池返还一个不再需要的对象。\n * @method put\n */\nPool.prototype.put = function (obj) {\n    var pool = this._pool;\n    if (this.count < pool.length) {\n        if (this._cleanup && this._cleanup(obj) === false) {\n            return;\n        }\n        pool[this.count] = obj;\n        ++this.count;\n    }\n};\n\n/**\n * !#en Resize the pool.\n * !#zh 设置对象池容量。\n * @method resize\n */\nPool.prototype.resize = function (length) {\n    if (length >= 0) {\n        this._pool.length = length;\n        if (this.count > length) {\n            this.count = length;\n        }\n    }\n};\n\njs.Pool = Pool;\n\n//\n\ncc.js = js;\n\nmodule.exports = js;\n\n// fix submodule pollute ...\n/**\n * @submodule cc\n */\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst js = require('./js');\nconst Attrs = require('./attribute');\n\n// 增加预处理属性这个步骤的目的是降低 CCClass 的实现难度，将比较稳定的通用逻辑和一些需求比较灵活的属性需求分隔开。\n\nvar SerializableAttrs = {\n    url: {\n        canUsedInGet: true\n    },\n    default: {},\n    serializable: {},\n    editorOnly: {},\n    formerlySerializedAs: {}\n};\n\nvar TYPO_TO_CORRECT_DEV = CC_DEV && {\n    extend: 'extends',\n    property: 'properties',\n    static: 'statics',\n    constructor: 'ctor'\n};\n\n// 预处理 notify 等扩展属性\nfunction parseNotify (val, propName, notify, properties) {\n    if (val.get || val.set) {\n        if (CC_DEV) {\n            cc.warnID(5500);\n        }\n        return;\n    }\n    if (val.hasOwnProperty('default')) {\n        // 添加新的内部属性，将原来的属性修改为 getter/setter 形式\n        // （以 _ 开头将自动设置property 为 visible: false）\n        var newKey = \"_N$\" + propName;\n\n        val.get = function () {\n            return this[newKey];\n        };\n        val.set = function (value) {\n            var oldValue = this[newKey];\n            this[newKey] = value;\n            notify.call(this, oldValue);\n        };\n\n        if (CC_EDITOR) {\n            val.notifyFor = newKey;\n        }\n\n        var newValue = {};\n        properties[newKey] = newValue;\n        // 将不能用于get方法中的属性移动到newValue中\n        for (var attr in SerializableAttrs) {\n            var v = SerializableAttrs[attr];\n            if (val.hasOwnProperty(attr)) {\n                newValue[attr] = val[attr];\n                if (!v.canUsedInGet) {\n                    delete val[attr];\n                }\n            }\n        }\n    }\n    else if (CC_DEV) {\n        cc.warnID(5501);\n    }\n}\n\nfunction checkUrl (val, className, propName, url) {\n    if (Array.isArray(url)) {\n        if (url.length > 0) {\n            url = url[0];\n        }\n        else if (CC_EDITOR) {\n            return cc.errorID(5502, className, propName);\n        }\n    }\n    if (CC_EDITOR) {\n        if (url == null) {\n            return cc.warnID(5503, className, propName);\n        }\n        if (typeof url !== 'function' || !js.isChildClassOf(url, cc.RawAsset)) {\n            return cc.errorID(5504, className, propName);\n        }\n        if (url === cc.RawAsset) {\n            cc.warn('Please change the definition of property \\'%s\\' in class \\'%s\\'. Starting from v1.10,\\n' +\n                    'the use of declaring a property in CCClass as a URL has been deprecated.\\n' +\n                    'For example, if property is cc.RawAsset, the previous definition is:\\n' +\n                    '    %s: cc.RawAsset,\\n' +\n                    '    // or:\\n' +\n                    '    %s: {\\n' +\n                    '      url: cc.RawAsset,\\n' +\n                    '      default: \"\"\\n' +\n                    '    },\\n' +\n                    '    // and the original method to get url is:\\n' +\n                    '    `this.%s`\\n' +\n                    'Now it should be changed to:\\n' +\n                    '    %s: {\\n' +\n                    '      type: cc.Asset,     // use \\'type:\\' to define Asset object directly\\n' +\n                    '      default: null,      // object\\'s default value is null\\n' +\n                    '    },\\n' +\n                    '    // and you must get the url by using:\\n' +\n                    '    `this.%s.nativeUrl`\\n' +\n                    '(This helps us to successfully refactor all RawAssets at v2.0, ' +\n                    'sorry for the inconvenience. \\uD83D\\uDE30 )',\n                    propName, className, propName, propName, propName, propName, propName);\n        }\n        else if (js.isChildClassOf(url, cc.Asset)) {\n            if (cc.RawAsset.wasRawAssetType(url)) {\n                if (!val._short) {\n                    cc.warn('Please change the definition of property \\'%s\\' in class \\'%s\\'. Starting from v1.10,\\n' +\n                            'the use of declaring a property in CCClass as a URL has been deprecated.\\n' +\n                            'For example, if property is Texture2D, the previous definition is:\\n' +\n                            '    %s: cc.Texture2D,\\n' +\n                            '    // or:\\n' +\n                            '    %s: {\\n' +\n                            '      url: cc.Texture2D,\\n' +\n                            '      default: \"\"\\n' +\n                            '    },\\n' +\n                            'Now it should be changed to:\\n' +\n                            '    %s: {\\n' +\n                            '      type: cc.Texture2D, // use \\'type:\\' to define Texture2D object directly\\n' +\n                            '      default: null,      // object\\'s default value is null\\n' +\n                            '    },\\n' +\n                            '(This helps us to successfully refactor all RawAssets at v2.0, ' +\n                            'sorry for the inconvenience. \\uD83D\\uDE30 )',\n                            propName, className, propName, propName, propName);\n                }\n            }\n            else {\n                return cc.errorID(5505, className, propName, cc.js.getClassName(url));\n            }\n        }\n        if (val.type) {\n            return cc.warnID(5506, className, propName);\n        }\n    }\n    val.type = url;\n}\n\nfunction parseType (val, type, className, propName) {\n    const STATIC_CHECK = (CC_EDITOR && CC_DEV) || CC_TEST;\n\n    if (Array.isArray(type)) {\n        if (STATIC_CHECK && 'default' in val) {\n            var isArray = require('./CCClass').isArray;   // require lazily to avoid circular require() calls\n            if (!isArray(val.default)) {\n                cc.warnID(5507, className, propName);\n            }\n        }\n        if (type.length > 0) {\n            if (cc.RawAsset.isRawAssetType(type[0])) {\n                val.url = type[0];\n                delete val.type;\n                return;\n            }\n            else {\n                val.type = type = type[0];\n            }\n        }\n        else {\n            return cc.errorID(5508, className, propName);\n        }\n    }\n    if (typeof type === 'function') {\n        if (type === String) {\n            val.type = cc.String;\n            if (STATIC_CHECK) {\n                cc.warnID(3608, `\"${className}.${propName}\"`);\n            }\n        }\n        else if (type === Boolean) {\n            val.type = cc.Boolean;\n            if (STATIC_CHECK) {\n                cc.warnID(3609, `\"${className}.${propName}\"`);\n            }\n        }\n        else if (type === Number) {\n            val.type = cc.Float;\n            if (STATIC_CHECK) {\n                cc.warnID(3610, `\"${className}.${propName}\"`);\n            }\n        }\n        else if (STATIC_CHECK && cc.RawAsset.isRawAssetType(type)) {\n            cc.warnID(5509, className, propName, js.getClassName(type));\n        }\n    }\n    else if (STATIC_CHECK) {\n        switch (type) {\n        case 'Number':\n            cc.warnID(5510, className, propName);\n            break;\n        case 'String':\n            cc.warn(`The type of \"${className}.${propName}\" must be cc.String, not \"String\".`);\n            break;\n        case 'Boolean':\n            cc.warn(`The type of \"${className}.${propName}\" must be cc.Boolean, not \"Boolean\".`);\n            break;\n        case 'Float':\n            cc.warn(`The type of \"${className}.${propName}\" must be cc.Float, not \"Float\".`);\n            break;\n        case 'Integer':\n            cc.warn(`The type of \"${className}.${propName}\" must be cc.Integer, not \"Integer\".`);\n            break;\n        case null:\n            cc.warnID(5511, className, propName);\n            break;\n        }\n    }\n}\n\nfunction postCheckType (val, type, className, propName) {\n    if (CC_EDITOR && typeof type === 'function') {\n        if (cc.Class._isCCClass(type) && val.serializable !== false && !js._getClassId(type, false)) {\n            cc.warnID(5512, className, propName, className, propName);\n        }\n    }\n}\n\nfunction getBaseClassWherePropertyDefined_DEV (propName, cls) {\n    if (CC_DEV) {\n        var res;\n        for (; cls && cls.__props__ && cls.__props__.indexOf(propName) !== -1; cls = cls.$super) {\n            res = cls;\n        }\n        if (!res) {\n            cc.error('unknown error');\n        }\n        return res;\n    }\n}\n\nexports.getFullFormOfProperty = function (options, propname_dev, classname_dev) {\n    var isLiteral = options && options.constructor === Object;\n    if (isLiteral) {\n        return null;\n    }\n    if (Array.isArray(options) && options.length > 0) {\n        let type = options[0];\n        if (CC_DEV && cc.RawAsset.wasRawAssetType(type)) {\n            // deprecate `myProp: [cc.Texture2D]` since 1.10\n            cc.warn('Please change the definition of property \\'%s\\' in class \\'%s\\'. Starting from v1.10,\\n' +\n                    'properties in CCClass can not be abbreviated if they are of type RawAsset.\\n' +\n                    'Please use the complete form.\\n' +\n                    'For example, if property is Texture2D\\'s url array, the previous definition is:\\n' +\n                    '    %s: [cc.Texture2D],\\n' +\n                    'If you use JS, it should be changed to:\\n' +\n                    '    %s: {\\n' +\n                    '      type: cc.Texture2D, // use \\'type:\\' to define an array of Texture2D objects\\n' +\n                    '      default: []\\n' +\n                    '    },\\n' +\n                    'If you use TS, it should be changed to:\\n' +\n                    '    %s: {\\n' +\n                    '      type: cc.Texture2D, // use \\'type:\\' to define an array of Texture2D objects\\n' +\n                    '    }\\n' +\n                    '   %s: cc.Texture2D[] = [];\\n'+\n                    '(This helps us to successfully refactor all RawAssets at v2.0, ' +\n                    'sorry for the inconvenience. \\uD83D\\uDE30 )',\n                    propname_dev, classname_dev, propname_dev, propname_dev);\n            return {\n                default: [],\n                url: options,\n                _short: true\n            };\n        }\n        return {\n            default: [],\n            type: options,\n            _short: true\n        };\n    }\n    else if (typeof options === 'function') {\n        let type = options;\n        if (!cc.RawAsset.isRawAssetType(type)) {\n            if (cc.RawAsset.wasRawAssetType(type)) {\n                // deprecate `myProp: cc.Texture2D` since 1.10\n                if (CC_DEV) {\n                    cc.warn('Please change the definition of property \\'%s\\' in class \\'%s\\'. Starting from v1.10,\\n' +\n                            'properties in CCClass can not be abbreviated if they are of type RawAsset.\\n' +\n                            'Please use the complete form.\\n' +\n                            'For example, if the type is Texture2D, the previous definition is:\\n' +\n                            '    %s: cc.Texture2D,\\n' +\n                            'If you use JS, it should be changed to:\\n' +\n                            '    %s: {\\n' +\n                            '      type: cc.Texture2D // use \\'type:\\' to define Texture2D object directly\\n' +\n                            '      default: null,     // object\\'s default value is null\\n' +\n                            '    },\\n' +\n                            'If you use TS, it should be changed to:\\n' +\n                            '    %s: {\\n' +\n                            '      type: cc.Texture2D // use \\'type:\\' to define Texture2D object directly\\n' +\n                            '    }\\n' +\n                            '    %s: cc.Texture2D = null;\\n'+\n                            '(This helps us to successfully refactor all RawAssets at v2.0, ' +\n                            'sorry for the inconvenience. \\uD83D\\uDE30 )',\n                            propname_dev, classname_dev, propname_dev, propname_dev);\n                }\n            }\n            else {\n                return {\n                    default: js.isChildClassOf(type, cc.ValueType) ? new type() : null,\n                    type: type,\n                    _short: true\n                };\n            }\n        }\n        return {\n            default: '',\n            url: type,\n            _short: true\n        };\n    }\n    else if (options instanceof Attrs.PrimitiveType) {\n        return {\n            default: options.default,\n            _short: true\n        };\n    }\n    else {\n        return {\n            default: options,\n            _short: true\n        };\n    }\n};\n\nexports.preprocessAttrs = function (properties, className, cls, es6) {\n    for (var propName in properties) {\n        var val = properties[propName];\n        var fullForm = exports.getFullFormOfProperty(val, propName, className);\n        if (fullForm) {\n            val = properties[propName] = fullForm;\n        }\n        if (val) {\n            if (CC_EDITOR) {\n                if ('default' in val) {\n                    if (val.get) {\n                        cc.errorID(5513, className, propName);\n                    }\n                    else if (val.set) {\n                        cc.errorID(5514, className, propName);\n                    }\n                    else if (cc.Class._isCCClass(val.default)) {\n                        val.default = null;\n                        cc.errorID(5515, className, propName);\n                    }\n                }\n                else if (!val.get && !val.set) {\n                    var maybeTypeScript = es6;\n                    if (!maybeTypeScript) {\n                        cc.errorID(5516, className, propName);\n                    }\n                }\n            }\n            if (CC_DEV && !val.override && cls.__props__.indexOf(propName) !== -1) {\n                // check override\n                var baseClass = js.getClassName(getBaseClassWherePropertyDefined_DEV(propName, cls));\n                cc.warnID(5517, className, propName, baseClass, propName);\n            }\n            var notify = val.notify;\n            if (notify) {\n                if (CC_DEV && es6) {\n                    cc.error('not yet support notify attribute for ES6 Classes');\n                }\n                else {\n                    parseNotify(val, propName, notify, properties);\n                }\n            }\n\n            if ('type' in val) {\n                parseType(val, val.type, className, propName);\n            }\n\n            if ('url' in val) {\n                checkUrl(val, className, propName, val.url);\n            }\n\n            if ('type' in val) {\n                postCheckType(val, val.type, className, propName);\n            }\n        }\n    }\n};\n\nif (CC_DEV) {\n    const CALL_SUPER_DESTROY_REG_DEV = /\\b\\._super\\b|destroy\\s*\\.\\s*call\\s*\\(\\s*\\w+\\s*[,|)]/;\n    exports.doValidateMethodWithProps_DEV = function (func, funcName, className, cls, base) {\n        if (cls.__props__ && cls.__props__.indexOf(funcName) >= 0) {\n            // find class that defines this method as a property\n            var baseClassName = js.getClassName(getBaseClassWherePropertyDefined_DEV(funcName, cls));\n            cc.errorID(3648, className, funcName, baseClassName);\n            return false;\n        }\n        if (funcName === 'destroy' &&\n            js.isChildClassOf(base, cc.Component) &&\n            !CALL_SUPER_DESTROY_REG_DEV.test(func)\n        ) {\n            cc.error(`Overwriting '${funcName}' function in '${className}' class without calling super is not allowed. Call the super function in '${funcName}' please.`);\n        }\n    };\n}\n\nexports.validateMethodWithProps = function (func, funcName, className, cls, base) {\n    if (CC_DEV && funcName === 'constructor') {\n        cc.errorID(3643, className);\n        return false;\n    }\n    if (typeof func === 'function' || func === null) {\n        if (CC_DEV) {\n            this.doValidateMethodWithProps_DEV(func, funcName, className, cls, base);\n        }\n    }\n    else {\n        if (CC_DEV) {\n            if (func === false && base && base.prototype) {\n                // check override\n                var overrided = base.prototype[funcName];\n                if (typeof overrided === 'function') {\n                    var baseFuc = js.getClassName(base) + '.' + funcName;\n                    var subFuc = className + '.' + funcName;\n                    cc.warnID(3624, subFuc, baseFuc, subFuc, subFuc);\n                }\n            }\n            var correct = TYPO_TO_CORRECT_DEV[funcName];\n            if (correct) {\n                cc.warnID(3621, className, funcName, correct);\n            }\n            else if (func) {\n                cc.errorID(3622, className, funcName);\n            }\n        }\n        return false;\n    }\n    return true;\n};\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar requiringFrames = [];  // the requiring frame infos\n\ncc._RF = {\n    push: function (module, uuid, script) {\n        if (script === undefined) {\n            script = uuid;\n            uuid = '';\n        }\n        requiringFrames.push({\n            uuid: uuid,\n            script: script,\n            module: module,\n            exports: module.exports,    // original exports\n            beh: null\n        });\n    },\n    pop: function () {\n        var frameInfo = requiringFrames.pop();\n        // check exports\n        var module = frameInfo.module;\n        var exports = module.exports;\n        if (exports === frameInfo.exports) {\n            for (var anyKey in exports) {\n                // exported\n                return;\n            }\n            // auto export component\n            module.exports = exports = frameInfo.cls;\n        }\n    },\n    peek: function () {\n        return requiringFrames[requiringFrames.length - 1];\n    }\n};\n\nif (CC_EDITOR) {\n    cc._RF.reset = function () {\n        requiringFrames = [];\n    };\n}\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * @class url\n * @static\n */\ncc.url = {\n\n    /**\n     * The base url of raw assets.\n     * @property {Object} _rawAssets\n     * @private\n     * @readOnly\n     */\n    _rawAssets: '',\n    \n    normalize: function (url) {\n        if (url) {\n            if (url.charCodeAt(0) === 46 && url.charCodeAt(1) === 47) {\n                // strip './'\n                url = url.slice(2);\n            }\n            else if (url.charCodeAt(0) === 47) {\n                // strip '/'\n                url = url.slice(1);\n            }\n        }\n        return url;\n    },\n\n    /**\n     * Returns the url of raw assets, you will only need this if the raw asset is inside the \"resources\" folder.\n     * \n     * @method raw\n     * @param {String} url\n     * @return {String}\n     * @example {@link cocos2d/core/platform/url/raw.js}\n     */\n    raw: function (url) {\n        if (CC_EDITOR && !this._rawAssets) {\n            cc.errorID(7000);\n            return '';\n        }\n\n        url = this.normalize(url);\n\n        if ( !url.startsWith('resources/') ) {\n            cc.errorID(CC_EDITOR ? 7001 : 7002, url);\n        }\n        else {\n            // Compatible with versions lower than 1.10\n            var uuid = cc.loader._getResUuid(url.slice(10), cc.Asset, null, true);\n            if (uuid) {\n                return cc.AssetLibrary.getLibUrlNoExt(uuid, true) + cc.path.extname(url);\n            }\n        }\n        \n        return this._rawAssets + url;\n    },\n\n    _init: function (assets) {\n        this._rawAssets = cc.path.stripSep(assets) + '/';\n    }\n};\n\nmodule.exports = cc.url;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n// TODO - merge with misc.js\nconst js = require('./js');\n\nmodule.exports = {\n    contains: function (refNode, otherNode) {\n        if(typeof refNode.contains == 'function'){\n            return refNode.contains(otherNode);\n        }else if(typeof refNode.compareDocumentPosition == 'function' ) {\n            return !!(refNode.compareDocumentPosition(otherNode) & 16);\n        }else {\n            var node = otherNode.parentNode;\n            if (node) {\n                do {\n                    if (node === refNode) {\n                        return true;\n                    } else {\n                        node = node.parentNode;\n                    }\n                } while (node !==null);\n            }\n            return false;\n        }\n    },\n\n    isDomNode: typeof window === 'object' && (typeof Node === 'function' ?\n        function (obj) {\n            // If \"TypeError: Right-hand side of 'instanceof' is not callback\" is thrown,\n            // it should because window.Node was overwritten.\n            return obj instanceof Node;\n        } :\n        function (obj) {\n            return obj &&\n                   typeof obj === 'object' &&\n                   typeof obj.nodeType === 'number' &&\n                   typeof obj.nodeName === 'string';\n        }\n    ),\n\n    callInNextTick: CC_EDITOR ?\n        function (callback, p1, p2) {\n            if (callback) {\n                process.nextTick(function () {\n                    callback(p1, p2);\n                });\n            }\n        }\n        :\n        (\n            \n            function (callback, p1, p2) {\n                if (callback) {\n                    setTimeout(function () {\n                        callback(p1, p2);\n                    }, 0);\n                }\n            }\n        )\n};\n\nif (CC_DEV) {\n    ///**\n    // * @param {Object} obj\n    // * @return {Boolean} is {} ?\n    // */\n    module.exports.isPlainEmptyObj_DEV = function (obj) {\n        if (!obj || obj.constructor !== Object) {\n            return false;\n        }\n       \n        return js.isEmptyObject(obj);\n    };\n    module.exports.cloneable_DEV = function (obj) {\n        return obj &&\n               typeof obj.clone === 'function' &&\n               ( (obj.constructor && obj.constructor.prototype.hasOwnProperty('clone')) || obj.hasOwnProperty('clone') );\n    };\n}\n\nif (CC_TEST) {\n    // editor mocks using in unit tests\n    if (typeof Editor === 'undefined') {\n        window.Editor = {\n            UuidUtils: {\n                NonUuidMark: '.',\n                uuid: function () {\n                    return '' + ((new Date()).getTime() + Math.random());\n                }\n            }\n        };\n    }\n}\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n// predefine some modules for cocos\nrequire('./platform/js');\nrequire('./value-types');\nrequire('./utils');\nrequire('./platform/CCInputManager');\nrequire('./platform/CCInputExtension');\nrequire('./event');\nrequire('./platform/CCSys');\nrequire('./platform/CCMacro');\nrequire('./load-pipeline');\nrequire('./CCDirector');\nrequire('./renderer');\n\nif (!(CC_EDITOR && Editor.isMainProcess)) {\n    require('./platform/CCView');\n    require('./platform/CCScreen');\n    require('./CCScheduler');\n    require('./event-manager');\n}\n","import Assembler from './assembler';\nimport dynamicAtlasManager from './utils/dynamic-atlas/manager';\nimport RenderData from './webgl/render-data';\n\nexport default class Assembler2D extends Assembler {\n    constructor () {\n        super();\n\n        this._renderData = new RenderData();\n        this._renderData.init(this);\n        \n        this.initData();\n        this.initLocal();\n    }\n\n    get verticesFloats () {\n        return this.verticesCount * this.floatsPerVert;\n    }\n\n    initData () {\n        let data = this._renderData;\n        data.createQuadData(0, this.verticesFloats, this.indicesCount);\n    }\n    initLocal () {\n        this._local = [];\n        this._local.length = 4;\n    }\n\n    updateColor (comp, color) {\n        let uintVerts = this._renderData.uintVDatas[0];\n        if (!uintVerts) return;\n        color = color ||comp.node.color._val;\n        let floatsPerVert = this.floatsPerVert;\n        let colorOffset = this.colorOffset;\n        for (let i = colorOffset, l = uintVerts.length; i < l; i += floatsPerVert) {\n            uintVerts[i] = color;\n        }\n    }\n\n    getBuffer () {\n        return cc.renderer._handle._meshBuffer;\n    }\n\n    updateWorldVerts (comp) {\n        let local = this._local;\n        let verts = this._renderData.vDatas[0];\n\n        let matrix = comp.node._worldMatrix;\n        let matrixm = matrix.m,\n            a = matrixm[0], b = matrixm[1], c = matrixm[4], d = matrixm[5],\n            tx = matrixm[12], ty = matrixm[13];\n\n        let vl = local[0], vr = local[2],\n            vb = local[1], vt = local[3];\n        \n        let justTranslate = a === 1 && b === 0 && c === 0 && d === 1;\n\n        if (justTranslate) {\n            // left bottom\n            verts[0] = vl + tx;\n            verts[1] = vb + ty;\n            // right bottom\n            verts[5] = vr + tx;\n            verts[6] = vb + ty;\n            // left top\n            verts[10] = vl + tx;\n            verts[11] = vt + ty;\n            // right top\n            verts[15] = vr + tx;\n            verts[16] = vt + ty;\n        } else {\n            let al = a * vl, ar = a * vr,\n            bl = b * vl, br = b * vr,\n            cb = c * vb, ct = c * vt,\n            db = d * vb, dt = d * vt;\n\n            // left bottom\n            verts[0] = al + cb + tx;\n            verts[1] = bl + db + ty;\n            // right bottom\n            verts[5] = ar + cb + tx;\n            verts[6] = br + db + ty;\n            // left top\n            verts[10] = al + ct + tx;\n            verts[11] = bl + dt + ty;\n            // right top\n            verts[15] = ar + ct + tx;\n            verts[16] = br + dt + ty;\n        }\n    }\n\n    fillBuffers (comp, renderer) {\n        if (renderer.worldMatDirty) {\n            this.updateWorldVerts(comp);\n        }\n\n        let renderData = this._renderData;\n        let vData = renderData.vDatas[0];\n        let iData = renderData.iDatas[0];\n\n        let buffer = this.getBuffer(renderer);\n        let offsetInfo = buffer.request(this.verticesCount, this.indicesCount);\n\n        // buffer data may be realloc, need get reference after request.\n\n        // fill vertices\n        let vertexOffset = offsetInfo.byteOffset >> 2,\n            vbuf = buffer._vData;\n\n        if (vData.length + vertexOffset > vbuf.length) {\n            vbuf.set(vData.subarray(0, vbuf.length - vertexOffset), vertexOffset);\n        } else {\n            vbuf.set(vData, vertexOffset);\n        }\n\n        // fill indices\n        let ibuf = buffer._iData,\n            indiceOffset = offsetInfo.indiceOffset,\n            vertexId = offsetInfo.vertexOffset;\n        for (let i = 0, l = iData.length; i < l; i++) {\n            ibuf[indiceOffset++] = vertexId + iData[i];\n        }\n    }\n\n    packToDynamicAtlas (comp, frame) {\n        if (CC_TEST) return;\n        \n        if (!frame._original && dynamicAtlasManager && frame._texture.packable) {\n            let packedFrame = dynamicAtlasManager.insertSpriteFrame(frame);\n            if (packedFrame) {\n                frame._setDynamicAtlasFrame(packedFrame);\n            }\n        }\n        let material = comp._materials[0];\n        if (!material) return;\n        \n        if (material.getProperty('texture') !== frame._texture) {\n            // texture was packed to dynamic atlas, should update uvs\n            comp._vertsDirty = true;\n            comp._updateMaterial();\n        }\n    }\n}\n\ncc.js.addon(Assembler2D.prototype, {\n    floatsPerVert: 5,\n\n    verticesCount: 4,\n    indicesCount: 6,\n\n    uvOffset: 2,\n    colorOffset: 4,\n});\n\ncc.Assembler2D = Assembler2D;\n","import Pool from '../utils/pool';\n\nlet _assemblerId = 0;\n\nfunction getAssemblerId (assemblerCtor) {\n    if (!Object.getOwnPropertyDescriptor(assemblerCtor, '__assemblerId__')) {\n        assemblerCtor.__assemblerId__ = ++_assemblerId;\n    }\n    return assemblerCtor.__assemblerId__;\n}\n\n/**\n * {\n *   assembler_ctor_id: []\n * }\n */\nclass AssemblerPool extends Pool {\n    _pool = {};\n\n    put (assembler) {\n        if (!assembler) return;\n        if (!this.enabled) {\n            if (CC_JSB && CC_NATIVERENDERER) {\n                assembler.destroy && assembler.destroy();\n            }\n            return;\n        }\n\n        let id = getAssemblerId(assembler.constructor);\n        let pool = this._pool;\n        if (!pool[id]) {\n            pool[id] = [];\n        }\n        if (this.count > this.maxSize) return;\n\n        this._clean(assembler);\n        pool[id].push(assembler);\n        this.count++;\n    }\n\n    get (assemblerCtor) {\n        let assembler;\n        \n        if (this.enabled) {\n            let pool = this._pool;\n            let id = getAssemblerId(assemblerCtor);\n            assembler = pool[id] && pool[id].pop();\n        }\n\n        if (!assembler) {\n            assembler = new assemblerCtor();\n        }\n        else {\n            this.count--;\n        }\n        return assembler;\n    }\n\n    clear () {\n        if (CC_JSB && CC_NATIVERENDERER) {\n            let pool = this._pool;\n            for (let name in pool) {\n                let assemblers = pool[name];\n                if (!assemblers) continue;\n\n                for (let i = 0; i < assemblers.length; i++) {\n                    assemblers[i].destroy && assemblers[i].destroy();\n                }\n            }\n        }\n        \n        this._pool = {};\n        this.count = 0;\n    }\n\n    _clean (assembler) {\n        if (CC_JSB && CC_NATIVERENDERER) {\n            assembler.reset();\n        }\n        assembler._renderComp = null;\n    }\n}\n\nlet pool = new AssemblerPool();\nPool.register('assembler', pool);\nexport default pool;\n","import { vfmtPosUvColor } from './webgl/vertex-format';\nimport assemblerPool from './assembler-pool';\n\nexport default class Assembler {\n    constructor () {\n        this._extendNative && this._extendNative();\n    }\n    init (renderComp) {\n        this._renderComp = renderComp;\n    }\n    \n    updateRenderData (comp) {\n    }\n\n    fillBuffers (comp, renderer) {\n    }\n    \n    getVfmt () {\n        return vfmtPosUvColor;\n    }\n}\n\n\nAssembler.register = function (renderCompCtor, assembler) {\n    renderCompCtor.__assembler__ = assembler;\n};\n\nAssembler.init = function (renderComp) {\n    let renderCompCtor = renderComp.constructor;\n    let assemblerCtor =  renderCompCtor.__assembler__;\n    while (!assemblerCtor) {\n        renderCompCtor = renderCompCtor.$super;\n        if (!renderCompCtor) {\n            cc.warn(`Can not find assembler for render component : [${cc.js.getClassName(renderComp)}]`);\n            return;\n        }\n        assemblerCtor =  renderCompCtor.__assembler__;\n    }\n    if (assemblerCtor.getConstructor) {\n        assemblerCtor = assemblerCtor.getConstructor(renderComp);\n    }\n    \n    if (!renderComp._assembler || renderComp._assembler.constructor !== assemblerCtor) {\n        let assembler = assemblerPool.get(assemblerCtor);\n        assembler.init(renderComp);\n        renderComp._assembler = assembler;\n    }\n};\n\ncc.Assembler = Assembler;\n","\n// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.  \n \nvar Device = function Device(canvasEL) {\n  var ctx;\n\n  try {\n    ctx = canvasEL.getContext('2d');\n  } catch (err) {\n    console.error(err);\n    return;\n  }\n\n  // statics\n  this._canvas = canvasEL;\n  this._ctx = ctx;\n  this._caps = {}; // capability\n  this._stats = {\n    drawcalls: 0,\n  };\n\n  // runtime\n  this._vx = this._vy = this._vw = this._vh = 0;\n  this._sx = this._sy = this._sw = this._sh = 0;\n};\n\nDevice.prototype._restoreTexture = function _restoreTexture (unit) {\n};\n\n// ===============================\n// Immediate Settings\n// ===============================\n\n/**\n * @method setViewport\n * @param {Number} x\n * @param {Number} y\n * @param {Number} w\n * @param {Number} h\n */\nDevice.prototype.setViewport = function setViewport (x, y, w, h) {\n  if (\n    this._vx !== x ||\n    this._vy !== y ||\n    this._vw !== w ||\n    this._vh !== h\n  ) {\n    this._vx = x;\n    this._vy = y;\n    this._vw = w;\n    this._vh = h;\n  }\n};\n\n/**\n * @method setScissor\n * @param {Number} x\n * @param {Number} y\n * @param {Number} w\n * @param {Number} h\n */\nDevice.prototype.setScissor = function setScissor (x, y, w, h) {\n  if (\n    this._sx !== x ||\n    this._sy !== y ||\n    this._sw !== w ||\n    this._sh !== h\n  ) {\n    this._sx = x;\n    this._sy = y;\n    this._sw = w;\n    this._sh = h;\n  }\n};\n\nDevice.prototype.clear = function clear (color) {\n  var ctx = this._ctx;\n  ctx.clearRect(this._vx, this._vy, this._vw, this._vh);\n  if (color && (color[0] !== 0 || color[1] !== 0 || color[2] !== 0)) {\n    ctx.fillStyle = 'rgb(' + color[0] + ',' + color[1] + ',' + color[2] +')';\n    ctx.globalAlpha = color[3];\n    ctx.fillRect(this._vx, this._vy, this._vw, this._vh);\n  }\n};\n\nDevice.prototype.resetDrawCalls = function () {\n  this._stats.drawcalls = 0;\n}\n\nDevice.prototype.getDrawCalls = function () {\n  return this._stats.drawcalls;\n}\n\nmodule.exports = Device;\n","\n// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.  \n \nvar Texture2D = function Texture2D(device, options) {\n  this._device = device;\n    \n  this._width = 4;\n  this._height = 4;\n\n  this._image = null;\n\n  if (options) {\n    if (options.width !== undefined) {\n      this._width = options.width;\n    }\n    if (options.height !== undefined) {\n      this._height = options.height;\n    }\n\n    this.updateImage(options);\n  }\n};\n\nTexture2D.prototype.update = function update (options) {\n  this.updateImage(options);\n};\n\nTexture2D.prototype.updateImage = function updateImage (options) {\n  if (options.images && options.images[0]) {\n    var image = options.images[0];\n    if (image && image !== this._image) {\n      this._image = image;\n    }\n  }\n};\n\nTexture2D.prototype.destroy = function destroy () {\n  this._image = null;\n};\n\nmodule.exports = Texture2D;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\nimport gfx from '../../renderer/gfx';\n\nimport InputAssembler from '../../renderer/core/input-assembler';\nimport Pass from '../../renderer/core/pass';\n\n// const RenderFlow = require('./render-flow');\n\nfunction _initBuiltins(device) {\n    let defaultTexture = new gfx.Texture2D(device, {\n        images: [],\n        width: 128,\n        height: 128,\n        wrapS: gfx.WRAP_REPEAT,\n        wrapT: gfx.WRAP_REPEAT,\n        format: gfx.TEXTURE_FMT_RGB8,\n        mipmap: false,\n    });\n\n    return {\n        defaultTexture: defaultTexture,\n        programTemplates: [],\n        programChunks: {},\n    };\n}\n\n/**\n * @module cc\n */\n\n/**\n * !#en The renderer object which provide access to render system APIs, \n * detailed APIs will be available progressively.\n * !#zh 提供基础渲染接口的渲染器对象，渲染层的基础接口将逐步开放给用户\n * @class renderer\n * @static\n */\nexport default cc.renderer = {\n    Texture2D: null,\n\n    InputAssembler: InputAssembler,\n    Pass: Pass,\n\n    /**\n     * !#en The render engine is available only after cc.game.EVENT_ENGINE_INITED event.<br/>\n     * Normally it will be inited as the webgl render engine, but in wechat open context domain,\n     * it will be inited as the canvas render engine. Canvas render engine is no longer available for other use case since v2.0.\n     * !#zh 基础渲染引擎对象只在 cc.game.EVENT_ENGINE_INITED 事件触发后才可获取。<br/>\n     * 大多数情况下，它都会是 WebGL 渲染引擎实例，但是在微信开放数据域当中，它会是 Canvas 渲染引擎实例。请注意，从 2.0 开始，我们在其他平台和环境下都废弃了 Canvas 渲染器。\n     * @property renderEngine\n     * @deprecated\n     * @type {Object}\n     */\n    renderEngine: null,\n\n    /*\n     * !#en The canvas object which provides the rendering context\n     * !#zh 用于渲染的 Canvas 对象\n     * @property canvas\n     * @type {HTMLCanvasElement}\n     */\n    canvas: null,\n    /*\n     * !#en The device object which provides device related rendering functionality, it divers for different render engine type.\n     * !#zh 提供设备渲染能力的对象，它对于不同的渲染环境功能也不相同。\n     * @property device\n     * @type {renderer.Device}\n     */\n    device: null,\n    scene: null,\n    /**\n     * !#en The total draw call count in last rendered frame.\n     * !#zh 上一次渲染帧所提交的渲染批次总数。\n     * @property drawCalls\n     * @type {Number}\n     */\n    drawCalls: 0,\n    // Render component handler\n    _handle: null,\n    _cameraNode: null,\n    _camera: null,\n    _forward: null,\n    _flow: null,\n\n    initWebGL (canvas, opts) {\n        require('./webgl/assemblers');\n        const ModelBatcher = require('./webgl/model-batcher');\n\n        this.Texture2D = gfx.Texture2D;\n        this.canvas = canvas;\n        this._flow = cc.RenderFlow;\n        \n        if (CC_JSB && CC_NATIVERENDERER) {\n            // native codes will create an instance of Device, so just use the global instance.\n            this.device = gfx.Device.getInstance();\n            this.scene = new renderer.Scene();\n            let builtins = _initBuiltins(this.device);\n            this._forward = new renderer.ForwardRenderer(this.device, builtins);\n            let nativeFlow = new renderer.RenderFlow(this.device, this.scene, this._forward);\n            this._flow.init(nativeFlow);\n        }\n        else {\n            let Scene = require('../../renderer/scene/scene');\n            let ForwardRenderer = require('../../renderer/renderers/forward-renderer');\n            this.device = new gfx.Device(canvas, opts);\n            this.scene = new Scene();\n            let builtins = _initBuiltins(this.device);\n            this._forward = new ForwardRenderer(this.device, builtins);\n            this._handle = new ModelBatcher(this.device, this.scene);\n            this._flow.init(this._handle, this._forward);\n        }\n    },\n\n    initCanvas (canvas) {\n        const canvasRenderer = require('./canvas');\n        const Texture2D = require('./canvas/Texture2D');\n        const Device = require('./canvas/Device');\n\n        // It's actually running with original render engine\n        this.Device = Device;\n\n        this.Texture2D = Texture2D;\n\n        this.canvas = canvas;\n        this.device = new Device(canvas);\n        this._camera = {\n            a: 1, b: 0, c: 0, d: 1, tx: 0, ty: 0\n        };\n        this._handle = new canvasRenderer.RenderComponentHandle(this.device, this._camera);\n        this._forward = new canvasRenderer.ForwardRenderer();\n        this._flow = cc.RenderFlow;\n        this._flow.init(this._handle, this._forward);\n    },\n\n    updateCameraViewport () {\n        // TODO: remove HACK\n        if (!CC_EDITOR && cc.director) {\n            let ecScene = cc.director.getScene();\n            if (ecScene) ecScene.setScale(1, 1, 1);\n        }\n\n        if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {\n            let vp = cc.view.getViewportRect();\n            this.device.setViewport(vp.x, vp.y, vp.width, vp.height);\n            this._camera.a = cc.view.getScaleX();\n            this._camera.d = cc.view.getScaleY();\n            this._camera.tx = vp.x;\n            this._camera.ty = vp.y + vp.height;\n        }\n    },\n\n    render (ecScene, dt) {\n        this.device.resetDrawCalls();\n        if (ecScene) {\n            // walk entity component scene to generate models\n            this._flow.render(ecScene, dt);\n            this.drawCalls = this.device.getDrawCalls();\n        }\n    },\n\n    clear () {\n        this._handle.reset();\n        this._forward.clear();\n    }\n};\n","let FlagOfset = 0;\n\nconst DONOTHING = 1 << FlagOfset++;\nconst BREAK_FLOW = 1 << FlagOfset++;\nconst LOCAL_TRANSFORM = 1 << FlagOfset++;\nconst WORLD_TRANSFORM = 1 << FlagOfset++;\nconst TRANSFORM = LOCAL_TRANSFORM | WORLD_TRANSFORM;\nconst UPDATE_RENDER_DATA = 1 << FlagOfset++;\nconst OPACITY = 1 << FlagOfset++;\nconst COLOR = 1 << FlagOfset++;\nconst OPACITY_COLOR = OPACITY | COLOR;\nconst RENDER = 1 << FlagOfset++;\nconst CHILDREN = 1 << FlagOfset++;\nconst POST_RENDER = 1 << FlagOfset++;\nconst FINAL = 1 << FlagOfset++;\n\nlet _batcher, _forward;\nlet _cullingMask = 0;\n\nfunction RenderFlow () {\n    this._func = init;\n    this._next = null;\n}\n\nlet _proto = RenderFlow.prototype;\n_proto._doNothing = function () {\n};\n\n_proto._localTransform = function (node) {\n    node._updateLocalMatrix();\n    node._renderFlag &= ~LOCAL_TRANSFORM;\n    this._next._func(node);\n};\n\n_proto._worldTransform = function (node) {\n    _batcher.worldMatDirty ++;\n\n    let t = node._matrix;\n    let trs = node._trs;\n    let tm = t.m;\n    tm[12] = trs[0];\n    tm[13] = trs[1];\n    tm[14] = trs[2];\n\n    node._mulMat(node._worldMatrix, node._parent._worldMatrix, t);\n    node._renderFlag &= ~WORLD_TRANSFORM;\n    this._next._func(node);\n\n    _batcher.worldMatDirty --;\n};\n\n_proto._opacity = function (node) {\n    _batcher.parentOpacityDirty++;\n\n    node._renderFlag &= ~OPACITY;\n    this._next._func(node);\n\n    _batcher.parentOpacityDirty--;\n};\n\n_proto._color = function (node) {\n    let comp = node._renderComponent;\n    if (comp) {\n        comp._updateColor();\n    }\n\n    node._renderFlag &= ~COLOR;\n    this._next._func(node);\n};\n\n_proto._updateRenderData = function (node) {\n    let comp = node._renderComponent;\n    comp._assembler.updateRenderData(comp);\n    node._renderFlag &= ~UPDATE_RENDER_DATA;\n    this._next._func(node);\n};\n\n_proto._render = function (node) {\n    let comp = node._renderComponent;\n    comp._checkBacth(_batcher, node._cullingMask);\n    comp._assembler.fillBuffers(comp, _batcher);\n    this._next._func(node);\n};\n\n\n_proto._children = function (node) {\n    let cullingMask = _cullingMask;\n    let batcher = _batcher;\n\n    let parentOpacity = batcher.parentOpacity;\n    let opacity = (batcher.parentOpacity *= (node._opacity / 255));\n\n    let worldTransformFlag = batcher.worldMatDirty ? WORLD_TRANSFORM : 0;\n    let worldOpacityFlag = batcher.parentOpacityDirty ? OPACITY_COLOR : 0;\n    let worldDirtyFlag = worldTransformFlag | worldOpacityFlag;\n\n    let children = node._children;\n    for (let i = 0, l = children.length; i < l; i++) {\n        let c = children[i];\n\n        // Advance the modification of the flag to avoid node attribute modification is invalid when opacity === 0.\n        c._renderFlag |= worldDirtyFlag;\n        if (!c._activeInHierarchy || c._opacity === 0) continue;\n\n        _cullingMask = c._cullingMask = c.groupIndex === 0 ? cullingMask : 1 << c.groupIndex;\n\n        // TODO: Maybe has better way to implement cascade opacity\n        let colorVal = c._color._val;\n        c._color._fastSetA(c._opacity * opacity);\n        flows[c._renderFlag]._func(c);\n        c._color._val = colorVal;\n    }\n\n    batcher.parentOpacity = parentOpacity;\n\n    this._next._func(node);\n};\n\n_proto._postRender = function (node) {\n    let comp = node._renderComponent;\n    comp._checkBacth(_batcher, node._cullingMask);\n    comp._assembler.postFillBuffers(comp, _batcher);\n    this._next._func(node);\n};\n\nconst EMPTY_FLOW = new RenderFlow();\nEMPTY_FLOW._func = EMPTY_FLOW._doNothing;\nEMPTY_FLOW._next = EMPTY_FLOW;\n\nlet flows = {};\n\nfunction createFlow (flag, next) {\n    let flow = new RenderFlow();\n    flow._next = next || EMPTY_FLOW;\n\n    switch (flag) {\n        case DONOTHING: \n            flow._func = flow._doNothing;\n            break;\n        case BREAK_FLOW:\n            flow._func = flow._doNothing;\n            break;\n        case LOCAL_TRANSFORM: \n            flow._func = flow._localTransform;\n            break;\n        case WORLD_TRANSFORM: \n            flow._func = flow._worldTransform;\n            break;\n        case OPACITY:\n            flow._func = flow._opacity;\n            break;\n        case COLOR:\n            flow._func = flow._color;\n            break;\n        case UPDATE_RENDER_DATA:\n            flow._func = flow._updateRenderData;\n            break;\n        case RENDER: \n            flow._func = flow._render;\n            break;\n        case CHILDREN: \n            flow._func = flow._children;\n            break;\n        case POST_RENDER: \n            flow._func = flow._postRender;\n            break;\n    }\n\n    return flow;\n}\n\nfunction getFlow (flag) {\n    let flow = null;\n    let tFlag = FINAL;\n    while (tFlag > 0) {\n        if (tFlag & flag)\n            flow = createFlow(tFlag, flow);\n        tFlag = tFlag >> 1;\n    }\n    return flow;\n}\n\n// \nfunction init (node) {\n    let flag = node._renderFlag;\n    let r = flows[flag] = getFlow(flag);\n    r._func(node);\n}\n\nRenderFlow.flows = flows;\nRenderFlow.createFlow = createFlow;\n\n// validate whether render component is ready to be rendered.\nlet _validateList = [];\nRenderFlow.registerValidate = function (renderComp) {\n    if (renderComp._inValidateList) return;\n    _validateList.push(renderComp);\n    renderComp._inValidateList =  true;\n};\nRenderFlow.validateRenderers = function () {\n    for (let i = 0, l = _validateList.length; i < l; i++) {\n        let renderComp = _validateList[i];\n        if (!renderComp.isValid) continue;\n        if (!renderComp.enabledInHierarchy) {\n            renderComp.disableRender();\n        }\n        else {\n            renderComp._validateRender();\n        }\n        renderComp._inValidateList = false;\n    }\n    _validateList.length = 0;\n};\n\n\nRenderFlow.visitRootNode = function (rootNode) {\n    RenderFlow.validateRenderers();    \n\n    _cullingMask = 1 << rootNode.groupIndex;\n\n    if (rootNode._renderFlag & WORLD_TRANSFORM) {\n        _batcher.worldMatDirty ++;\n        rootNode._calculWorldMatrix();\n        rootNode._renderFlag &= ~WORLD_TRANSFORM;\n\n        flows[rootNode._renderFlag]._func(rootNode);\n\n        _batcher.worldMatDirty --;\n    }\n    else {\n        flows[rootNode._renderFlag]._func(rootNode);\n    }\n};\n\nRenderFlow.render = function (scene, dt) {\n    _batcher.reset();\n    _batcher.walking = true;\n\n    RenderFlow.visitRootNode(scene);\n\n    _batcher.terminate();\n    _batcher.walking = false;\n\n    _forward.render(_batcher._renderScene, dt);\n};\n\nRenderFlow.init = function (batcher, forwardRenderer) {\n    _batcher = batcher;\n    _forward = forwardRenderer;\n\n    flows[0] = EMPTY_FLOW;\n    for (let i = 1; i < FINAL; i++) {\n        flows[i] = new RenderFlow();\n    }\n};\n\nRenderFlow.getBachther = function () {\n    return _batcher;\n};\n\nRenderFlow.FLAG_DONOTHING = DONOTHING;\nRenderFlow.FLAG_BREAK_FLOW = BREAK_FLOW;\nRenderFlow.FLAG_LOCAL_TRANSFORM = LOCAL_TRANSFORM;\nRenderFlow.FLAG_WORLD_TRANSFORM = WORLD_TRANSFORM;\nRenderFlow.FLAG_TRANSFORM = TRANSFORM;\nRenderFlow.FLAG_OPACITY = OPACITY;\nRenderFlow.FLAG_COLOR = COLOR;\nRenderFlow.FLAG_OPACITY_COLOR = OPACITY_COLOR;\nRenderFlow.FLAG_UPDATE_RENDER_DATA = UPDATE_RENDER_DATA;\nRenderFlow.FLAG_RENDER = RENDER;\nRenderFlow.FLAG_CHILDREN = CHILDREN;\nRenderFlow.FLAG_POST_RENDER = POST_RENDER;\nRenderFlow.FLAG_FINAL = FINAL;\n\nmodule.exports = cc.RenderFlow = RenderFlow;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler2D from '../../assembler-2d';\n\nconst textUtils = require('../../../utils/text-utils');\nconst macro = require('../../../platform/CCMacro');\nconst Label = require('../../../components/CCLabel');\nconst Overflow = Label.Overflow;\n\nconst shareLabelInfo = require('../utils').shareLabelInfo;\n\nlet LetterInfo = function() {\n    this.char = '';\n    this.valid = true;\n    this.x = 0;\n    this.y = 0;\n    this.line = 0;\n    this.hash = \"\";\n};\n\nlet _tmpRect = cc.rect();\n\nlet _comp = null;\n\nlet _horizontalKernings = [];\nlet _lettersInfo = [];\nlet _linesWidth = [];\nlet _linesOffsetX = [];\n\nlet _fntConfig = null;\nlet _numberOfLines = 0;\nlet _textDesiredHeight =  0;\nlet _letterOffsetY =  0;\nlet _tailoredTopY =  0;\n\nlet _tailoredBottomY =  0;\nlet _bmfontScale =  1.0;\n\nlet _lineBreakWithoutSpaces =  false;\nlet _spriteFrame = null;\nlet _lineSpacing = 0;\nlet _contentSize = cc.size();\nlet _string = '';\nlet _fontSize = 0;\nlet _originFontSize = 0;\nlet _hAlign = 0;\nlet _vAlign = 0;\nlet _spacingX = 0;\nlet _lineHeight = 0;\nlet _overflow = 0;\nlet _isWrapText = false;\nlet _labelWidth = 0;\nlet _labelHeight = 0;\nlet _maxLineWidth = 0;\n\nexport default class BmfontAssembler extends Assembler2D {\n    updateRenderData (comp) {\n        if (!comp._vertsDirty) return;\n        if (_comp === comp) return;\n\n        _comp = comp;\n        \n        this._reserveQuads(comp, comp.string.toString().length);\n        this._updateFontFamily(comp);\n        this._updateProperties(comp);\n        this._updateLabelInfo(comp);\n        this._updateContent();\n        this.updateWorldVerts(comp);\n        \n        _comp._actualFontSize = _fontSize;\n        _comp.node.setContentSize(_contentSize);\n\n        _comp._vertsDirty = false;\n        _comp = null;\n        this._resetProperties();\n    }\n\n    _updateFontScale () {\n        _bmfontScale = _fontSize / _originFontSize;\n    }\n\n    _updateFontFamily (comp) {\n        let fontAsset = comp.font;\n        _spriteFrame = fontAsset.spriteFrame;\n        _fntConfig = fontAsset._fntConfig;\n        shareLabelInfo.fontAtlas = fontAsset._fontDefDictionary;\n\n        this.packToDynamicAtlas(comp, _spriteFrame);\n    }\n\n    _updateLabelInfo() {\n        // clear\n        shareLabelInfo.hash = \"\";\n        shareLabelInfo.margin = 0;\n    }\n\n    _updateProperties (comp) {\n        _string = comp.string.toString();\n        _fontSize = comp.fontSize;\n        _originFontSize = _fntConfig ? _fntConfig.fontSize : comp.fontSize;\n        _hAlign = comp.horizontalAlign;\n        _vAlign = comp.verticalAlign;\n        _spacingX = comp.spacingX;\n        _overflow = comp.overflow;\n        _lineHeight = comp._lineHeight;\n        \n        _contentSize.width = comp.node.width;\n        _contentSize.height = comp.node.height;\n\n        // should wrap text\n        if (_overflow === Overflow.NONE) {\n            _isWrapText = false;\n            _contentSize.width += shareLabelInfo.margin * 2;\n            _contentSize.height += shareLabelInfo.margin * 2;\n        }\n        else if (_overflow === Overflow.RESIZE_HEIGHT) {\n            _isWrapText = true;\n            _contentSize.height += shareLabelInfo.margin * 2;\n        }\n        else {\n            _isWrapText = comp.enableWrapText;\n        }\n        \n        shareLabelInfo.lineHeight = _lineHeight;\n        shareLabelInfo.fontSize = _fontSize;\n\n        this._setupBMFontOverflowMetrics();\n    }\n\n    _resetProperties () {\n        _fntConfig = null;\n        _spriteFrame = null;\n        shareLabelInfo.hash = \"\";\n        shareLabelInfo.margin = 0;\n    }\n\n    _updateContent () {\n        this._updateFontScale();\n        this._computeHorizontalKerningForText();\n        this._alignText();\n    }\n\n    _computeHorizontalKerningForText () {\n        let string = _string;\n        let stringLen = string.length;\n\n        let kerningDict = _fntConfig.kerningDict;\n        let horizontalKernings = _horizontalKernings;\n\n        let prev = -1;\n        for (let i = 0; i < stringLen; ++i) {\n            let key = string.charCodeAt(i);\n            let kerningAmount = kerningDict[(prev << 16) | (key & 0xffff)] || 0;\n            if (i < stringLen - 1) {\n                horizontalKernings[i] = kerningAmount;\n            } else {\n                horizontalKernings[i] = 0;\n            }\n            prev = key;\n        }\n    }\n\n    _multilineTextWrap (nextTokenFunc) {\n        let textLen = _string.length;\n\n        let lineIndex = 0;\n        let nextTokenX = 0;\n        let nextTokenY = 0;\n        let longestLine = 0;\n        let letterRight = 0;\n\n        let highestY = 0;\n        let lowestY = 0;\n        let letterDef = null;\n        let letterPosition = cc.v2(0, 0);\n\n        for (let index = 0; index < textLen;) {\n            let character = _string.charAt(index);\n            if (character === \"\\n\") {\n                _linesWidth.push(letterRight);\n                letterRight = 0;\n                lineIndex++;\n                nextTokenX = 0;\n                nextTokenY -= _lineHeight * this._getFontScale() + _lineSpacing;\n                this._recordPlaceholderInfo(index, character);\n                index++;\n                continue;\n            }\n\n            let tokenLen = nextTokenFunc(_string, index, textLen);\n            let tokenHighestY = highestY;\n            let tokenLowestY = lowestY;\n            let tokenRight = letterRight;\n            let nextLetterX = nextTokenX;\n            let newLine = false;\n\n            for (let tmp = 0; tmp < tokenLen; ++tmp) {\n                let letterIndex = index + tmp;\n                character = _string.charAt(letterIndex);\n                if (character === \"\\r\") {\n                    this._recordPlaceholderInfo(letterIndex, character);\n                    continue;\n                }\n                letterDef = shareLabelInfo.fontAtlas.getLetterDefinitionForChar(character, shareLabelInfo);\n                if (!letterDef) {\n                    this._recordPlaceholderInfo(letterIndex, character);\n                    console.log(\"Can't find letter definition in texture atlas \" + _fntConfig.atlasName + \" for letter:\" + character);\n                    continue;\n                }\n\n                let letterX = nextLetterX + letterDef.offsetX * _bmfontScale - shareLabelInfo.margin;\n\n                if (_isWrapText\n                    && _maxLineWidth > 0\n                    && nextTokenX > 0\n                    && letterX + letterDef.w * _bmfontScale > _maxLineWidth\n                    && !textUtils.isUnicodeSpace(character)) {\n                    _linesWidth.push(letterRight);\n                    letterRight = 0;\n                    lineIndex++;\n                    nextTokenX = 0;\n                    nextTokenY -= (_lineHeight * this._getFontScale() + _lineSpacing);\n                    newLine = true;\n                    break;\n                } else {\n                    letterPosition.x = letterX;\n                }\n\n                letterPosition.y = nextTokenY - letterDef.offsetY * _bmfontScale  + shareLabelInfo.margin;\n                this._recordLetterInfo(letterPosition, character, letterIndex, lineIndex);\n\n                if (letterIndex + 1 < _horizontalKernings.length && letterIndex < textLen - 1) {\n                    nextLetterX += _horizontalKernings[letterIndex + 1];\n                }\n\n                nextLetterX += letterDef.xAdvance * _bmfontScale + _spacingX  - shareLabelInfo.margin * 2;\n\n                tokenRight = letterPosition.x + letterDef.w * _bmfontScale  - shareLabelInfo.margin;\n\n                if (tokenHighestY < letterPosition.y) {\n                    tokenHighestY = letterPosition.y;\n                }\n\n                if (tokenLowestY > letterPosition.y - letterDef.h * _bmfontScale) {\n                    tokenLowestY = letterPosition.y - letterDef.h * _bmfontScale;\n                }\n\n            } //end of for loop\n\n            if (newLine) continue;\n\n            nextTokenX = nextLetterX;\n            letterRight = tokenRight;\n\n            if (highestY < tokenHighestY) {\n                highestY = tokenHighestY;\n            }\n            if (lowestY > tokenLowestY) {\n                lowestY = tokenLowestY;\n            }\n            if (longestLine < letterRight) {\n                longestLine = letterRight;\n            }\n\n            index += tokenLen;\n        } //end of for loop\n\n        _linesWidth.push(letterRight);\n\n        _numberOfLines = lineIndex + 1;\n        _textDesiredHeight = _numberOfLines * _lineHeight * this._getFontScale();\n        if (_numberOfLines > 1) {\n            _textDesiredHeight += (_numberOfLines - 1) * _lineSpacing;\n        }\n\n        _contentSize.width = _labelWidth;\n        _contentSize.height = _labelHeight;\n        if (_labelWidth <= 0) {\n            _contentSize.width = parseFloat(longestLine.toFixed(2)) + shareLabelInfo.margin * 2;\n        }\n        if (_labelHeight <= 0) {\n            _contentSize.height = parseFloat(_textDesiredHeight.toFixed(2)) + shareLabelInfo.margin * 2;\n        }\n\n        _tailoredTopY = _contentSize.height;\n        _tailoredBottomY = 0;\n\n        if (_overflow !== Overflow.CLAMP) {\n            if (highestY > 0) {\n                _tailoredTopY = _contentSize.height + highestY;\n            }\n    \n            if (lowestY < -_textDesiredHeight) {\n                _tailoredBottomY = _textDesiredHeight + lowestY;\n            }\n        }\n\n        return true;\n    }\n\n    _getFirstCharLen () {\n        return 1;\n    }\n\n    _getFontScale () {\n        return _overflow === Overflow.SHRINK ? _bmfontScale : 1;\n    }\n\n    _getFirstWordLen (text, startIndex, textLen) {\n        let character = text.charAt(startIndex);\n        if (textUtils.isUnicodeCJK(character)\n            || character === \"\\n\"\n            || textUtils.isUnicodeSpace(character)) {\n            return 1;\n        }\n\n        let len = 1;\n        let letterDef = shareLabelInfo.fontAtlas.getLetterDefinitionForChar(character, shareLabelInfo);\n        if (!letterDef) {\n            return len;\n        }\n        let nextLetterX = letterDef.xAdvance * _bmfontScale + _spacingX;\n        let letterX;\n        for (let index = startIndex + 1; index < textLen; ++index) {\n            character = text.charAt(index);\n\n            letterDef = shareLabelInfo.fontAtlas.getLetterDefinitionForChar(character, shareLabelInfo);\n            if (!letterDef) {\n                break;\n            }\n            letterX = nextLetterX + letterDef.offsetX * _bmfontScale;\n\n            if(letterX + letterDef.w * _bmfontScale > _maxLineWidth\n               && !textUtils.isUnicodeSpace(character)\n               && _maxLineWidth > 0) {\n                return len;\n            }\n            nextLetterX += letterDef.xAdvance * _bmfontScale + _spacingX;\n            if (character === \"\\n\"\n                || textUtils.isUnicodeSpace(character)\n                || textUtils.isUnicodeCJK(character)) {\n                break;\n            }\n            len++;\n        }\n\n        return len;\n    }\n\n    _multilineTextWrapByWord () {\n        return this._multilineTextWrap(this._getFirstWordLen);\n    }\n\n    _multilineTextWrapByChar () {\n        return this._multilineTextWrap(this._getFirstCharLen);\n    }\n\n    _recordPlaceholderInfo (letterIndex, char) {\n        if (letterIndex >= _lettersInfo.length) {\n            let tmpInfo = new LetterInfo();\n            _lettersInfo.push(tmpInfo);\n        }\n\n        _lettersInfo[letterIndex].char = char;\n        _lettersInfo[letterIndex].hash = char.charCodeAt(0) + shareLabelInfo.hash;\n        _lettersInfo[letterIndex].valid = false;\n    }\n\n    _recordLetterInfo (letterPosition, character, letterIndex, lineIndex) {\n        if (letterIndex >= _lettersInfo.length) {\n            let tmpInfo = new LetterInfo();\n            _lettersInfo.push(tmpInfo);\n        }\n        let char = character.charCodeAt(0);\n        let key = char + shareLabelInfo.hash;\n\n        _lettersInfo[letterIndex].line= lineIndex;\n        _lettersInfo[letterIndex].char = character;\n        _lettersInfo[letterIndex].hash = key;\n        _lettersInfo[letterIndex].valid = shareLabelInfo.fontAtlas.getLetter(key).valid;\n        _lettersInfo[letterIndex].x = letterPosition.x;\n        _lettersInfo[letterIndex].y = letterPosition.y;\n    }\n\n    _alignText () {\n        _textDesiredHeight = 0;\n        _linesWidth.length = 0;\n\n        if (!_lineBreakWithoutSpaces) {\n            this._multilineTextWrapByWord();\n        } else {\n            this._multilineTextWrapByChar();\n        }\n\n        this._computeAlignmentOffset();\n\n        //shrink\n        if (_overflow === Overflow.SHRINK) {\n            if (_fontSize > 0 && this._isVerticalClamp()) {\n                this._shrinkLabelToContentSize(this._isVerticalClamp);\n            }\n        }\n\n        if (!this._updateQuads()) {\n            if (_overflow === Overflow.SHRINK) {\n                this._shrinkLabelToContentSize(this._isHorizontalClamp);\n            }\n        }\n    }\n\n    _scaleFontSizeDown (fontSize) {\n        let shouldUpdateContent = true;\n        if (!fontSize) {\n            fontSize = 0.1;\n            shouldUpdateContent = false;\n        }\n        _fontSize = fontSize;\n\n        if (shouldUpdateContent) {\n            this._updateContent();\n        }\n    }\n\n    _shrinkLabelToContentSize (lambda) {\n        let fontSize = _fontSize;\n\n        let left = 0, right = fontSize | 0, mid = 0;\n        while (left < right) {\n            mid = (left + right + 1) >> 1;\n\n            let newFontSize = mid;\n            if (newFontSize <= 0) {\n                break;\n            }\n\n            _bmfontScale = newFontSize / _originFontSize;\n            \n            if (!_lineBreakWithoutSpaces) {\n                this._multilineTextWrapByWord();\n            } else {\n                this._multilineTextWrapByChar();\n            }\n            this._computeAlignmentOffset();\n\n            if (lambda()) {\n                right = mid - 1;\n            } else {\n                left = mid;\n            }\n        }\n\n        let actualFontSize = left;\n        if (actualFontSize >= 0) {\n            this._scaleFontSizeDown(actualFontSize);\n        }\n    }\n\n    _isVerticalClamp () {\n        if (_textDesiredHeight > _contentSize.height) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    _isHorizontalClamp () {\n        let letterClamp = false;\n        for (let ctr = 0, l = _string.length; ctr < l; ++ctr) {\n            let letterInfo = _lettersInfo[ctr];\n            if (letterInfo.valid) {\n                let letterDef = shareLabelInfo.fontAtlas.getLetter(letterInfo.hash);\n\n                let px = letterInfo.x + letterDef.w * _bmfontScale;\n                let lineIndex = letterInfo.line;\n                if (_labelWidth > 0) {\n                    if (!_isWrapText) {\n                        if(px > _contentSize.width){\n                            letterClamp = true;\n                            break;\n                        }\n                    }else{\n                        let wordWidth = _linesWidth[lineIndex];\n                        if (wordWidth > _contentSize.width && (px > _contentSize.width || px < 0)) {\n                            letterClamp = true;\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n\n        return letterClamp;\n    }\n\n    _isHorizontalClamped (px, lineIndex) {\n        let wordWidth = _linesWidth[lineIndex];\n        let letterOverClamp = (px > _contentSize.width || px < 0);\n\n        if(!_isWrapText){\n            return letterOverClamp;\n        }else{\n            return (wordWidth > _contentSize.width && letterOverClamp);\n        }\n    }\n\n    _updateQuads () {\n        let texture = _spriteFrame ? _spriteFrame._texture : shareLabelInfo.fontAtlas.getTexture();\n\n        let node = _comp.node;\n\n        this.verticesCount = this.indicesCount = 0;\n        \n        // Need to reset dataLength in Canvas rendering mode.\n        this._renderData && (this._renderData.dataLength = 0);\n\n        let contentSize = _contentSize,\n            appx = node._anchorPoint.x * contentSize.width,\n            appy = node._anchorPoint.y * contentSize.height;\n        \n        let ret = true;\n        for (let ctr = 0, l = _string.length; ctr < l; ++ctr) {\n            let letterInfo = _lettersInfo[ctr];\n            if (!letterInfo.valid) continue;\n            let letterDef = shareLabelInfo.fontAtlas.getLetter(letterInfo.hash);\n\n            _tmpRect.height = letterDef.h;\n            _tmpRect.width = letterDef.w;\n            _tmpRect.x = letterDef.u;\n            _tmpRect.y = letterDef.v;\n\n            let py = letterInfo.y + _letterOffsetY;\n\n            if (_labelHeight > 0) {\n                if (py > _tailoredTopY) {\n                    let clipTop = py - _tailoredTopY;\n                    _tmpRect.y += clipTop;\n                    _tmpRect.height -= clipTop;\n                    py = py - clipTop;\n                }\n\n                if ((py - letterDef.h * _bmfontScale < _tailoredBottomY) && _overflow === Overflow.CLAMP) {\n                    _tmpRect.height = (py < _tailoredBottomY) ? 0 : (py - _tailoredBottomY) / _bmfontScale;\n                }\n            }\n\n            let lineIndex = letterInfo.line;\n            let px = letterInfo.x + letterDef.w / 2 * _bmfontScale + _linesOffsetX[lineIndex];\n\n            if (_labelWidth > 0) {\n                if (this._isHorizontalClamped(px, lineIndex)) {\n                    if (_overflow === Overflow.CLAMP) {\n                        _tmpRect.width = 0;\n                    } else if (_overflow === Overflow.SHRINK) {\n                        if (_contentSize.width > letterDef.w) {\n                            ret = false;\n                            break;\n                        } else {\n                            _tmpRect.width = 0;\n                        }\n                    }\n                }\n            }\n\n            if (_tmpRect.height > 0 && _tmpRect.width > 0) {\n                let isRotated = this._determineRect(_tmpRect);\n                let letterPositionX = letterInfo.x + _linesOffsetX[letterInfo.line];\n                this.appendQuad(_comp, texture, _tmpRect, isRotated, letterPositionX - appx, py - appy, _bmfontScale);\n            }\n        }\n        this._quadsUpdated(_comp);\n\n        return ret;\n    }\n\n    _determineRect (tempRect) {\n        let isRotated = _spriteFrame.isRotated();\n\n        let originalSize = _spriteFrame._originalSize;\n        let rect = _spriteFrame._rect;\n        let offset = _spriteFrame._offset;\n        let trimmedLeft = offset.x + (originalSize.width - rect.width) / 2;\n        let trimmedTop = offset.y - (originalSize.height - rect.height) / 2;\n\n        if(!isRotated) {\n            tempRect.x += (rect.x - trimmedLeft);\n            tempRect.y += (rect.y + trimmedTop);\n        } else {\n            let originalX = tempRect.x;\n            tempRect.x = rect.x + rect.height - tempRect.y - tempRect.height - trimmedTop;\n            tempRect.y = originalX + rect.y - trimmedLeft;\n            if (tempRect.y < 0) {\n                tempRect.height = tempRect.height + trimmedTop;\n            }\n        }\n\n        return isRotated;\n    }\n\n    _computeAlignmentOffset () {\n        _linesOffsetX.length = 0;\n        \n        switch (_hAlign) {\n            case macro.TextAlignment.LEFT:\n                for (let i = 0; i < _numberOfLines; ++i) {\n                    _linesOffsetX.push(0);\n                }\n                break;\n            case macro.TextAlignment.CENTER:\n                for (let i = 0, l = _linesWidth.length; i < l; i++) {\n                    _linesOffsetX.push((_contentSize.width - _linesWidth[i]) / 2);\n                }\n                break;\n            case macro.TextAlignment.RIGHT:\n                for (let i = 0, l = _linesWidth.length; i < l; i++) {\n                    _linesOffsetX.push(_contentSize.width - _linesWidth[i]);\n                }\n                break;\n            default:\n                break;\n        }\n\n        // TOP\n        _letterOffsetY = _contentSize.height;\n        if (_vAlign !== macro.VerticalTextAlignment.TOP) {\n            let blank = _contentSize.height - _textDesiredHeight + _lineHeight * this._getFontScale() - _originFontSize * _bmfontScale;\n            if (_vAlign === macro.VerticalTextAlignment.BOTTOM) {\n                // BOTTOM\n                _letterOffsetY -= blank;\n            } else {\n                // CENTER:\n                _letterOffsetY -= blank / 2;\n            }\n        }\n    }\n\n    _setupBMFontOverflowMetrics () {\n        let newWidth = _contentSize.width,\n            newHeight = _contentSize.height;\n\n        if (_overflow === Overflow.RESIZE_HEIGHT) {\n            newHeight = 0;\n        }\n\n        if (_overflow === Overflow.NONE) {\n            newWidth = 0;\n            newHeight = 0;\n        }\n\n        _labelWidth = newWidth;\n        _labelHeight = newHeight;\n        _maxLineWidth = newWidth;\n    }\n\n    updateWorldVerts() {}\n\n    appendQuad (comp, texture, rect, rotated, x, y, scale) {}\n    _quadsUpdated (comp) {}\n\n    _reserveQuads () {}\n}","/****************************************************************************\n Copyright (c) 2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#en Class for Label Frame.\n * !#zh LabelFrame\n */\nfunction LabelFrame () {\n    // the location of the label on rendering texture\n    this._rect = null;\n    // uv data of frame\n    this.uv = [];\n    // texture of frame\n    this._texture = null;\n    // store original info before packed to dynamic atlas\n    this._original = null;\n}\n\nLabelFrame.prototype = {\n    constructor: LabelFrame,\n\n     /**\n     * !#en Returns the rect of the label frame in the texture.\n     * !#zh 获取 LabelFrame 的纹理矩形区域\n     * @method getRect\n     * @return {Rect}\n     */\n    getRect: function () {\n        return cc.rect(this._rect);\n    },\n    \n    /**\n     * !#en Sets the rect of the label frame in the texture.\n     * !#zh 设置 LabelFrame 的纹理矩形区域\n     * @method setRect\n     * @param {Rect} rect\n     */\n    setRect: function (rect) {\n        this._rect = rect;\n        if (this._texture)\n            this._calculateUV();\n    },\n\n    _setDynamicAtlasFrame (frame) {\n        if (!frame) return;\n\n        this._original = {\n            _texture : this._texture,\n            _x : this._rect.x,\n            _y : this._rect.y\n        }\n        \n        this._texture = frame.texture;\n        this._rect.x = frame.x;\n        this._rect.y = frame.y;\n        this._calculateUV();\n    },\n    _resetDynamicAtlasFrame () {\n        if (!this._original) return;\n        this._rect.x = this._original._x;\n        this._rect.y = this._original._y;\n        this._texture = this._original._texture;\n        this._original = null;\n        this._calculateUV();\n    },\n\n    _refreshTexture: function (texture) {\n        this._texture = texture;\n        this._rect = cc.rect(0, 0, texture.width, texture.height);\n        this._calculateUV();\n    },\n\n    _calculateUV() {\n        let rect = this._rect,\n            texture = this._texture,\n            uv = this.uv,\n            texw = texture.width,\n            texh = texture.height;\n\n        let l = texw === 0 ? 0 : rect.x / texw;\n        let r = texw === 0 ? 0 : (rect.x + rect.width) / texw;\n        let b = texh === 0 ? 0 : (rect.y + rect.height) / texh;\n        let t = texh === 0 ? 0 : rect.y / texh;\n\n        uv[0] = l;\n        uv[1] = b;\n        uv[2] = r;\n        uv[3] = b;\n        uv[4] = l;\n        uv[5] = t;\n        uv[6] = r;\n        uv[7] = t;\n    }\n}\n\nmodule.exports = LabelFrame;\n","/****************************************************************************\n Copyright (c) 2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport WebglBmfontAssembler from '../../webgl/assemblers/label/2d/bmfont';\n\nconst Label = require('../../../components/CCLabel');\nconst LabelOutline = require('../../../components/CCLabelOutline');\nconst textUtils = require('../../../utils/text-utils');\nconst Component = require('../../../components/CCComponent');\nconst RenderTexture = require('../../../assets/CCRenderTexture');\nconst OUTLINE_SUPPORTED = cc.js.isChildClassOf(LabelOutline, Component);\nconst getFontFamily = require('../utils').getFontFamily;\nconst shareLabelInfo = require('../utils').shareLabelInfo;\n\n\nconst FontLetterDefinition = cc.BitmapFont.FontLetterDefinition;\nconst FontAtlas = cc.BitmapFont.FontAtlas;\n\nconst WHITE = cc.Color.WHITE;\nconst space = 0;\nconst bleed = 2;\nconst _invisibleAlpha = (1 / 255).toFixed(3);\n\nfunction LetterTexture(char, labelInfo) {\n    this._texture = null;\n    this._labelInfo = labelInfo;\n    this._char = char;\n    this._hash = null;\n    this._data = null;\n    this._canvas = null;\n    this._context = null;\n    this._width = 0;\n    this._height = 0;\n    this._offsetY = 0;\n    this._hash = char.charCodeAt(0) + labelInfo.hash;\n}\n\nLetterTexture.prototype = {\n    constructor: LetterTexture,\n\n    updateRenderData () {\n        this._updateProperties();\n        this._updateTexture();\n    },\n    _updateProperties () {\n        this._texture = new cc.Texture2D();\n        this._data = Label._canvasPool.get();\n        this._canvas = this._data.canvas;\n        this._context = this._data.context;\n        this._context.font = this._labelInfo.fontDesc;\n        let width = textUtils.safeMeasureText(this._context, this._char, this._labelInfo.fontDesc);\n        let blank = this._labelInfo.margin * 2 + bleed;\n        this._width = parseFloat(width.toFixed(2)) + blank;\n        this._height = (1 + textUtils.BASELINE_RATIO) * this._labelInfo.fontSize + blank;\n        this._offsetY = - (this._labelInfo.fontSize * textUtils.BASELINE_RATIO) / 2;\n\n        if (this._canvas.width !== this._width) {\n            this._canvas.width = this._width;\n        }\n\n        if (this._canvas.height !== this._height) {\n            this._canvas.height = this._height;\n        }\n\n        this._texture.initWithElement(this._canvas);\n    },\n    _updateTexture () {\n        let context = this._context;\n        let labelInfo = this._labelInfo,\n            width = this._canvas.width,\n            height = this._canvas.height;\n\n        let startX = width / 2;\n        let startY = height / 2 + this._labelInfo.fontSize * textUtils.MIDDLE_RATIO;\n        let color = labelInfo.color;\n\n        context.textAlign = 'center';\n        context.textBaseline = 'alphabetic';\n        context.clearRect(0, 0, width, height);\n        //Add a white background to avoid black edges.\n        context.fillStyle = `rgba(${color.r}, ${color.g}, ${color.b}, ${_invisibleAlpha})`;\n        context.fillRect(0, 0, width, height);\n        context.font = labelInfo.fontDesc;\n\n        //use round for line join to avoid sharp intersect point\n        context.lineJoin = 'round';\n        context.fillStyle = `rgba(${color.r}, ${color.g}, ${color.b}, 1)`;\n        if (labelInfo.isOutlined && labelInfo.margin > 0) {\n            let strokeColor = labelInfo.out || WHITE;\n            context.strokeStyle = `rgba(${strokeColor.r}, ${strokeColor.g}, ${strokeColor.b}, ${strokeColor.a / 255})`;\n            context.lineWidth = labelInfo.margin * 2;\n            context.strokeText(this._char, startX, startY);\n        }\n        context.fillText(this._char, startX, startY);\n\n        this._texture.handleLoadedTexture();\n    },\n\n    destroy () {\n        this._texture.destroy();\n        this._texture = null;\n        Label._canvasPool.put(this._data);\n    },\n}\n\nfunction LetterAtlas (width, height) {\n    let texture = new RenderTexture();\n    texture.initWithSize(width, height);\n    texture.update();\n\n    this._fontDefDictionary = new FontAtlas(texture);\n    \n    this._x = space;\n    this._y = space;\n    this._nexty = space;\n\n    this._width = width;\n    this._height = height;\n\n    cc.director.on(cc.Director.EVENT_BEFORE_SCENE_LAUNCH, this.beforeSceneLoad, this);\n}\n\ncc.js.mixin(LetterAtlas.prototype, {\n    insertLetterTexture (letterTexture) {\n        let texture = letterTexture._texture;\n        let width = texture.width, height = texture.height;        \n\n        if ((this._x + width + space) > this._width) {\n            this._x = space;\n            this._y = this._nexty;\n        }\n\n        if ((this._y + height) > this._nexty) {\n            this._nexty = this._y + height + space;\n        }\n\n        if (this._nexty > this._height) {\n            return null;\n        }\n\n        this._fontDefDictionary._texture.drawTextureAt(texture, this._x, this._y);\n\n        this._dirty = true;\n        \n        let letter = new FontLetterDefinition();\n        letter.u = this._x + bleed/2;\n        letter.v = this._y + bleed/2;\n        letter.texture = this._fontDefDictionary._texture;\n        letter.valid = true;\n        letter.w = letterTexture._width - bleed;\n        letter.h = letterTexture._height - bleed;\n        letter.xAdvance = letter.w;\n        letter.offsetY = letterTexture._offsetY;\n\n        this._x += width + space;\n\n        this._fontDefDictionary.addLetterDefinitions(letterTexture._hash, letter);\n        \n        return letter\n    },\n\n    update () {\n        if (!this._dirty) return;\n        this._fontDefDictionary._texture.update();\n        this._dirty = false;\n    },\n\n    reset () {\n        this._x = space;\n        this._y = space;\n        this._nexty = space;\n\n        let chars = this._fontDefDictionary._letterDefinitions;\n        for (let i = 0, l = chars.length; i < l; i++) {\n            let char = chars[i];\n            if (!char.isValid) {\n                continue;\n            }\n            char.destroy();\n        }\n\n        this._fontDefDictionary.clear();\n    },\n\n    destroy () {\n        this.reset();\n        this._fontDefDictionary._texture.destroy();\n        this._fontDefDictionary._texture = null;\n    },\n\n    beforeSceneLoad () {\n        this.clearAllCache();\n    },\n\n    clearAllCache () {\n        this.destroy();\n\n        let texture = new RenderTexture();\n        texture.initWithSize(this._width, this._height);\n        texture.update();\n        \n        this._fontDefDictionary._texture = texture;\n    },\n\n    getLetter (key) {\n        return this._fontDefDictionary._letterDefinitions[key];\n    },\n\n    getTexture () {\n        return this._fontDefDictionary.getTexture();\n    },\n\n    getLetterDefinitionForChar: function(char, labelInfo) {\n        let hash = char.charCodeAt(0) + labelInfo.hash;\n        let letter = this._fontDefDictionary._letterDefinitions[hash];\n        if (!letter) {\n            let temp = new LetterTexture(char, labelInfo);\n            temp.updateRenderData();\n            letter = this.insertLetterTexture(temp);\n            temp.destroy();\n        }\n\n        return letter;\n    }\n});\n\nfunction computeHash (labelInfo) {\n    let hashData = '';\n    let color = labelInfo.color.toHEX(\"#rrggbb\");\n    let out = '';\n    if (labelInfo.isOutlined && labelInfo.margin > 0) {\n        out = out + labelInfo.margin + labelInfo.out.toHEX(\"#rrggbb\");\n    };\n    \n    return hashData + labelInfo.fontSize + labelInfo.fontFamily + color + out;\n}\n\nlet _shareAtlas = null;\n\nlet _atlasWidth = 2048;\nlet _atlasHeight = 2048;\nlet _isBold = false;\n\nexport default class LetterFontAssembler extends WebglBmfontAssembler {\n    _getAssemblerData () {\n        if (!_shareAtlas) {\n            _shareAtlas = new LetterAtlas(_atlasWidth, _atlasHeight);\n            cc.Label._shareAtlas = _shareAtlas;\n        }\n        \n        return _shareAtlas.getTexture();\n    }\n\n    _updateFontFamily (comp) {\n        shareLabelInfo.fontAtlas = _shareAtlas;\n        shareLabelInfo.fontFamily = getFontFamily(comp);\n\n        // outline\n        let outline = OUTLINE_SUPPORTED && comp.getComponent(LabelOutline);\n        if (outline && outline.enabled) {\n            shareLabelInfo.isOutlined = true;\n            shareLabelInfo.margin = outline.width;\n            shareLabelInfo.out = outline.color.clone();\n            shareLabelInfo.out.a = outline.color.a * comp.node.color.a / 255.0;\n        }\n        else {\n            shareLabelInfo.isOutlined = false;\n            shareLabelInfo.margin = 0;\n        }\n    }\n\n    _updateLabelInfo (comp) {\n        shareLabelInfo.fontDesc = this._getFontDesc();\n        shareLabelInfo.color = comp.node.color;\n        shareLabelInfo.hash = computeHash(shareLabelInfo);\n    }\n\n    _getFontDesc () {\n        let fontDesc = shareLabelInfo.fontSize.toString() + 'px ';\n        fontDesc = fontDesc + shareLabelInfo.fontFamily;\n        if (_isBold) {\n            fontDesc = \"bold \" + fontDesc;\n        }\n\n        return fontDesc;\n    }\n    _computeHorizontalKerningForText () {}\n    _determineRect (tempRect) {\n        return false;\n    }\n}","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler2D from '../../assembler-2d';\n\nlet textUtils = require('../../../utils/text-utils');\nconst macro = require('../../../platform/CCMacro');\nconst Label = require('../../../components/CCLabel');\nconst LabelOutline = require('../../../components/CCLabelOutline');\nconst LabelShadow = require('../../../components/CCLabelShadow');\nconst Overflow = Label.Overflow;\nconst deleteFromDynamicAtlas = require('../utils').deleteFromDynamicAtlas;\nconst getFontFamily = require('../utils').getFontFamily;\n\nconst MAX_SIZE = 2048;\nconst _invisibleAlpha = (1 / 255).toFixed(3);\n\nlet _context = null;\nlet _canvas = null;\nlet _texture = null;\n\nlet _fontDesc = '';\nlet _string = '';\nlet _fontSize = 0;\nlet _drawFontSize = 0;\nlet _splitedStrings = [];\nlet _canvasSize = cc.Size.ZERO;\nlet _lineHeight = 0;\nlet _hAlign = 0;\nlet _vAlign = 0;\nlet _color = null;\nlet _fontFamily = '';\nlet _overflow = Overflow.NONE;\nlet _isWrapText = false;\n\n// outline\nlet _outlineComp = null;\nlet _outlineColor = cc.Color.WHITE;\n\n// shadow\nlet _shadowComp = null;\nlet _shadowColor = cc.Color.BLACK;\n\nlet _canvasPadding = cc.rect();\nlet _contentSizeExtend = cc.Size.ZERO;\nlet _nodeContentSize = cc.Size.ZERO;\n\nlet _enableBold = false;\nlet _enableItalic = false;\nlet _enableUnderline = false;\nlet _underlineThickness = 0;\n\nlet _drawUnderlinePos = cc.Vec2.ZERO;\nlet _drawUnderlineWidth = 0;\n\nlet _sharedLabelData;\n\nexport default class TTFAssembler extends Assembler2D {\n    _getAssemblerData () {\n        _sharedLabelData = Label._canvasPool.get();\n        _sharedLabelData.canvas.width = _sharedLabelData.canvas.height = 1;\n        return _sharedLabelData;\n    }\n\n    _resetAssemblerData (assemblerData) {\n        if (assemblerData) {\n            Label._canvasPool.put(assemblerData);\n        }\n    }\n\n    updateRenderData (comp) {\n        super.updateRenderData(comp);\n        \n        if (!comp._vertsDirty) return;\n\n        this._updateFontFamily(comp);\n        this._updateProperties(comp);\n        this._calculateLabelFont();\n        this._calculateSplitedStrings();\n        this._updateLabelDimensions();\n        this._calculateTextBaseline();\n        this._updateTexture(comp);\n        this._calDynamicAtlas(comp);\n\n        comp._actualFontSize = _fontSize;\n        comp.node.setContentSize(_nodeContentSize);\n\n        this.updateVerts(comp);\n\n        comp._vertsDirty = false;\n\n        _context = null;\n        _canvas = null;\n        _texture = null;\n    }\n\n    updateVerts () {\n    }\n\n    _updatePaddingRect () {\n        let top = 0, bottom = 0, left = 0, right = 0;\n        let outlineWidth = 0;\n        _contentSizeExtend.width = _contentSizeExtend.height = 0;\n        if (_outlineComp) {\n            outlineWidth = _outlineComp.width;\n            top = bottom = left = right = outlineWidth;\n            _contentSizeExtend.width = _contentSizeExtend.height = outlineWidth * 2;\n        }\n        if (_shadowComp) {\n            let shadowWidth = _shadowComp.blur + outlineWidth;\n            left = Math.max(left, -_shadowComp._offset.x + shadowWidth);\n            right = Math.max(right, _shadowComp._offset.x + shadowWidth);\n            top = Math.max(top, _shadowComp._offset.y + shadowWidth);\n            bottom = Math.max(bottom, -_shadowComp._offset.y + shadowWidth);\n        }\n        if (_enableItalic) {\n            //0.0174532925 = 3.141592653 / 180\n            let offset = _drawFontSize * Math.tan(12 * 0.0174532925);\n            right += offset;\n            _contentSizeExtend.width += offset;\n        }\n        _canvasPadding.x = left;\n        _canvasPadding.y = top;\n        _canvasPadding.width = left + right;\n        _canvasPadding.height = top + bottom;\n    }\n\n    _updateFontFamily (comp) {\n        _fontFamily = getFontFamily(comp);\n    }\n\n    _updateProperties (comp) {\n        let assemblerData = comp._assemblerData;\n        _context = assemblerData.context;\n        _canvas = assemblerData.canvas;\n        _texture = comp._frame._original ? comp._frame._original._texture : comp._frame._texture;\n\n        _string = comp.string.toString();\n        _fontSize = comp._fontSize;\n        _drawFontSize = _fontSize;\n        _underlineThickness = comp.underlineHeight || _drawFontSize / 8;\n        _overflow = comp.overflow;\n        _canvasSize.width = comp.node.width;\n        _canvasSize.height = comp.node.height;\n        _nodeContentSize = comp.node.getContentSize();\n        _lineHeight = comp._lineHeight;\n        _hAlign = comp.horizontalAlign;\n        _vAlign = comp.verticalAlign;\n        _color = comp.node.color;\n        _enableBold = comp.enableBold;\n        _enableItalic = comp.enableItalic;\n        _enableUnderline = comp.enableUnderline;\n\n        if (_overflow === Overflow.NONE) {\n            _isWrapText = false;\n        }\n        else if (_overflow === Overflow.RESIZE_HEIGHT) {\n            _isWrapText = true;\n        }\n        else {\n            _isWrapText = comp.enableWrapText;\n        }\n\n        // outline\n        _outlineComp = LabelOutline && comp.getComponent(LabelOutline);\n        _outlineComp = (_outlineComp && _outlineComp.enabled && _outlineComp.width > 0) ? _outlineComp : null;\n        if (_outlineComp) {\n            _outlineColor.set(_outlineComp.color);\n        }\n\n        // shadow\n        _shadowComp = LabelShadow && comp.getComponent(LabelShadow);\n        _shadowComp = (_shadowComp && _shadowComp.enabled) ? _shadowComp : null;\n        if (_shadowComp) {\n            _shadowColor.set(_shadowComp.color);\n            // TODO: temporary solution, cascade opacity for outline color\n            _shadowColor.a = _shadowColor.a * comp.node.color.a / 255.0;\n        }\n\n        this._updatePaddingRect();\n    }\n\n    _calculateFillTextStartPosition () {\n        let labelX = 0;\n        if (_hAlign === macro.TextAlignment.RIGHT) {\n            labelX = _canvasSize.width - _canvasPadding.width;\n        }\n        else if (_hAlign === macro.TextAlignment.CENTER) {\n            labelX = (_canvasSize.width - _canvasPadding.width) / 2;\n        }\n\n        let lineHeight = this._getLineHeight();\n        let drawStartY = lineHeight * (_splitedStrings.length - 1);\n        // TOP\n        let firstLinelabelY = _fontSize * (1 - textUtils.BASELINE_RATIO / 2);\n        if (_vAlign !== macro.VerticalTextAlignment.TOP) {\n            // free space in vertical direction\n            let blank = drawStartY + _canvasPadding.height + _fontSize - _canvasSize.height;\n            if (_vAlign === macro.VerticalTextAlignment.BOTTOM) {\n                // Unlike BMFont, needs to reserve space below.\n                blank += textUtils.BASELINE_RATIO / 2 * _fontSize;\n                // BOTTOM\n                firstLinelabelY -= blank;\n            } else {\n                // CENTER\n                firstLinelabelY -= blank / 2;\n            }\n        }\n\n        return cc.v2(labelX + _canvasPadding.x, firstLinelabelY + _canvasPadding.y);\n    }\n\n    _setupOutline () {\n        _context.strokeStyle = `rgba(${_outlineColor.r}, ${_outlineColor.g}, ${_outlineColor.b}, ${_outlineColor.a / 255})`;\n        _context.lineWidth = _outlineComp.width * 2;\n    }\n\n    _setupShadow () {\n        _context.shadowColor = `rgba(${_shadowColor.r}, ${_shadowColor.g}, ${_shadowColor.b}, ${_shadowColor.a / 255})`;\n        _context.shadowBlur = _shadowComp.blur;\n        _context.shadowOffsetX = _shadowComp.offset.x;\n        _context.shadowOffsetY = -_shadowComp.offset.y;\n    }\n\n    _drawUnderline (underlinewidth) {\n        if (_outlineComp) {\n            this._setupOutline();\n            _context.strokeRect(_drawUnderlinePos.x, _drawUnderlinePos.y, underlinewidth, _underlineThickness);\n        }\n        _context.lineWidth = _underlineThickness;\n        _context.fillStyle = `rgba(${_color.r}, ${_color.g}, ${_color.b}, ${_color.a / 255})`;\n        _context.fillRect(_drawUnderlinePos.x, _drawUnderlinePos.y, underlinewidth, _underlineThickness);\n    }\n\n    _updateTexture () {\n        _context.clearRect(0, 0, _canvas.width, _canvas.height);\n        //Add a white background to avoid black edges.\n        //TODO: it is best to add alphaTest to filter out the background color.\n        let _fillColor = _outlineComp ? _outlineColor : _color;\n        _context.fillStyle = `rgba(${_fillColor.r}, ${_fillColor.g}, ${_fillColor.b}, ${_invisibleAlpha})`;\n        _context.fillRect(0, 0, _canvas.width, _canvas.height);\n        _context.font = _fontDesc;\n\n        let startPosition = this._calculateFillTextStartPosition();\n        let lineHeight = this._getLineHeight();\n        //use round for line join to avoid sharp intersect point\n        _context.lineJoin = 'round';\n        _context.fillStyle = `rgba(${_color.r}, ${_color.g}, ${_color.b}, 1)`;\n\n        let isMultiple = _splitedStrings.length > 1;\n\n        //do real rendering\n        let measureText = this._measureText(_context, _fontDesc);\n\n        let drawTextPosX = 0, drawTextPosY = 0;\n\n        // only one set shadow and outline\n        if (_shadowComp) {\n            this._setupShadow();\n        }\n        if (_outlineComp && _outlineComp.width > 0) {\n            this._setupOutline();\n        }\n\n        // draw shadow and (outline or text)\n        for (let i = 0; i < _splitedStrings.length; ++i) {\n            drawTextPosX = startPosition.x;\n            drawTextPosY = startPosition.y + i * lineHeight;\n            if (_shadowComp) {\n                // multiple lines need to be drawn outline and fill text\n                if (isMultiple) {\n                    if (_outlineComp && _outlineComp.width > 0) {\n                        _context.strokeText(_splitedStrings[i], drawTextPosX, drawTextPosY);\n                    }\n                    _context.fillText(_splitedStrings[i], drawTextPosX, drawTextPosY);\n                }\n            }\n\n            // draw underline\n            if (_enableUnderline) {\n                _drawUnderlineWidth = measureText(_splitedStrings[i]);\n                if (_hAlign === macro.TextAlignment.RIGHT) {\n                    _drawUnderlinePos.x = startPosition.x - _drawUnderlineWidth;\n                } else if (_hAlign === macro.TextAlignment.CENTER) {\n                    _drawUnderlinePos.x = startPosition.x - (_drawUnderlineWidth / 2);\n                } else {\n                    _drawUnderlinePos.x = startPosition.x;\n                }\n                _drawUnderlinePos.y = drawTextPosY + _drawFontSize / 8;\n                this._drawUnderline(_drawUnderlineWidth);\n            }\n        }\n\n        if (_shadowComp && isMultiple) {\n            _context.shadowColor = 'transparent';\n        }\n\n        // draw text and outline\n        for (let i = 0; i < _splitedStrings.length; ++i) {\n            drawTextPosX = startPosition.x;\n            drawTextPosY = startPosition.y + i * lineHeight;\n            if (_outlineComp && _outlineComp.width > 0) {\n                _context.strokeText(_splitedStrings[i], drawTextPosX, drawTextPosY);\n            }\n            _context.fillText(_splitedStrings[i], drawTextPosX, drawTextPosY);\n        }\n\n        if (_shadowComp) {\n            _context.shadowColor = 'transparent';\n        }\n\n        _texture.handleLoadedTexture();\n    }\n\n    _calDynamicAtlas (comp) {\n        if(comp.cacheMode !== Label.CacheMode.BITMAP) return;\n        let frame = comp._frame;\n        // Delete cache in atlas.\n        deleteFromDynamicAtlas(comp, frame);\n        if (!frame._original) {\n            frame.setRect(cc.rect(0, 0, _canvas.width, _canvas.height));\n        }\n        this.packToDynamicAtlas(comp, frame);\n    }\n\n    _updateLabelDimensions () {\n        let paragraphedStrings = _string.split('\\n');\n\n        if (_overflow === Overflow.RESIZE_HEIGHT) {\n            let rawHeight = (_splitedStrings.length + textUtils.BASELINE_RATIO) * this._getLineHeight();\n            _canvasSize.height = rawHeight + _canvasPadding.height;\n            // set node height\n            _nodeContentSize.height = rawHeight + _contentSizeExtend.height;\n        }\n        else if (_overflow === Overflow.NONE) {\n            _splitedStrings = paragraphedStrings;\n            let canvasSizeX = 0;\n            let canvasSizeY = 0;\n            for (let i = 0; i < paragraphedStrings.length; ++i) {\n                let paraLength = textUtils.safeMeasureText(_context, paragraphedStrings[i], _fontDesc);\n                canvasSizeX = canvasSizeX > paraLength ? canvasSizeX : paraLength;\n            }\n            canvasSizeY = (_splitedStrings.length + textUtils.BASELINE_RATIO) * this._getLineHeight();\n            let rawWidth = parseFloat(canvasSizeX.toFixed(2));\n            let rawHeight = parseFloat(canvasSizeY.toFixed(2));\n            _canvasSize.width = rawWidth + _canvasPadding.width;\n            _canvasSize.height = rawHeight + _canvasPadding.height;\n            _nodeContentSize.width = rawWidth + _contentSizeExtend.width;\n            _nodeContentSize.height = rawHeight + _contentSizeExtend.height;\n        }\n\n        _canvasSize.width = Math.min(_canvasSize.width, MAX_SIZE);\n        _canvasSize.height = Math.min(_canvasSize.height, MAX_SIZE);\n\n        if (_canvas.width !== _canvasSize.width) {\n            _canvas.width = _canvasSize.width;\n        }\n\n        if (_canvas.height !== _canvasSize.height) {\n            _canvas.height = _canvasSize.height;\n        }\n    }\n\n    _calculateTextBaseline () {\n        let hAlign;\n\n        if (_hAlign === macro.TextAlignment.RIGHT) {\n            hAlign = 'right';\n        }\n        else if (_hAlign === macro.TextAlignment.CENTER) {\n            hAlign = 'center';\n        }\n        else {\n            hAlign = 'left';\n        }\n        _context.textAlign = hAlign;\n        _context.textBaseline = 'alphabetic';\n    }\n\n    _calculateSplitedStrings () {\n        let paragraphedStrings = _string.split('\\n');\n\n        if (_isWrapText) {\n            _splitedStrings = [];\n            let canvasWidthNoMargin = _nodeContentSize.width;\n            for (let i = 0; i < paragraphedStrings.length; ++i) {\n                let allWidth = textUtils.safeMeasureText(_context, paragraphedStrings[i], _fontDesc);\n                let textFragment = textUtils.fragmentText(paragraphedStrings[i],\n                                                        allWidth,\n                                                        canvasWidthNoMargin,\n                                                        this._measureText(_context, _fontDesc));\n                _splitedStrings = _splitedStrings.concat(textFragment);\n            }\n        }\n        else {\n            _splitedStrings = paragraphedStrings;\n        }\n\n    }\n\n    _getFontDesc () {\n        let fontDesc = _fontSize.toString() + 'px ';\n        fontDesc = fontDesc + _fontFamily;\n        if (_enableBold) {\n            fontDesc = \"bold \" + fontDesc;\n        }\n        if (_enableItalic) {\n            fontDesc = \"italic \" + fontDesc;\n        }\n        return fontDesc;\n    }\n\n    _getLineHeight () {\n        let nodeSpacingY = _lineHeight;\n        if (nodeSpacingY === 0) {\n            nodeSpacingY = _fontSize;\n        } else {\n            nodeSpacingY = nodeSpacingY * _fontSize / _drawFontSize;\n        }\n\n        return nodeSpacingY | 0;\n    }\n\n    _calculateParagraphLength (paragraphedStrings, ctx) {\n        let paragraphLength = [];\n\n        for (let i = 0; i < paragraphedStrings.length; ++i) {\n            let width = textUtils.safeMeasureText(ctx, paragraphedStrings[i], _fontDesc);\n            paragraphLength.push(width);\n        }\n\n        return paragraphLength;\n    }\n\n    _measureText (ctx, fontDesc) {\n        return function (string) {\n            return textUtils.safeMeasureText(ctx, string, fontDesc);\n        };\n    }\n\n    _calculateLabelFont () {\n        _fontDesc = this._getFontDesc();\n        _context.font = _fontDesc;\n\n        if (_overflow === Overflow.SHRINK) {\n            let paragraphedStrings = _string.split('\\n');\n            let paragraphLength = this._calculateParagraphLength(paragraphedStrings, _context);\n            \n            let i = 0;\n            let totalHeight = 0;\n            let maxLength = 0;\n\n            if (_isWrapText) {\n                let canvasWidthNoMargin = _nodeContentSize.width;\n                let canvasHeightNoMargin = _nodeContentSize.height;\n                if (canvasWidthNoMargin < 0 || canvasHeightNoMargin < 0) {\n                    _fontDesc = this._getFontDesc();\n                    _context.font = _fontDesc;\n                    return;\n                }\n                totalHeight = canvasHeightNoMargin + 1;\n                maxLength = canvasWidthNoMargin + 1;\n                let actualFontSize = _fontSize + 1;\n                let textFragment = \"\";\n                //let startShrinkFontSize = actualFontSize | 0;\n                let left = 0, right = actualFontSize | 0, mid = 0;\n\n                while (left < right) {\n                    mid = (left + right + 1) >> 1;\n\n                    if (mid <= 0) {\n                        cc.logID(4003);\n                        break;\n                    }\n\n                    _fontSize = mid;\n                    _fontDesc = this._getFontDesc();\n                    _context.font = _fontDesc;\n\n                    totalHeight = 0;\n                    for (i = 0; i < paragraphedStrings.length; ++i) {\n                        let j = 0;\n                        let allWidth = textUtils.safeMeasureText(_context, paragraphedStrings[i], _fontDesc);\n                        textFragment = textUtils.fragmentText(paragraphedStrings[i],\n                                                            allWidth,\n                                                            canvasWidthNoMargin,\n                                                            this._measureText(_context, _fontDesc));\n                        while (j < textFragment.length) {\n                            maxLength = textUtils.safeMeasureText(_context, textFragment[j], _fontDesc);\n                            totalHeight += this._getLineHeight();\n                            ++j;\n                        }\n                    }\n\n                    if (totalHeight > canvasHeightNoMargin) {\n                        right = mid - 1;\n                    } else {\n                        left = mid;\n                    }\n                }\n\n                if (left === 0) {\n                    cc.logID(4003);\n                } else {\n                    _fontSize = left;\n                    _fontDesc = this._getFontDesc();\n                    _context.font = _fontDesc;\n                }\n            }\n            else {\n                totalHeight = paragraphedStrings.length * this._getLineHeight();\n\n                for (i = 0; i < paragraphedStrings.length; ++i) {\n                    if (maxLength < paragraphLength[i]) {\n                        maxLength = paragraphLength[i];\n                    }\n                }\n                let scaleX = (_canvasSize.width - _canvasPadding.width) / maxLength;\n                let scaleY = _canvasSize.height / totalHeight;\n\n                _fontSize = (_drawFontSize * Math.min(1, scaleX, scaleY)) | 0;\n                _fontDesc = this._getFontDesc();\n                _context.font = _fontDesc;\n            }\n        }\n    }\n}\n\n","const dynamicAtlasManager = require('./dynamic-atlas/manager');\nconst WHITE = cc.Color.WHITE;\n\n// share data of bmfont\nlet shareLabelInfo = {\n    fontAtlas: null,\n    \n    fontSize:0,\n    lineHeight:0,\n    hAlign:0,\n    vAlign:0,\n\n    hash:\"\",\n    fontFamily:\"\",\n    fontDesc:\"Arial\",\n    color:WHITE,\n    isOutlined:false,\n    out:WHITE,\n    margin:0,\n}\n\nmodule.exports = {\n\n    deleteFromDynamicAtlas (comp, frame) {\n        if (frame && !CC_TEST) {\n            if (frame._original && dynamicAtlasManager) {\n                dynamicAtlasManager.deleteAtlasSpriteFrame(frame);\n                frame._resetDynamicAtlasFrame();\n            }\n        }\n    },\n\n    getFontFamily (comp) {\n        if (!comp.useSystemFont) {\n            if (comp.font) {\n                if (comp.font._nativeAsset) return comp.font._nativeAsset;\n                cc.loader.load(comp.font.nativeUrl, (err, asset) => {\n                    comp.font._nativeAsset = asset;\n                    comp.setVertsDirty();\n                });\n                return 'Arial';\n            }\n    \n            return 'Arial';\n        }\n        else {\n            return comp.fontFamily || 'Arial';\n        }\n    },\n\n    shareLabelInfo: shareLabelInfo\n}\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n'use strict';\n\ncc.Graphics.earcut = module.exports = earcut;\n\nfunction earcut(data, holeIndices, dim) {\n\n    dim = dim || 2;\n\n    var hasHoles = holeIndices && holeIndices.length,\n        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\n        outerNode = linkedList(data, 0, outerLen, dim, true),\n        triangles = [];\n\n    if (!outerNode) return triangles;\n\n    var minX, minY, maxX, maxY, x, y, size;\n\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n    if (data.length > 80 * dim) {\n        minX = maxX = data[0];\n        minY = maxY = data[1];\n\n        for (var i = dim; i < outerLen; i += dim) {\n            x = data[i];\n            y = data[i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n        }\n\n        // minX, minY and size are later used to transform coords into integers for z-order calculation\n        size = Math.max(maxX - minX, maxY - minY);\n    }\n\n    earcutLinked(outerNode, triangles, dim, minX, minY, size);\n\n    return triangles;\n}\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList(data, start, end, dim, clockwise) {\n    var i, last;\n\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\n    } else {\n        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\n    }\n\n    if (last && equals(last, last.next)) {\n        removeNode(last);\n        last = last.next;\n    }\n\n    return last;\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints(start, end) {\n    if (!start) return start;\n    if (!end) end = start;\n\n    var p = start,\n        again;\n    do {\n        again = false;\n\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n            removeNode(p);\n            p = end = p.prev;\n            if (p === p.next) return null;\n            again = true;\n\n        } else {\n            p = p.next;\n        }\n    } while (again || p !== end);\n\n    return end;\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked(ear, triangles, dim, minX, minY, size, pass) {\n    if (!ear) return;\n\n    // interlink polygon nodes in z-order\n    if (!pass && size) indexCurve(ear, minX, minY, size);\n\n    var stop = ear,\n        prev, next;\n\n    // iterate through ears, slicing them one by one\n    while (ear.prev !== ear.next) {\n        prev = ear.prev;\n        next = ear.next;\n\n        if (size ? isEarHashed(ear, minX, minY, size) : isEar(ear)) {\n            // cut off the triangle\n            triangles.push(prev.i / dim);\n            triangles.push(ear.i / dim);\n            triangles.push(next.i / dim);\n\n            removeNode(ear);\n\n            // skipping the next vertice leads to less sliver triangles\n            ear = next.next;\n            stop = next.next;\n\n            continue;\n        }\n\n        ear = next;\n\n        // if we looped through the whole remaining polygon and can't find any more ears\n        if (ear === stop) {\n            // try filtering points and slicing again\n            if (!pass) {\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, size, 1);\n\n            // if this didn't work, try curing all small self-intersections locally\n            } else if (pass === 1) {\n                ear = cureLocalIntersections(ear, triangles, dim);\n                earcutLinked(ear, triangles, dim, minX, minY, size, 2);\n\n            // as a last resort, try splitting the remaining polygon into two\n            } else if (pass === 2) {\n                splitEarcut(ear, triangles, dim, minX, minY, size);\n            }\n\n            break;\n        }\n    }\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar(ear) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // now make sure we don't have other points inside the potential ear\n    var p = ear.next.next;\n\n    while (p !== ear.prev) {\n        if (pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.next;\n    }\n\n    return true;\n}\n\nfunction isEarHashed(ear, minX, minY, size) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // triangle bbox; min & max are calculated like this for speed\n    var minTX = a.x < b.x ? (a.x < c.x ? a.x : c.x) : (b.x < c.x ? b.x : c.x),\n        minTY = a.y < b.y ? (a.y < c.y ? a.y : c.y) : (b.y < c.y ? b.y : c.y),\n        maxTX = a.x > b.x ? (a.x > c.x ? a.x : c.x) : (b.x > c.x ? b.x : c.x),\n        maxTY = a.y > b.y ? (a.y > c.y ? a.y : c.y) : (b.y > c.y ? b.y : c.y);\n\n    // z-order range for the current triangle bbox;\n    var minZ = zOrder(minTX, minTY, minX, minY, size),\n        maxZ = zOrder(maxTX, maxTY, minX, minY, size);\n\n    // first look for points inside the triangle in increasing z-order\n    var p = ear.nextZ;\n\n    while (p && p.z <= maxZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.nextZ;\n    }\n\n    // then look for points in decreasing z-order\n    p = ear.prevZ;\n\n    while (p && p.z >= minZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n    }\n\n    return true;\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections(start, triangles, dim) {\n    var p = start;\n    do {\n        var a = p.prev,\n            b = p.next.next;\n\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\n            triangles.push(a.i / dim);\n            triangles.push(p.i / dim);\n            triangles.push(b.i / dim);\n\n            // remove two nodes involved\n            removeNode(p);\n            removeNode(p.next);\n\n            p = start = b;\n        }\n        p = p.next;\n    } while (p !== start);\n\n    return p;\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut(start, triangles, dim, minX, minY, size) {\n    // look for a valid diagonal that divides the polygon into two\n    var a = start;\n    do {\n        var b = a.next.next;\n        while (b !== a.prev) {\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\n                // split the polygon in two by the diagonal\n                var c = splitPolygon(a, b);\n\n                // filter colinear points around the cuts\n                a = filterPoints(a, a.next);\n                c = filterPoints(c, c.next);\n\n                // run earcut on each half\n                earcutLinked(a, triangles, dim, minX, minY, size);\n                earcutLinked(c, triangles, dim, minX, minY, size);\n                return;\n            }\n            b = b.next;\n        }\n        a = a.next;\n    } while (a !== start);\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n    var queue = [],\n        i, len, start, end, list;\n\n    for (i = 0, len = holeIndices.length; i < len; i++) {\n        start = holeIndices[i] * dim;\n        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n        list = linkedList(data, start, end, dim, false);\n        if (list === list.next) list.steiner = true;\n        queue.push(getLeftmost(list));\n    }\n\n    queue.sort(compareX);\n\n    // process holes from left to right\n    for (i = 0; i < queue.length; i++) {\n        eliminateHole(queue[i], outerNode);\n        outerNode = filterPoints(outerNode, outerNode.next);\n    }\n\n    return outerNode;\n}\n\nfunction compareX(a, b) {\n    return a.x - b.x;\n}\n\n// find a bridge between vertices that connects hole with an outer ring and and link it\nfunction eliminateHole(hole, outerNode) {\n    outerNode = findHoleBridge(hole, outerNode);\n    if (outerNode) {\n        var b = splitPolygon(outerNode, hole);\n        filterPoints(b, b.next);\n    }\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge(hole, outerNode) {\n    var p = outerNode,\n        hx = hole.x,\n        hy = hole.y,\n        qx = -Infinity,\n        m;\n\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\n    // segment's endpoint with lesser x will be potential connection point\n    do {\n        if (hy <= p.y && hy >= p.next.y) {\n            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n            if (x <= hx && x > qx) {\n                qx = x;\n                if (x === hx) {\n                    if (hy === p.y) return p;\n                    if (hy === p.next.y) return p.next;\n                }\n                m = p.x < p.next.x ? p : p.next;\n            }\n        }\n        p = p.next;\n    } while (p !== outerNode);\n\n    if (!m) return null;\n\n    if (hx === qx) return m.prev; // hole touches outer segment; pick lower endpoint\n\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\n    // if there are no points found, we have a valid connection;\n    // otherwise choose the point of the minimum angle with the ray as connection point\n\n    var stop = m,\n        mx = m.x,\n        my = m.y,\n        tanMin = Infinity,\n        tan;\n\n    p = m.next;\n\n    while (p !== stop) {\n        if (hx >= p.x && p.x >= mx &&\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\n            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\n            if ((tan < tanMin || (tan === tanMin && p.x > m.x)) && locallyInside(p, hole)) {\n                m = p;\n                tanMin = tan;\n            }\n        }\n\n        p = p.next;\n    }\n\n    return m;\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve(start, minX, minY, size) {\n    var p = start;\n    do {\n        if (p.z === null) p.z = zOrder(p.x, p.y, minX, minY, size);\n        p.prevZ = p.prev;\n        p.nextZ = p.next;\n        p = p.next;\n    } while (p !== start);\n\n    p.prevZ.nextZ = null;\n    p.prevZ = null;\n\n    sortLinked(p);\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked(list) {\n    var i, p, q, e, tail, numMerges, pSize, qSize,\n        inSize = 1;\n\n    do {\n        p = list;\n        list = null;\n        tail = null;\n        numMerges = 0;\n\n        while (p) {\n            numMerges++;\n            q = p;\n            pSize = 0;\n            for (i = 0; i < inSize; i++) {\n                pSize++;\n                q = q.nextZ;\n                if (!q) break;\n            }\n\n            qSize = inSize;\n\n            while (pSize > 0 || (qSize > 0 && q)) {\n\n                if (pSize === 0) {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                } else if (qSize === 0 || !q) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else if (p.z <= q.z) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                }\n\n                if (tail) tail.nextZ = e;\n                else list = e;\n\n                e.prevZ = tail;\n                tail = e;\n            }\n\n            p = q;\n        }\n\n        tail.nextZ = null;\n        inSize *= 2;\n\n    } while (numMerges > 1);\n\n    return list;\n}\n\n// z-order of a point given coords and size of the data bounding box\nfunction zOrder(x, y, minX, minY, size) {\n    // coords are transformed into non-negative 15-bit integer range\n    x = 32767 * (x - minX) / size;\n    y = 32767 * (y - minY) / size;\n\n    x = (x | (x << 8)) & 0x00FF00FF;\n    x = (x | (x << 4)) & 0x0F0F0F0F;\n    x = (x | (x << 2)) & 0x33333333;\n    x = (x | (x << 1)) & 0x55555555;\n\n    y = (y | (y << 8)) & 0x00FF00FF;\n    y = (y | (y << 4)) & 0x0F0F0F0F;\n    y = (y | (y << 2)) & 0x33333333;\n    y = (y | (y << 1)) & 0x55555555;\n\n    return x | (y << 1);\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost(start) {\n    var p = start,\n        leftmost = start;\n    do {\n        if (p.x < leftmost.x) leftmost = p;\n        p = p.next;\n    } while (p !== start);\n\n    return leftmost;\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n    return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 &&\n           (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 &&\n           (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal(a, b) {\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) &&\n           locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b);\n}\n\n// signed area of a triangle\nfunction area(p, q, r) {\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n}\n\n// check if two points are equal\nfunction equals(p1, p2) {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n// check if two segments intersect\nfunction intersects(p1, q1, p2, q2) {\n    if ((equals(p1, q1) && equals(p2, q2)) ||\n        (equals(p1, q2) && equals(p2, q1))) return true;\n    return area(p1, q1, p2) > 0 !== area(p1, q1, q2) > 0 &&\n           area(p2, q2, p1) > 0 !== area(p2, q2, q1) > 0;\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon(a, b) {\n    var p = a;\n    do {\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n                intersects(p, p.next, a, b)) return true;\n        p = p.next;\n    } while (p !== a);\n\n    return false;\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside(a, b) {\n    return area(a.prev, a, a.next) < 0 ?\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside(a, b) {\n    var p = a,\n        inside = false,\n        px = (a.x + b.x) / 2,\n        py = (a.y + b.y) / 2;\n    do {\n        if (((p.y > py) !== (p.next.y > py)) && (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n            inside = !inside;\n        p = p.next;\n    } while (p !== a);\n\n    return inside;\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon(a, b) {\n    var a2 = new Node(a.i, a.x, a.y),\n        b2 = new Node(b.i, b.x, b.y),\n        an = a.next,\n        bp = b.prev;\n\n    a.next = b;\n    b.prev = a;\n\n    a2.next = an;\n    an.prev = a2;\n\n    b2.next = a2;\n    a2.prev = b2;\n\n    bp.next = b2;\n    b2.prev = bp;\n\n    return b2;\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode(i, x, y, last) {\n    var p = new Node(i, x, y);\n\n    if (!last) {\n        p.prev = p;\n        p.next = p;\n\n    } else {\n        p.next = last.next;\n        p.prev = last;\n        last.next.prev = p;\n        last.next = p;\n    }\n    return p;\n}\n\nfunction removeNode(p) {\n    p.next.prev = p.prev;\n    p.prev.next = p.next;\n\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n}\n\nfunction Node(i, x, y) {\n    // vertice index in coordinates array\n    this.i = i;\n\n    // vertex coordinates\n    this.x = x;\n    this.y = y;\n\n    // previous and next vertice nodes in a polygon ring\n    this.prev = null;\n    this.next = null;\n\n    // z-order curve value\n    this.z = null;\n\n    // previous and next nodes in z-order\n    this.prevZ = null;\n    this.nextZ = null;\n\n    // indicates whether this is a steiner point\n    this.steiner = false;\n}\n\n// return a percentage difference between the polygon area and its triangulation area;\n// used to verify correctness of triangulation\nearcut.deviation = function (data, holeIndices, dim, triangles) {\n    var hasHoles = holeIndices && holeIndices.length;\n    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\n    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n    if (hasHoles) {\n        for (var i = 0, len = holeIndices.length; i < len; i++) {\n            var start = holeIndices[i] * dim;\n            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n        }\n    }\n\n    var trianglesArea = 0;\n    for (i = 0; i < triangles.length; i += 3) {\n        var a = triangles[i] * dim;\n        var b = triangles[i + 1] * dim;\n        var c = triangles[i + 2] * dim;\n        trianglesArea += Math.abs(\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n    }\n\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\n};\n\nfunction signedArea(data, start, end, dim) {\n    var sum = 0;\n    for (var i = start, j = end - dim; i < end; i += dim) {\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n        j = i;\n    }\n    return sum;\n}\n\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\nearcut.flatten = function (data) {\n    var dim = data[0][0].length,\n        result = {vertices: [], holes: [], dimensions: dim},\n        holeIndex = 0;\n\n    for (var i = 0; i < data.length; i++) {\n        for (var j = 0; j < data[i].length; j++) {\n            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\n        }\n        if (i > 0) {\n            holeIndex += data[i - 1].length;\n            result.holes.push(holeIndex);\n        }\n    }\n    return result;\n};","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst Helper = require('../../../../graphics/helper');\nconst PointFlags = require('../../../../graphics/types').PointFlags;\n\nlet Point = cc.Graphics.Point = cc.Class({\n    name: 'cc.GraphicsPoint',\n    extends: cc.Vec2,\n\n    ctor (x, y) {\n        this.reset();\n    },\n    \n    reset () {\n        this.dx = 0;\n        this.dy = 0;\n        this.dmx = 0;\n        this.dmy = 0;\n        this.flags = 0;\n        this.len = 0;\n    }\n});\n\nfunction Path () {\n    this.reset();\n}\n\ncc.js.mixin(Path.prototype, {\n    reset () {\n        this.closed = false;\n        this.nbevel = 0;\n        this.complex = true;\n\n        if (this.points) {\n            this.points.length = 0;\n        }\n        else {\n            this.points = [];\n        }\n    }\n});\n\nfunction Impl (graphics) {\n    // inner properties\n    this._tessTol = 0.25;\n    this._distTol = 0.01;\n    this._updatePathOffset = false;\n    \n    this._paths = null;\n    this._pathLength = 0;\n    this._pathOffset = 0;\n    \n    this._points = null;\n    this._pointsOffset = 0;\n    \n    this._commandx = 0;\n    this._commandy = 0;\n\n    this._paths = [];\n    this._points = [];\n}\n\ncc.js.mixin(Impl.prototype, {\n    moveTo (x, y) {\n        if (this._updatePathOffset) {\n            this._pathOffset = this._pathLength;\n            this._updatePathOffset = false;\n        }\n    \n        this._addPath();\n        this._addPoint(x, y, PointFlags.PT_CORNER);\n    \n        this._commandx = x;\n        this._commandy = y;\n    },\n\n    lineTo (x, y) {\n        this._addPoint(x, y, PointFlags.PT_CORNER);\n        \n        this._commandx = x;\n        this._commandy = y;\n    },\n\n    bezierCurveTo (c1x, c1y, c2x, c2y, x, y) {\n        var path = this._curPath;\n        var last = path.points[path.points.length - 1];\n    \n        if (last.x === c1x && last.y === c1y && c2x === x && c2y === y) {\n            this.lineTo(x, y);\n            return;\n        }\n    \n        Helper.tesselateBezier(this, last.x, last.y, c1x, c1y, c2x, c2y, x, y, 0, PointFlags.PT_CORNER);\n    \n        this._commandx = x;\n        this._commandy = y;\n    },\n\n    quadraticCurveTo (cx, cy, x, y) {\n        var x0 = this._commandx;\n        var y0 = this._commandy;\n        this.bezierCurveTo(x0 + 2.0 / 3.0 * (cx - x0), y0 + 2.0 / 3.0 * (cy - y0), x + 2.0 / 3.0 * (cx - x), y + 2.0 / 3.0 * (cy - y), x, y);\n    },\n\n    arc (cx, cy, r, startAngle, endAngle, counterclockwise) {\n        Helper.arc(this, cx, cy, r, startAngle, endAngle, counterclockwise);\n    },\n\n    ellipse (cx, cy, rx, ry) {\n        Helper.ellipse(this, cx, cy, rx, ry);\n        this._curPath.complex = false;\n    },\n\n    circle (cx, cy, r) {\n        Helper.ellipse(this, cx, cy, r, r);\n        this._curPath.complex = false;\n    },\n\n    rect (x, y, w, h) {\n        this.moveTo(x, y);\n        this.lineTo(x, y + h);\n        this.lineTo(x + w, y + h);\n        this.lineTo(x + w, y);\n        this.close();\n        this._curPath.complex = false;\n    },\n\n    roundRect (x, y, w, h, r) {\n        Helper.roundRect(this, x, y, w, h, r);\n        this._curPath.complex = false;\n    },\n\n    clear (clean) {\n        this._pathLength = 0;\n        this._pathOffset = 0;\n        this._pointsOffset = 0;\n      \n        this._curPath = null;\n\n        if (clean) {\n            this._paths.length = 0;\n            this._points.length = 0;\n        }\n    },\n\n    close () {\n        this._curPath.closed = true;\n    },\n\n    _addPath () {\n        var offset = this._pathLength;\n        var path = this._paths[offset];\n    \n        if (!path) {\n            path = new Path();\n    \n            this._paths.push(path);\n        } else {\n            path.reset();\n        }\n    \n        this._pathLength++;\n        this._curPath = path;\n    \n        return path;\n    },\n    \n    _addPoint (x, y, flags) {\n        var path = this._curPath;\n        if (!path) return;\n    \n        var pt;\n        var points = this._points;\n        var pathPoints = path.points;\n    \n        var offset = this._pointsOffset++;\n        pt = points[offset];\n    \n        if (!pt) {\n            pt = new Point(x, y);\n            points.push(pt);\n        } else {\n            pt.x = x;\n            pt.y = y;\n        }\n    \n        pt.flags = flags;\n        pathPoints.push(pt);\n    },\n\n});\n\ncc.Graphics._Impl = Impl;\nmodule.exports = Impl;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler from '../../../assembler';\n\nimport InputAssembler from '../../../../../renderer/core/input-assembler';\n\nconst MeshBuffer = require('../../mesh-buffer');\nconst vfmtPosColor = require('../../vertex-format').vfmtPosColor;\nconst renderer = require('../../../index');\n\nconst Graphics = require('../../../../graphics/graphics');\nconst PointFlags = require('../../../../graphics/types').PointFlags;\nconst LineJoin = Graphics.LineJoin;\nconst LineCap = Graphics.LineCap;\nconst Earcut = require('./earcut');\nconst Impl = require('./impl');\n\nconst MAX_VERTEX = 65535;\nconst MAX_INDICE = MAX_VERTEX * 2;\n\nconst PI      = Math.PI;\nconst min     = Math.min;\nconst max     = Math.max;\nconst ceil    = Math.ceil;\nconst acos    = Math.acos;\nconst cos     = Math.cos;\nconst sin     = Math.sin;\nconst atan2   = Math.atan2;\n\nfunction curveDivs (r, arc, tol) {\n    let da = acos(r / (r + tol)) * 2.0;\n    return max(2, ceil(arc / da));\n}\n\nfunction clamp (v, min, max) {\n    if (v < min) {\n        return min;\n    }\n    else if (v > max) {\n        return max;\n    }\n    return v;\n}\n\nexport default class GraphicsAssembler extends Assembler {\n    constructor (graphics) {\n        super(graphics);\n        \n        this._buffer = null;\n        this._buffers = [];\n        this._bufferOffset = 0;\n    }\n\n    getVfmt () {\n        return vfmtPosColor;\n    }\n\n    requestBuffer () {\n        let buffer = {\n            indiceStart: 0,\n            vertexStart: 0\n        };\n\n        let meshbuffer = new MeshBuffer(renderer._handle, vfmtPosColor);\n        buffer.meshbuffer = meshbuffer;\n\n        let ia = new InputAssembler(meshbuffer._vb, meshbuffer._ib);\n        buffer.ia = ia;\n\n        this._buffers.push(buffer);\n\n        return buffer;\n    }\n\n    getBuffers () {\n        if (this._buffers.length === 0) {\n            this.requestBuffer();\n        }\n\n        return this._buffers;\n    }\n\n    clear (clean) {\n        this._bufferOffset = 0;\n\n        let datas = this._buffers;\n        if (clean) {\n            for (let i = 0, l = datas.length; i < l; i++) {\n                let data = datas[i];\n                data.meshbuffer.destroy();\n                data.meshbuffer = null;\n            }\n            datas.length = 0;\n        }\n        else {\n            for (let i = 0, l = datas.length; i < l; i++) {\n                let data = datas[i];\n\n                data.indiceStart = 0;\n                data.vertexStart = 0;\n\n                let meshbuffer = data.meshbuffer;\n                meshbuffer.reset();\n            }\n        }\n    }\n\n    fillBuffers (graphics, renderer) {\n        renderer._flush();\n\n        renderer.node = graphics.node;\n        renderer.material = graphics._materials[0];\n\n        let buffers = this.getBuffers();\n        for (let index = 0, length = buffers.length; index < length; index++) {\n            let buffer = buffers[index];\n            let meshbuffer = buffer.meshbuffer;\n            buffer.ia._count = buffer.indiceStart;\n            renderer._flushIA(buffer.ia);\n            meshbuffer.uploadData();\n        }\n    }\n\n    genBuffer (graphics, cverts) {\n        let buffers = this.getBuffers(); \n        let buffer = buffers[this._bufferOffset];\n        let meshbuffer = buffer.meshbuffer;\n\n        let maxVertsCount = buffer.vertexStart + cverts;\n        if (maxVertsCount > MAX_VERTEX ||\n            maxVertsCount * 3 > MAX_INDICE) {\n            ++this._bufferOffset;\n            maxVertsCount = cverts;\n            \n            if (this._bufferOffset < buffers.length) {\n                buffer = buffers[this._bufferOffset];\n            }\n            else {\n                buffer = this.requestBuffer(graphics);\n                buffers[this._bufferOffset] = buffer;\n            }\n\n            meshbuffer = buffer.meshbuffer;\n        }\n\n        if (maxVertsCount > meshbuffer.vertexOffset) {\n            meshbuffer.requestStatic(cverts, cverts*3);\n        }\n\n        this._buffer = buffer;\n        return buffer;\n    }\n\n    stroke (graphics) {\n        this._curColor = graphics._strokeColor._val;\n\n        this._flattenPaths(graphics._impl);\n        this._expandStroke(graphics);\n    \n        graphics._impl._updatePathOffset = true;\n    }\n\n    fill (graphics) {\n        this._curColor = graphics._fillColor._val;\n\n        this._expandFill(graphics);\n        graphics._impl._updatePathOffset = true;\n    }\n\n    _expandStroke (graphics) {\n        let w = graphics.lineWidth * 0.5,\n            lineCap = graphics.lineCap,\n            lineJoin = graphics.lineJoin,\n            miterLimit = graphics.miterLimit;\n\n        let impl = graphics._impl;\n    \n        let ncap = curveDivs(w, PI, impl._tessTol);\n    \n        this._calculateJoins(impl, w, lineJoin, miterLimit);\n    \n        let paths = impl._paths;\n        \n        // Calculate max vertex usage.\n        let cverts = 0;\n        for (let i = impl._pathOffset, l = impl._pathLength; i < l; i++) {\n            let path = paths[i];\n            let pointsLength = path.points.length;\n\n            if (lineJoin === LineJoin.ROUND) cverts += (pointsLength + path.nbevel * (ncap + 2) + 1) * 2; // plus one for loop\n            else cverts += (pointsLength + path.nbevel * 5 + 1) * 2; // plus one for loop\n\n            if (!path.closed) {\n                // space for caps\n                if (lineCap === LineCap.ROUND) {\n                    cverts += (ncap * 2 + 2) * 2;\n                } else {\n                    cverts += (3 + 3) * 2;\n                }\n            }\n        }\n        \n        let buffer = this.genBuffer(graphics, cverts),\n            meshbuffer = buffer.meshbuffer,\n            vData = meshbuffer._vData,\n            iData = meshbuffer._iData;\n            \n        for (let i = impl._pathOffset, l = impl._pathLength; i < l; i++) {\n            let path = paths[i];\n            let pts = path.points;\n            let pointsLength = pts.length;\n            let offset = buffer.vertexStart;\n\n            let p0, p1;\n            let start, end, loop;\n            loop = path.closed;\n            if (loop) {\n                // Looping\n                p0 = pts[pointsLength - 1];\n                p1 = pts[0];\n                start = 0;\n                end = pointsLength;\n            } else {\n                // Add cap\n                p0 = pts[0];\n                p1 = pts[1];\n                start = 1;\n                end = pointsLength - 1;\n            }\n    \n            if (!loop) {\n                // Add cap\n                let dPos = p1.sub(p0);\n                dPos.normalizeSelf();\n    \n                let dx = dPos.x;\n                let dy = dPos.y;\n    \n                if (lineCap === LineCap.BUTT)\n                    this._buttCapStart(p0, dx, dy, w, 0);\n                else if (lineCap === LineCap.SQUARE)\n                    this._buttCapStart(p0, dx, dy, w, w);\n                else if (lineCap === LineCap.ROUND)\n                    this._roundCapStart(p0, dx, dy, w, ncap);\n            }\n    \n            for (let j = start; j < end; ++j) {\n                if (lineJoin === LineJoin.ROUND) {\n                    this._roundJoin(p0, p1, w, w, ncap);\n                }\n                else if ((p1.flags & (PointFlags.PT_BEVEL | PointFlags.PT_INNERBEVEL)) !== 0) {\n                    this._bevelJoin(p0, p1, w, w);\n                }\n                else {\n                    this._vset(p1.x + p1.dmx * w, p1.y + p1.dmy * w);\n                    this._vset(p1.x - p1.dmx * w, p1.y - p1.dmy * w);\n                }\n    \n                p0 = p1;\n                p1 = pts[j + 1];\n            }\n    \n            if (loop) {\n                // Loop it\n                let vDataoOfset = offset * 3;\n                this._vset(vData[vDataoOfset],   vData[vDataoOfset+1]);\n                this._vset(vData[vDataoOfset+3], vData[vDataoOfset+4]);\n            } else {\n                // Add cap\n                let dPos = p1.sub(p0);\n                dPos.normalizeSelf();\n    \n                let dx = dPos.x;\n                let dy = dPos.y;\n    \n                if (lineCap === LineCap.BUTT)\n                    this._buttCapEnd(p1, dx, dy, w, 0);\n                else if (lineCap === LineCap.SQUARE)\n                    this._buttCapEnd(p1, dx, dy, w, w);\n                else if (lineCap === LineCap.ROUND)\n                    this._roundCapEnd(p1, dx, dy, w, ncap);\n            }\n\n            // stroke indices\n            let indicesOffset = buffer.indiceStart;\n            for (let start = offset+2, end = buffer.vertexStart; start < end; start++) {\n                iData[indicesOffset++] = start - 2;\n                iData[indicesOffset++] = start - 1;\n                iData[indicesOffset++] = start;\n            }\n\n            buffer.indiceStart = indicesOffset;\n        }\n    }\n    \n    _expandFill (graphics) {\n        let impl = graphics._impl;\n\n        let paths = impl._paths;\n\n        // Calculate max vertex usage.\n        let cverts = 0;\n        for (let i = impl._pathOffset, l = impl._pathLength; i < l; i++) {\n            let path = paths[i];\n            let pointsLength = path.points.length;\n\n            cverts += pointsLength;\n        }\n\n        let buffer = this.genBuffer(graphics, cverts),\n            meshbuffer = buffer.meshbuffer,\n            vData = meshbuffer._vData,\n            iData = meshbuffer._iData;\n\n        for (let i = impl._pathOffset, l = impl._pathLength; i < l; i++) {\n            let path = paths[i];\n            let pts = path.points;\n            let pointsLength = pts.length;\n    \n            if (pointsLength === 0) {\n                continue;\n            }\n    \n            // Calculate shape vertices.\n            let offset = buffer.vertexStart;\n    \n            for (let j = 0; j < pointsLength; ++j) {\n                this._vset(pts[j].x, pts[j].y);\n            }\n    \n            let indicesOffset = buffer.indiceStart;\n    \n            if (path.complex) {\n                let earcutData = [];\n                for (let j = offset, end = buffer.vertexStart; j < end; j++) {\n                    let vDataOffset = j * 3;\n                    earcutData.push(vData[vDataOffset]);\n                    earcutData.push(vData[vDataOffset+1]);\n                }\n    \n                let newIndices = Earcut(earcutData, null, 2);\n    \n                if (!newIndices || newIndices.length === 0) {\n                    continue;\n                }\n    \n                for (let j = 0, nIndices = newIndices.length; j < nIndices; j++) {\n                    iData[indicesOffset++] = newIndices[j] + offset;\n                }\n            }\n            else {\n                let first = offset;\n                for (let start = offset+2, end = buffer.vertexStart; start < end; start++) {\n                    iData[indicesOffset++] = first;\n                    iData[indicesOffset++] = start - 1;\n                    iData[indicesOffset++] = start;\n                }\n            }\n\n            buffer.indiceStart = indicesOffset;\n        }\n    }\n\n    _calculateJoins (impl, w, lineJoin, miterLimit) {\n        let iw = 0.0;\n    \n        if (w > 0.0) {\n            iw = 1 / w;\n        }\n    \n        // Calculate which joins needs extra vertices to append, and gather vertex count.\n        let paths = impl._paths;\n        for (let i = impl._pathOffset, l = impl._pathLength; i < l; i++) {\n            let path = paths[i];\n    \n            let pts = path.points;\n            let ptsLength = pts.length;\n            let p0 = pts[ptsLength - 1];\n            let p1 = pts[0];\n            let nleft = 0;\n    \n            path.nbevel = 0;\n    \n            for (let j = 0; j < ptsLength; j++) {\n                let dmr2, cross, limit;\n    \n                // perp normals\n                let dlx0 = p0.dy;\n                let dly0 = -p0.dx;\n                let dlx1 = p1.dy;\n                let dly1 = -p1.dx;\n    \n                // Calculate extrusions\n                p1.dmx = (dlx0 + dlx1) * 0.5;\n                p1.dmy = (dly0 + dly1) * 0.5;\n                dmr2 = p1.dmx * p1.dmx + p1.dmy * p1.dmy;\n                if (dmr2 > 0.000001) {\n                    let scale = 1 / dmr2;\n                    if (scale > 600) {\n                        scale = 600;\n                    }\n                    p1.dmx *= scale;\n                    p1.dmy *= scale;\n                }\n    \n                // Keep track of left turns.\n                cross = p1.dx * p0.dy - p0.dx * p1.dy;\n                if (cross > 0) {\n                    nleft++;\n                    p1.flags |= PointFlags.PT_LEFT;\n                }\n    \n                // Calculate if we should use bevel or miter for inner join.\n                limit = max(11, min(p0.len, p1.len) * iw);\n                if (dmr2 * limit * limit < 1) {\n                    p1.flags |= PointFlags.PT_INNERBEVEL;\n                }\n    \n                // Check to see if the corner needs to be beveled.\n                if (p1.flags & PointFlags.PT_CORNER) {\n                    if (dmr2 * miterLimit * miterLimit < 1 || lineJoin === LineJoin.BEVEL || lineJoin === LineJoin.ROUND) {\n                        p1.flags |= PointFlags.PT_BEVEL;\n                    }\n                }\n    \n                if ((p1.flags & (PointFlags.PT_BEVEL | PointFlags.PT_INNERBEVEL)) !== 0) {\n                    path.nbevel++;\n                }\n    \n                p0 = p1;\n                p1 = pts[j + 1];\n            }\n        }\n    }\n    \n    _flattenPaths (impl) {\n        let paths = impl._paths;\n        for (let i = impl._pathOffset, l = impl._pathLength; i < l; i++) {\n            let path = paths[i];\n            let pts = path.points;\n    \n            let p0 = pts[pts.length - 1];\n            let p1 = pts[0];\n    \n            if (pts.length > 2 && p0.equals(p1)) {\n                path.closed = true;\n                pts.pop();\n                p0 = pts[pts.length - 1];\n            }\n    \n            for (let j = 0, size = pts.length; j < size; j++) {\n                // Calculate segment direction and length\n                let dPos = p1.sub(p0);\n                p0.len = dPos.mag();\n                if (dPos.x || dPos.y)\n                    dPos.normalizeSelf();\n                p0.dx = dPos.x;\n                p0.dy = dPos.y;\n                // Advance\n                p0 = p1;\n                p1 = pts[j + 1];\n            }\n        }\n    }\n\n    _chooseBevel (bevel, p0, p1, w) {\n        let x = p1.x;\n        let y = p1.y;\n        let x0, y0, x1, y1;\n    \n        if (bevel !== 0) {\n            x0 = x + p0.dy * w;\n            y0 = y - p0.dx * w;\n            x1 = x + p1.dy * w;\n            y1 = y - p1.dx * w;\n        } else {\n            x0 = x1 = x + p1.dmx * w;\n            y0 = y1 = y + p1.dmy * w;\n        }\n    \n        return [x0, y0, x1, y1];\n    }\n    \n    _buttCapStart (p, dx, dy, w, d) {\n        let px = p.x - dx * d;\n        let py = p.y - dy * d;\n        let dlx = dy;\n        let dly = -dx;\n    \n        this._vset(px + dlx * w, py + dly * w);\n        this._vset(px - dlx * w, py - dly * w);\n    }\n\n    _buttCapEnd (p, dx, dy, w, d) {\n        let px = p.x + dx * d;\n        let py = p.y + dy * d;\n        let dlx = dy;\n        let dly = -dx;\n    \n        this._vset(px + dlx * w, py + dly * w);\n        this._vset(px - dlx * w, py - dly * w);\n    }\n    \n    _roundCapStart (p, dx, dy, w, ncap) {\n        let px = p.x;\n        let py = p.y;\n        let dlx = dy;\n        let dly = -dx;\n    \n        for (let i = 0; i < ncap; i++) {\n            let a = i / (ncap - 1) * PI;\n            let ax = cos(a) * w,\n                ay = sin(a) * w;\n            this._vset(px - dlx * ax - dx * ay, py - dly * ax - dy * ay);\n            this._vset(px, py);\n        }\n        this._vset(px + dlx * w, py + dly * w);\n        this._vset(px - dlx * w, py - dly * w);\n    }\n    \n    _roundCapEnd (p, dx, dy, w, ncap) {\n        let px = p.x;\n        let py = p.y;\n        let dlx = dy;\n        let dly = -dx;\n    \n        this._vset(px + dlx * w, py + dly * w);\n        this._vset(px - dlx * w, py - dly * w);\n        for (let i = 0; i < ncap; i++) {\n            let a = i / (ncap - 1) * PI;\n            let ax = cos(a) * w,\n                ay = sin(a) * w;\n            this._vset(px, py);\n            this._vset(px - dlx * ax + dx * ay, py - dly * ax + dy * ay);\n        }\n    }\n    \n    _roundJoin (p0, p1, lw, rw, ncap) {\n        let dlx0 = p0.dy;\n        let dly0 = -p0.dx;\n        let dlx1 = p1.dy;\n        let dly1 = -p1.dx;\n    \n        let p1x = p1.x;\n        let p1y = p1.y;\n    \n        if ((p1.flags & PointFlags.PT_LEFT) !== 0) {\n            let out = this._chooseBevel(p1.flags & PointFlags.PT_INNERBEVEL, p0, p1, lw);\n            let lx0 = out[0];\n            let ly0 = out[1];\n            let lx1 = out[2];\n            let ly1 = out[3];\n    \n            let a0 = atan2(-dly0, -dlx0);\n            let a1 = atan2(-dly1, -dlx1);\n            if (a1 > a0) a1 -= PI * 2;\n    \n            this._vset(lx0, ly0);\n            this._vset(p1x - dlx0 * rw, p1.y - dly0 * rw);\n    \n            let n = clamp(ceil((a0 - a1) / PI) * ncap, 2, ncap);\n            for (let i = 0; i < n; i++) {\n                let u = i / (n - 1);\n                let a = a0 + u * (a1 - a0);\n                let rx = p1x + cos(a) * rw;\n                let ry = p1y + sin(a) * rw;\n                this._vset(p1x, p1y);\n                this._vset(rx, ry);\n            }\n    \n            this._vset(lx1, ly1);\n            this._vset(p1x - dlx1 * rw, p1y - dly1 * rw);\n        } else {\n            let out = this._chooseBevel(p1.flags & PointFlags.PT_INNERBEVEL, p0, p1, -rw);\n            let rx0 = out[0];\n            let ry0 = out[1];\n            let rx1 = out[2];\n            let ry1 = out[3];\n    \n            let a0 = atan2(dly0, dlx0);\n            let a1 = atan2(dly1, dlx1);\n            if (a1 < a0) a1 += PI * 2;\n    \n            this._vset(p1x + dlx0 * rw, p1y + dly0 * rw);\n            this._vset(rx0, ry0);\n    \n            let n = clamp(ceil((a1 - a0) / PI) * ncap, 2, ncap);\n            for (let i = 0; i < n; i++) {\n                let u = i / (n - 1);\n                let a = a0 + u * (a1 - a0);\n                let lx = p1x + cos(a) * lw;\n                let ly = p1y + sin(a) * lw;\n                this._vset(lx, ly);\n                this._vset(p1x, p1y);\n            }\n    \n            this._vset(p1x + dlx1 * rw, p1y + dly1 * rw);\n            this._vset(rx1, ry1);\n        }\n    }\n    \n    _bevelJoin (p0, p1, lw, rw) {\n        let rx0, ry0, rx1, ry1;\n        let lx0, ly0, lx1, ly1;\n        let dlx0 = p0.dy;\n        let dly0 = -p0.dx;\n        let dlx1 = p1.dy;\n        let dly1 = -p1.dx;\n    \n        if (p1.flags & PointFlags.PT_LEFT) {\n            let out = this._chooseBevel(p1.flags & PointFlags.PT_INNERBEVEL, p0, p1, lw);\n            lx0 = out[0];\n            ly0 = out[1];\n            lx1 = out[2];\n            ly1 = out[3];\n    \n            this._vset(lx0, ly0);\n            this._vset(p1.x - dlx0 * rw, p1.y - dly0 * rw);\n    \n            this._vset(lx1, ly1);\n            this._vset(p1.x - dlx1 * rw, p1.y - dly1 * rw);\n        } else {\n            let out = this._chooseBevel(p1.flags & PointFlags.PT_INNERBEVEL, p0, p1, -rw);\n            rx0 = out[0];\n            ry0 = out[1];\n            rx1 = out[2];\n            ry1 = out[3];\n    \n            this._vset(p1.x + dlx0 * lw, p1.y + dly0 * lw);\n            this._vset(rx0, ry0);\n    \n            this._vset(p1.x + dlx1 * lw, p1.y + dly1 * lw);\n            this._vset(rx1, ry1);\n        }\n    }\n    \n    _vset (x, y) {\n        let buffer = this._buffer;\n        let meshbuffer = buffer.meshbuffer;\n        let dataOffset = buffer.vertexStart * 3;\n\n        let vData = meshbuffer._vData;\n        let uintVData = meshbuffer._uintVData;\n\n        vData[dataOffset] = x;\n        vData[dataOffset+1] = y;\n        uintVData[dataOffset+2] = this._curColor;\n\n        buffer.vertexStart ++;\n        meshbuffer._dirty = true;\n    }\n}\n\nAssembler.register(cc.Graphics, GraphicsAssembler);\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\ncc.assemblers = {};\n \nrequire('./sprite');\nrequire('./mask-assembler');\nrequire('./graphics');\nrequire('./label');\nrequire('./motion-streak');\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport BmfontAssembler from '../../../../utils/label/bmfont';\n\nlet _dataOffset = 0;\n\nexport default class WebglBmfontAssembler extends BmfontAssembler {\n    initData () {\n        this._renderData.createFlexData(0, 4, 6, this.getVfmt());\n    }\n\n    _reserveQuads (comp, count) {\n        let verticesCount = count * 4;\n        let indicesCount = count * 6;\n        \n        let flexBuffer = this._renderData._flexBuffer;\n        flexBuffer.reserve(verticesCount, indicesCount);\n        flexBuffer.used(verticesCount, indicesCount);\n       \n        let iData = this._renderData.iDatas[0];\n\n        for (let i = 0, vid = 0, l = indicesCount; i < l; i += 6, vid += 4) {\n            iData[i] = vid;\n            iData[i + 1] = vid + 1;\n            iData[i + 2] = vid + 2;\n            iData[i + 3] = vid + 1;\n            iData[i + 4] = vid + 3;\n            iData[i + 5] = vid + 2;\n        }\n\n        _dataOffset = 0;\n    }\n\n    _quadsUpdated (comp) {\n        _dataOffset = 0;\n\n        let flexBuffer = this._renderData._flexBuffer;\n        flexBuffer.used(this.verticesCount, this.indicesCount);\n    }\n\n    _getColor (comp) {\n        return comp.node._color._val;\n    }\n\n    appendQuad (comp, texture, rect, rotated, x, y, scale) {\n        let renderData = this._renderData;\n        let verts = renderData.vDatas[0],\n            uintVerts = renderData.uintVDatas[0];\n\n        this.verticesCount += 4;\n        this.indicesCount = this.verticesCount / 2 * 3;\n\n        let texw = texture.width,\n            texh = texture.height,\n            rectWidth = rect.width,\n            rectHeight = rect.height,\n            color = this._getColor(comp);\n\n        let l, b, r, t;\n        let floatsPerVert = this.floatsPerVert;\n        // uvs\n        let uvDataOffset = _dataOffset + this.uvOffset;\n        if (!rotated) {\n            l = (rect.x) / texw;\n            r = (rect.x + rectWidth) / texw;\n            b = (rect.y + rectHeight) / texh;\n            t = (rect.y) / texh;\n\n            verts[uvDataOffset] = l;\n            verts[uvDataOffset + 1] = b;\n            uvDataOffset += floatsPerVert;\n            verts[uvDataOffset] = r;\n            verts[uvDataOffset + 1] = b;\n            uvDataOffset += floatsPerVert;\n            verts[uvDataOffset] = l;\n            verts[uvDataOffset + 1] = t;\n            uvDataOffset += floatsPerVert;\n            verts[uvDataOffset] = r;\n            verts[uvDataOffset + 1] = t;\n        } else {\n            l = (rect.x) / texw;\n            r = (rect.x + rectHeight) / texw;\n            b = (rect.y + rectWidth) / texh;\n            t = (rect.y) / texh;\n\n            verts[uvDataOffset] = l;\n            verts[uvDataOffset + 1] = t;\n            uvDataOffset += floatsPerVert;\n            verts[uvDataOffset] = l;\n            verts[uvDataOffset + 1] = b;\n            uvDataOffset += floatsPerVert;\n            verts[uvDataOffset] = r;\n            verts[uvDataOffset + 1] = t;\n            uvDataOffset += floatsPerVert;\n            verts[uvDataOffset] = r;\n            verts[uvDataOffset + 1] = b;\n        }\n\n\n        // positions\n        l = x;\n        r = x + rectWidth * scale;\n        b = y - rectHeight * scale;\n        t = y;\n\n        this.appendVerts(comp, _dataOffset, l, r, b, t);\n\n        // colors\n        let colorOffset = _dataOffset + this.colorOffset;\n        for (let i = 0; i < 4; i++) {\n            uintVerts[colorOffset] = color;\n            colorOffset += floatsPerVert;\n        }\n\n        _dataOffset += this.floatsPerVert * 4;\n    }\n\n    appendVerts (comp, offset, l, r, b, t) {\n        let local = this._local;\n        let floatsPerVert = this.floatsPerVert;\n\n        local[offset] = l;\n        local[offset + 1] = b;\n\n        offset += floatsPerVert;\n        local[offset] = r;\n        local[offset + 1] = b;\n\n        offset += floatsPerVert;\n        local[offset] = l;\n        local[offset + 1] = t;\n\n        offset += floatsPerVert;\n        local[offset] = r;\n        local[offset + 1] = t;\n    }\n\n    updateWorldVerts (comp) {\n        let node = comp.node;\n\n        let matrix = node._worldMatrix;\n        let matrixm = matrix.m,\n            a = matrixm[0], b = matrixm[1], c = matrixm[4], d = matrixm[5],\n            tx = matrixm[12], ty = matrixm[13];\n\n        let local = this._local;\n        let world = this._renderData.vDatas[0];\n        let floatsPerVert = this.floatsPerVert;\n        for (let offset = 0; offset < local.length; offset += floatsPerVert) {\n            let x = local[offset];\n            let y = local[offset + 1];\n            world[offset] = x * a + y * c + tx;\n            world[offset+1] = x * b + y * d + ty;\n        }\n    }\n}\n\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst js = require('../../../../../platform/js');\nconst WebglBmfontAssembler = require('./bmfont');\nconst LetterFontAssembler = require('../../../../utils/label/letter-font');\nconst WHITE = cc.color(255, 255, 255, 255);\n\nexport default class WebglLetterFontAssembler extends LetterFontAssembler {\n    createData (comp) {\n        return comp.requestRenderData();\n    }\n\n    _getColor (comp) {\n        WHITE._fastSetA(comp.node._color.a);\n        return WHITE._val;\n    }\n\n    updateColor (comp) {\n        let color = this._getColor(comp);\n\n        super.updateColor(comp, color);\n    }\n}\n\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport TTFAssembler from '../../../../utils/label/ttf';\n\nconst LabelShadow = require('../../../../../components/CCLabelShadow');\nconst WHITE = cc.color(255, 255, 255, 255);\n\nexport default class WebglTTFAssembler extends TTFAssembler {\n    updateUVs (comp) {\n        let verts = this._renderData.vDatas[0];\n        let uv = comp._frame.uv;\n        let uvOffset = this.uvOffset;\n        let floatsPerVert = this.floatsPerVert;\n        for (let i = 0; i < 4; i++) {\n            let srcOffset = i * 2;\n            let dstOffset = floatsPerVert * i + uvOffset;\n            verts[dstOffset] = uv[srcOffset];\n            verts[dstOffset + 1] = uv[srcOffset + 1];\n        }\n    }\n\n    updateColor (comp) {\n        WHITE._fastSetA(comp.node._color.a);\n        let color = WHITE._val;\n\n        super.updateColor(comp, color);\n    }\n\n    updateVerts (comp) {\n        let node = comp.node,\n            canvasWidth = comp._ttfTexture.width,\n            canvasHeight = comp._ttfTexture.height,\n            appx = node.anchorX * node.width,\n            appy = node.anchorY * node.height;\n\n        let shadow = LabelShadow && comp.getComponent(LabelShadow);\n        if (shadow && shadow._enabled) {\n            // adapt size changed caused by shadow\n            let offsetX = (canvasWidth - node.width) / 2;\n            let offsetY = (canvasHeight - node.height) / 2;\n\n            let shadowOffset = shadow.offset;\n            if (-shadowOffset.x > offsetX) {\n                // expand to left\n                appx += (canvasWidth - node.width);\n            }\n            else if (offsetX > shadowOffset.x) {\n                // expand to left and right\n                appx += (offsetX - shadowOffset.x);\n            }\n            else {\n                // expand to right, no need to change render position\n            }\n\n            if (-shadowOffset.y > offsetY) {\n                // expand to top\n                appy += (canvasHeight - node.height);\n            }\n            else if (offsetY > shadowOffset.y) {\n                // expand to top and bottom\n                appy += (offsetY - shadowOffset.y);\n            }\n            else {\n                // expand to bottom, no need to change render position\n            }\n        }\n\n        let local = this._local;\n        local[0] = -appx;\n        local[1] = -appy;\n        local[2] = canvasWidth - appx;\n        local[3] = canvasHeight - appy;\n\n        this.updateUVs(comp);\n        this.updateWorldVerts(comp);\n    }\n}\n\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler from '../../../assembler';\nimport Label from '../../../../components/CCLabel';\n\nimport TTF from './2d/ttf';\nimport Bmfont from './2d/bmfont';\nimport Letter from './2d/letter';\n\nimport TTF3D from './3d/ttf';\nimport Bmfont3D from './3d/bmfont';\nimport Letter3D from './3d/letter';\n\nLabel._canvasPool = {\n    pool: [],\n    get () {\n        let data = this.pool.pop();\n\n        if (!data) {\n            let canvas = document.createElement(\"canvas\");\n            let context = canvas.getContext(\"2d\");\n            data = {\n                canvas: canvas,\n                context: context\n            }\n        }\n\n        return data;\n    },\n    put (canvas) {\n        if (this.pool.length >= 32) {\n            return;\n        }\n        this.pool.push(canvas);\n    }\n};\n\nAssembler.register(cc.Label, {\n    getConstructor(label) {\n        let is3DNode = label.node.is3DNode;\n        let ctor = is3DNode ? TTF3D : TTF;\n        \n        if (label.font instanceof cc.BitmapFont) {\n            ctor = is3DNode ? Bmfont3D : Bmfont;\n        } else if (label.cacheMode === Label.CacheMode.CHAR) {\n            if (cc.sys.browserType === cc.sys.BROWSER_TYPE_WECHAT_GAME_SUB) {\n                cc.warn('sorry, subdomain does not support CHAR mode currently!');\n            } else {\n                ctor = is3DNode ? Letter3D : Letter;\n            }  \n        }\n\n        return ctor;\n    },\n\n    TTF,\n    Bmfont,\n    Letter,\n\n    TTF3D,\n    Bmfont3D,\n    Letter3D\n});\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler from '../../assembler';\n\nconst Mask = require('../../../components/CCMask');\nconst RenderFlow = require('../../render-flow');\nconst SimpleSpriteAssembler = require('./sprite/2d/simple');\nconst GraphicsAssembler = require('./graphics');\nconst gfx = require('../../../../renderer/gfx');\nconst vfmtPos = require('../vertex-format').vfmtPos;\n\n// todo: 8 is least Stencil depth supported by webGL device, it could be adjusted to vendor implementation value\nlet _maxLevel = 8;\n// Current mask\nlet _maskStack = [];\n\nfunction getWriteMask () {\n    return 0x01 << (_maskStack.length - 1);\n}\n\nfunction getStencilRef () {\n    let result = 0;\n    for (let i = 0; i < _maskStack.length; ++i) {\n        result += (0x01 << i);\n    }\n    return result;\n}\n\nfunction applyStencil (material, func, failOp, ref, stencilMask, writeMask) {\n    let effect = material.effect;\n    let zFailOp = gfx.STENCIL_OP_KEEP,\n        zPassOp = gfx.STENCIL_OP_KEEP;\n    effect.setStencil(gfx.STENCIL_ENABLE, func, ref, stencilMask, failOp, zFailOp, zPassOp, writeMask);\n}\n\n\nfunction pushMask (mask) {\n    if (_maskStack.length + 1 > _maxLevel) {\n        cc.errorID(9000, _maxLevel);\n    }\n    _maskStack.push(mask);\n}\n\nfunction exitMask (mask, renderer) {\n    if (_maskStack.length === 0) {\n        cc.errorID(9001);\n    }\n    _maskStack.pop();\n    if (_maskStack.length === 0) {\n        renderer._flushMaterial(mask._exitMaterial);\n    }\n    else {\n        enableMask(renderer);\n    }\n}\n\nfunction applyClearMask (mask, renderer) {\n    let func = gfx.DS_FUNC_NEVER;\n    let ref = getWriteMask();\n    let stencilMask = ref;\n    let writeMask = ref;\n    let failOp = mask.inverted ? gfx.STENCIL_OP_REPLACE : gfx.STENCIL_OP_ZERO;\n\n    applyStencil(mask._clearMaterial, func, failOp, ref, stencilMask, writeMask);\n\n    let buffer = renderer.getBuffer('mesh', vfmtPos);\n    let offsetInfo = buffer.request(4, 6);\n    let indiceOffset = offsetInfo.indiceOffset,\n        vertexOffset = offsetInfo.byteOffset >> 2,\n        vertexId = offsetInfo.vertexOffset,\n        vbuf = buffer._vData,\n        ibuf = buffer._iData;\n    \n    vbuf[vertexOffset++] = -1;\n    vbuf[vertexOffset++] = -1;\n    vbuf[vertexOffset++] = -1;\n    vbuf[vertexOffset++] = 1;\n    vbuf[vertexOffset++] = 1;\n    vbuf[vertexOffset++] = 1;\n    vbuf[vertexOffset++] = 1;\n    vbuf[vertexOffset++] = -1;\n\n    ibuf[indiceOffset++] = vertexId;\n    ibuf[indiceOffset++] = vertexId + 3;\n    ibuf[indiceOffset++] = vertexId + 1;\n    ibuf[indiceOffset++] = vertexId + 1;\n    ibuf[indiceOffset++] = vertexId + 3;\n    ibuf[indiceOffset++] = vertexId + 2;\n\n    renderer.node = renderer._dummyNode;\n    renderer.material = mask._clearMaterial;\n    renderer._flush();\n}\n\nfunction applyAreaMask (mask, renderer) {\n    let func = gfx.DS_FUNC_NEVER;\n    let ref = getWriteMask();\n    let stencilMask = ref;\n    let writeMask = ref;\n    let failOp = mask.inverted ? gfx.STENCIL_OP_ZERO : gfx.STENCIL_OP_REPLACE;\n\n    applyStencil(mask._materials[0], func, failOp, ref, stencilMask, writeMask);\n\n    // vertex buffer\n    renderer.material = mask._materials[0];\n\n    if (mask._type === Mask.Type.IMAGE_STENCIL) {\n        renderer.node = renderer._dummyNode;\n        SimpleSpriteAssembler.prototype.fillBuffers.call(mask._assembler, mask, renderer);\n        renderer._flush();\n    }\n    else {\n        renderer.node = mask.node;\n        GraphicsAssembler.prototype.fillBuffers.call(mask._graphics._assembler, mask._graphics, renderer);\n    }\n}\n\nfunction enableMask (renderer) {\n    let func = gfx.DS_FUNC_EQUAL;\n    let failOp = gfx.STENCIL_OP_KEEP;\n    let ref = getStencilRef();\n    let stencilMask = ref;\n    let writeMask = getWriteMask();\n    \n    let mask = _maskStack[_maskStack.length - 1];\n    applyStencil(mask._enableMaterial, func, failOp, ref, stencilMask, writeMask);\n    renderer._flushMaterial(mask._enableMaterial);\n}\n\nexport class MaskAssembler  extends SimpleSpriteAssembler {\n    updateRenderData (mask) {\n        if (mask._type === Mask.Type.IMAGE_STENCIL) {\n            if (mask.spriteFrame) {\n                SimpleSpriteAssembler.prototype.updateRenderData.call(this, mask);\n            }\n            else {\n                mask.setMaterial(0, null);\n            }\n        }\n        else {\n            mask._graphics.setMaterial(0, mask._materials[0]);\n            GraphicsAssembler.prototype.updateRenderData.call(mask._graphics._assembler, mask._graphics, mask._graphics);\n        }\n    }\n\n    fillBuffers (mask, renderer) {\n        // Invalid state\n        if (mask._type !== Mask.Type.IMAGE_STENCIL || mask.spriteFrame) {\n            // HACK: Must push mask after batch, so we can only put this logic in fillVertexBuffer or fillIndexBuffer\n            pushMask(mask);\n\n            applyClearMask(mask, renderer);\n            applyAreaMask(mask, renderer);\n\n            enableMask(renderer);\n        }\n\n        mask.node._renderFlag |= RenderFlow.FLAG_UPDATE_RENDER_DATA;\n    }\n\n    postFillBuffers (mask, renderer) {\n        // Invalid state\n        if (mask._type !== Mask.Type.IMAGE_STENCIL || mask.spriteFrame) {\n            // HACK: Must pop mask after batch, so we can only put this logic in fillBuffers\n            exitMask(mask, renderer);\n        }\n\n        mask.node._renderFlag |= RenderFlow.FLAG_UPDATE_RENDER_DATA;\n    }\n};\n\nAssembler.register(Mask, MaskAssembler);\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler2D from '../../assembler-2d';\n\nconst MotionStreak = require('../../../components/CCMotionStreak');\nconst RenderFlow = require('../../render-flow');\n\nfunction Point (point, dir) {\n    this.point = point || cc.v2();\n    this.dir = dir || cc.v2();\n    this.distance = 0;\n    this.time = 0;\n}\n\nPoint.prototype.setPoint = function (x, y) {\n    this.point.x = x;\n    this.point.y = y;\n};\n\nPoint.prototype.setDir = function (x, y) {\n    this.dir.x = x;\n    this.dir.y = y;\n};\n\nlet _tangent = cc.v2();\nlet _miter = cc.v2();\nlet _normal = cc.v2();\nlet _vec2 = cc.v2();\n\nfunction normal (out, dir) {\n    //get perpendicular\n    out.x = -dir.y;\n    out.y = dir.x;\n    return out\n}\n\nfunction computeMiter (miter, lineA, lineB, halfThick, maxMultiple) {\n    //get tangent line\n    lineA.add(lineB, _tangent);\n    _tangent.normalizeSelf();\n\n    //get miter as a unit vector\n    miter.x = -_tangent.y;\n    miter.y = _tangent.x;\n    _vec2.x = -lineA.y; \n    _vec2.y = lineA.x;\n\n    //get the necessary length of our miter\n    let multiple = 1 / miter.dot(_vec2);\n    if (maxMultiple) {\n        multiple = Math.min(multiple, maxMultiple);\n    }\n    return halfThick * multiple;\n}\n\nexport default class MotionStreakAssembler extends Assembler2D {\n    initData () {\n        this._renderData.createFlexData(0, 16, (16 - 2) * 3);\n    }\n\n    update (comp, dt) {\n        if (CC_EDITOR && !comp.preview) return;\n\n        let stroke = comp._stroke / 2;\n\n        let node = comp.node;\n        let matrix = node._worldMatrix.m;\n        let tx = matrix[12], ty = matrix[13];\n\n        let points = comp._points;\n\n        let cur;\n        if (points.length > 1) {\n            let difx = points[0].point.x - tx;\n            let dify = points[0].point.y - ty;\n            if ((difx*difx + dify*dify) < comp.minSeg) {\n                cur = points[0];\n            }\n        }\n\n        if (!cur) {\n            cur = new Point();\n            points.splice(0, 0, cur);\n        }\n\n        cur.setPoint(tx, ty);\n        cur.time = comp._fadeTime + dt;\n        \n        let verticesCount = 0;\n        let indicesCount = 0;\n\n        if (points.length < 2) {\n            return;\n        }\n\n        let color = comp._color,\n            cr = color.r, cg = color.g, cb = color.b, ca = color.a;\n\n        let prev = points[1];\n        prev.distance = cur.point.sub(prev.point, _vec2).mag();\n        _vec2.normalizeSelf();\n        prev.setDir(_vec2.x, _vec2.y);\n        cur.setDir(_vec2.x, _vec2.y);\n\n        let flexBuffer = this._renderData._flexBuffer;\n        flexBuffer.reserve(points.length*2, (points.length-1)*6);\n        let vData = flexBuffer.vData;\n        let uintVData = flexBuffer.uintVData;\n        let vertsOffset = 5;\n\n        let fadeTime = comp._fadeTime;\n        let findLast = false;\n        for (let i = points.length - 1; i >=0 ; i--) {\n            let p = points[i];\n            let point = p.point;\n            let dir = p.dir;\n            p.time -= dt;\n            \n            if (p.time < 0) {\n                points.splice(i, 1);\n                continue;\n            }\n\n            let progress = p.time / fadeTime;\n\n            let next = points[i - 1];\n            if (!findLast) {\n                if (!next) {\n                    points.splice(i, 1);\n                    continue;\n                }\n                \n                point.x = next.point.x - dir.x * progress;\n                point.y = next.point.y - dir.y * progress;\n            }\n            findLast = true;\n\n            normal(_normal, dir);\n\n            \n            let da = progress*ca;\n            let c = ((da<<24) >>> 0) + (cb<<16) + (cg<<8) + cr;\n\n            let offset = verticesCount * vertsOffset;\n\n            vData[offset] = point.x + _normal.x * stroke;\n            vData[offset + 1] = point.y + _normal.y * stroke;\n            vData[offset + 2] = 1;\n            vData[offset + 3] = progress;\n            uintVData[offset + 4] = c;\n            \n            offset += vertsOffset;\n\n            vData[offset] = point.x - _normal.x * stroke;\n            vData[offset + 1] = point.y - _normal.y * stroke;\n            vData[offset + 2] = 0;\n            vData[offset + 3] = progress;\n            uintVData[offset + 4] = c;\n            \n            verticesCount += 2;\n        }\n\n        indicesCount = verticesCount <= 2 ? 0 : (verticesCount - 2)*3;\n\n        flexBuffer.used(verticesCount, indicesCount);\n    }\n\n    fillBuffers (comp, renderer) {\n        let { vData, usedVertices, usedIndices, usedVerticesFloats } = this._renderData._flexBuffer;\n\n        let buffer = renderer._meshBuffer;\n        let offsetInfo = buffer.request(usedVertices, usedIndices);\n\n        // buffer data may be realloc, need get reference after request.\n\n        // fill vertices\n        let vertexOffset = offsetInfo.byteOffset >> 2,\n            vbuf = buffer._vData;\n\n        if (vData.length + vertexOffset > vbuf.length) {\n            vbuf.set(vData.subarray(0, usedVerticesFloats), vertexOffset);\n        }\n        else {\n            vbuf.set(vData, vertexOffset);\n        }\n\n        // fill indices\n        let ibuf = buffer._iData,\n            indiceOffset = offsetInfo.indiceOffset,\n            vertexId = offsetInfo.vertexOffset;\n\n        // index buffer\n        for (let i = 0, l = usedVertices; i < l; i += 2) {\n            let start = vertexId + i;\n            ibuf[indiceOffset++] = start;\n            ibuf[indiceOffset++] = start + 2;\n            ibuf[indiceOffset++] = start + 1;\n            ibuf[indiceOffset++] = start + 1;\n            ibuf[indiceOffset++] = start + 2;\n            ibuf[indiceOffset++] = start + 3;\n        }\n\n        comp.node._renderFlag |= RenderFlow.FLAG_UPDATE_RENDER_DATA;\n    }\n}\n\nMotionStreakAssembler.register(MotionStreak, MotionStreakAssembler);\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler2D from '../../../../assembler-2d';\n\nconst Sprite = require('../../../../../components/CCSprite');\nconst FillType = Sprite.FillType;\n\nexport default class BarFilledAssembler extends Assembler2D {\n    updateRenderData (sprite) {\n        let frame = sprite._spriteFrame;\n        this.packToDynamicAtlas(sprite, frame);\n\n        if (!sprite._vertsDirty) {\n            return;\n        }\n\n        let fillStart = sprite._fillStart;\n        let fillRange = sprite._fillRange;\n\n        if (fillRange < 0) {\n            fillStart += fillRange;\n            fillRange = -fillRange;\n        }\n\n        fillRange = fillStart + fillRange;\n\n        fillStart = fillStart > 1.0 ? 1.0 : fillStart;\n        fillStart = fillStart < 0.0 ? 0.0 : fillStart;\n\n        fillRange = fillRange > 1.0 ? 1.0 : fillRange;\n        fillRange = fillRange < 0.0 ? 0.0 : fillRange;\n        fillRange = fillRange - fillStart;\n        fillRange = fillRange < 0 ? 0 : fillRange;\n\n        let fillEnd = fillStart + fillRange;\n        fillEnd = fillEnd > 1 ? 1 : fillEnd;\n\n        this.updateUVs(sprite, fillStart, fillEnd);\n        this.updateVerts(sprite, fillStart, fillEnd);\n\n        sprite._vertsDirty = false;\n    }\n\n    updateUVs (sprite, fillStart, fillEnd) {\n        let spriteFrame = sprite._spriteFrame;\n\n        //build uvs\n        let atlasWidth = spriteFrame._texture.width;\n        let atlasHeight = spriteFrame._texture.height;\n        let textureRect = spriteFrame._rect;\n        //uv computation should take spritesheet into account.\n        let ul, vb, ur, vt;\n        let quadUV0, quadUV1, quadUV2, quadUV3, quadUV4, quadUV5, quadUV6, quadUV7;\n        if (spriteFrame._rotated) {\n            ul = (textureRect.x) / atlasWidth;\n            vb = (textureRect.y + textureRect.width) / atlasHeight;\n            ur = (textureRect.x + textureRect.height) / atlasWidth;\n            vt = (textureRect.y) / atlasHeight;\n\n            quadUV0 = quadUV2 = ul;\n            quadUV4 = quadUV6 = ur;\n            quadUV3 = quadUV7 = vb;\n            quadUV1 = quadUV5 = vt;\n        }\n        else {\n            ul = (textureRect.x) / atlasWidth;\n            vb = (textureRect.y + textureRect.height) / atlasHeight;\n            ur = (textureRect.x + textureRect.width) / atlasWidth;\n            vt = (textureRect.y) / atlasHeight;\n\n            quadUV0 = quadUV4 = ul;\n            quadUV2 = quadUV6 = ur;\n            quadUV1 = quadUV3 = vb;\n            quadUV5 = quadUV7 = vt;\n        }\n\n        let verts = this._renderData.vDatas[0];\n        let uvOffset = this.uvOffset;\n        let floatsPerVert = this.floatsPerVert;\n        switch (sprite._fillType) {\n            case FillType.HORIZONTAL:\n                verts[uvOffset] = quadUV0 + (quadUV2 - quadUV0) * fillStart;\n                verts[uvOffset + 1] = quadUV1 + (quadUV3 - quadUV1) * fillStart;\n                verts[uvOffset + floatsPerVert] = quadUV0 + (quadUV2 - quadUV0) * fillEnd;\n                verts[uvOffset + floatsPerVert + 1] = quadUV1 + (quadUV3 - quadUV1) * fillEnd;\n                verts[uvOffset + floatsPerVert * 2] = quadUV4 + (quadUV6 - quadUV4) * fillStart;\n                verts[uvOffset + floatsPerVert * 2 + 1] = quadUV5 + (quadUV7 - quadUV5) * fillStart;\n                verts[uvOffset + floatsPerVert * 3] = quadUV4 + (quadUV6 - quadUV4) * fillEnd;\n                verts[uvOffset + floatsPerVert * 3 + 1] = quadUV5 + (quadUV7 - quadUV5) * fillEnd;\n                break;\n            case FillType.VERTICAL:\n                verts[uvOffset] = quadUV0 + (quadUV4 - quadUV0) * fillStart;\n                verts[uvOffset + 1] = quadUV1 + (quadUV5 - quadUV1) * fillStart;\n                verts[uvOffset + floatsPerVert] = quadUV2 + (quadUV6 - quadUV2) * fillStart;\n                verts[uvOffset + floatsPerVert + 1] = quadUV3 + (quadUV7 - quadUV3) * fillStart;\n                verts[uvOffset + floatsPerVert * 2] = quadUV0 + (quadUV4 - quadUV0) * fillEnd;\n                verts[uvOffset + floatsPerVert * 2 + 1] = quadUV1 + (quadUV5 - quadUV1) * fillEnd;\n                verts[uvOffset + floatsPerVert * 3] = quadUV2 + (quadUV6 - quadUV2) * fillEnd;\n                verts[uvOffset + floatsPerVert * 3 + 1] = quadUV3 + (quadUV7 - quadUV3) * fillEnd;\n                break;\n            default:\n                cc.errorID(2626);\n                break;\n        }\n    }\n\n    updateVerts (sprite, fillStart, fillEnd) {\n        let node = sprite.node,\n            width = node.width, height = node.height,\n            appx = node.anchorX * width, appy = node.anchorY * height;\n\n        let l = -appx, b = -appy,\n            r = width - appx, t = height - appy;\n\n        let progressStart, progressEnd;\n        switch (sprite._fillType) {\n            case FillType.HORIZONTAL:\n                progressStart = l + (r - l) * fillStart;\n                progressEnd = l + (r - l) * fillEnd;\n\n                l = progressStart;\n                r = progressEnd;\n                break;\n            case FillType.VERTICAL:\n                progressStart = b + (t - b) * fillStart;\n                progressEnd = b + (t - b) * fillEnd;\n\n                b = progressStart;\n                t = progressEnd;\n                break;\n            default:\n                cc.errorID(2626);\n                break;\n        }\n\n        let local = this._local;\n        local[0] = l;\n        local[1] = b;\n        local[2] = r;\n        local[3] = t;\n\n        this.updateWorldVerts(sprite);\n    }\n}\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler2D from '../../../../assembler-2d';\n\nexport default class MeshSpriteAssembler extends Assembler2D {\n    initData (sprite) {\n        this._renderData.createFlexData(0, 4, 6, this.getVfmt());\n    }\n    \n    updateRenderData (sprite) {\n        this.packToDynamicAtlas(sprite, sprite._spriteFrame);\n\n        let frame = sprite.spriteFrame;\n        if (frame) {\n            let vertices = frame.vertices;\n            if (vertices) {\n                this.verticesCount = vertices.x.length;\n                this.indicesCount = vertices.triangles.length;\n\n                let renderData = this._renderData;\n                let flexBuffer = renderData._flexBuffer;\n                if (flexBuffer.reserve(this.verticesCount, this.indicesCount)) {\n                    this.updateColor(sprite);\n                    sprite._vertsDirty = true;\n                }\n                flexBuffer.used(this.verticesCount, this.indicesCount);\n\n                this.updateIndices(vertices.triangles);\n\n                if (sprite._vertsDirty) {\n                    this.updateUVs(sprite);\n                    this.updateVerts(sprite);\n                    this.updateWorldVerts(sprite);\n                    sprite._vertsDirty = false;\n                }\n            }\n        }\n    }\n\n    updateIndices (triangles) {\n        this._renderData.iDatas[0].set(triangles);\n    }\n\n    updateUVs (sprite) {\n        let vertices = sprite.spriteFrame.vertices,\n            u = vertices.nu,\n            v = vertices.nv;\n\n        let uvOffset = this.uvOffset;\n        let floatsPerVert = this.floatsPerVert;\n        let verts = this._renderData.vDatas[0];\n        for (let i = 0; i < u.length; i++) {\n            let dstOffset = floatsPerVert * i + uvOffset;\n            verts[dstOffset] = u[i];\n            verts[dstOffset + 1] = v[i];\n        }\n    }\n\n    updateVerts (sprite) {\n        let node = sprite.node,\n            contentWidth = Math.abs(node.width),\n            contentHeight = Math.abs(node.height),\n            appx = node.anchorX * contentWidth,\n            appy = node.anchorY * contentHeight;\n\n        let frame = sprite.spriteFrame,\n            vertices = frame.vertices,\n            x = vertices.x,\n            y = vertices.y,\n            originalWidth = frame._originalSize.width,\n            originalHeight = frame._originalSize.height,\n            rectWidth = frame._rect.width,\n            rectHeight = frame._rect.height,\n            offsetX = frame._offset.x,\n            offsetY = frame._offset.y,\n            trimX = offsetX + (originalWidth - rectWidth) / 2,\n            trimY = offsetY + (originalHeight - rectHeight) / 2;\n\n        let scaleX = contentWidth / (sprite.trim ? rectWidth : originalWidth),\n            scaleY = contentHeight / (sprite.trim ? rectHeight : originalHeight);\n\n        let local = this._local;\n        if (!sprite.trim) {\n            for (let i = 0, l = x.length; i < l; i++) {\n                let offset = i * 2;\n                local[offset] = (x[i]) * scaleX - appx;\n                local[offset + 1] = (originalHeight - y[i]) * scaleY - appy;\n            }\n        }\n        else {\n            for (let i = 0, l = x.length; i < l; i++) {\n                let offset = i * 2;\n                local[offset] = (x[i] - trimX) * scaleX - appx;\n                local[offset + 1] = (originalHeight - y[i] - trimY) * scaleY - appy;\n            }\n        }\n    }\n\n    updateWorldVerts (sprite) {\n        let node = sprite.node;\n        let matrix = node._worldMatrix;\n        let matrixm = matrix.m;\n        let a = matrixm[0], b = matrixm[1], c = matrixm[4], d = matrixm[5],\n            tx = matrixm[12], ty = matrixm[13];\n        let local = this._local;\n        let world = this._renderData.vDatas[0];\n        let floatsPerVert = this.floatsPerVert;\n        for (let i = 0, l = this.verticesCount; i < l; i++) {\n            let lx = local[i*2];\n            let ly = local[i*2 + 1];\n            world[floatsPerVert * i] = lx * a + ly * c + tx;\n            world[floatsPerVert * i + 1] = lx * b + ly * d + ty;\n        }\n    }\n}\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler2D from '../../../../assembler-2d';\n\nconst PI_2 = Math.PI * 2;\n\nlet _vertPos = [cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0)];\nlet _vertices = [0, 0, 0, 0];\nlet _uvs = [0, 0, 0, 0, 0, 0, 0, 0];\nlet _intersectPoint_1 = [cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0)];\nlet _intersectPoint_2 = [cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0)];\nlet _center = cc.v2(0, 0);\nlet _triangles = [];\n\nfunction _calcInsectedPoints (left, right, bottom, top, center, angle, intersectPoints) {\n    //left bottom, right, top\n    let sinAngle = Math.sin(angle);\n    let cosAngle = Math.cos(angle);\n    let tanAngle, cotAngle;\n    if (Math.cos(angle) !== 0) {\n        tanAngle = sinAngle / cosAngle;\n        //calculate right and left\n        if ((left - center.x) * cosAngle > 0) {\n            let yleft = center.y + tanAngle * (left - center.x);\n            intersectPoints[0].x = left;\n            intersectPoints[0].y = yleft;\n        }\n        if ((right - center.x) * cosAngle > 0) {\n            let yright = center.y + tanAngle * (right - center.x);\n\n            intersectPoints[2].x = right;\n            intersectPoints[2].y = yright;\n        }\n\n    }\n\n    if (Math.sin(angle) !== 0) {\n        cotAngle = cosAngle / sinAngle;\n        //calculate  top and bottom\n        if ((top - center.y) * sinAngle > 0) {\n            let xtop = center.x + cotAngle * (top - center.y);\n            intersectPoints[3].x = xtop;\n            intersectPoints[3].y = top;\n        }\n        if ((bottom - center.y) * sinAngle > 0) {\n            let xbottom = center.x + cotAngle * (bottom - center.y);\n            intersectPoints[1].x = xbottom;\n            intersectPoints[1].y = bottom;\n        }\n\n    }\n}\n\nfunction _calculateVertices (sprite) {\n    let node = sprite.node,\n        width = node.width, height = node.height,\n        appx = node.anchorX * width, appy = node.anchorY * height;\n\n    let l = -appx, b = -appy,\n        r = width - appx, t = height - appy;\n\n    let vertices = _vertices;\n    vertices[0] = l;\n    vertices[1] = b;\n    vertices[2] = r;\n    vertices[3] = t;\n\n    let fillCenter = sprite._fillCenter,\n        cx = _center.x = Math.min(Math.max(0, fillCenter.x), 1) * (r - l) + l,\n        cy = _center.y = Math.min(Math.max(0, fillCenter.y), 1) * (t - b) + b;\n\n    _vertPos[0].x = _vertPos[3].x = l;\n    _vertPos[1].x = _vertPos[2].x = r;\n    _vertPos[0].y = _vertPos[1].y = b;\n    _vertPos[2].y = _vertPos[3].y = t;\n\n    _triangles.length = 0;\n    if (cx !== vertices[0]) {\n        _triangles[0] = [3, 0];\n    }\n    if (cx !== vertices[2]) {\n        _triangles[2] = [1, 2];\n    }\n    if (cy !== vertices[1]) {\n        _triangles[1] = [0, 1];\n    }\n    if (cy !== vertices[3]) {\n        _triangles[3] = [2, 3];\n    }\n}\n\nfunction _calculateUVs (spriteFrame) {\n    let atlasWidth = spriteFrame._texture.width;\n    let atlasHeight = spriteFrame._texture.height;\n    let textureRect = spriteFrame._rect;\n\n    let u0, u1, v0, v1;\n    let uvs = _uvs;\n\n    if (spriteFrame._rotated) {\n        u0 = (textureRect.x) / atlasWidth;\n        u1 = (textureRect.x + textureRect.height) / atlasWidth;\n\n        v0 = (textureRect.y) / atlasHeight;\n        v1 = (textureRect.y + textureRect.width) / atlasHeight;\n\n        uvs[0] = uvs[2] = u0;\n        uvs[4] = uvs[6] = u1;\n        uvs[3] = uvs[7] = v1;\n        uvs[1] = uvs[5] = v0;\n    }\n    else {\n        u0 = (textureRect.x) / atlasWidth;\n        u1 = (textureRect.x + textureRect.width) / atlasWidth;\n\n        v0 = (textureRect.y) / atlasHeight;\n        v1 = (textureRect.y + textureRect.height) / atlasHeight;\n\n        uvs[0] = uvs[4] = u0;\n        uvs[2] = uvs[6] = u1;\n        uvs[1] = uvs[3] = v1;\n        uvs[5] = uvs[7] = v0;\n    }\n}\n\nfunction _getVertAngle (start, end) {\n    let placementX, placementY;\n    placementX = end.x - start.x;\n    placementY = end.y - start.y;\n\n    if (placementX === 0 && placementY === 0) {\n        return undefined;\n    } else if (placementX === 0) {\n        if (placementY > 0) {\n            return Math.PI * 0.5;\n        } else {\n            return Math.PI * 1.5;\n        }\n    } else {\n        let angle = Math.atan(placementY / placementX);\n        if (placementX < 0) {\n            angle += Math.PI;\n        }\n\n        return angle;\n    }\n}\n\nexport default class RadialFilledAssembler extends Assembler2D {\n    initData (sprite) {\n        this._renderData.createFlexData(0, 4, 6, this.getVfmt());\n        this.updateIndices();\n    }\n\n    updateRenderData (sprite) {\n        super.updateRenderData(sprite);\n\n        let frame = sprite.spriteFrame;\n        this.packToDynamicAtlas(sprite, frame);\n\n        if (sprite._vertsDirty) {\n            let fillStart = sprite._fillStart;\n            let fillRange = sprite._fillRange;\n            if (fillRange < 0) {\n                fillStart += fillRange;\n                fillRange = -fillRange;\n            }\n\n            //do round fill start [0,1), include 0, exclude 1\n            while (fillStart >= 1.0) fillStart -= 1.0;\n            while (fillStart < 0.0) fillStart += 1.0;\n\n            fillStart *= PI_2;\n            fillRange *= PI_2;\n\n            //build vertices\n            _calculateVertices(sprite);\n            //build uvs\n            _calculateUVs(frame);\n\n            _calcInsectedPoints(_vertices[0], _vertices[2], _vertices[1], _vertices[3], _center, fillStart, _intersectPoint_1);\n            _calcInsectedPoints(_vertices[0], _vertices[2], _vertices[1], _vertices[3], _center, fillStart + fillRange, _intersectPoint_2);\n\n            this.updateVerts(sprite, fillStart, fillRange);\n\n            sprite._vertsDirty = false;\n        }\n    }\n\n    updateVerts (sprite, fillStart, fillRange) {\n        let fillEnd = fillStart + fillRange;\n        \n        let local = this._local;\n        local.length = 0;\n\n        let offset = 0;\n        let floatsPerTriangle = 3 * this.floatsPerVert;\n        for (let triangleIndex = 0; triangleIndex < 4; ++triangleIndex) {\n            let triangle = _triangles[triangleIndex];\n            if (!triangle) {\n                continue;\n            }\n            //all in\n            if (fillRange >= PI_2) {\n                local.length = offset + floatsPerTriangle;\n                this._generateTriangle(local, offset, _center, _vertPos[triangle[0]], _vertPos[triangle[1]]);\n                offset += floatsPerTriangle;\n                continue;\n            }\n            //test against\n            let startAngle = _getVertAngle(_center, _vertPos[triangle[0]]);\n            let endAngle = _getVertAngle(_center, _vertPos[triangle[1]]);\n            if (endAngle < startAngle) endAngle += PI_2;\n            startAngle -= PI_2;\n            endAngle -= PI_2;\n            //testing\n            for (let testIndex = 0; testIndex < 3; ++testIndex) {\n                if (startAngle >= fillEnd) {\n                    //all out\n                } else if (startAngle >= fillStart) {\n                    local.length = offset + floatsPerTriangle;\n                    if (endAngle >= fillEnd) {\n                        //startAngle to fillEnd\n                        this._generateTriangle(local, offset, _center, _vertPos[triangle[0]], _intersectPoint_2[triangleIndex]);\n                    } else {\n                        //startAngle to endAngle\n                        this._generateTriangle(local, offset, _center, _vertPos[triangle[0]], _vertPos[triangle[1]]);\n                    }\n                    offset += floatsPerTriangle;\n                } else {\n                    //startAngle < fillStart\n                    if (endAngle <= fillStart) {\n                        //all out\n                    } else if (endAngle <= fillEnd) {\n                        local.length = offset + floatsPerTriangle;\n                        //fillStart to endAngle\n                        this._generateTriangle(local, offset, _center, _intersectPoint_1[triangleIndex], _vertPos[triangle[1]]);\n                        offset += floatsPerTriangle;\n                    } else {\n                        local.length = offset + floatsPerTriangle;\n                        //fillStart to fillEnd\n                        this._generateTriangle(local, offset, _center, _intersectPoint_1[triangleIndex], _intersectPoint_2[triangleIndex]);\n                        offset += floatsPerTriangle;\n                    }\n                }\n                //add 2 * PI\n                startAngle += PI_2;\n                endAngle += PI_2;\n            }\n        }\n\n        this.allocWorldVerts(sprite);\n        this.updateWorldVerts(sprite);\n    }\n\n    allocWorldVerts(sprite) {\n        let color = sprite.node._color._val;\n        let renderData = this._renderData;\n        let floatsPerVert = this.floatsPerVert;\n\n        let local = this._local;\n        let verticesCount = local.length / floatsPerVert;\n        this.verticesCount = this.indicesCount = verticesCount;\n\n        let flexBuffer = renderData._flexBuffer;\n        if (flexBuffer.reserve(verticesCount, verticesCount)) {\n            this.updateIndices();\n        }\n        flexBuffer.used(this.verticesCount, this.indicesCount);\n\n        let verts = renderData.vDatas[0],\n            uintVerts = renderData.uintVDatas[0];\n        \n        let uvOffset = this.uvOffset;\n        for (let offset = 0; offset < local.length; offset += floatsPerVert) {\n            let start = offset + uvOffset;\n            verts[start] = local[start];\n            verts[start + 1] = local[start + 1];\n            uintVerts[start + 2] = color;\n        }\n    }\n\n    updateIndices () {\n        let iData = this._renderData.iDatas[0];\n        for (let i = 0; i < iData.length; i ++) {\n            iData[i] = i;\n        }\n    }\n\n    updateWorldVerts (sprite) {\n        let node = sprite.node;\n\n        let matrix = node._worldMatrix;\n        let matrixm = matrix.m,\n            a = matrixm[0], b = matrixm[1], c = matrixm[4], d = matrixm[5],\n            tx = matrixm[12], ty = matrixm[13];\n\n        let local = this._local;\n        let world = this._renderData.vDatas[0];\n        let floatsPerVert = this.floatsPerVert;\n        for (let offset = 0; offset < local.length; offset += floatsPerVert) {\n            let x = local[offset];\n            let y = local[offset + 1];\n            world[offset] = x * a + y * c + tx;\n            world[offset+1] = x * b + y * d + ty;\n        }\n    }\n\n    _generateTriangle (verts, offset, vert0, vert1, vert2) {\n        let vertices = _vertices;\n        let v0x = vertices[0];\n        let v0y = vertices[1];\n        let v1x = vertices[2];\n        let v1y = vertices[3];\n\n        let floatsPerVert = this.floatsPerVert;\n        verts[offset] = vert0.x;\n        verts[offset + 1] = vert0.y;\n        verts[offset + floatsPerVert] = vert1.x;\n        verts[offset + floatsPerVert + 1] = vert1.y;\n        verts[offset + floatsPerVert*2] = vert2.x;\n        verts[offset + floatsPerVert*2 + 1] = vert2.y;\n\n        let uvOffset = this.uvOffset;\n        let progressX, progressY;\n        progressX = (vert0.x - v0x) / (v1x - v0x);\n        progressY = (vert0.y - v0y) / (v1y - v0y);\n        this._generateUV(progressX, progressY, verts, offset + uvOffset);\n\n        progressX = (vert1.x - v0x) / (v1x - v0x);\n        progressY = (vert1.y - v0y) / (v1y - v0y);\n        this._generateUV(progressX, progressY, verts, offset + floatsPerVert + uvOffset);\n\n        progressX = (vert2.x - v0x) / (v1x - v0x);\n        progressY = (vert2.y - v0y) / (v1y - v0y);\n        this._generateUV(progressX, progressY, verts, offset + floatsPerVert*2 + uvOffset);\n    }\n\n    _generateUV (progressX, progressY, verts, offset) {\n        let uvs = _uvs;\n        let px1 = uvs[0] + (uvs[2] - uvs[0]) * progressX;\n        let px2 = uvs[4] + (uvs[6] - uvs[4]) * progressX;\n        let py1 = uvs[1] + (uvs[3] - uvs[1]) * progressX;\n        let py2 = uvs[5] + (uvs[7] - uvs[5]) * progressX;\n        verts[offset] = px1 + (px2 - px1) * progressY;\n        verts[offset + 1] = py1 + (py2 - py1) * progressY;\n    }\n}\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler2D from '../../../../assembler-2d';\n\nexport default class SimpleSpriteAssembler extends Assembler2D {\n    updateRenderData (sprite) {\n        this.packToDynamicAtlas(sprite, sprite._spriteFrame);\n\n        if (sprite._vertsDirty) {\n            this.updateUVs(sprite);\n            this.updateVerts(sprite);\n            sprite._vertsDirty = false;\n        }\n    }\n\n    updateUVs (sprite) {\n        let uv = sprite._spriteFrame.uv;\n        let uvOffset = this.uvOffset;\n        let floatsPerVert = this.floatsPerVert;\n        let verts = this._renderData.vDatas[0];\n        for (let i = 0; i < 4; i++) {\n            let srcOffset = i * 2;\n            let dstOffset = floatsPerVert * i + uvOffset;\n            verts[dstOffset] = uv[srcOffset];\n            verts[dstOffset + 1] = uv[srcOffset + 1];\n        }\n    }\n\n    updateVerts (sprite) {\n        let node = sprite.node,\n            cw = node.width, ch = node.height,\n            appx = node.anchorX * cw, appy = node.anchorY * ch,\n            l, b, r, t;\n        if (sprite.trim) {\n            l = -appx;\n            b = -appy;\n            r = cw - appx;\n            t = ch - appy;\n        }\n        else {\n            let frame = sprite.spriteFrame,\n                ow = frame._originalSize.width, oh = frame._originalSize.height,\n                rw = frame._rect.width, rh = frame._rect.height,\n                offset = frame._offset,\n                scaleX = cw / ow, scaleY = ch / oh;\n            let trimLeft = offset.x + (ow - rw) / 2;\n            let trimRight = offset.x - (ow - rw) / 2;\n            let trimBottom = offset.y + (oh - rh) / 2;\n            let trimTop = offset.y - (oh - rh) / 2;\n            l = trimLeft * scaleX - appx;\n            b = trimBottom * scaleY - appy;\n            r = cw + trimRight * scaleX - appx;\n            t = ch + trimTop * scaleY - appy;\n        }\n\n        let local = this._local;\n        local[0] = l;\n        local[1] = b;\n        local[2] = r;\n        local[3] = t;\n        this.updateWorldVerts(sprite);\n    }\n}\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos.com\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler2D from '../../../../assembler-2d';\n\nexport default class SlicedAssembler extends Assembler2D {\n    initData (sprite) {\n        if (this._renderData.meshCount > 0) return;\n        this._renderData.createData(0, this.verticesFloats, this.indicesCount);\n\n        let indices = this._renderData.iDatas[0];\n        let indexOffset = 0;\n        for (let r = 0; r < 3; ++r) {\n            for (let c = 0; c < 3; ++c) {\n                let start = r * 4 + c;\n                indices[indexOffset++] = start;\n                indices[indexOffset++] = start + 1;\n                indices[indexOffset++] = start + 4;\n                indices[indexOffset++] = start + 1;\n                indices[indexOffset++] = start + 5;\n                indices[indexOffset++] = start + 4;\n            }\n        }\n    }\n\n    initLocal () {\n        this._local = [];\n        this._local.length = 8;\n    }\n\n    updateRenderData (sprite) {\n        let frame = sprite._spriteFrame;\n        this.packToDynamicAtlas(sprite, frame);\n\n        if (sprite._vertsDirty) {\n            this.updateUVs(sprite);\n            this.updateVerts(sprite);\n            sprite._vertsDirty = false;\n        }\n    }\n\n    updateVerts (sprite) {\n        let node = sprite.node,\n            width = node.width, height = node.height,\n            appx = node.anchorX * width, appy = node.anchorY * height;\n\n        let frame = sprite.spriteFrame;\n        let leftWidth = frame.insetLeft;\n        let rightWidth = frame.insetRight;\n        let topHeight = frame.insetTop;\n        let bottomHeight = frame.insetBottom;\n\n        let sizableWidth = width - leftWidth - rightWidth;\n        let sizableHeight = height - topHeight - bottomHeight;\n        let xScale = width / (leftWidth + rightWidth);\n        let yScale = height / (topHeight + bottomHeight);\n        xScale = (isNaN(xScale) || xScale > 1) ? 1 : xScale;\n        yScale = (isNaN(yScale) || yScale > 1) ? 1 : yScale;\n        sizableWidth = sizableWidth < 0 ? 0 : sizableWidth;\n        sizableHeight = sizableHeight < 0 ? 0 : sizableHeight;\n\n        // update local\n        let local = this._local;\n        local[0] = -appx;\n        local[1] = -appy;\n        local[2] = leftWidth * xScale - appx;\n        local[3] = bottomHeight * yScale - appy;\n        local[4] = local[2] + sizableWidth;\n        local[5] = local[3] + sizableHeight;\n        local[6] = width - appx;\n        local[7] = height - appy;\n\n        this.updateWorldVerts(sprite);\n    }\n\n    updateUVs (sprite) {\n        let verts = this._renderData.vDatas[0];\n        let uvSliced = sprite.spriteFrame.uvSliced;\n        let uvOffset = this.uvOffset;\n        let floatsPerVert = this.floatsPerVert;\n        for (let row = 0; row < 4; ++row) {\n            for (let col = 0; col < 4; ++col) {\n                let vid = row * 4 + col;\n                let uv = uvSliced[vid];\n                let voffset = vid * floatsPerVert;\n                verts[voffset + uvOffset] = uv.u;\n                verts[voffset + uvOffset + 1] = uv.v;\n            }\n        }\n    }\n\n    updateWorldVerts (sprite) {\n        let matrix = sprite.node._worldMatrix;\n        let matrixm = matrix.m,\n            a = matrixm[0], b = matrixm[1], c = matrixm[4], d = matrixm[5],\n            tx = matrixm[12], ty = matrixm[13];\n\n        let local = this._local;\n        let world = this._renderData.vDatas[0];\n\n        let floatsPerVert = this.floatsPerVert;\n        for (let row = 0; row < 4; ++row) {\n            let localRowY = local[row * 2 + 1];\n            for (let col = 0; col < 4; ++col) {\n                let localColX = local[col * 2];\n                let worldIndex = (row * 4 + col) * floatsPerVert;\n                world[worldIndex] = localColX * a + localRowY * c + tx;\n                world[worldIndex + 1] = localColX * b + localRowY * d + ty;\n            }\n        }\n    }\n}\n\nObject.assign(SlicedAssembler.prototype, {\n    verticesCount: 16,\n    indicesCount: 54\n});\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport Assembler2D from '../../../../assembler-2d';\n\nexport default class TiledAssembler extends Assembler2D {\n    initData (sprite) {\n        this.verticesCount = 0;\n        this.contentWidth = 0;\n        this.contentHeight = 0;\n        this.rectWidth = 0;\n        this.rectHeight = 0;\n        this.hRepeat = 0;\n        this.vRepeat = 0;\n        this.row = 0;\n        this.col = 0;\n\n        this._renderData.createFlexData(0, 4, 6, this.getVfmt());\n        this._updateIndices();\n    }\n\n    initLocal () {\n        this._local = { x: [], y: []};\n    }\n\n    _updateIndices () {\n        let iData = this._renderData.iDatas[0];\n        for (let i = 0, vid = 0, l = iData.length; i < l; i += 6, vid += 4) {\n            iData[i] = vid;\n            iData[i + 1] = vid + 1;\n            iData[i + 2] = vid + 2;\n            iData[i + 3] = vid + 1;\n            iData[i + 4] = vid + 3;\n            iData[i + 5] = vid + 2;\n        }\n    }\n\n    updateRenderData (sprite) {\n        let frame = sprite._spriteFrame;\n        this.packToDynamicAtlas(sprite, frame);\n\n        let node = sprite.node;\n\n        let contentWidth = this.contentWidth = Math.abs(node.width);\n        let contentHeight = this.contentHeight = Math.abs(node.height);\n        let rect = frame._rect;\n        let rectWidth = this.rectWidth = rect.width;\n        let rectHeight = this.rectHeight = rect.height;\n        let hRepeat = this.hRepeat = contentWidth / rectWidth;\n        let vRepeat = this.vRepeat = contentHeight / rectHeight;\n        let row = this.row = Math.ceil(vRepeat);\n        let col = this.col = Math.ceil(hRepeat);\n\n        // update data property\n        let count = row * col;\n        this.verticesCount = count * 4;\n        this.indicesCount = count * 6;\n\n        let renderData = this._renderData;\n        let flexBuffer = renderData._flexBuffer;\n        if (flexBuffer.reserve(this.verticesCount, this.indicesCount)) {\n            this._updateIndices();\n            this.updateColor(sprite);\n        }\n        flexBuffer.used(this.verticesCount, this.indicesCount);\n\n        if (sprite._vertsDirty) {\n            this.updateUVs(sprite);\n            this.updateVerts(sprite);\n            sprite._vertsDirty = false;\n        }\n    }\n\n    updateVerts (sprite) {\n        let node = sprite.node,\n            appx = node.anchorX * node.width, appy = node.anchorY * node.height;\n\n        let { row, col, rectWidth, rectHeight, contentWidth, contentHeight } = this;\n        let { x, y } = this._local;\n        x.length = y.length = 0;\n        for (let i = 0; i <= col; ++i) {\n            x[i] = Math.min(rectWidth * i, contentWidth) - appx;\n        }\n        for (let i = 0; i <= row; ++i) {\n            y[i] = Math.min(rectHeight * i, contentHeight) - appy;\n        }\n\n        this.updateWorldVerts(sprite);\n    }\n    \n    updateWorldVerts (sprite) {\n        let renderData = this._renderData;\n        let local = this._local;\n        let localX = local.x, localY = local.y;\n        let world = renderData.vDatas[0];\n        let { row, col } = this;\n        let matrix = sprite.node._worldMatrix;\n        let matrixm = matrix.m;\n        let a = matrixm[0], b = matrixm[1], c = matrixm[4], d = matrixm[5],\n            tx = matrixm[12], ty = matrixm[13];\n\n        let x, x1, y, y1;\n        let floatsPerVert = this.floatsPerVert;\n        let vertexOffset = 0;\n        for (let yindex = 0, ylength = row; yindex < ylength; ++yindex) {\n            y = localY[yindex];\n            y1 = localY[yindex + 1];\n            for (let xindex = 0, xlength = col; xindex < xlength; ++xindex) {\n                x = localX[xindex];\n                x1 = localX[xindex + 1];\n\n                // lb\n                world[vertexOffset] = x * a + y * c + tx;\n                world[vertexOffset + 1] = x * b + y * d + ty;\n                vertexOffset += floatsPerVert;\n                // rb\n                world[vertexOffset] = x1 * a + y * c + tx;\n                world[vertexOffset + 1] = x1 * b + y * d + ty;\n                vertexOffset += floatsPerVert;\n                // lt\n                world[vertexOffset] = x * a + y1 * c + tx;\n                world[vertexOffset + 1] = x * b + y1 * d + ty;\n                vertexOffset += floatsPerVert;\n                // rt\n                world[vertexOffset] = x1 * a + y1 * c + tx;\n                world[vertexOffset + 1] = x1 * b + y1 * d + ty;\n                vertexOffset += floatsPerVert;\n            }\n        }\n    }\n\n    updateUVs (sprite) {\n        let verts = this._renderData.vDatas[0];\n        if (!verts) return;\n\n        let { row, col, hRepeat, vRepeat } = this;\n        let uv = sprite.spriteFrame.uv;\n        let rotated = sprite.spriteFrame._rotated;\n        let floatsPerVert = this.floatsPerVert, uvOffset = this.uvOffset;\n        for (let yindex = 0, ylength = row; yindex < ylength; ++yindex) {\n            let coefv = Math.min(1, vRepeat - yindex);\n            for (let xindex = 0, xlength = col; xindex < xlength; ++xindex) {\n                let coefu = Math.min(1, hRepeat - xindex);\n\n                // UV\n                if (rotated) {\n                    // lb\n                    verts[uvOffset] = uv[0];\n                    verts[uvOffset + 1] = uv[1];\n                    uvOffset += floatsPerVert;\n                    // rb\n                    verts[uvOffset] = uv[0];\n                    verts[uvOffset + 1] = uv[1] + (uv[7] - uv[1]) * coefu;\n                    uvOffset += floatsPerVert;\n                    // lt\n                    verts[uvOffset] = uv[0] + (uv[6] - uv[0]) * coefv;\n                    verts[uvOffset + 1] = uv[1];\n                    uvOffset += floatsPerVert;\n                    // rt\n                    verts[uvOffset] = verts[uvOffset - floatsPerVert];\n                    verts[uvOffset + 1] = verts[uvOffset + 1 - floatsPerVert * 2];\n                    uvOffset += floatsPerVert;\n                }\n                else {\n                    // lb\n                    verts[uvOffset] = uv[0];\n                    verts[uvOffset + 1] = uv[1];\n                    uvOffset += floatsPerVert;\n                    // rb\n                    verts[uvOffset] = uv[0] + (uv[6] - uv[0]) * coefu;\n                    verts[uvOffset + 1] = uv[1];\n                    uvOffset += floatsPerVert;\n                    // lt\n                    verts[uvOffset] = uv[0];\n                    verts[uvOffset + 1] = uv[1] + (uv[7] - uv[1]) * coefv;\n                    uvOffset += floatsPerVert;\n                    // rt\n                    verts[uvOffset] = verts[uvOffset - floatsPerVert * 2];\n                    verts[uvOffset + 1] = verts[uvOffset + 1 - floatsPerVert];\n                    uvOffset += floatsPerVert;\n                }\n            }\n        }\n    }\n}\n\n","import Asembler from '../../../assembler';\nimport { Type, FillType } from '../../../../components/CCSprite';\n\nimport Simple from \"./2d/simple\";\nimport Sliced from \"./2d/sliced\";\nimport Tiled from \"./2d/tiled\";\nimport RadialFilled from \"./2d/radial-filled\";\nimport BarFilled from \"./2d/bar-filled\";\nimport Mesh from './2d/mesh';\n\nimport Simple3D from \"./3d/simple\";\nimport Sliced3D from \"./3d/sliced\";\nimport Tiled3D from \"./3d/tiled\";\nimport RadialFilled3D from \"./3d/radial-filled\";\nimport BarFilled3D from \"./3d/bar-filled\";\nimport Mesh3D from './3d/mesh';\n\nlet ctor = {\n    getConstructor(sprite) {\n        let is3DNode = sprite.node.is3DNode;\n\n        let ctor = is3DNode ? Simple3D : Simple;\n        switch (sprite.type) {\n            case Type.SLICED:\n                ctor = is3DNode ? Sliced3D : Sliced;\n                break;\n            case Type.TILED:\n                ctor = is3DNode ? Tiled3D : Tiled;\n                break;\n            case Type.FILLED:\n                if (sprite._fillType === FillType.RADIAL) {\n                    ctor = is3DNode ? RadialFilled3D : RadialFilled;\n                } else {\n                    ctor = is3DNode ? BarFilled3D : BarFilled;\n                }\n                break;\n            case Type.MESH:\n                ctor = is3DNode ? Mesh3D : Mesh;\n                break;\n        }\n\n        return ctor;\n    },\n\n    Simple,\n    Sliced,\n    Tiled,\n    RadialFilled,\n    BarFilled,\n    Mesh,\n\n    Simple3D,\n    Sliced3D,\n    Tiled3D,\n    RadialFilled3D,\n    BarFilled3D,\n    Mesh3D,\n};\n\nAsembler.register(cc.Sprite, ctor);\n","/****************************************************************************\n LICENSING AGREEMENT\n \n Xiamen Yaji Software Co., Ltd., (the “Licensor”) grants the user (the “Licensee”) non-exclusive and non-transferable rights to use the software according to the following conditions:\n a.  The Licensee shall pay royalties to the Licensor, and the amount of those royalties and the payment method are subject to separate negotiations between the parties.\n b.  The software is licensed for use rather than sold, and the Licensor reserves all rights over the software that are not expressly granted (whether by implication, reservation or prohibition).\n c.  The open source codes contained in the software are subject to the MIT Open Source Licensing Agreement (see the attached for the details);\n d.  The Licensee acknowledges and consents to the possibility that errors may occur during the operation of the software for one or more technical reasons, and the Licensee shall take precautions and prepare remedies for such events. In such circumstance, the Licensor shall provide software patches or updates according to the agreement between the two parties. The Licensor will not assume any liability beyond the explicit wording of this Licensing Agreement.\n e.  Where the Licensor must assume liability for the software according to relevant laws, the Licensor’s entire liability is limited to the annual royalty payable by the Licensee.\n f.  The Licensor owns the portions listed in the root directory and subdirectory (if any) in the software and enjoys the intellectual property rights over those portions. As for the portions owned by the Licensor, the Licensee shall not:\n - i. Bypass or avoid any relevant technical protection measures in the products or services;\n - ii. Release the source codes to any other parties;\n - iii. Disassemble, decompile, decipher, attack, emulate, exploit or reverse-engineer these portion of code;\n - iv. Apply it to any third-party products or services without Licensor’s permission;\n - v. Publish, copy, rent, lease, sell, export, import, distribute or lend any products containing these portions of code;\n - vi. Allow others to use any services relevant to the technology of these codes;\n - vii. Conduct any other act beyond the scope of this Licensing Agreement.\n g.  This Licensing Agreement terminates immediately if the Licensee breaches this Agreement. The Licensor may claim compensation from the Licensee where the Licensee’s breach causes any damage to the Licensor.\n h.  The laws of the People's Republic of China apply to this Licensing Agreement.\n i.  This Agreement is made in both Chinese and English, and the Chinese version shall prevail the event of conflict.\n ****************************************************************************/\n\nexport default class FlexBuffer {\n    constructor (handler, index, verticesCount, indicesCount, vfmt) {\n        this._handler = handler;\n        this._index = index;\n        this._vfmt = vfmt;\n        this._verticesBytes = vfmt._bytes;\n\n        this._initVerticesCount = verticesCount;\n        this._initIndicesCount = indicesCount;\n\n        this.reset();\n    }\n\n    _reallocVData (floatsCount, oldData) {\n        this.vData = new Float32Array(floatsCount);\n        this.uintVData = new Uint32Array(this.vData.buffer);\n\n        if (oldData) {\n            this.vData.set(oldData);\n        }\n\n        this._handler.updateMesh(this._index, this.vData, this.iData);\n    }\n\n    _reallocIData (indicesCount, oldData) {\n        this.iData = new Uint16Array(indicesCount);\n        \n        if (oldData) {\n            this.iData.set(oldData);\n        }\n\n        this._handler.updateMesh(this._index, this.vData, this.iData);\n    }\n\n    reserve (verticesCount, indicesCount) {\n        let floatsCount = verticesCount * this._verticesBytes >> 2;\n        let newFloatsCount = this.vData.length;\n        let realloced = false;\n\n        if (floatsCount > newFloatsCount) {\n            while (newFloatsCount < floatsCount) {\n                newFloatsCount *= 2;\n            }\n            this._reallocVData(newFloatsCount, this.vData);\n            realloced = true;\n        }\n\n        let newIndicesCount = this.iData.length;\n        if (indicesCount > newIndicesCount) {\n            while (newIndicesCount < indicesCount) {\n                newIndicesCount *= 2;\n            }\n            this._reallocIData(indicesCount, this.iData);\n            realloced = true;\n        }\n\n        return realloced;\n    }\n\n    used (verticesCount, indicesCount) {\n        this.usedVertices = verticesCount;\n        this.usedIndices = indicesCount;\n        this.usedVerticesFloats = verticesCount * this._verticesBytes >> 2;\n\n        this._handler.updateMeshRange(verticesCount, indicesCount);\n    }\n\n    reset () {\n        let floatsCount = this._initVerticesCount * this._verticesBytes >> 2;\n        this._reallocVData(floatsCount);\n        this._reallocIData(this._initIndicesCount);\n\n        this.usedVertices = 0;\n        this.usedVerticesFloats = 0;\n        this.usedIndices = 0;\n    }\n} \n\ncc.FlexBuffer = FlexBuffer\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport gfx from '../../../renderer/gfx';\n\nlet MeshBuffer = cc.Class({\n    name: 'cc.MeshBuffer',\n    ctor (batcher, vertexFormat) {\n        this.init (batcher, vertexFormat);\n    },\n\n    init (batcher, vertexFormat) {\n        this.byteOffset = 0;\n        this.indiceOffset = 0;\n        this.vertexOffset = 0;\n        this.indiceStart = 0;\n\n        this._dirty = false;\n\n        this._vertexFormat = vertexFormat;\n        this._vertexBytes = this._vertexFormat._bytes;\n\n        this._arrOffset = 0;\n        this._vbArr = [];\n        this._vb = new gfx.VertexBuffer(\n            batcher._device,\n            vertexFormat,\n            gfx.USAGE_DYNAMIC,\n            new ArrayBuffer(),\n            0\n        );\n        this._vbArr[0] = this._vb;\n\n        this._ibArr = [];\n        this._ib = new gfx.IndexBuffer(\n            batcher._device,\n            gfx.INDEX_FMT_UINT16,\n            gfx.USAGE_STATIC,\n            new ArrayBuffer(),\n            0\n        );\n        this._ibArr[0] = this._ib;\n\n        this._vData = null;\n        this._uintVData = null;\n        this._iData = null;\n\n        this._batcher = batcher;\n\n        this._initVDataCount = 256 * vertexFormat._bytes;// actually 256 * 4 * (vertexFormat._bytes / 4)\n        this._initIDataCount = 256 * 6;\n        \n        this._offsetInfo = {\n            byteOffset : 0,\n            vertexOffset : 0,\n            indiceOffset : 0\n        }\n        this._reallocBuffer();\n    },\n\n    uploadData () {\n        if (this.byteOffset === 0 || !this._dirty) {\n            return;\n        }\n\n        // update vertext data\n        let vertexsData = new Float32Array(this._vData.buffer, 0, this.byteOffset >> 2);\n        let indicesData = new Uint16Array(this._iData.buffer, 0, this.indiceOffset);\n\n        let vb = this._vb;\n        vb.update(0, vertexsData);\n\n        let ib = this._ib;\n        ib.update(0, indicesData);\n\n        this._dirty = false;\n    },\n\n    switchBuffer () {\n        let offset = ++this._arrOffset;\n\n        this.byteOffset = 0;\n        this.vertexOffset = 0;\n        this.indiceOffset = 0;\n        this.indiceStart = 0;\n\n        if (offset < this._vbArr.length) {\n            this._vb = this._vbArr[offset];\n            this._ib = this._ibArr[offset];\n        } else {\n\n            this._vb = new gfx.VertexBuffer(\n                this._batcher._device,\n                this._vertexFormat,\n                gfx.USAGE_DYNAMIC,\n                new ArrayBuffer(),\n                0\n            );\n            this._vbArr[offset] = this._vb;\n\n            this._ib = new gfx.IndexBuffer(\n                this._batcher._device,\n                gfx.INDEX_FMT_UINT16,\n                gfx.USAGE_STATIC,\n                new ArrayBuffer(),\n                0\n            );\n            this._ibArr[offset] = this._ib;\n        }\n    },\n\n    checkAndSwitchBuffer (vertexCount) {\n        if (this.vertexOffset + vertexCount > 65535) {\n            this.uploadData();\n            this._batcher._flush();\n            this.switchBuffer();\n        }\n    },\n\n    requestStatic (vertexCount, indiceCount) {\n\n        this.checkAndSwitchBuffer(vertexCount);\n\n        let byteOffset = this.byteOffset + vertexCount * this._vertexBytes;\n        let indiceOffset = this.indiceOffset + indiceCount;\n\n        let byteLength = this._vData.byteLength;\n        let indiceLength = this._iData.length;\n        if (byteOffset > byteLength || indiceOffset > indiceLength) {\n            while (byteLength < byteOffset || indiceLength < indiceOffset) {\n                this._initVDataCount *= 2;\n                this._initIDataCount *= 2;\n\n                byteLength = this._initVDataCount * 4;\n                indiceLength = this._initIDataCount;\n            }\n\n            this._reallocBuffer();\n        }\n        this._updateOffset(vertexCount, indiceCount, byteOffset);\n    },\n\n    _updateOffset (vertexCount, indiceCount, byteOffset) {\n        let offsetInfo = this._offsetInfo;\n        offsetInfo.vertexOffset = this.vertexOffset;\n        this.vertexOffset += vertexCount;\n\n        offsetInfo.indiceOffset = this.indiceOffset;\n        this.indiceOffset += indiceCount;\n\n        offsetInfo.byteOffset = this.byteOffset;\n        this.byteOffset = byteOffset;\n\n        this._dirty = true;\n    },\n\n    request (vertexCount, indiceCount) {\n        if (this._batcher._buffer !== this) {\n            this._batcher._flush();\n            this._batcher._buffer = this;\n        }\n\n        this.requestStatic(vertexCount, indiceCount);\n        return this._offsetInfo;\n    },\n    \n    _reallocBuffer () {\n        this._reallocVData(true);\n        this._reallocIData(true);\n    },\n\n    _reallocVData (copyOldData) {\n        let oldVData;\n        if (this._vData) {\n            oldVData = new Uint8Array(this._vData.buffer);\n        }\n\n        this._vData = new Float32Array(this._initVDataCount);\n        this._uintVData = new Uint32Array(this._vData.buffer);\n\n        let newData = new Uint8Array(this._uintVData.buffer);\n\n        if (oldVData && copyOldData) {\n            for (let i = 0, l = oldVData.length; i < l; i++) {\n                newData[i] = oldVData[i];\n            }\n        }\n    },\n\n    _reallocIData (copyOldData) {\n        let oldIData = this._iData;\n\n        this._iData = new Uint16Array(this._initIDataCount);\n\n        if (oldIData && copyOldData) {\n            let iData = this._iData;\n            for (let i = 0, l = oldIData.length; i < l; i++) {\n                iData[i] = oldIData[i];\n            }\n        }\n    },\n\n    reset () {\n        this._arrOffset = 0;\n        this._vb = this._vbArr[0];\n        this._ib = this._ibArr[0];\n\n        this.byteOffset = 0;\n        this.indiceOffset = 0;\n        this.vertexOffset = 0;\n        this.indiceStart = 0;\n\n        this._dirty = false;\n    },\n\n    destroy () {\n        this.reset();\n        for (let i = 0; i <  this._vbArr.length; i++) {\n            let vb = this._vbArr[i];\n            vb.destroy();\n        }\n        this._vbArr = null;\n\n        for (let i = 0; i < this._ibArr.length; i++) {\n            let ib = this._ibArr[i];\n            ib.destroy();\n        }\n        this._ibArr = null;\n\n        this._ib = null;\n        this._vb = null;\n    },\n\n    forwardIndiceStartToOffset () {\n        this.indiceStart = this.indiceOffset;\n    }\n});\n\ncc.MeshBuffer = module.exports = MeshBuffer;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst { vfmtPosUvColor, vfmt3D } = require('./vertex-format');\nconst QuadBuffer = require('./quad-buffer');\nconst MeshBuffer = require('./mesh-buffer');\nconst SpineBuffer = require('./spine-buffer');\nconst Material = require('../../assets/material/CCMaterial');\n\nlet idGenerater = new (require('../../platform/id-generater'))('VertextFormat');\n\nimport InputAssembler from '../../../renderer/core/input-assembler';\nimport RecyclePool from '../../../renderer/memop/recycle-pool';\nimport Model from '../../../renderer/scene/model';\n\nlet _buffers = {};\n\nconst empty_material = new Material();\nconst empty_ia = new InputAssembler();\nempty_ia._count = 0;\n\nvar ModelBatcher = function (device, renderScene) {\n    this._renderScene = renderScene;\n    this._device = device;\n\n    this.walking = false;\n    this.material = empty_material;\n    this.cullingMask = 1;\n\n    this._iaPool = new RecyclePool(function () {\n        return new InputAssembler();\n    }, 16);\n\n    this._modelPool = new RecyclePool(function () {\n        return new Model();\n    }, 16);\n\n    // buffers\n    this._quadBuffer = this.getBuffer('quad', vfmtPosUvColor);\n    this._meshBuffer = this.getBuffer('mesh', vfmtPosUvColor);\n    this._quadBuffer3D = this.getBuffer('quad', vfmt3D);\n    this._meshBuffer3D = this.getBuffer('mesh', vfmt3D);\n    this._buffer = this._meshBuffer;\n\n    this._batchedModels = [];\n    this._dummyNode = new cc.Node();\n    this._sortKey = 0;\n\n    this.node = this._dummyNode;\n    \n    this.parentOpacity = 1;\n    this.parentOpacityDirty = 0;\n    this.worldMatDirty = 0;\n};\n\nModelBatcher.prototype = {\n    constructor: ModelBatcher,\n    \n    reset() {\n        // Reset pools\n        this._iaPool.reset();\n\n        // Reset scene\n        let scene = this._renderScene;\n        let models = this._batchedModels;\n        for (let i = 0; i < models.length; ++i) {\n            // remove from scene\n            // models[i].clearInputAssemblers();\n            // models[i].clearEffects();\n            models[i].setInputAssembler(null);\n            models[i].setEffect(null);\n            scene.removeModel(models[i]);\n        }\n        this._modelPool.reset();\n        models.length = 0;\n        this._sortKey = 0;\n\n        for (let key in _buffers) {\n            _buffers[key].reset();\n        }\n        this._buffer = this._meshBuffer;\n\n        // reset caches for handle render components\n        this.node = this._dummyNode;\n        this.material = empty_material;\n        this.cullingMask = 1;\n\n        this.parentOpacity = 1;\n        this.parentOpacityDirty = 0;\n        this.worldMatDirty = 0;\n    },\n\n    _flushMaterial (material) {\n        if (!material) {\n            return;\n        }\n        this.material = material;\n        let effect = material.effect;\n        if (!effect) return;\n        \n        // Generate model\n        let model = this._modelPool.add();\n        this._batchedModels.push(model);\n        model.sortKey = this._sortKey++;\n        model._cullingMask = this.cullingMask;\n        model.setNode(this.node);\n        model.setEffect(effect, null);\n        model.setInputAssembler(empty_ia);\n        \n        this._renderScene.addModel(model);\n    },\n\n    _flush () {\n        let material = this.material,\n            buffer = this._buffer,\n            indiceCount = buffer.indiceOffset - buffer.indiceStart;\n        if (!this.walking || !material || indiceCount <= 0) {\n            return;\n        }\n\n        let effect = material.effect;\n        if (!effect) return;\n        \n        // Generate ia\n        let ia = this._iaPool.add();\n        ia._vertexBuffer = buffer._vb;\n        ia._indexBuffer = buffer._ib;\n        ia._start = buffer.indiceStart;\n        ia._count = indiceCount;\n        \n        // Generate model\n        let model = this._modelPool.add();\n        this._batchedModels.push(model);\n        model.sortKey = this._sortKey++;\n        model._cullingMask = this.cullingMask;\n        model.setNode(this.node);\n        model.setEffect(effect);\n        model.setInputAssembler(ia);\n        \n        this._renderScene.addModel(model);\n        buffer.forwardIndiceStartToOffset();\n    },\n\n    _flushIA (ia) {\n        if (!ia) {\n            return;\n        }\n\n        let material = this.material;\n        let effect = material.effect;\n        if (!effect) return;\n        \n        // Generate model\n        let model = this._modelPool.add();\n        this._batchedModels.push(model);\n        model.sortKey = this._sortKey++;\n        model._cullingMask = this.cullingMask;\n        model.setNode(this.node);\n        model.setEffect(effect);\n        model.setInputAssembler(ia);\n        \n        this._renderScene.addModel(model);\n    },\n\n    terminate () {\n        if (cc.dynamicAtlasManager && cc.dynamicAtlasManager.enabled) {\n            cc.dynamicAtlasManager.update();\n        }\n\n        // flush current rest Model\n        this._flush();\n\n        for (let key in _buffers) {\n            _buffers[key].uploadData();\n        }\n    \n        this.walking = false;\n    },\n\n    getBuffer (type, vertextFormat) {\n        let key = type + vertextFormat.getHash();\n        let buffer = _buffers[key];\n        if (!buffer) {\n            if (type === 'mesh') {\n                buffer = new MeshBuffer(this, vertextFormat);\n            }\n            else if (type === 'quad') {\n                buffer = new QuadBuffer(this, vertextFormat);\n            }\n            else if (type === 'spine') {\n                buffer = new SpineBuffer(this, vertextFormat);\n            }\n            else {\n                cc.error(`Not support buffer type [${type}]`);\n                return null;\n            }\n\n            _buffers[key] = buffer;\n        }\n\n        return buffer;\n    }\n}\n\nmodule.exports = ModelBatcher;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst MeshBuffer = require('./mesh-buffer');\n\nlet QuadBuffer = cc.Class({\n    name: 'cc.QuadBuffer',\n    extends: MeshBuffer,\n    \n    _fillQuadBuffer () {\n        let count = this._initIDataCount / 6;\n        let buffer = this._iData;\n        for (let i = 0, idx = 0; i < count; i++) {\n            let vertextID = i * 4;\n            buffer[idx++] = vertextID;\n            buffer[idx++] = vertextID+1;\n            buffer[idx++] = vertextID+2;\n            buffer[idx++] = vertextID+1;\n            buffer[idx++] = vertextID+3;\n            buffer[idx++] = vertextID+2;\n        }\n\n        let indicesData = new Uint16Array(this._iData.buffer, 0, count * 6);\n        this._ib.update(0, indicesData);\n    },\n\n    uploadData () {\n        if (this.byteOffset === 0 || !this._dirty) {\n            return;\n        }\n\n        // update vertext data\n        let vertexsData = new Float32Array(this._vData.buffer, 0, this.byteOffset >> 2);\n        this._vb.update(0, vertexsData);\n\n        this._dirty = false;\n    },\n\n    switchBuffer () {\n        this._super();\n        // upload index buffer data\n        let indicesData = new Uint16Array(this._iData.buffer, 0, this._initIDataCount);\n        this._ib.update(0, indicesData);\n    },\n\n    _reallocBuffer () {\n        this._reallocVData(true);\n        this._reallocIData();\n        this._fillQuadBuffer();\n    }\n});\n\ncc.QuadBuffer = module.exports = QuadBuffer;\n","import FlexBuffer from \"./flex-buffer\";\nimport { vfmtPosUvColor } from './vertex-format';\n\nexport default function RenderData () {\n    this.vDatas = [];\n    this.uintVDatas = [];\n    this.iDatas = [];\n    this.meshCount = 0;\n\n    this._infos = null;\n    this._flexBuffer = null;\n}\n\ncc.js.mixin(RenderData.prototype, {\n    init (assembler) {\n    },\n    clear () {\n        this.vDatas.length = 0;\n        this.iDatas.length = 0;\n        this.uintVDatas.length = 0;\n        this.meshCount = 0;\n\n        this._infos = null;\n\n        if (this._flexBuffer) {\n            this._flexBuffer.reset();\n        }\n    },\n\n    updateMesh (index, vertices, indices) {\n        this.vDatas[index] = vertices;\n        this.uintVDatas[index] = new Uint32Array(vertices.buffer, 0, vertices.length);\n        this.iDatas[index] = indices;\n    \n        this.meshCount = this.vDatas.length;\n    },\n\n    updateMeshRange (verticesCount, indicesCount) {\n    },\n    \n    createData (index, verticesFloats, indicesCount) {\n        let vertices = new Float32Array(verticesFloats);\n        let indices = new Uint16Array(indicesCount);\n        this.updateMesh(index, vertices, indices);\n    },\n    \n    createQuadData (index, verticesFloats, indicesCount) {\n        this.createData(index, verticesFloats, indicesCount);\n        this.initQuadIndices(this.iDatas[index]);\n    },\n\n    createFlexData (index, verticesFloats, indicesCount, vfmt) {\n        vfmt = vfmt || vfmtPosUvColor;\n        this._flexBuffer = new FlexBuffer(this, index, verticesFloats, indicesCount, vfmt);\n    },\n\n    initQuadIndices(indices) {\n        let count = indices.length / 6;\n        for (let i = 0, idx = 0; i < count; i++) {\n            let vertextID = i * 4;\n            indices[idx++] = vertextID;\n            indices[idx++] = vertextID+1;\n            indices[idx++] = vertextID+2;\n            indices[idx++] = vertextID+1;\n            indices[idx++] = vertextID+3;\n            indices[idx++] = vertextID+2;\n        }\n    }\n})\n\ncc.RenderData = RenderData;\n\n","var SpineBuffer = cc.Class({\n    name: 'cc.SpineBuffer',\n    extends: require('./mesh-buffer'),\n\n    requestStatic (vertexCount, indiceCount) {\n        \n        this.checkAndSwitchBuffer(vertexCount);\n\n        let byteOffset = this.byteOffset + vertexCount * this._vertexBytes;\n        let indiceOffset = this.indiceOffset + indiceCount;\n\n        let byteLength = this._vData.byteLength;\n        let indiceLength = this._iData.length;\n        if (byteOffset > byteLength || indiceOffset > indiceLength) {\n            while (byteLength < byteOffset || indiceLength < indiceOffset) {\n                this._initVDataCount *= 2;\n                this._initIDataCount *= 2;\n\n                byteLength = this._initVDataCount * 4;\n                indiceLength = this._initIDataCount;\n            }\n\n            this._reallocBuffer();\n        }\n\n        let offsetInfo = this._offsetInfo;\n        offsetInfo.vertexOffset = this.vertexOffset;\n        offsetInfo.indiceOffset = this.indiceOffset;\n        offsetInfo.byteOffset = this.byteOffset;\n    },\n\n    adjust (vertexCount, indiceCount) {\n        this.vertexOffset += vertexCount;\n        this.indiceOffset += indiceCount;\n        \n        this.byteOffset = this.byteOffset + vertexCount * this._vertexBytes;\n\n        this._dirty = true;\n    }\n});\n\ncc.SpineBuffer = module.exports = SpineBuffer;","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport gfx from '../../../renderer/gfx';\n\nvar vfmt3D = new gfx.VertexFormat([\n    { name: gfx.ATTR_POSITION, type: gfx.ATTR_TYPE_FLOAT32, num: 3 },\n    { name: gfx.ATTR_UV0, type: gfx.ATTR_TYPE_FLOAT32, num: 2 },\n    { name: gfx.ATTR_COLOR, type: gfx.ATTR_TYPE_UINT8, num: 4, normalize: true },\n]);\nvfmt3D.name = 'vfmt3D';\ngfx.VertexFormat.XYZ_UV_Color = vfmt3D;\n\nvar vfmtPosUvColor = new gfx.VertexFormat([\n    { name: gfx.ATTR_POSITION, type: gfx.ATTR_TYPE_FLOAT32, num: 2 },\n    { name: gfx.ATTR_UV0, type: gfx.ATTR_TYPE_FLOAT32, num: 2 },\n    { name: gfx.ATTR_COLOR, type: gfx.ATTR_TYPE_UINT8, num: 4, normalize: true },\n]);\nvfmtPosUvColor.name = 'vfmtPosUvColor';\ngfx.VertexFormat.XY_UV_Color = vfmtPosUvColor;\n\nvar vfmtPosUvTwoColor = new gfx.VertexFormat([\n    { name: gfx.ATTR_POSITION, type: gfx.ATTR_TYPE_FLOAT32, num: 2 },\n    { name: gfx.ATTR_UV0, type: gfx.ATTR_TYPE_FLOAT32, num: 2 },\n    { name: gfx.ATTR_COLOR, type: gfx.ATTR_TYPE_UINT8, num: 4, normalize: true },\n    { name: gfx.ATTR_COLOR0, type: gfx.ATTR_TYPE_UINT8, num: 4, normalize: true },\n]);\nvfmtPosUvTwoColor.name = 'vfmtPosUvTwoColor';\ngfx.VertexFormat.XY_UV_Two_Color = vfmtPosUvTwoColor;\n\nvar vfmtPosUv = new gfx.VertexFormat([\n    { name: gfx.ATTR_POSITION, type: gfx.ATTR_TYPE_FLOAT32, num: 2 },\n    { name: gfx.ATTR_UV0, type: gfx.ATTR_TYPE_FLOAT32, num: 2 }\n]);\nvfmtPosUv.name = 'vfmtPosUv';\ngfx.VertexFormat.XY_UV = vfmtPosUv;\n\nvar vfmtPosColor = new gfx.VertexFormat([\n    { name: gfx.ATTR_POSITION, type: gfx.ATTR_TYPE_FLOAT32, num: 2 },\n    { name: gfx.ATTR_COLOR, type: gfx.ATTR_TYPE_UINT8, num: 4, normalize: true },\n]);\nvfmtPosColor.name = 'vfmtPosColor';\ngfx.VertexFormat.XY_Color = vfmtPosColor;\n\nvar vfmtPos = new gfx.VertexFormat([\n    { name: gfx.ATTR_POSITION, type: gfx.ATTR_TYPE_FLOAT32, num: 2 },\n]);\nvfmtPos.name = 'vfmtPos';\ngfx.VertexFormat.XY = vfmtPos;\n\nmodule.exports = {\n    vfmt3D,\n    vfmtPosUvColor,\n    vfmtPosUvTwoColor,\n    vfmtPosUv,\n    vfmtPosColor,\n    vfmtPos\n};","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('../platform/CCSys');\n\nvar EXTNAME_RE = /(\\.[^\\.\\/\\?\\\\]*)(\\?.*)?$/;\nvar DIRNAME_RE = /((.*)(\\/|\\\\|\\\\\\\\))?(.*?\\..*$)?/;\nvar NORMALIZE_RE = /[^\\.\\/]+\\/\\.\\.\\//;\n\n/**\n * !#en The module provides utilities for working with file and directory paths\n * !#zh 用于处理文件与目录的路径的模块\n * @class path\n * @static\n */\ncc.path = /** @lends cc.path# */{\n    /**\n     * !#en Join strings to be a path.\n     * !#zh 拼接字符串为 Path\n     * @method join\n     * @example {@link cocos2d/core/utils/CCPath/join.js}\n     * @returns {String}\n     */\n    join: function () {\n        var l = arguments.length;\n        var result = \"\";\n        for (var i = 0; i < l; i++) {\n            result = (result + (result === \"\" ? \"\" : \"/\") + arguments[i]).replace(/(\\/|\\\\\\\\)$/, \"\");\n        }\n        return result;\n    },\n\n    /**\n     * !#en Get the ext name of a path including '.', like '.png'.\n     * !#zh 返回 Path 的扩展名，包括 '.'，例如 '.png'。\n     * @method extname\n     * @example {@link cocos2d/core/utils/CCPath/extname.js}\n     * @param {String} pathStr\n     * @returns {*}\n     */\n    extname: function (pathStr) {\n        var temp = EXTNAME_RE.exec(pathStr);\n        return temp ? temp[1] : '';\n    },\n\n    /**\n     * !#en Get the main name of a file name\n     * !#zh 获取文件名的主名称\n     * @method mainFileName\n     * @param {String} fileName\n     * @returns {String}\n     * @deprecated\n     */\n    mainFileName: function (fileName) {\n        if (fileName) {\n            var idx = fileName.lastIndexOf(\".\");\n            if (idx !== -1)\n                return fileName.substring(0, idx);\n        }\n        return fileName;\n    },\n\n    /**\n     * !#en Get the file name of a file path.\n     * !#zh 获取文件路径的文件名。\n     * @method basename\n     * @example {@link cocos2d/core/utils/CCPath/basename.js}\n     * @param {String} pathStr\n     * @param {String} [extname]\n     * @returns {*}\n     */\n    basename: function (pathStr, extname) {\n        var index = pathStr.indexOf(\"?\");\n        if (index > 0) pathStr = pathStr.substring(0, index);\n        var reg = /(\\/|\\\\)([^\\/\\\\]+)$/g;\n        var result = reg.exec(pathStr.replace(/(\\/|\\\\)$/, \"\"));\n        if (!result) return null;\n        var baseName = result[2];\n        if (extname && pathStr.substring(pathStr.length - extname.length).toLowerCase() === extname.toLowerCase())\n            return baseName.substring(0, baseName.length - extname.length);\n        return baseName;\n    },\n\n    /**\n     * !#en Get dirname of a file path.\n     * !#zh 获取文件路径的目录名。\n     * @method dirname\n     * @example {@link cocos2d/core/utils/CCPath/dirname.js}\n     * @param {String} pathStr\n     * @returns {*}\n     */\n    dirname: function (pathStr) {\n        var temp = DIRNAME_RE.exec(pathStr);\n        return temp ? temp[2] : '';\n    },\n\n    /**\n     * !#en Change extname of a file path.\n     * !#zh 更改文件路径的扩展名。\n     * @method changeExtname\n     * @example {@link cocos2d/core/utils/CCPath/changeExtname.js}\n     * @param {String} pathStr\n     * @param {String} [extname]\n     * @returns {String}\n     */\n    changeExtname: function (pathStr, extname) {\n        extname = extname || \"\";\n        var index = pathStr.indexOf(\"?\");\n        var tempStr = \"\";\n        if (index > 0) {\n            tempStr = pathStr.substring(index);\n            pathStr = pathStr.substring(0, index);\n        }\n        index = pathStr.lastIndexOf(\".\");\n        if (index < 0) return pathStr + extname + tempStr;\n        return pathStr.substring(0, index) + extname + tempStr;\n    },\n    /**\n     * !#en Change file name of a file path.\n     * !#zh 更改文件路径的文件名。\n     * @example {@link cocos2d/core/utils/CCPath/changeBasename.js}\n     * @param {String} pathStr\n     * @param {String} basename\n     * @param {Boolean} [isSameExt]\n     * @returns {String}\n     */\n    changeBasename: function (pathStr, basename, isSameExt) {\n        if (basename.indexOf(\".\") === 0) return this.changeExtname(pathStr, basename);\n        var index = pathStr.indexOf(\"?\");\n        var tempStr = \"\";\n        var ext = isSameExt ? this.extname(pathStr) : \"\";\n        if (index > 0) {\n            tempStr = pathStr.substring(index);\n            pathStr = pathStr.substring(0, index);\n        }\n        index = pathStr.lastIndexOf(\"/\");\n        index = index <= 0 ? 0 : index + 1;\n        return pathStr.substring(0, index) + basename + ext + tempStr;\n    },\n    //todo make public after verification\n    _normalize: function (url) {\n        var oldUrl = url = String(url);\n\n        //removing all ../\n        do {\n            oldUrl = url;\n            url = url.replace(NORMALIZE_RE, \"\");\n        } while (oldUrl.length !== url.length);\n        return url;\n    },\n\n    // The platform-specific file separator. '\\\\' or '/'.\n    sep: (cc.sys.os === cc.sys.OS_WINDOWS ? '\\\\' : '/'),\n\n    // @param {string} path\n    stripSep (path) {\n        return path.replace(/[\\/\\\\]$/, '');\n    }\n};\n\nmodule.exports = cc.path;","/****************************************************************************\n Copyright (c) 2008-2010 Ricardo Quesada\n Copyright (c) 2011-2012 cocos2d-x.org\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos2d-x.org\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in\n all copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * !#en\n * AffineTransform class represent an affine transform matrix. It's composed basically by translation, rotation, scale transformations.<br/>\n * !#zh\n * AffineTransform 类代表一个仿射变换矩阵。它基本上是由平移旋转，缩放转变所组成。<br/>\n * @class AffineTransform\n * @constructor\n * @param {Number} a\n * @param {Number} b\n * @param {Number} c\n * @param {Number} d\n * @param {Number} tx\n * @param {Number} ty\n * @see AffineTransform.create\n */\nvar AffineTransform = function (a, b, c, d, tx, ty) {\n    this.a = a;\n    this.b = b;\n    this.c = c;\n    this.d = d;\n    this.tx = tx;\n    this.ty = ty;\n};\n\n/**\n * !#en Create a AffineTransform object with all contents in the matrix.\n * !#zh 用在矩阵中的所有内容创建一个 AffineTransform 对象。\n * @method create\n * @static\n * @param {Number} a\n * @param {Number} b\n * @param {Number} c\n * @param {Number} d\n * @param {Number} tx\n * @param {Number} ty\n * @return {AffineTransform}\n */\nAffineTransform.create = function (a, b, c, d, tx, ty) {\n    return {a: a, b: b, c: c, d: d, tx: tx, ty: ty};\n};\n\n/**\n * !#en\n * Create a identity transformation matrix: <br/>\n * [ 1, 0, 0, <br/>\n *   0, 1, 0 ]\n * !#zh\n * 单位矩阵：<br/>\n * [ 1, 0, 0, <br/>\n *   0, 1, 0 ]\n *\n * @method identity\n * @static\n * @return {AffineTransform}\n */\nAffineTransform.identity = function () {\n    return {a: 1.0, b: 0.0, c: 0.0, d: 1.0, tx: 0.0, ty: 0.0};\n};\n\n/**\n * !#en Clone a AffineTransform object from the specified transform.\n * !#zh 克隆指定的 AffineTransform 对象。\n * @method clone\n * @static\n * @param {AffineTransform} t\n * @return {AffineTransform}\n */\nAffineTransform.clone = function (t) {\n    return {a: t.a, b: t.b, c: t.c, d: t.d, tx: t.tx, ty: t.ty};\n};\n\n/**\n * !#en\n * Concatenate a transform matrix to another\n * The results are reflected in the out affine transform\n * out = t1 * t2\n * This function is memory free, you should create the output affine transform by yourself and manage its memory.\n * !#zh\n * 拼接两个矩阵，将结果保存到 out 矩阵。这个函数不创建任何内存，你需要先创建 AffineTransform 对象用来存储结果，并作为第一个参数传入函数。\n * out = t1 * t2\n * @method concat\n * @static\n * @param {AffineTransform} out Out object to store the concat result\n * @param {AffineTransform} t1 The first transform object.\n * @param {AffineTransform} t2 The transform object to concatenate.\n * @return {AffineTransform} Out object with the result of concatenation.\n */\nAffineTransform.concat = function (out, t1, t2) {\n    var a = t1.a, b = t1.b, c = t1.c, d = t1.d, tx = t1.tx, ty = t1.ty;\n    out.a = a * t2.a + b * t2.c;\n    out.b = a * t2.b + b * t2.d;\n    out.c = c * t2.a + d * t2.c;\n    out.d = c * t2.b + d * t2.d;\n    out.tx = tx * t2.a + ty * t2.c + t2.tx;\n    out.ty = tx * t2.b + ty * t2.d + t2.ty;\n    return out;\n};\n\n/**\n * !#en Get the invert transform of an AffineTransform object.\n * This function is memory free, you should create the output affine transform by yourself and manage its memory.\n * !#zh 求逆矩阵。这个函数不创建任何内存，你需要先创建 AffineTransform 对象用来存储结果，并作为第一个参数传入函数。\n * @method invert\n * @static\n * @param {AffineTransform} out\n * @param {AffineTransform} t\n * @return {AffineTransform} Out object with inverted result.\n */\nAffineTransform.invert = function (out, t) {\n    var a = t.a, b = t.b, c = t.c, d = t.d;\n    var determinant = 1 / (a * d - b * c);\n    var tx = t.tx, ty = t.ty;\n    out.a = determinant * d;\n    out.b = -determinant * b;\n    out.c = -determinant * c;\n    out.d = determinant * a;\n    out.tx = determinant * (c * ty - d * tx);\n    out.ty = determinant * (b * tx - a * ty);\n    return out;\n};\n\n/**\n * !#en Get an AffineTransform object from a given matrix 4x4.\n * This function is memory free, you should create the output affine transform by yourself and manage its memory.\n * !#zh 从一个 4x4 Matrix 获取 AffineTransform 对象。这个函数不创建任何内存，你需要先创建 AffineTransform 对象用来存储结果，并作为第一个参数传入函数。\n * @method invert\n * @static\n * @param {AffineTransform} out\n * @param {Mat4} mat\n * @return {AffineTransform} Out object with inverted result.\n */\nAffineTransform.fromMat4 = function (out, mat) {\n    let matm = mat.m;\n    out.a = matm[0];\n    out.b = matm[1];\n    out.c = matm[4];\n    out.d = matm[5];\n    out.tx = matm[12];\n    out.ty = matm[13];\n    return out;\n};\n\n/**\n * !#en Apply the affine transformation on a point.\n * This function is memory free, you should create the output Vec2 by yourself and manage its memory.\n * !#zh 对一个点应用矩阵变换。这个函数不创建任何内存，你需要先创建一个 Vec2 对象用来存储结果，并作为第一个参数传入函数。\n * @method transformVec2\n * @static\n * @param {Vec2} out The output point to store the result\n * @param {Vec2|Number} point Point to apply transform or x.\n * @param {AffineTransform|Number} transOrY transform matrix or y.\n * @param {AffineTransform} [t] transform matrix.\n * @return {Vec2}\n */\nAffineTransform.transformVec2 = function (out, point, transOrY, t) {\n    var x, y;\n    if (t === undefined) {\n        t = transOrY;\n        x = point.x;\n        y = point.y;\n    } else {\n        x = point;\n        y = transOrY;\n    }\n    out.x = t.a * x + t.c * y + t.tx;\n    out.y = t.b * x + t.d * y + t.ty;\n    return out;\n};\n\n/**\n * !#en Apply the affine transformation on a size.\n * This function is memory free, you should create the output Size by yourself and manage its memory.\n * !#zh 应用仿射变换矩阵到 Size 上。这个函数不创建任何内存，你需要先创建一个 Size 对象用来存储结果，并作为第一个参数传入函数。\n * @method transformSize\n * @static\n * @param {Size} out The output point to store the result\n * @param {Size} size\n * @param {AffineTransform} t\n * @return {Size}\n */\nAffineTransform.transformSize = function (out, size, t) {\n    out.width = t.a * size.width + t.c * size.height;\n    out.height = t.b * size.width + t.d * size.height;\n    return out;\n};\n\n/**\n * !#en Apply the affine transformation on a rect.\n * This function is memory free, you should create the output Rect by yourself and manage its memory.\n * !#zh 应用仿射变换矩阵到 Rect 上。这个函数不创建任何内存，你需要先创建一个 Rect 对象用来存储结果，并作为第一个参数传入函数。\n * @method transformRect\n * @static\n * @param {Rect} out\n * @param {Rect} rect\n * @param {AffineTransform} anAffineTransform\n * @return {Rect}\n */\nAffineTransform.transformRect = function(out, rect, t){\n    var ol = rect.x;\n    var ob = rect.y;\n    var or = ol + rect.width;\n    var ot = ob + rect.height;\n    var lbx = t.a * ol + t.c * ob + t.tx;\n    var lby = t.b * ol + t.d * ob + t.ty;\n    var rbx = t.a * or + t.c * ob + t.tx;\n    var rby = t.b * or + t.d * ob + t.ty;\n    var ltx = t.a * ol + t.c * ot + t.tx;\n    var lty = t.b * ol + t.d * ot + t.ty;\n    var rtx = t.a * or + t.c * ot + t.tx;\n    var rty = t.b * or + t.d * ot + t.ty;\n\n    var minX = Math.min(lbx, rbx, ltx, rtx);\n    var maxX = Math.max(lbx, rbx, ltx, rtx);\n    var minY = Math.min(lby, rby, lty, rty);\n    var maxY = Math.max(lby, rby, lty, rty);\n\n    out.x = minX;\n    out.y = minY;\n    out.width = maxX - minX;\n    out.height = maxY - minY;\n    return out;\n};\n\n/**\n * !#en Apply the affine transformation on a rect, and truns to an Oriented Bounding Box.\n * This function is memory free, you should create the output vectors by yourself and manage their memory.\n * !#zh 应用仿射变换矩阵到 Rect 上, 并转换为有向包围盒。这个函数不创建任何内存，你需要先创建包围盒的四个 Vector 对象用来存储结果，并作为前四个参数传入函数。\n * @method transformObb\n * @static\n * @param {Vec2} out_bl\n * @param {Vec2} out_tl\n * @param {Vec2} out_tr\n * @param {Vec2} out_br\n * @param {Rect} rect\n * @param {AffineTransform} anAffineTransform\n */\nAffineTransform.transformObb = function (out_bl, out_tl, out_tr, out_br, rect, anAffineTransform) {\n    var x = rect.x;\n    var y = rect.y;\n    var width = rect.width;\n    var height = rect.height;\n\n    var tx = anAffineTransform.a * x + anAffineTransform.c * y + anAffineTransform.tx;\n    var ty = anAffineTransform.b * x + anAffineTransform.d * y + anAffineTransform.ty;\n    var xa = anAffineTransform.a * width;\n    var xb = anAffineTransform.b * width;\n    var yc = anAffineTransform.c * height;\n    var yd = anAffineTransform.d * height;\n\n    out_tl.x = tx;\n    out_tl.y = ty;\n    out_tr.x = xa + tx;\n    out_tr.y = xb + ty;\n    out_bl.x = yc + tx;\n    out_bl.y = yd + ty;\n    out_br.x = xa + yc + tx;\n    out_br.y = xb + yd + ty;\n};\n\ncc.AffineTransform = module.exports = AffineTransform;","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst Flags = require('../platform/CCObject').Flags;\nconst misc = require('./misc');\nconst js = require('../platform/js');\nconst IdGenerater = require('../platform/id-generater');\nconst eventManager = require('../event-manager');\nconst RenderFlow = require('../renderer/render-flow');\n\nconst Destroying = Flags.Destroying;\nconst DontDestroy = Flags.DontDestroy;\nconst Deactivating = Flags.Deactivating; \n\nconst CHILD_ADDED = 'child-added';\nconst CHILD_REMOVED = 'child-removed';\n\nvar idGenerater = new IdGenerater('Node');\n\nfunction getConstructor(typeOrClassName) {\n    if (!typeOrClassName) {\n        cc.errorID(3804);\n        return null;\n    }\n    if (typeof typeOrClassName === 'string') {\n        return js.getClassByName(typeOrClassName);\n    }\n\n    return typeOrClassName;\n}\n\nfunction findComponent(node, constructor) {\n    if (constructor._sealed) {\n        for (let i = 0; i < node._components.length; ++i) {\n            let comp = node._components[i];\n            if (comp.constructor === constructor) {\n                return comp;\n            }\n        }\n    }\n    else {\n        for (let i = 0; i < node._components.length; ++i) {\n            let comp = node._components[i];\n            if (comp instanceof constructor) {\n                return comp;\n            }\n        }\n    }\n    return null;\n}\n\nfunction findComponents(node, constructor, components) {\n    if (constructor._sealed) {\n        for (let i = 0; i < node._components.length; ++i) {\n            let comp = node._components[i];\n            if (comp.constructor === constructor) {\n                components.push(comp);\n            }\n        }\n    }\n    else {\n        for (let i = 0; i < node._components.length; ++i) {\n            let comp = node._components[i];\n            if (comp instanceof constructor) {\n                components.push(comp);\n            }\n        }\n    }\n}\n\nfunction findChildComponent(children, constructor) {\n    for (var i = 0; i < children.length; ++i) {\n        var node = children[i];\n        var comp = findComponent(node, constructor);\n        if (comp) {\n            return comp;\n        }\n        else if (node._children.length > 0) {\n            comp = findChildComponent(node._children, constructor);\n            if (comp) {\n                return comp;\n            }\n        }\n    }\n    return null;\n}\n\nfunction findChildComponents(children, constructor, components) {\n    for (var i = 0; i < children.length; ++i) {\n        var node = children[i];\n        findComponents(node, constructor, components);\n        if (node._children.length > 0) {\n            findChildComponents(node._children, constructor, components);\n        }\n    }\n}\n\n/**\n * A base node for CCNode, it will:\n * - maintain scene hierarchy and active logic\n * - notifications if some properties changed\n * - define some interfaces shares between CCNode\n * - define machanisms for Enity Component Systems\n * - define prefab and serialize functions\n *\n * @class _BaseNode\n * @extends Object\n * @uses EventTarget\n * @constructor\n * @param {String} [name]\n * @private\n */\nvar BaseNode = cc.Class({\n    name: 'cc._BaseNode',\n    extends: cc.Object,\n\n    properties: {\n        // SERIALIZABLE\n\n        _parent: null,\n        _children: [],\n\n        _active: true,\n\n        /**\n         * @property _components\n         * @type {Component[]}\n         * @default []\n         * @readOnly\n         * @private\n         */\n        _components: [],\n\n        /**\n         * The PrefabInfo object\n         * @property _prefab\n         * @type {PrefabInfo}\n         * @private\n         */\n        _prefab: null,\n\n        /**\n         * If true, the node is an persist node which won't be destroyed during scene transition.\n         * If false, the node will be destroyed automatically when loading a new scene. Default is false.\n         * @property _persistNode\n         * @type {Boolean}\n         * @default false\n         * @private\n         */\n        _persistNode: {\n            get () {\n                return (this._objFlags & DontDestroy) > 0;\n            },\n            set (value) {\n                if (value) {\n                    this._objFlags |= DontDestroy;\n                }\n                else {\n                    this._objFlags &= ~DontDestroy;\n                }\n            }\n        },\n\n        // API\n\n        /**\n         * !#en Name of node.\n         * !#zh 该节点名称。\n         * @property name\n         * @type {String}\n         * @example\n         * node.name = \"New Node\";\n         * cc.log(\"Node Name: \" + node.name);\n         */\n        name: {\n            get () {\n                return this._name;\n            },\n            set (value) {\n                if (CC_DEV && value.indexOf('/') !== -1) {\n                    cc.errorID(1632);\n                    return;\n                }\n                this._name = value;\n                if (CC_JSB && CC_NATIVERENDERER) {\n                    this._proxy.setName(this._name);\n                }\n            },\n        },\n\n        /**\n         * !#en The uuid for editor, will be stripped before building project.\n         * !#zh 主要用于编辑器的 uuid，在编辑器下可用于持久化存储，在项目构建之后将变成自增的 id。\n         * @property uuid\n         * @type {String}\n         * @readOnly\n         * @example\n         * cc.log(\"Node Uuid: \" + node.uuid);\n         */\n        uuid: {\n            get () {\n                return this._id;\n            }\n        },\n\n        /**\n         * !#en All children nodes.\n         * !#zh 节点的所有子节点。\n         * @property children\n         * @type {Node[]}\n         * @readOnly\n         * @example\n         * var children = node.children;\n         * for (var i = 0; i < children.length; ++i) {\n         *     cc.log(\"Node: \" + children[i]);\n         * }\n         */\n        children: {\n            get () {\n                return this._children;\n            }\n        },\n\n        /**\n         * !#en All children nodes.\n         * !#zh 节点的子节点数量。\n         * @property childrenCount\n         * @type {Number}\n         * @readOnly\n         * @example\n         * var count = node.childrenCount;\n         * cc.log(\"Node Children Count: \" + count);\n         */\n        childrenCount: {\n            get () {\n                return this._children.length;\n            }\n        },\n\n        /**\n         * !#en\n         * The local active state of this node.<br/>\n         * Note that a Node may be inactive because a parent is not active, even if this returns true.<br/>\n         * Use {{#crossLink \"Node/activeInHierarchy:property\"}}{{/crossLink}} if you want to check if the Node is actually treated as active in the scene.\n         * !#zh\n         * 当前节点的自身激活状态。<br/>\n         * 值得注意的是，一个节点的父节点如果不被激活，那么即使它自身设为激活，它仍然无法激活。<br/>\n         * 如果你想检查节点在场景中实际的激活状态可以使用 {{#crossLink \"Node/activeInHierarchy:property\"}}{{/crossLink}}。\n         * @property active\n         * @type {Boolean}\n         * @default true\n         * @example\n         * node.active = false;\n         */\n        active: {\n            get () {\n                return this._active;\n            },\n            set (value) {\n                value = !!value;\n                if (this._active !== value) {\n                    this._active = value;\n                    var parent = this._parent;\n                    if (parent) {\n                        var couldActiveInScene = parent._activeInHierarchy;\n                        if (couldActiveInScene) {\n                            cc.director._nodeActivator.activateNode(this, value);\n                        }\n                    }\n                }\n            }\n        },\n\n        /**\n         * !#en Indicates whether this node is active in the scene.\n         * !#zh 表示此节点是否在场景中激活。\n         * @property activeInHierarchy\n         * @type {Boolean}\n         * @example\n         * cc.log(\"activeInHierarchy: \" + node.activeInHierarchy);\n         */\n        activeInHierarchy: {\n            get () {\n                return this._activeInHierarchy;\n            }\n        },\n    },\n\n    /**\n     * @method constructor\n     * @param {String} [name]\n     */\n    ctor (name) {\n        this._name = name !== undefined ? name : 'New Node';\n        this._activeInHierarchy = false;\n        this._id = CC_EDITOR ? Editor.Utils.UuidUtils.uuid() : idGenerater.getNewId();\n\n        cc.director._scheduler && cc.director._scheduler.enableForTarget(this);\n\n        /**\n         * Register all related EventTargets,\n         * all event callbacks will be removed in _onPreDestroy\n         * @property __eventTargets\n         * @type {EventTarget[]}\n         * @private\n         */\n        this.__eventTargets = [];\n    },\n    /** \n     * !#en The parent of the node.\n     * !#zh 该节点的父节点。\n     * @property {Node} parent\n     * @example \n     * cc.log(\"Node Parent: \" + node.parent);\n     */\n\n    /**\n     * !#en Get parent of the node.\n     * !#zh 获取该节点的父节点。\n     * @method getParent\n     * @return {Node}\n     * @example\n     * var parent = this.node.getParent();\n     */\n    getParent () {\n        return this._parent;\n    },\n\n    /**\n     * !#en Set parent of the node.\n     * !#zh 设置该节点的父节点。\n     * @method setParent\n     * @param {Node} value\n     * @example\n     * node.setParent(newNode);\n     */\n    setParent (value) {\n        if (this._parent === value) {\n            return;\n        }\n        if (CC_EDITOR && cc.engine && !cc.engine.isPlaying) {\n            if (_Scene.DetectConflict.beforeAddChild(this, value)) {\n                return;\n            }\n        }\n        var oldParent = this._parent;\n        if (CC_DEBUG && oldParent && (oldParent._objFlags & Deactivating)) {\n            cc.errorID(3821);\n        }\n        this._parent = value || null;\n\n        this._onSetParent(value);\n\n        if (value) {\n            if (CC_DEBUG && (value._objFlags & Deactivating)) {\n                cc.errorID(3821);\n            }\n            eventManager._setDirtyForNode(this);\n            value._children.push(this);\n            value.emit && value.emit(CHILD_ADDED, this);\n            value._renderFlag |= RenderFlow.FLAG_CHILDREN;\n        }\n        if (oldParent) {\n            if (!(oldParent._objFlags & Destroying)) {\n                var removeAt = oldParent._children.indexOf(this);\n                if (CC_DEV && removeAt < 0) {\n                    return cc.errorID(1633);\n                }\n                oldParent._children.splice(removeAt, 1);\n                oldParent.emit && oldParent.emit(CHILD_REMOVED, this);\n                this._onHierarchyChanged(oldParent);\n\n                if (oldParent._children.length === 0) {\n                    oldParent._renderFlag &= ~RenderFlow.FLAG_CHILDREN;\n                }\n            }\n        }\n        else if (value) {\n            this._onHierarchyChanged(null);\n        }\n    },\n\n    // ABSTRACT INTERFACES\n\n    /**\n     * !#en\n     * Properties configuration function <br/>\n     * All properties in attrs will be set to the node, <br/>\n     * when the setter of the node is available, <br/>\n     * the property will be set via setter function.<br/>\n     * !#zh 属性配置函数。在 attrs 的所有属性将被设置为节点属性。\n     * @method attr\n     * @param {Object} attrs - Properties to be set to node\n     * @example\n     * var attrs = { key: 0, num: 100 };\n     * node.attr(attrs);\n     */\n    attr (attrs) {\n        js.mixin(this, attrs);\n    },\n\n    // composition: GET\n\n    /**\n     * !#en Returns a child from the container given its uuid.\n     * !#zh 通过 uuid 获取节点的子节点。\n     * @method getChildByUuid\n     * @param {String} uuid - The uuid to find the child node.\n     * @return {Node} a Node whose uuid equals to the input parameter\n     * @example\n     * var child = node.getChildByUuid(uuid);\n     */\n    getChildByUuid (uuid) {\n        if (!uuid) {\n            cc.log(\"Invalid uuid\");\n            return null;\n        }\n\n        var locChildren = this._children;\n        for (var i = 0, len = locChildren.length; i < len; i++) {\n            if (locChildren[i]._id === uuid)\n                return locChildren[i];\n        }\n        return null;\n    },\n\n    /**\n     * !#en Returns a child from the container given its name.\n     * !#zh 通过名称获取节点的子节点。\n     * @method getChildByName\n     * @param {String} name - A name to find the child node.\n     * @return {Node} a CCNode object whose name equals to the input parameter\n     * @example\n     * var child = node.getChildByName(\"Test Node\");\n     */\n    getChildByName (name) {\n        if (!name) {\n            cc.log(\"Invalid name\");\n            return null;\n        }\n\n        var locChildren = this._children;\n        for (var i = 0, len = locChildren.length; i < len; i++) {\n            if (locChildren[i]._name === name)\n                return locChildren[i];\n        }\n        return null;\n    },\n\n    // composition: ADD\n\n    addChild (child) {\n\n        if (CC_DEV && !(child instanceof cc._BaseNode)) {\n            return cc.errorID(1634, cc.js.getClassName(child));\n        }\n        cc.assertID(child, 1606);\n        cc.assertID(child._parent === null, 1605);\n\n        // invokes the parent setter\n        child.setParent(this);\n\n    },\n\n    /**\n     * !#en\n     * Inserts a child to the node at a specified index.\n     * !#zh\n     * 插入子节点到指定位置\n     * @method insertChild\n     * @param {Node} child - the child node to be inserted\n     * @param {Number} siblingIndex - the sibling index to place the child in\n     * @example\n     * node.insertChild(child, 2);\n     */\n    insertChild (child, siblingIndex) {\n        child.parent = this;\n        child.setSiblingIndex(siblingIndex);\n    },\n\n    // HIERARCHY METHODS\n\n    /**\n     * !#en Get the sibling index.\n     * !#zh 获取同级索引。\n     * @method getSiblingIndex\n     * @return {Number}\n     * @example\n     * var index = node.getSiblingIndex();\n     */\n    getSiblingIndex () {\n        if (this._parent) {\n            return this._parent._children.indexOf(this);\n        }\n        else {\n            return 0;\n        }\n    },\n\n    /**\n     * !#en Set the sibling index of this node.\n     * !#zh 设置节点同级索引。\n     * @method setSiblingIndex\n     * @param {Number} index\n     * @example\n     * node.setSiblingIndex(1);\n     */\n    setSiblingIndex (index) {\n        if (!this._parent) {\n            return;\n        }\n        if (this._parent._objFlags & Deactivating) {\n            cc.errorID(3821);\n            return;\n        }\n        var siblings = this._parent._children;\n        index = index !== -1 ? index : siblings.length - 1;\n        var oldIndex = siblings.indexOf(this);\n        if (index !== oldIndex) {\n            siblings.splice(oldIndex, 1);\n            if (index < siblings.length) {\n                siblings.splice(index, 0, this);\n            }\n            else {\n                siblings.push(this);\n            }\n            this._onSiblingIndexChanged && this._onSiblingIndexChanged(index);\n        }\n    },\n\n    /**\n     * !#en Walk though the sub children tree of the current node.\n     * Each node, including the current node, in the sub tree will be visited two times, before all children and after all children.\n     * This function call is not recursive, it's based on stack.\n     * Please don't walk any other node inside the walk process.\n     * !#zh 遍历该节点的子树里的所有节点并按规则执行回调函数。\n     * 对子树中的所有节点，包含当前节点，会执行两次回调，prefunc 会在访问它的子节点之前调用，postfunc 会在访问所有子节点之后调用。\n     * 这个函数的实现不是基于递归的，而是基于栈展开递归的方式。\n     * 请不要在 walk 过程中对任何其他的节点嵌套执行 walk。\n     * @method walk\n     * @param {Function} prefunc The callback to process node when reach the node for the first time\n     * @param {_BaseNode} prefunc.target The current visiting node\n     * @param {Function} postfunc The callback to process node when re-visit the node after walked all children in its sub tree\n     * @param {_BaseNode} postfunc.target The current visiting node\n     * @example\n     * node.walk(function (target) {\n     *     console.log('Walked through node ' + target.name + ' for the first time');\n     * }, function (target) {\n     *     console.log('Walked through node ' + target.name + ' after walked all children in its sub tree');\n     * });\n     */\n    walk (prefunc, postfunc) {\n        var BaseNode = cc._BaseNode;\n        var index = 1;\n        var children, child, curr, i, afterChildren;\n        var stack = BaseNode._stacks[BaseNode._stackId];\n        if (!stack) {\n            stack = [];\n            BaseNode._stacks.push(stack);\n        }\n        BaseNode._stackId++;\n\n        stack.length = 0;\n        stack[0] = this;\n        var parent = null;\n        afterChildren = false;\n        while (index) {\n            index--;\n            curr = stack[index];\n            if (!curr) {\n                continue;\n            }\n            if (!afterChildren && prefunc) {\n                // pre call\n                prefunc(curr);\n            }\n            else if (afterChildren && postfunc) {\n                // post call\n                postfunc(curr);\n            }\n            \n            // Avoid memory leak\n            stack[index] = null;\n            // Do not repeatly visit child tree, just do post call and continue walk\n            if (afterChildren) {\n                afterChildren = false;\n            }\n            else {\n                // Children not proceeded and has children, proceed to child tree\n                if (curr._children.length > 0) {\n                    parent = curr;\n                    children = curr._children;\n                    i = 0;\n                    stack[index] = children[i];\n                    index++;\n                }\n                // No children, then repush curr to be walked for post func\n                else {\n                    stack[index] = curr;\n                    index++;\n                    afterChildren = true;\n                }\n                continue;\n            }\n            // curr has no sub tree, so look into the siblings in parent children\n            if (children) {\n                i++;\n                // Proceed to next sibling in parent children\n                if (children[i]) {\n                    stack[index] = children[i];\n                    index++;\n                }\n                // No children any more in this sub tree, go upward\n                else if (parent) {\n                    stack[index] = parent;\n                    index++;\n                    // Setup parent walk env\n                    afterChildren = true;\n                    if (parent._parent) {\n                        children = parent._parent._children;\n                        i = children.indexOf(parent);\n                        parent = parent._parent;\n                    }\n                    else {\n                        // At root\n                        parent = null;\n                        children = null;\n                    }\n\n                    // ERROR\n                    if (i < 0) {\n                        break;\n                    }\n                }\n            }\n        }\n        stack.length = 0;\n        BaseNode._stackId--;\n    },\n\n    cleanup () {\n\n    },\n\n    /**\n     * !#en\n     * Remove itself from its parent node. If cleanup is `true`, then also remove all events and actions. <br/>\n     * If the cleanup parameter is not passed, it will force a cleanup, so it is recommended that you always pass in the `false` parameter when calling this API.<br/>\n     * If the node orphan, then nothing happens.\n     * !#zh\n     * 从父节点中删除该节点。如果不传入 cleanup 参数或者传入 `true`，那么这个节点上所有绑定的事件、action 都会被删除。<br/>\n     * 因此建议调用这个 API 时总是传入 `false` 参数。<br/>\n     * 如果这个节点是一个孤节点，那么什么都不会发生。\n     * @method removeFromParent\n     * @param {Boolean} [cleanup=true] - true if all actions and callbacks on this node should be removed, false otherwise.\n     * @see cc.Node#removeFromParentAndCleanup\n     * @example\n     * node.removeFromParent();\n     * node.removeFromParent(false);\n     */\n    removeFromParent (cleanup) {\n        if (this._parent) {\n            if (cleanup === undefined)\n                cleanup = true;\n            this._parent.removeChild(this, cleanup);\n        }\n    },\n\n    /**\n     * !#en\n     * Removes a child from the container. It will also cleanup all running actions depending on the cleanup parameter. </p>\n     * If the cleanup parameter is not passed, it will force a cleanup. <br/>\n     * \"remove\" logic MUST only be on this method  <br/>\n     * If a class wants to extend the 'removeChild' behavior it only needs <br/>\n     * to override this method.\n     * !#zh\n     * 移除节点中指定的子节点，是否需要清理所有正在运行的行为取决于 cleanup 参数。<br/>\n     * 如果 cleanup 参数不传入，默认为 true 表示清理。<br/>\n     * @method removeChild\n     * @param {Node} child - The child node which will be removed.\n     * @param {Boolean} [cleanup=true] - true if all running actions and callbacks on the child node will be cleanup, false otherwise.\n     * @example\n     * node.removeChild(newNode);\n     * node.removeChild(newNode, false);\n     */\n    removeChild (child, cleanup) {\n        if (this._children.indexOf(child) > -1) {\n            // If you don't do cleanup, the child's actions will not get removed and the\n            if (cleanup || cleanup === undefined) {\n                child.cleanup();\n            }\n            // invoke the parent setter\n            child.parent = null;\n        }\n    },\n\n    /**\n     * !#en\n     * Removes all children from the container and do a cleanup all running actions depending on the cleanup parameter. <br/>\n     * If the cleanup parameter is not passed, it will force a cleanup.\n     * !#zh\n     * 移除节点所有的子节点，是否需要清理所有正在运行的行为取决于 cleanup 参数。<br/>\n     * 如果 cleanup 参数不传入，默认为 true 表示清理。\n     * @method removeAllChildren\n     * @param {Boolean} [cleanup=true] - true if all running actions on all children nodes should be cleanup, false otherwise.\n     * @example\n     * node.removeAllChildren();\n     * node.removeAllChildren(false);\n     */\n    removeAllChildren (cleanup) {\n        // not using detachChild improves speed here\n        var children = this._children;\n        if (cleanup === undefined)\n            cleanup = true;\n        for (var i = children.length - 1; i >= 0; i--) {\n            var node = children[i];\n            if (node) {\n                // If you don't do cleanup, the node's actions will not get removed and the\n                if (cleanup)\n                    node.cleanup();\n\n                node.parent = null;\n            }\n        }\n        this._children.length = 0;\n    },\n\n    /**\n     * !#en Is this node a child of the given node?\n     * !#zh 是否是指定节点的子节点？\n     * @method isChildOf\n     * @param {Node} parent\n     * @return {Boolean} - Returns true if this node is a child, deep child or identical to the given node.\n     * @example\n     * node.isChildOf(newNode);\n     */\n    isChildOf (parent) {\n        var child = this;\n        do {\n            if (child === parent) {\n                return true;\n            }\n            child = child._parent;\n        }\n        while (child);\n        return false;\n    },\n\n    // COMPONENT\n\n    /**\n     * !#en\n     * Returns the component of supplied type if the node has one attached, null if it doesn't.<br/>\n     * You can also get component in the node by passing in the name of the script.\n     * !#zh\n     * 获取节点上指定类型的组件，如果节点有附加指定类型的组件，则返回，如果没有则为空。<br/>\n     * 传入参数也可以是脚本的名称。\n     * @method getComponent\n     * @param {Function|String} typeOrClassName\n     * @return {Component}\n     * @example\n     * // get sprite component\n     * var sprite = node.getComponent(cc.Sprite);\n     * // get custom test class\n     * var test = node.getComponent(\"Test\");\n     * @typescript\n     * getComponent<T extends Component>(type: {prototype: T}): T\n     * getComponent(className: string): any\n     */\n    getComponent (typeOrClassName) {\n        var constructor = getConstructor(typeOrClassName);\n        if (constructor) {\n            return findComponent(this, constructor);\n        }\n        return null;\n    },\n\n    /**\n     * !#en Returns all components of supplied type in the node.\n     * !#zh 返回节点上指定类型的所有组件。\n     * @method getComponents\n     * @param {Function|String} typeOrClassName\n     * @return {Component[]}\n     * @example\n     * var sprites = node.getComponents(cc.Sprite);\n     * var tests = node.getComponents(\"Test\");\n     * @typescript\n     * getComponents<T extends Component>(type: {prototype: T}): T[]\n     * getComponents(className: string): any[]\n     */\n    getComponents (typeOrClassName) {\n        var constructor = getConstructor(typeOrClassName), components = [];\n        if (constructor) {\n            findComponents(this, constructor, components);\n        }\n        return components;\n    },\n\n    /**\n     * !#en Returns the component of supplied type in any of its children using depth first search.\n     * !#zh 递归查找所有子节点中第一个匹配指定类型的组件。\n     * @method getComponentInChildren\n     * @param {Function|String} typeOrClassName\n     * @return {Component}\n     * @example\n     * var sprite = node.getComponentInChildren(cc.Sprite);\n     * var Test = node.getComponentInChildren(\"Test\");\n     * @typescript\n     * getComponentInChildren<T extends Component>(type: {prototype: T}): T\n     * getComponentInChildren(className: string): any\n     */\n    getComponentInChildren (typeOrClassName) {\n        var constructor = getConstructor(typeOrClassName);\n        if (constructor) {\n            return findChildComponent(this._children, constructor);\n        }\n        return null;\n    },\n\n    /**\n     * !#en Returns all components of supplied type in self or any of its children.\n     * !#zh 递归查找自身或所有子节点中指定类型的组件\n     * @method getComponentsInChildren\n     * @param {Function|String} typeOrClassName\n     * @return {Component[]}\n     * @example\n     * var sprites = node.getComponentsInChildren(cc.Sprite);\n     * var tests = node.getComponentsInChildren(\"Test\");\n     * @typescript\n     * getComponentsInChildren<T extends Component>(type: {prototype: T}): T[]\n     * getComponentsInChildren(className: string): any[]\n     */\n    getComponentsInChildren (typeOrClassName) {\n        var constructor = getConstructor(typeOrClassName), components = [];\n        if (constructor) {\n            findComponents(this, constructor, components);\n            findChildComponents(this._children, constructor, components);\n        }\n        return components;\n    },\n\n    _checkMultipleComp: CC_EDITOR && function (ctor) {\n        var existing = this.getComponent(ctor._disallowMultiple);\n        if (existing) {\n            if (existing.constructor === ctor) {\n                cc.errorID(3805, js.getClassName(ctor), this._name);\n            }\n            else {\n                cc.errorID(3806, js.getClassName(ctor), this._name, js.getClassName(existing));\n            }\n            return false;\n        }\n        return true;\n    },\n\n    /**\n     * !#en Adds a component class to the node. You can also add component to node by passing in the name of the script.\n     * !#zh 向节点添加一个指定类型的组件类，你还可以通过传入脚本的名称来添加组件。\n     * @method addComponent\n     * @param {Function|String} typeOrClassName - The constructor or the class name of the component to add\n     * @return {Component} - The newly added component\n     * @example\n     * var sprite = node.addComponent(cc.Sprite);\n     * var test = node.addComponent(\"Test\");\n     * @typescript\n     * addComponent<T extends Component>(type: {new(): T}): T\n     * addComponent(className: string): any\n     */\n    addComponent (typeOrClassName) {\n        if (CC_EDITOR && (this._objFlags & Destroying)) {\n            cc.error('isDestroying');\n            return null;\n        }\n\n        // get component\n\n        var constructor;\n        if (typeof typeOrClassName === 'string') {\n            constructor = js.getClassByName(typeOrClassName);\n            if (!constructor) {\n                cc.errorID(3807, typeOrClassName);\n                if (cc._RFpeek()) {\n                    cc.errorID(3808, typeOrClassName);\n                }\n                return null;\n            }\n        }\n        else {\n            if (!typeOrClassName) {\n                cc.errorID(3804);\n                return null;\n            }\n            constructor = typeOrClassName;\n        }\n\n        // check component\n\n        if (typeof constructor !== 'function') {\n            cc.errorID(3809);\n            return null;\n        }\n        if (!js.isChildClassOf(constructor, cc.Component)) {\n            cc.errorID(3810);\n            return null;\n        }\n\n        if (CC_EDITOR && constructor._disallowMultiple) {\n            if (!this._checkMultipleComp(constructor)) {\n                return null;\n            }\n        }\n\n        // check requirement\n\n        var ReqComp = constructor._requireComponent;\n        if (ReqComp && !this.getComponent(ReqComp)) {\n            var depended = this.addComponent(ReqComp);\n            if (!depended) {\n                // depend conflicts\n                return null;\n            }\n        }\n\n        //// check conflict\n        //\n        //if (CC_EDITOR && !_Scene.DetectConflict.beforeAddComponent(this, constructor)) {\n        //    return null;\n        //}\n\n        //\n\n        var component = new constructor();\n        component.node = this;\n        this._components.push(component);\n        if ((CC_EDITOR || CC_TEST) && cc.engine && (this._id in cc.engine.attachedObjsForEditor)) {\n            cc.engine.attachedObjsForEditor[component._id] = component;\n        }\n        if (this._activeInHierarchy) {\n            cc.director._nodeActivator.activateComp(component);\n        }\n\n        return component;\n    },\n\n    /**\n     * This api should only used by undo system\n     * @method _addComponentAt\n     * @param {Component} comp\n     * @param {Number} index\n     * @private\n     */\n    _addComponentAt: CC_EDITOR && function (comp, index) {\n        if (this._objFlags & Destroying) {\n            return cc.error('isDestroying');\n        }\n        if (!(comp instanceof cc.Component)) {\n            return cc.errorID(3811);\n        }\n        if (index > this._components.length) {\n            return cc.errorID(3812);\n        }\n\n        // recheck attributes because script may changed\n        var ctor = comp.constructor;\n        if (ctor._disallowMultiple) {\n            if (!this._checkMultipleComp(ctor)) {\n                return;\n            }\n        }\n        var ReqComp = ctor._requireComponent;\n        if (ReqComp && !this.getComponent(ReqComp)) {\n            if (index === this._components.length) {\n                // If comp should be last component, increase the index because required component added\n                ++index;\n            }\n            var depended = this.addComponent(ReqComp);\n            if (!depended) {\n                // depend conflicts\n                return null;\n            }\n        }\n\n        comp.node = this;\n        this._components.splice(index, 0, comp);\n        if ((CC_EDITOR || CC_TEST) && cc.engine && (this._id in cc.engine.attachedObjsForEditor)) {\n            cc.engine.attachedObjsForEditor[comp._id] = comp;\n        }\n        if (this._activeInHierarchy) {\n            cc.director._nodeActivator.activateComp(comp);\n        }\n    },\n\n    /**\n     * !#en\n     * Removes a component identified by the given name or removes the component object given.\n     * You can also use component.destroy() if you already have the reference.\n     * !#zh\n     * 删除节点上的指定组件，传入参数可以是一个组件构造函数或组件名，也可以是已经获得的组件引用。\n     * 如果你已经获得组件引用，你也可以直接调用 component.destroy()\n     * @method removeComponent\n     * @param {String|Function|Component} component - The need remove component.\n     * @deprecated please destroy the component to remove it.\n     * @example\n     * node.removeComponent(cc.Sprite);\n     * var Test = require(\"Test\");\n     * node.removeComponent(Test);\n     */\n    removeComponent (component) {\n        if (!component) {\n            cc.errorID(3813);\n            return;\n        }\n        if (!(component instanceof cc.Component)) {\n            component = this.getComponent(component);\n        }\n        if (component) {\n            component.destroy();\n        }\n    },\n\n    /**\n     * @method _getDependComponent\n     * @param {Component} depended\n     * @return {Component}\n     * @private\n     */\n    _getDependComponent: CC_EDITOR && function (depended) {\n        for (var i = 0; i < this._components.length; i++) {\n            var comp = this._components[i];\n            if (comp !== depended && comp.isValid && !cc.Object._willDestroy(comp)) {\n                var depend = comp.constructor._requireComponent;\n                if (depend && depended instanceof depend) {\n                    return comp;\n                }\n            }\n        }\n        return null;\n    },\n\n    // do remove component, only used internally\n    _removeComponent (component) {\n        if (!component) {\n            cc.errorID(3814);\n            return;\n        }\n\n        if (!(this._objFlags & Destroying)) {\n            var i = this._components.indexOf(component);\n            if (i !== -1) {\n                this._components.splice(i, 1);\n                if ((CC_EDITOR || CC_TEST) && cc.engine) {\n                    delete cc.engine.attachedObjsForEditor[component._id];\n                }\n            }\n            else if (component.node !== this) {\n                cc.errorID(3815);\n            }\n        }\n    },\n\n    destroy () {\n        if (cc.Object.prototype.destroy.call(this)) {\n            this.active = false;\n        }\n    },\n\n    /**\n     * !#en\n     * Destroy all children from the node, and release all their own references to other objects.<br/>\n     * Actual destruct operation will delayed until before rendering.\n     * !#zh\n     * 销毁所有子节点，并释放所有它们对其它对象的引用。<br/>\n     * 实际销毁操作会延迟到当前帧渲染前执行。\n     * @method destroyAllChildren\n     * @example\n     * node.destroyAllChildren();\n     */\n    destroyAllChildren () {\n        var children = this._children;\n        for (var i = 0; i < children.length; ++i) {\n            children[i].destroy();\n        }\n    },\n\n    _onSetParent (value) {},\n    _onPostActivated () {},\n    _onBatchRestored () {},\n    _onBatchCreated () {},\n\n    _onHierarchyChanged (oldParent) {\n        var newParent = this._parent;\n        if (this._persistNode && !(newParent instanceof cc.Scene)) {\n            cc.game.removePersistRootNode(this);\n            if (CC_EDITOR) {\n                cc.warnID(1623);\n            }\n        }\n\n        if (CC_EDITOR || CC_TEST) {\n            var scene = cc.director.getScene();\n            var inCurrentSceneBefore = oldParent && oldParent.isChildOf(scene);\n            var inCurrentSceneNow = newParent && newParent.isChildOf(scene);\n            if (!inCurrentSceneBefore && inCurrentSceneNow) {\n                // attached\n                this._registerIfAttached(true);\n            }\n            else if (inCurrentSceneBefore && !inCurrentSceneNow) {\n                // detached\n                this._registerIfAttached(false);\n            }\n\n            // update prefab\n            var newPrefabRoot = newParent && newParent._prefab && newParent._prefab.root;\n            var myPrefabInfo = this._prefab;\n            var PrefabUtils = Editor.require('scene://utils/prefab');\n            if (myPrefabInfo) {\n                if (newPrefabRoot) {\n                    if (myPrefabInfo.root !== newPrefabRoot) {\n                        // change prefab\n                        PrefabUtils.unlinkPrefab(this);\n                        PrefabUtils.linkPrefab(newPrefabRoot._prefab.asset, newPrefabRoot, this);\n                    }\n                }\n                else if (myPrefabInfo.root !== this) {\n                    // detach from prefab\n                    PrefabUtils.unlinkPrefab(this);\n                }\n            }\n            else if (newPrefabRoot) {\n                // attach to prefab\n                PrefabUtils.linkPrefab(newPrefabRoot._prefab.asset, newPrefabRoot, this);\n            }\n\n            // conflict detection\n            _Scene.DetectConflict.afterAddChild(this);\n        }\n\n        var shouldActiveNow = this._active && !!(newParent && newParent._activeInHierarchy);\n        if (this._activeInHierarchy !== shouldActiveNow) {\n            cc.director._nodeActivator.activateNode(this, shouldActiveNow);\n        }\n    },\n\n    _instantiate (cloned) {\n        if (!cloned) {\n            cloned = cc.instantiate._clone(this, this);\n        }\n\n        var thisPrefabInfo = this._prefab;\n        if (CC_EDITOR && thisPrefabInfo) {\n            if (this !== thisPrefabInfo.root) {\n                var PrefabUtils = Editor.require('scene://utils/prefab');\n                PrefabUtils.initClonedChildOfPrefab(cloned);\n            }\n        }\n        var syncing = thisPrefabInfo && this === thisPrefabInfo.root && thisPrefabInfo.sync;\n        if (syncing) {\n            //if (thisPrefabInfo._synced) {\n            //    return clone;\n            //}\n        }\n        else if (CC_EDITOR && cc.engine._isPlaying) {\n            cloned._name += ' (Clone)';\n        }\n\n        // reset and init\n        cloned._parent = null;\n        cloned._onBatchRestored();\n\n        return cloned;\n    },\n\n    _registerIfAttached: (CC_EDITOR || CC_TEST) && function (register) {\n        var attachedObjsForEditor = cc.engine.attachedObjsForEditor;\n        if (register) {\n            attachedObjsForEditor[this._id] = this;\n            for (let i = 0; i < this._components.length; i++) {\n                let comp = this._components[i];\n                attachedObjsForEditor[comp._id] = comp;\n            }\n            cc.engine.emit('node-attach-to-scene', this);\n        }\n        else {\n            cc.engine.emit('node-detach-from-scene', this);\n            delete attachedObjsForEditor[this._id];\n            for (let i = 0; i < this._components.length; i++) {\n                let comp = this._components[i];\n                delete attachedObjsForEditor[comp._id];\n            }\n        }\n        var children = this._children;\n        for (let i = 0, len = children.length; i < len; ++i) {\n            var child = children[i];\n            child._registerIfAttached(register);\n        }\n    },\n\n    _onPreDestroy () {\n        var i, len;\n\n        // marked as destroying\n        this._objFlags |= Destroying;\n\n        // detach self and children from editor\n        var parent = this._parent;\n        var destroyByParent = parent && (parent._objFlags & Destroying);\n        if (!destroyByParent && (CC_EDITOR || CC_TEST)) {\n            this._registerIfAttached(false);\n        }\n\n        // destroy children\n        var children = this._children;\n        for (i = 0, len = children.length; i < len; ++i) {\n            // destroy immediate so its _onPreDestroy can be called\n            children[i]._destroyImmediate();\n        }\n\n        // destroy self components\n        for (i = 0, len = this._components.length; i < len; ++i) {\n            var component = this._components[i];\n            // destroy immediate so its _onPreDestroy can be called\n            component._destroyImmediate();\n        }\n\n        var eventTargets = this.__eventTargets;\n        for (i = 0, len = eventTargets.length; i < len; ++i) {\n            var target = eventTargets[i];\n            target && target.targetOff(this);\n        }\n        eventTargets.length = 0;\n\n        // remove from persist\n        if (this._persistNode) {\n            cc.game.removePersistRootNode(this);\n        }\n\n        if (!destroyByParent) {\n            // remove from parent\n            if (parent) {\n                var childIndex = parent._children.indexOf(this);\n                parent._children.splice(childIndex, 1);\n                parent.emit && parent.emit('child-removed', this);\n            }\n        }\n\n        return destroyByParent;\n    },\n\n    onRestore: CC_EDITOR && function () {\n        // check activity state\n        var shouldActiveNow = this._active && !!(this._parent && this._parent._activeInHierarchy);\n        if (this._activeInHierarchy !== shouldActiveNow) {\n            cc.director._nodeActivator.activateNode(this, shouldActiveNow);\n        }\n    },\n});\n\nBaseNode.idGenerater = idGenerater;\n\n// For walk\nBaseNode._stacks = [[]];\nBaseNode._stackId = 0;\n\nBaseNode.prototype._onPreDestroyBase = BaseNode.prototype._onPreDestroy;\nif (CC_EDITOR) {\n    BaseNode.prototype._onPreDestroy = function () {\n       var destroyByParent = this._onPreDestroyBase();\n       if (!destroyByParent) {\n           // ensure this node can reattach to scene by undo system\n           // (simulate some destruct logic to make undo system work correctly)\n           this._parent = null;\n       }\n       return destroyByParent;\n   };\n}\n\nBaseNode.prototype._onHierarchyChangedBase = BaseNode.prototype._onHierarchyChanged;\n\nif(CC_EDITOR) {\n    BaseNode.prototype._onRestoreBase = BaseNode.prototype.onRestore;\n}\n\n// Define public getter and setter methods to ensure api compatibility.\nvar SameNameGetSets = ['parent', 'name', 'children', 'childrenCount',];\nmisc.propertyDefine(BaseNode, SameNameGetSets, {});\n\nif (CC_DEV) {\n    // promote debug info\n    js.get(BaseNode.prototype, ' INFO ', function () {\n        var path = '';\n        var node = this;\n        while (node && !(node instanceof cc.Scene)) {\n            if (path) {\n                path = node.name + '/' + path;\n            }\n            else {\n                path = node.name;\n            }\n            node = node._parent;\n        }\n        return this.name + ', path: ' + path;\n    });\n}\n\n/**\n * !#en\n * Note: This event is only emitted from the top most node whose active value did changed,\n * not including its child nodes.\n * !#zh\n * 注意：此节点激活时，此事件仅从最顶部的节点发出。\n * @event active-in-hierarchy-changed\n * @param {Event.EventCustom} event\n */\n\ncc._BaseNode = module.exports = BaseNode;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar EPSILON = 1e-6;\n\n/**\n * Searches the entire sorted Array for an element and returns the index of the element.\n *\n * @method binarySearch\n * @param {number[]} array\n * @param {number} value\n * @return {number} The index of item in the sorted Array, if item is found; otherwise, a negative number that is the bitwise complement of the index of the next element that is larger than item or, if there is no larger element, the bitwise complement of array's length.\n */\n// function binarySearch (array, value) {\n//     for (var l = 0, h = array.length - 1, m = h >>> 1;\n//          l <= h;\n//          m = (l + h) >>> 1\n//     ) {\n//         var test = array[m];\n//         if (test > value) {\n//             h = m - 1;\n//         }\n//         else if (test < value) {\n//             l = m + 1;\n//         }\n//         else {\n//             return m;\n//         }\n//     }\n//     return ~l;\n// }\n\n/**\n * Searches the entire sorted Array for an element and returns the index of the element.\n * It accepts iteratee which is invoked for value and each element of array to compute their sort ranking.\n * The iteratee is invoked with one argument: (value).\n *\n * @method binarySearchBy\n * @param {number[]} array\n * @param {number} value\n * @param {function} iteratee - the iteratee invoked per element\n * @return {number} The index of item in the sorted Array, if item is found; otherwise, a negative number that is the bitwise complement of the index of the next element that is larger than item or, if there is no larger element, the bitwise complement of array's length.\n */\n// function binarySearchBy (array, value, iteratee) {\n//     for (var l = 0, h = array.length - 1, m = h >>> 1;\n//          l <= h;\n//          m = (l + h) >>> 1\n//     ) {\n//         var test = iteratee(array[m]);\n//         if (test > value) {\n//             h = m - 1;\n//         }\n//         else if (test < value) {\n//             l = m + 1;\n//         }\n//         else {\n//             return m;\n//         }\n//     }\n//     return ~l;\n// }\n\nfunction binarySearchEpsilon (array, value) {\n    for (var l = 0, h = array.length - 1, m = h >>> 1;\n         l <= h;\n         m = (l + h) >>> 1\n    ) {\n        var test = array[m];\n        if (test > value + EPSILON) {\n            h = m - 1;\n        }\n        else if (test < value - EPSILON) {\n            l = m + 1;\n        }\n        else {\n            return m;\n        }\n    }\n    return ~l;\n}\n\n\nmodule.exports = {\n    binarySearchEpsilon\n};\n","\nconst RenderComponent = require('../components/CCRenderComponent');\nconst BlendFactor = require('../platform/CCMacro').BlendFactor;\nconst gfx = require('../../renderer/gfx');\n\n/**\n * !#en\n * Helper class for setting material blend function.\n * !#zh\n * 设置材质混合模式的辅助类。\n * @class BlendFunc\n */\nlet BlendFunc = cc.Class({\n    properties: {\n        _srcBlendFactor: BlendFactor.SRC_ALPHA,\n        _dstBlendFactor: BlendFactor.ONE_MINUS_SRC_ALPHA,\n\n        /**\n         * !#en specify the source Blend Factor, this will generate a custom material object, please pay attention to the memory cost.\n         * !#zh 指定原图的混合模式，这会克隆一个新的材质对象，注意这带来的开销\n         * @property srcBlendFactor\n         * @type {macro.BlendFactor}\n         * @example\n         * sprite.srcBlendFactor = cc.macro.BlendFactor.ONE;\n         */\n        srcBlendFactor: {\n            get () {\n                return this._srcBlendFactor;\n            },\n            set (value) {\n                if (this._srcBlendFactor === value) return;\n                this._srcBlendFactor = value;\n                this._updateBlendFunc();\n            },\n            animatable: false,\n            type: BlendFactor,\n            tooltip: CC_DEV && 'i18n:COMPONENT.sprite.src_blend_factor',\n            visible: true\n        },\n\n        /**\n         * !#en specify the destination Blend Factor.\n         * !#zh 指定目标的混合模式\n         * @property dstBlendFactor\n         * @type {macro.BlendFactor}\n         * @example\n         * sprite.dstBlendFactor = cc.macro.BlendFactor.ONE;\n         */\n        dstBlendFactor: {\n            get () {\n                return this._dstBlendFactor;\n            },\n            set (value) {\n                if (this._dstBlendFactor === value) return;\n                this._dstBlendFactor = value;\n                this._updateBlendFunc();\n            },\n            animatable: false,\n            type: BlendFactor,\n            tooltip: CC_DEV && 'i18n:COMPONENT.sprite.dst_blend_factor',\n            visible: true\n        },\n    },\n\n    setMaterial (index, material) {\n        RenderComponent.prototype.setMaterial.call(this, index, material);\n        \n        if (this._srcBlendFactor === BlendFactor.SRC_ALPHA && this._dstBlendFactor === BlendFactor.ONE_MINUS_SRC_ALPHA) {\n            return;\n        }\n        this._updateMaterialBlendFunc(material);\n    },\n\n    _updateMaterial () {\n        this._updateBlendFunc();\n    },\n\n    _updateBlendFunc () {\n        if (this._srcBlendFactor === BlendFactor.SRC_ALPHA && this._dstBlendFactor === BlendFactor.ONE_MINUS_SRC_ALPHA) {\n            return;\n        }\n        let materials = this.getMaterials();\n        for (let i = 0; i < materials.length; i++) {\n            let material = materials[i];\n            this._updateMaterialBlendFunc(material);\n        }\n    },\n\n    _updateMaterialBlendFunc (material) {\n        material.setBlend(\n            true,\n            gfx.BLEND_FUNC_ADD,\n            this._srcBlendFactor, this._dstBlendFactor,\n            gfx.BLEND_FUNC_ADD,\n            this._srcBlendFactor, this._dstBlendFactor\n        );\n    },\n});\n\nmodule.exports = cc.BlendFunc = BlendFunc;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar Base64Values = require('./misc').BASE64_VALUES;\n\nvar HexChars = '0123456789abcdef'.split('');\n\nvar _t = ['', '', '', ''];\nvar UuidTemplate = _t.concat(_t, '-', _t, '-', _t, '-', _t, '-', _t, _t, _t);\nvar Indices = UuidTemplate.map(function (x, i) { return x === '-' ? NaN : i; }).filter(isFinite);\n\n// fcmR3XADNLgJ1ByKhqcC5Z -> fc991dd7-0033-4b80-9d41-c8a86a702e59\nmodule.exports = function (base64) {\n    if (base64.length !== 22) {\n        return base64;\n    }\n    UuidTemplate[0] = base64[0];\n    UuidTemplate[1] = base64[1];\n    for (var i = 2, j = 2; i < 22; i += 2) {\n        var lhs = Base64Values[base64.charCodeAt(i)];\n        var rhs = Base64Values[base64.charCodeAt(i + 1)];\n        UuidTemplate[Indices[j++]] = HexChars[lhs >> 2];\n        UuidTemplate[Indices[j++]] = HexChars[((lhs & 3) << 2) | rhs >> 4];\n        UuidTemplate[Indices[j++]] = HexChars[rhs & 0xF];\n    }\n    return UuidTemplate.join('');\n};\n\nif (CC_TEST) {\n    cc._Test.decodeUuid = module.exports;\n}\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * Finds a node by hierarchy path, the path is case-sensitive.\n * It will traverse the hierarchy by splitting the path using '/' character.\n * This function will still returns the node even if it is inactive.\n * It is recommended to not use this function every frame instead cache the result at startup.\n *\n * @method find\n * @static\n * @param {String} path\n * @param {Node} [referenceNode]\n * @return {Node|null} the node or null if not found\n */\ncc.find = module.exports = function (path, referenceNode) {\n    if (path == null) {\n        cc.errorID(5600);\n        return null;\n    }\n    if (!referenceNode) {\n        var scene = cc.director.getScene();\n        if (!scene) {\n            if (CC_DEV) {\n                cc.warnID(5601);\n            }\n            return null;\n        }\n        else if (CC_DEV && !scene.isValid) {\n            cc.warnID(5602);\n            return null;\n        }\n        referenceNode = scene;\n    }\n    else if (CC_DEV && !referenceNode.isValid) {\n        cc.warnID(5603);\n        return null;\n    }\n\n    var match = referenceNode;\n    var startIndex = (path[0] !== '/') ? 0 : 1; // skip first '/'\n    var nameList = path.split('/');\n\n    // parse path\n    for (var n = startIndex; n < nameList.length; n++) {\n        var name = nameList[n];\n        var children = match._children;\n        match = null;\n        for (var t = 0, len = children.length; t < len; ++t) {\n            var subChild = children[t];\n            if (subChild.name === name) {\n                match = subChild;\n                break;\n            }\n        }\n        if (!match) {\n            return null;\n        }\n    }\n\n    return match;\n};\n","\nimport MaterialVariant from '../assets/material/material-variant';\nconst Material = require('../assets/material/CCMaterial');\n\n/**\n * An internal helper class for switching render component's material between normal sprite material and gray sprite material.\n * @class GraySpriteState\n */\nlet GraySpriteState = cc.Class({\n    properties: {\n        _normalMaterial: null,\n\n        /**\n         * !#en The normal material.\n         * !#zh 正常状态的材质。\n         * @property normalMaterial\n         * @type {Material}\n         * @default null\n         */\n        normalMaterial: {\n            get () {\n                return this._normalMaterial;\n            },\n            set (val) {\n                this._normalMaterial = val;\n                this._updateDisabledState && this._updateDisabledState();\n            },\n            type: Material,\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.normal_material',\n            animatable: false\n        },\n\n        _grayMaterial: null,\n\n        /**\n         * !#en The gray material.\n         * !#zh 置灰状态的材质。\n         * @property grayMaterial\n         * @type {Material}\n         * @default null\n         */\n        grayMaterial: {\n            get () {\n                return this._grayMaterial;\n            },\n            set (val) {\n                this._grayMaterial = val;\n                this._updateDisabledState && this._updateDisabledState();\n            },\n            type: Material,\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.gray_material',\n            animatable: false\n        }\n    },\n  \n    _switchGrayMaterial (useGrayMaterial, renderComp) {\n        let material;\n        if (useGrayMaterial) {\n            material = this._grayMaterial;\n            if (!material) {\n                material = Material.getBuiltinMaterial('2d-gray-sprite');\n            }\n            material = this._grayMaterial = MaterialVariant.create(material, renderComp);\n        }\n        else {\n            material = this._normalMaterial;\n            if (!material) {\n                material = Material.getBuiltinMaterial('2d-sprite', renderComp);\n            }\n            material = this._normalMaterial = MaterialVariant.create(material, renderComp);\n        }\n    \n        renderComp.setMaterial(0, material);\n    }\n});\n\nmodule.exports = GraySpriteState;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n \nrequire('./CCPath');\nif (!CC_EDITOR) {\n    require('./profiler/CCProfiler');\n}\nrequire('./find');\nrequire('./mutable-forward-iterator');\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar js = require('../platform/js');\n\n/**\n * misc utilities\n * @class misc\n * @static\n */\nvar misc = {};\n\nmisc.propertyDefine = function (ctor, sameNameGetSets, diffNameGetSets) {\n    function define (np, propName, getter, setter) {\n        var pd = Object.getOwnPropertyDescriptor(np, propName);\n        if (pd) {\n            if (pd.get) np[getter] = pd.get;\n            if (pd.set && setter) np[setter] = pd.set;\n        }\n        else {\n            var getterFunc = np[getter];\n            if (CC_DEV && !getterFunc) {\n                var clsName = (cc.Class._isCCClass(ctor) && js.getClassName(ctor)) ||\n                              ctor.name ||\n                              '(anonymous class)';\n                cc.warnID(5700, propName, getter, clsName);\n            }\n            else {\n                js.getset(np, propName, getterFunc, np[setter]);\n            }\n        }\n    }\n    var propName, np = ctor.prototype;\n    for (var i = 0; i < sameNameGetSets.length; i++) {\n        propName = sameNameGetSets[i];\n        var suffix = propName[0].toUpperCase() + propName.slice(1);\n        define(np, propName, 'get' + suffix, 'set' + suffix);\n    }\n    for (propName in diffNameGetSets) {\n        var getset = diffNameGetSets[propName];\n        define(np, propName, getset[0], getset[1]);\n    }\n};\n\n/**\n * @param {Number} x\n * @return {Number}\n * Constructor\n */\nmisc.NextPOT = function (x) {\n    x = x - 1;\n    x = x | (x >> 1);\n    x = x | (x >> 2);\n    x = x | (x >> 4);\n    x = x | (x >> 8);\n    x = x | (x >> 16);\n    return x + 1;\n};\n\n//var DirtyFlags = m.DirtyFlags = {\n//    TRANSFORM: 1 << 0,\n//    SIZE: 1 << 1,\n//    //Visible:\n//    //Color:\n//    //Opacity\n//    //Cache\n//    //Order\n//    //Text\n//    //Gradient\n//    ALL: (1 << 2) - 1\n//};\n//\n//DirtyFlags.WIDGET = DirtyFlags.TRANSFORM | DirtyFlags.SIZE;\n\nif (CC_EDITOR) {\n    // use anonymous function here to ensure it will not being hoisted without CC_EDITOR\n\n    misc.tryCatchFunctor_EDITOR = function (funcName) {\n        return Function('target',\n            'try {\\n' +\n            '  target.' + funcName + '();\\n' +\n            '}\\n' +\n            'catch (e) {\\n' +\n            '  cc._throw(e);\\n' +\n            '}');\n    };\n}\n\nmisc.BUILTIN_CLASSID_RE = /^(?:cc|dragonBones|sp|ccsg)\\..+/;\n\n\nvar BASE64_KEYS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\nvar BASE64_VALUES = new Array(123); // max char code in base64Keys\nfor (let i = 0; i < 123; ++i) BASE64_VALUES[i] = 64; // fill with placeholder('=') index\nfor (let i = 0; i < 64; ++i) BASE64_VALUES[BASE64_KEYS.charCodeAt(i)] = i;\n\n// decoded value indexed by base64 char code\nmisc.BASE64_VALUES = BASE64_VALUES;\n\n// set value to map, if key exists, push to array\nmisc.pushToMap = function (map, key, value, pushFront) {\n    var exists = map[key];\n    if (exists) {\n        if (Array.isArray(exists)) {\n            if (pushFront) {\n                exists.push(exists[0]);\n                exists[0] = value;\n            }\n            else {\n                exists.push(value);\n            }\n        }\n        else {\n            map[key] = (pushFront ? [value, exists] : [exists, value]);\n        }\n    }\n    else {\n        map[key] = value;\n    }\n};\n\n/**\n * !#en Clamp a value between from and to.\n * !#zh\n * 限定浮点数的最大最小值。<br/>\n * 数值大于 max_inclusive 则返回 max_inclusive。<br/>\n * 数值小于 min_inclusive 则返回 min_inclusive。<br/>\n * 否则返回自身。\n * @method clampf\n * @param {Number} value\n * @param {Number} min_inclusive\n * @param {Number} max_inclusive\n * @return {Number}\n * @example\n * var v1 = cc.misc.clampf(20, 0, 20); // 20;\n * var v2 = cc.misc.clampf(-1, 0, 20); //  0;\n * var v3 = cc.misc.clampf(10, 0, 20); // 10;\n */\nmisc.clampf = function (value, min_inclusive, max_inclusive) {\n    if (min_inclusive > max_inclusive) {\n        var temp = min_inclusive;\n        min_inclusive = max_inclusive;\n        max_inclusive = temp;\n    }\n    return value < min_inclusive ? min_inclusive : value < max_inclusive ? value : max_inclusive;\n};\n\n/**\n * !#en Clamp a value between 0 and 1.\n * !#zh 限定浮点数的取值范围为 0 ~ 1 之间。\n * @method clamp01\n * @param {Number} value\n * @return {Number}\n * @example\n * var v1 = cc.misc.clamp01(20);  // 1;\n * var v2 = cc.misc.clamp01(-1);  // 0;\n * var v3 = cc.misc.clamp01(0.5); // 0.5;\n */\nmisc.clamp01 = function (value) {\n    return value < 0 ? 0 : value < 1 ? value : 1;\n};\n\n/**\n * Linear interpolation between 2 numbers, the ratio sets how much it is biased to each end\n * @method lerp\n * @param {Number} a number A\n * @param {Number} b number B\n * @param {Number} r ratio between 0 and 1\n * @return {Number}\n * @example {@link cocos2d/core/platform/CCMacro/lerp.js}\n */\nmisc.lerp = function (a, b, r) {\n    return a + (b - a) * r;\n};\n\n/**\n * converts degrees to radians\n * @param {Number} angle\n * @return {Number}\n * @method degreesToRadians\n */\nmisc.degreesToRadians = function (angle) {\n    return angle * cc.macro.RAD;\n};\n\n/**\n * converts radians to degrees\n * @param {Number} angle\n * @return {Number}\n * @method radiansToDegrees\n */\nmisc.radiansToDegrees = function (angle) {\n    return angle * cc.macro.DEG;\n};\n\ncc.misc = module.exports = misc;","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * @example\n * var array = [0, 1, 2, 3, 4];\n * var iterator = new cc.js.array.MutableForwardIterator(array);\n * for (iterator.i = 0; iterator.i < array.length; ++iterator.i) {\n *     var item = array[iterator.i];\n *     ...\n * }\n */\nfunction MutableForwardIterator (array) {\n    this.i = 0;\n    this.array = array;\n}\n\nvar proto = MutableForwardIterator.prototype;\n\nproto.remove = function (value) {\n    var index = this.array.indexOf(value);\n    if (index >= 0) {\n        this.removeAt(index);\n    }\n};\nproto.removeAt = function (i) {\n    this.array.splice(i, 1);\n\n    if (i <= this.i) {\n        --this.i;\n    }\n};\nproto.fastRemove = function (value) {\n    var index = this.array.indexOf(value);\n    if (index >= 0) {\n        this.fastRemoveAt(index);\n    }\n};\nproto.fastRemoveAt = function (i) {\n    var array = this.array;\n    array[i] = array[array.length - 1];\n    --array.length;\n\n    if (i <= this.i) {\n        --this.i;\n    }\n};\n\nproto.push = function (item) {\n    this.array.push(item);\n};\n\n//js.getset(proto, 'length',\n//    function () {\n//        return this.array.length;\n//    },\n//    function (len) {\n//        this.array.length = len;\n//        if (this.i >= len) {\n//            this.i = len - 1;\n//        }\n//    }\n//);\n\nmodule.exports = MutableForwardIterator;\n","\nexport default class Pool {\n    enabled = false;\n    count = 0;\n    maxSize = 1024;\n\n    get () {\n\n    }\n    put () {\n\n    }\n    clear () {\n\n    }\n}\n\ncc.pool = {};\n\nPool.register = function (name, pool) {\n    cc.pool[name] = pool;\n}\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\ncc._PrefabInfo = cc.Class({\n    name: 'cc.PrefabInfo',\n    // extends: require('../platform/CCObject'),\n    properties: {\n        // the most top node of this prefab in the scene\n        root: null,\n\n        // 所属的 prefab 资源对象 (cc.Prefab)\n        // In Editor, only asset._uuid is usable because asset will be changed.\n        asset: null,\n\n        // 用来标识别该节点在 prefab 资源中的位置，因此这个 ID 只需要保证在 Assets 里不重复就行\n        fileId: '',\n\n        // Indicates whether this node should always synchronize with the prefab asset, only available in the root node\n        sync: false,\n\n        // Indicates whether this node is synchronized, only available in the root node\n        _synced: {\n            default: false,\n            serializable: false\n        },\n    },\n    // _instantiate (cloned) {\n    //     if (!cloned) {\n    //         cloned = new cc._PrefabInfo();\n    //     }\n    //     cloned.root = this.root;\n    //     cloned.asset = this.asset;\n    //     cloned.fileId = this.fileId;\n    //     cloned.sync = this.sync;\n    //     cloned._synced = this._synced;\n    //     return cloned;\n    // }\n});\n\n// prefab helper function\nmodule.exports = {\n    // update node to make it sync with prefab\n    syncWithPrefab: function (node) {\n        var _prefab = node._prefab;\n        // non-reentrant\n        _prefab._synced = true;\n        //\n        if (!_prefab.asset) {\n            if (CC_EDITOR) {\n                var NodeUtils = Editor.require('scene://utils/node');\n                var PrefabUtils = Editor.require('scene://utils/prefab');\n\n                cc.warn(Editor.T('MESSAGE.prefab.missing_prefab', { node: NodeUtils.getNodePath(node) }));\n                node.name += PrefabUtils.MISSING_PREFAB_SUFFIX;\n            }\n            else {\n                cc.errorID(3701, node.name);\n            }\n            node._prefab = null;\n            return;\n        }\n\n        // save root's preserved props to avoid overwritten by prefab\n        var _objFlags = node._objFlags;\n        var _parent = node._parent;\n        var _id = node._id;\n        var _name = node._name;\n        var _active = node._active;\n        var eulerAnglesX = node._eulerAngles.x;\n        var eulerAnglesY = node._eulerAngles.y;\n        var eulerAnglesZ = node._eulerAngles.z;\n        var _localZOrder = node._localZOrder;\n        var _globalZOrder = node._globalZOrder;\n        var trs = node._trs;\n        var x = trs[0];\n        var y = trs[1];\n        var z = trs[2];\n\n        // instantiate prefab\n        cc.game._isCloning = true;\n        if (CC_SUPPORT_JIT) {\n            _prefab.asset._doInstantiate(node);\n        }\n        else {\n            // root in prefab asset is always synced\n            var prefabRoot = _prefab.asset.data;\n            prefabRoot._prefab._synced = true;\n\n            // use node as the instantiated prefabRoot to make references to prefabRoot in prefab redirect to node\n            prefabRoot._iN$t = node;\n\n            // instantiate prefab and apply to node\n            cc.instantiate._clone(prefabRoot, prefabRoot);\n        }\n        cc.game._isCloning = false;\n\n        // restore preserved props\n        node._objFlags = _objFlags;\n        node._parent = _parent;\n        node._id = _id;\n        node._prefab = _prefab;\n        node._name = _name;\n        node._active = _active;\n        node._localZOrder = _localZOrder;\n        node._globalZOrder = _globalZOrder;\n        trs = node._trs;\n        trs[0] = x;\n        trs[1] = y;\n        trs[2] = z;\n        node._eulerAngles.x = eulerAnglesX;\n        node._eulerAngles.y = eulerAnglesY;\n        node._eulerAngles.z = eulerAnglesZ;\n    }\n};\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nvar macro = require('../../platform/CCMacro');\n\nconst PerfCounter = require('./perf-counter');\n\nlet _showFPS = false;\nlet _fontSize = 15;\n\nlet _stats = null;\nlet _rootNode = null;\nlet _label = null;\n\nfunction generateStats () {\n    if (_stats) return;\n    \n    _stats = {\n        frame: { desc: 'Frame time (ms)', min: 0, max: 50, average: 500 },\n        fps: { desc: 'Framerate (FPS)', below: 30, average: 500 },\n        draws: { desc: 'Draw call' },\n        logic: { desc: 'Game Logic (ms)', min: 0, max: 50, average: 500, color: '#080' },\n        render: { desc: 'Renderer (ms)', min: 0, max: 50, average: 500, color: '#f90' },\n        mode: { desc: cc.game.renderType === cc.game.RENDER_TYPE_WEBGL ? 'WebGL' : 'Canvas', min: 1 }\n    };\n\n    let now = performance.now();\n    for (let id in _stats) {\n        _stats[id]._counter = new PerfCounter(id, _stats[id], now);\n    }\n}\n\nfunction generateNode () {\n    if (_rootNode && _rootNode.isValid) return;\n\n\n    _rootNode = new cc.Node('PROFILER-NODE');\n    _rootNode.x = _rootNode.y = 10;\n\n    _rootNode.groupIndex = cc.Node.BuiltinGroupIndex.DEBUG;\n    cc.Camera._setupDebugCamera();\n\n    _rootNode.zIndex = macro.MAX_ZINDEX;\n    cc.game.addPersistRootNode(_rootNode);\n\n    let left = new cc.Node('LEFT-PANEL');\n    left.anchorX = left.anchorY = 0;\n    let leftLabel = left.addComponent(cc.Label);\n    leftLabel.fontSize = _fontSize;\n    leftLabel.lineHeight = _fontSize;\n    left.parent = _rootNode;\n\n    let right = new cc.Node('RIGHT-PANEL');\n    right.anchorX = 1;\n    right.anchorY = 0;\n    right.x = 200;\n    let rightLabel = right.addComponent(cc.Label);\n    rightLabel.horizontalAlign = cc.Label.HorizontalAlign.RIGHT;\n    rightLabel.fontSize = _fontSize;\n    rightLabel.lineHeight = _fontSize;\n    right.parent = _rootNode;\n    if (cc.sys.browserType !== cc.sys.BROWSER_TYPE_BAIDU_GAME_SUB &&\n        cc.sys.browserType !== cc.sys.BROWSER_TYPE_WECHAT_GAME_SUB) {\n        leftLabel.cacheMode = cc.Label.CacheMode.CHAR;\n        rightLabel.cacheMode = cc.Label.CacheMode.CHAR;\n    }\n\n    _label = {\n        left: leftLabel,\n        right: rightLabel\n    };\n}\n\nfunction beforeUpdate () {\n    generateNode();\n\n    let now = cc.director._lastUpdate;\n    _stats['frame']._counter.start(now);\n    _stats['logic']._counter.start(now);\n}\n\nfunction afterUpdate () {\n    let now = performance.now();\n    if (cc.director.isPaused()) {\n        _stats['frame']._counter.start(now);\n    }\n    else {\n        _stats['logic']._counter.end(now);\n    }\n    _stats['render']._counter.start(now);\n}\n\nfunction updateLabel (stat) {\n    let length = 20;\n    let desc = stat.desc;\n    let value = stat._counter.human() + '';\n    stat.label.string = stat.desc + '  ' + stat._counter.human();\n}\n\nfunction afterDraw () {\n    let now = performance.now();\n    _stats['render']._counter.end(now);\n    _stats['draws']._counter.value = cc.renderer.drawCalls;\n    _stats['frame']._counter.end(now);\n    _stats['fps']._counter.frame(now);\n    \n    let left = '';\n    let right = '';\n    for (let id in _stats) {\n        let stat = _stats[id];\n        stat._counter.sample(now);\n\n        left += stat.desc + '\\n';\n        right += stat._counter.human() + '\\n';\n    }\n\n    if (_label) {\n        _label.left.string = left;\n        _label.right.string = right;\n    }\n}\n\ncc.profiler = module.exports = {\n    isShowingStats () {\n        return _showFPS;\n    },\n\n    hideStats () {\n        if (_showFPS) {\n            if (_rootNode) {\n                _rootNode.active = false;\n            }\n\n            cc.director.off(cc.Director.EVENT_BEFORE_UPDATE, beforeUpdate);\n            cc.director.off(cc.Director.EVENT_AFTER_UPDATE, afterUpdate);\n            cc.director.off(cc.Director.EVENT_AFTER_DRAW, afterDraw);\n            _showFPS = false;\n        }\n    },\n\n    showStats () {\n        if (!_showFPS) {\n            generateStats();\n\n            if (_rootNode) {\n                _rootNode.active = true;\n            }\n\n            cc.director.on(cc.Director.EVENT_BEFORE_UPDATE, beforeUpdate);\n            cc.director.on(cc.Director.EVENT_AFTER_UPDATE, afterUpdate);\n            cc.director.on(cc.Director.EVENT_AFTER_DRAW, afterDraw);\n            _showFPS = true;\n        }\n    }\n}","let Counter = cc.Class({\n    name: 'cc.Counter',\n    ctor (id, opts, now) {\n        this._id = id;\n        this._opts = opts || {};\n\n        this._value = 0;\n        this._total = 0;\n        this._averageValue = 0;\n        this._accumValue = 0;\n        this._accumSamples = 0;\n        this._accumStart = now;\n    },\n\n    properties: {\n        value: {\n            get () {\n                return this._value;\n            },\n            set (v) {\n                this._value = v;\n            }\n        }\n    },\n\n    _average (v, now) {\n        if (this._opts.average) {\n            this._accumValue += v;\n            ++this._accumSamples;\n\n            let t = now;\n            if (t - this._accumStart >= this._opts.average) {\n                this._averageValue = this._accumValue / this._accumSamples;\n                this._accumValue = 0;\n                this._accumStart = t;\n                this._accumSamples = 0;\n            }\n        }\n    },\n\n    sample (now) {\n        this._average(this._value, now);\n    },\n\n    human () {\n        let v = this._opts.average ? this._averageValue : this._value;\n        return Math.round(v * 100) / 100;\n    },\n\n    alarm () {\n        return (\n            (this._opts.below && this._value < this._opts.below) ||\n            (this._opts.over && this._value > this._opts.over)\n        );\n    }\n})\n\nmodule.exports = Counter;\n","const Counter = require('./counter');\n\nlet PerfCounter = cc.Class({\n  name: 'cc.PerfCounter',\n  extends: Counter,\n  \n  ctor (id, opts, now) {\n    // DISABLE\n    // this._idstart = `${id}_start`;\n    // this._idend = `${id}_end`;\n\n    this._time = now;\n  },\n\n  start(now) {\n    this._time = now;\n\n    // DISABLE: long time running will cause performance drop down\n    // window.performance.mark(this._idstart);\n  },\n\n  end(now) {\n    this._value = now - this._time;\n\n    // DISABLE: long time running will cause performance drop down\n    // window.performance.mark(this._idend);\n    // window.performance.measure(this._id, this._idstart, this._idend);\n\n    this._average(this._value);\n  },\n\n  tick() {\n    this.end();\n    this.start();\n  },\n\n  frame(now) {\n    let t = now;\n    let e = t - this._time;\n    this._total++;\n    let avg = this._opts.average || 1000;\n\n    if (e > avg) {\n      this._value = this._total * 1000 / e;\n      this._total = 0;\n      this._time = t;\n      this._average(this._value);\n    }\n  }\n});\n\nmodule.exports = PerfCounter;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport js from '../platform/js'\n\n// Draw text the textBaseline ratio (Can adjust the appropriate baseline ratio based on the platform)\nlet _BASELINE_RATIO = 0.26;\nif (CC_RUNTIME) {\n    _BASELINE_RATIO = -0.05;\n}\n\nconst MAX_CACHE_SIZE = 100;\n\nlet pool = new js.Pool(2);\npool.get = function () {\n    var node = this._get() || {\n        key: null,\n        value: null,\n        prev: null,\n        next: null\n    };\n\n    return node;\n};\n\nfunction LRUCache(size) {\n    this.count = 0;\n    this.limit = size;\n    this.datas = {};\n    this.head = null;\n    this.tail = null;\n}\n\nLRUCache.prototype.moveToHead = function (node) {\n    node.next = this.head;\n    node.prev = null;\n    if (this.head !== null) \n        this.head.prev = node;\n    this.head = node;\n    if (this.tail === null) \n        this.tail = node;\n    this.count++;\n    this.datas[node.key] = node;\n}\n\nLRUCache.prototype.put = function (key, value) {\n    const node = pool.get();\n    node.key = key;\n    node.value = value;\n    \n    if (this.count >= this.limit) {\n        let discard = this.tail;\n        delete this.datas[discard.key];\n        this.count--;\n        this.tail = discard.prev;\n        this.tail.next = null;\n        discard.prev = null;\n        discard.next = null;\n        pool.put(discard);\n    }\n    this.moveToHead(node);\n}\n\nLRUCache.prototype.remove = function (node) {\n    if (node.prev !== null) {\n        node.prev.next = node.next;\n    } else {\n        this.head = node.next;\n    }\n    if (node.next !== null) {\n        node.next.prev = node.prev;\n    } else {\n        this.tail = node.prev;\n    }\n    delete this.datas[node.key];\n    this.count--;\n}\n\nLRUCache.prototype.get = function (key) {\n    const node = this.datas[key];\n    if (node) {\n        this.remove(node);\n        this.moveToHead(node);\n        return node.value;\n    }\n    return null;\n}\n\nLRUCache.prototype.clear = function () {\n    this.count = 0;\n    this.datas = {};\n    this.head = null;\n    this.tail = null;\n}\n\nLRUCache.prototype.has = function (key) {\n    return !!this.datas[key];\n}\n\nLRUCache.prototype.delete = function (key) {\n    const node = this.datas[key];\n    this.remove(node);\n}\n\nlet measureCache = new LRUCache(MAX_CACHE_SIZE);\n\nvar textUtils = {\n\n    BASELINE_RATIO: _BASELINE_RATIO,\n    MIDDLE_RATIO: (_BASELINE_RATIO + 1) / 2 - _BASELINE_RATIO,\n\n    label_wordRex : /([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]+|\\S)/,\n    label_symbolRex : /^[!,.:;'}\\]%\\?>、‘“》？。，！]/,\n    label_lastWordRex : /([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁё]+|\\S)$/,\n    label_lastEnglish : /[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁё]+$/,\n    label_firstEnglish : /^[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁё]/,\n    label_firstEmoji : /^[\\uD83C\\uDF00-\\uDFFF\\uDC00-\\uDE4F]/,\n    label_lastEmoji : /([\\uDF00-\\uDFFF\\uDC00-\\uDE4F]+|\\S)$/,\n    label_wrapinspection : true,\n\n    __CHINESE_REG: /^[\\u4E00-\\u9FFF\\u3400-\\u4DFF]+$/,\n    __JAPANESE_REG: /[\\u3000-\\u303F]|[\\u3040-\\u309F]|[\\u30A0-\\u30FF]|[\\uFF00-\\uFFEF]|[\\u4E00-\\u9FAF]|[\\u2605-\\u2606]|[\\u2190-\\u2195]|\\u203B/g,\n    __KOREAN_REG: /^[\\u1100-\\u11FF]|[\\u3130-\\u318F]|[\\uA960-\\uA97F]|[\\uAC00-\\uD7AF]|[\\uD7B0-\\uD7FF]+$/,\n\n    isUnicodeCJK: function(ch) {\n        return this.__CHINESE_REG.test(ch) || this.__JAPANESE_REG.test(ch) || this.__KOREAN_REG.test(ch);\n    },\n\n    //Checking whether the character is a whitespace\n    isUnicodeSpace: function(ch) {\n        ch = ch.charCodeAt(0);\n        return ((ch >= 9 && ch <= 13) || ch === 32 || ch === 133 || ch === 160 || ch === 5760 || (ch >= 8192 && ch <= 8202) || ch === 8232 || ch === 8233 || ch === 8239 || ch === 8287 || ch === 12288);\n    },\n\n    safeMeasureText: function (ctx, string, desc) {\n        let font = desc || ctx.font;\n        let key = font + \"\\uD83C\\uDFAE\" + string;\n        let cache = measureCache.get(key);\n        if (cache !== null) {\n            return cache;\n        }\n\n        let metric = ctx.measureText(string);\n        let width = metric && metric.width || 0;\n        measureCache.put(key, width);\n\n        return width;\n    },\n\n    fragmentText: function (stringToken, allWidth, maxWidth, measureText) {\n        //check the first character\n        var wrappedWords = [];\n        //fast return if strArr is empty\n        if(stringToken.length === 0 || maxWidth < 0) {\n            wrappedWords.push('');\n            return wrappedWords;\n        }\n\n        var text = stringToken;\n        while (allWidth > maxWidth && text.length > 1) {\n\n            var fuzzyLen = text.length * ( maxWidth / allWidth ) | 0;\n            var tmpText = text.substring(fuzzyLen);\n            var width = allWidth - measureText(tmpText);\n            var sLine = tmpText;\n            var pushNum = 0;\n\n            var checkWhile = 0;\n            var checkCount = 10;\n\n            //Exceeded the size\n            while (width > maxWidth && checkWhile++ < checkCount) {\n                fuzzyLen *= maxWidth / width;\n                fuzzyLen = fuzzyLen | 0;\n                tmpText = text.substring(fuzzyLen);\n                width = allWidth - measureText(tmpText);\n            }\n\n            checkWhile = 0;\n\n            //Find the truncation point\n            while (width <= maxWidth && checkWhile++ < checkCount) {\n                if (tmpText) {\n                    var exec = this.label_wordRex.exec(tmpText);\n                    pushNum = exec ? exec[0].length : 1;\n                    sLine = tmpText;\n                }\n\n                fuzzyLen = fuzzyLen + pushNum;\n                tmpText = text.substring(fuzzyLen);\n                width = allWidth - measureText(tmpText);\n            }\n\n            fuzzyLen -= pushNum;\n            if (fuzzyLen === 0) {\n                fuzzyLen = 1;\n                sLine = sLine.substring(1);\n            }\n\n            var sText = text.substring(0, 0 + fuzzyLen), result;\n\n            //symbol in the first\n            if (this.label_wrapinspection) {\n                if (this.label_symbolRex.test(sLine || tmpText)) {\n                    result = this.label_lastWordRex.exec(sText);\n                    fuzzyLen -= result ? result[0].length : 0;\n                    if (fuzzyLen === 0) fuzzyLen = 1;\n\n                    sLine = text.substring(fuzzyLen);\n                    sText = text.substring(0, 0 + fuzzyLen);\n                }\n            }\n\n            // To judge whether a Emoji words are truncated\n            // todo Some Emoji are not well adapted, such as 🚗 and 🇨🇳\n            if (this.label_firstEmoji.test(sLine)) {\n                result = this.label_lastEmoji.exec(sText);\n                if (result && sText !== result[0]) {\n                    fuzzyLen -= result[0].length;\n                    sLine = text.substring(fuzzyLen);\n                    sText = text.substring(0, 0 + fuzzyLen);\n                }\n            }\n\n            //To judge whether a English words are truncated\n            if (this.label_firstEnglish.test(sLine)) {\n                result = this.label_lastEnglish.exec(sText);\n                if (result && sText !== result[0]) {\n                    fuzzyLen -= result[0].length;\n                    sLine = text.substring(fuzzyLen);\n                    sText = text.substring(0, 0 + fuzzyLen);\n                }\n            }\n\n            // The first line And do not wrap should not remove the space\n            if (wrappedWords.length === 0) {\n                wrappedWords.push(sText);\n            }\n            else {\n                sText = sText.trimLeft();\n                if (sText.length > 0) {\n                    wrappedWords.push(sText);\n                }\n            }\n            text = sLine || tmpText;\n            allWidth = measureText(text);\n        }\n\n        if (wrappedWords.length === 0) {\n            wrappedWords.push(text);\n        }\n        else {\n            text = text.trimLeft();\n            if (text.length > 0) {\n                wrappedWords.push(text);\n            }\n        }\n        return wrappedWords;\n    },\n};\n\ncc.textUtils = module.exports = textUtils;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst Texture2D = require('../assets/CCTexture2D');\n\n/**\n * cc.textureUtil is a singleton object, it can load cc.Texture2D asynchronously\n * @class textureUtil\n * @static\n */\nlet textureUtil = {\n    loadImage (url, cb, target) {\n        cc.assertID(url, 3103);\n\n        var tex = cc.loader.getRes(url);\n        if (tex) {\n            if (tex.loaded) {\n                cb && cb.call(target, null, tex);\n                return tex;\n            }\n            else\n            {\n                tex.once(\"load\", function(){\n                   cb && cb.call(target, null, tex);\n                }, target);\n                return tex;\n            }\n        }\n        else {\n            tex = new Texture2D();\n            tex.url = url;\n            cc.loader.load({url: url, texture: tex}, function (err, texture) {\n                if (err) {\n                    return cb && cb.call(target, err || new Error('Unknown error'));\n                }\n                texture.handleLoadedTexture();\n                cb && cb.call(target, null, texture);\n            });\n            return tex;\n        }\n    },\n\n    cacheImage (url, image) {\n        if (url && image) {\n            var tex = new Texture2D();\n            tex.initWithElement(image);\n            var item = {\n                id: url,\n                url: url, // real download url, maybe changed\n                error: null,\n                content: tex,\n                complete: false\n            }\n            cc.loader.flowOut(item);\n            return tex;\n        }\n    },\n\n    postLoadTexture (texture, callback) {\n        if (texture.loaded) {\n            callback && callback();\n            return;\n        }\n        if (!texture.url) {\n            callback && callback();\n            return;\n        }\n        // load image\n        cc.loader.load({\n            url: texture.url,\n            // For uncompressed image, we should skip loader otherwise it will load a new texture.\n            // compressed texture need loader to parse data\n            skips: texture._isCompressed() ? undefined : ['Loader'],\n        }, function (err, image) {\n            if (image) {\n                if (CC_DEBUG && image instanceof cc.Texture2D) {\n                    return cc.error('internal error: loader handle pipe must be skipped');\n                }\n                if (!texture.loaded) {\n                    texture._nativeAsset = image;\n                }\n            }\n            callback && callback(err);\n        });\n    }\n};\n\ncc.textureUtil = module.exports = textureUtil;","/****************************************************************************\n Copyright (c) 2019 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nlet NodeUnit = require('./node-unit');\nlet NodeMemPool = require('./node-mem-pool');\n\nmodule.exports = {\n    NodeMemPool: new NodeMemPool(NodeUnit)\n};","/****************************************************************************\n Copyright (c) 2019 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nlet MemPool = function (unitClass) {\n    this._unitClass = unitClass;\n    this._pool = [];\n    this._findOrder = [];\n\n    if (CC_JSB && CC_NATIVERENDERER) {\n        this._initNative();\n    }\n};\n\nlet proto = MemPool.prototype;\nproto._initNative = function () {\n    this._nativeMemPool = new renderer.MemPool();\n};\n\nproto._buildUnit = function (unitID) {\n    let unit = new this._unitClass(unitID, this);\n    if (CC_JSB && CC_NATIVERENDERER) {\n        this._nativeMemPool.updateCommonData(unitID, unit._data, unit._signData);\n    }\n    return unit;\n};\n\nproto._destroyUnit = function (unitID) {\n    this._pool[unitID] = null;\n    for (let idx = 0, n = this._findOrder.length; idx < n; idx++) {\n        let unit = this._findOrder[idx];\n        if (unit && unit.unitID == unitID) {\n            this._findOrder.splice(idx, 1);\n            break;\n        }\n    }\n    if (CC_JSB && CC_NATIVERENDERER) {\n        this._nativeMemPool.removeCommonData(unitID);\n    }\n};\n\nproto._findUnitID = function () {\n    let unitID = 0;\n    let pool = this._pool;\n    while (pool[unitID]) unitID++;\n    return unitID;\n};\n\nproto.pop = function () {\n    let findUnit = null;\n    let idx = 0;\n    let findOrder = this._findOrder;\n    let pool = this._pool;\n    for (let n = findOrder.length; idx < n; idx++) {\n        let unit = findOrder[idx];\n        if (unit && unit.hasSpace()) {\n            findUnit = unit;\n            break;\n        }\n    }\n\n    if (!findUnit) {\n        let unitID = this._findUnitID();\n        findUnit = this._buildUnit(unitID);\n        pool[unitID] = findUnit;\n        findOrder.push(findUnit);\n        idx = findOrder.length - 1;\n    }\n\n    // swap has space unit to first position, so next find will fast\n    let firstUnit = findOrder[0];\n    if (firstUnit !== findUnit) {\n        findOrder[0] = findUnit;\n        findOrder[idx] = firstUnit;\n    }\n\n    return findUnit.pop();\n};\n\nproto.push = function (info) {\n    let unit = this._pool[info.unitID];\n    unit.push(info.index);\n    if (this._findOrder.length > 1 && unit.isAllFree()) {\n        this._destroyUnit(info.unitID);\n    }\n    return unit;\n};\nmodule.exports = MemPool;","/****************************************************************************\n Copyright (c) 2019 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nlet MemPool = require('./mem-pool');\nlet NodeMemPool = function (unitClass) {\n    MemPool.call(this, unitClass);\n};\n\n(function(){\n    let Super = function(){};\n    Super.prototype = MemPool.prototype;\n    NodeMemPool.prototype = new Super();\n})();\n\nlet proto = NodeMemPool.prototype;\nproto._initNative = function () {\n    this._nativeMemPool = new renderer.NodeMemPool();\n};\n\nproto._destroyUnit = function (unitID) {\n    MemPool.prototype._destroyUnit.call(this, unitID);\n    if (CC_JSB && CC_NATIVERENDERER) {\n        this._nativeMemPool.removeNodeData(unitID);\n    }\n};\n\nmodule.exports = NodeMemPool;","/****************************************************************************\n Copyright (c) 2019 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport { FLOAT_ARRAY_TYPE, FLOAT_BYTES } from '../../value-types/utils'\n\nconst Uint32_Bytes = 4;\nconst Uint8_Bytes = 1;\n\n// Space : [Dirty]                                  [Size:4 Uint32]\nconst Dirty_Type = Uint32Array;\nconst Dirty_Members = 1;\nconst Dirty_Stride = Dirty_Members * Uint32_Bytes;\n\n// Space : [TRS]                                    [Size:4 * 10 Float32|Float64]\nconst TRS_Members = 10;\nconst TRS_Stride = TRS_Members * FLOAT_BYTES;\n\n// Space : [LocalMatrix]                            [Size:4 * 16 Float32|Float64]\nconst LocalMatrix_Members = 16;\nconst LocalMatrix_Stride = LocalMatrix_Members * FLOAT_BYTES;\n\n// Space : [WorldMatrix]                            [Size:4 * 16 Float32|Float64]\nconst WorldMatrix_Members = 16;\nconst WorldMatrix_Stride = WorldMatrix_Members * FLOAT_BYTES;\n\n// Space : [Parent Unit]                            [Size:4 Uint32]\n// Space : [Parent Index]                           [Size:4 Uint32]\nconst Parent_Type = Uint32Array;\nconst Parent_Members = 2;\nconst Parent_Stride = Parent_Members * Uint32_Bytes;\n\n// Space : [ZOrder]                                 [Size:4 Uint32]\nconst ZOrder_Type = Uint32Array;\nconst ZOrder_Members = 1;\nconst ZOrder_Stride = ZOrder_Members * Uint32_Bytes;\n\n// Space : [CullingMask]                            [Size:4 Int32]\nconst CullingMask_Type = Int32Array;\nconst CullingMask_Members = 1;\nconst CullingMask_Stride = CullingMask_Members * Uint32_Bytes;\n\n// Space : [Opacity]                                [Size:1 Uint8]\nconst Opacity_Type = Uint8Array;\nconst Opacity_Members = 1;\nconst Opacity_Stride = Opacity_Members * Uint8_Bytes;\n\n// Space : [Is3D]                                   [Size:1 Uint8]\nconst Is3D_Type = Uint8Array;\nconst Is3D_Members = 1;\nconst Is3D_Stride = Is3D_Members * Uint8_Bytes;\n\n// Space : [NodePtr]                                [Size:4 * 2 Uint32]\nconst Node_Type = Uint32Array;\nconst Node_Members = 2;\n\n// Space : [Skew]                                   [Size:4 * 2 Float32]\nconst Skew_Members = 2;\nconst Skew_Stride = Skew_Members * FLOAT_BYTES;\n\nlet UnitBase = require('./unit-base');\nlet NodeUnit = function (unitID, memPool) {\n    UnitBase.call(this, unitID, memPool);\n\n    let contentNum = this._contentNum;\n    this.trsList = new FLOAT_ARRAY_TYPE(contentNum * TRS_Members);\n    this.localMatList = new FLOAT_ARRAY_TYPE(contentNum * LocalMatrix_Members);\n    this.worldMatList = new FLOAT_ARRAY_TYPE(contentNum * WorldMatrix_Members);\n\n    if (CC_JSB && CC_NATIVERENDERER) {\n        this.dirtyList = new Dirty_Type(contentNum * Dirty_Members);\n        this.parentList = new Parent_Type(contentNum * Parent_Members);\n        this.zOrderList = new ZOrder_Type(contentNum * ZOrder_Members);\n        this.cullingMaskList = new CullingMask_Type(contentNum * CullingMask_Members);\n        this.opacityList = new Opacity_Type(contentNum * Opacity_Members);\n        this.is3DList = new Is3D_Type(contentNum * Is3D_Members);\n        this.nodeList = new Node_Type(contentNum * Node_Members);\n        this.skewList = new FLOAT_ARRAY_TYPE(contentNum * Skew_Members);\n\n        this._memPool._nativeMemPool.updateNodeData(\n            unitID,\n            this.dirtyList,\n            this.trsList,\n            this.localMatList,\n            this.worldMatList,\n            this.parentList,\n            this.zOrderList,\n            this.cullingMaskList,\n            this.opacityList,\n            this.is3DList,\n            this.nodeList,\n            this.skewList\n        );\n    }\n\n    for (let i = 0; i < contentNum; i ++) {\n        let space = this._spacesData[i];\n\n        space.trs = new FLOAT_ARRAY_TYPE(this.trsList.buffer, i * TRS_Stride, TRS_Members);\n        space.localMat = new FLOAT_ARRAY_TYPE(this.localMatList.buffer, i * LocalMatrix_Stride, LocalMatrix_Members);\n        space.worldMat = new FLOAT_ARRAY_TYPE(this.worldMatList.buffer, i * WorldMatrix_Stride, WorldMatrix_Members);\n\n        if (CC_JSB && CC_NATIVERENDERER) {\n            space.dirty = new Dirty_Type(this.dirtyList.buffer, i * Dirty_Stride, Dirty_Members);\n            space.parent = new Parent_Type(this.parentList.buffer, i * Parent_Stride, Parent_Members);\n            space.zOrder = new ZOrder_Type(this.zOrderList.buffer, i * ZOrder_Stride, ZOrder_Members);\n            space.cullingMask = new CullingMask_Type(this.cullingMaskList.buffer, i * CullingMask_Stride, CullingMask_Members);\n            space.opacity = new Opacity_Type(this.opacityList.buffer, i * Opacity_Stride, Opacity_Members);\n            space.is3D = new Is3D_Type(this.is3DList.buffer, i * Is3D_Stride, Is3D_Members);\n            space.skew = new FLOAT_ARRAY_TYPE(this.skewList.buffer, i * Skew_Stride, Skew_Members);\n        }\n    }\n};\n\n(function(){\n    let Super = function(){};\n    Super.prototype = UnitBase.prototype;\n    NodeUnit.prototype = new Super();\n})();\n\nmodule.exports = NodeUnit;","/****************************************************************************\n Copyright (c) 2019 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n// Unit has many segment, layout such as :\n// Head Free Pointer + Using Segment Num + Segment 1 + Segment 2 + Segment 3 ...\n\n// sign data format\n// Space : [If Free Flag]                          [Size:1 Uint16]\n// Space : [Next Free Index]                       [Size:1 Uint16]\n\n// invalid pointer value\nlet POINTER_INVALID_FLAG = 0xffff;\nlet SPACE_FREE_FLAG = 0x0;\nlet SPACE_USE_FLAG = 0x1;\nlet POS_NEXT_FREE = 0;\nlet POS_FREE_FLAG = 1;\n\nlet UnitBase = function (unitID, memPool, contentNum) {\n    contentNum = contentNum || 128;\n\n    // set unit id\n    this.unitID = unitID;\n    this._memPool = memPool;\n\n    this._data = new Uint16Array(2);\n    // head of the free content index\n    this._data[0] = 0;\n    // using segment num\n    this._data[1] = 0;\n\n    this._contentNum = contentNum;\n    this._signData = new Uint16Array(this._contentNum * 2);\n    this._spacesData = [];\n\n    for (let i = 0; i < contentNum; i++) {\n        let signIndex = i * 2;\n        // store content block index but not sign array index\n        this._signData[signIndex + POS_NEXT_FREE] = i + 1;\n        this._signData[signIndex + POS_FREE_FLAG] = SPACE_FREE_FLAG;\n\n        this._spacesData[i] = {\n            index: i,\n            unitID: unitID,\n        };\n    }\n    // last one has no next space;\n    this._signData[(contentNum - 1) * 2] = POINTER_INVALID_FLAG;\n};\n\nlet UnitBaseProto = UnitBase.prototype;\nUnitBaseProto.hasSpace = function () {\n    return this._data[0] !== POINTER_INVALID_FLAG;\n};\n\nUnitBaseProto.isAllFree = function () {\n    return this._data[1] == 0;\n};\n\n// pop space from unit\nUnitBaseProto.pop = function () {\n    let headFreeIndex = this._data[0];\n    if (headFreeIndex === POINTER_INVALID_FLAG) return null;\n\n    let index = headFreeIndex;\n    let signIndex = index * 2;\n    let space = this._spacesData[index];\n\n    // set use flag\n    this._signData[signIndex + POS_FREE_FLAG] = SPACE_USE_FLAG;\n\n    // store new next free space index\n    this._data[0] = this._signData[signIndex + POS_NEXT_FREE];\n    // add using segment num\n    this._data[1]++;\n    return space;\n};\n\n// push back to unit\nUnitBaseProto.push = function (index) {\n    let signIndex = index * 2;\n\n    // set free flag\n    this._signData[signIndex + POS_FREE_FLAG] = SPACE_FREE_FLAG;\n\n    // store head free index to the space\n    this._signData[signIndex + POS_NEXT_FREE] = this._data[0];\n    // update head free index\n    this._data[0] = index;\n    // sub using segment num\n    this._data[1]--;\n};\n\n// dump all space info\nUnitBaseProto.dump = function () {\n    let spaceNum = 0;\n    let index = this._data[0];\n    let freeStr = \"\";\n    \n    while (index != POINTER_INVALID_FLAG) {\n        spaceNum ++;\n        freeStr += index + \"->\";\n        index = this._signData[index * 2 + POS_NEXT_FREE];\n    }\n\n    let usingNum = 0;\n    let usingStr = \"\";\n    let contentNum = this._contentNum;\n    for (let i = 0; i < contentNum; i++) {\n        let freeFlag = this._signData[i * 2 + POS_FREE_FLAG];\n        if (freeFlag == SPACE_USE_FLAG) {\n            usingNum ++;\n            usingStr += i + \"->\";\n        }\n    }\n    \n    let totalNum = spaceNum + usingNum;\n    console.log(\n        \"unitID:\", this.unitID, \n        \"spaceNum:\", spaceNum, \n        \"calc using num:\", usingNum, \n        'store using num:', this._data[1], \n        'calc total num:', totalNum, \n        'actually total num:', this._contentNum\n    );\n    console.log(\"free info:\", freeStr);\n    console.log(\"using info:\", usingStr);\n\n    if (usingNum != this._data[1]) {\n        cc.error(\n            'using num error', \n            \"calc using num:\", usingNum, \n            'store using num:', this._data[1]\n        );\n    }\n\n    if (spaceNum + usingNum != this._contentNum) {\n        cc.error(\n            'total num error', \n            'calc total num:', totalNum, \n            'actually total num:', this._contentNum\n        );\n    }\n};\n\nmodule.exports = UnitBase;","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport ValueType from './value-type';\nimport CCClass from '../platform/CCClass';\nimport misc from '../utils/misc';\n\n/**\n * !#en\n * Representation of RGBA colors.\n *\n * Each color component is a floating point value with a range from 0 to 255.\n *\n * You can also use the convenience method {{#crossLink \"cc/color:method\"}}cc.color{{/crossLink}} to create a new Color.\n *\n * !#zh\n * cc.Color 用于表示颜色。\n *\n * 它包含 RGBA 四个以浮点数保存的颜色分量，每个的值都在 0 到 255 之间。\n *\n * 您也可以通过使用 {{#crossLink \"cc/color:method\"}}cc.color{{/crossLink}} 的便捷方法来创建一个新的 Color。\n *\n * @class Color\n * @extends ValueType\n */\nexport default class Color extends ValueType {\n    static div = Color.divide;\n    static sub = Color.subtract;\n    static mul = Color.multiply;\n\n    /**\n     * !#en Solid white, RGBA is [255, 255, 255, 255].\n     * !#zh 纯白色，RGBA 是 [255, 255, 255, 255]。\n     * @property WHITE\n     * @type {Color}\n     * @static\n     */\n    static get WHITE () { return new Color(255, 255, 255, 255); }\n    static readonly WHITE_R: Color = Color.WHITE;\n\n    /**\n     * !#en Solid black, RGBA is [0, 0, 0, 255].\n     * !#zh 纯黑色，RGBA 是 [0, 0, 0, 255]。\n     * @property BLACK\n     * @type {Color}\n     * @static\n     */\n    static get BLACK () { return new Color(0, 0, 0, 255); }\n    static readonly BLACK_R: Color = Color.BLACK;\n\n    /**\n     * !#en Transparent, RGBA is [0, 0, 0, 0].\n     * !#zh 透明，RGBA 是 [0, 0, 0, 0]。\n     * @property TRANSPARENT\n     * @type {Color}\n     * @static\n     */\n    static get TRANSPARENT () { return new Color(0, 0, 0, 0); }\n    static readonly TRANSPARENT_R: Color = Color.TRANSPARENT;\n\n    /**\n     * !#en Grey, RGBA is [127.5, 127.5, 127.5].\n     * !#zh 灰色，RGBA 是 [127.5, 127.5, 127.5]。\n     * @property GRAY\n     * @type {Color}\n     * @static\n     */\n    static get GRAY () { return new Color(127.5, 127.5, 127.5); }\n    static readonly GRAY_R: Color = Color.GRAY;\n\n    /**\n     * !#en Solid red, RGBA is [255, 0, 0].\n     * !#zh 纯红色，RGBA 是 [255, 0, 0]。\n     * @property RED\n     * @type {Color}\n     * @static\n     */\n    static get RED () { return new Color(255, 0, 0); }\n    static readonly RED_R: Color = Color.RED;\n    /**\n     * !#en Solid green, RGBA is [0, 255, 0].\n     * !#zh 纯绿色，RGBA 是 [0, 255, 0]。\n     * @property GREEN\n     * @type {Color}\n     * @static\n     */\n    static get GREEN () { return new Color(0, 255, 0); }\n    static readonly GREEN_R: Color = Color.GREEN;\n    /**\n     * !#en Solid blue, RGBA is [0, 0, 255].\n     * !#zh 纯蓝色，RGBA 是 [0, 0, 255]。\n     * @property BLUE\n     * @type {Color}\n     * @static\n     */\n    static get BLUE () { return new Color(0, 0, 255); }\n    static readonly BLUE_R: Color = Color.BLUE;\n    /**\n     * !#en Yellow, RGBA is [255, 235, 4].\n     * !#zh 黄色，RGBA 是 [255, 235, 4]。\n     * @property YELLOW\n     * @type {Color}\n     * @static\n     */\n    static get YELLOW () { return new Color(255, 235, 4); }\n    static readonly YELLOW_R: Color = Color.YELLOW;\n    /**\n     * !#en Orange, RGBA is [255, 127, 0].\n     * !#zh 橙色，RGBA 是 [255, 127, 0]。\n     * @property ORANGE\n     * @type {Color}\n     * @static\n     */\n    static get ORANGE () { return new Color(255, 127, 0); }\n    static readonly ORANGE_R: Color = Color.ORANGE;\n    /**\n     * !#en Cyan, RGBA is [0, 255, 255].\n     * !#zh 青色，RGBA 是 [0, 255, 255]。\n     * @property CYAN\n     * @type {Color}\n     * @static\n     */\n    static get CYAN () { return new Color(0, 255, 255); }\n    static readonly CYAN_R: Color = Color.CYAN;\n    /**\n     * !#en Magenta, RGBA is [255, 0, 255].\n     * !#zh 洋红色（品红色），RGBA 是 [255, 0, 255]。\n     * @property MAGENTA\n     * @type {Color}\n     * @static\n     */\n    static get MAGENTA () { return new Color(255, 0, 255); }\n    static readonly MAGENTA_R: Color = Color.MAGENTA;\n\n    /**\n     * Copy content of a color into another.\n     * @method copy\n     * @typescript\n     * copy (out: Color, a: Color): Color\n     * @static\n     */\n    static copy (out: Color, a: Color): Color {\n        out.r = a.r;\n        out.g = a.g;\n        out.b = a.b;\n        out.a = a.a;\n        return out;\n    }\n\n    /**\n     * Clone a new color.\n     * @method clone\n     * @typescript\n     * clone (a: Color): Color\n     * @static\n     */\n    static clone (a: Color): Color {\n        return new Color(a.r, a.g, a.b, a.a);\n    }\n\n    /**\n     * Set the components of a color to the given values.\n     * @method set\n     * @typescript\n     * set (out: Color, r = 255, g = 255, b = 255, a = 255): Color\n     * @static\n     */\n    static set (out: Color, r = 255, g = 255, b = 255, a = 255): Color {\n        out.r = r;\n        out.g = g;\n        out.b = b;\n        out.a = a;\n        return out;\n    }\n\n    /**\n     * Converts the hexadecimal formal color into rgb formal.\n     * @method fromHex\n     * @typescript\n     * fromHex (out: Color, hex: number): Color\n     * @static\n     */\n    static fromHex (out: Color, hex: number): Color {\n        let r = ((hex >> 24)) / 255.0;\n        let g = ((hex >> 16) & 0xff) / 255.0;\n        let b = ((hex >> 8) & 0xff) / 255.0;\n        let a = ((hex) & 0xff) / 255.0;\n\n        out.r = r;\n        out.g = g;\n        out.b = b;\n        out.a = a;\n        return out;\n    }\n\n    /**\n     * Add components of two colors, respectively.\n     * @method add\n     * @typescript\n     * add (out: Color, a: Color, b: Color): Color\n     * @static\n     */\n    static add (out: Color, a: Color, b: Color): Color {\n        out.r = a.r + b.r;\n        out.g = a.g + b.g;\n        out.b = a.b + b.b;\n        out.a = a.a + b.a;\n        return out;\n    }\n\n    /**\n     * Subtract components of color b from components of color a, respectively.\n     * @method subtract\n     * @typescript\n     * subtract (out: Color, a: Color, b: Color): Color\n     * @static\n     */\n    static subtract (out: Color, a: Color, b: Color): Color {\n        out.r = a.r - b.r;\n        out.g = a.g - b.g;\n        out.b = a.b - b.b;\n        out.a = a.a - b.a;\n        return out;\n    }\n\n    /**\n     * Multiply components of two colors, respectively.\n     * @method multiply\n     * @typescript\n     * multiply (out: Color, a: Color, b: Color): Color\n     * @static\n     */\n    static multiply (out: Color, a: Color, b: Color): Color {\n        out.r = a.r * b.r;\n        out.g = a.g * b.g;\n        out.b = a.b * b.b;\n        out.a = a.a * b.a;\n        return out;\n    }\n\n    /**\n     * Divide components of color a by components of color b, respectively.\n     * @method divide\n     * @typescript\n     * divide (out: Color, a: Color, b: Color): Color\n     * @static\n     */\n    static divide (out: Color, a: Color, b: Color): Color {\n        out.r = a.r / b.r;\n        out.g = a.g / b.g;\n        out.b = a.b / b.b;\n        out.a = a.a / b.a;\n        return out;\n    }\n\n    /**\n     * Scales a color by a number.\n     * @method scale\n     * @typescript\n     * scale (out: Color, a: Color, b: number): Color\n     * @static\n     */\n    static scale (out: Color, a: Color, b: number): Color {\n        out.r = a.r * b;\n        out.g = a.g * b;\n        out.b = a.b * b;\n        out.a = a.a * b;\n        return out;\n    }\n\n    /**\n     * Performs a linear interpolation between two colors.\n     * @method lerp\n     * @typescript\n     * lerp (out: Color, a: Color, b: Color, t: number): Color\n     * @static\n     */\n    static lerp (out: Color, a: Color, b: Color, t: number): Color {\n        let ar = a.r,\n            ag = a.g,\n            ab = a.b,\n            aa = a.a;\n        out.r = ar + t * (b.r - ar);\n        out.g = ag + t * (b.g - ag);\n        out.b = ab + t * (b.b - ab);\n        out.a = aa + t * (b.a - aa);\n        return out;\n    }\n\n    /**\n     * !#zh 颜色转数组\n     * !#en Turn an array of colors\n     * @method toArray\n     * @typescript\n     * toArray <Out extends IWritableArrayLike<number>> (out: Out, a: IColorLike, ofs = 0)\n     * @param ofs 数组起始偏移量\n     * @static\n     */\n    static toArray<Out extends IWritableArrayLike<number>> (out: Out, a: IColorLike, ofs = 0) {\n        const scale = (a instanceof Color || a.a > 1) ? 1 / 255 : 1;\n        out[ofs + 0] = a.r * scale;\n        out[ofs + 1] = a.g * scale;\n        out[ofs + 2] = a.b * scale;\n        out[ofs + 3] = a.a * scale;\n        return out;\n    }\n\n    /**\n     * !#zh 数组转颜色\n     * !#en An array of colors turn\n     * @method fromArray\n     * @typescript\n     * fromArray <Out extends IColorLike> (arr: IWritableArrayLike<number>, out: Out, ofs = 0)\n     * @param ofs 数组起始偏移量\n     * @static\n     */\n    static fromArray<Out extends IColorLike> (arr: IWritableArrayLike<number>, out: Out, ofs = 0) {\n        out.r = arr[ofs + 0] * 255;\n        out.g = arr[ofs + 1] * 255;\n        out.b = arr[ofs + 2] * 255;\n        out.a = arr[ofs + 3] * 255;\n        return out;\n    }\n\n    _val: number = 0;\n\n    /**\n     * @method constructor\n     * @param {Number} [r=0] - red component of the color, default value is 0.\n     * @param {Number} [g=0] - green component of the color, defualt value is 0.\n     * @param {Number} [b=0] - blue component of the color, default value is 0.\n     * @param {Number} [a=255] - alpha component of the color, default value is 255.\n     */\n    constructor (r: Color | number = 0, g: number = 0, b: number = 0, a: number = 255) {\n        super();\n        if (typeof r === 'object') {\n            g = r.g;\n            b = r.b;\n            a = r.a;\n            r = r.r;\n        }\n\n        this._val = ((a << 24) >>> 0) + (b << 16) + (g << 8) + r;\n    }\n\n    /**\n     * !#en Clone a new color from the current color.\n     * !#zh 克隆当前颜色。\n     * @method clone\n     * @return {Color} Newly created color.\n     * @example\n     * var color = new cc.Color();\n     * var newColor = color.clone();// Color {r: 0, g: 0, b: 0, a: 255}\n     */\n    clone (): Color {\n        var ret = new Color();\n        ret._val = this._val;\n        return ret;\n    }\n\n    /**\n     * !#en TODO\n     * !#zh 判断两个颜色是否相等。\n     * @method equals\n     * @param {Color} other\n     * @return {Boolean}\n     * @example\n     * var color1 = cc.Color.WHITE;\n     * var color2 = new cc.Color(255, 255, 255);\n     * cc.log(color1.equals(color2)); // true;\n     * color2 = cc.Color.RED;\n     * cc.log(color2.equals(color1)); // false;\n     */\n    equals (other: Color): boolean {\n        return other && this._val === other._val;\n    }\n\n    /**\n     * !#en TODO\n     * !#zh 线性插值\n     * @method lerp\n     * @param {Color} to\n     * @param {number} ratio - the interpolation coefficient.\n     * @param {Color} [out] - optional, the receiving vector.\n     * @return {Color}\n     * @example {@link cocos2d/core/value-types/CCColor/lerp.js}\n     */\n    lerp (to: Color, ratio: number, out?: Color): Color {\n        out = out || new Color();\n        var r = this.r;\n        var g = this.g;\n        var b = this.b;\n        var a = this.a;\n        out.r = r + (to.r - r) * ratio;\n        out.g = g + (to.g - g) * ratio;\n        out.b = b + (to.b - b) * ratio;\n        out.a = a + (to.a - a) * ratio;\n        return out;\n    };\n\n    /**\n     * !#en TODO\n     * !#zh 转换为方便阅读的字符串。\n     * @method toString\n     * @return {String}\n     * @example\n     * var color = cc.Color.WHITE;\n     * color.toString(); // \"rgba(255, 255, 255, 255)\"\n     */\n    toString (): string {\n        return \"rgba(\" +\n            this.r.toFixed() + \", \" +\n            this.g.toFixed() + \", \" +\n            this.b.toFixed() + \", \" +\n            this.a.toFixed() + \")\";\n    };\n\n    /**\n     * !#en Get or set red channel value\n     * !#zh 获取或者设置红色通道\n     * @property {number} r\n     */\n    get r (): number {\n        return this.getR();\n    }\n    set r (v: number) {\n        this.setR(v);\n    }\n\n    /**\n     * !#en Get or set green channel value\n     * !#zh 获取或者设置绿色通道\n     * @property {number} g\n     */\n    get g (): number {\n        return this.getG();\n    }\n    set g (v: number) {\n        this.setG(v);\n    }\n\n    /**\n     * !#en Get or set blue channel value\n     * !#zh 获取或者设置蓝色通道\n     * @property {number} b\n     */\n    get b (): number {\n        return this.getB();\n    }\n    set b (v: number) {\n        this.setB(v);\n    }\n\n    /**\n     * !#en Get or set alpha channel value\n     * !#zh 获取或者设置透明通道\n     * @property {number} a\n     */\n    get a (): number {\n        return this.getA();\n    }\n    set a (v: number) {\n        this.setA(v);\n    }\n\n    /**\n     * !#en Gets red channel value\n     * !#zh 获取当前颜色的红色值。\n     * @method getR\n     * @return {Number} red value.\n     */\n    getR (): number {\n        return this._val & 0x000000ff;\n    }\n    /**\n     * !#en Sets red value and return the current color object\n     * !#zh 设置当前的红色值，并返回当前对象。\n     * @method setR\n     * @param {Number} red - the new Red component.\n     * @return {Color} this color.\n     * @example\n     * var color = new cc.Color();\n     * color.setR(255); // Color {r: 255, g: 0, b: 0, a: 255}\n     */\n    setR (red): this {\n        red = ~~misc.clampf(red, 0, 255);\n        this._val = ((this._val & 0xffffff00) | red) >>> 0;\n        return this;\n    }\n    /**\n     * !#en Gets green channel value\n     * !#zh 获取当前颜色的绿色值。\n     * @method getG\n     * @return {Number} green value.\n     */\n    getG (): number {\n        return (this._val & 0x0000ff00) >> 8;\n    }\n    /**\n     * !#en Sets green value and return the current color object\n     * !#zh 设置当前的绿色值，并返回当前对象。\n     * @method setG\n     * @param {Number} green - the new Green component.\n     * @return {Color} this color.\n     * @example\n     * var color = new cc.Color();\n     * color.setG(255); // Color {r: 0, g: 255, b: 0, a: 255}\n     */\n    setG (green): this {\n        green = ~~misc.clampf(green, 0, 255);\n        this._val = ((this._val & 0xffff00ff) | (green << 8)) >>> 0;\n        return this;\n    }\n    /**\n     * !#en Gets blue channel value\n     * !#zh 获取当前颜色的蓝色值。\n     * @method getB\n     * @return {Number} blue value.\n     */\n    getB (): number {\n        return (this._val & 0x00ff0000) >> 16;\n    }\n    /**\n     * !#en Sets blue value and return the current color object\n     * !#zh 设置当前的蓝色值，并返回当前对象。\n     * @method setB\n     * @param {Number} blue - the new Blue component.\n     * @return {Color} this color.\n     * @example\n     * var color = new cc.Color();\n     * color.setB(255); // Color {r: 0, g: 0, b: 255, a: 255}\n     */\n    setB (blue): this {\n        blue = ~~misc.clampf(blue, 0, 255);\n        this._val = ((this._val & 0xff00ffff) | (blue << 16)) >>> 0;\n        return this;\n    }\n    /**\n     * !#en Gets alpha channel value\n     * !#zh 获取当前颜色的透明度值。\n     * @method getA\n     * @return {Number} alpha value.\n     */\n    getA (): number {\n        return (this._val & 0xff000000) >>> 24;\n    }\n    /**\n     * !#en Sets alpha value and return the current color object\n     * !#zh 设置当前的透明度，并返回当前对象。\n     * @method setA\n     * @param {Number} alpha - the new Alpha component.\n     * @return {Color} this color.\n     * @example\n     * var color = new cc.Color();\n     * color.setA(0); // Color {r: 0, g: 0, b: 0, a: 0}\n     */\n    setA (alpha): this {\n        alpha = ~~misc.clampf(alpha, 0, 255);\n        this._val = ((this._val & 0x00ffffff) | (alpha << 24)) >>> 0;\n        return this;\n    }\n\n    /**\n     * !#en Convert color to css format.\n     * !#zh 转换为 CSS 格式。\n     * @method toCSS\n     * @param {String} [opt=\"rgba\"] - \"rgba\", \"rgb\", \"#rgb\" or \"#rrggbb\".\n     * @return {String}\n     * @example\n     * var color = cc.Color.BLACK;\n     * color.toCSS();          // \"rgba(0,0,0,1.00)\";\n     * color.toCSS(\"rgba\");    // \"rgba(0,0,0,1.00)\";\n     * color.toCSS(\"rgb\");     // \"rgba(0,0,0)\";\n     * color.toCSS(\"#rgb\");    // \"#000\";\n     * color.toCSS(\"#rrggbb\"); // \"#000000\";\n     */\n    toCSS (opt: string): string {\n        if (!opt || opt === 'rgba') {\n            return \"rgba(\" +\n                (this.r | 0) + \",\" +\n                (this.g | 0) + \",\" +\n                (this.b | 0) + \",\" +\n                (this.a / 255).toFixed(2) + \")\"\n                ;\n        }\n        else if (opt === 'rgb') {\n            return \"rgb(\" +\n                (this.r | 0) + \",\" +\n                (this.g | 0) + \",\" +\n                (this.b | 0) + \")\"\n                ;\n        }\n        else {\n            return '#' + this.toHEX(opt);\n        }\n    }\n\n    /**\n     * !#en Read hex string and store color data into the current color object, the hex string must be formated as rgba or rgb.\n     * !#zh 读取 16 进制颜色。\n     * @method fromHEX\n     * @param {String} hexString\n     * @return {Color}\n     * @chainable\n     * @example\n     * var color = cc.Color.BLACK;\n     * color.fromHEX(\"#FFFF33\"); // Color {r: 255, g: 255, b: 51, a: 255};\n     */\n    fromHEX (hexString: string): this {\n        hexString = (hexString.indexOf('#') === 0) ? hexString.substring(1) : hexString;\n        let r = parseInt(hexString.substr(0, 2), 16) || 0;\n        let g = parseInt(hexString.substr(2, 2), 16) || 0;\n        let b = parseInt(hexString.substr(4, 2), 16) || 0;\n        let a = parseInt(hexString.substr(6, 2), 16) || 255;\n        this._val = ((a << 24) >>> 0) + (b << 16) + (g << 8) + r;\n        return this;\n    }\n\n    /**\n     * !#en convert Color to HEX color string.\n     * e.g.  cc.color(255,6,255)  to : \"#ff06ff\"\n     * !#zh 转换为 16 进制。\n     * @method toHEX\n     * @param {String} fmt - \"#rgb\", \"#rrggbb\" or \"#rrggbbaa\".\n     * @return {String}\n     * @example\n     * var color = cc.Color.BLACK;\n     * color.toHEX(\"#rgb\");     // \"000\";\n     * color.toHEX(\"#rrggbb\");  // \"000000\";\n     */\n    toHEX (fmt): string {\n        let prefix = '0';\n        let hex = [\n            (this.r < 16 ? prefix : '') + (this.r | 0).toString(16),\n            (this.g < 16 ? prefix : '') + (this.g | 0).toString(16),\n            (this.b < 16 ? prefix : '') + (this.b | 0).toString(16),\n        ];\n        var i = -1;\n        if (fmt === '#rgb') {\n            for (i = 0; i < hex.length; ++i) {\n                if (hex[i].length > 1) {\n                    hex[i] = hex[i][0];\n                }\n            }\n        }\n        else if (fmt === '#rrggbb') {\n            for (i = 0; i < hex.length; ++i) {\n                if (hex[i].length === 1) {\n                    hex[i] = '0' + hex[i];\n                }\n            }\n        }\n        else if (fmt === '#rrggbbaa') {\n            hex.push((this.a < 16 ? prefix : '') + (this.a | 0).toString(16));\n        }\n        return hex.join('');\n    };\n\n    /**\n     * !#en Convert to 24bit rgb value.\n     * !#zh 转换为 24bit 的 RGB 值。\n     * @method toRGBValue\n     * @return {Number}\n     * @example\n     * var color = cc.Color.YELLOW;\n     * color.toRGBValue(); // 16771844;\n     */\n    toRGBValue (): number {\n        return this._val & 0x00ffffff;\n    }\n\n    /**\n     * !#en Read HSV model color and convert to RGB color\n     * !#zh 读取 HSV（色彩模型）格式。\n     * @method fromHSV\n     * @param {Number} h\n     * @param {Number} s\n     * @param {Number} v\n     * @return {Color}\n     * @chainable\n     * @example\n     * var color = cc.Color.YELLOW;\n     * color.fromHSV(0, 0, 1); // Color {r: 255, g: 255, b: 255, a: 255};\n     */\n    fromHSV (h, s, v): this {\n        var r, g, b;\n        if (s === 0) {\n            r = g = b = v;\n        }\n        else {\n            if (v === 0) {\n                r = g = b = 0;\n            }\n            else {\n                if (h === 1) h = 0;\n                h *= 6;\n                s = s;\n                v = v;\n                var i = Math.floor(h);\n                var f = h - i;\n                var p = v * (1 - s);\n                var q = v * (1 - (s * f));\n                var t = v * (1 - (s * (1 - f)));\n                switch (i) {\n                    case 0:\n                        r = v;\n                        g = t;\n                        b = p;\n                        break;\n\n                    case 1:\n                        r = q;\n                        g = v;\n                        b = p;\n                        break;\n\n                    case 2:\n                        r = p;\n                        g = v;\n                        b = t;\n                        break;\n\n                    case 3:\n                        r = p;\n                        g = q;\n                        b = v;\n                        break;\n\n                    case 4:\n                        r = t;\n                        g = p;\n                        b = v;\n                        break;\n\n                    case 5:\n                        r = v;\n                        g = p;\n                        b = q;\n                        break;\n                }\n            }\n        }\n        r *= 255;\n        g *= 255;\n        b *= 255;\n        this._val = ((this.a << 24) >>> 0) + (b << 16) + (g << 8) + r;\n        return this;\n    }\n\n    /**\n     * !#en Transform to HSV model color\n     * !#zh 转换为 HSV（色彩模型）格式。\n     * @method toHSV\n     * @return {Object} - {h: number, s: number, v: number}.\n     * @example\n     * var color = cc.Color.YELLOW;\n     * color.toHSV(); // Object {h: 0.1533864541832669, s: 0.9843137254901961, v: 1};\n     */\n    toHSV () {\n        var r = this.r / 255;\n        var g = this.g / 255;\n        var b = this.b / 255;\n        var hsv = { h: 0, s: 0, v: 0 };\n        var max = Math.max(r, g, b);\n        var min = Math.min(r, g, b);\n        var delta = 0;\n        hsv.v = max;\n        hsv.s = max ? (max - min) / max : 0;\n        if (!hsv.s) hsv.h = 0;\n        else {\n            delta = max - min;\n            if (r === max) hsv.h = (g - b) / delta;\n            else if (g === max) hsv.h = 2 + (b - r) / delta;\n            else hsv.h = 4 + (r - g) / delta;\n            hsv.h /= 6;\n            if (hsv.h < 0) hsv.h += 1.0;\n        }\n        return hsv;\n    }\n\n    /**\n     * !#en Set the color\n     * !#zh 设置颜色\n     * @method set\n     * @typescript\n     * set (color: Color): Color\n     * @param {Color} color \n     */\n    set (color: Color): this {\n        if (color._val) {\n            this._val = color._val;\n        }\n        else {\n            this.r = color.r;\n            this.g = color.g;\n            this.b = color.b;\n            this.a = color.a;\n        }\n        return this;\n    }\n\n    _fastSetA (alpha) {\n        this._val = ((this._val & 0x00ffffff) | (alpha << 24)) >>> 0;\n    }\n\n    /**\n     * !#en Multiplies the current color by the specified color\n     * !#zh 将当前颜色乘以与指定颜色\n     * @method multiply\n     * @return {Color}\n     * @param {Color} other\n     */\n    multiply (other: Color) {\n        let r = ((this._val & 0x000000ff) * other.r) >> 8;\n        let g = ((this._val & 0x0000ff00) * other.g) >> 8;\n        let b = ((this._val & 0x00ff0000) * other.b) >> 8;\n        let a = ((this._val & 0xff000000) >>> 8) * other.a;\n        this._val = (a & 0xff000000) | (b & 0x00ff0000) | (g & 0x0000ff00) | (r & 0x000000ff);\n        return this;\n    }\n}\n\nCCClass.fastDefine('cc.Color', Color, { r: 0, g: 0, b: 0, a: 255 });\n\n\ncc.Color = Color;\n\n/**\n * @module cc\n */\n\n/**\n * !#en\n * The convenience method to create a new {{#crossLink \"Color/Color:method\"}}cc.Color{{/crossLink}}\n * Alpha channel is optional. Default value is 255.\n *\n * !#zh\n * 通过该方法来创建一个新的 {{#crossLink \"Color/Color:method\"}}cc.Color{{/crossLink}} 对象。\n * Alpha 通道是可选的。默认值是 255。\n *\n * @method color\n * @param {Number} [r=0]\n * @param {Number} [g=0]\n * @param {Number} [b=0]\n * @param {Number} [a=255]\n * @return {Color}\n * @example {@link cocos2d/core/value-types/CCColor/color.js}\n */\ncc.color = function color (r, g, b, a) {\n    if (typeof r === 'string') {\n        var result = new Color();\n        return result.fromHEX(r);\n    }\n    if (typeof r === 'object') {\n        return new Color(r.r, r.g, r.b, r.a);\n    }\n    return new Color(r, g, b, a);\n};\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nexport { default as Vec2 } from './vec2';\nexport { default as Vec3} from './vec3';\nexport { default as Vec4} from './vec4';\nexport { default as Mat4} from './mat4';\nexport { default as Mat3} from './mat3';\nexport { default as Rect} from './rect';\nexport { default as Size} from './size';\nexport { default as Color} from './color';\nexport { default as Quat} from './quat';\nexport { default as Trs} from './trs';\nexport * from './utils';\n\ncc.math = module.exports;\n","import { EPSILON, FLOAT_ARRAY_TYPE } from '../value-types/utils';\nimport Vec3 from './vec3';\nimport Vec2 from './vec2';\nimport Mat4 from './mat4';\nimport Quat from './quat';\n\n/**\n * Mathematical 3x3 matrix.\n *\n * NOTE: we use column-major matrix for all matrix calculation.\n *\n * This may lead to some confusion when referencing OpenGL documentation,\n * however, which represents out all matricies in column-major format.\n * This means that while in code a matrix may be typed out as:\n *\n * [1, 0, 0, 0,\n *  0, 1, 0, 0,\n *  0, 0, 1, 0,\n *  x, y, z, 0]\n *\n * The same matrix in the [OpenGL documentation](https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glTranslate.xml)\n * is written as:\n *\n *  1 0 0 x\n *  0 1 0 y\n *  0 0 1 z\n *  0 0 0 0\n *\n * Please rest assured, however, that they are the same thing!\n * This is not unique to glMatrix, either, as OpenGL developers have long been confused by the\n * apparent lack of consistency between the memory layout and the documentation.\n */\nexport default class Mat3 {\n    static sub = Mat3.subtract;\n    static mul = Mat3.multiply;\n    \n    /**\n     * Identity  of Mat3\n     * @property {Mat3} IDENTITY\n     * @static\n     */\n    static IDENTITY = Object.freeze(new Mat3());\n\n    /**\n     * Creates a matrix, with elements specified separately.\n     *\n     * @param {Number} m00 - Value assigned to element at column 0 row 0.\n     * @param {Number} m01 - Value assigned to element at column 0 row 1.\n     * @param {Number} m02 - Value assigned to element at column 0 row 2.\n     * @param {Number} m03 - Value assigned to element at column 1 row 0.\n     * @param {Number} m04 - Value assigned to element at column 1 row 1.\n     * @param {Number} m05 - Value assigned to element at column 1 row 2.\n     * @param {Number} m06 - Value assigned to element at column 2 row 0.\n     * @param {Number} m07 - Value assigned to element at column 2 row 1.\n     * @param {Number} m08 - Value assigned to element at column 2 row 2.\n     * @returns {Mat3} The newly created matrix.\n     * @static\n     */\n    static create (m00: number = 1, m01: number = 0, m02: number = 0, m03: number = 0, m04: number = 1, m05: number = 0, m06: number = 0, m07: number = 0, m08: number = 1): Mat3 {\n        return new Mat3(m00, m01, m02, m03, m04, m05, m06, m07, m08);\n    }\n\n    /**\n     * Clone a matrix.\n     *\n     * @param {Mat3} a - Matrix to clone.\n     * @returns {Mat3} The newly created matrix.\n     * @static\n     */\n    static clone (a: Mat3): Mat3 {\n        let am = a.m;\n        return new Mat3(\n            am[0], am[1], am[2],\n            am[3], am[4], am[5],\n            am[6], am[7], am[8]\n        );\n    }\n\n    /**\n     * Copy content of a matrix into another.\n     *\n     * @param {Mat3} out - Matrix to modified.\n     * @param {Mat3} a - The specified matrix.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static copy (out: Mat3, a: Mat3): Mat3 {\n        out.m.set(a.m);\n        return out;\n    }\n\n    /**\n     * Sets the elements of a matrix to the given values.\n     *\n     * @param {Mat3} out - The matrix to modified.\n     * @param {Number} m00 - Value assigned to element at column 0 row 0.\n     * @param {Number} m01 - Value assigned to element at column 0 row 1.\n     * @param {Number} m02 - Value assigned to element at column 0 row 2.\n     * @param {Number} m10 - Value assigned to element at column 1 row 0.\n     * @param {Number} m11 - Value assigned to element at column 1 row 1.\n     * @param {Number} m12 - Value assigned to element at column 1 row 2.\n     * @param {Number} m20 - Value assigned to element at column 2 row 0.\n     * @param {Number} m21 - Value assigned to element at column 2 row 1.\n     * @param {Number} m22 - Value assigned to element at column 2 row 2.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static set (out: Mat3, m00: number, m01: number, m02: number, m10: number, m11: number, m12: number, m20: number, m21: number, m22: number): Mat3 {\n        let outm = out.m;\n        outm[0] = m00;\n        outm[1] = m01;\n        outm[2] = m02;\n        outm[3] = m10;\n        outm[4] = m11;\n        outm[5] = m12;\n        outm[6] = m20;\n        outm[7] = m21;\n        outm[8] = m22;\n        return out;\n    }\n\n    /**\n     * return an identity matrix.\n     *\n     * @returns {Mat3} out.\n     * @static\n     */\n    static identity (out: Mat3): Mat3 {\n        let outm = out.m;\n        outm[0] = 1;\n        outm[1] = 0;\n        outm[2] = 0;\n        outm[3] = 0;\n        outm[4] = 1;\n        outm[5] = 0;\n        outm[6] = 0;\n        outm[7] = 0;\n        outm[8] = 1;\n        return out;\n    }\n\n    /**\n     * Transposes a matrix.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - Matrix to transpose.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static transpose (out: Mat3, a: Mat3): Mat3 {\n        let am = a.m, outm = out.m;\n        // If we are transposing ourselves we can skip a few steps but have to cache some values\n        if (out === a) {\n            let a01 = am[1], a02 = am[2], a12 = am[5];\n            outm[1] = am[3];\n            outm[2] = am[6];\n            outm[3] = a01;\n            outm[5] = am[7];\n            outm[6] = a02;\n            outm[7] = a12;\n        } else {\n            outm[0] = am[0];\n            outm[1] = am[3];\n            outm[2] = am[6];\n            outm[3] = am[1];\n            outm[4] = am[4];\n            outm[5] = am[7];\n            outm[6] = am[2];\n            outm[7] = am[5];\n            outm[8] = am[8];\n        }\n\n        return out;\n    }\n\n    /**\n     * Inverts a matrix.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - Matrix to invert.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static invert (out: Mat3, a: Mat3): Mat3 {\n        let am = a.m, outm = out.m;\n        let a00 = am[0], a01 = am[1], a02 = am[2],\n            a10 = am[3], a11 = am[4], a12 = am[5],\n            a20 = am[6], a21 = am[7], a22 = am[8];\n\n        let b01 = a22 * a11 - a12 * a21;\n        let b11 = -a22 * a10 + a12 * a20;\n        let b21 = a21 * a10 - a11 * a20;\n\n        // Calculate the determinant\n        let det = a00 * b01 + a01 * b11 + a02 * b21;\n\n        if (!det) {\n            return out;\n        }\n        det = 1.0 / det;\n\n        outm[0] = b01 * det;\n        outm[1] = (-a22 * a01 + a02 * a21) * det;\n        outm[2] = (a12 * a01 - a02 * a11) * det;\n        outm[3] = b11 * det;\n        outm[4] = (a22 * a00 - a02 * a20) * det;\n        outm[5] = (-a12 * a00 + a02 * a10) * det;\n        outm[6] = b21 * det;\n        outm[7] = (-a21 * a00 + a01 * a20) * det;\n        outm[8] = (a11 * a00 - a01 * a10) * det;\n        return out;\n    }\n\n    /**\n     * Calculates the adjugate of a matrix.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - Matrix to calculate.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static adjoint (out: Mat3, a: Mat3): Mat3 {\n        let am = a.m, outm = out.m;\n        let a00 = am[0], a01 = am[1], a02 = am[2],\n            a10 = am[3], a11 = am[4], a12 = am[5],\n            a20 = am[6], a21 = am[7], a22 = am[8];\n\n        outm[0] = (a11 * a22 - a12 * a21);\n        outm[1] = (a02 * a21 - a01 * a22);\n        outm[2] = (a01 * a12 - a02 * a11);\n        outm[3] = (a12 * a20 - a10 * a22);\n        outm[4] = (a00 * a22 - a02 * a20);\n        outm[5] = (a02 * a10 - a00 * a12);\n        outm[6] = (a10 * a21 - a11 * a20);\n        outm[7] = (a01 * a20 - a00 * a21);\n        outm[8] = (a00 * a11 - a01 * a10);\n        return out;\n    }\n\n    /**\n     * Calculates the determinant of a matrix.\n     *\n     * @param {Mat3} a - Matrix to calculate.\n     * @returns {Number} Determinant of a.\n     * @static\n     */\n    static determinant (a: Mat3): number {\n        let am = a.m;\n        let a00 = am[0], a01 = am[1], a02 = am[2],\n            a10 = am[3], a11 = am[4], a12 = am[5],\n            a20 = am[6], a21 = am[7], a22 = am[8];\n\n        return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n    }\n\n    /**\n     * Multiply two matrices explicitly.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - The first operand.\n     * @param {Mat3} b - The second operand.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static multiply (out: Mat3, a: Mat3, b: Mat3): Mat3 {\n        let am = a.m, bm = b.m, outm = out.m;\n        let a00 = am[0], a01 = am[1], a02 = am[2],\n            a10 = am[3], a11 = am[4], a12 = am[5],\n            a20 = am[6], a21 = am[7], a22 = am[8];\n\n        let b00 = bm[0], b01 = bm[1], b02 = bm[2];\n        let b10 = bm[3], b11 = bm[4], b12 = bm[5];\n        let b20 = bm[6], b21 = bm[7], b22 = bm[8];\n\n        outm[0] = b00 * a00 + b01 * a10 + b02 * a20;\n        outm[1] = b00 * a01 + b01 * a11 + b02 * a21;\n        outm[2] = b00 * a02 + b01 * a12 + b02 * a22;\n\n        outm[3] = b10 * a00 + b11 * a10 + b12 * a20;\n        outm[4] = b10 * a01 + b11 * a11 + b12 * a21;\n        outm[5] = b10 * a02 + b11 * a12 + b12 * a22;\n\n        outm[6] = b20 * a00 + b21 * a10 + b22 * a20;\n        outm[7] = b20 * a01 + b21 * a11 + b22 * a21;\n        outm[8] = b20 * a02 + b21 * a12 + b22 * a22;\n        return out;\n    }\n\n    /**\n     * !#en Take the first third order of the fourth order matrix and multiply by the third order matrix\n     * !#zh 取四阶矩阵的前三阶，与三阶矩阵相乘\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - The first operand.\n     * @param {Mat3} b - The second operand.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static multiplyMat4 <Out extends IMat3Like> (out: Out, a: Out, b: IMat4Like) {\n        let am = a.m, bm = b.m, outm = out.m;\n        let a00 = am[0], a01 = am[1], a02 = am[2],\n            a10 = am[3], a11 = am[4], a12 = am[5],\n            a20 = am[6], a21 = am[7], a22 = am[8];\n\n        const b00 = bm[0], b01 = bm[1], b02 = bm[2];\n        const b10 = bm[4], b11 = bm[5], b12 = bm[6];\n        const b20 = bm[8], b21 = bm[9], b22 = bm[10];\n\n        outm[0] = b00 * a00 + b01 * a10 + b02 * a20;\n        outm[1] = b00 * a01 + b01 * a11 + b02 * a21;\n        outm[2] = b00 * a02 + b01 * a12 + b02 * a22;\n        outm[3] = b10 * a00 + b11 * a10 + b12 * a20;\n        outm[4] = b10 * a01 + b11 * a11 + b12 * a21;\n        outm[5] = b10 * a02 + b11 * a12 + b12 * a22;\n        outm[6] = b20 * a00 + b21 * a10 + b22 * a20;\n        outm[7] = b20 * a01 + b21 * a11 + b22 * a21;\n        outm[8] = b20 * a02 + b21 * a12 + b22 * a22;\n        return out;\n    }\n\n    /**\n     * Multiply a matrix with a translation matrix given by a translation offset.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - Matrix to multiply.\n     * @param {vec2} v - The translation offset.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static translate (out: Mat3, a: Mat3, v: Vec2): Mat3 {\n        let am = a.m, outm = out.m;\n        let a00 = am[0], a01 = am[1], a02 = am[2],\n            a10 = am[3], a11 = am[4], a12 = am[5],\n            a20 = am[6], a21 = am[7], a22 = am[8];\n        let x = v.x, y = v.y;\n\n        outm[0] = a00;\n        outm[1] = a01;\n        outm[2] = a02;\n\n        outm[3] = a10;\n        outm[4] = a11;\n        outm[5] = a12;\n\n        outm[6] = x * a00 + y * a10 + a20;\n        outm[7] = x * a01 + y * a11 + a21;\n        outm[8] = x * a02 + y * a12 + a22;\n        return out;\n    }\n\n    /**\n     * Rotates a matrix by the given angle.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - Matrix to rotate.\n     * @param {Number} rad - The rotation angle.\n     * @returns {Mat3} out\n     * @static\n     */\n    static rotate (out: Mat3, a: Mat3, rad: number): Mat3 {\n        let am = a.m, outm = out.m;\n        let a00 = am[0], a01 = am[1], a02 = am[2],\n            a10 = am[3], a11 = am[4], a12 = am[5],\n            a20 = am[6], a21 = am[7], a22 = am[8];\n\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n\n        outm[0] = c * a00 + s * a10;\n        outm[1] = c * a01 + s * a11;\n        outm[2] = c * a02 + s * a12;\n\n        outm[3] = c * a10 - s * a00;\n        outm[4] = c * a11 - s * a01;\n        outm[5] = c * a12 - s * a02;\n\n        outm[6] = a20;\n        outm[7] = a21;\n        outm[8] = a22;\n        return out;\n    }\n\n    /**\n     * Multiply a matrix with a scale matrix given by a scale vector.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - Matrix to multiply.\n     * @param {vec2} v - The scale vector.\n     * @returns {Mat3} out\n     **/\n    static scale (out: Mat3, a: Mat3, v: Vec2): Mat3 {\n        let x = v.x, y = v.y;\n        let am = a.m, outm = out.m;\n\n        outm[0] = x * am[0];\n        outm[1] = x * am[1];\n        outm[2] = x * am[2];\n\n        outm[3] = y * am[3];\n        outm[4] = y * am[4];\n        outm[5] = y * am[5];\n\n        outm[6] = am[6];\n        outm[7] = am[7];\n        outm[8] = am[8];\n        return out;\n    }\n\n    /**\n     * Copies the upper-left 3x3 values of a 4x4 matrix into a 3x3 matrix.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {mat4} a - The 4x4 matrix.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static fromMat4 (out: Mat3, a: Mat4): Mat3 {\n        let am = a.m, outm = out.m;\n        outm[0] = am[0];\n        outm[1] = am[1];\n        outm[2] = am[2];\n        outm[3] = am[4];\n        outm[4] = am[5];\n        outm[5] = am[6];\n        outm[6] = am[8];\n        outm[7] = am[9];\n        outm[8] = am[10];\n        return out;\n    }\n\n    /**\n     * Creates a matrix from a translation offset.\n     * This is equivalent to (but much faster than):\n     *\n     *     mat3.identity(dest);\n     *     mat3.translate(dest, dest, vec);\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {vec2} v - The translation offset.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static fromTranslation (out: Mat3, v: Vec2): Mat3 {\n        let outm = out.m;\n        outm[0] = 1;\n        outm[1] = 0;\n        outm[2] = 0;\n        outm[3] = 0;\n        outm[4] = 1;\n        outm[5] = 0;\n        outm[6] = v.x;\n        outm[7] = v.y;\n        outm[8] = 1;\n        return out;\n    }\n\n    /**\n     * Creates a matrix from a given angle.\n     * This is equivalent to (but much faster than):\n     *\n     *     mat3.identity(dest);\n     *     mat3.rotate(dest, dest, rad);\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Number} rad - The rotation angle.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static fromRotation (out: Mat3, rad: number): Mat3 {\n        let s = Math.sin(rad), c = Math.cos(rad);\n        let outm = out.m;\n\n        outm[0] = c;\n        outm[1] = s;\n        outm[2] = 0;\n\n        outm[3] = -s;\n        outm[4] = c;\n        outm[5] = 0;\n\n        outm[6] = 0;\n        outm[7] = 0;\n        outm[8] = 1;\n        return out;\n    }\n\n    /**\n     * Creates a matrix from a scale vector.\n     * This is equivalent to (but much faster than):\n     *\n     *     mat3.identity(dest);\n     *     mat3.scale(dest, dest, vec);\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {vec2} v - Scale vector.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static fromScaling (out: Mat3, v: Vec2): Mat3 {\n        let outm = out.m;\n        outm[0] = v.x;\n        outm[1] = 0;\n        outm[2] = 0;\n\n        outm[3] = 0;\n        outm[4] = v.y;\n        outm[5] = 0;\n\n        outm[6] = 0;\n        outm[7] = 0;\n        outm[8] = 1;\n        return out;\n    }\n\n    /**\n     * Calculates a 3x3 matrix from the given quaternion.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {quat} q - The quaternion.\n     *\n     * @returns {Mat3} out.\n     * @static\n     */\n    static fromQuat (out: Mat3, q: Quat): Mat3 {\n        let outm = out.m;\n        let x = q.x, y = q.y, z = q.z, w = q.w;\n        let x2 = x + x;\n        let y2 = y + y;\n        let z2 = z + z;\n\n        let xx = x * x2;\n        let yx = y * x2;\n        let yy = y * y2;\n        let zx = z * x2;\n        let zy = z * y2;\n        let zz = z * z2;\n        let wx = w * x2;\n        let wy = w * y2;\n        let wz = w * z2;\n\n        outm[0] = 1 - yy - zz;\n        outm[3] = yx - wz;\n        outm[6] = zx + wy;\n\n        outm[1] = yx + wz;\n        outm[4] = 1 - xx - zz;\n        outm[7] = zy - wx;\n\n        outm[2] = zx - wy;\n        outm[5] = zy + wx;\n        outm[8] = 1 - xx - yy;\n\n        return out;\n    }\n\n    /**\n     * Calculates a 3x3 matrix from view direction and up direction.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {vec3} view - View direction (must be normalized).\n     * @param {vec3} [up] - Up direction, default is (0,1,0) (must be normalized).\n     *\n     * @returns {Mat3} out\n     * @static\n     */\n    static fromViewUp (out: Mat3, view: Vec3, up?: Vec3): Mat3 {\n        let _fromViewUpIIFE = (function () {\n            let default_up = new Vec3(0, 1, 0);\n            let x = new Vec3();\n            let y = new Vec3();\n\n            return function (out, view, up) {\n                if (Vec3.lengthSqr(view) < EPSILON * EPSILON) {\n                    Mat3.identity(out);\n                    return out;\n                }\n\n                up = up || default_up;\n                Vec3.normalize(x, Vec3.cross(x, up, view));\n\n                if (Vec3.lengthSqr(x) < EPSILON * EPSILON) {\n                    Mat3.identity(out);\n                    return out;\n                }\n\n                Vec3.cross(y, view, x);\n                Mat3.set(\n                    out,\n                    x.x, x.y, x.z,\n                    y.x, y.y, y.z,\n                    view.x, view.y, view.z\n                );\n\n                return out;\n            };\n        })();\n        return _fromViewUpIIFE(out, view, up);\n    }\n\n    /**\n     * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {mat4} a - A 4x4 matrix to derive the normal matrix from.\n     *\n     * @returns {Mat3} out.\n     * @static\n     */\n    static normalFromMat4 (out: Mat3, a: Mat4): Mat3 {\n        let am = a.m, outm = out.m;\n        let a00 = am[0], a01 = am[1], a02 = am[2], a03 = am[3],\n            a10 = am[4], a11 = am[5], a12 = am[6], a13 = am[7],\n            a20 = am[8], a21 = am[9], a22 = am[10], a23 = am[11],\n            a30 = am[12], a31 = am[13], a32 = am[14], a33 = am[15];\n\n        let b00 = a00 * a11 - a01 * a10;\n        let b01 = a00 * a12 - a02 * a10;\n        let b02 = a00 * a13 - a03 * a10;\n        let b03 = a01 * a12 - a02 * a11;\n        let b04 = a01 * a13 - a03 * a11;\n        let b05 = a02 * a13 - a03 * a12;\n        let b06 = a20 * a31 - a21 * a30;\n        let b07 = a20 * a32 - a22 * a30;\n        let b08 = a20 * a33 - a23 * a30;\n        let b09 = a21 * a32 - a22 * a31;\n        let b10 = a21 * a33 - a23 * a31;\n        let b11 = a22 * a33 - a23 * a32;\n\n        // Calculate the determinant\n        let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n        if (!det) {\n            return out;\n        }\n        det = 1.0 / det;\n\n        outm[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n        outm[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n        outm[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n\n        outm[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n        outm[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n        outm[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n\n        outm[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n        outm[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n        outm[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n\n        return out;\n    }\n\n    /**\n     * Returns Frobenius norm of a matrix.\n     *\n     * @param {Mat3} a - Matrix to calculate Frobenius norm of.\n     * @returns {Number} - The frobenius norm.\n     * @static\n     */\n    static frob (a: Mat3): number {\n        let am = a.m;\n        return (Math.sqrt(Math.pow(am[0], 2) + Math.pow(am[1], 2) + Math.pow(am[2], 2) + Math.pow(am[3], 2) + Math.pow(am[4], 2) + Math.pow(am[5], 2) + Math.pow(am[6], 2) + Math.pow(am[7], 2) + Math.pow(am[8], 2)));\n    }\n\n    /**\n     * Adds two matrices.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - The first operand.\n     * @param {Mat3} b - The second operand.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static add (out: Mat3, a: Mat3, b: Mat3): Mat3 {\n        let am = a.m, bm = b.m, outm = out.m;\n        outm[0] = am[0] + bm[0];\n        outm[1] = am[1] + bm[1];\n        outm[2] = am[2] + bm[2];\n        outm[3] = am[3] + bm[3];\n        outm[4] = am[4] + bm[4];\n        outm[5] = am[5] + bm[5];\n        outm[6] = am[6] + bm[6];\n        outm[7] = am[7] + bm[7];\n        outm[8] = am[8] + bm[8];\n        return out;\n    }\n\n    /**\n     * Subtracts matrix b from matrix a.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - The first operand.\n     * @param {Mat3} b - The second operand.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static subtract (out: Mat3, a: Mat3, b: Mat3): Mat3 {\n        let am = a.m, bm = b.m, outm = out.m;\n        outm[0] = am[0] - bm[0];\n        outm[1] = am[1] - bm[1];\n        outm[2] = am[2] - bm[2];\n        outm[3] = am[3] - bm[3];\n        outm[4] = am[4] - bm[4];\n        outm[5] = am[5] - bm[5];\n        outm[6] = am[6] - bm[6];\n        outm[7] = am[7] - bm[7];\n        outm[8] = am[8] - bm[8];\n        return out;\n    }\n\n    /**\n     * Multiply each element of a matrix by a scalar number.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - Matrix to scale\n     * @param {Number} b - The scale number.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static multiplyScalar (out: Mat3, a: Mat3, b: number): Mat3 {\n        let am = a.m, outm = out.m;\n        outm[0] = am[0] * b;\n        outm[1] = am[1] * b;\n        outm[2] = am[2] * b;\n        outm[3] = am[3] * b;\n        outm[4] = am[4] * b;\n        outm[5] = am[5] * b;\n        outm[6] = am[6] * b;\n        outm[7] = am[7] * b;\n        outm[8] = am[8] * b;\n        return out;\n    }\n\n    /**\n     * Adds two matrices after multiplying each element of the second operand by a scalar number.\n     *\n     * @param {Mat3} out - Matrix to store result.\n     * @param {Mat3} a - The first operand.\n     * @param {Mat3} b - The second operand.\n     * @param {Number} scale - The scale number.\n     * @returns {Mat3} out.\n     * @static\n     */\n    static multiplyScalarAndAdd (out: Mat3, a: Mat3, b: Mat3, scale: number): Mat3 {\n        let am = a.m, bm = b.m, outm = out.m;\n        outm[0] = am[0] + (bm[0] * scale);\n        outm[1] = am[1] + (bm[1] * scale);\n        outm[2] = am[2] + (bm[2] * scale);\n        outm[3] = am[3] + (bm[3] * scale);\n        outm[4] = am[4] + (bm[4] * scale);\n        outm[5] = am[5] + (bm[5] * scale);\n        outm[6] = am[6] + (bm[6] * scale);\n        outm[7] = am[7] + (bm[7] * scale);\n        outm[8] = am[8] + (bm[8] * scale);\n        return out;\n    }\n\n    /**\n     * Returns whether the specified matrices are equal. (Compared using ===)\n     *\n     * @param {Mat3} a - The first matrix.\n     * @param {Mat3} b - The second matrix.\n     * @returns {Boolean} True if the matrices are equal, false otherwise.\n     * @static\n     */\n    static exactEquals (a: Mat3, b: Mat3): boolean {\n        let am = a.m, bm = b.m;\n        return am[0] === bm[0] && am[1] === bm[1] && am[2] === bm[2] &&\n            am[3] === bm[3] && am[4] === bm[4] && am[5] === bm[5] &&\n            am[6] === bm[6] && am[7] === bm[7] && am[8] === bm[8];\n    }\n\n    /**\n     * Returns whether the specified matrices are approximately equal.\n     *\n     * @param {Mat3} a - The first matrix.\n     * @param {Mat3} b - The second matrix.\n     * @returns {Boolean} True if the matrices are equal, false otherwise.\n     * @static\n     */\n    static equals (a: Mat3, b: Mat3): boolean {\n        let am = a.m, bm = b.m;\n        let a0 = am[0], a1 = am[1], a2 = am[2], a3 = am[3], a4 = am[4], a5 = am[5], a6 = am[6], a7 = am[7], a8 = am[8];\n        let b0 = bm[0], b1 = bm[1], b2 = bm[2], b3 = bm[3], b4 = bm[4], b5 = bm[5], b6 = bm[6], b7 = bm[7], b8 = bm[8];\n        return (\n            Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\n            Math.abs(a6 - b6) <= EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\n            Math.abs(a7 - b7) <= EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) &&\n            Math.abs(a8 - b8) <= EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8))\n        );\n    }\n\n    /**\n     * !#zh 矩阵转数组\n     * !#en Matrix transpose array\n     * @method toArray\n     * @typescript\n     * toArray <Out extends IWritableArrayLike<number>> (out: Out, mat: IMat3Like, ofs = 0)\n     * @param ofs 数组内的起始偏移量\n     * @static\n     */\n    static toArray <Out extends IWritableArrayLike<number>> (out: Out, mat: IMat3Like, ofs = 0) {\n        let m = mat.m;\n        for (let i = 0; i < 9; i++) {\n            out[ofs + i] = m[i];\n        }\n        return out;\n    }\n\n    /**\n     * !#zh 数组转矩阵\n     * !#en Transfer matrix array\n     * @method fromArray\n     * @typescript\n     * fromArray <Out extends IMat3Like> (out: Out, arr: IWritableArrayLike<number>, ofs = 0)\n     * @param ofs 数组起始偏移量\n     * @static\n     */\n    static fromArray <Out extends IMat3Like> (out: Out, arr: IWritableArrayLike<number>, ofs = 0) {\n        let m = out.m;\n        for (let i = 0; i < 9; i++) {\n            m[i] = arr[ofs + i];\n        }\n        return out;\n    }\n\n    /**\n     * !#en Matrix Data\n     * !#zh 矩阵数据\n     * @property {Float64Array | Float32Array} m\n     */\n    m: FloatArray;\n\n\n    /**\n     * @method constructor\n     * @typescript\n     * constructor (m00: number | Float32Array = 1, m01 = 0, m02 = 0, m03 = 0, m04 = 1, m05 = 0, m06 = 0, m07 = 0, m08 = 1)\n     */\n    constructor (\n        m00: number | FloatArray = 1, m01 = 0, m02 = 0,\n        m03 = 0, m04 = 1, m05 = 0,\n        m06 = 0, m07 = 0, m08 = 1\n    ) {\n        if (m00 instanceof FLOAT_ARRAY_TYPE) {\n            this.m = m00;\n        } else {\n            this.m = new FLOAT_ARRAY_TYPE(9);\n            let m = this.m;\n            /**\n             * The element at column 0 row 0.\n             * @type {number}\n             * */\n            m[0] = m00 as number;\n\n            /**\n             * The element at column 0 row 1.\n             * @type {number}\n             * */\n            m[1] = m01;\n\n            /**\n             * The element at column 0 row 2.\n             * @type {number}\n             * */\n            m[2] = m02;\n\n            /**\n             * The element at column 1 row 0.\n             * @type {number}\n             * */\n            m[3] = m03;\n\n            /**\n             * The element at column 1 row 1.\n             * @type {number}\n             * */\n            m[4] = m04;\n\n            /**\n             * The element at column 1 row 2.\n             * @type {number}\n             * */\n            m[5] = m05;\n\n            /**\n             * The element at column 2 row 0.\n             * @type {number}\n             * */\n            m[6] = m06;\n\n            /**\n             * The element at column 2 row 1.\n             * @type {number}\n             * */\n            m[7] = m07;\n\n            /**\n             * The element at column 2 row 2.\n             * @type {number}\n             * */\n            m[8] = m08;\n        }\n    }\n\n\n    /**\n     * Returns a string representation of a matrix.\n     *\n     * @param {Mat3} a - The matrix.\n     * @returns {String} String representation of this matrix.\n     */\n    toString () {\n        let am = this.m;\n        return `mat3(${am[0]}, ${am[1]}, ${am[2]}, ${am[3]}, ${am[4]}, ${am[5]}, ${am[6]}, ${am[7]}, ${am[8]})`;\n    }\n}\n\ncc.Mat3 = Mat3;\n","/****************************************************************************\n Copyright (c) 2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport ValueType from './value-type';\nimport CCClass from '../platform/CCClass';\nimport Vec3 from './vec3';\nimport Quat from './quat';\nimport { EPSILON, FLOAT_ARRAY_TYPE } from './utils';\nimport Mat3 from './mat3';\n\nlet _a00: number = 0; let _a01: number = 0; let _a02: number = 0; let _a03: number = 0;\nlet _a10: number = 0; let _a11: number = 0; let _a12: number = 0; let _a13: number = 0;\nlet _a20: number = 0; let _a21: number = 0; let _a22: number = 0; let _a23: number = 0;\nlet _a30: number = 0; let _a31: number = 0; let _a32: number = 0; let _a33: number = 0;\n\n/**\n * !#en Representation of 4*4 matrix.\n * !#zh 表示 4*4 矩阵\n *\n * @class Mat4\n * @extends ValueType\n */\nexport default class Mat4 extends ValueType {\n    static mul = Mat4.multiply;\n    static sub = Mat4.subtract;\n\n    /**\n     * !#en Multiply the current matrix with another one\n     * !#zh 将当前矩阵与指定矩阵相乘\n     * @method mul\n     * @param {Mat4} other the second operand\n     * @param {Mat4} [out] the receiving matrix, you can pass the same matrix to save result to itself, if not provided, a new matrix will be created\n     * @returns {Mat4} out\n     */\n    mul (m: Mat4, out: Mat4): Mat4 {\n        return Mat4.multiply(out || new Mat4(), this, m);\n    }\n    /**\n     * !#en Multiply each element of the matrix by a scalar.\n     * !#zh 将矩阵的每一个元素都乘以指定的缩放值。\n     * @method mulScalar\n     * @param {Number} number amount to scale the matrix's elements by\n     * @param {Mat4} [out] the receiving matrix, you can pass the same matrix to save result to itself, if not provided, a new matrix will be created\n     * @returns {Mat4} out\n     */\n    mulScalar (num: number, out: Mat4) {\n        Mat4.multiplyScalar(out || new Mat4(), this, num);\n    }\n    /**\n     * !#en Subtracts the current matrix with another one\n     * !#zh 将当前矩阵与指定的矩阵相减\n     * @method sub\n     * @param {Mat4} other the second operand\n     * @param {Mat4} [out] the receiving matrix, you can pass the same matrix to save result to itself, if not provided, a new matrix will be created\n     * @returns {Mat4} out\n     */\n    sub (m: Mat4, out: Mat4) {\n        Mat4.subtract(out || new Mat4(), this, m);\n    }\n\n    /**\n     * Identity  of Mat4\n     * @property {Mat4} IDENTITY\n     * @static\n     */\n    static IDENTITY = Object.freeze(new Mat4());\n\n    /**\n     * !#zh 获得指定矩阵的拷贝\n     * !#en Copy of the specified matrix to obtain\n     * @method clone\n     * @typescript\n     * clone<Out extends IMat4Like> (a: Out)\n     * @static\n     */\n    static clone<Out extends IMat4Like> (a: Out) {\n        let m = a.m;\n        return new Mat4(\n            m[0], m[1], m[2], m[3],\n            m[4], m[5], m[6], m[7],\n            m[8], m[9], m[10], m[11],\n            m[12], m[13], m[14], m[15],\n        );\n    }\n\n    /**\n     * !#zh 复制目标矩阵\n     * !#en Copy the target matrix\n     * @method copy\n     * @typescript\n     * copy<Out extends IMat4Like> (out: Out, a: Out)\n     * @static\n     */\n    static copy<Out extends IMat4Like> (out: Out, a: Out) {\n        let m = out.m, am = a.m;\n        m[0] = am[0];\n        m[1] = am[1];\n        m[2] = am[2];\n        m[3] = am[3];\n        m[4] = am[4];\n        m[5] = am[5];\n        m[6] = am[6];\n        m[7] = am[7];\n        m[8] = am[8];\n        m[9] = am[9];\n        m[10] = am[10];\n        m[11] = am[11];\n        m[12] = am[12];\n        m[13] = am[13];\n        m[14] = am[14];\n        m[15] = am[15];\n        return out;\n    }\n\n    /**\n     * !#zh 设置矩阵值\n     * !#en Setting matrix values\n     * @static\n     */\n    static set<Out extends IMat4Like> (\n        out: Out,\n        m00: number, m01: number, m02: number, m03: number,\n        m10: number, m11: number, m12: number, m13: number,\n        m20: number, m21: number, m22: number, m23: number,\n        m30: number, m31: number, m32: number, m33: number,\n    ) {\n        let m = out.m;\n        m[0] = m00; m[1] = m01; m[2] = m02; m[3] = m03;\n        m[4] = m10; m[5] = m11; m[6] = m12; m[7] = m13;\n        m[8] = m20; m[9] = m21; m[10] = m22; m[11] = m23;\n        m[12] = m30; m[13] = m31; m[14] = m32; m[15] = m33;\n        return out;\n    }\n\n    /**\n     * !#zh 将目标赋值为单位矩阵\n     * !#en The target of an assignment is the identity matrix\n     * @method identity\n     * @typescript\n     * identity<Out extends IMat4Like> (out: Out)\n     * @static\n     */\n    static identity<Out extends IMat4Like> (out: Out) {\n        let m = out.m;\n        m[0] = 1;\n        m[1] = 0;\n        m[2] = 0;\n        m[3] = 0;\n        m[4] = 0;\n        m[5] = 1;\n        m[6] = 0;\n        m[7] = 0;\n        m[8] = 0;\n        m[9] = 0;\n        m[10] = 1;\n        m[11] = 0;\n        m[12] = 0;\n        m[13] = 0;\n        m[14] = 0;\n        m[15] = 1;\n        return out;\n    }\n\n    /**\n     * !#zh 转置矩阵\n     * !#en Transposed matrix\n     * @method transpose\n     * @typescript\n     * transpose<Out extends IMat4Like> (out: Out, a: Out)\n     * @static\n     */\n    static transpose<Out extends IMat4Like> (out: Out, a: Out) {\n        let m = out.m, am = a.m;\n        // If we are transposing ourselves we can skip a few steps but have to cache some values\n        if (out === a) {\n            const a01 = am[1], a02 = am[2], a03 = am[3], a12 = am[6], a13 = am[7], a23 = am[11];\n            m[1] = am[4];\n            m[2] = am[8];\n            m[3] = am[12];\n            m[4] = a01;\n            m[6] = am[9];\n            m[7] = am[13];\n            m[8] = a02;\n            m[9] = a12;\n            m[11] = am[14];\n            m[12] = a03;\n            m[13] = a13;\n            m[14] = a23;\n        } else {\n            m[0] = am[0];\n            m[1] = am[4];\n            m[2] = am[8];\n            m[3] = am[12];\n            m[4] = am[1];\n            m[5] = am[5];\n            m[6] = am[9];\n            m[7] = am[13];\n            m[8] = am[2];\n            m[9] = am[6];\n            m[10] = am[10];\n            m[11] = am[14];\n            m[12] = am[3];\n            m[13] = am[7];\n            m[14] = am[11];\n            m[15] = am[15];\n        }\n        return out;\n    }\n\n    /**\n     * !#zh 矩阵求逆\n     * !#en Matrix inversion\n     * @method invert\n     * @typescript\n     * invert<Out extends IMat4Like> (out: Out, a: Out)\n     * @static\n     */\n    static invert<Out extends IMat4Like> (out: Out, a: Out) {\n        let am = a.m;\n        _a00 = am[0]; _a01 = am[1]; _a02 = am[2]; _a03 = am[3];\n        _a10 = am[4]; _a11 = am[5]; _a12 = am[6]; _a13 = am[7];\n        _a20 = am[8]; _a21 = am[9]; _a22 = am[10]; _a23 = am[11];\n        _a30 = am[12]; _a31 = am[13]; _a32 = am[14]; _a33 = am[15];\n\n        const b00 = _a00 * _a11 - _a01 * _a10;\n        const b01 = _a00 * _a12 - _a02 * _a10;\n        const b02 = _a00 * _a13 - _a03 * _a10;\n        const b03 = _a01 * _a12 - _a02 * _a11;\n        const b04 = _a01 * _a13 - _a03 * _a11;\n        const b05 = _a02 * _a13 - _a03 * _a12;\n        const b06 = _a20 * _a31 - _a21 * _a30;\n        const b07 = _a20 * _a32 - _a22 * _a30;\n        const b08 = _a20 * _a33 - _a23 * _a30;\n        const b09 = _a21 * _a32 - _a22 * _a31;\n        const b10 = _a21 * _a33 - _a23 * _a31;\n        const b11 = _a22 * _a33 - _a23 * _a32;\n\n        // Calculate the determinant\n        let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n        if (det === 0) { return null; }\n        det = 1.0 / det;\n\n        let m = out.m;\n        m[0] = (_a11 * b11 - _a12 * b10 + _a13 * b09) * det;\n        m[1] = (_a02 * b10 - _a01 * b11 - _a03 * b09) * det;\n        m[2] = (_a31 * b05 - _a32 * b04 + _a33 * b03) * det;\n        m[3] = (_a22 * b04 - _a21 * b05 - _a23 * b03) * det;\n        m[4] = (_a12 * b08 - _a10 * b11 - _a13 * b07) * det;\n        m[5] = (_a00 * b11 - _a02 * b08 + _a03 * b07) * det;\n        m[6] = (_a32 * b02 - _a30 * b05 - _a33 * b01) * det;\n        m[7] = (_a20 * b05 - _a22 * b02 + _a23 * b01) * det;\n        m[8] = (_a10 * b10 - _a11 * b08 + _a13 * b06) * det;\n        m[9] = (_a01 * b08 - _a00 * b10 - _a03 * b06) * det;\n        m[10] = (_a30 * b04 - _a31 * b02 + _a33 * b00) * det;\n        m[11] = (_a21 * b02 - _a20 * b04 - _a23 * b00) * det;\n        m[12] = (_a11 * b07 - _a10 * b09 - _a12 * b06) * det;\n        m[13] = (_a00 * b09 - _a01 * b07 + _a02 * b06) * det;\n        m[14] = (_a31 * b01 - _a30 * b03 - _a32 * b00) * det;\n        m[15] = (_a20 * b03 - _a21 * b01 + _a22 * b00) * det;\n\n        return out;\n    }\n\n    /**\n     * !#zh 矩阵行列式\n     * !#en Matrix determinant\n     * @method determinant\n     * @typescript\n     * determinant<Out extends IMat4Like> (a: Out): number\n     * @static\n     */\n    static determinant<Out extends IMat4Like> (a: Out): number {\n        let m = a.m;\n        _a00 = m[0]; _a01 = m[1]; _a02 = m[2]; _a03 = m[3];\n        _a10 = m[4]; _a11 = m[5]; _a12 = m[6]; _a13 = m[7];\n        _a20 = m[8]; _a21 = m[9]; _a22 = m[10]; _a23 = m[11];\n        _a30 = m[12]; _a31 = m[13]; _a32 = m[14]; _a33 = m[15];\n\n        const b00 = _a00 * _a11 - _a01 * _a10;\n        const b01 = _a00 * _a12 - _a02 * _a10;\n        const b02 = _a00 * _a13 - _a03 * _a10;\n        const b03 = _a01 * _a12 - _a02 * _a11;\n        const b04 = _a01 * _a13 - _a03 * _a11;\n        const b05 = _a02 * _a13 - _a03 * _a12;\n        const b06 = _a20 * _a31 - _a21 * _a30;\n        const b07 = _a20 * _a32 - _a22 * _a30;\n        const b08 = _a20 * _a33 - _a23 * _a30;\n        const b09 = _a21 * _a32 - _a22 * _a31;\n        const b10 = _a21 * _a33 - _a23 * _a31;\n        const b11 = _a22 * _a33 - _a23 * _a32;\n\n        // Calculate the determinant\n        return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n    }\n\n    /**\n     * !#zh 矩阵乘法\n     * !#en Matrix Multiplication\n     * @method multiply\n     * @typescript\n     * multiply<Out extends IMat4Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static multiply<Out extends IMat4Like> (out: Out, a: Out, b: Out) {\n        let m = out.m, am = a.m, bm = b.m;\n        _a00 = am[0]; _a01 = am[1]; _a02 = am[2]; _a03 = am[3];\n        _a10 = am[4]; _a11 = am[5]; _a12 = am[6]; _a13 = am[7];\n        _a20 = am[8]; _a21 = am[9]; _a22 = am[10]; _a23 = am[11];\n        _a30 = am[12]; _a31 = am[13]; _a32 = am[14]; _a33 = am[15];\n\n        // Cache only the current line of the second matrix\n        let b0 = bm[0], b1 = bm[1], b2 = bm[2], b3 = bm[3];\n        m[0] = b0 * _a00 + b1 * _a10 + b2 * _a20 + b3 * _a30;\n        m[1] = b0 * _a01 + b1 * _a11 + b2 * _a21 + b3 * _a31;\n        m[2] = b0 * _a02 + b1 * _a12 + b2 * _a22 + b3 * _a32;\n        m[3] = b0 * _a03 + b1 * _a13 + b2 * _a23 + b3 * _a33;\n\n        b0 = bm[4]; b1 = bm[5]; b2 = bm[6]; b3 = bm[7];\n        m[4] = b0 * _a00 + b1 * _a10 + b2 * _a20 + b3 * _a30;\n        m[5] = b0 * _a01 + b1 * _a11 + b2 * _a21 + b3 * _a31;\n        m[6] = b0 * _a02 + b1 * _a12 + b2 * _a22 + b3 * _a32;\n        m[7] = b0 * _a03 + b1 * _a13 + b2 * _a23 + b3 * _a33;\n\n        b0 = bm[8]; b1 = bm[9]; b2 = bm[10]; b3 = bm[11];\n        m[8] = b0 * _a00 + b1 * _a10 + b2 * _a20 + b3 * _a30;\n        m[9] = b0 * _a01 + b1 * _a11 + b2 * _a21 + b3 * _a31;\n        m[10] = b0 * _a02 + b1 * _a12 + b2 * _a22 + b3 * _a32;\n        m[11] = b0 * _a03 + b1 * _a13 + b2 * _a23 + b3 * _a33;\n\n        b0 = bm[12]; b1 = bm[13]; b2 = bm[14]; b3 = bm[15];\n        m[12] = b0 * _a00 + b1 * _a10 + b2 * _a20 + b3 * _a30;\n        m[13] = b0 * _a01 + b1 * _a11 + b2 * _a21 + b3 * _a31;\n        m[14] = b0 * _a02 + b1 * _a12 + b2 * _a22 + b3 * _a32;\n        m[15] = b0 * _a03 + b1 * _a13 + b2 * _a23 + b3 * _a33;\n        return out;\n    }\n\n    /**\n     * !#zh 在给定矩阵变换基础上加入变换\n     * !#en Was added in a given transformation matrix transformation on the basis of\n     * @method transform\n     * @typescript\n     * transform<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, a: Out, v: VecLike)\n     * @static\n     */\n    static transform<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, a: Out, v: VecLike) {\n        const x = v.x, y = v.y, z = v.z;\n        let m = out.m, am = a.m;\n        if (a === out) {\n            m[12] = am[0] * x + am[4] * y + am[8] * z + am[12];\n            m[13] = am[1] * x + am[5] * y + am[9] * z + am[13];\n            m[14] = am[2] * x + am[6] * y + am[10] * z + am[14];\n            m[15] = am[3] * x + am[7] * y + am[11] * z + am[15];\n        } else {\n            _a00 = am[0]; _a01 = am[1]; _a02 = am[2]; _a03 = am[3];\n            _a10 = am[4]; _a11 = am[5]; _a12 = am[6]; _a13 = am[7];\n            _a20 = am[8]; _a21 = am[9]; _a22 = am[10]; _a23 = am[11];\n            _a30 = am[12]; _a31 = am[13]; _a32 = am[14]; _a33 = am[15];\n\n            m[0] = _a00; m[1] = _a01; m[2] = _a02; m[3] = _a03;\n            m[4] = _a10; m[5] = _a11; m[6] = _a12; m[7] = _a13;\n            m[8] = _a20; m[9] = _a21; m[10] = _a22; m[11] = _a23;\n\n            m[12] = _a00 * x + _a10 * y + _a20 * z + am[12];\n            m[13] = _a01 * x + _a11 * y + _a21 * z + am[13];\n            m[14] = _a02 * x + _a12 * y + _a22 * z + am[14];\n            m[15] = _a03 * x + _a13 * y + _a23 * z + am[15];\n        }\n        return out;\n    }\n\n    /**\n     * !#zh 在给定矩阵变换基础上加入新位移变换\n     * !#en Add new displacement transducer in a matrix transformation on the basis of a given\n     * @method translate\n     * @typescript\n     * translate<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, a: Out, v: VecLike)\n     * @static\n     */\n    static translate<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, a: Out, v: VecLike) {\n        let m = out.m, am = a.m;\n        if (a === out) {\n            m[12] += v.x;\n            m[13] += v.y;\n            m[14] += v.y;\n        } else {\n            m[0] = am[0]; m[1] = am[1]; m[2] = am[2]; m[3] = am[3];\n            m[4] = am[4]; m[5] = am[5]; m[6] = am[6]; m[7] = am[7];\n            m[8] = am[8]; m[9] = am[9]; m[10] = am[10]; m[11] = am[11];\n            m[12] += v.x;\n            m[13] += v.y;\n            m[14] += v.z;\n            m[15] = am[15];\n        }\n        return out;\n    }\n\n    /**\n     * !#zh 在给定矩阵变换基础上加入新缩放变换\n     * !#en Add new scaling transformation in a given matrix transformation on the basis of\n     * @method scale\n     * @typescript\n     * scale<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, a: Out, v: VecLike)\n     * @static\n     */\n    static scale<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, a: Out, v: VecLike) {\n        const x = v.x, y = v.y, z = v.z;\n        let m = out.m, am = a.m;\n        m[0] = am[0] * x;\n        m[1] = am[1] * x;\n        m[2] = am[2] * x;\n        m[3] = am[3] * x;\n        m[4] = am[4] * y;\n        m[5] = am[5] * y;\n        m[6] = am[6] * y;\n        m[7] = am[7] * y;\n        m[8] = am[8] * z;\n        m[9] = am[9] * z;\n        m[10] = am[10] * z;\n        m[11] = am[11] * z;\n        m[12] = am[12];\n        m[13] = am[13];\n        m[14] = am[14];\n        m[15] = am[15];\n        return out;\n    }\n\n    /**\n     * !#zh 在给定矩阵变换基础上加入新旋转变换\n     * !#en Add a new rotational transform matrix transformation on the basis of a given\n     * @method rotate\n     * @typescript\n     * rotate<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, a: Out, rad: number, axis: VecLike)\n     * @param rad 旋转角度\n     * @param axis 旋转轴\n     * @static\n     */\n    static rotate<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, a: Out, rad: number, axis: VecLike) {\n        let x = axis.x, y = axis.y, z = axis.z;\n\n        let len = Math.sqrt(x * x + y * y + z * z);\n\n        if (Math.abs(len) < EPSILON) {\n            return null;\n        }\n\n        len = 1 / len;\n        x *= len;\n        y *= len;\n        z *= len;\n\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        const t = 1 - c;\n\n        let am = a.m;\n        _a00 = am[0]; _a01 = am[1]; _a02 = am[2]; _a03 = am[3];\n        _a10 = am[4]; _a11 = am[5]; _a12 = am[6]; _a13 = am[7];\n        _a20 = am[8]; _a21 = am[9]; _a22 = am[10]; _a23 = am[11];\n\n        // Construct the elements of the rotation matrix\n        const b00 = x * x * t + c, b01 = y * x * t + z * s, b02 = z * x * t - y * s;\n        const b10 = x * y * t - z * s, b11 = y * y * t + c, b12 = z * y * t + x * s;\n        const b20 = x * z * t + y * s, b21 = y * z * t - x * s, b22 = z * z * t + c;\n\n        let m = out.m;\n        // Perform rotation-specific matrix multiplication\n        m[0] = _a00 * b00 + _a10 * b01 + _a20 * b02;\n        m[1] = _a01 * b00 + _a11 * b01 + _a21 * b02;\n        m[2] = _a02 * b00 + _a12 * b01 + _a22 * b02;\n        m[3] = _a03 * b00 + _a13 * b01 + _a23 * b02;\n        m[4] = _a00 * b10 + _a10 * b11 + _a20 * b12;\n        m[5] = _a01 * b10 + _a11 * b11 + _a21 * b12;\n        m[6] = _a02 * b10 + _a12 * b11 + _a22 * b12;\n        m[7] = _a03 * b10 + _a13 * b11 + _a23 * b12;\n        m[8] = _a00 * b20 + _a10 * b21 + _a20 * b22;\n        m[9] = _a01 * b20 + _a11 * b21 + _a21 * b22;\n        m[10] = _a02 * b20 + _a12 * b21 + _a22 * b22;\n        m[11] = _a03 * b20 + _a13 * b21 + _a23 * b22;\n\n        // If the source and destination differ, copy the unchanged last row\n        if (a !== out) {\n            m[12] = am[12];\n            m[13] = am[13];\n            m[14] = am[14];\n            m[15] = am[15];\n        }\n\n        return out;\n    }\n\n    /**\n     * !#zh 在给定矩阵变换基础上加入绕 X 轴的旋转变换\n     * !#en Add rotational transformation around the X axis at a given matrix transformation on the basis of\n     * @method rotateX\n     * @typescript\n     * rotateX<Out extends IMat4Like> (out: Out, a: Out, rad: number)\n     * @param rad 旋转角度\n     * @static\n     */\n    static rotateX<Out extends IMat4Like> (out: Out, a: Out, rad: number) {\n        let m = out.m, am = a.m;\n        const s = Math.sin(rad),\n            c = Math.cos(rad),\n            a10 = am[4],\n            a11 = am[5],\n            a12 = am[6],\n            a13 = am[7],\n            a20 = am[8],\n            a21 = am[9],\n            a22 = am[10],\n            a23 = am[11];\n\n        if (a !== out) { // If the source and destination differ, copy the unchanged rows\n            m[0] = am[0];\n            m[1] = am[1];\n            m[2] = am[2];\n            m[3] = am[3];\n            m[12] = am[12];\n            m[13] = am[13];\n            m[14] = am[14];\n            m[15] = am[15];\n        }\n\n        // Perform axis-specific matrix multiplication\n        m[4] = a10 * c + a20 * s;\n        m[5] = a11 * c + a21 * s;\n        m[6] = a12 * c + a22 * s;\n        m[7] = a13 * c + a23 * s;\n        m[8] = a20 * c - a10 * s;\n        m[9] = a21 * c - a11 * s;\n        m[10] = a22 * c - a12 * s;\n        m[11] = a23 * c - a13 * s;\n\n        return out;\n    }\n\n    /**\n     * !#zh 在给定矩阵变换基础上加入绕 Y 轴的旋转变换\n     * !#en Add about the Y axis rotation transformation in a given matrix transformation on the basis of\n     * @method rotateY\n     * @typescript\n     * rotateY<Out extends IMat4Like> (out: Out, a: Out, rad: number)\n     * @param rad 旋转角度\n     * @static\n     */\n    static rotateY<Out extends IMat4Like> (out: Out, a: Out, rad: number) {\n        let m = out.m, am = a.m;\n        const s = Math.sin(rad),\n            c = Math.cos(rad),\n            a00 = am[0],\n            a01 = am[1],\n            a02 = am[2],\n            a03 = am[3],\n            a20 = am[8],\n            a21 = am[9],\n            a22 = am[10],\n            a23 = am[11];\n\n        if (a !== out) { // If the source and destination differ, copy the unchanged rows\n            m[4] = am[4];\n            m[5] = am[5];\n            m[6] = am[6];\n            m[7] = am[7];\n            m[12] = am[12];\n            m[13] = am[13];\n            m[14] = am[14];\n            m[15] = am[15];\n        }\n\n        // Perform axis-specific matrix multiplication\n        m[0] = a00 * c - a20 * s;\n        m[1] = a01 * c - a21 * s;\n        m[2] = a02 * c - a22 * s;\n        m[3] = a03 * c - a23 * s;\n        m[8] = a00 * s + a20 * c;\n        m[9] = a01 * s + a21 * c;\n        m[10] = a02 * s + a22 * c;\n        m[11] = a03 * s + a23 * c;\n\n        return out;\n    }\n\n    /**\n     * !#zh 在给定矩阵变换基础上加入绕 Z 轴的旋转变换\n     * !#en Added about the Z axis at a given rotational transformation matrix transformation on the basis of\n     * @method rotateZ\n     * @typescript\n     * rotateZ<Out extends IMat4Like> (out: Out, a: Out, rad: number)\n     * @param rad 旋转角度\n     * @static\n     */\n    static rotateZ<Out extends IMat4Like> (out: Out, a: Out, rad: number) {\n        const am = a.m;\n        let m = out.m;\n        const s = Math.sin(rad),\n            c = Math.cos(rad),\n            a00 = a.m[0],\n            a01 = a.m[1],\n            a02 = a.m[2],\n            a03 = a.m[3],\n            a10 = a.m[4],\n            a11 = a.m[5],\n            a12 = a.m[6],\n            a13 = a.m[7];\n\n        // If the source and destination differ, copy the unchanged last row\n        if (a !== out) {\n            m[8] = am[8];\n            m[9] = am[9];\n            m[10] = am[10];\n            m[11] = am[11];\n            m[12] = am[12];\n            m[13] = am[13];\n            m[14] = am[14];\n            m[15] = am[15];\n        }\n\n        // Perform axis-specific matrix multiplication\n        m[0] = a00 * c + a10 * s;\n        m[1] = a01 * c + a11 * s;\n        m[2] = a02 * c + a12 * s;\n        m[3] = a03 * c + a13 * s;\n        m[4] = a10 * c - a00 * s;\n        m[5] = a11 * c - a01 * s;\n        m[6] = a12 * c - a02 * s;\n        m[7] = a13 * c - a03 * s;\n\n        return out;\n    }\n\n    /**\n     * !#zh 计算位移矩阵\n     * !#en Displacement matrix calculation\n     * @method fromTranslation\n     * @typescript\n     * fromTranslation<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, v: VecLike)\n     * @static\n     */\n    static fromTranslation<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, v: VecLike) {\n        let m = out.m;\n        m[0] = 1;\n        m[1] = 0;\n        m[2] = 0;\n        m[3] = 0;\n        m[4] = 0;\n        m[5] = 1;\n        m[6] = 0;\n        m[7] = 0;\n        m[8] = 0;\n        m[9] = 0;\n        m[10] = 1;\n        m[11] = 0;\n        m[12] = v.x;\n        m[13] = v.y;\n        m[14] = v.z;\n        m[15] = 1;\n        return out;\n    }\n\n    /**\n     * !#zh 计算缩放矩阵\n     * !#en Scaling matrix calculation\n     * @method fromScaling\n     * @typescript\n     * fromScaling<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, v: VecLike)\n     * @static\n     */\n    static fromScaling<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, v: VecLike) {\n        let m = out.m;\n        m[0] = v.x;\n        m[1] = 0;\n        m[2] = 0;\n        m[3] = 0;\n        m[4] = 0;\n        m[5] = v.y;\n        m[6] = 0;\n        m[7] = 0;\n        m[8] = 0;\n        m[9] = 0;\n        m[10] = v.z;\n        m[11] = 0;\n        m[12] = 0;\n        m[13] = 0;\n        m[14] = 0;\n        m[15] = 1;\n        return out;\n    }\n\n    /**\n     * !#zh 计算旋转矩阵\n     * !#en Calculates the rotation matrix\n     * @method fromRotation\n     * @typescript\n     * fromRotation<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, rad: number, axis: VecLike)\n     * @static\n     */\n    static fromRotation<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, rad: number, axis: VecLike) {\n        let x = axis.x, y = axis.y, z = axis.z;\n        let len = Math.sqrt(x * x + y * y + z * z);\n\n        if (Math.abs(len) < EPSILON) {\n            return null;\n        }\n\n        len = 1 / len;\n        x *= len;\n        y *= len;\n        z *= len;\n\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        const t = 1 - c;\n\n        // Perform rotation-specific matrix multiplication\n        let m = out.m;\n        m[0] = x * x * t + c;\n        m[1] = y * x * t + z * s;\n        m[2] = z * x * t - y * s;\n        m[3] = 0;\n        m[4] = x * y * t - z * s;\n        m[5] = y * y * t + c;\n        m[6] = z * y * t + x * s;\n        m[7] = 0;\n        m[8] = x * z * t + y * s;\n        m[9] = y * z * t - x * s;\n        m[10] = z * z * t + c;\n        m[11] = 0;\n        m[12] = 0;\n        m[13] = 0;\n        m[14] = 0;\n        m[15] = 1;\n        return out;\n    }\n\n    /**\n     * !#zh 计算绕 X 轴的旋转矩阵\n     * !#en Calculating rotation matrix about the X axis\n     * @method fromXRotation\n     * @typescript\n     * fromXRotation<Out extends IMat4Like> (out: Out, rad: number)\n     * @static\n     */\n    static fromXRotation<Out extends IMat4Like> (out: Out, rad: number) {\n        const s = Math.sin(rad), c = Math.cos(rad);\n\n        // Perform axis-specific matrix multiplication\n        let m = out.m;\n        m[0] = 1;\n        m[1] = 0;\n        m[2] = 0;\n        m[3] = 0;\n        m[4] = 0;\n        m[5] = c;\n        m[6] = s;\n        m[7] = 0;\n        m[8] = 0;\n        m[9] = -s;\n        m[10] = c;\n        m[11] = 0;\n        m[12] = 0;\n        m[13] = 0;\n        m[14] = 0;\n        m[15] = 1;\n        return out;\n    }\n\n    /**\n     * !#zh 计算绕 Y 轴的旋转矩阵\n     * !#en Calculating rotation matrix about the Y axis\n     * @method fromYRotation\n     * @typescript\n     * fromYRotation<Out extends IMat4Like> (out: Out, rad: number)\n     * @static\n     */\n    static fromYRotation<Out extends IMat4Like> (out: Out, rad: number) {\n        const s = Math.sin(rad), c = Math.cos(rad);\n\n        // Perform axis-specific matrix multiplication\n        let m = out.m;\n        m[0] = c;\n        m[1] = 0;\n        m[2] = -s;\n        m[3] = 0;\n        m[4] = 0;\n        m[5] = 1;\n        m[6] = 0;\n        m[7] = 0;\n        m[8] = s;\n        m[9] = 0;\n        m[10] = c;\n        m[11] = 0;\n        m[12] = 0;\n        m[13] = 0;\n        m[14] = 0;\n        m[15] = 1;\n        return out;\n    }\n\n    /**\n     * !#zh 计算绕 Z 轴的旋转矩阵\n     * !#en Calculating rotation matrix about the Z axis\n     * @method fromZRotation\n     * @typescript\n     * fromZRotation<Out extends IMat4Like> (out: Out, rad: number)\n     * @static\n     */\n    static fromZRotation<Out extends IMat4Like> (out: Out, rad: number) {\n        const s = Math.sin(rad), c = Math.cos(rad);\n\n        // Perform axis-specific matrix multiplication\n        let m = out.m;\n        m[0] = c;\n        m[1] = s;\n        m[2] = 0;\n        m[3] = 0;\n        m[4] = -s;\n        m[5] = c;\n        m[6] = 0;\n        m[7] = 0;\n        m[8] = 0;\n        m[9] = 0;\n        m[10] = 1;\n        m[11] = 0;\n        m[12] = 0;\n        m[13] = 0;\n        m[14] = 0;\n        m[15] = 1;\n        return out;\n    }\n\n    /**\n     * !#zh 根据旋转和位移信息计算矩阵\n     * !#en The rotation and displacement information calculating matrix\n     * @method fromRT\n     * @typescript\n     * fromRT<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, q: Quat, v: VecLike)\n     * @static\n     */\n    static fromRT<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, q: Quat, v: VecLike) {\n        const x = q.x, y = q.y, z = q.z, w = q.w;\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n\n        let m = out.m;\n        m[0] = 1 - (yy + zz);\n        m[1] = xy + wz;\n        m[2] = xz - wy;\n        m[3] = 0;\n        m[4] = xy - wz;\n        m[5] = 1 - (xx + zz);\n        m[6] = yz + wx;\n        m[7] = 0;\n        m[8] = xz + wy;\n        m[9] = yz - wx;\n        m[10] = 1 - (xx + yy);\n        m[11] = 0;\n        m[12] = v.x;\n        m[13] = v.y;\n        m[14] = v.z;\n        m[15] = 1;\n\n        return out;\n    }\n\n    /**\n     * !#zh 提取矩阵的位移信息, 默认矩阵中的变换以 S->R->T 的顺序应用\n     * !#en Extracting displacement information of the matrix, the matrix transform to the default sequential application S-> R-> T is\n     * @method getTranslation\n     * @typescript\n     * getTranslation<Out extends IMat4Like, VecLike extends IVec3Like> (out: VecLike, mat: Out)\n     * @static\n     */\n    static getTranslation<Out extends IMat4Like, VecLike extends IVec3Like> (out: VecLike, mat: Out) {\n        let m = mat.m;\n        out.x = m[12];\n        out.y = m[13];\n        out.z = m[14];\n\n        return out;\n    }\n\n    /**\n     * !#zh 提取矩阵的缩放信息, 默认矩阵中的变换以 S->R->T 的顺序应用\n     * !#en Scaling information extraction matrix, the matrix transform to the default sequential application S-> R-> T is\n     * @method getScaling\n     * @typescript\n     * getScaling<Out extends IMat4Like, VecLike extends IVec3Like> (out: VecLike, mat: Out)\n     * @static\n     */\n    static getScaling<Out extends IMat4Like, VecLike extends IVec3Like> (out: VecLike, mat: Out) {\n        let m = mat.m;\n        let m3 = m3_1.m;\n        const m00 = m3[0] = m[0];\n        const m01 = m3[1] = m[1];\n        const m02 = m3[2] = m[2];\n        const m04 = m3[3] = m[4];\n        const m05 = m3[4] = m[5];\n        const m06 = m3[5] = m[6];\n        const m08 = m3[6] = m[8];\n        const m09 = m3[7] = m[9];\n        const m10 = m3[8] = m[10];\n        out.x = Math.sqrt(m00 * m00 + m01 * m01 + m02 * m02);\n        out.y = Math.sqrt(m04 * m04 + m05 * m05 + m06 * m06);\n        out.z = Math.sqrt(m08 * m08 + m09 * m09 + m10 * m10);\n        // account for refections\n        if (Mat3.determinant(m3_1) < 0) { out.x *= -1; }\n        return out;\n    }\n\n    /**\n     * !#zh 提取矩阵的旋转信息, 默认输入矩阵不含有缩放信息，如考虑缩放应使用 `toRTS` 函数。\n     * !#en Rotation information extraction matrix, the matrix containing no default input scaling information, such as the use of `toRTS` should consider the scaling function.\n     * @method getRotation\n     * @typescript\n     * getRotation<Out extends IMat4Like> (out: Quat, mat: Out)\n     * @static\n     */\n    static getRotation<Out extends IMat4Like> (out: Quat, mat: Out) {\n        let m = mat.m;\n        const trace = m[0] + m[5] + m[10];\n        let S = 0;\n\n        if (trace > 0) {\n            S = Math.sqrt(trace + 1.0) * 2;\n            out.w = 0.25 * S;\n            out.x = (m[6] - m[9]) / S;\n            out.y = (m[8] - m[2]) / S;\n            out.z = (m[1] - m[4]) / S;\n        } else if ((m[0] > m[5]) && (m[0] > m[10])) {\n            S = Math.sqrt(1.0 + m[0] - m[5] - m[10]) * 2;\n            out.w = (m[6] - m[9]) / S;\n            out.x = 0.25 * S;\n            out.y = (m[1] + m[4]) / S;\n            out.z = (m[8] + m[2]) / S;\n        } else if (m[5] > m[10]) {\n            S = Math.sqrt(1.0 + m[5] - m[0] - m[10]) * 2;\n            out.w = (m[8] - m[2]) / S;\n            out.x = (m[1] + m[4]) / S;\n            out.y = 0.25 * S;\n            out.z = (m[6] + m[9]) / S;\n        } else {\n            S = Math.sqrt(1.0 + m[10] - m[0] - m[5]) * 2;\n            out.w = (m[1] - m[4]) / S;\n            out.x = (m[8] + m[2]) / S;\n            out.y = (m[6] + m[9]) / S;\n            out.z = 0.25 * S;\n        }\n\n        return out;\n    }\n\n    /**\n     * !#zh 提取旋转、位移、缩放信息， 默认矩阵中的变换以 S->R->T 的顺序应用\n     * !#en Extracting rotational displacement, zoom information, the default matrix transformation in order S-> R-> T applications\n     * @method toRTS\n     * @typescript\n     * toRTS<Out extends IMat4Like, VecLike extends IVec3Like> (mat: Out, q: Quat, v: VecLike, s: VecLike)\n     * @static\n     */\n    static toRTS<Out extends IMat4Like, VecLike extends IVec3Like> (mat: Out, q: Quat, v: VecLike, s: VecLike) {\n        let m = mat.m;\n        let m3 = m3_1.m;\n        s.x = Vec3.set(v3_1, m[0], m[1], m[2]).mag();\n        m3[0] = m[0] / s.x;\n        m3[1] = m[1] / s.x;\n        m3[2] = m[2] / s.x;\n        s.y = Vec3.set(v3_1, m[4], m[5], m[6]).mag();\n        m3[3] = m[4] / s.y;\n        m3[4] = m[5] / s.y;\n        m3[5] = m[6] / s.y;\n        s.z = Vec3.set(v3_1, m[8], m[9], m[10]).mag();\n        m3[6] = m[8] / s.z;\n        m3[7] = m[9] / s.z;\n        m3[8] = m[10] / s.z;\n        const det = Mat3.determinant(m3_1);\n        if (det < 0) { s.x *= -1; m3[0] *= -1; m3[1] *= -1; m3[2] *= -1; }\n        Quat.fromMat3(q, m3_1); // already normalized\n        Vec3.set(v, m[12], m[13], m[14]);\n    }\n\n    /**\n     * !#zh 根据旋转、位移、缩放信息计算矩阵，以 S->R->T 的顺序应用\n     * !#en The rotary displacement, the scaling matrix calculation information, the order S-> R-> T applications\n     * @method fromRTS\n     * @typescript\n     * fromRTS<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, q: Quat, v: VecLike, s: VecLike)\n     * @static\n     */\n    static fromRTS<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, q: Quat, v: VecLike, s: VecLike) {\n        const x = q.x, y = q.y, z = q.z, w = q.w;\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        const sx = s.x;\n        const sy = s.y;\n        const sz = s.z;\n\n        let m = out.m;\n        m[0] = (1 - (yy + zz)) * sx;\n        m[1] = (xy + wz) * sx;\n        m[2] = (xz - wy) * sx;\n        m[3] = 0;\n        m[4] = (xy - wz) * sy;\n        m[5] = (1 - (xx + zz)) * sy;\n        m[6] = (yz + wx) * sy;\n        m[7] = 0;\n        m[8] = (xz + wy) * sz;\n        m[9] = (yz - wx) * sz;\n        m[10] = (1 - (xx + yy)) * sz;\n        m[11] = 0;\n        m[12] = v.x;\n        m[13] = v.y;\n        m[14] = v.z;\n        m[15] = 1;\n\n        return out;\n    }\n\n    /**\n     * !#zh 根据指定的旋转、位移、缩放及变换中心信息计算矩阵，以 S->R->T 的顺序应用\n     * !#en According to the specified rotation, displacement, and scale conversion matrix calculation information center, order S-> R-> T applications\n     * @method fromRTSOrigin\n     * @typescript\n     * fromRTSOrigin<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, q: Quat, v: VecLike, s: VecLike, o: VecLike)\n     * @param q 旋转值\n     * @param v 位移值\n     * @param s 缩放值\n     * @param o 指定变换中心\n     * @static\n     */\n    static fromRTSOrigin<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, q: Quat, v: VecLike, s: VecLike, o: VecLike) {\n        const x = q.x, y = q.y, z = q.z, w = q.w;\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n\n        const sx = s.x;\n        const sy = s.y;\n        const sz = s.z;\n\n        const ox = o.x;\n        const oy = o.y;\n        const oz = o.z;\n\n        let m = out.m;\n        m[0] = (1 - (yy + zz)) * sx;\n        m[1] = (xy + wz) * sx;\n        m[2] = (xz - wy) * sx;\n        m[3] = 0;\n        m[4] = (xy - wz) * sy;\n        m[5] = (1 - (xx + zz)) * sy;\n        m[6] = (yz + wx) * sy;\n        m[7] = 0;\n        m[8] = (xz + wy) * sz;\n        m[9] = (yz - wx) * sz;\n        m[10] = (1 - (xx + yy)) * sz;\n        m[11] = 0;\n        m[12] = v.x + ox - (m[0] * ox + m[4] * oy + m[8] * oz);\n        m[13] = v.y + oy - (m[1] * ox + m[5] * oy + m[9] * oz);\n        m[14] = v.z + oz - (m[2] * ox + m[6] * oy + m[10] * oz);\n        m[15] = 1;\n\n        return out;\n    }\n\n    /**\n     * !#zh 根据指定的旋转信息计算矩阵\n     * !#en The rotation matrix calculation information specified\n     * @method fromQuat\n     * @typescript\n     * fromQuat<Out extends IMat4Like> (out: Out, q: Quat)\n     * @static\n     */\n    static fromQuat<Out extends IMat4Like> (out: Out, q: Quat) {\n        const x = q.x, y = q.y, z = q.z, w = q.w;\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n\n        const xx = x * x2;\n        const yx = y * x2;\n        const yy = y * y2;\n        const zx = z * x2;\n        const zy = z * y2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n\n        let m = out.m;\n        m[0] = 1 - yy - zz;\n        m[1] = yx + wz;\n        m[2] = zx - wy;\n        m[3] = 0;\n\n        m[4] = yx - wz;\n        m[5] = 1 - xx - zz;\n        m[6] = zy + wx;\n        m[7] = 0;\n\n        m[8] = zx + wy;\n        m[9] = zy - wx;\n        m[10] = 1 - xx - yy;\n        m[11] = 0;\n\n        m[12] = 0;\n        m[13] = 0;\n        m[14] = 0;\n        m[15] = 1;\n\n        return out;\n    }\n\n    /**\n     * !#zh 根据指定的视锥体信息计算矩阵\n     * !#en The matrix calculation information specified frustum\n     * @method frustum\n     * @typescript\n     * frustum<Out extends IMat4Like> (out: Out, left: number, right: number, bottom: number, top: number, near: number, far: number)\n     * @param left 左平面距离\n     * @param right 右平面距离\n     * @param bottom 下平面距离\n     * @param top 上平面距离\n     * @param near 近平面距离\n     * @param far 远平面距离\n     * @static\n     */\n    static frustum<Out extends IMat4Like> (out: Out, left: number, right: number, bottom: number, top: number, near: number, far: number) {\n        const rl = 1 / (right - left);\n        const tb = 1 / (top - bottom);\n        const nf = 1 / (near - far);\n\n        let m = out.m;\n        m[0] = (near * 2) * rl;\n        m[1] = 0;\n        m[2] = 0;\n        m[3] = 0;\n        m[4] = 0;\n        m[5] = (near * 2) * tb;\n        m[6] = 0;\n        m[7] = 0;\n        m[8] = (right + left) * rl;\n        m[9] = (top + bottom) * tb;\n        m[10] = (far + near) * nf;\n        m[11] = -1;\n        m[12] = 0;\n        m[13] = 0;\n        m[14] = (far * near * 2) * nf;\n        m[15] = 0;\n        return out;\n    }\n\n    /**\n     * !#zh 计算透视投影矩阵\n     * !#en Perspective projection matrix calculation\n     * @method perspective\n     * @typescript\n     * perspective<Out extends IMat4Like> (out: Out, fovy: number, aspect: number, near: number, far: number)\n     * @param fovy 纵向视角高度\n     * @param aspect 长宽比\n     * @param near 近平面距离\n     * @param far 远平面距离\n     * @static\n     */\n    static perspective<Out extends IMat4Like> (out: Out, fovy: number, aspect: number, near: number, far: number) {\n        const f = 1.0 / Math.tan(fovy / 2);\n        const nf = 1 / (near - far);\n\n        let m = out.m;\n        m[0] = f / aspect;\n        m[1] = 0;\n        m[2] = 0;\n        m[3] = 0;\n        m[4] = 0;\n        m[5] = f;\n        m[6] = 0;\n        m[7] = 0;\n        m[8] = 0;\n        m[9] = 0;\n        m[10] = (far + near) * nf;\n        m[11] = -1;\n        m[12] = 0;\n        m[13] = 0;\n        m[14] = (2 * far * near) * nf;\n        m[15] = 0;\n        return out;\n    }\n\n    /**\n     * !#zh 计算正交投影矩阵\n     * !#en Computing orthogonal projection matrix\n     * @method ortho\n     * @typescript\n     * ortho<Out extends IMat4Like> (out: Out, left: number, right: number, bottom: number, top: number, near: number, far: number)\n     * @param left 左平面距离\n     * @param right 右平面距离\n     * @param bottom 下平面距离\n     * @param top 上平面距离\n     * @param near 近平面距离\n     * @param far 远平面距离\n     * @static\n     */\n    static ortho<Out extends IMat4Like> (out: Out, left: number, right: number, bottom: number, top: number, near: number, far: number) {\n        const lr = 1 / (left - right);\n        const bt = 1 / (bottom - top);\n        const nf = 1 / (near - far);\n        let m = out.m;\n        m[0] = -2 * lr;\n        m[1] = 0;\n        m[2] = 0;\n        m[3] = 0;\n        m[4] = 0;\n        m[5] = -2 * bt;\n        m[6] = 0;\n        m[7] = 0;\n        m[8] = 0;\n        m[9] = 0;\n        m[10] = 2 * nf;\n        m[11] = 0;\n        m[12] = (left + right) * lr;\n        m[13] = (top + bottom) * bt;\n        m[14] = (far + near) * nf;\n        m[15] = 1;\n        return out;\n    }\n\n    /**\n     * !#zh 根据视点计算矩阵，注意 `eye - center` 不能为零向量或与 `up` 向量平行\n     * !#en `Up` parallel vector or vector center` not be zero - the matrix calculation according to the viewpoint, note` eye\n     * @method lookAt\n     * @typescript\n     * lookAt<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, eye: VecLike, center: VecLike, up: VecLike)\n     * @param eye 当前位置\n     * @param center 目标视点\n     * @param up 视口上方向\n     * @static\n     */\n    static lookAt<Out extends IMat4Like, VecLike extends IVec3Like> (out: Out, eye: VecLike, center: VecLike, up: VecLike) {\n        const eyex = eye.x;\n        const eyey = eye.y;\n        const eyez = eye.z;\n        const upx = up.x;\n        const upy = up.y;\n        const upz = up.z;\n        const centerx = center.x;\n        const centery = center.y;\n        const centerz = center.z;\n\n        let z0 = eyex - centerx;\n        let z1 = eyey - centery;\n        let z2 = eyez - centerz;\n\n        let len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n        z0 *= len;\n        z1 *= len;\n        z2 *= len;\n\n        let x0 = upy * z2 - upz * z1;\n        let x1 = upz * z0 - upx * z2;\n        let x2 = upx * z1 - upy * z0;\n        len = 1 / Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n        x0 *= len;\n        x1 *= len;\n        x2 *= len;\n\n        const y0 = z1 * x2 - z2 * x1;\n        const y1 = z2 * x0 - z0 * x2;\n        const y2 = z0 * x1 - z1 * x0;\n\n        let m = out.m;\n        m[0] = x0;\n        m[1] = y0;\n        m[2] = z0;\n        m[3] = 0;\n        m[4] = x1;\n        m[5] = y1;\n        m[6] = z1;\n        m[7] = 0;\n        m[8] = x2;\n        m[9] = y2;\n        m[10] = z2;\n        m[11] = 0;\n        m[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n        m[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n        m[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n        m[15] = 1;\n\n        return out;\n    }\n\n    /**\n     * !#zh 计算逆转置矩阵\n     * !#en Reversal matrix calculation\n     * @method inverseTranspose\n     * @typescript\n     * inverseTranspose<Out extends IMat4Like> (out: Out, a: Out)\n     * @static\n     */\n    static inverseTranspose<Out extends IMat4Like> (out: Out, a: Out) {\n\n        let m = a.m;\n        _a00 = m[0]; _a01 = m[1]; _a02 = m[2]; _a03 = m[3];\n        _a10 = m[4]; _a11 = m[5]; _a12 = m[6]; _a13 = m[7];\n        _a20 = m[8]; _a21 = m[9]; _a22 = m[10]; _a23 = m[11];\n        _a30 = m[12]; _a31 = m[13]; _a32 = m[14]; _a33 = m[15];\n\n        const b00 = _a00 * _a11 - _a01 * _a10;\n        const b01 = _a00 * _a12 - _a02 * _a10;\n        const b02 = _a00 * _a13 - _a03 * _a10;\n        const b03 = _a01 * _a12 - _a02 * _a11;\n        const b04 = _a01 * _a13 - _a03 * _a11;\n        const b05 = _a02 * _a13 - _a03 * _a12;\n        const b06 = _a20 * _a31 - _a21 * _a30;\n        const b07 = _a20 * _a32 - _a22 * _a30;\n        const b08 = _a20 * _a33 - _a23 * _a30;\n        const b09 = _a21 * _a32 - _a22 * _a31;\n        const b10 = _a21 * _a33 - _a23 * _a31;\n        const b11 = _a22 * _a33 - _a23 * _a32;\n\n        // Calculate the determinant\n        let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n\n        m = out.m;\n        m[0] = (_a11 * b11 - _a12 * b10 + _a13 * b09) * det;\n        m[1] = (_a12 * b08 - _a10 * b11 - _a13 * b07) * det;\n        m[2] = (_a10 * b10 - _a11 * b08 + _a13 * b06) * det;\n        m[3] = 0;\n\n        m[4] = (_a02 * b10 - _a01 * b11 - _a03 * b09) * det;\n        m[5] = (_a00 * b11 - _a02 * b08 + _a03 * b07) * det;\n        m[6] = (_a01 * b08 - _a00 * b10 - _a03 * b06) * det;\n        m[7] = 0;\n\n        m[8] = (_a31 * b05 - _a32 * b04 + _a33 * b03) * det;\n        m[9] = (_a32 * b02 - _a30 * b05 - _a33 * b01) * det;\n        m[10] = (_a30 * b04 - _a31 * b02 + _a33 * b00) * det;\n        m[11] = 0;\n\n        m[12] = 0;\n        m[13] = 0;\n        m[14] = 0;\n        m[15] = 1;\n\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素矩阵加法\n     * !#en Element by element matrix addition\n     * @method add\n     * @typescript\n     * add<Out extends IMat4Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static add<Out extends IMat4Like> (out: Out, a: Out, b: Out) {\n        let m = out.m, am = a.m, bm = b.m;\n        m[0] = am[0] + bm[0];\n        m[1] = am[1] + bm[1];\n        m[2] = am[2] + bm[2];\n        m[3] = am[3] + bm[3];\n        m[4] = am[4] + bm[4];\n        m[5] = am[5] + bm[5];\n        m[6] = am[6] + bm[6];\n        m[7] = am[7] + bm[7];\n        m[8] = am[8] + bm[8];\n        m[9] = am[9] + bm[9];\n        m[10] = am[10] + bm[10];\n        m[11] = am[11] + bm[11];\n        m[12] = am[12] + bm[12];\n        m[13] = am[13] + bm[13];\n        m[14] = am[14] + bm[14];\n        m[15] = am[15] + bm[15];\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素矩阵减法\n     * !#en Matrix element by element subtraction\n     * @method subtract\n     * @typescript\n     * subtract<Out extends IMat4Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static subtract<Out extends IMat4Like> (out: Out, a: Out, b: Out) {\n        let m = out.m, am = a.m, bm = b.m;\n        m[0] = am[0] - bm[0];\n        m[1] = am[1] - bm[1];\n        m[2] = am[2] - bm[2];\n        m[3] = am[3] - bm[3];\n        m[4] = am[4] - bm[4];\n        m[5] = am[5] - bm[5];\n        m[6] = am[6] - bm[6];\n        m[7] = am[7] - bm[7];\n        m[8] = am[8] - bm[8];\n        m[9] = am[9] - bm[9];\n        m[10] = am[10] - bm[10];\n        m[11] = am[11] - bm[11];\n        m[12] = am[12] - bm[12];\n        m[13] = am[13] - bm[13];\n        m[14] = am[14] - bm[14];\n        m[15] = am[15] - bm[15];\n        return out;\n    }\n\n    /**\n     * !#zh 矩阵标量乘法\n     * !#en Matrix scalar multiplication\n     * @method multiplyScalar\n     * @typescript\n     * multiplyScalar<Out extends IMat4Like> (out: Out, a: Out, b: number)\n     * @static\n     */\n    static multiplyScalar<Out extends IMat4Like> (out: Out, a: Out, b: number) {\n        let m = out.m, am = a.m;\n        m[0] = am[0] * b;\n        m[1] = am[1] * b;\n        m[2] = am[2] * b;\n        m[3] = am[3] * b;\n        m[4] = am[4] * b;\n        m[5] = am[5] * b;\n        m[6] = am[6] * b;\n        m[7] = am[7] * b;\n        m[8] = am[8] * b;\n        m[9] = am[9] * b;\n        m[10] = am[10] * b;\n        m[11] = am[11] * b;\n        m[12] = am[12] * b;\n        m[13] = am[13] * b;\n        m[14] = am[14] * b;\n        m[15] = am[15] * b;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素矩阵标量乘加: A + B * scale\n     * !#en Elements of the matrix by the scalar multiplication and addition: A + B * scale\n     * @method multiplyScalarAndAdd\n     * @typescript\n     * multiplyScalarAndAdd<Out extends IMat4Like> (out: Out, a: Out, b: Out, scale: number)\n     * @static\n     */\n    static multiplyScalarAndAdd<Out extends IMat4Like> (out: Out, a: Out, b: Out, scale: number) {\n        let m = out.m, am = a.m, bm = b.m;\n        m[0] = am[0] + (bm[0] * scale);\n        m[1] = am[1] + (bm[1] * scale);\n        m[2] = am[2] + (bm[2] * scale);\n        m[3] = am[3] + (bm[3] * scale);\n        m[4] = am[4] + (bm[4] * scale);\n        m[5] = am[5] + (bm[5] * scale);\n        m[6] = am[6] + (bm[6] * scale);\n        m[7] = am[7] + (bm[7] * scale);\n        m[8] = am[8] + (bm[8] * scale);\n        m[9] = am[9] + (bm[9] * scale);\n        m[10] = am[10] + (bm[10] * scale);\n        m[11] = am[11] + (bm[11] * scale);\n        m[12] = am[12] + (bm[12] * scale);\n        m[13] = am[13] + (bm[13] * scale);\n        m[14] = am[14] + (bm[14] * scale);\n        m[15] = am[15] + (bm[15] * scale);\n        return out;\n    }\n\n    /**\n     * !#zh 矩阵等价判断\n     * !#en Analyzing the equivalent matrix\n     * @method strictEquals\n     * @return {bool}\n     * @typescript\n     * strictEquals<Out extends IMat4Like> (a: Out, b: Out)\n     * @static\n     */\n    static strictEquals<Out extends IMat4Like> (a: Out, b: Out) {\n        let am = a.m, bm = b.m;\n        return am[0] === bm[0] && am[1] === bm[1] && am[2] === bm[2] && am[3] === bm[3] &&\n            am[4] === bm[4] && am[5] === bm[5] && am[6] === bm[6] && am[7] === bm[7] &&\n            am[8] === bm[8] && am[9] === bm[9] && am[10] === bm[10] && am[11] === bm[11] &&\n            am[12] === bm[12] && am[13] === bm[13] && am[14] === bm[14] && am[15] === bm[15];\n    }\n\n    /**\n     * !#zh 排除浮点数误差的矩阵近似等价判断\n     * !#en Negative floating point error is approximately equivalent to determining a matrix\n     * @method equals\n     * @typescript\n     * equals<Out extends IMat4Like> (a: Out, b: Out, epsilon = EPSILON)\n     * @static\n     */\n    static equals<Out extends IMat4Like> (a: Out, b: Out, epsilon = EPSILON) {\n\n        let am = a.m, bm = b.m;\n        return (\n            Math.abs(am[0] - bm[0]) <= epsilon * Math.max(1.0, Math.abs(am[0]), Math.abs(bm[0])) &&\n            Math.abs(am[1] - bm[1]) <= epsilon * Math.max(1.0, Math.abs(am[1]), Math.abs(bm[1])) &&\n            Math.abs(am[2] - bm[2]) <= epsilon * Math.max(1.0, Math.abs(am[2]), Math.abs(bm[2])) &&\n            Math.abs(am[3] - bm[3]) <= epsilon * Math.max(1.0, Math.abs(am[3]), Math.abs(bm[3])) &&\n            Math.abs(am[4] - bm[4]) <= epsilon * Math.max(1.0, Math.abs(am[4]), Math.abs(bm[4])) &&\n            Math.abs(am[5] - bm[5]) <= epsilon * Math.max(1.0, Math.abs(am[5]), Math.abs(bm[5])) &&\n            Math.abs(am[6] - bm[6]) <= epsilon * Math.max(1.0, Math.abs(am[6]), Math.abs(bm[6])) &&\n            Math.abs(am[7] - bm[7]) <= epsilon * Math.max(1.0, Math.abs(am[7]), Math.abs(bm[7])) &&\n            Math.abs(am[8] - bm[8]) <= epsilon * Math.max(1.0, Math.abs(am[8]), Math.abs(bm[8])) &&\n            Math.abs(am[9] - bm[9]) <= epsilon * Math.max(1.0, Math.abs(am[9]), Math.abs(bm[9])) &&\n            Math.abs(am[10] - bm[10]) <= epsilon * Math.max(1.0, Math.abs(am[10]), Math.abs(bm[10])) &&\n            Math.abs(am[11] - bm[11]) <= epsilon * Math.max(1.0, Math.abs(am[11]), Math.abs(bm[11])) &&\n            Math.abs(am[12] - bm[12]) <= epsilon * Math.max(1.0, Math.abs(am[12]), Math.abs(bm[12])) &&\n            Math.abs(am[13] - bm[13]) <= epsilon * Math.max(1.0, Math.abs(am[13]), Math.abs(bm[13])) &&\n            Math.abs(am[14] - bm[14]) <= epsilon * Math.max(1.0, Math.abs(am[14]), Math.abs(bm[14])) &&\n            Math.abs(am[15] - bm[15]) <= epsilon * Math.max(1.0, Math.abs(am[15]), Math.abs(bm[15]))\n        );\n    }\n\n    /**\n     * Calculates the adjugate of a matrix.\n     *\n     * @param {Mat4} out - Matrix to store result.\n     * @param {Mat4} a - Matrix to calculate.\n     * @returns {Mat4} out.\n     */\n    static adjoint (out, a) {\n        let am = a.m, outm = out.m;\n        let a00 = am[0], a01 = am[1], a02 = am[2], a03 = am[3],\n            a10 = am[4], a11 = am[5], a12 = am[6], a13 = am[7],\n            a20 = am[8], a21 = am[9], a22 = am[10], a23 = am[11],\n            a30 = am[12], a31 = am[13], a32 = am[14], a33 = am[15];\n\n        outm[0] = (a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22));\n        outm[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n        outm[2] = (a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12));\n        outm[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n        outm[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n        outm[5] = (a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22));\n        outm[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n        outm[7] = (a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12));\n        outm[8] = (a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21));\n        outm[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n        outm[10] = (a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11));\n        outm[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n        outm[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n        outm[13] = (a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21));\n        outm[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n        outm[15] = (a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11));\n        return out;\n    }\n\n    /**\n     * !#zh 矩阵转数组\n     * !#en Matrix transpose array\n     * @method toArray\n     * @typescript\n     * toArray <Out extends IWritableArrayLike<number>> (out: Out, mat: IMat4Like, ofs = 0)\n     * @param ofs 数组内的起始偏移量\n     * @static\n     */\n    static toArray<Out extends IWritableArrayLike<number>> (out: Out, mat: IMat4Like, ofs = 0) {\n        let m = mat.m;\n        for (let i = 0; i < 16; i++) {\n            out[ofs + i] = m[i];\n        }\n        return out;\n    }\n\n    /**\n     * !#zh 数组转矩阵\n     * !#en Transfer matrix array\n     * @method fromArray\n     * @typescript\n     * fromArray <Out extends IMat4Like> (out: Out, arr: IWritableArrayLike<number>, ofs = 0)\n     * @param ofs 数组起始偏移量\n     * @static\n     */\n    static fromArray<Out extends IMat4Like> (out: Out, arr: IWritableArrayLike<number>, ofs = 0) {\n        let m = out.m;\n        for (let i = 0; i < 16; i++) {\n            m[i] = arr[ofs + i];\n        }\n        return out;\n    }\n\n    /**\n     * !#en Matrix Data\n     * !#zh 矩阵数据\n     * @property {Float64Array | Float32Array} m\n     */\n    m: FloatArray;\n\n\n    /**\n     * !#en\n     * Constructor\n     * see {{#crossLink \"cc/mat4:method\"}}cc.mat4{{/crossLink}}\n     * !#zh\n     * 构造函数，可查看 {{#crossLink \"cc/mat4:method\"}}cc.mat4{{/crossLink}}\n     * @method constructor\n     * @typescript\n     * constructor ( m00: number = 1, m01: number = 0, m02: number = 0, m03: number = 0, m10: number = 0, m11: number = 1, m12: number = 0, m13: number = 0, m20: number = 0, m21: number = 0, m22: number = 1, m23: number = 0, m30: number = 0, m31: number = 0, m32: number = 0, m33: number = 1)\n     */\n    constructor (\n        m00: number | FloatArray = 1, m01: number = 0, m02: number = 0, m03: number = 0,\n        m10: number = 0, m11: number = 1, m12: number = 0, m13: number = 0,\n        m20: number = 0, m21: number = 0, m22: number = 1, m23: number = 0,\n        m30: number = 0, m31: number = 0, m32: number = 0, m33: number = 1) {\n        super();\n        if (m00 instanceof FLOAT_ARRAY_TYPE) {\n            this.m = m00;\n        } else {\n            this.m = new FLOAT_ARRAY_TYPE(16);\n            let tm = this.m;\n            tm[0] = m00 as number;\n            tm[1] = m01;\n            tm[2] = m02;\n            tm[3] = m03;\n            tm[4] = m10;\n            tm[5] = m11;\n            tm[6] = m12;\n            tm[7] = m13;\n            tm[8] = m20;\n            tm[9] = m21;\n            tm[10] = m22;\n            tm[11] = m23;\n            tm[12] = m30;\n            tm[13] = m31;\n            tm[14] = m32;\n            tm[15] = m33;\n        }\n    }\n\n    /**\n     * !#en clone a Mat4 object\n     * !#zh 克隆一个 Mat4 对象\n     * @method clone\n     * @return {Mat4}\n     */\n    clone () {\n        let t = this;\n        let tm = t.m;\n        return new Mat4(\n            tm[0], tm[1], tm[2], tm[3],\n            tm[4], tm[5], tm[6], tm[7],\n            tm[8], tm[9], tm[10], tm[11],\n            tm[12], tm[13], tm[14], tm[15]);\n    }\n\n    /**\n     * !#en Sets the matrix with another one's value\n     * !#zh 用另一个矩阵设置这个矩阵的值。\n     * @method set\n     * @param {Mat4} srcObj\n     * @return {Mat4} returns this\n     * @chainable\n     */\n    set (s) {\n        let t = this;\n        let tm = t.m, sm = s.m;\n        tm[0] = sm[0];\n        tm[1] = sm[1];\n        tm[2] = sm[2];\n        tm[3] = sm[3];\n        tm[4] = sm[4];\n        tm[5] = sm[5];\n        tm[6] = sm[6];\n        tm[7] = sm[7];\n        tm[8] = sm[8];\n        tm[9] = sm[9];\n        tm[10] = sm[10];\n        tm[11] = sm[11];\n        tm[12] = sm[12];\n        tm[13] = sm[13];\n        tm[14] = sm[14];\n        tm[15] = sm[15];\n        return this;\n    }\n\n    /**\n     * !#en Check whether two matrix equal\n     * !#zh 当前的矩阵是否与指定的矩阵相等。\n     * @method equals\n     * @param {Mat4} other\n     * @return {Boolean}\n     */\n    equals (other) {\n        return Mat4.strictEquals(this, other);\n    }\n\n    /**\n     * !#en Check whether two matrix equal with default degree of variance.\n     * !#zh\n     * 近似判断两个矩阵是否相等。<br/>\n     * 判断 2 个矩阵是否在默认误差范围之内，如果在则返回 true，反之则返回 false。\n     * @method fuzzyEquals\n     * @param {Mat4} other\n     * @return {Boolean}\n     */\n    fuzzyEquals (other) {\n        return Mat4.equals(this, other);\n    }\n\n    /**\n     * !#en Transform to string with matrix informations\n     * !#zh 转换为方便阅读的字符串。\n     * @method toString\n     * @return {string}\n     */\n    toString () {\n        let tm = this.m;\n        if (tm) {\n            return \"[\\n\" +\n                tm[0] + \", \" + tm[1] + \", \" + tm[2] + \", \" + tm[3] + \",\\n\" +\n                tm[4] + \", \" + tm[5] + \", \" + tm[6] + \", \" + tm[7] + \",\\n\" +\n                tm[8] + \", \" + tm[9] + \", \" + tm[10] + \", \" + tm[11] + \",\\n\" +\n                tm[12] + \", \" + tm[13] + \", \" + tm[14] + \", \" + tm[15] + \"\\n\" +\n                \"]\";\n        } else {\n            return \"[\\n\" +\n                \"1, 0, 0, 0\\n\" +\n                \"0, 1, 0, 0\\n\" +\n                \"0, 0, 1, 0\\n\" +\n                \"0, 0, 0, 1\\n\" +\n                \"]\";\n        }\n    }\n\n    /**\n     * Set the matrix to the identity matrix\n     * @method identity\n     * @returns {Mat4} self\n     * @chainable\n     */\n    identity (): this {\n        return Mat4.identity(this);\n    }\n\n    /**\n     * Transpose the values of a mat4\n     * @method transpose\n     * @param {Mat4} [out] the receiving matrix, you can pass the same matrix to save result to itself, if not provided, a new matrix will be created.\n     * @returns {Mat4} out\n     */\n    transpose (out) {\n        out = out || new Mat4();\n        return Mat4.transpose(out, this);\n    }\n\n    /**\n     * Inverts a mat4\n     * @method invert\n     * @param {Mat4} [out] the receiving matrix, you can pass the same matrix to save result to itself, if not provided, a new matrix will be created.\n     * @returns {Mat4} out\n     */\n    invert (out) {\n        out = out || new Mat4();\n        return Mat4.invert(out, this);\n    }\n\n    /**\n     * Calculates the adjugate of a mat4\n     * @method adjoint\n     * @param {Mat4} [out] the receiving matrix, you can pass the same matrix to save result to itself, if not provided, a new matrix will be created.\n     * @returns {Mat4} out\n     */\n    adjoint (out) {\n        out = out || new Mat4();\n        return Mat4.adjoint(out, this);\n    }\n\n    /**\n     * Calculates the determinant of a mat4\n     * @method determinant\n     * @returns {Number} determinant of a\n     */\n    determinant () {\n        return Mat4.determinant(this);\n    }\n\n    /**\n     * Adds two Mat4\n     * @method add\n     * @param {Mat4} other the second operand\n     * @param {Mat4} [out] the receiving matrix, you can pass the same matrix to save result to itself, if not provided, a new matrix will be created.\n     * @returns {Mat4} out\n     */\n    add (other, out) {\n        out = out || new Mat4();\n        return Mat4.add(out, this, other);\n    }\n\n    /**\n     * Subtracts the current matrix with another one\n     * @method subtract\n     * @param {Mat4} other the second operand\n     * @returns {Mat4} this\n     */\n    subtract (other): this {\n        return Mat4.subtract(this, this, other);\n    }\n\n    /**\n     * Subtracts the current matrix with another one\n     * @method multiply\n     * @param {Mat4} other the second operand\n     * @returns {Mat4} this\n     */\n    multiply (other): this {\n        return Mat4.multiply(this, this, other);\n    }\n\n    /**\n     * Multiply each element of the matrix by a scalar.\n     * @method multiplyScalar\n     * @param {Number} number amount to scale the matrix's elements by\n     * @returns {Mat4} this\n     */\n    multiplyScalar (number): this {\n        return Mat4.multiplyScalar(this, this, number);\n    }\n\n    /**\n     * Translate a mat4 by the given vector\n     * @method translate\n     * @param {Vec3} v vector to translate by\n     * @param {Mat4} [out] the receiving matrix, you can pass the same matrix to save result to itself, if not provided, a new matrix will be created\n     * @returns {Mat4} out\n     */\n    translate (v, out) {\n        out = out || new Mat4();\n        return Mat4.translate(out, this, v);\n    }\n\n    /**\n     * Scales the mat4 by the dimensions in the given vec3\n     * @method scale\n     * @param {Vec3} v vector to scale by\n     * @param {Mat4} [out] the receiving matrix, you can pass the same matrix to save result to itself, if not provided, a new matrix will be created\n     * @returns {Mat4} out\n     */\n    scale (v, out) {\n        out = out || new Mat4();\n        return Mat4.scale(out, this, v);\n    }\n\n    /**\n     * Rotates a mat4 by the given angle around the given axis\n     * @method rotate\n     * @param {Number} rad the angle to rotate the matrix by\n     * @param {Vec3} axis the axis to rotate around\n     * @param {Mat4} [out] the receiving matrix, you can pass the same matrix to save result to itself, if not provided, a new matrix will be created\n     * @returns {Mat4} out\n     */\n    rotate (rad, axis, out) {\n        out = out || new Mat4();\n        return Mat4.rotate(out, this, rad, axis);\n    }\n\n    /**\n     * Returns the translation vector component of a transformation matrix.\n     * @method getTranslation\n     * @param  {Vec3} out Vector to receive translation component, if not provided, a new vec3 will be created\n     * @return {Vec3} out\n     */\n    getTranslation (out) {\n        out = out || new Vec3();\n        return Mat4.getTranslation(out, this);\n    }\n\n    /**\n     * Returns the scale factor component of a transformation matrix\n     * @method getScale\n     * @param  {Vec3} out Vector to receive scale component, if not provided, a new vec3 will be created\n     * @return {Vec3} out\n     */\n    getScale (out) {\n        out = out || new Vec3();\n        return Mat4.getScaling(out, this);\n    }\n\n    /**\n     * Returns the rotation factor component of a transformation matrix\n     * @method getRotation\n     * @param  {Quat} out Vector to receive rotation component, if not provided, a new quaternion object will be created\n     * @return {Quat} out\n     */\n    getRotation (out) {\n        out = out || new Quat();\n        return Mat4.getRotation(out, this);\n    }\n\n    /**\n     * Restore the matrix values from a quaternion rotation, vector translation and vector scale\n     * @method fromRTS\n     * @param {Quat} q Rotation quaternion\n     * @param {Vec3} v Translation vector\n     * @param {Vec3} s Scaling vector\n     * @returns {Mat4} the current mat4 object\n     * @chainable\n     */\n    fromRTS (q, v, s): this {\n        return Mat4.fromRTS(this, q, v, s);\n    }\n\n    /**\n     * Restore the matrix values from a quaternion rotation\n     * @method fromQuat\n     * @param {Quat} q Rotation quaternion\n     * @returns {Mat4} the current mat4 object\n     * @chainable\n     */\n    fromQuat (quat): this {\n        return Mat4.fromQuat(this, quat);\n    }\n}\n\nconst v3_1: Vec3 = new Vec3();\nconst m3_1: Mat3 = new Mat3();\n\nCCClass.fastDefine('cc.Mat4', Mat4, {\n    m00: 1, m01: 0, m02: 0, m03: 0,\n    m04: 0, m05: 1, m06: 0, m07: 0,\n    m08: 0, m09: 0, m10: 1, m11: 0,\n    m12: 0, m13: 0, m14: 0, m15: 1\n});\n\nfor (let i = 0; i < 16; i++) {\n    Object.defineProperty(Mat4.prototype, 'm' + i, {\n        get () {\n            return this.m[i];\n        },\n        set (value) {\n            this.m[i] = value;\n        },\n    });\n}\n\n/**\n * @module cc\n */\n\n/**\n * !#en The convenience method to create a new {{#crossLink \"Mat4\"}}cc.Mat4{{/crossLink}}.\n * !#zh 通过该简便的函数进行创建 {{#crossLink \"Mat4\"}}cc.Mat4{{/crossLink}} 对象。\n * @method mat4\n * @param {Number} [m00] Component in column 0, row 0 position (index 0)\n * @param {Number} [m01] Component in column 0, row 1 position (index 1)\n * @param {Number} [m02] Component in column 0, row 2 position (index 2)\n * @param {Number} [m03] Component in column 0, row 3 position (index 3)\n * @param {Number} [m10] Component in column 1, row 0 position (index 4)\n * @param {Number} [m11] Component in column 1, row 1 position (index 5)\n * @param {Number} [m12] Component in column 1, row 2 position (index 6)\n * @param {Number} [m13] Component in column 1, row 3 position (index 7)\n * @param {Number} [m20] Component in column 2, row 0 position (index 8)\n * @param {Number} [m21] Component in column 2, row 1 position (index 9)\n * @param {Number} [m22] Component in column 2, row 2 position (index 10)\n * @param {Number} [m23] Component in column 2, row 3 position (index 11)\n * @param {Number} [m30] Component in column 3, row 0 position (index 12)\n * @param {Number} [m31] Component in column 3, row 1 position (index 13)\n * @param {Number} [m32] Component in column 3, row 2 position (index 14)\n * @param {Number} [m33] Component in column 3, row 3 position (index 15)\n * @return {Mat4}\n */\ncc.mat4 = function (m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n    let mat = new Mat4(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\n    if (m00 === undefined) {\n        Mat4.identity(mat);\n    }\n    return mat;\n};\n\ncc.Mat4 = Mat4;\n","/****************************************************************************\n Copyright (c) 2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport ValueType from './value-type';\nimport CCClass from '../platform/CCClass';\nimport Vec3 from './vec3';\nimport Mat3 from './mat3';\nimport { EPSILON, toDegree } from './utils';\n\nlet _x: number = 0.0;\nlet _y: number = 0.0;\nlet _z: number = 0.0;\nlet _w: number = 0.0;\n\n/**\n * !#en Representation of 2D vectors and points.\n * !#zh 表示 2D 向量和坐标\n *\n * @class Quat\n * @extends ValueType\n */\n\n/**\n * !#en\n * Constructor\n * see {{#crossLink \"cc/quat:method\"}}cc.quat{{/crossLink}}\n * !#zh\n * 构造函数，可查看 {{#crossLink \"cc/quat:method\"}}cc.quat{{/crossLink}}\n * @method constructor\n * @param {number} [x=0]\n * @param {number} [y=0]\n * @param {number} [z=0]\n * @param {number} [w=1]\n */\nexport default class Quat extends ValueType {\n    static mul = Quat.multiply;\n    static scale = Quat.multiplyScalar;\n    static mag = Quat.len;\n\n    /**\n     * !#en Calculate the multiply result between this quaternion and another one\n     * !#zh 计算四元数乘积的结果\n     * @method mul\n     * @param {Quat} other\n     * @param {Quat} [out]\n     * @returns {Quat} out\n     */\n    mul (other: Quat, out?: Quat): Quat {\n        return Quat.multiply(out || new Quat(), this, other);\n    }\n\n    static IDENTITY = Object.freeze(new Quat());\n\n    /**\n     * !#zh 获得指定四元数的拷贝\n     * !#en Obtaining copy specified quaternion\n     * @method clone\n     * @typescript\n     * clone<Out extends IQuatLike> (a: Out)\n     * @static\n     */\n    static clone<Out extends IQuatLike> (a: Out) {\n        return new Quat(a.x, a.y, a.z, a.w);\n    }\n\n    /**\n     * !#zh 复制目标四元数\n     * !#en Copy quaternion target\n     * @method copy\n     * @typescript\n     * copy<Out extends IQuatLike, QuatLike extends IQuatLike> (out: Out, a: QuatLike)\n     * @static\n     */\n    static copy<Out extends IQuatLike, QuatLike extends IQuatLike> (out: Out, a: QuatLike) {\n        out.x = a.x;\n        out.y = a.y;\n        out.z = a.z;\n        out.w = a.w;\n        return out;\n    }\n\n    /**\n     * !#zh 设置四元数值\n     * !#en Provided Quaternion Value\n     * @method set\n     * @typescript\n     * set<Out extends IQuatLike> (out: Out, x: number, y: number, z: number, w: number)\n     * @static\n     */\n    static set<Out extends IQuatLike> (out: Out, x: number, y: number, z: number, w: number) {\n        out.x = x;\n        out.y = y;\n        out.z = z;\n        out.w = w;\n        return out;\n    }\n\n    /**\n     * !#zh 将目标赋值为单位四元数\n     * !#en The target of an assignment as a unit quaternion\n     * @method identity\n     * @typescript\n     * identity<Out extends IQuatLike> (out: Out)\n     * @static\n     */\n    static identity<Out extends IQuatLike> (out: Out) {\n        out.x = 0;\n        out.y = 0;\n        out.z = 0;\n        out.w = 1;\n        return out;\n    }\n\n    /**\n     * !#zh 设置四元数为两向量间的最短路径旋转，默认两向量都已归一化\n     * !#en Set quaternion rotation is the shortest path between two vectors, the default two vectors are normalized\n     * @method rotationTo\n     * @typescript\n     * rotationTo<Out extends IQuatLike, VecLike extends IVec3Like> (out: Out, a: VecLike, b: VecLike)\n     * @static\n     */\n    static rotationTo<Out extends IQuatLike, VecLike extends IVec3Like> (out: Out, a: VecLike, b: VecLike) {\n        const dot = Vec3.dot(a, b);\n        if (dot < -0.999999) {\n            Vec3.cross(v3_1, Vec3.RIGHT, a);\n            if (v3_1.mag() < 0.000001) {\n                Vec3.cross(v3_1, Vec3.UP, a);\n            }\n            Vec3.normalize(v3_1, v3_1);\n            Quat.fromAxisAngle(out, v3_1, Math.PI);\n            return out;\n        } else if (dot > 0.999999) {\n            out.x = 0;\n            out.y = 0;\n            out.z = 0;\n            out.w = 1;\n            return out;\n        } else {\n            Vec3.cross(v3_1, a, b);\n            out.x = v3_1.x;\n            out.y = v3_1.y;\n            out.z = v3_1.z;\n            out.w = 1 + dot;\n            return Quat.normalize(out, out);\n        }\n    }\n\n    /**\n     * !#zh 获取四元数的旋转轴和旋转弧度\n     * !#en Get the rotary shaft and the arc of rotation quaternion\n     * @method getAxisAngle\n     * @param {Vec3} outAxis - 旋转轴输出\n     * @param {Quat} q - 源四元数\n     * @return {Number} - 旋转弧度\n     * @typescript\n     * getAxisAngle<Out extends IQuatLike, VecLike extends IVec3Like> (outAxis: VecLike, q: Out)\n     * @static\n     */\n    static getAxisAngle<Out extends IQuatLike, VecLike extends IVec3Like> (outAxis: VecLike, q: Out) {\n        const rad = Math.acos(q.w) * 2.0;\n        const s = Math.sin(rad / 2.0);\n        if (s !== 0.0) {\n            outAxis.x = q.x / s;\n            outAxis.y = q.y / s;\n            outAxis.z = q.z / s;\n        } else {\n            // If s is zero, return any axis (no rotation - axis does not matter)\n            outAxis.x = 1;\n            outAxis.y = 0;\n            outAxis.z = 0;\n        }\n        return rad;\n    }\n\n    /**\n     * !#zh 四元数乘法\n     * !#en Quaternion multiplication\n     * @method multiply\n     * @typescript\n     * multiply<Out extends IQuatLike, QuatLike_1 extends IQuatLike, QuatLike_2 extends IQuatLike> (out: Out, a: QuatLike_1, b: QuatLike_2)\n     * @static\n     */\n    static multiply<Out extends IQuatLike, QuatLike_1 extends IQuatLike, QuatLike_2 extends IQuatLike> (out: Out, a: QuatLike_1, b: QuatLike_2) {\n        _x = a.x * b.w + a.w * b.x + a.y * b.z - a.z * b.y;\n        _y = a.y * b.w + a.w * b.y + a.z * b.x - a.x * b.z;\n        _z = a.z * b.w + a.w * b.z + a.x * b.y - a.y * b.x;\n        _w = a.w * b.w - a.x * b.x - a.y * b.y - a.z * b.z;\n        out.x = _x;\n        out.y = _y;\n        out.z = _z;\n        out.w = _w;\n        return out;\n    }\n\n    /**\n     * !#zh 四元数标量乘法\n     * !#en Quaternion scalar multiplication\n     * @method multiplyScalar\n     * @typescript\n     * multiplyScalar<Out extends IQuatLike> (out: Out, a: Out, b: number)\n     * @static\n     */\n    static multiplyScalar<Out extends IQuatLike> (out: Out, a: Out, b: number) {\n        out.x = a.x * b;\n        out.y = a.y * b;\n        out.z = a.z * b;\n        out.w = a.w * b;\n        return out;\n    }\n\n    /**\n     * !#zh 四元数乘加：A + B * scale\n     * !#en Quaternion multiplication and addition: A + B * scale\n     * @method scaleAndAdd\n     * @typescript\n     * scaleAndAdd<Out extends IQuatLike> (out: Out, a: Out, b: Out, scale: number)\n     * @static\n     */\n    static scaleAndAdd<Out extends IQuatLike> (out: Out, a: Out, b: Out, scale: number) {\n        out.x = a.x + b.x * scale;\n        out.y = a.y + b.y * scale;\n        out.z = a.z + b.z * scale;\n        out.w = a.w + b.w * scale;\n        return out;\n    }\n\n    /**\n     * !#zh 绕 X 轴旋转指定四元数\n     * !#en About the X axis specified quaternion\n     * @method rotateX\n     * @typescript\n     * rotateX<Out extends IQuatLike> (out: Out, a: Out, rad: number)\n     * @param rad 旋转弧度\n     * @static\n     */\n    static rotateX<Out extends IQuatLike> (out: Out, a: Out, rad: number) {\n        rad *= 0.5;\n\n        const bx = Math.sin(rad);\n        const bw = Math.cos(rad);\n\n        out.x = a.x * bw + a.w * bx;\n        out.y = a.y * bw + a.z * bx;\n        out.z = a.z * bw - a.y * bx;\n        out.w = a.w * bw - a.x * bx;\n        return out;\n    }\n\n    /**\n     * !#zh 绕 Y 轴旋转指定四元数\n     * !#en Rotation about the Y axis designated quaternion\n     * @method rotateY\n     * @typescript\n     * rotateY<Out extends IQuatLike> (out: Out, a: Out, rad: number)\n     * @param rad 旋转弧度\n     * @static\n     */\n    static rotateY<Out extends IQuatLike> (out: Out, a: Out, rad: number) {\n        rad *= 0.5;\n\n        const by = Math.sin(rad);\n        const bw = Math.cos(rad);\n\n        out.x = a.x * bw - a.z * by;\n        out.y = a.y * bw + a.w * by;\n        out.z = a.z * bw + a.x * by;\n        out.w = a.w * bw - a.y * by;\n        return out;\n    }\n\n    /**\n     * !#zh 绕 Z 轴旋转指定四元数\n     * !#en Around the Z axis specified quaternion\n     * @method rotateZ\n     * @typescript\n     * rotateZ<Out extends IQuatLike> (out: Out, a: Out, rad: number)\n     * @param rad 旋转弧度\n     * @static\n     */\n    static rotateZ<Out extends IQuatLike> (out: Out, a: Out, rad: number) {\n        rad *= 0.5;\n\n        const bz = Math.sin(rad);\n        const bw = Math.cos(rad);\n\n        out.x = a.x * bw + a.y * bz;\n        out.y = a.y * bw - a.x * bz;\n        out.z = a.z * bw + a.w * bz;\n        out.w = a.w * bw - a.z * bz;\n        return out;\n    }\n\n    /**\n     * !#zh 绕世界空间下指定轴旋转四元数\n     * !#en Space around the world at a given axis of rotation quaternion\n     * @method rotateAround\n     * @typescript\n     * rotateAround<Out extends IQuatLike, VecLike extends IVec3Like> (out: Out, rot: Out, axis: VecLike, rad: number)\n     * @param axis 旋转轴，默认已归一化\n     * @param rad 旋转弧度\n     * @static\n     */\n    static rotateAround<Out extends IQuatLike, VecLike extends IVec3Like> (out: Out, rot: Out, axis: VecLike, rad: number) {\n        // get inv-axis (local to rot)\n        Quat.invert(qt_1, rot);\n        Vec3.transformQuat(v3_1, axis, qt_1);\n        // rotate by inv-axis\n        Quat.fromAxisAngle(qt_1, v3_1, rad);\n        Quat.multiply(out, rot, qt_1);\n        return out;\n    }\n\n    /**\n     * !#zh 绕本地空间下指定轴旋转四元数\n     * !#en Local space around the specified axis rotation quaternion\n     * @method rotateAroundLocal\n     * @typescript\n     * rotateAroundLocal<Out extends IQuatLike, VecLike extends IVec3Like> (out: Out, rot: Out, axis: VecLike, rad: number)\n     * @param axis 旋转轴\n     * @param rad 旋转弧度\n     * @static\n     */\n    static rotateAroundLocal<Out extends IQuatLike, VecLike extends IVec3Like> (out: Out, rot: Out, axis: VecLike, rad: number) {\n        Quat.fromAxisAngle(qt_1, axis, rad);\n        Quat.multiply(out, rot, qt_1);\n        return out;\n    }\n\n    /**\n     * !#zh 根据 xyz 分量计算 w 分量，默认已归一化\n     * !#en The component w xyz components calculated, normalized by default\n     * @method calculateW\n     * @typescript\n     * calculateW<Out extends IQuatLike> (out: Out, a: Out)\n     * @static\n     */\n    static calculateW<Out extends IQuatLike> (out: Out, a: Out) {\n\n        out.x = a.x;\n        out.y = a.y;\n        out.z = a.z;\n        out.w = Math.sqrt(Math.abs(1.0 - a.x * a.x - a.y * a.y - a.z * a.z));\n        return out;\n    }\n\n    /**\n     * !#zh 四元数点积（数量积）\n     * !#en Quaternion dot product (scalar product)\n     * @method dot\n     * @typescript\n     * dot<Out extends IQuatLike> (a: Out, b: Out)\n     * @static\n     */\n    static dot<Out extends IQuatLike> (a: Out, b: Out) {\n        return a.x * b.x + a.y * b.y + a.z * b.z + a.w * b.w;\n    }\n\n    /**\n     * !#zh 逐元素线性插值： A + t * (B - A)\n     * !#en Element by element linear interpolation: A + t * (B - A)\n     * @method lerp\n     * @typescript\n     * lerp<Out extends IQuatLike> (out: Out, a: Out, b: Out, t: number)\n     * @static\n     */\n    static lerp<Out extends IQuatLike> (out: Out, a: Out, b: Out, t: number) {\n        out.x = a.x + t * (b.x - a.x);\n        out.y = a.y + t * (b.y - a.y);\n        out.z = a.z + t * (b.z - a.z);\n        out.w = a.w + t * (b.w - a.w);\n        return out;\n    }\n\n    /**\n     * !#zh 四元数球面插值\n     * !#en Spherical quaternion interpolation\n     * @static\n     */\n    static slerp<Out extends IQuatLike, QuatLike_1 extends IQuatLike, QuatLike_2 extends IQuatLike>\n        (out: Out, a: QuatLike_1, b: QuatLike_2, t: number) {\n        // benchmarks:\n        //    http://jsperf.com/quaternion-slerp-implementations\n\n        let scale0 = 0;\n        let scale1 = 0;\n\n        // calc cosine\n        let cosom = a.x * b.x + a.y * b.y + a.z * b.z + a.w * b.w;\n        // adjust signs (if necessary)\n        if (cosom < 0.0) {\n            cosom = -cosom;\n            b.x = -b.x;\n            b.y = -b.y;\n            b.z = -b.z;\n            b.w = -b.w;\n        }\n        // calculate coefficients\n        if ((1.0 - cosom) > 0.000001) {\n            // standard case (slerp)\n            const omega = Math.acos(cosom);\n            const sinom = Math.sin(omega);\n            scale0 = Math.sin((1.0 - t) * omega) / sinom;\n            scale1 = Math.sin(t * omega) / sinom;\n        } else {\n            // \"from\" and \"to\" quaternions are very close\n            //  ... so we can do a linear interpolation\n            scale0 = 1.0 - t;\n            scale1 = t;\n        }\n        // calculate final values\n        out.x = scale0 * a.x + scale1 * b.x;\n        out.y = scale0 * a.y + scale1 * b.y;\n        out.z = scale0 * a.z + scale1 * b.z;\n        out.w = scale0 * a.w + scale1 * b.w;\n\n        return out;\n    }\n\n    /**\n     * !#zh 带两个控制点的四元数球面插值\n     * !#en Quaternion with two spherical interpolation control points\n     * @method sqlerp\n     * @typescript\n     * sqlerp<Out extends IQuatLike> (out: Out, a: Out, b: Out, c: Out, d: Out, t: number)\n     * @static\n     */\n    static sqlerp<Out extends IQuatLike> (out: Out, a: Out, b: Out, c: Out, d: Out, t: number) {\n        Quat.slerp(qt_1, a, d, t);\n        Quat.slerp(qt_2, b, c, t);\n        Quat.slerp(out, qt_1, qt_2, 2 * t * (1 - t));\n        return out;\n    }\n\n    /**\n     * !#zh 四元数求逆\n     * !#en Quaternion inverse\n     * @method invert\n     * @typescript\n     * invert<Out extends IQuatLike, QuatLike extends IQuatLike> (out: Out, a: QuatLike)\n     * @static\n     */\n    static invert<Out extends IQuatLike, QuatLike extends IQuatLike> (out: Out, a: QuatLike) {\n        const dot = a.x * a.x + a.y * a.y + a.z * a.z + a.w * a.w;\n        const invDot = dot ? 1.0 / dot : 0;\n\n        // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n        out.x = -a.x * invDot;\n        out.y = -a.y * invDot;\n        out.z = -a.z * invDot;\n        out.w = a.w * invDot;\n        return out;\n    }\n\n    /**\n     * !#zh 求共轭四元数，对单位四元数与求逆等价，但更高效\n     * !#en Conjugating a quaternion, and the unit quaternion equivalent to inversion, but more efficient\n     * @method conjugate\n     * @typescript\n     * conjugate<Out extends IQuatLike> (out: Out, a: Out)\n     * @static\n     */\n    static conjugate<Out extends IQuatLike> (out: Out, a: Out) {\n        out.x = -a.x;\n        out.y = -a.y;\n        out.z = -a.z;\n        out.w = a.w;\n        return out;\n    }\n\n    /**\n     * !#zh 求四元数长度\n     * !#en Seek length quaternion\n     * @method len\n     * @typescript\n     * len<Out extends IQuatLike> (a: Out)\n     * @static\n     */\n    static len<Out extends IQuatLike> (a: Out) {\n        return Math.sqrt(a.x * a.x + a.y * a.y + a.z * a.z + a.w * a.w);\n    }\n\n    /**\n     * !#zh 求四元数长度平方\n     * !#en Seeking quaternion square of the length\n     * @method lengthSqr\n     * @typescript\n     * lengthSqr<Out extends IQuatLike> (a: Out)\n     * @static\n     */\n    static lengthSqr<Out extends IQuatLike> (a: Out) {\n        return a.x * a.x + a.y * a.y + a.z * a.z + a.w * a.w;\n    }\n\n    /**\n     * !#zh 归一化四元数\n     * !#en Normalized quaternions\n     * @method normalize\n     * @typescript\n     * normalize<Out extends IQuatLike> (out: Out, a: Out)\n     * @static\n     */\n    static normalize<Out extends IQuatLike> (out: Out, a: Out) {\n        let len = a.x * a.x + a.y * a.y + a.z * a.z + a.w * a.w;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n            out.x = a.x * len;\n            out.y = a.y * len;\n            out.z = a.z * len;\n            out.w = a.w * len;\n        }\n        return out;\n    }\n\n    /**\n     * !#zh 根据本地坐标轴朝向计算四元数，默认三向量都已归一化且相互垂直\n     * !#en Calculated according to the local orientation quaternion coordinate axis, the default three vectors are normalized and mutually perpendicular\n     * @method fromAxes\n     * @typescript\n     * fromAxes<Out extends IQuatLike, VecLike extends IVec3Like> (out: Out, xAxis: VecLike, yAxis: VecLike, zAxis: VecLike)\n     * @static\n     */\n    static fromAxes<Out extends IQuatLike, VecLike extends IVec3Like> (out: Out, xAxis: VecLike, yAxis: VecLike, zAxis: VecLike) {\n        Mat3.set(m3_1,\n            xAxis.x, xAxis.y, xAxis.z,\n            yAxis.x, yAxis.y, yAxis.z,\n            zAxis.x, zAxis.y, zAxis.z,\n        );\n        return Quat.normalize(out, Quat.fromMat3(out, m3_1));\n    }\n\n    /**\n     * !#zh 根据视口的前方向和上方向计算四元数\n     * !#en The forward direction and the direction of the viewport computing quaternion\n     * @method fromViewUp\n     * @typescript\n     * fromViewUp<Out extends IQuatLike> (out: Out, view: Vec3, up?: Vec3)\n     * @param view 视口面向的前方向，必须归一化\n     * @param up 视口的上方向，必须归一化，默认为 (0, 1, 0)\n     * @static\n     */\n    static fromViewUp<Out extends IQuatLike> (out: Out, view: Vec3, up?: Vec3) {\n        Mat3.fromViewUp(m3_1, view, up);\n        return Quat.normalize(out, Quat.fromMat3(out, m3_1));\n    }\n\n    /**\n     * !#zh 根据旋转轴和旋转弧度计算四元数\n     * !#en The quaternion calculated and the arc of rotation of the rotary shaft\n     * @method fromAxisAngle\n     * @typescript\n     * fromAxisAngle<Out extends IQuatLike, VecLike extends IVec3Like> (out: Out, axis: VecLike, rad: number)\n     * @static\n     */\n    static fromAxisAngle<Out extends IQuatLike, VecLike extends IVec3Like> (out: Out, axis: VecLike, rad: number) {\n        rad = rad * 0.5;\n        const s = Math.sin(rad);\n        out.x = s * axis.x;\n        out.y = s * axis.y;\n        out.z = s * axis.z;\n        out.w = Math.cos(rad);\n        return out;\n    }\n\n    /**\n     * Set a quaternion from the given euler angle 0, 0, z.\n     *\n     * @param {quat} out - Quaternion to store result.\n     * @param {number} z - Angle to rotate around Z axis in degrees.\n     * @function\n     */\n    static fromAngleZ (out: Quat, z: number): Quat {\n        z *= halfToRad;\n        out.x = out.y = 0;\n        out.z = Math.sin(z);\n        out.w = Math.cos(z);\n        return out;\n    }\n\n    /**\n     * !#zh 根据三维矩阵信息计算四元数，默认输入矩阵不含有缩放信息\n     * !#en Calculating the three-dimensional quaternion matrix information, default zoom information input matrix does not contain\n     * @method fromMat3\n     * @typescript\n     * fromMat3<Out extends IQuatLike> (out: Out, mat: Mat3)\n     * @static\n     */\n    static fromMat3<Out extends IQuatLike> (out: Out, mat: Mat3) {\n        let m = mat.m;\n        let m00 = m[0], m10 = m[1], m20 = m[2],\n            m01 = m[3], m11 = m[4], m21 = m[5],\n            m02 = m[6], m12 = m[7], m22 = m[8];\n\n        const trace = m00 + m11 + m22;\n\n        if (trace > 0) {\n            const s = 0.5 / Math.sqrt(trace + 1.0);\n\n            out.w = 0.25 / s;\n            out.x = (m21 - m12) * s;\n            out.y = (m02 - m20) * s;\n            out.z = (m10 - m01) * s;\n\n        } else if ((m00 > m11) && (m00 > m22)) {\n            const s = 2.0 * Math.sqrt(1.0 + m00 - m11 - m22);\n\n            out.w = (m21 - m12) / s;\n            out.x = 0.25 * s;\n            out.y = (m01 + m10) / s;\n            out.z = (m02 + m20) / s;\n\n        } else if (m11 > m22) {\n            const s = 2.0 * Math.sqrt(1.0 + m11 - m00 - m22);\n\n            out.w = (m02 - m20) / s;\n            out.x = (m01 + m10) / s;\n            out.y = 0.25 * s;\n            out.z = (m12 + m21) / s;\n\n        } else {\n            const s = 2.0 * Math.sqrt(1.0 + m22 - m00 - m11);\n\n            out.w = (m10 - m01) / s;\n            out.x = (m02 + m20) / s;\n            out.y = (m12 + m21) / s;\n            out.z = 0.25 * s;\n        }\n\n        return out;\n    }\n\n    /**\n     * !#zh 根据欧拉角信息计算四元数，旋转顺序为 YZX\n     * !#en The quaternion calculated Euler angle information, rotation order YZX\n     * @method fromEuler\n     * @typescript\n     * fromEuler<Out extends IQuatLike> (out: Out, x: number, y: number, z: number)\n     * @static\n     */\n    static fromEuler<Out extends IQuatLike> (out: Out, x: number, y: number, z: number) {\n        x *= halfToRad;\n        y *= halfToRad;\n        z *= halfToRad;\n\n        const sx = Math.sin(x);\n        const cx = Math.cos(x);\n        const sy = Math.sin(y);\n        const cy = Math.cos(y);\n        const sz = Math.sin(z);\n        const cz = Math.cos(z);\n\n        out.x = sx * cy * cz + cx * sy * sz;\n        out.y = cx * sy * cz + sx * cy * sz;\n        out.z = cx * cy * sz - sx * sy * cz;\n        out.w = cx * cy * cz - sx * sy * sz;\n\n        return out;\n    }\n\n    /**\n     * !#zh 返回定义此四元数的坐标系 X 轴向量\n     * !#en This returns the result of the quaternion coordinate system X-axis vector\n     * @method toAxisX\n     * @typescript\n     * toAxisX<Out extends IQuatLike, VecLike extends IVec3Like> (out: VecLike, q: Out)\n     * @static\n     */\n    static toAxisX<Out extends IQuatLike, VecLike extends IVec3Like> (out: VecLike, q: Out) {\n        const fy = 2.0 * q.y;\n        const fz = 2.0 * q.z;\n        out.x = 1.0 - fy * q.y - fz * q.z;\n        out.y = fy * q.x + fz * q.w;\n        out.z = fz * q.x + fy * q.w;\n\n        return out;\n    }\n\n    /**\n     * !#zh 返回定义此四元数的坐标系 Y 轴向量\n     * !#en This returns the result of the quaternion coordinate system Y axis vector\n     * @method toAxisY\n     * @typescript\n     * toAxisY<Out extends IQuatLike, VecLike extends IVec3Like> (out: VecLike, q: Out)\n     * @static\n     */\n    static toAxisY<Out extends IQuatLike, VecLike extends IVec3Like> (out: VecLike, q: Out) {\n        const fx = 2.0 * q.x;\n        const fy = 2.0 * q.y;\n        const fz = 2.0 * q.z;\n        out.x = fy * q.x - fz * q.w;\n        out.y = 1.0 - fx * q.x - fz * q.z;\n        out.z = fz * q.y + fx * q.w;\n\n        return out;\n    }\n\n    /**\n     * !#zh 返回定义此四元数的坐标系 Z 轴向量\n     * !#en This returns the result of the quaternion coordinate system the Z-axis vector\n     * @method toAxisZ\n     * @typescript\n     * toAxisZ<Out extends IQuatLike, VecLike extends IVec3Like> (out: VecLike, q: Out)\n     * @static\n     */\n    static toAxisZ<Out extends IQuatLike, VecLike extends IVec3Like> (out: VecLike, q: Out) {\n        const fx = 2.0 * q.x;\n        const fy = 2.0 * q.y;\n        const fz = 2.0 * q.z;\n        out.x = fz * q.x - fy * q.w;\n        out.y = fz * q.y - fx * q.w;\n        out.z = 1.0 - fx * q.x - fy * q.y;\n\n        return out;\n    }\n\n    /**\n     * !#zh 根据四元数计算欧拉角，返回角度 x, y 在 [-180, 180] 区间内, z 默认在 [-90, 90] 区间内，旋转顺序为 YZX\n     * !#en The quaternion calculated Euler angles, return angle x, y in the [-180, 180] interval, z default the range [-90, 90] interval, the rotation order YZX\n     * @method toEuler\n     * @typescript\n     * toEuler<Out extends IVec3Like> (out: Out, q: IQuatLike, outerZ?: boolean)\n     * @param outerZ z 取值范围区间改为 [-180, -90] U [90, 180]\n     * @static\n     */\n    static toEuler<Out extends IVec3Like> (out: Out, q: IQuatLike, outerZ?: boolean) {\n        const { x, y, z, w } = q;\n        let bank = 0;\n        let heading = 0;\n        let attitude = 0;\n        const test = x * y + z * w;\n        if (test > 0.499999) {\n            bank = 0; // default to zero\n            heading = toDegree(2 * Math.atan2(x, w));\n            attitude = 90;\n        } else if (test < -0.499999) {\n            bank = 0; // default to zero\n            heading = -toDegree(2 * Math.atan2(x, w));\n            attitude = -90;\n        } else {\n            const sqx = x * x;\n            const sqy = y * y;\n            const sqz = z * z;\n            bank = toDegree(Math.atan2(2 * x * w - 2 * y * z, 1 - 2 * sqx - 2 * sqz));\n            heading = toDegree(Math.atan2(2 * y * w - 2 * x * z, 1 - 2 * sqy - 2 * sqz));\n            attitude = toDegree(Math.asin(2 * test));\n            if (outerZ) {\n                bank = -180 * Math.sign(bank + 1e-6) + bank;\n                heading = -180 * Math.sign(heading + 1e-6) + heading;\n                attitude = 180 * Math.sign(attitude + 1e-6) - attitude;\n            }\n        }\n        out.x = bank; out.y = heading; out.z = attitude;\n        return out;\n    }\n\n    /**\n     * !#zh 四元数等价判断\n     * !#en Analyzing quaternion equivalent\n     * @method strictEquals\n     * @typescript\n     * strictEquals<Out extends IQuatLike> (a: Out, b: Out)\n     * @static\n     */\n    static strictEquals<Out extends IQuatLike> (a: Out, b: Out) {\n        return a.x === b.x && a.y === b.y && a.z === b.z && a.w === b.w;\n    }\n\n    /**\n     * !#zh 排除浮点数误差的四元数近似等价判断\n     * !#en Negative floating point error quaternion approximately equivalent Analyzing\n     * @method equals\n     * @typescript\n     * equals<Out extends IQuatLike> (a: Out, b: Out, epsilon = EPSILON)\n     * @static\n     */\n    static equals<Out extends IQuatLike> (a: Out, b: Out, epsilon = EPSILON) {\n        return (Math.abs(a.x - b.x) <= epsilon * Math.max(1.0, Math.abs(a.x), Math.abs(b.x)) &&\n            Math.abs(a.y - b.y) <= epsilon * Math.max(1.0, Math.abs(a.y), Math.abs(b.y)) &&\n            Math.abs(a.z - b.z) <= epsilon * Math.max(1.0, Math.abs(a.z), Math.abs(b.z)) &&\n            Math.abs(a.w - b.w) <= epsilon * Math.max(1.0, Math.abs(a.w), Math.abs(b.w)));\n    }\n\n\n    /**\n     * !#zh 四元数转数组\n     * !#en Quaternion rotation array\n     * @method toArray\n     * @typescript\n     * toArray <Out extends IWritableArrayLike<number>> (out: Out, q: IQuatLike, ofs = 0)\n     * @param ofs 数组内的起始偏移量\n     * @static\n     */\n    static toArray <Out extends IWritableArrayLike<number>> (out: Out, q: IQuatLike, ofs = 0) {\n        out[ofs + 0] = q.x;\n        out[ofs + 1] = q.y;\n        out[ofs + 2] = q.z;\n        out[ofs + 3] = q.w;\n        return out;\n    }\n\n    /**\n     * !#zh 数组转四元数\n     * !#en Array to a quaternion\n     * @method fromArray\n     * @typescript\n     * fromArray <Out extends IQuatLike> (out: Out, arr: IWritableArrayLike<number>, ofs = 0)\n     * @param ofs 数组起始偏移量\n     * @static\n     */\n    static fromArray <Out extends IQuatLike> (out: Out, arr: IWritableArrayLike<number>, ofs = 0) {\n        out.x = arr[ofs + 0];\n        out.y = arr[ofs + 1];\n        out.z = arr[ofs + 2];\n        out.w = arr[ofs + 3];\n        return out;\n    }\n\n\n    /**\n     * @property {Number} x\n     */\n    x: number;\n    /**\n     * @property {Number} y\n     */\n    y: number;\n    /**\n     * @property {Number} z\n     */\n    z: number;\n    /**\n     * @property {Number} w\n     */\n    w: number;\n\n    constructor (x: Quat | number = 0, y: number = 0, z: number = 0, w: number = 1) {\n        super();\n\n        if (x && typeof x === 'object') {\n            this.z = x.z;\n            this.y = x.y;\n            this.w = x.w;\n            this.x = x.x;\n        }\n        else {\n            this.x = x as number;\n            this.y = y;\n            this.z = z;\n            this.w = w;\n        }\n    }\n\n    /**\n     * !#en clone a Quat object and return the new object\n     * !#zh 克隆一个四元数并返回\n     * @method clone\n     * @return {Quat}\n     */\n    clone (): Quat {\n        return new Quat(this.x, this.y, this.z, this.w);\n    }\n\n    /**\n     * !#en Set values with another quaternion\n     * !#zh 用另一个四元数的值设置到当前对象上。\n     * @method set\n     * @param {Quat} newValue - !#en new value to set. !#zh 要设置的新值\n     * @return {Quat} returns this\n     * @chainable\n     */\n    set (newValue: Quat): this {\n        this.x = newValue.x;\n        this.y = newValue.y;\n        this.z = newValue.z;\n        this.w = newValue.w;\n        return this;\n    }\n\n    /**\n     * !#en Check whether current quaternion equals another\n     * !#zh 当前的四元数是否与指定的四元数相等。\n     * @method equals\n     * @param {Quat} other\n     * @return {Boolean}\n     */\n    equals (other: Quat): boolean {\n        return other && this.x === other.x && this.y === other.y && this.z === other.z && this.w === other.w;\n    }\n\n    /**\n     * !#en Convert quaternion to euler\n     * !#zh 转换四元数到欧拉角\n     * @method toEuler\n     * @param {Vec3} out\n     * @return {Vec3}\n     */\n    toEuler (out: Vec3): Vec3 {\n        return Quat.toEuler(out, this);\n    }\n\n    /**\n     * !#en Convert euler to quaternion\n     * !#zh 转换欧拉角到四元数\n     * @method fromEuler\n     * @param {Vec3} euler\n     * @return {Quat}\n     */\n    fromEuler (euler: Vec3): this {\n        return Quat.fromEuler(this, euler.x, euler.y, euler.z);\n    }\n\n    /**\n     * !#en Calculate the interpolation result between this quaternion and another one with given ratio\n     * !#zh 计算四元数的插值结果\n     * @member lerp\n     * @param {Quat} to\n     * @param {Number} ratio\n     * @param {Quat} [out]\n     * @returns {Quat} out\n     */\n    lerp (to: Quat, ratio: number, out?: Quat): Quat {\n        out = out || new Quat();\n        Quat.slerp(out, this, to, ratio);\n        return out;\n    }\n\n    /**\n     * !#en Calculate the multiply result between this quaternion and another one\n     * !#zh 计算四元数乘积的结果\n     * @member multiply\n     * @param {Quat} other\n     * @returns {Quat} this\n     */\n    multiply (other: Quat): this {\n        return Quat.multiply(this, this, other);\n    }\n\n    /**\n     * !#en Rotates a quaternion by the given angle (in radians) about a world space axis.\n     * !#zh 围绕世界空间轴按给定弧度旋转四元数\n     * @member rotateAround\n     * @param {Quat} rot - Quaternion to rotate\n     * @param {Vec3} axis - The axis around which to rotate in world space\n     * @param {Number} rad - Angle (in radians) to rotate\n     * @param {Quat} [out] - Quaternion to store result\n     * @returns {Quat} out\n     */\n    rotateAround (rot: Quat, axis: Vec3, rad: number, out?: Quat): Quat {\n        out = out || new Quat();\n        return Quat.rotateAround(out, rot, axis, rad);\n    }\n}\n\nconst qt_1 = new Quat();\nconst qt_2 = new Quat();\nconst v3_1 = new Vec3();\nconst m3_1 = new Mat3();\nconst halfToRad = 0.5 * Math.PI / 180.0;\n\nCCClass.fastDefine('cc.Quat', Quat, { x: 0, y: 0, z: 0, w: 1 });\n\n\n/**\n * @module cc\n */\n\n/**\n * !#en The convenience method to create a new {{#crossLink \"Quat\"}}cc.Quat{{/crossLink}}.\n * !#zh 通过该简便的函数进行创建 {{#crossLink \"Quat\"}}cc.Quat{{/crossLink}} 对象。\n * @method quat\n * @param {Number|Object} [x=0]\n * @param {Number} [y=0]\n * @param {Number} [z=0]\n * @param {Number} [w=1]\n * @return {Quat}\n */\ncc.quat = function quat (x, y, z, w) {\n    return new Quat(x, y, z, w);\n};\n\ncc.Quat = Quat;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport ValueType from './value-type';\nimport CCClass from '../platform/CCClass';\nimport Vec2 from './vec2';\nimport Mat4 from './mat4';\nimport Size from './size';\n\n/**\n * !#en A 2D rectangle defined by x, y position and width, height.\n * !#zh 通过位置和宽高定义的 2D 矩形。\n * @class Rect\n * @extends ValueType\n */\n/**\n * !#en\n * Constructor of Rect class.\n * see {{#crossLink \"cc/rect:method\"}} cc.rect {{/crossLink}} for convenience method.\n * !#zh\n * Rect类的构造函数。可以通过 {{#crossLink \"cc/rect:method\"}} cc.rect {{/crossLink}} 简便方法进行创建。\n *\n * @method constructor\n * @param {Number} [x=0]\n * @param {Number} [y=0]\n * @param {Number} [w=0]\n * @param {Number} [h=0]\n */\nexport default class Rect extends ValueType {\n\n    /**\n     * !#en Creates a rectangle from two coordinate values.\n     * !#zh 根据指定 2 个坐标创建出一个矩形区域。\n     * @static\n     * @method fromMinMax\n     * @param {Vec2} v1\n     * @param {Vec2} v2\n     * @return {Rect}\n     * @example\n     * cc.Rect.fromMinMax(cc.v2(10, 10), cc.v2(20, 20)); // Rect {x: 10, y: 10, width: 10, height: 10};\n     */\n    static fromMinMax (v1: Vec2, v2: Vec2) {\n        var min_x = Math.min(v1.x, v2.x);\n        var min_y = Math.min(v1.y, v2.y);\n        var max_x = Math.max(v1.x, v2.x);\n        var max_y = Math.max(v1.y, v2.y);\n\n        return new Rect(min_x, min_y, max_x - min_x, max_y - min_y);\n    }\n\n    /**\n     * @property {Number} x\n     */\n    x: number;\n    /**\n     * @property {Number} y\n     */\n    y: number;\n    /**\n     * @property {Number} width\n     */\n    width: number;\n    /**\n     * @property {Number} height\n     */\n    height: number;\n    constructor (x: Rect | number = 0, y: number = 0, w: number = 0, h: number = 0) {\n        super();\n        if (x && typeof x === 'object') {\n            y = x.y;\n            w = x.width;\n            h = x.height;\n            x = x.x;\n        }\n        this.x = x as number || 0;\n        this.y = y || 0;\n        this.width = w || 0;\n        this.height = h || 0;\n    }\n\n\n    /**\n     * !#en TODO\n     * !#zh 克隆一个新的 Rect。\n     * @method clone\n     * @return {Rect}\n     * @example\n     * var a = new cc.Rect(0, 0, 10, 10);\n     * a.clone();// Rect {x: 0, y: 0, width: 10, height: 10}\n     */\n    clone (): Rect {\n        return new Rect(this.x, this.y, this.width, this.height);\n    }\n\n    /**\n     * !#en TODO\n     * !#zh 是否等于指定的矩形。\n     * @method equals\n     * @param {Rect} other\n     * @return {Boolean}\n     * @example\n     * var a = new cc.Rect(0, 0, 10, 10);\n     * var b = new cc.Rect(0, 0, 10, 10);\n     * a.equals(b);// true;\n     */\n    equals (other: Rect): boolean {\n        return other &&\n            this.x === other.x &&\n            this.y === other.y &&\n            this.width === other.width &&\n            this.height === other.height;\n    };\n\n    /**\n     * !#en TODO\n     * !#zh 线性插值\n     * @method lerp\n     * @param {Rect} to\n     * @param {Number} ratio - the interpolation coefficient.\n     * @param {Rect} [out] - optional, the receiving vector.\n     * @return {Rect}\n     * @example\n     * var a = new cc.Rect(0, 0, 10, 10);\n     * var b = new cc.Rect(50, 50, 100, 100);\n     * update (dt) {\n     *    // method 1;\n     *    var c = a.lerp(b, dt * 0.1);\n     *    // method 2;\n     *    a.lerp(b, dt * 0.1, c);\n     * }\n     */\n    lerp (to: Rect, ratio: number, out?: Rect): Rect {\n        out = out || new Rect();\n        var x = this.x;\n        var y = this.y;\n        var width = this.width;\n        var height = this.height;\n        out.x = x + (to.x - x) * ratio;\n        out.y = y + (to.y - y) * ratio;\n        out.width = width + (to.width - width) * ratio;\n        out.height = height + (to.height - height) * ratio;\n        return out;\n    };\n\n    set (source: Rect): Rect {\n        this.x = source.x;\n        this.y = source.y;\n        this.width = source.width;\n        this.height = source.height;\n        return this;\n    }\n\n    /**\n     * !#en Check whether the current rectangle intersects with the given one\n     * !#zh 当前矩形与指定矩形是否相交。\n     * @method intersects\n     * @param {Rect} rect\n     * @return {Boolean}\n     * @example\n     * var a = new cc.Rect(0, 0, 10, 10);\n     * var b = new cc.Rect(0, 0, 20, 20);\n     * a.intersects(b);// true\n     */\n    intersects (rect: Rect): boolean {\n        var maxax = this.x + this.width,\n            maxay = this.y + this.height,\n            maxbx = rect.x + rect.width,\n            maxby = rect.y + rect.height;\n        return !(maxax < rect.x || maxbx < this.x || maxay < rect.y || maxby < this.y);\n    }\n\n    /**\n     * !#en Returns the overlapping portion of 2 rectangles.\n     * !#zh 返回 2 个矩形重叠的部分。\n     * @method intersection\n     * @param {Rect} out Stores the result\n     * @param {Rect} rectB\n     * @return {Rect} Returns the out parameter\n     * @example\n     * var a = new cc.Rect(0, 10, 20, 20);\n     * var b = new cc.Rect(0, 10, 10, 10);\n     * var intersection = new cc.Rect();\n     * a.intersection(intersection, b); // intersection {x: 0, y: 10, width: 10, height: 10};\n     */\n    intersection (out: Rect, rectB: Rect): Rect {\n        var axMin = this.x, ayMin = this.y, axMax = this.x + this.width, ayMax = this.y + this.height;\n        var bxMin = rectB.x, byMin = rectB.y, bxMax = rectB.x + rectB.width, byMax = rectB.y + rectB.height;\n        out.x = Math.max(axMin, bxMin);\n        out.y = Math.max(ayMin, byMin);\n        out.width = Math.min(axMax, bxMax) - out.x;\n        out.height = Math.min(ayMax, byMax) - out.y;\n        return out;\n    }\n\n    /**\n     * !#en Check whether the current rect contains the given point\n     * !#zh 当前矩形是否包含指定坐标点。\n     * Returns true if the point inside this rectangle.\n     * @method contains\n     * @param {Vec2} point\n     * @return {Boolean}\n     * @example\n     * var a = new cc.Rect(0, 0, 10, 10);\n     * var b = new cc.Vec2(0, 5);\n     * a.contains(b);// true\n     */\n    contains (point: Vec2): boolean {\n        return (this.x <= point.x &&\n            this.x + this.width >= point.x &&\n            this.y <= point.y &&\n            this.y + this.height >= point.y);\n    }\n\n    /**\n     * !#en Returns true if the other rect totally inside this rectangle.\n     * !#zh 当前矩形是否包含指定矩形。\n     * @method containsRect\n     * @param {Rect} rect\n     * @return {Boolean}\n     * @example\n     * var a = new cc.Rect(0, 0, 20, 20);\n     * var b = new cc.Rect(0, 0, 10, 10);\n     * a.containsRect(b);// true\n     */\n    containsRect (rect: Rect): boolean {\n        return (this.x <= rect.x &&\n            this.x + this.width >= rect.x + rect.width &&\n            this.y <= rect.y &&\n            this.y + this.height >= rect.y + rect.height);\n    }\n\n    /**\n     * !#en Returns the smallest rectangle that contains the current rect and the given rect.\n     * !#zh 返回一个包含当前矩形和指定矩形的最小矩形。\n     * @method union\n     * @param {Rect} out Stores the result\n     * @param {Rect} rectB\n     * @return {Rect} Returns the out parameter\n     * @example\n     * var a = new cc.Rect(0, 10, 20, 20);\n     * var b = new cc.Rect(0, 10, 10, 10);\n     * var union = new cc.Rect();\n     * a.union(union, b); // union {x: 0, y: 10, width: 20, height: 20};\n     */\n    union (out: Rect, rectB: Rect): Rect {\n        var ax = this.x, ay = this.y, aw = this.width, ah = this.height;\n        var bx = rectB.x, by = rectB.y, bw = rectB.width, bh = rectB.height;\n        out.x = Math.min(ax, bx);\n        out.y = Math.min(ay, by);\n        out.width = Math.max(ax + aw, bx + bw) - out.x;\n        out.height = Math.max(ay + ah, by + bh) - out.y;\n        return out;\n    }\n\n    /**\n     * !#en Apply matrix4 to the rect.\n     * !#zh 使用 mat4 对矩形进行矩阵转换。\n     * @method transformMat4\n     * @param out {Rect} The output rect\n     * @param mat {Mat4} The matrix4\n     */\n    transformMat4 (out: Rect, mat: Mat4): Rect {\n        let ol = this.x;\n        let ob = this.y;\n        let or = ol + this.width;\n        let ot = ob + this.height;\n        let matm = mat.m;\n        let lbx = matm[0] * ol + matm[4] * ob + matm[12];\n        let lby = matm[1] * ol + matm[5] * ob + matm[13];\n        let rbx = matm[0] * or + matm[4] * ob + matm[12];\n        let rby = matm[1] * or + matm[5] * ob + matm[13];\n        let ltx = matm[0] * ol + matm[4] * ot + matm[12];\n        let lty = matm[1] * ol + matm[5] * ot + matm[13];\n        let rtx = matm[0] * or + matm[4] * ot + matm[12];\n        let rty = matm[1] * or + matm[5] * ot + matm[13];\n\n        let minX = Math.min(lbx, rbx, ltx, rtx);\n        let maxX = Math.max(lbx, rbx, ltx, rtx);\n        let minY = Math.min(lby, rby, lty, rty);\n        let maxY = Math.max(lby, rby, lty, rty);\n\n        out.x = minX;\n        out.y = minY;\n        out.width = maxX - minX;\n        out.height = maxY - minY;\n        return out;\n    }\n\n    /**\n     * !#en Output rect informations to string\n     * !#zh 转换为方便阅读的字符串\n     * @method toString\n     * @return {String}\n     * @example\n     * var a = new cc.Rect(0, 0, 10, 10);\n     * a.toString();// \"(0.00, 0.00, 10.00, 10.00)\";\n     */\n    toString (): string {\n        return '(' + this.x.toFixed(2) + ', ' + this.y.toFixed(2) + ', ' + this.width.toFixed(2) +\n            ', ' + this.height.toFixed(2) + ')';\n    }\n\n    /**\n     * !#en The minimum x value, equals to rect.x\n     * !#zh 矩形 x 轴上的最小值，等价于 rect.x。\n     * @property xMin\n     * @type {Number}\n     */\n    get xMin () {\n        return this.x;\n    }\n    set xMin (v) {\n        this.width += this.x - v;\n        this.x = v;\n    }\n\n    /**\n    * !#en The minimum y value, equals to rect.y\n    * !#zh 矩形 y 轴上的最小值。\n    * @property yMin\n    * @type {Number}\n    */\n    get yMin () {\n        return this.y;\n    }\n    set yMin (v) {\n        this.height += this.y - v;\n        this.y = v;\n    }\n\n\n    /**\n    * !#en The maximum x value.\n    * !#zh 矩形 x 轴上的最大值。\n    * @property xMax\n    * @type {Number}\n    */\n    get xMax () {\n        return this.x + this.width;\n    }\n    set xMax (value) {\n        this.width = value - this.x;\n    }\n\n    /**\n    * !#en The maximum y value.\n    * !#zh 矩形 y 轴上的最大值。\n    * @property yMax\n    * @type {Number}\n    */\n    get yMax () {\n        return this.y + this.height;\n    }\n    set yMax (value) {\n        this.height = value - this.y;\n    }\n\n    /**\n    * !#en The position of the center of the rectangle.\n    * !#zh 矩形的中心点。\n    * @property {Vec2} center\n    */\n    get center () {\n        return new Vec2(this.x + this.width * 0.5,\n            this.y + this.height * 0.5);\n    }\n    set center (value) {\n        this.x = value.x - this.width * 0.5;\n        this.y = value.y - this.height * 0.5;\n    }\n\n    /**\n    * !#en The X and Y position of the rectangle.\n    * !#zh 矩形的 x 和 y 坐标。\n    * @property {Vec2} origin\n    */\n    get origin () {\n        return new Vec2(this.x, this.y);\n    }\n    set origin (value) {\n        this.x = value.x;\n        this.y = value.y;\n    }\n\n    /**\n    * !#en Width and height of the rectangle.\n    * !#zh 矩形的大小。\n    * @property {Size} size\n    */\n    get size () {\n        return new Size(this.width, this.height);\n    }\n    set size (value) {\n        this.width = value.width;\n        this.height = value.height;\n    }\n}\n\nCCClass.fastDefine('cc.Rect', Rect, { x: 0, y: 0, width: 0, height: 0 });\ncc.Rect = Rect;\n\n\n/**\n * @module cc\n */\n\n/**\n * !#en\n * The convenience method to create a new Rect.\n * see {{#crossLink \"Rect/Rect:method\"}}cc.Rect{{/crossLink}}\n * !#zh\n * 该方法用来快速创建一个新的矩形。{{#crossLink \"Rect/Rect:method\"}}cc.Rect{{/crossLink}}\n * @method rect\n * @param {Number} [x=0]\n * @param {Number} [y=0]\n * @param {Number} [w=0]\n * @param {Number} [h=0]\n * @return {Rect}\n * @example\n * var a = new cc.Rect(0 , 0, 10, 0);\n */\ncc.rect = function rect (x, y, w, h) {\n    return new Rect(x, y, w, h);\n};\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport ValueType from './value-type';\nimport CCClass from '../platform/CCClass';\n\n/**\n * !#en\n * cc.Size is the class for size object,<br/>\n * please do not use its constructor to create sizes,<br/>\n * use {{#crossLink \"cc/size:method\"}}{{/crossLink}} alias function instead.<br/>\n * It will be deprecated soon, please use cc.Vec2 instead.\n *\n * !#zh\n * cc.Size 是 size 对象的类。<br/>\n * 请不要使用它的构造函数创建的 size，<br/>\n * 使用 {{#crossLink \"cc/size:method\"}}{{/crossLink}} 别名函数。<br/>\n * 它不久将被取消，请使用cc.Vec2代替。\n *\n * @class Size\n */\n/**\n * @method constructor\n * @param {Number|Size} width\n * @param {Number} [height]\n */\nexport default class Size extends ValueType {\n\n    /**\n     * !#en return a Size object with width = 0 and height = 0.\n     * !#zh 返回一个宽度为 0 和高度为 0 的 Size 对象。\n     * @property ZERO\n     * @type {Size}\n     * @default new Size(0, 0)\n     * @static\n     */\n    static get ZERO () { return new Size(); }\n    static readonly ZERO_R = Size.ZERO;\n\n    /**\n     * @property {Number} width\n     */\n    width: number;\n    /**\n     * @property {Number} height\n     */\n    height: number;\n\n    constructor (width: Size | number = 0, height: number = 0) {\n        super();\n        if (width && typeof width === 'object') {\n            this.height = width.height;\n            this.width = width.width;\n        }\n        else {\n            this.width = width as number || 0;\n            this.height = height || 0;\n        }\n    }\n\n    /**\n     * !#en TODO\n     * !#zh 克隆 size 对象。\n     * @method clone\n     * @return {Size}\n     * @example\n     * var a = new cc.size(10, 10);\n     * a.clone();// return Size {width: 0, height: 0};\n     */\n    clone (): Size {\n        return new Size(this.width, this.height);\n    }\n\n    /**\n     * !#en TODO\n     * !#zh 当前 Size 对象是否等于指定 Size 对象。\n     * @method equals\n     * @param {Size} other\n     * @return {Boolean}\n     * @example\n     * var a = new cc.size(10, 10);\n     * a.equals(new cc.size(10, 10));// return true;\n     */\n    equals (other: Size): boolean {\n        return other &&\n            this.width === other.width &&\n            this.height === other.height;\n    }\n\n    /**\n     * !#en TODO\n     * !#zh 线性插值。\n     * @method lerp\n     * @param {Rect} to\n     * @param {Number} ratio - the interpolation coefficient.\n     * @param {Size} [out] - optional, the receiving vector.\n     * @return {Size}\n     * @example\n     * var a = new cc.size(10, 10);\n     * var b = new cc.rect(50, 50, 100, 100);\n     * update (dt) {\n     *    // method 1;\n     *    var c = a.lerp(b, dt * 0.1);\n     *    // method 2;\n     *    a.lerp(b, dt * 0.1, c);\n     * }\n     */\n    lerp (to: Size, ratio: number, out?: Size): Size {\n        out = out || new Size();\n        var width = this.width;\n        var height = this.height;\n        out.width = width + (to.width - width) * ratio;\n        out.height = height + (to.height - height) * ratio;\n        return out;\n    }\n\n    set (source): Size {\n        this.width = source.width;\n        this.height = source.height;\n        return this;\n    }\n\n    /**\n     * !#en TODO\n     * !#zh 转换为方便阅读的字符串。\n     * @method toString\n     * @return {String}\n     * @example\n     * var a = new cc.size(10, 10);\n     * a.toString();// return \"(10.00, 10.00)\";\n     */\n    toString (): string {\n        return '(' + this.width.toFixed(2) + ', ' + this.height.toFixed(2) + ')';\n    }\n}\n\nCCClass.fastDefine('cc.Size', Size, { width: 0, height: 0 });\n\n\n/**\n * @module cc\n */\n\n/**\n * !#en\n * Helper function that creates a cc.Size.<br/>\n * Please use cc.p or cc.v2 instead, it will soon replace cc.Size.\n * !#zh\n * 创建一个 cc.Size 对象的帮助函数。<br/>\n * 注意：可以使用 cc.p 或者是 cc.v2 代替，它们将很快取代 cc.Size。\n * @method size\n * @param {Number|Size} w - width or a size object\n * @param {Number} [h] - height\n * @return {Size}\n * @example {@link cocos2d/core/value-types/CCSize/size.js}\n */\ncc.size = function (w, h) {\n    return new Size(w, h);\n};\n\ncc.Size = Size;\n","\nimport Quat from './quat';\nimport Vec3 from './vec3';\nimport Mat4 from './Mat4';\n\nlet tmp_quat = new Quat();\n\nexport default class Trs {\n    static toRotation (out: Quat, a: FloatArray): Quat {\n        out.x = a[3];\n        out.y = a[4];\n        out.z = a[5];\n        out.w = a[6];\n        return out;\n    }\n\n    static fromRotation (out: FloatArray, a: Quat): FloatArray {\n        out[3] = a.x;\n        out[4] = a.y;\n        out[5] = a.z;\n        out[6] = a.w;\n        return out;\n    }\n\n    static toEuler (out: Vec3, a: FloatArray): Vec3 {\n        Trs.toRotation(tmp_quat, a);\n        Quat.toEuler(out, tmp_quat);\n        return out;\n    }\n\n    static fromEuler (out: FloatArray, a: Vec3): FloatArray {\n        Quat.fromEuler(tmp_quat, a.x, a.y, a.z);\n        Trs.fromRotation(out, tmp_quat);\n        return out;\n    }\n\n    static fromEulerNumber (out: FloatArray, x: number, y: number, z: number): FloatArray {\n        Quat.fromEuler(tmp_quat, x, y, z);\n        Trs.fromRotation(out, tmp_quat);\n        return out;\n    }\n\n    static toScale (out: Vec3, a: FloatArray): Vec3 {\n        out.x = a[7];\n        out.y = a[8];\n        out.z = a[9];\n        return out;\n    }\n\n    static fromScale (out: FloatArray, a: Vec3): FloatArray {\n        out[7] = a.x;\n        out[8] = a.y;\n        out[9] = a.z;\n        return out;\n    }\n\n    static toPosition (out: Vec3, a: FloatArray): Vec3 {\n        out.x = a[0];\n        out.y = a[1];\n        out.z = a[2];\n        return out;\n    }\n\n    static fromPosition (out: FloatArray, a: Vec3): FloatArray {\n        out[0] = a.x;\n        out[1] = a.y;\n        out[2] = a.z;\n        return out;\n    }\n\n    static fromAngleZ (out: FloatArray, a: number): FloatArray {\n        Quat.fromAngleZ(tmp_quat, a);\n        Trs.fromRotation(out, tmp_quat);\n        return out;\n    }\n\n    static toMat4 (out: Mat4, trs: FloatArray): Mat4 {\n        let x = trs[3], y = trs[4], z = trs[5], w = trs[6];\n        let x2 = x + x;\n        let y2 = y + y;\n        let z2 = z + z;\n\n        let xx = x * x2;\n        let xy = x * y2;\n        let xz = x * z2;\n        let yy = y * y2;\n        let yz = y * z2;\n        let zz = z * z2;\n        let wx = w * x2;\n        let wy = w * y2;\n        let wz = w * z2;\n        let sx = trs[7];\n        let sy = trs[8];\n        let sz = trs[9];\n\n        let m = out.m;\n        m[0] = (1 - (yy + zz)) * sx;\n        m[1] = (xy + wz) * sx;\n        m[2] = (xz - wy) * sx;\n        m[3] = 0;\n        m[4] = (xy - wz) * sy;\n        m[5] = (1 - (xx + zz)) * sy;\n        m[6] = (yz + wx) * sy;\n        m[7] = 0;\n        m[8] = (xz + wy) * sz;\n        m[9] = (yz - wx) * sz;\n        m[10] = (1 - (xx + yy)) * sz;\n        m[11] = 0;\n        m[12] = trs[0];\n        m[13] = trs[1];\n        m[14] = trs[2];\n        m[15] = 1;\n\n        return out;\n    }\n}\n\ncc.Trs = Trs;","/**\n * @ignore\n */\nconst _d2r = Math.PI / 180.0;\n/**\n * @ignore\n */\nconst _r2d = 180.0 / Math.PI;\n\n/**\n * @property {number} EPSILON\n */\nexport const EPSILON = 0.000001;\n\n// Number of bits in an integer\nexport const INT_BITS = 32;\nexport const INT_MAX = 0x7fffffff;\nexport const INT_MIN = -1 << (INT_BITS - 1);\n\n/**\n * Use single-precision floating point on native platforms to be compatible with native math libraries.\n * Double precision floating point is used on Web platforms and editors to reduce the overhead of type conversion.\n */\nexport const FLOAT_ARRAY_TYPE = (CC_JSB && CC_NATIVERENDERER) ? Float32Array : Float64Array;\nexport const FLOAT_BYTES = (CC_JSB && CC_NATIVERENDERER) ? 4 : 8;\n\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\n\n/**\n * Tests whether or not the arguments have approximately the same value by given maxDiff\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @param {Number} maxDiff Maximum difference.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\nexport function approx(a, b, maxDiff) {\n  maxDiff = maxDiff || EPSILON;\n  return Math.abs(a - b) <= maxDiff;\n}\n\n/**\n * Clamps a value between a minimum float and maximum float value.\n *\n * @method clamp\n * @param {number} val\n * @param {number} min\n * @param {number} max\n * @return {number}\n */\nexport function clamp(val, min, max) {\n  return val < min ? min : val > max ? max : val;\n}\n\n/**\n * Clamps a value between 0 and 1.\n *\n * @method clamp01\n * @param {number} val\n * @return {number}\n */\nexport function clamp01(val) {\n  return val < 0 ? 0 : val > 1 ? 1 : val;\n}\n\n/**\n * @method lerp\n * @param {number} from\n * @param {number} to\n * @param {number} ratio - the interpolation coefficient\n * @return {number}\n */\nexport function lerp(from, to, ratio) {\n  return from + (to - from) * ratio;\n}\n\n/**\n* Convert Degree To Radian\n*\n* @param {Number} a Angle in Degrees\n*/\nexport function toRadian(a) {\n  return a * _d2r;\n}\n\n/**\n* Convert Radian To Degree\n*\n* @param {Number} a Angle in Radian\n*/\nexport function toDegree(a) {\n  return a * _r2d;\n}\n\n/**\n* @method random\n*/\nexport const random = Math.random;\n\n/**\n * Returns a floating-point random number between min (inclusive) and max (exclusive).\n *\n * @method randomRange\n * @param {number} min\n * @param {number} max\n * @return {number} the random number\n */\nexport function randomRange(min, max) {\n  return Math.random() * (max - min) + min;\n}\n\n/**\n * Returns a random integer between min (inclusive) and max (exclusive).\n *\n * @method randomRangeInt\n * @param {number} min\n * @param {number} max\n * @return {number} the random integer\n */\nexport function randomRangeInt(min, max) {\n  return Math.floor(randomRange(min, max));\n}\n\n/**\n * Linear congruential generator using Hull-Dobell Theorem.\n *\n * @method pseudoRandom\n * @param {number} seed the random seed\n * @return {number} the pseudo random\n */\nexport function pseudoRandom(seed) {\n  seed = (seed * 9301 + 49297) % 233280;\n  return seed / 233280.0;\n}\n\n/**\n * Returns a floating-point pseudo-random number between min (inclusive) and max (exclusive).\n *\n * @method pseudoRandomRange\n * @param {number} seed\n * @param {number} min\n * @param {number} max\n * @return {number} the random number\n */\nexport function pseudoRandomRange(seed, min, max) {\n  return pseudoRandom(seed) * (max - min) + min;\n}\n\n/**\n * Returns a pseudo-random integer between min (inclusive) and max (exclusive).\n *\n * @method pseudoRandomRangeInt\n * @param {number} seed\n * @param {number} min\n * @param {number} max\n * @return {number} the random integer\n */\nexport function pseudoRandomRangeInt(seed, min, max) {\n  return Math.floor(pseudoRandomRange(seed, min, max));\n}\n\n/**\n * Returns the next power of two for the value\n *\n * @method nextPow2\n * @param {number} val\n * @return {number} the the next power of two\n */\nexport function nextPow2(val) {\n  --val;\n  val = (val >> 1) | val;\n  val = (val >> 2) | val;\n  val = (val >> 4) | val;\n  val = (val >> 8) | val;\n  val = (val >> 16) | val;\n  ++val;\n\n  return val;\n}\n\n/**\n * Returns float remainder for t / length\n *\n * @method repeat\n * @param {number} t time start at 0\n * @param {number} length time of one cycle\n * @return {number} the time wrapped in the first cycle\n */\nexport function repeat(t, length) {\n  return t - Math.floor(t / length) * length;\n}\n\n/**\n * Returns time wrapped in ping-pong mode\n *\n * @method repeat\n * @param {number} t time start at 0\n * @param {number} length time of one cycle\n * @return {number} the time wrapped in the first cycle\n */\nexport function pingPong(t, length) {\n  t = repeat(t, length * 2);\n  t = length - Math.abs(t - length);\n  return t;\n}\n\n/**\n * Returns ratio of a value within a given range\n *\n * @method repeat\n * @param {number} from start value\n * @param {number} to end value\n * @param {number} value given value\n * @return {number} the ratio between [from,to]\n */\nexport function inverseLerp(from, to, value) {\n  return (value - from) / (to - from);\n}\n\n/**\n * Returns -1, 0, +1 depending on sign of x.\n * \n * @method sign\n * @param {number} v\n */\nexport function sign (v) {\n  return (v > 0) - (v < 0);\n}","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport js from '../platform/js';\n\n/**\n * !#en The base class of all value types.\n * !#zh 所有值类型的基类。\n * @class ValueType\n *\n */\nexport default class ValueType {\n    /**\n     * !#en This method returns an exact copy of current value.\n     * !#zh 克隆当前值，该方法返回一个新对象，新对象的值和原对象相等。\n     * @method clone\n     * @return {ValueType}\n     */\n    clone () : ValueType {\n        cc.errorID('0100', js.getClassName(this) + '.clone');\n        // @ts-ignore\n        return null;\n    }\n\n    /**\n     * !#en Compares this object with the other one.\n     * !#zh 当前对象是否等于指定对象。\n     * @method equals\n     * @param {ValueType} other\n     * @return {Boolean}\n     */\n    equals (other) {\n        cc.errorID('0100', js.getClassName(this) + '.equals');\n        return false;\n    }\n\n    /**\n     * !#en\n     * Linearly interpolates between this value to to value by ratio which is in the range [0, 1].\n     * When ratio = 0 returns this. When ratio = 1 return to. When ratio = 0.5 returns the average of this and to.\n     * !#zh\n     * 线性插值。<br/>\n     * 当 ratio = 0 时返回自身，ratio = 1 时返回目标，ratio = 0.5 返回自身和目标的平均值。。\n     * @method lerp\n     * @param {ValueType} to - the to value\n     * @param {number} ratio - the interpolation coefficient\n     * @return {ValueType}\n     */\n    lerp (to, ratio) {\n        cc.errorID('0100', js.getClassName(this) + '.lerp');\n        return this.clone();\n    }\n\n    /**\n     * !#en\n     * Copys all the properties from another given object to this value.\n     * !#zh\n     * 从其它对象把所有属性复制到当前对象。\n     * @method set\n     * @param {ValueType} source - the source to copy\n     */\n    set (source) {\n        cc.errorID('0100', js.getClassName(this) + '.set');\n    }\n\n    /**\n     * !#en Convert to a readable string.\n     * !#zh 转换为方便阅读的字符串。\n     * @method toString\n     * @return {string}\n     */\n    toString () {\n        return '' + {};\n    }\n}\n\njs.setClassName('cc.ValueType', ValueType);\ncc.ValueType = ValueType;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport ValueType from './value-type';\nimport Mat4 from './mat4';\nimport CCClass from '../platform/CCClass';\nimport misc from '../utils/misc';\nimport { EPSILON, random } from './utils';\n\nlet _x: number = 0.0;\nlet _y: number = 0.0;\n\n/**\n * !#en Representation of 2D vectors and points.\n * !#zh 表示 2D 向量和坐标\n *\n * @class Vec2\n * @extends ValueType\n */\n\nexport default class Vec2 extends ValueType {\n    // deprecated\n    static sub   = Vec2.subtract;\n    static mul   = Vec2.multiply;\n    static scale = Vec2.multiplyScalar;\n    static mag   = Vec2.len;\n    static squaredMagnitude = Vec2.lengthSqr;\n    static div = Vec2.divide;\n    /**\n     * !#en Returns the length of this vector.\n     * !#zh 返回该向量的长度。\n     * @method mag\n     * @return {number} the result\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.mag(); // return 14.142135623730951;\n     */\n    mag  = Vec2.prototype.len;\n    /**\n     * !#en Returns the squared length of this vector.\n     * !#zh 返回该向量的长度平方。\n     * @method magSqr\n     * @return {number} the result\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.magSqr(); // return 200;\n     */\n    magSqr = Vec2.prototype.lengthSqr;\n    /**\n     * !#en Subtracts one vector from this. If you want to save result to another vector, use sub() instead.\n     * !#zh 向量减法。如果你想保存结果到另一个向量，可使用 sub() 代替。\n     * @method subSelf\n     * @param {Vec2} vector\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.subSelf(cc.v2(5, 5));// return Vec2 {x: 5, y: 5};\n     */\n    subSelf  = Vec2.prototype.subtract;\n    /**\n     * !#en Subtracts one vector from this, and returns the new result.\n     * !#zh 向量减法，并返回新结果。\n     * @method sub\n     * @param {Vec2} vector\n     * @param {Vec2} [out] - optional, the receiving vector, you can pass the same vec2 to save result to itself, if not provided, a new vec2 will be created\n     * @return {Vec2} the result\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.sub(cc.v2(5, 5));      // return Vec2 {x: 5, y: 5};\n     * var v1;\n     * v.sub(cc.v2(5, 5), v1);  // return Vec2 {x: 5, y: 5};\n     */\n    sub (vector: Vec2, out?: Vec2): Vec2 {\n        return Vec2.subtract(out || new Vec2(), this, vector);\n    }\n    /**\n     * !#en Multiplies this by a number. If you want to save result to another vector, use mul() instead.\n     * !#zh 缩放当前向量。如果你想结果保存到另一个向量，可使用 mul() 代替。\n     * @method mulSelf\n     * @param {number} num\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.mulSelf(5);// return Vec2 {x: 50, y: 50};\n     */\n    mulSelf  = Vec2.prototype.multiplyScalar;\n    /**\n     * !#en Multiplies by a number, and returns the new result.\n     * !#zh 缩放向量，并返回新结果。\n     * @method mul\n     * @param {number} num\n     * @param {Vec2} [out] - optional, the receiving vector, you can pass the same vec2 to save result to itself, if not provided, a new vec2 will be created\n     * @return {Vec2} the result\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.mul(5);      // return Vec2 {x: 50, y: 50};\n     * var v1;\n     * v.mul(5, v1);  // return Vec2 {x: 50, y: 50};\n     */\n    mul (num: number, out?: Vec2): Vec2 {\n        return Vec2.multiplyScalar(out || new Vec2(), this, num);\n    }\n    /**\n     * !#en Divides by a number. If you want to save result to another vector, use div() instead.\n     * !#zh 向量除法。如果你想结果保存到另一个向量，可使用 div() 代替。\n     * @method divSelf\n     * @param {number} num\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.divSelf(5); // return Vec2 {x: 2, y: 2};\n     */\n    divSelf  = Vec2.prototype.divide;\n    /**\n     * !#en Divides by a number, and returns the new result.\n     * !#zh 向量除法，并返回新的结果。\n     * @method div\n     * @param {number} num\n     * @param {Vec2} [out] - optional, the receiving vector, you can pass the same vec2 to save result to itself, if not provided, a new vec2 will be created\n     * @return {Vec2} the result\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.div(5);      // return Vec2 {x: 2, y: 2};\n     * var v1;\n     * v.div(5, v1);  // return Vec2 {x: 2, y: 2};\n     */\n    div (num: number, out?: Vec2): Vec2 {\n        return Vec2.multiplyScalar(out || new Vec2(), this, 1/num);\n    }\n    /**\n     * !#en Multiplies two vectors.\n     * !#zh 分量相乘。\n     * @method scaleSelf\n     * @param {Vec2} vector\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.scaleSelf(cc.v2(5, 5));// return Vec2 {x: 50, y: 50};\n     */\n    scaleSelf = Vec2.prototype.multiply;\n    /**\n     * !#en Multiplies two vectors, and returns the new result.\n     * !#zh 分量相乘，并返回新的结果。\n     * @method scale\n     * @param {Vec2} vector\n     * @param {Vec2} [out] - optional, the receiving vector, you can pass the same vec2 to save result to itself, if not provided, a new vec2 will be created\n     * @return {Vec2} the result\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.scale(cc.v2(5, 5));      // return Vec2 {x: 50, y: 50};\n     * var v1;\n     * v.scale(cc.v2(5, 5), v1);  // return Vec2 {x: 50, y: 50};\n     */\n    scale (vector: Vec2, out?: Vec2): Vec2 {\n        return Vec2.multiply(out || new Vec2(), this, vector);\n    }\n    /**\n     * !#en Negates the components. If you want to save result to another vector, use neg() instead.\n     * !#zh 向量取反。如果你想结果保存到另一个向量，可使用 neg() 代替。\n     * @method negSelf\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.negSelf(); // return Vec2 {x: -10, y: -10};\n     */\n    negSelf = Vec2.prototype.negate;\n    /**\n     * !#en Negates the components, and returns the new result.\n     * !#zh 返回取反后的新向量。\n     * @method neg\n     * @param {Vec2} [out] - optional, the receiving vector, you can pass the same vec2 to save result to itself, if not provided, a new vec2 will be created\n     * @return {Vec2} the result\n     * @example\n     * var v = cc.v2(10, 10);\n     * var v1;\n     * v.neg(v1);  // return Vec2 {x: -10, y: -10};\n     */\n    neg (out?: Vec2): Vec2 {\n        return Vec2.negate(out || new Vec2(), this);\n    }\n\n    /**\n     * !#en return a Vec2 object with x = 1 and y = 1.\n     * !#zh 新 Vec2 对象。\n     * @property ONE\n     * @type Vec2\n     * @static\n     */\n    static get ONE () { return new Vec2(1, 1) };\n    static readonly ONE_R = Vec2.ONE;\n\n    /**\n     * !#en return a Vec2 object with x = 0 and y = 0.\n     * !#zh 返回 x = 0 和 y = 0 的 Vec2 对象。\n     * @property {Vec2} ZERO\n     * @static\n     */\n    static get ZERO () { return new Vec2(0, 0) };\n    /**\n     * !#en return a readonly Vec2 object with x = 0 and y = 0.\n     * !#zh 返回一个 x = 0 和 y = 0 的 Vec2 只读对象。\n     * @property {Vec2} ZERO_R\n     * @readonly\n     * @static\n     */\n    static readonly ZERO_R = Vec2.ZERO;\n\n    /**\n     * !#en return a Vec2 object with x = 0 and y = 1.\n     * !#zh 返回 x = 0 和 y = 1 的 Vec2 对象。\n     * @property {Vec2} UP\n     * @static\n     */\n    static get UP () { return new Vec2(0, 1) };\n    /**\n     * !#en return a readonly Vec2 object with x = 0 and y = 1.\n     * !#zh 返回 x = 0 和 y = 1 的 Vec2 只读对象。\n     * @property {Vec2} UP_R\n     * @static\n     * @readonly\n     */\n    static readonly UP_R = Vec2.UP;\n\n    /**\n     * !#en return a readonly Vec2 object with x = 1 and y = 0.\n     * !#zh 返回 x = 1 和 y = 0 的 Vec2 只读对象。\n     * @property {Vec2} RIGHT\n     * @static\n     */\n    static get RIGHT () { return new Vec2(1, 0) };\n    /**\n     * !#en return a Vec2 object with x = 1 and y = 0.\n     * !#zh 返回 x = 1 和 y = 0 的 Vec2 对象。\n     * @property {Vec2} RIGHT_R\n     * @static\n     * @readonly\n     */\n    static readonly RIGHT_R = Vec2.RIGHT;\n\n    /**\n     * !#zh 获得指定向量的拷贝\n     * @method clone\n     * @typescript\n     * clone <Out extends IVec2Like> (a: Out)\n     * @static\n     */\n    static clone <Out extends IVec2Like> (a: Out) {\n        return new Vec2(a.x, a.y);\n    }\n\n    /**\n     * !#zh 复制指定向量的值\n     * @method copy\n     * @typescript\n     * copy <Out extends IVec2Like> (out: Out, a: Out)\n     * @static\n     */\n    static copy <Out extends IVec2Like> (out: Out, a: Out) {\n        out.x = a.x;\n        out.y = a.y;\n        return out;\n    }\n\n    /**\n     * !#zh  设置向量值\n     * @method set\n     * @typescript\n     * set <Out extends IVec2Like> (out: Out, x: number, y: number)\n     * @static\n     */\n    static set <Out extends IVec2Like> (out: Out, x: number, y: number) {\n        out.x = x;\n        out.y = y;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量加法\n     * @method add\n     * @typescript\n     * add <Out extends IVec2Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static add <Out extends IVec2Like> (out: Out, a: Out, b: Out) {\n        out.x = a.x + b.x;\n        out.y = a.y + b.y;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量减法\n     * @method subtract\n     * @typescript\n     * subtract <Out extends IVec2Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static subtract <Out extends IVec2Like> (out: Out, a: Out, b: Out) {\n        out.x = a.x - b.x;\n        out.y = a.y - b.y;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量乘法\n     * @method multiply\n     * @typescript\n     * multiply <Out extends IVec2Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static multiply <Out extends IVec2Like> (out: Out, a: Out, b: Out) {\n        out.x = a.x * b.x;\n        out.y = a.y * b.y;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量除法\n     * @method divide\n     * @typescript\n     * divide <Out extends IVec2Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static divide <Out extends IVec2Like> (out: Out, a: Out, b: Out) {\n        out.x = a.x / b.x;\n        out.y = a.y / b.y;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量向上取整\n     * @method ceil\n     * @typescript\n     * ceil <Out extends IVec2Like> (out: Out, a: Out)\n     * @static\n     */\n    static ceil <Out extends IVec2Like> (out: Out, a: Out) {\n        out.x = Math.ceil(a.x);\n        out.y = Math.ceil(a.y);\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量向下取整\n     * @method floor\n     * @typescript\n     * floor <Out extends IVec2Like> (out: Out, a: Out)\n     * @static\n     */\n    static floor <Out extends IVec2Like> (out: Out, a: Out) {\n        out.x = Math.floor(a.x);\n        out.y = Math.floor(a.y);\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量最小值\n     * @method min\n     * @typescript\n     * min <Out extends IVec2Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static min <Out extends IVec2Like> (out: Out, a: Out, b: Out) {\n        out.x = Math.min(a.x, b.x);\n        out.y = Math.min(a.y, b.y);\n        return out;\n    }\n\n    \n    /**\n     * !#zh 逐元素向量最大值\n     * @method max\n     * @typescript\n     * max <Out extends IVec2Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static max <Out extends IVec2Like> (out: Out, a: Out, b: Out) {\n        out.x = Math.max(a.x, b.x);\n        out.y = Math.max(a.y, b.y);\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量四舍五入取整\n     * @method round\n     * @typescript\n     * round <Out extends IVec2Like> (out: Out, a: Out)\n     * @static\n     */\n    static round <Out extends IVec2Like> (out: Out, a: Out) {\n        out.x = Math.round(a.x);\n        out.y = Math.round(a.y);\n        return out;\n    }\n\n    /**\n     * !#zh 向量标量乘法\n     * @method multiplyScalar\n     * @typescript\n     * multiplyScalar <Out extends IVec2Like> (out: Out, a: Out, b: number)\n     * @static\n     */\n    static multiplyScalar <Out extends IVec2Like> (out: Out, a: Out, b: number) {\n        out.x = a.x * b;\n        out.y = a.y * b;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量乘加: A + B * scale\n     * @method scaleAndAdd\n     * @typescript\n     * scaleAndAdd <Out extends IVec2Like> (out: Out, a: Out, b: Out, scale: number)\n     * @static\n     */\n    static scaleAndAdd <Out extends IVec2Like> (out: Out, a: Out, b: Out, scale: number) {\n        out.x = a.x + (b.x * scale);\n        out.y = a.y + (b.y * scale);\n        return out;\n    }\n\n    /**\n     * !#zh 求两向量的欧氏距离\n     * @method distance\n     * @typescript\n     * distance <Out extends IVec2Like> (a: Out, b: Out)\n     * @static\n     */\n    static distance <Out extends IVec2Like> (a: Out, b: Out) {\n        _x = b.x - a.x;\n        _y = b.y - a.y;\n        return Math.sqrt(_x * _x + _y * _y);\n    }\n\n    /**\n     * !#zh 求两向量的欧氏距离平方\n     * @method squaredDistance\n     * @typescript\n     * squaredDistance <Out extends IVec2Like> (a: Out, b: Out)\n     * @static\n     */\n    static squaredDistance <Out extends IVec2Like> (a: Out, b: Out) {\n        _x = b.x - a.x;\n        _y = b.y - a.y;\n        return _x * _x + _y * _y;\n    }\n\n    /**\n     * !#zh 求向量长度\n     * @method len\n     * @typescript\n     * len <Out extends IVec2Like> (a: Out)\n     * @static\n     */\n    static len <Out extends IVec2Like> (a: Out) {\n        _x = a.x;\n        _y = a.y;\n        return Math.sqrt(_x * _x + _y * _y);\n    }\n\n    /**\n     * !#zh 求向量长度平方\n     * @method lengthSqr\n     * @typescript\n     * lengthSqr <Out extends IVec2Like> (a: Out)\n     * @static\n     */\n    static lengthSqr <Out extends IVec2Like> (a: Out) {\n        _x = a.x;\n        _y = a.y;\n        return _x * _x + _y * _y;\n    }\n\n    /**\n     * !#zh 逐元素向量取负\n     * @method negate\n     * @typescript\n     * negate <Out extends IVec2Like> (out: Out, a: Out)\n     * @static\n     */\n    static negate <Out extends IVec2Like> (out: Out, a: Out) {\n        out.x = -a.x;\n        out.y = -a.y;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量取倒数，接近 0 时返回 Infinity\n     * @method inverse\n     * @typescript\n     * inverse <Out extends IVec2Like> (out: Out, a: Out)\n     * @static\n     */\n    static inverse <Out extends IVec2Like> (out: Out, a: Out) {\n        out.x = 1.0 / a.x;\n        out.y = 1.0 / a.y;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量取倒数，接近 0 时返回 0\n     * @method inverseSafe\n     * @typescript\n     * inverseSafe <Out extends IVec2Like> (out: Out, a: Out)\n     * @static\n     */\n    static inverseSafe <Out extends IVec2Like> (out: Out, a: Out) {\n        _x = a.x;\n        _y = a.y;\n\n        if (Math.abs(_x) < EPSILON) {\n            out.x = 0;\n        } else {\n            out.x = 1.0 / _x;\n        }\n\n        if (Math.abs(_y) < EPSILON) {\n            out.y = 0;\n        } else {\n            out.y = 1.0 / _y;\n        }\n\n        return out;\n    }\n\n    /**\n     * !#zh 归一化向量\n     * @method normalize\n     * @typescript\n     * normalize <Out extends IVec2Like, Vec2Like extends IVec2Like> (out: Out, a: Vec2Like)\n     * @static\n     */\n    static normalize <Out extends IVec2Like, Vec2Like extends IVec2Like> (out: Out, a: Vec2Like) {\n        _x = a.x;\n        _y = a.y;\n        let len = _x * _x + _y * _y;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n            out.x = _x * len;\n            out.y = _y * len;\n        }\n        return out;\n    }\n\n    /**\n     * !#zh 向量点积（数量积）\n     * @method dot\n     * @typescript\n     * dot <Out extends IVec2Like> (a: Out, b: Out)\n     * @static\n     */\n    static dot <Out extends IVec2Like> (a: Out, b: Out) {\n        return a.x * b.x + a.y * b.y;\n    }\n\n    /**\n     * !#zh 向量叉积（向量积），注意二维向量的叉积为与 Z 轴平行的三维向量\n     * @method cross\n     * @typescript\n     * cross <Out extends IVec2Like> (out: Vec2, a: Out, b: Out)\n     * @static\n     */\n    static cross <Out extends IVec2Like> (out: Vec2, a: Out, b: Out) {\n        out.x = out.y = 0;\n        out.z = a.x * b.y - a.y * b.x;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量线性插值： A + t * (B - A)\n     * @method lerp\n     * @typescript\n     * lerp <Out extends IVec2Like> (out: Out, a: Out, b: Out, t: number)\n     * @static\n     */\n    static lerp <Out extends IVec2Like> (out: Out, a: Out, b: Out, t: number) {\n        _x = a.x;\n        _y = a.y;\n        out.x = _x + t * (b.x - _x);\n        out.y = _y + t * (b.y - _y);\n        return out;\n    }\n\n    /**\n     * !#zh 生成一个在单位圆上均匀分布的随机向量\n     * @method random\n     * @typescript\n     * random <Out extends IVec2Like> (out: Out, scale?: number)\n     * @static\n     */\n    static random <Out extends IVec2Like> (out: Out, scale?: number) {\n        scale = scale || 1.0;\n        const r = random() * 2.0 * Math.PI;\n        out.x = Math.cos(r) * scale;\n        out.y = Math.sin(r) * scale;\n        return out;\n    }\n\n    /**\n     * !#zh 向量与三维矩阵乘法，默认向量第三位为 1。\n     * @method transformMat3\n     * @typescript\n     * transformMat3 <Out extends IVec2Like, MatLike extends IMat3Like> (out: Out, a: Out, mat: IMat3Like)\n     * @static\n     */\n    static transformMat3 <Out extends IVec2Like, MatLike extends IMat3Like> (out: Out, a: Out, mat: MatLike) {\n        _x = a.x;\n        _y = a.y;\n        let m = mat.m;\n        out.x = m[0] * _x + m[3] * _y + m[6];\n        out.y = m[1] * _x + m[4] * _y + m[7];\n        return out;\n    }\n\n    /**\n     * !#zh 向量与四维矩阵乘法，默认向量第三位为 0，第四位为 1。\n     * @method transformMat4\n     * @typescript\n     * transformMat4 <Out extends IVec2Like, MatLike extends IMat4Like> (out: Out, a: Out, mat: MatLike)\n     * @static\n     */\n    static transformMat4 <Out extends IVec2Like, MatLike extends IMat4Like> (out: Out, a: Out, mat: MatLike) {\n        _x = a.x;\n        _y = a.y;\n        let m = mat.m;\n        out.x = m[0] * _x + m[4] * _y + m[12];\n        out.y = m[1] * _x + m[5] * _y + m[13];\n        return out;\n    }\n\n    /**\n     * !#zh 向量等价判断\n     * @method strictEquals\n     * @typescript\n     * strictEquals <Out extends IVec2Like> (a: Out, b: Out)\n     * @static\n     */\n    static strictEquals <Out extends IVec2Like> (a: Out, b: Out) {\n        return a.x === b.x && a.y === b.y;\n    }\n\n    /**\n     * !#zh 排除浮点数误差的向量近似等价判断\n     * @method equals\n     * @typescript\n     * equals <Out extends IVec2Like> (a: Out, b: Out,  epsilon = EPSILON)\n     * @static\n     */\n    static equals <Out extends IVec2Like> (a: Out, b: Out,  epsilon = EPSILON) {\n        return (\n            Math.abs(a.x - b.x) <=\n            epsilon * Math.max(1.0, Math.abs(a.x), Math.abs(b.x)) &&\n            Math.abs(a.y - b.y) <=\n            epsilon * Math.max(1.0, Math.abs(a.y), Math.abs(b.y))\n        );\n    }\n\n    /**\n     * !#zh 排除浮点数误差的向量近似等价判断\n     * @method angle\n     * @typescript\n     * angle <Out extends IVec2Like> (a: Out, b: Out)\n     * @static\n     */\n    static angle <Out extends IVec2Like> (a: Out, b: Out) {\n        Vec2.normalize(v2_1, a);\n        Vec2.normalize(v2_2, b);\n        const cosine = Vec2.dot(v2_1, v2_2);\n        if (cosine > 1.0) {\n            return 0;\n        }\n        if (cosine < -1.0) {\n            return Math.PI;\n        }\n        return Math.acos(cosine);\n    }\n\n    /**\n     * !#zh 向量转数组\n     * @method toArray\n     * @typescript\n     * toArray <Out extends IWritableArrayLike<number>> (out: Out, v: IVec2Like, ofs = 0)\n     * @static\n     */\n    static toArray <Out extends IWritableArrayLike<number>> (out: Out, v: IVec2Like, ofs = 0) {\n        out[ofs + 0] = v.x;\n        out[ofs + 1] = v.y;\n        return out;\n    }\n\n    /**\n     * !#zh 数组转向量\n     * @method fromArray\n     * @typescript\n     * fromArray <Out extends IVec2Like> (out: Out, arr: IWritableArrayLike<number>, ofs = 0)\n     * @static\n     */\n    static fromArray <Out extends IVec2Like> (out: Out, arr: IWritableArrayLike<number>, ofs = 0) {\n        out.x = arr[ofs + 0];\n        out.y = arr[ofs + 1];\n        return out;\n    }\n\n    /**\n     * @property {Number} x\n     */\n    x: number;\n\n    /**\n     * @property {Number} y\n     */\n    y: number;\n\n    // compatible with vec3\n    z: number = 0;\n\n    /**\n     * !#en\n     * Constructor\n     * see {{#crossLink \"cc/vec2:method\"}}cc.v2{{/crossLink}} or {{#crossLink \"cc/p:method\"}}cc.p{{/crossLink}}\n     * !#zh\n     * 构造函数，可查看 {{#crossLink \"cc/vec2:method\"}}cc.v2{{/crossLink}} 或者 {{#crossLink \"cc/p:method\"}}cc.p{{/crossLink}}\n     * @method constructor\n     * @param {Number} [x=0]\n     * @param {Number} [y=0]\n     */\n    constructor (x: number | Vec2 = 0, y: number = 0) {\n        super();\n\n        if (x && typeof x === 'object') {\n            this.y = x.y || 0;\n            this.x = x.x || 0;\n        } else {\n            this.x = x as number || 0;\n            this.y = y || 0;\n        }\n    }\n\n    /**\n     * !#en clone a Vec2 object\n     * !#zh 克隆一个 Vec2 对象\n     * @method clone\n     * @return {Vec2}\n     */\n    clone (): Vec2 {\n        return new Vec2(this.x, this.y);\n    }\n\n    /**\n     * !#en Sets vector with another's value\n     * !#zh 设置向量值。\n     * @method set\n     * @param {Vec2} newValue - !#en new value to set. !#zh 要设置的新值\n     * @return {Vec2} returns this\n     * @chainable\n     */\n    set (newValue: Vec2): this {\n        this.x = newValue.x;\n        this.y = newValue.y;\n        return this;\n    }\n\n    /**\n     * !#en Check whether two vector equal\n     * !#zh 当前的向量是否与指定的向量相等。\n     * @method equals\n     * @param {Vec2} other\n     * @return {Boolean}\n     */\n    equals (other: Vec2): boolean {\n        return other && this.x === other.x && this.y === other.y;\n    }\n\n    /**\n     * !#en Check whether two vector equal with some degree of variance.\n     * !#zh\n     * 近似判断两个点是否相等。<br/>\n     * 判断 2 个向量是否在指定数值的范围之内，如果在则返回 true，反之则返回 false。\n     * @method fuzzyEquals\n     * @param {Vec2} other\n     * @param {Number} variance\n     * @return {Boolean}\n     */\n    fuzzyEquals (other: Vec2, variance): boolean {\n        if (this.x - variance <= other.x && other.x <= this.x + variance) {\n            if (this.y - variance <= other.y && other.y <= this.y + variance)\n                return true;\n        }\n        return false;\n    }\n\n    /**\n     * !#en Transform to string with vector informations\n     * !#zh 转换为方便阅读的字符串。\n     * @method toString\n     * @return {string}\n     */\n    toString (): string {\n        return \"(\" +\n            this.x.toFixed(2) + \", \" +\n            this.y.toFixed(2) + \")\"\n            ;\n    }\n\n    /**\n     * !#en Calculate linear interpolation result between this vector and another one with given ratio\n     * !#zh 线性插值。\n     * @method lerp\n     * @param {Vec2} to\n     * @param {Number} ratio - the interpolation coefficient\n     * @param {Vec2} [out] - optional, the receiving vector, you can pass the same vec2 to save result to itself, if not provided, a new vec2 will be created\n     * @return {Vec2}\n     */\n    lerp (to: Vec2, ratio: number, out?: Vec2): Vec2 {\n        out = out || new Vec2();\n        var x = this.x;\n        var y = this.y;\n        out.x = x + (to.x - x) * ratio;\n        out.y = y + (to.y - y) * ratio;\n        return out;\n    }\n\n    /**\n     * !#en Clamp the vector between from float and to float.\n     * !#zh\n     * 返回指定限制区域后的向量。<br/>\n     * 向量大于 max_inclusive 则返回 max_inclusive。<br/>\n     * 向量小于 min_inclusive 则返回 min_inclusive。<br/>\n     * 否则返回自身。\n     * @method clampf\n     * @param {Vec2} min_inclusive\n     * @param {Vec2} max_inclusive\n     * @return {Vec2}\n     * @example\n     * var min_inclusive = cc.v2(0, 0);\n     * var max_inclusive = cc.v2(20, 20);\n     * var v1 = cc.v2(20, 20).clampf(min_inclusive, max_inclusive); // Vec2 {x: 20, y: 20};\n     * var v2 = cc.v2(0, 0).clampf(min_inclusive, max_inclusive);   // Vec2 {x: 0, y: 0};\n     * var v3 = cc.v2(10, 10).clampf(min_inclusive, max_inclusive); // Vec2 {x: 10, y: 10};\n     */\n    clampf (min_inclusive: Vec2, max_inclusive: Vec2): this {\n        this.x = misc.clampf(this.x, min_inclusive.x, max_inclusive.x);\n        this.y = misc.clampf(this.y, min_inclusive.y, max_inclusive.y);\n        return this;\n    }\n\n    /**\n     * !#en Adds this vector.\n     * !#zh 向量加法。\n     * @method add\n     * @param {Vec2} vector\n     * @param {Vec2} [out]\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.add(cc.v2(5, 5));// return Vec2 {x: 15, y: 15};\n     */\n    add (vector: Vec2, out?: Vec2): Vec2 {\n        out = out || new Vec2();\n        out.x = this.x + vector.x;\n        out.y = this.y + vector.y;\n        return out;\n    }\n\n    /**\n     * !#en Adds this vector. If you want to save result to another vector, use add() instead.\n     * !#zh 向量加法。如果你想保存结果到另一个向量，使用 add() 代替。\n     * @method addSelf\n     * @param {Vec2} vector\n     * @return {Vec2} returns this\n     * @chainable\n     */\n    addSelf (vector: Vec2): this {\n        this.x += vector.x;\n        this.y += vector.y;\n        return this;\n    }\n\n    /**\n     * !#en Subtracts one vector from this.\n     * !#zh 向量减法。\n     * @method subtract\n     * @param {Vec2} vector\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.subSelf(cc.v2(5, 5));// return Vec2 {x: 5, y: 5};\n     */\n    subtract (vector: Vec2): this {\n        this.x -= vector.x;\n        this.y -= vector.y;\n        return this;\n    }\n\n    /**\n     * !#en Multiplies this by a number.\n     * !#zh 缩放当前向量。\n     * @method multiplyScalar\n     * @param {number} num\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.multiply(5);// return Vec2 {x: 50, y: 50};\n     */\n    multiplyScalar (num: number): this {\n        this.x *= num;\n        this.y *= num;\n        return this;\n    }\n\n    /**\n     * !#en Multiplies two vectors.\n     * !#zh 分量相乘。\n     * @method multiply\n     * @param {Vec2} vector\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.multiply(cc.v2(5, 5));// return Vec2 {x: 50, y: 50};\n     */\n    multiply (vector: Vec2): this {\n        this.x *= vector.x;\n        this.y *= vector.y;\n        return this;\n    }\n\n    /**\n     * !#en Divides by a number.\n     * !#zh 向量除法。\n     * @method divide\n     * @param {number} num\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.divide(5); // return Vec2 {x: 2, y: 2};\n     */\n    divide (num: number): this {\n        this.x /= num;\n        this.y /= num;\n        return this;\n    }\n\n    /**\n     * !#en Negates the components.\n     * !#zh 向量取反。\n     * @method negate\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.negate(); // return Vec2 {x: -10, y: -10};\n     */\n    negate (): this {\n        this.x = -this.x;\n        this.y = -this.y;\n        return this;\n    }\n\n    /**\n     * !#en Dot product\n     * !#zh 当前向量与指定向量进行点乘。\n     * @method dot\n     * @param {Vec2} [vector]\n     * @return {number} the result\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.dot(cc.v2(5, 5)); // return 100;\n     */\n    dot (vector: Vec2): number {\n        return this.x * vector.x + this.y * vector.y;\n    }\n\n    /**\n     * !#en Cross product\n     * !#zh 当前向量与指定向量进行叉乘。\n     * @method cross\n     * @param {Vec2} [vector]\n     * @return {number} the result\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.cross(cc.v2(5, 5)); // return 0;\n     */\n    cross (vector: Vec2): number {\n        return this.x * vector.y - this.y * vector.x;\n    }\n\n    /**\n     * !#en Returns the length of this vector.\n     * !#zh 返回该向量的长度。\n     * @method len\n     * @return {number} the result\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.len(); // return 14.142135623730951;\n     */\n    len (): number {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    }\n\n    /**\n     * !#en Returns the squared length of this vector.\n     * !#zh 返回该向量的长度平方。\n     * @method lengthSqr\n     * @return {number} the result\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.lengthSqr(); // return 200;\n     */\n    lengthSqr (): number {\n        return this.x * this.x + this.y * this.y;\n    }\n\n    /**\n     * !#en Make the length of this vector to 1.\n     * !#zh 向量归一化，让这个向量的长度为 1。\n     * @method normalizeSelf\n     * @return {Vec2} returns this\n     * @chainable\n     * @example\n     * var v = cc.v2(10, 10);\n     * v.normalizeSelf(); // return Vec2 {x: 0.7071067811865475, y: 0.7071067811865475};\n     */\n    normalizeSelf (): Vec2 {\n        var magSqr = this.x * this.x + this.y * this.y;\n        if (magSqr === 1.0)\n            return this;\n\n        if (magSqr === 0.0) {\n            return this;\n        }\n\n        var invsqrt = 1.0 / Math.sqrt(magSqr);\n        this.x *= invsqrt;\n        this.y *= invsqrt;\n\n        return this;\n    }\n\n    /**\n     * !#en\n     * Returns this vector with a magnitude of 1.<br/>\n     * <br/>\n     * Note that the current vector is unchanged and a new normalized vector is returned. If you want to normalize the current vector, use normalizeSelf function.\n     * !#zh\n     * 返回归一化后的向量。<br/>\n     * <br/>\n     * 注意，当前向量不变，并返回一个新的归一化向量。如果你想来归一化当前向量，可使用 normalizeSelf 函数。\n     * @method normalize\n     * @param {Vec2} [out] - optional, the receiving vector, you can pass the same vec2 to save result to itself, if not provided, a new vec2 will be created\n     * @return {Vec2} result\n     * var v = cc.v2(10, 10);\n     * v.normalize();   // return Vec2 {x: 0.7071067811865475, y: 0.7071067811865475};\n     */\n    normalize (out?: Vec2): Vec2 {\n        out = out || new Vec2();\n        out.x = this.x;\n        out.y = this.y;\n        out.normalizeSelf();\n        return out;\n    }\n\n    /**\n     * !#en Get angle in radian between this and vector.\n     * !#zh 夹角的弧度。\n     * @method angle\n     * @param {Vec2} vector\n     * @return {number} from 0 to Math.PI\n     */\n    angle (vector: Vec2): number {\n        var magSqr1 = this.magSqr();\n        var magSqr2 = vector.magSqr();\n\n        if (magSqr1 === 0 || magSqr2 === 0) {\n            console.warn(\"Can't get angle between zero vector\");\n            return 0.0;\n        }\n\n        var dot = this.dot(vector);\n        var theta = dot / (Math.sqrt(magSqr1 * magSqr2));\n        theta = misc.clampf(theta, -1.0, 1.0);\n        return Math.acos(theta);\n    }\n\n    /**\n     * !#en Get angle in radian between this and vector with direction.\n     * !#zh 带方向的夹角的弧度。\n     * @method signAngle\n     * @param {Vec2} vector\n     * @return {number} from -MathPI to Math.PI\n     */\n    signAngle (vector: Vec2): number {\n        let angle = this.angle(vector);\n        return this.cross(vector) < 0 ? -angle : angle;\n    }\n\n    /**\n     * !#en rotate\n     * !#zh 返回旋转给定弧度后的新向量。\n     * @method rotate\n     * @param {number} radians\n     * @param {Vec2} [out] - optional, the receiving vector, you can pass the same vec2 to save result to itself, if not provided, a new vec2 will be created\n     * @return {Vec2} the result\n     */\n    rotate (radians: number, out?: Vec2): Vec2 {\n        out = out || new Vec2();\n        out.x = this.x;\n        out.y = this.y;\n        return out.rotateSelf(radians);\n    }\n\n    /**\n     * !#en rotate self\n     * !#zh 按指定弧度旋转向量。\n     * @method rotateSelf\n     * @param {number} radians\n     * @return {Vec2} returns this\n     * @chainable\n     */\n    rotateSelf (radians: number): Vec2 {\n        var sin = Math.sin(radians);\n        var cos = Math.cos(radians);\n        var x = this.x;\n        this.x = cos * x - sin * this.y;\n        this.y = sin * x + cos * this.y;\n        return this;\n    }\n\n    /**\n     * !#en Calculates the projection of the current vector over the given vector.\n     * !#zh 返回当前向量在指定 vector 向量上的投影向量。\n     * @method project\n     * @param {Vec2} vector\n     * @return {Vec2}\n     * @example\n     * var v1 = cc.v2(20, 20);\n     * var v2 = cc.v2(5, 5);\n     * v1.project(v2); // Vec2 {x: 20, y: 20};\n     */\n    project (vector: Vec2): Vec2 {\n        return vector.multiplyScalar(this.dot(vector) / vector.dot(vector));\n    }\n\n    /**\n     * Transforms the vec2 with a mat4. 3rd vector component is implicitly '0', 4th vector component is implicitly '1'\n     * @method transformMat4\n     * @param {Mat4} m matrix to transform with\n     * @param {Vec2} [out] the receiving vector, you can pass the same vec2 to save result to itself, if not provided, a new vec2 will be created\n     * @returns {Vec2} out\n     */\n    transformMat4 (m: Mat4, out?: Vec2): Vec2 {\n        out = out || new Vec2();\n        Vec2.transformMat4(out, this, m);\n        return out;\n    }\n\n    /**\n     * Returns the maximum value in x, y.\n     * @method maxAxis\n     * @returns {number}\n     */\n    maxAxis (): number {\n        return Math.max(this.x, this.y);\n    }\n}\n\nconst v2_1 = new Vec2();\nconst v2_2 = new Vec2();\n\nCCClass.fastDefine('cc.Vec2', Vec2, { x: 0, y: 0 });\n\n\n\n/**\n * @module cc\n */\n\n\n/**\n * !#en The convenience method to create a new {{#crossLink \"Vec2\"}}cc.Vec2{{/crossLink}}.\n * !#zh 通过该简便的函数进行创建 {{#crossLink \"Vec2\"}}cc.Vec2{{/crossLink}} 对象。\n * @method v2\n * @param {Number|Object} [x=0]\n * @param {Number} [y=0]\n * @return {Vec2}\n * @example\n * var v1 = cc.v2();\n * var v2 = cc.v2(0, 0);\n * var v3 = cc.v2(v2);\n * var v4 = cc.v2({x: 100, y: 100});\n */\ncc.v2 = function v2 (x, y) {\n    return new Vec2(x, y);\n};\n\ncc.Vec2 = Vec2;\n","/****************************************************************************\n Copyright (c) 2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nimport ValueType from './value-type';\nimport CCClass from '../platform/CCClass';\nimport misc from '../utils/misc';\nimport Vec2 from './vec2';\nimport Mat4 from './mat4';\nimport { EPSILON, random } from './utils';\n\nlet _x: number = 0.0;\nlet _y: number = 0.0;\nlet _z: number = 0.0;\n\n/**\n * !#en Representation of 3D vectors and points.\n * !#zh 表示 3D 向量和坐标\n *\n * @class Vec3\n * @extends ValueType\n */\n\nexport default class Vec3 extends ValueType {\n    // deprecated\n    static sub   = Vec3.subtract;\n    static mul   = Vec3.multiply;\n    static scale = Vec3.multiplyScalar;\n    static mag   = Vec3.len;\n    static squaredMagnitude = Vec3.lengthSqr;\n    static div = Vec3.divide;\n\n    /**\n     * !#en Returns the length of this vector.\n     * !#zh 返回该向量的长度。\n     * @method mag\n     * @return {number} the result\n     * @example\n     * var v = cc.v3(10, 10, 10);\n     * v.mag(); // return 17.320508075688775;\n     */\n    mag  = Vec3.prototype.len;\n    /**\n     * !#en Returns the squared length of this vector.\n     * !#zh 返回该向量的长度平方。\n     * @method magSqr\n     * @return {number} the result\n     */\n    magSqr = Vec3.prototype.lengthSqr;\n    /**\n     * !#en Subtracts one vector from this. If you want to save result to another vector, use sub() instead.\n     * !#zh 向量减法。如果你想保存结果到另一个向量，可使用 sub() 代替。\n     * @method subSelf\n     * @param {Vec3} vector\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    subSelf  = Vec3.prototype.subtract;\n    /**\n     * !#en Subtracts one vector from this, and returns the new result.\n     * !#zh 向量减法，并返回新结果。\n     * @method sub\n     * @param {Vec3} vector\n     * @param {Vec3} [out] - optional, the receiving vector, you can pass the same vec3 to save result to itself, if not provided, a new vec3 will be created\n     * @return {Vec3} the result\n     */\n    sub (vector: Vec3, out?: Vec3) {\n        return Vec3.subtract(out || new Vec3(), this, vector);\n    }\n    /**\n     * !#en Multiplies this by a number. If you want to save result to another vector, use mul() instead.\n     * !#zh 缩放当前向量。如果你想结果保存到另一个向量，可使用 mul() 代替。\n     * @method mulSelf\n     * @param {number} num\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    mulSelf  = Vec3.prototype.multiplyScalar;\n    /**\n     * !#en Multiplies by a number, and returns the new result.\n     * !#zh 缩放向量，并返回新结果。\n     * @method mul\n     * @param {number} num\n     * @param {Vec3} [out] - optional, the receiving vector, you can pass the same vec3 to save result to itself, if not provided, a new vec3 will be created\n     * @return {Vec3} the result\n     */\n    mul (num: number, out?: Vec3) {\n        return Vec3.multiplyScalar(out || new Vec3(), this, num);\n    }\n    /**\n     * !#en Divides by a number. If you want to save result to another vector, use div() instead.\n     * !#zh 向量除法。如果你想结果保存到另一个向量，可使用 div() 代替。\n     * @method divSelf\n     * @param {number} num\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    divSelf  = Vec3.prototype.divide;\n    /**\n     * !#en Divides by a number, and returns the new result.\n     * !#zh 向量除法，并返回新的结果。\n     * @method div\n     * @param {number} num\n     * @param {Vec3} [out] - optional, the receiving vector, you can pass the same vec3 to save result to itself, if not provided, a new vec3 will be created\n     * @return {Vec3} the result\n     */\n    div (num: number, out?: Vec3): Vec3 {\n        return Vec3.multiplyScalar(out || new Vec3(), this, 1/num);\n    }\n    /**\n     * !#en Multiplies two vectors.\n     * !#zh 分量相乘。\n     * @method scaleSelf\n     * @param {Vec3} vector\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    scaleSelf = Vec3.prototype.multiply;\n    /**\n     * !#en Multiplies two vectors, and returns the new result.\n     * !#zh 分量相乘，并返回新的结果。\n     * @method scale\n     * @param {Vec3} vector\n     * @param {Vec3} [out] - optional, the receiving vector, you can pass the same vec3 to save result to itself, if not provided, a new vec3 will be created\n     * @return {Vec3} the result\n     */\n    scale (vector: Vec3, out?: Vec3) {\n        return Vec3.multiply(out || new Vec3(), this, vector);\n    }\n    /**\n     * !#en Negates the components. If you want to save result to another vector, use neg() instead.\n     * !#zh 向量取反。如果你想结果保存到另一个向量，可使用 neg() 代替。\n     * @method negSelf\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    negSelf = Vec3.prototype.negate;\n    /**\n     * !#en Negates the components, and returns the new result.\n     * !#zh 返回取反后的新向量。\n     * @method neg\n     * @param {Vec3} [out] - optional, the receiving vector, you can pass the same vec3 to save result to itself, if not provided, a new vec3 will be created\n     * @return {Vec3} the result\n     */\n    neg (out?: Vec3) {\n        return Vec3.negate(out || new Vec3(), this);\n    }\n\n    /**\n     * !#en return a Vec3 object with x = 1, y = 1, z = 1.\n     * !#zh 新 Vec3 对象。\n     * @property ONE\n     * @type Vec3\n     * @static\n     */\n    static get ONE () { return new Vec3(1, 1, 1); }\n    static readonly ONE_R = Vec3.ONE;\n\n    /**\n     * !#en return a Vec3 object with x = 0, y = 0, z = 0.\n     * !#zh 返回 x = 0，y = 0，z = 0 的 Vec3 对象。\n     * @property ZERO\n     * @type Vec3\n     * @static\n     */\n    static get ZERO () { return new Vec3(); }\n    static readonly ZERO_R = Vec3.ZERO;\n\n    /**\n     * !#en return a Vec3 object with x = 0, y = 1, z = 0.\n     * !#zh 返回 x = 0, y = 1, z = 0 的 Vec3 对象。\n     * @property UP\n     * @type Vec3\n     * @static\n     */\n    static get UP () { return new Vec3(0, 1, 0); }\n    static readonly UP_R = Vec3.UP;\n\n    /**\n     * !#en return a Vec3 object with x = 1, y = 0, z = 0.\n     * !#zh 返回 x = 1，y = 0，z = 0 的 Vec3 对象。\n     * @property RIGHT\n     * @type Vec3\n     * @static\n     */\n    static get RIGHT () { return new Vec3(1, 0, 0); }\n    static readonly RIGHT_R = Vec3.RIGHT;\n    \n    /**\n     * !#en return a Vec3 object with x = 0, y = 0, z = 1.\n     * !#zh 返回 x = 0，y = 0，z = 1 的 Vec3 对象。\n     * @property FRONT\n     * @type Vec3\n     * @static\n     */\n    static get FRONT () { return new Vec3(0, 0, 1); }\n    static readonly FRONT_R = Vec3.FRONT;\n\n\n    /**\n     * !#zh 将目标赋值为零向量\n     * !#en The target of an assignment zero vector\n     * @method zero\n     * @typescript\n     * zero<Out extends IVec3Like> (out: Out)\n     * @static\n     */\n    static zero<Out extends IVec3Like> (out: Out) {\n        out.x = 0;\n        out.y = 0;\n        out.z = 0;\n        return out;\n    }\n\n    /**\n     * !#zh 获得指定向量的拷贝\n     * !#en Obtaining copy vectors designated\n     * @method clone\n     * @typescript\n     * clone<Out extends IVec3Like> (a: Out)\n     * @static\n     */\n    static clone<Out extends IVec3Like> (a: Out) {\n        return new Vec3(a.x, a.y, a.z);\n    }\n\n    /**\n     * !#zh 复制目标向量\n     * !#en Copy the target vector\n     * @method copy\n     * @typescript\n     * copy<Out extends IVec3Like, Vec3Like extends IVec3Like> (out: Out, a: Vec3Like)\n     * @static\n     */\n    static copy<Out extends IVec3Like, Vec3Like extends IVec3Like> (out: Out, a: Vec3Like) {\n        out.x = a.x;\n        out.y = a.y;\n        out.z = a.z;\n        return out;\n    }\n\n    /**\n     * !#zh 设置向量值\n     * !#en Set to value\n     * @method set\n     * @typescript\n     * set<Out extends IVec3Like> (out: Out, x: number, y: number, z: number)\n     * @static\n     */\n    static set<Out extends IVec3Like> (out: Out, x: number, y: number, z: number) {\n        out.x = x;\n        out.y = y;\n        out.z = z;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量加法\n     * !#en Element-wise vector addition\n     * @method add\n     * @typescript\n     * add<Out extends IVec3Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static add<Out extends IVec3Like> (out: Out, a: Out, b: Out) {\n        out.x = a.x + b.x;\n        out.y = a.y + b.y;\n        out.z = a.z + b.z;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量减法\n     * !#en Element-wise vector subtraction\n     * @method subtract\n     * @typescript\n     * subtract<Out extends IVec3Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static subtract<Out extends IVec3Like> (out: Out, a: Out, b: Out) {\n        out.x = a.x - b.x;\n        out.y = a.y - b.y;\n        out.z = a.z - b.z;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量乘法 (分量积)\n     * !#en Element-wise vector multiplication (product component)\n     * @method multiply\n     * @typescript\n     * multiply<Out extends IVec3Like, Vec3Like_1 extends IVec3Like, Vec3Like_2 extends IVec3Like> (out: Out, a: Vec3Like_1, b: Vec3Like_2)\n     * @static\n     */\n    static multiply<Out extends IVec3Like, Vec3Like_1 extends IVec3Like, Vec3Like_2 extends IVec3Like> (out: Out, a: Vec3Like_1, b: Vec3Like_2) {\n        out.x = a.x * b.x;\n        out.y = a.y * b.y;\n        out.z = a.z * b.z;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量除法\n     * !#en Element-wise vector division\n     * @method divide\n     * @typescript\n     * divide<Out extends IVec3Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static divide<Out extends IVec3Like> (out: Out, a: Out, b: Out) {\n        out.x = a.x / b.x;\n        out.y = a.y / b.y;\n        out.z = a.z / b.z;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量向上取整\n     * !#en Rounding up by elements of the vector\n     * @method ceil\n     * @typescript\n     * ceil<Out extends IVec3Like> (out: Out, a: Out)\n     * @static\n     */\n    static ceil<Out extends IVec3Like> (out: Out, a: Out) {\n        out.x = Math.ceil(a.x);\n        out.y = Math.ceil(a.y);\n        out.z = Math.ceil(a.z);\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量向下取整\n     * !#en Element vector by rounding down\n     * @method floor\n     * @typescript\n     * floor<Out extends IVec3Like> (out: Out, a: Out)\n     * @static\n     */\n    static floor<Out extends IVec3Like> (out: Out, a: Out) {\n        out.x = Math.floor(a.x);\n        out.y = Math.floor(a.y);\n        out.z = Math.floor(a.z);\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量最小值\n     * !#en The minimum by-element vector\n     * @method min\n     * @typescript\n     * min<Out extends IVec3Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static min<Out extends IVec3Like> (out: Out, a: Out, b: Out) {\n        out.x = Math.min(a.x, b.x);\n        out.y = Math.min(a.y, b.y);\n        out.z = Math.min(a.z, b.z);\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量最大值\n     * !#en The maximum value of the element-wise vector\n     * @method max\n     * @typescript\n     * max<Out extends IVec3Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    static max<Out extends IVec3Like> (out: Out, a: Out, b: Out) {\n        out.x = Math.max(a.x, b.x);\n        out.y = Math.max(a.y, b.y);\n        out.z = Math.max(a.z, b.z);\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量四舍五入取整\n     * !#en Element-wise vector of rounding to whole\n     * @method round\n     * @typescript\n     * round<Out extends IVec3Like> (out: Out, a: Out)\n     * @static\n     */\n    static round<Out extends IVec3Like> (out: Out, a: Out) {\n        out.x = Math.round(a.x);\n        out.y = Math.round(a.y);\n        out.z = Math.round(a.z);\n        return out;\n    }\n\n    /**\n     * !#zh 向量标量乘法\n     * !#en Vector scalar multiplication\n     * @method multiplyScalar\n     * @typescript\n     * multiplyScalar<Out extends IVec3Like, Vec3Like extends IVec3Like> (out: Out, a: Vec3Like, b: number)\n     * @static\n     */\n    static multiplyScalar<Out extends IVec3Like, Vec3Like extends IVec3Like> (out: Out, a: Vec3Like, b: number) {\n        out.x = a.x * b;\n        out.y = a.y * b;\n        out.z = a.z * b;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量乘加: A + B * scale\n     * !#en Element-wise vector multiply add: A + B * scale\n     * @method scaleAndAdd\n     * @typescript\n     * scaleAndAdd<Out extends IVec3Like> (out: Out, a: Out, b: Out, scale: number)\n     * @static\n     */\n    static scaleAndAdd<Out extends IVec3Like> (out: Out, a: Out, b: Out, scale: number) {\n        out.x = a.x + b.x * scale;\n        out.y = a.y + b.y * scale;\n        out.z = a.z + b.z * scale;\n        return out;\n    }\n\n    /**\n     * !#zh 求两向量的欧氏距离\n     * !#en Seeking two vectors Euclidean distance\n     * @method distance\n     * @typescript\n     * distance<Out extends IVec3Like> (a: Out, b: Out)\n     * @static\n     */\n    static distance<Out extends IVec3Like> (a: Out, b: Out) {\n        _x = b.x - a.x;\n        _y = b.y - a.y;\n        _z = b.z - a.z;\n        return Math.sqrt(_x * _x + _y * _y + _z * _z);\n    }\n\n    /**\n     * !#zh 求两向量的欧氏距离平方\n     * !#en Euclidean distance squared seeking two vectors\n     * @method squaredDistance\n     * @typescript\n     * squaredDistance<Out extends IVec3Like> (a: Out, b: Out)\n     * @static\n     */\n    static squaredDistance<Out extends IVec3Like> (a: Out, b: Out) {\n        _x = b.x - a.x;\n        _y = b.y - a.y;\n        _z = b.z - a.z;\n        return _x * _x + _y * _y + _z * _z;\n    }\n\n    /**\n     * !#zh 求向量长度\n     * !#en Seeking vector length\n     * @method len\n     * @typescript\n     * len<Out extends IVec3Like> (a: Out)\n     * @static\n     */\n    static len<Out extends IVec3Like> (a: Out) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n        return Math.sqrt(_x * _x + _y * _y + _z * _z);\n    }\n\n    /**\n     * !#zh 求向量长度平方\n     * !#en Seeking squared vector length\n     * @method lengthSqr\n     * @typescript\n     * lengthSqr<Out extends IVec3Like> (a: Out)\n     * @static\n     */\n    static lengthSqr<Out extends IVec3Like> (a: Out) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n        return _x * _x + _y * _y + _z * _z;\n    }\n\n    /**\n     * !#zh 逐元素向量取负\n     * !#en By taking the negative elements of the vector\n     * @method negate\n     * @typescript\n     * negate<Out extends IVec3Like> (out: Out, a: Out)\n     * @static\n     */\n    static negate<Out extends IVec3Like> (out: Out, a: Out) {\n        out.x = -a.x;\n        out.y = -a.y;\n        out.z = -a.z;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量取倒数，接近 0 时返回 Infinity\n     * !#en Element vector by taking the inverse, return near 0 Infinity\n     * @method inverse\n     * @typescript\n     * inverse<Out extends IVec3Like> (out: Out, a: Out)\n     * @static\n     */\n    static inverse<Out extends IVec3Like> (out: Out, a: Out) {\n        out.x = 1.0 / a.x;\n        out.y = 1.0 / a.y;\n        out.z = 1.0 / a.z;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量取倒数，接近 0 时返回 0\n     * !#en Element vector by taking the inverse, return near 0 0\n     * @method inverseSafe\n     * @typescript\n     * inverseSafe<Out extends IVec3Like> (out: Out, a: Out)\n     * @static\n     */\n    static inverseSafe<Out extends IVec3Like> (out: Out, a: Out) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n\n        if (Math.abs(_x) < EPSILON) {\n            out.x = 0;\n        } else {\n            out.x = 1.0 / _x;\n        }\n\n        if (Math.abs(_y) < EPSILON) {\n            out.y = 0;\n        } else {\n            out.y = 1.0 / _y;\n        }\n\n        if (Math.abs(_z) < EPSILON) {\n            out.z = 0;\n        } else {\n            out.z = 1.0 / _z;\n        }\n\n        return out;\n    }\n\n    /**\n     * !#zh 归一化向量\n     * !#en Normalized vector\n     * @method normalize\n     * @typescript\n     * normalize<Out extends IVec3Like, Vec3Like extends IVec3Like> (out: Out, a: Vec3Like)\n     * @static\n     */\n    static normalize<Out extends IVec3Like, Vec3Like extends IVec3Like> (out: Out, a: Vec3Like) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n\n        let len = _x * _x + _y * _y + _z * _z;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n            out.x = _x * len;\n            out.y = _y * len;\n            out.z = _z * len;\n        }\n        return out;\n    }\n\n    /**\n     * !#zh 向量点积（数量积）\n     * !#en Vector dot product (scalar product)\n     * @method dot\n     * @typescript\n     * dot<Out extends IVec3Like> (a: Out, b: Out)\n     * @static\n     */\n    static dot<Out extends IVec3Like> (a: Out, b: Out) {\n        return a.x * b.x + a.y * b.y + a.z * b.z;\n    }\n\n    /**\n     * !#zh 向量叉积（向量积）\n     * !#en Vector cross product (vector product)\n     * @method cross\n     * @typescript\n     * cross<Out extends IVec3Like, Vec3Like_1 extends IVec3Like, Vec3Like_2 extends IVec3Like> (out: Out, a: Vec3Like_1, b: Vec3Like_2)\n     * @static\n     */\n    static cross<Out extends IVec3Like, Vec3Like_1 extends IVec3Like, Vec3Like_2 extends IVec3Like> (out: Out, a: Vec3Like_1, b: Vec3Like_2) {\n        const { x: ax, y: ay, z: az } = a;\n        const { x: bx, y: by, z: bz } = b;\n        out.x = ay * bz - az * by;\n        out.y = az * bx - ax * bz;\n        out.z = ax * by - ay * bx;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量线性插值： A + t * (B - A)\n     * !#en Vector element by element linear interpolation: A + t * (B - A)\n     * @method lerp\n     * @typescript\n     * lerp<Out extends IVec3Like> (out: Out, a: Out, b: Out, t: number)\n     * @static\n     */\n    static lerp<Out extends IVec3Like> (out: Out, a: Out, b: Out, t: number) {\n        out.x = a.x + t * (b.x - a.x);\n        out.y = a.y + t * (b.y - a.y);\n        out.z = a.z + t * (b.z - a.z);\n        return out;\n    }\n\n    /**\n     * !#zh 生成一个在单位球体上均匀分布的随机向量\n     * !#en Generates a uniformly distributed random vectors on the unit sphere\n     * @method random\n     * @typescript\n     * random<Out extends IVec3Like> (out: Out, scale?: number)\n     * @param scale 生成的向量长度\n     * @static\n     */\n    static random<Out extends IVec3Like> (out: Out, scale?: number) {\n        scale = scale || 1.0;\n\n        const phi = random() * 2.0 * Math.PI;\n        const cosTheta = random() * 2 - 1;\n        const sinTheta = Math.sqrt(1 - cosTheta * cosTheta);\n\n        out.x = sinTheta * Math.cos(phi) * scale;\n        out.y = sinTheta * Math.sin(phi) * scale;\n        out.z = cosTheta * scale;\n        return out;\n    }\n\n    /**\n     * !#zh 向量与四维矩阵乘法，默认向量第四位为 1。\n     * !#en Four-dimensional vector and matrix multiplication, the default vectors fourth one.\n     * @method transformMat4\n     * @typescript\n     * transformMat4<Out extends IVec3Like, Vec3Like extends IVec3Like, MatLike extends IMat4Like> (out: Out, a: Vec3Like, mat: MatLike)\n     * @static\n     */\n    static transformMat4<Out extends IVec3Like, Vec3Like extends IVec3Like, MatLike extends IMat4Like> (out: Out, a: Vec3Like, mat: MatLike) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n        let m = mat.m;\n        let rhw = m[3] * _x + m[7] * _y + m[11] * _z + m[15];\n        rhw = rhw ? 1 / rhw : 1;\n        out.x = (m[0] * _x + m[4] * _y + m[8] * _z + m[12]) * rhw;\n        out.y = (m[1] * _x + m[5] * _y + m[9] * _z + m[13]) * rhw;\n        out.z = (m[2] * _x + m[6] * _y + m[10] * _z + m[14]) * rhw;\n        return out;\n    }\n\n    /**\n     * !#zh 向量与四维矩阵乘法，默认向量第四位为 0。\n     * !#en Four-dimensional vector and matrix multiplication, vector fourth default is 0.\n     * @method transformMat4Normal\n     * @typescript\n     * transformMat4Normal<Out extends IVec3Like, MatLike extends IMat4Like> (out: Out, a: Out, mat: MatLike)\n     * @static\n     */\n    static transformMat4Normal<Out extends IVec3Like, MatLike extends IMat4Like> (out: Out, a: Out, mat: MatLike) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n        let m = mat.m;\n        let rhw = m[3] * _x + m[7] * _y + m[11] * _z;\n        rhw = rhw ? 1 / rhw : 1;\n        out.x = (m[0] * _x + m[4] * _y + m[8] * _z) * rhw;\n        out.y = (m[1] * _x + m[5] * _y + m[9] * _z) * rhw;\n        out.z = (m[2] * _x + m[6] * _y + m[10] * _z) * rhw;\n        return out;\n    }\n\n    /**\n     * !#zh 向量与三维矩阵乘法\n     * !#en Dimensional vector matrix multiplication\n     * @method transformMat3\n     * @typescript\n     * transformMat3<Out extends IVec3Like, MatLike extends IMat3Like> (out: Out, a: Out, mat: MatLike)\n     * @static\n     */\n    static transformMat3<Out extends IVec3Like, MatLike extends IMat3Like> (out: Out, a: Out, mat: MatLike) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n        let m = mat.m;\n        out.x = _x * m[0] + _y * m[3] + _z * m[6];\n        out.y = _x * m[1] + _y * m[4] + _z * m[7];\n        out.z = _x * m[2] + _y * m[5] + _z * m[8];\n        return out;\n    }\n\n    /**\n     * !#zh 向量仿射变换\n     * !#en Affine transformation vector\n     * @static\n     */\n    static transformAffine<Out extends IVec3Like, VecLike extends IVec3Like, MatLike extends IMat4Like>\n        (out: Out, v: VecLike, mat: MatLike) {\n        _x = v.x;\n        _y = v.y;\n        _z = v.z;\n        let m = mat.m;\n        out.x = m[0] * _x + m[1] * _y + m[2] * _z + m[3];\n        out.y = m[4] * _x + m[5] * _y + m[6] * _z + m[7];\n        out.x = m[8] * _x + m[9] * _y + m[10] * _z + m[11];\n        return out;\n    }\n\n    /**\n     * !#zh 向量四元数乘法\n     * !#en Vector quaternion multiplication\n     * @method transformQuat\n     * @typescript\n     * transformQuat<Out extends IVec3Like, VecLike extends IVec3Like, QuatLike extends IQuatLike> (out: Out, a: VecLike, q: QuatLike)\n     * @static\n     */\n    static transformQuat<Out extends IVec3Like, VecLike extends IVec3Like, QuatLike extends IQuatLike> (out: Out, a: VecLike, q: QuatLike) {\n        // benchmarks: http://jsperf.com/quaternion-transform-Vec3-implementations\n\n        // calculate quat * vec\n        const ix = q.w * a.x + q.y * a.z - q.z * a.y;\n        const iy = q.w * a.y + q.z * a.x - q.x * a.z;\n        const iz = q.w * a.z + q.x * a.y - q.y * a.x;\n        const iw = -q.x * a.x - q.y * a.y - q.z * a.z;\n\n        // calculate result * inverse quat\n        out.x = ix * q.w + iw * -q.x + iy * -q.z - iz * -q.y;\n        out.y = iy * q.w + iw * -q.y + iz * -q.x - ix * -q.z;\n        out.z = iz * q.w + iw * -q.z + ix * -q.y - iy * -q.x;\n        return out;\n    }\n\n    /**\n     * !#zh 以缩放 -> 旋转 -> 平移顺序变换向量\n     * !#en To scale -> rotation -> transformation vector sequence translation\n     * @static\n     */\n    static transformRTS<Out extends IVec3Like, VecLike extends IVec3Like, QuatLike extends IQuatLike> (\n        out: Out, a: VecLike, r: QuatLike, t: VecLike, s: VecLike) {\n        const x = a.x * s.x;\n        const y = a.y * s.y;\n        const z = a.z * s.z;\n        const ix = r.w * x + r.y * z - r.z * y;\n        const iy = r.w * y + r.z * x - r.x * z;\n        const iz = r.w * z + r.x * y - r.y * x;\n        const iw = -r.x * x - r.y * y - r.z * z;\n        out.x = ix * r.w + iw * -r.x + iy * -r.z - iz * -r.y + t.x;\n        out.y = iy * r.w + iw * -r.y + iz * -r.x - ix * -r.z + t.y;\n        out.z = iz * r.w + iw * -r.z + ix * -r.y - iy * -r.x + t.z;\n        return out;\n    }\n\n    /**\n     * !#zh 以平移 -> 旋转 -> 缩放顺序逆变换向量\n     * !#en Translational -> rotation -> Zoom inverse transformation vector sequence\n     * @static\n     */\n    static transformInverseRTS<Out extends IVec3Like, VecLike extends IVec3Like, QuatLike extends IQuatLike> (\n        out: Out, a: VecLike, r: QuatLike, t: VecLike, s: VecLike) {\n        const x = a.x - t.x;\n        const y = a.y - t.y;\n        const z = a.z - t.z;\n        const ix = r.w * x - r.y * z + r.z * y;\n        const iy = r.w * y - r.z * x + r.x * z;\n        const iz = r.w * z - r.x * y + r.y * x;\n        const iw = r.x * x + r.y * y + r.z * z;\n        out.x = (ix * r.w + iw * r.x + iy * r.z - iz * r.y) / s.x;\n        out.y = (iy * r.w + iw * r.y + iz * r.x - ix * r.z) / s.y;\n        out.z = (iz * r.w + iw * r.z + ix * r.y - iy * r.x) / s.z;\n        return out;\n    }\n\n    /**\n     * !#zh 绕 X 轴旋转向量指定弧度\n     * !#en Rotation vector specified angle about the X axis\n     * @method rotateX\n     * @typescript\n     * rotateX<Out extends IVec3Like> (out: Out, v: Out, o: Out, a: number)\n     * @param v 待旋转向量\n     * @param o 旋转中心\n     * @param a 旋转弧度\n     * @static\n     */\n    static rotateX<Out extends IVec3Like> (out: Out, v: Out, o: Out, a: number) {\n        // Translate point to the origin\n        _x = v.x - o.x;\n        _y = v.y - o.y;\n        _z = v.z - o.z;\n\n        // perform rotation\n        const cos = Math.cos(a);\n        const sin = Math.sin(a);\n        const rx = _x;\n        const ry = _y * cos - _z * sin;\n        const rz = _y * sin + _z * cos;\n\n        // translate to correct position\n        out.x = rx + o.x;\n        out.y = ry + o.y;\n        out.z = rz + o.z;\n\n        return out;\n    }\n\n    /**\n     * !#zh 绕 Y 轴旋转向量指定弧度\n     * !#en Rotation vector specified angle around the Y axis\n     * @method rotateY\n     * @typescript\n     * rotateY<Out extends IVec3Like> (out: Out, v: Out, o: Out, a: number)\n     * @param v 待旋转向量\n     * @param o 旋转中心\n     * @param a 旋转弧度\n     * @static\n     */\n    static rotateY<Out extends IVec3Like> (out: Out, v: Out, o: Out, a: number) {\n        // Translate point to the origin\n        _x = v.x - o.x;\n        _y = v.y - o.y;\n        _z = v.z - o.z;\n\n        // perform rotation\n        const cos = Math.cos(a);\n        const sin = Math.sin(a);\n        const rx = _z * sin + _x * cos;\n        const ry = _y;\n        const rz = _z * cos - _x * sin;\n\n        // translate to correct position\n        out.x = rx + o.x;\n        out.y = ry + o.y;\n        out.z = rz + o.z;\n\n        return out;\n    }\n\n    /**\n     * !#zh 绕 Z 轴旋转向量指定弧度\n     * !#en Around the Z axis specified angle vector\n     * @method rotateZ\n     * @typescript\n     * rotateZ<Out extends IVec3Like> (out: Out, v: Out, o: Out, a: number)\n     * @param v 待旋转向量\n     * @param o 旋转中心\n     * @param a 旋转弧度\n     * @static\n     */\n    static rotateZ<Out extends IVec3Like> (out: Out, v: Out, o: Out, a: number) {\n        // Translate point to the origin\n        _x = v.x - o.x;\n        _y = v.y - o.y;\n        _z = v.z - o.z;\n\n        // perform rotation\n        const cos = Math.cos(a);\n        const sin = Math.sin(a);\n        const rx = _x * cos - _y * sin;\n        const ry = _x * sin + _y * cos;\n        const rz = _z;\n\n        // translate to correct position\n        out.x = rx + o.x;\n        out.y = ry + o.y;\n        out.z = rz + o.z;\n\n        return out;\n    }\n\n    /**\n     * !#zh 向量等价判断\n     * !#en Equivalent vectors Analyzing\n     * @method strictEquals\n     * @typescript\n     * strictEquals<Out extends IVec3Like> (a: Out, b: Out)\n     * @static\n     */\n    static strictEquals<Out extends IVec3Like> (a: Out, b: Out) {\n        return a.x === b.x && a.y === b.y && a.z === b.z;\n    }\n\n    /**\n     * !#zh 排除浮点数误差的向量近似等价判断\n     * !#en Negative error vector floating point approximately equivalent Analyzing\n     * @method equals\n     * @typescript\n     * equals<Out extends IVec3Like> (a: Out, b: Out, epsilon = EPSILON)\n     * @static\n     */\n    static equals<Out extends IVec3Like> (a: Out, b: Out, epsilon = EPSILON) {\n        const { x: a0, y: a1, z: a2 } = a;\n        const { x: b0, y: b1, z: b2 } = b;\n        return (\n            Math.abs(a0 - b0) <=\n            epsilon * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <=\n            epsilon * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <=\n            epsilon * Math.max(1.0, Math.abs(a2), Math.abs(b2))\n        );\n    }\n\n    /**\n     * !#zh 求两向量夹角弧度\n     * !#en Radian angle between two vectors seek\n     * @method angle\n     * @typescript\n     * angle<Out extends IVec3Like> (a: Out, b: Out)\n     * @static\n     */\n    static angle<Out extends IVec3Like> (a: Out, b: Out) {\n        Vec3.normalize(v3_1, a);\n        Vec3.normalize(v3_2, b);\n        const cosine = Vec3.dot(v3_1, v3_2);\n        if (cosine > 1.0) {\n            return 0;\n        }\n        if (cosine < -1.0) {\n            return Math.PI;\n        }\n        return Math.acos(cosine);\n    }\n\n    /**\n     * !#zh 计算向量在指定平面上的投影\n     * !#en Calculating a projection vector in the specified plane\n     * @method projectOnPlane\n     * @typescript\n     * projectOnPlane<Out extends IVec3Like> (out: Out, a: Out, n: Out)\n     * @param a 待投影向量\n     * @param n 指定平面的法线\n     * @static\n     */\n    static projectOnPlane<Out extends IVec3Like> (out: Out, a: Out, n: Out) {\n        return Vec3.subtract(out, a, Vec3.project(out, a, n));\n    }\n\n    /**\n     * !#zh 计算向量在指定向量上的投影\n     * !#en Projection vector calculated in the vector designated\n     * @method project\n     * @typescript\n     * project<Out extends IVec3Like> (out: Out, a: Out, b: Out)\n     * @param a 待投影向量\n     * @param n 目标向量\n     * @static\n     */\n    static project<Out extends IVec3Like> (out: Out, a: Out, b: Out) {\n        const sqrLen = Vec3.lengthSqr(b);\n        if (sqrLen < 0.000001) {\n            return Vec3.set(out, 0, 0, 0);\n        } else {\n            return Vec3.multiplyScalar(out, b, Vec3.dot(a, b) / sqrLen);\n        }\n    }\n\n    /**\n     * !#zh 向量转数组\n     * !#en Vector transfer array\n     * @method toArray\n     * @typescript\n     * toArray <Out extends IWritableArrayLike<number>> (out: Out, v: IVec3Like, ofs = 0)\n     * @param ofs 数组起始偏移量\n     * @static\n     */\n    static toArray <Out extends IWritableArrayLike<number>> (out: Out, v: IVec3Like, ofs = 0) {\n        out[ofs + 0] = v.x;\n        out[ofs + 1] = v.y;\n        out[ofs + 2] = v.z;\n\n        return out;\n    }\n\n    /**\n     * !#zh 数组转向量\n     * !#en Array steering amount\n     * @method fromArray\n     * @typescript\n     * fromArray <Out extends IVec3Like> (out: Out, arr: IWritableArrayLike<number>, ofs = 0)\n     * @param ofs 数组起始偏移量\n     * @static\n     */\n    static fromArray <Out extends IVec3Like> (out: Out, arr: IWritableArrayLike<number>, ofs = 0) {\n        out.x = arr[ofs + 0];\n        out.y = arr[ofs + 1];\n        out.z = arr[ofs + 2];\n        return out;\n    }\n\n\n    /**\n     * @property {Number} x\n     */\n    x: number;\n    /**\n     * @property {Number} y\n     */\n    y: number;\n    /**\n     * @property {Number} z\n     */\n    z: number;\n\n\n    /**\n     * !#en\n     * Constructor\n     * see {{#crossLink \"cc/vec3:method\"}}cc.v3{{/crossLink}}\n     * !#zh\n     * 构造函数，可查看 {{#crossLink \"cc/vec3:method\"}}cc.v3{{/crossLink}}\n     * @method constructor\n     * @param {Vec3|number} [x=0]\n     * @param {number} [y=0]\n     * @param {number} [z=0]\n     */\n    constructor (x: Vec3 | number = 0, y: number = 0, z: number = 0) {\n        super();\n        if (x && typeof x === 'object') {\n            this.z = x.z;\n            this.y = x.y;\n            this.x = x.x;\n        }\n        else {\n            this.x = x as number;\n            this.y = y;\n            this.z = z;\n        }\n    }\n\n    /**\n     * !#en clone a Vec3 value\n     * !#zh 克隆一个 Vec3 值\n     * @method clone\n     * @return {Vec3}\n     */\n    clone (): Vec3 {\n        return new Vec3(this.x, this.y, this.z);\n    }\n\n    /**\n     * !#en Set the current vector value with the given vector.\n     * !#zh 用另一个向量设置当前的向量对象值。\n     * @method set\n     * @param {Vec3} newValue - !#en new value to set. !#zh 要设置的新值\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    set (newValue: Vec3): Vec3 {\n        this.x = newValue.x;\n        this.y = newValue.y;\n        this.z = newValue.z;\n        return this;\n    }\n\n    /**\n     * !#en Check whether the vector equals another one\n     * !#zh 当前的向量是否与指定的向量相等。\n     * @method equals\n     * @param {Vec3} other\n     * @return {Boolean}\n     */\n    equals (other: Vec3): boolean {\n        return other && this.x === other.x && this.y === other.y && this.z === other.z;\n    }\n\n\n    /**\n     * !#en Check whether two vector equal with some degree of variance.\n     * !#zh\n     * 近似判断两个点是否相等。<br/>\n     * 判断 2 个向量是否在指定数值的范围之内，如果在则返回 true，反之则返回 false。\n     * @method fuzzyEquals\n     * @param {Vec3} other\n     * @param {Number} variance\n     * @return {Boolean}\n     */\n    fuzzyEquals (other: Vec3, variance: number): boolean {\n        if (this.x - variance <= other.x && other.x <= this.x + variance) {\n            if (this.y - variance <= other.y && other.y <= this.y + variance) {\n                if (this.z - variance <= other.z && other.z <= this.z + variance)\n                    return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * !#en Transform to string with vector informations\n     * !#zh 转换为方便阅读的字符串。\n     * @method toString\n     * @return {string}\n     */\n    toString (): string {\n        return \"(\" +\n            this.x.toFixed(2) + \", \" +\n            this.y.toFixed(2) + \", \" +\n            this.z.toFixed(2) + \")\"\n            ;\n    }\n\n    /**\n     * !#en Calculate linear interpolation result between this vector and another one with given ratio\n     * !#zh 线性插值。\n     * @method lerp\n     * @param {Vec3} to\n     * @param {number} ratio - the interpolation coefficient\n     * @param {Vec3} [out] - optional, the receiving vector, you can pass the same vec3 to save result to itself, if not provided, a new vec3 will be created\n     * @return {Vec3}\n     */\n    lerp (to: Vec3, ratio: number, out?: Vec3): Vec3 {\n        out = out || new Vec3();\n        Vec3.lerp(out, this, to, ratio);\n        return out;\n    }\n\n    /**\n     * !#en Clamp the vector between from float and to float.\n     * !#zh\n     * 返回指定限制区域后的向量。<br/>\n     * 向量大于 max_inclusive 则返回 max_inclusive。<br/>\n     * 向量小于 min_inclusive 则返回 min_inclusive。<br/>\n     * 否则返回自身。\n     * @method clampf\n     * @param {Vec3} min_inclusive\n     * @param {Vec3} max_inclusive\n     * @return {Vec3}\n     */\n    clampf (min_inclusive: Vec3, max_inclusive: Vec3): Vec3 {\n        this.x = misc.clampf(this.x, min_inclusive.x, max_inclusive.x);\n        this.y = misc.clampf(this.y, min_inclusive.y, max_inclusive.y);\n        this.z = misc.clampf(this.z, min_inclusive.z, max_inclusive.z);\n        return this;\n    }\n\n    /**\n     * !#en Adds this vector. If you want to save result to another vector, use add() instead.\n     * !#zh 向量加法。如果你想保存结果到另一个向量，使用 add() 代替。\n     * @method addSelf\n     * @param {Vec3} vector\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    addSelf (vector: Vec3): this {\n        this.x += vector.x;\n        this.y += vector.y;\n        this.z += vector.z;\n        return this;\n    }\n\n    /**\n     * !#en Adds two vectors, and returns the new result.\n     * !#zh 向量加法，并返回新结果。\n     * @method add\n     * @param {Vec3} vector\n     * @param {Vec3} [out] - optional, the receiving vector, you can pass the same vec3 to save result to itself, if not provided, a new vec3 will be created\n     * @return {Vec3} the result\n     */\n    add (vector: Vec3, out?: Vec3): Vec3 {\n        out = out || new Vec3();\n        out.x = this.x + vector.x;\n        out.y = this.y + vector.y;\n        out.z = this.z + vector.z;\n        return out;\n    }\n\n    /**\n     * !#en Subtracts one vector from this.\n     * !#zh 向量减法。\n     * @method subtract\n     * @param {Vec3} vector\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    subtract (vector: Vec3): Vec3 {\n        this.x -= vector.x;\n        this.y -= vector.y;\n        this.z -= vector.z;\n        return this;\n    }\n\n    /**\n     * !#en Multiplies this by a number.\n     * !#zh 缩放当前向量。\n     * @method multiplyScalar\n     * @param {number} num\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    multiplyScalar (num: number): Vec3 {\n        this.x *= num;\n        this.y *= num;\n        this.z *= num;\n        return this;\n    }\n\n    /**\n     * !#en Multiplies two vectors.\n     * !#zh 分量相乘。\n     * @method multiply\n     * @param {Vec3} vector\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    multiply (vector: Vec3): Vec3 {\n        this.x *= vector.x;\n        this.y *= vector.y;\n        this.z *= vector.z;\n        return this;\n    }\n\n    /**\n     * !#en Divides by a number.\n     * !#zh 向量除法。\n     * @method divide\n     * @param {number} num\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    divide (num: number): Vec3 {\n        this.x /= num;\n        this.y /= num;\n        this.z /= num;\n        return this;\n    }\n\n    /**\n     * !#en Negates the components.\n     * !#zh 向量取反。\n     * @method negate\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    negate (): this {\n        this.x = -this.x;\n        this.y = -this.y;\n        this.z = -this.z;\n        return this;\n    }\n\n    /**\n     * !#en Dot product\n     * !#zh 当前向量与指定向量进行点乘。\n     * @method dot\n     * @param {Vec3} [vector]\n     * @return {number} the result\n     */\n    dot (vector: Vec3): number {\n        return this.x * vector.x + this.y * vector.y + this.z * vector.z;\n    }\n\n    /**\n     * !#en Cross product\n     * !#zh 当前向量与指定向量进行叉乘。\n     * @method cross\n     * @param {Vec3} vector\n     * @param {Vec3} [out]\n     * @return {Vec3} the result\n     */\n    cross (vector: Vec3, out?: Vec3): Vec3 {\n        out = out || new Vec3();\n        Vec3.cross(out, this, vector)\n        return out;\n    }\n\n    /**\n     * !#en Returns the length of this vector.\n     * !#zh 返回该向量的长度。\n     * @method len\n     * @return {number} the result\n     * @example\n     * var v = cc.v3(10, 10, 10);\n     * v.len(); // return 17.320508075688775;\n     */\n    len (): number {\n        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n    }\n\n    /**\n     * !#en Returns the squared length of this vector.\n     * !#zh 返回该向量的长度平方。\n     * @method lengthSqr\n     * @return {number} the result\n     */\n    lengthSqr (): number {\n        return this.x * this.x + this.y * this.y + this.z * this.z;\n    }\n\n    /**\n     * !#en Make the length of this vector to 1.\n     * !#zh 向量归一化，让这个向量的长度为 1。\n     * @method normalizeSelf\n     * @return {Vec3} returns this\n     * @chainable\n     */\n    normalizeSelf (): Vec3 {\n        Vec3.normalize(this, this);\n        return this;\n    };\n\n    /**\n     * !#en\n     * Returns this vector with a magnitude of 1.<br/>\n     * <br/>\n     * Note that the current vector is unchanged and a new normalized vector is returned. If you want to normalize the current vector, use normalizeSelf function.\n     * !#zh\n     * 返回归一化后的向量。<br/>\n     * <br/>\n     * 注意，当前向量不变，并返回一个新的归一化向量。如果你想来归一化当前向量，可使用 normalizeSelf 函数。\n     * @method normalize\n     * @param {Vec3} [out] - optional, the receiving vector, you can pass the same vec3 to save result to itself, if not provided, a new vec3 will be created\n     * @return {Vec3} result\n     */\n    normalize (out?: Vec3): Vec3 {\n        out = out || new Vec3();\n        Vec3.normalize(out, this);\n        return out;\n    }\n\n    /**\n     * Transforms the vec3 with a mat4. 4th vector component is implicitly '1'\n     * @method transformMat4\n     * @param {Mat4} m matrix to transform with\n     * @param {Vec3} [out] the receiving vector, you can pass the same vec3 to save result to itself, if not provided, a new vec3 will be created\n     * @returns {Vec3} out\n     */\n    transformMat4 (m: Mat4, out?: Vec3): Vec3 {\n        out = out || new Vec3();\n        Vec3.transformMat4(out, this, m);\n        return out;\n    }\n\n    /**\n     * Returns the maximum value in x, y, and z\n     * @method maxAxis\n     * @returns {number}\n     */\n    maxAxis (): number {\n       return Math.max(this.x, this.y, this.z);\n    }\n\n    /**\n     * !#en Get angle in radian between this and vector.\n     * !#zh 夹角的弧度。\n     * @method angle\n     * @param {Vec3} vector\n     * @return {number} from 0 to Math.PI\n     */\n    angle = Vec2.prototype.angle\n    /**\n     * !#en Calculates the projection of the current vector over the given vector.\n     * !#zh 返回当前向量在指定 vector 向量上的投影向量。\n     * @method project\n     * @param {Vec3} vector\n     * @return {Vec3}\n     * @example\n     * var v1 = cc.v3(20, 20, 20);\n     * var v2 = cc.v3(5, 5, 5);\n     * v1.project(v2); // Vec3 {x: 20, y: 20, z: 20};\n     */\n    project = Vec2.prototype.project\n    // Compatible with the vec2 API\n\n    /**\n     * !#en Get angle in radian between this and vector with direction. <br/>\n     * In order to compatible with the vec2 API.\n     * !#zh 带方向的夹角的弧度。该方法仅用做兼容 2D 计算。\n     * @method signAngle\n     * @param {Vec3 | Vec2} vector\n     * @return {number} from -MathPI to Math.PI\n     * @deprecated\n     */\n    signAngle (vector) {\n        cc.warnID(1408, 'vec3.signAngle', 'v2.1', 'cc.v2(selfVector).signAngle(vector)');\n        let vec1 = new Vec2(this.x, this.y);\n        let vec2 = new Vec2(vector.x, vector.y);\n        return vec1.signAngle(vec2);\n    }\n\n    /**\n     * !#en rotate. In order to compatible with the vec2 API.\n     * !#zh 返回旋转给定弧度后的新向量。该方法仅用做兼容 2D 计算。\n     * @method rotate\n     * @param {number} radians\n     * @param {Vec3} [out] - optional, the receiving vector, you can pass the same vec2 to save result to itself, if not provided, a new vec2 will be created\n     * @return {Vec2 | Vec3} if the 'out' value is a vec3 you will get a Vec3 return. \n     * @deprecated\n     */\n    rotate (radians, out) {\n        cc.warnID(1408, 'vec3.rotate', 'v2.1', 'cc.v2(selfVector).rotate(radians, out)');\n        return Vec2.prototype.rotate.call(this, radians, out);\n    }\n\n    /**\n     * !#en rotate self. In order to compatible with the vec2 API.\n     * !#zh 按指定弧度旋转向量。该方法仅用做兼容 2D 计算。\n     * @method rotateSelf\n     * @param {number} radians\n     * @return {Vec3} returns this\n     * @chainable\n     * @deprecated\n     */\n    rotateSelf (radians) {\n        cc.warnID(1408, 'vec3.rotateSelf', 'v2.1', 'cc.v2(selfVector).rotateSelf(radians)');\n        return Vec2.prototype.rotateSelf.call(this, radians);\n    }\n}\n\nconst v3_1 = new Vec3();\nconst v3_2 = new Vec3();\n\nCCClass.fastDefine('cc.Vec3', Vec3, { x: 0, y: 0, z: 0 });\n\n/**\n * @module cc\n */\n\n/**\n * !#en The convenience method to create a new {{#crossLink \"Vec3\"}}cc.Vec3{{/crossLink}}.\n * !#zh 通过该简便的函数进行创建 {{#crossLink \"Vec3\"}}cc.Vec3{{/crossLink}} 对象。\n * @method v3\n * @param {Number|Object} [x=0]\n * @param {Number} [y=0]\n * @param {Number} [z=0]\n * @return {Vec3}\n * @example\n * var v1 = cc.v3();\n * var v2 = cc.v3(0, 0, 0);\n * var v3 = cc.v3(v2);\n * var v4 = cc.v3({x: 100, y: 100, z: 0});\n */\ncc.v3 = function v3 (x, y, z) {\n    return new Vec3(x, y, z);\n};\n\ncc.Vec3 = Vec3;\n","/*\n Copyright (c) 2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n http://www.cocos.com\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n*/\n\nimport CCClass from '../platform/CCClass';\nimport ValueType from './value-type';\nimport Mat4 from './mat4';\nimport { clamp, EPSILON, random } from './utils';\n\nlet _x: number = 0.0;\nlet _y: number = 0.0;\nlet _z: number = 0.0;\nlet _w: number = 0.0;\n\n/**\n * !#en Representation of 3D vectors and points.\n * !#zh 表示 3D 向量和坐标\n *\n * @class Vec4\n * @extends ValueType\n */\nexport default class Vec4 extends ValueType {\n    // deprecated\n    public static sub   = Vec4.subtract;\n    public static mul   = Vec4.multiply;\n    public static div = Vec4.divide;\n    public static scale = Vec4.multiplyScalar;\n    public static mag   = Vec4.len;\n    public static squaredMagnitude = Vec4.lengthSqr;\n    mag  = Vec4.prototype.len;\n    magSqr = Vec4.prototype.lengthSqr;\n    /**\n     * !#en Subtracts one vector from this. If you want to save result to another vector, use sub() instead.\n     * !#zh 向量减法。如果你想保存结果到另一个向量，可使用 sub() 代替。\n     * @method subSelf\n     * @param {Vec4} vector\n     * @return {Vec4} returns this\n     * @chainable\n     */\n    subSelf  = Vec4.prototype.subtract;\n    /**\n     * !#en Subtracts one vector from this, and returns the new result.\n     * !#zh 向量减法，并返回新结果。\n     * @method sub\n     * @param {Vec4} vector\n     * @param {Vec4} [out] - optional, the receiving vector, you can pass the same vec4 to save result to itself, if not provided, a new vec4 will be created\n     * @return {Vec4} the result\n     */\n    sub (vector: Vec4, out?: Vec4) {\n        return Vec4.subtract(out || new Vec4(), this, vector);\n    }\n    /**\n     * !#en Multiplies this by a number. If you want to save result to another vector, use mul() instead.\n     * !#zh 缩放当前向量。如果你想结果保存到另一个向量，可使用 mul() 代替。\n     * @method mulSelf\n     * @param {number} num\n     * @return {Vec4} returns this\n     * @chainable\n     */\n    mulSelf  = Vec4.prototype.multiplyScalar;\n    /**\n     * !#en Multiplies by a number, and returns the new result.\n     * !#zh 缩放向量，并返回新结果。\n     * @method mul\n     * @param {number} num\n     * @param {Vec4} [out] - optional, the receiving vector, you can pass the same vec4 to save result to itself, if not provided, a new vec4 will be created\n     * @return {Vec4} the result\n     */\n    mul (num: number, out?: Vec4) {\n        return Vec4.multiplyScalar(out || new Vec4(), this, num);\n    }\n    /**\n     * !#en Divides by a number. If you want to save result to another vector, use div() instead.\n     * !#zh 向量除法。如果你想结果保存到另一个向量，可使用 div() 代替。\n     * @method divSelf\n     * @param {number} num\n     * @return {Vec4} returns this\n     * @chainable\n     */\n    divSelf  = Vec4.prototype.divide;\n    /**\n     * !#en Divides by a number, and returns the new result.\n     * !#zh 向量除法，并返回新的结果。\n     * @method div\n     * @param {number} num\n     * @param {Vec4} [out] - optional, the receiving vector, you can pass the same vec4 to save result to itself, if not provided, a new vec4 will be created\n     * @return {Vec4} the result\n     */\n    div (num: number, out?: Vec4): Vec4 {\n        return Vec4.multiplyScalar(out || new Vec4(), this, 1/num);\n    }\n    /**\n     * !#en Multiplies two vectors.\n     * !#zh 分量相乘。\n     * @method scaleSelf\n     * @param {Vec4} vector\n     * @return {Vec4} returns this\n     * @chainable\n     */\n    scaleSelf = Vec4.prototype.multiply;\n    /**\n     * !#en Multiplies two vectors, and returns the new result.\n     * !#zh 分量相乘，并返回新的结果。\n     * @method scale\n     * @param {Vec4} vector\n     * @param {Vec4} [out] - optional, the receiving vector, you can pass the same vec4 to save result to itself, if not provided, a new vec4 will be created\n     * @return {Vec4} the result\n     */\n    scale (vector: Vec4, out?: Vec4) {\n        return Vec4.multiply(out || new Vec4(), this, vector);\n    }\n    /**\n     * !#en Negates the components. If you want to save result to another vector, use neg() instead.\n     * !#zh 向量取反。如果你想结果保存到另一个向量，可使用 neg() 代替。\n     * @method negSelf\n     * @return {Vec4} returns this\n     * @chainable\n     */\n    negSelf = Vec4.prototype.negate;\n    /**\n     * !#en Negates the components, and returns the new result.\n     * !#zh 返回取反后的新向量。\n     * @method neg\n     * @param {Vec4} [out] - optional, the receiving vector, you can pass the same vec4 to save result to itself, if not provided, a new vec4 will be created\n     * @return {Vec4} the result\n     */\n    neg (out?: Vec4) {\n        return Vec4.negate(out || new Vec4(), this);\n    }\n\n    public static get ZERO () { return new Vec4(0, 0, 0, 0); }\n    public static readonly ZERO_R = Vec4.ZERO;\n\n    public static get ONE () { return new Vec4(1, 1, 1, 1); }\n    public static readonly ONE_R = Vec4.ONE;\n\n    public static get NEG_ONE () { return new Vec4(-1, -1, -1, -1); }\n    public static readonly NEG_ONE_R = Vec4.NEG_ONE;\n\n    /**\n     * !#zh 获得指定向量的拷贝\n     * !#en Obtaining copy vectors designated\n     * @method clone\n     * @typescript\n     * clone <Out extends IVec4Like> (a: Out)\n     * @static\n     */\n    public static clone <Out extends IVec4Like> (a: Out) {\n        return new Vec4(a.x, a.y, a.z, a.w);\n    }\n\n    /**\n     * !#zh 复制目标向量\n     * !#en Copy the target vector\n     * @method copy\n     * @typescript\n     * copy <Out extends IVec4Like> (out: Out, a: Out)\n     * @static\n     */\n    public static copy <Out extends IVec4Like> (out: Out, a: Out) {\n        out.x = a.x;\n        out.y = a.y;\n        out.z = a.z;\n        out.w = a.w;\n        return out;\n    }\n\n    /**\n     * !#zh 设置向量值\n     * !#en Set to value\n     * @method set\n     * @typescript\n     * set <Out extends IVec4Like> (out: Out, x: number, y: number, z: number, w: number)\n     * @static\n     */\n    public static set <Out extends IVec4Like> (out: Out, x: number, y: number, z: number, w: number) {\n        out.x = x;\n        out.y = y;\n        out.z = z;\n        out.w = w;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量加法\n     * !#en Element-wise vector addition\n     * @method add\n     * @typescript\n     * add <Out extends IVec4Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    public static add <Out extends IVec4Like> (out: Out, a: Out, b: Out) {\n        out.x = a.x + b.x;\n        out.y = a.y + b.y;\n        out.z = a.z + b.z;\n        out.w = a.w + b.w;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量减法\n     * !#en Element-wise vector subtraction\n     * @method subtract\n     * @typescript\n     * subtract <Out extends IVec4Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    public static subtract <Out extends IVec4Like> (out: Out, a: Out, b: Out) {\n        out.x = a.x - b.x;\n        out.y = a.y - b.y;\n        out.z = a.z - b.z;\n        out.w = a.w - b.w;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量乘法\n     * !#en Element-wise vector multiplication\n     * @method multiply\n     * @typescript\n     * multiply <Out extends IVec4Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    public static multiply <Out extends IVec4Like> (out: Out, a: Out, b: Out) {\n        out.x = a.x * b.x;\n        out.y = a.y * b.y;\n        out.z = a.z * b.z;\n        out.w = a.w * b.w;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量除法\n     * !#en Element-wise vector division\n     * @method divide\n     * @typescript\n     * divide <Out extends IVec4Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    public static divide <Out extends IVec4Like> (out: Out, a: Out, b: Out) {\n        out.x = a.x / b.x;\n        out.y = a.y / b.y;\n        out.z = a.z / b.z;\n        out.w = a.w / b.w;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量向上取整\n     * !#en Rounding up by elements of the vector\n     * @method ceil\n     * @typescript\n     * ceil <Out extends IVec4Like> (out: Out, a: Out)\n     * @static\n     */\n    public static ceil <Out extends IVec4Like> (out: Out, a: Out) {\n        out.x = Math.ceil(a.x);\n        out.y = Math.ceil(a.y);\n        out.z = Math.ceil(a.z);\n        out.w = Math.ceil(a.w);\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量向下取整\n     * !#en Element vector by rounding down\n     * @method floor\n     * @typescript\n     * floor <Out extends IVec4Like> (out: Out, a: Out)\n     * @static\n     */\n    public static floor <Out extends IVec4Like> (out: Out, a: Out) {\n        out.x = Math.floor(a.x);\n        out.y = Math.floor(a.y);\n        out.z = Math.floor(a.z);\n        out.w = Math.floor(a.w);\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量最小值\n     * !#en The minimum by-element vector\n     * @method min\n     * @typescript\n     * min <Out extends IVec4Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    public static min <Out extends IVec4Like> (out: Out, a: Out, b: Out) {\n        out.x = Math.min(a.x, b.x);\n        out.y = Math.min(a.y, b.y);\n        out.z = Math.min(a.z, b.z);\n        out.w = Math.min(a.w, b.w);\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量最大值\n     * !#en The maximum value of the element-wise vector\n     * @method max\n     * @typescript\n     * max <Out extends IVec4Like> (out: Out, a: Out, b: Out)\n     * @static\n     */\n    public static max <Out extends IVec4Like> (out: Out, a: Out, b: Out) {\n        out.x = Math.max(a.x, b.x);\n        out.y = Math.max(a.y, b.y);\n        out.z = Math.max(a.z, b.z);\n        out.w = Math.max(a.w, b.w);\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量四舍五入取整\n     * !#en Element-wise vector of rounding to whole\n     * @method round\n     * @typescript\n     * round <Out extends IVec4Like> (out: Out, a: Out)\n     * @static\n     */\n    public static round <Out extends IVec4Like> (out: Out, a: Out) {\n        out.x = Math.round(a.x);\n        out.y = Math.round(a.y);\n        out.z = Math.round(a.z);\n        out.w = Math.round(a.w);\n        return out;\n    }\n\n    /**\n     * !#zh 向量标量乘法\n     * !#en Vector scalar multiplication\n     * @method multiplyScalar\n     * @typescript\n     * multiplyScalar <Out extends IVec4Like> (out: Out, a: Out, b: number)\n     * @static\n     */\n    public static multiplyScalar <Out extends IVec4Like> (out: Out, a: Out, b: number) {\n        out.x = a.x * b;\n        out.y = a.y * b;\n        out.z = a.z * b;\n        out.w = a.w * b;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量乘加: A + B * scale\n     * !#en Element-wise vector multiply add: A + B * scale\n     * @method scaleAndAdd\n     * @typescript\n     * scaleAndAdd <Out extends IVec4Like> (out: Out, a: Out, b: Out, scale: number)\n     * @static\n     */\n    public static scaleAndAdd <Out extends IVec4Like> (out: Out, a: Out, b: Out, scale: number) {\n        out.x = a.x + (b.x * scale);\n        out.y = a.y + (b.y * scale);\n        out.z = a.z + (b.z * scale);\n        out.w = a.w + (b.w * scale);\n        return out;\n    }\n\n    /**\n     * !#zh 求两向量的欧氏距离\n     * !#en Seeking two vectors Euclidean distance\n     * @method distance\n     * @typescript\n     * distance <Out extends IVec4Like> (a: Out, b: Out)\n     * @static\n     */\n    public static distance <Out extends IVec4Like> (a: Out, b: Out) {\n        const x = b.x - a.x;\n        const y = b.y - a.y;\n        const z = b.z - a.z;\n        const w = b.w - a.w;\n        return Math.sqrt(x * x + y * y + z * z + w * w);\n    }\n\n    /**\n     * !#zh 求两向量的欧氏距离平方\n     * !#en Euclidean distance squared seeking two vectors\n     * @method squaredDistance\n     * @typescript\n     * squaredDistance <Out extends IVec4Like> (a: Out, b: Out)\n     * @static\n     */\n    public static squaredDistance <Out extends IVec4Like> (a: Out, b: Out) {\n        const x = b.x - a.x;\n        const y = b.y - a.y;\n        const z = b.z - a.z;\n        const w = b.w - a.w;\n        return x * x + y * y + z * z + w * w;\n    }\n\n    /**\n     * !#zh 求向量长度\n     * !#en Seeking vector length\n     * @method len\n     * @typescript\n     * len <Out extends IVec4Like> (a: Out)\n     * @static\n     */\n    public static len <Out extends IVec4Like> (a: Out) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n        _w = a.w;\n        return Math.sqrt(_x * _x + _y * _y + _z * _z + _w * _w);\n    }\n\n    /**\n     * !#zh 求向量长度平方\n     * !#en Seeking squared vector length\n     * @method lengthSqr\n     * @typescript\n     * lengthSqr <Out extends IVec4Like> (a: Out)\n     * @static\n     */\n    public static lengthSqr <Out extends IVec4Like> (a: Out) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n        _w = a.w;\n        return _x * _x + _y * _y + _z * _z + _w * _w;\n    }\n\n    /**\n     * !#zh 逐元素向量取负\n     * !#en By taking the negative elements of the vector\n     * @method negate\n     * @typescript\n     * negate <Out extends IVec4Like> (out: Out, a: Out)\n     * @static\n     */\n    public static negate <Out extends IVec4Like> (out: Out, a: Out) {\n        out.x = -a.x;\n        out.y = -a.y;\n        out.z = -a.z;\n        out.w = -a.w;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量取倒数，接近 0 时返回 Infinity\n     * !#en Element vector by taking the inverse, return near 0 Infinity\n     * @method inverse\n     * @typescript\n     * inverse <Out extends IVec4Like> (out: Out, a: Out)\n     * @static\n     */\n    public static inverse <Out extends IVec4Like> (out: Out, a: Out) {\n        out.x = 1.0 / a.x;\n        out.y = 1.0 / a.y;\n        out.z = 1.0 / a.z;\n        out.w = 1.0 / a.w;\n        return out;\n    }\n\n    /**\n     * !#zh 逐元素向量取倒数，接近 0 时返回 0\n     * !#en Element vector by taking the inverse, return near 0 0\n     * @method inverseSafe\n     * @typescript\n     * inverseSafe <Out extends IVec4Like> (out: Out, a: Out)\n     * @static\n     */\n    public static inverseSafe <Out extends IVec4Like> (out: Out, a: Out) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n        _w = a.w;\n\n        if (Math.abs(_x) < EPSILON) {\n            out.x = 0;\n        } else {\n            out.x = 1.0 / _x;\n        }\n\n        if (Math.abs(_y) < EPSILON) {\n            out.y = 0;\n        } else {\n            out.y = 1.0 / _y;\n        }\n\n        if (Math.abs(_z) < EPSILON) {\n            out.z = 0;\n        } else {\n            out.z = 1.0 / _z;\n        }\n\n        if (Math.abs(_w) < EPSILON) {\n            out.w = 0;\n        } else {\n            out.w = 1.0 / _w;\n        }\n\n        return out;\n    }\n\n    /**\n     * !#zh 归一化向量\n     * !#en Normalized vector\n     * @method normalize\n     * @typescript\n     * normalize <Out extends IVec4Like> (out: Out, a: Out)\n     * @static\n     */\n    public static normalize <Out extends IVec4Like> (out: Out, a: Out) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n        _w = a.w;\n        let len = _x * _x + _y * _y + _z * _z + _w * _w;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n            out.x = _x * len;\n            out.y = _y * len;\n            out.z = _z * len;\n            out.w = _w * len;\n        }\n        return out;\n    }\n\n    /**\n     * !#zh 向量点积（数量积）\n     * !#en Vector dot product (scalar product)\n     * @method dot\n     * @typescript\n     * dot <Out extends IVec4Like> (a: Out, b: Out)\n     * @static\n     */\n    public static dot <Out extends IVec4Like> (a: Out, b: Out) {\n        return a.x * b.x + a.y * b.y + a.z * b.z + a.w * b.w;\n    }\n\n    /**\n     * !#zh 逐元素向量线性插值： A + t * (B - A)\n     * !#en Vector element by element linear interpolation: A + t * (B - A)\n     * @method lerp\n     * @typescript\n     * lerp <Out extends IVec4Like> (out: Out, a: Out, b: Out, t: number)\n     * @static\n     */\n    public static lerp <Out extends IVec4Like> (out: Out, a: Out, b: Out, t: number) {\n        out.x = a.x + t * (b.x - a.x);\n        out.y = a.y + t * (b.y - a.y);\n        out.z = a.z + t * (b.z - a.z);\n        out.w = a.w + t * (b.w - a.w);\n        return out;\n    }\n\n    /**\n     * !#zh 生成一个在单位球体上均匀分布的随机向量\n     * !#en Generates a uniformly distributed random vectors on the unit sphere\n     * @method random\n     * @typescript\n     * random <Out extends IVec4Like> (out: Out, scale?: number)\n     * @param scale 生成的向量长度\n     * @static\n     */\n    public static random <Out extends IVec4Like> (out: Out, scale?: number) {\n        scale = scale || 1.0;\n\n        const phi = random() * 2.0 * Math.PI;\n        const cosTheta = random() * 2 - 1;\n        const sinTheta = Math.sqrt(1 - cosTheta * cosTheta);\n\n        out.x = sinTheta * Math.cos(phi) * scale;\n        out.y = sinTheta * Math.sin(phi) * scale;\n        out.z = cosTheta * scale;\n        out.w = 0;\n        return out;\n    }\n\n    /**\n     * !#zh 向量矩阵乘法\n     * !#en Vector matrix multiplication\n     * @method transformMat4\n     * @typescript\n     * transformMat4 <Out extends IVec4Like, MatLike extends IMat4Like> (out: Out, a: Out, mat: MatLike)\n     * @static\n     */\n    public static transformMat4 <Out extends IVec4Like, MatLike extends IMat4Like> (out: Out, a: Out, mat: MatLike) {\n        _x = a.x;\n        _y = a.y;\n        _z = a.z;\n        _w = a.w;\n        let m = mat.m;\n        out.x = m[0] * _x + m[4] * _y + m[8]  * _z + m[12] * _w;\n        out.y = m[1] * _x + m[5] * _y + m[9]  * _z + m[13] * _w;\n        out.z = m[2] * _x + m[6] * _y + m[10] * _z + m[14] * _w;\n        out.w = m[3] * _x + m[7] * _y + m[11] * _z + m[15] * _w;\n        return out;\n    }\n\n    /**\n     * !#zh 向量仿射变换\n     * !#en Affine transformation vector\n     * @static\n     */\n    public static transformAffine<Out extends IVec4Like, VecLike extends IVec4Like, MatLike extends IMat4Like>\n        (out: Out, v: VecLike, mat: MatLike) {\n        _x = v.x;\n        _y = v.y;\n        _z = v.z;\n        _w = v.w;\n        let m = mat.m;\n        out.x = m[0] * _x + m[1] * _y + m[2]  * _z + m[3] * _w;\n        out.y = m[4] * _x + m[5] * _y + m[6]  * _z + m[7] * _w;\n        out.x = m[8] * _x + m[9] * _y + m[10] * _z + m[11] * _w;\n        out.w = v.w;\n        return out;\n    }\n\n    /**\n     * !#zh 向量四元数乘法\n     * !#en Vector quaternion multiplication\n     * @method transformQuat\n     * @typescript\n     * transformQuat <Out extends IVec4Like, QuatLike extends IQuatLike> (out: Out, a: Out, q: QuatLike)\n     * @static\n     */\n    public static transformQuat <Out extends IVec4Like, QuatLike extends IQuatLike> (out: Out, a: Out, q: QuatLike) {\n        const { x, y, z } = a;\n\n        _x = q.x;\n        _y = q.y;\n        _z = q.z;\n        _w = q.w;\n\n        // calculate quat * vec\n        const ix = _w * x + _y * z - _z * y;\n        const iy = _w * y + _z * x - _x * z;\n        const iz = _w * z + _x * y - _y * x;\n        const iw = -_x * x - _y * y - _z * z;\n\n        // calculate result * inverse quat\n        out.x = ix * _w + iw * -_x + iy * -_z - iz * -_y;\n        out.y = iy * _w + iw * -_y + iz * -_x - ix * -_z;\n        out.z = iz * _w + iw * -_z + ix * -_y - iy * -_x;\n        out.w = a.w;\n        return out;\n    }\n\n    /**\n     * !#zh 向量等价判断\n     * !#en Equivalent vectors Analyzing\n     * @method strictEquals\n     * @typescript\n     * strictEquals <Out extends IVec4Like> (a: Out, b: Out)\n     * @static\n     */\n    public static strictEquals <Out extends IVec4Like> (a: Out, b: Out) {\n        return a.x === b.x && a.y === b.y && a.z === b.z && a.w === b.w;\n    }\n\n    /**\n     * !#zh 排除浮点数误差的向量近似等价判断\n     * !#en Negative error vector floating point approximately equivalent Analyzing\n     * @method equals\n     * @typescript\n     * equals <Out extends IVec4Like> (a: Out, b: Out, epsilon = EPSILON)\n     * @static\n     */\n    public static equals <Out extends IVec4Like> (a: Out, b: Out, epsilon = EPSILON) {\n        return (Math.abs(a.x - b.x) <= epsilon * Math.max(1.0, Math.abs(a.x), Math.abs(b.x)) &&\n            Math.abs(a.y - b.y) <= epsilon * Math.max(1.0, Math.abs(a.y), Math.abs(b.y)) &&\n            Math.abs(a.z - b.z) <= epsilon * Math.max(1.0, Math.abs(a.z), Math.abs(b.z)) &&\n            Math.abs(a.w - b.w) <= epsilon * Math.max(1.0, Math.abs(a.w), Math.abs(b.w)));\n    }\n\n    /**\n     * !#zh 向量转数组\n     * !#en Vector transfer array\n     * @method toArray\n     * @typescript\n     * toArray <Out extends IWritableArrayLike<number>> (out: Out, v: IVec4Like, ofs = 0)\n     * @param ofs 数组起始偏移量\n     * @static\n     */\n    public static toArray <Out extends IWritableArrayLike<number>> (out: Out, v: IVec4Like, ofs = 0) {\n        out[ofs + 0] = v.x;\n        out[ofs + 1] = v.y;\n        out[ofs + 2] = v.z;\n        out[ofs + 3] = v.w;\n        return out;\n    }\n\n    /**\n     * !#zh 数组转向量\n     * !#en Array steering amount\n     * @method fromArray\n     * @typescript\n     * fromArray <Out extends IVec4Like> (out: Out, arr: IWritableArrayLike<number>, ofs = 0)\n     * @param ofs 数组起始偏移量\n     * @static\n     */\n    public static fromArray <Out extends IVec4Like> (out: Out, arr: IWritableArrayLike<number>, ofs = 0) {\n        out.x = arr[ofs + 0];\n        out.y = arr[ofs + 1];\n        out.z = arr[ofs + 2];\n        out.w = arr[ofs + 3];\n        return out;\n    }\n\n    /**\n     * @property {Number} x\n     */\n    public x: number;\n\n    /**\n     * @property {Number} y\n     */\n    public y: number;\n\n    /**\n     * @property {Number} z\n     */\n    public z: number;\n\n    /**\n     * @property {Number} w\n     */\n    public w: number;\n\n    /**\n     * !#en\n     * Constructor\n     * see {{#crossLink \"cc/vec4:method\"}}cc.v4{{/crossLink}}\n     * !#zh\n     * 构造函数，可查看 {{#crossLink \"cc/vec4:method\"}}cc.v4{{/crossLink}}\n     * @method constructor\n     * @param {number} [x=0]\n     * @param {number} [y=0]\n     * @param {number} [z=0]\n     * @param {number} [w=0]\n     */\n    constructor (x: number | Vec4 = 0, y: number = 0, z: number = 0, w: number = 0) {\n        super();\n        if (x && typeof x === 'object') {\n            this.w = x.w;\n            this.z = x.z;\n            this.y = x.y;\n            this.x = x.x;\n        } else {\n            this.x = x as number;\n            this.y = y;\n            this.z = z;\n            this.w = w;\n        }\n    }\n\n    /**\n     * !#en clone a Vec4 value\n     * !#zh 克隆一个 Vec4 值\n     * @method clone\n     * @return {Vec4}\n     */\n    public clone () {\n        return new Vec4(this.x, this.y, this.z, this.w);\n    }\n\n    /**\n     * !#en Set the current vector value with the given vector.\n     * !#zh 用另一个向量设置当前的向量对象值。\n     * @method set\n     * @param {Vec4} newValue - !#en new value to set. !#zh 要设置的新值\n     * @return {Vec4} returns this\n     */\n    public set (other: Vec4);\n\n    public set (x?: number, y?: number, z?: number, w?: number);\n\n    public set (x?: number | Vec4, y?: number, z?: number, w?: number) {\n        if (x && typeof x === 'object') {\n            this.x = x.x;\n            this.y = x.y;\n            this.z = x.z;\n            this.w = x.w;\n        } else {\n            this.x = x as number || 0;\n            this.y = y || 0;\n            this.z = z || 0;\n            this.w = w || 0;\n        }\n        return this;\n    }\n\n    /**\n     * !#en Check whether the vector equals another one\n     * !#zh 当前的向量是否与指定的向量相等。\n     * @method equals\n     * @param {Vec4} other\n     * @param {number} [epsilon]\n     * @return {Boolean}\n     */\n    public equals (other: Vec4, epsilon = EPSILON) {\n        return (Math.abs(this.x - other.x) <= epsilon * Math.max(1.0, Math.abs(this.x), Math.abs(other.x)) &&\n            Math.abs(this.y - other.y) <= epsilon * Math.max(1.0, Math.abs(this.y), Math.abs(other.y)) &&\n            Math.abs(this.z - other.z) <= epsilon * Math.max(1.0, Math.abs(this.z), Math.abs(other.z)) &&\n            Math.abs(this.w - other.w) <= epsilon * Math.max(1.0, Math.abs(this.w), Math.abs(other.w)));\n    }\n\n    /**\n     * !#en Check whether the vector equals another one\n     * !#zh 判断当前向量是否在误差范围内与指定分量的向量相等。\n     * @method equals4f\n     * @param {number} x - 相比较的向量的 x 分量。\n     * @param {number} y - 相比较的向量的 y 分量。\n     * @param {number} z - 相比较的向量的 z 分量。\n     * @param {number} w - 相比较的向量的 w 分量。\n     * @param {number} [epsilon] - 允许的误差，应为非负数。\n     * @returns {Boolean} - 当两向量的各分量都在指定的误差范围内分别相等时，返回 `true`；否则返回 `false`。\n     */\n    public equals4f (x: number, y: number, z: number, w: number, epsilon = EPSILON) {\n        return (Math.abs(this.x - x) <= epsilon * Math.max(1.0, Math.abs(this.x), Math.abs(x)) &&\n            Math.abs(this.y - y) <= epsilon * Math.max(1.0, Math.abs(this.y), Math.abs(y)) &&\n            Math.abs(this.z - z) <= epsilon * Math.max(1.0, Math.abs(this.z), Math.abs(z)) &&\n            Math.abs(this.w - w) <= epsilon * Math.max(1.0, Math.abs(this.w), Math.abs(w)));\n    }\n\n    /**\n     * !#en Check whether strict equals other Vec4\n     * !#zh 判断当前向量是否与指定向量相等。两向量的各分量都分别相等时返回 `true`；否则返回 `false`。\n     * @method strictEquals\n     * @param {Vec4} other - 相比较的向量。\n     * @returns {boolean}\n     */\n    public strictEquals (other: Vec4) {\n        return this.x === other.x && this.y === other.y && this.z === other.z && this.w === other.w;\n    }\n\n    /**\n     * !#en Check whether strict equals other Vec4\n     * !#zh 判断当前向量是否与指定分量的向量相等。两向量的各分量都分别相等时返回 `true`；否则返回 `false`。\n     * @method strictEquals4f\n     * @param {number} x - 指定向量的 x 分量。\n     * @param {number} y - 指定向量的 y 分量。\n     * @param {number} z - 指定向量的 z 分量。\n     * @param {number} w - 指定向量的 w 分量。\n     * @returns {boolean}\n     */\n    public strictEquals4f (x: number, y: number, z: number, w: number) {\n        return this.x === x && this.y === y && this.z === z && this.w === w;\n    }\n\n    /**\n     * !#en Calculate linear interpolation result between this vector and another one with given ratio\n     * !#zh 根据指定的插值比率，从当前向量到目标向量之间做插值。\n     * @method lerp\n     * @param {Vec4} to 目标向量。\n     * @param {number} ratio 插值比率，范围为 [0,1]。\n     * @returns {Vec4}\n     */\n    public lerp (to: Vec4, ratio: number) {\n        _x = this.x;\n        _y = this.y;\n        _z = this.z;\n        _w = this.w;\n        this.x = _x + ratio * (to.x - _x);\n        this.y = _y + ratio * (to.y - _y);\n        this.z = _z + ratio * (to.z - _z);\n        this.w = _w + ratio * (to.w - _w);\n        return this;\n    }\n\n    /**\n     * !#en Transform to string with vector informations\n     * !#zh 返回当前向量的字符串表示。\n     * @method toString\n     * @returns {string} 当前向量的字符串表示。\n     */\n    public toString (): string {\n        return `(${this.x.toFixed(2)}, ${this.y.toFixed(2)}, ${this.z.toFixed(2)}, ${this.w.toFixed(2)})`;\n    }\n\n    /**\n     * !#en Clamp the vector between minInclusive and maxInclusive.\n     * !#zh 设置当前向量的值，使其各个分量都处于指定的范围内。\n     * @method clampf\n     * @param {Vec4} minInclusive 每个分量都代表了对应分量允许的最小值。\n     * @param {Vec4} maxInclusive 每个分量都代表了对应分量允许的最大值。\n     * @returns {Vec4}\n     */\n    public clampf (minInclusive: Vec4, maxInclusive: Vec4) {\n        this.x = clamp(this.x, minInclusive.x, maxInclusive.x);\n        this.y = clamp(this.y, minInclusive.y, maxInclusive.y);\n        this.z = clamp(this.z, minInclusive.z, maxInclusive.z);\n        this.w = clamp(this.w, minInclusive.w, maxInclusive.w);\n        return this;\n    }\n\n    /**\n     * !#en Adds this vector. If you want to save result to another vector, use add() instead.\n     * !#zh 向量加法。如果你想保存结果到另一个向量，使用 add() 代替。\n     * @method addSelf\n     * @param {Vec4} vector\n     * @return {Vec4} returns this\n     * @chainable\n     */\n    addSelf (vector: Vec4): this {\n        this.x += vector.x;\n        this.y += vector.y;\n        this.z += vector.z;\n        this.w += vector.w;\n        return this;\n    }\n\n    /**\n     * !#en Adds two vectors, and returns the new result.\n     * !#zh 向量加法，并返回新结果。\n     * @method add\n     * @param {Vec4} vector\n     * @param {Vec4} [out] - optional, the receiving vector, you can pass the same vec4 to save result to itself, if not provided, a new vec4 will be created\n     * @return {Vec4} the result\n     */\n    add (vector: Vec4, out?: Vec4): Vec4 {\n        out = out || new Vec4();\n        out.x = this.x + vector.x;\n        out.y = this.y + vector.y;\n        out.z = this.z + vector.z;\n        out.w = this.w + vector.w;\n        return out;\n    }\n\n    /**\n     * !#en Subtracts one vector from this, and returns the new result.\n     * !#zh 向量减法，并返回新结果。\n     * @method subtract\n     * @param {Vec4} vector\n     * @param {Vec4} [out] - optional, the receiving vector, you can pass the same vec4 to save result to itself, if not provided, a new vec4 will be created\n     * @return {Vec4} the result\n     */\n    subtract (vector: Vec4, out?: Vec4): Vec4 {\n        out = out || new Vec4();\n        out.x = this.x - vector.x;\n        out.y = this.y - vector.y;\n        out.z = this.z - vector.z;\n        out.w = this.w - vector.w;\n        return out;\n    }\n\n    /**\n     * !#en Multiplies this by a number.\n     * !#zh 缩放当前向量。\n     * @method multiplyScalar\n     * @param {number} num\n     * @return {Vec4} returns this\n     * @chainable\n     */\n    multiplyScalar (num: number): this {\n        this.x *= num;\n        this.y *= num;\n        this.z *= num;\n        this.w *= num;\n        return this;\n    }\n\n    /**\n     * !#en Multiplies two vectors.\n     * !#zh 分量相乘。\n     * @method multiply\n     * @param {Vec4} vector\n     * @return {Vec4} returns this\n     * @chainable\n     */\n    multiply (vector: Vec4): this {\n        this.x *= vector.x;\n        this.y *= vector.y;\n        this.z *= vector.z;\n        this.w *= vector.w;\n        return this;\n    }\n\n    /**\n     * !#en Divides by a number.\n     * !#zh 向量除法。\n     * @method divide\n     * @param {number} num\n     * @return {Vec4} returns this\n     * @chainable\n     */\n    divide (num: number): this {\n        this.x /= num;\n        this.y /= num;\n        this.z /= num;\n        this.w /= num;\n        return this;\n    }\n\n    /**\n     * !#en Negates the components.\n     * !#zh 向量取反\n     * @method negate\n     * @return {Vec4} returns this\n     * @chainable\n     */\n    negate (): this {\n        this.x = -this.x;\n        this.y = -this.y;\n        this.z = -this.z;\n        this.w = -this.w;\n        return this;\n    }\n\n    /**\n     * !#en Dot product\n     * !#zh 当前向量与指定向量进行点乘。\n     * @method dot\n     * @param {Vec4} [vector]\n     * @return {number} the result\n     */\n    dot (vector: Vec4): number {\n        return this.x * vector.x + this.y * vector.y + this.z * vector.z + this.w * vector.w;\n    }\n\n    /**\n     * !#en Cross product\n     * !#zh 当前向量与指定向量进行叉乘。\n     * @method cross\n     * @param {Vec4} vector\n     * @param {Vec4} [out]\n     * @return {Vec4} the result\n     */\n    cross (vector: Vec4, out?: Vec4): Vec4 {\n        out = out || new Vec4();\n        const { x: ax, y: ay, z: az } = this;\n        const { x: bx, y: by, z: bz } = vector;\n\n        out.x = ay * bz - az * by;\n        out.y = az * bx - ax * bz;\n        out.z = ax * by - ay * bx;\n        return out;\n    }\n\n    /**\n     * !#en Returns the length of this vector.\n     * !#zh 返回该向量的长度。\n     * @method len\n     * @return {number} the result\n     * @example\n     * var v = cc.v4(10, 10);\n     * v.len(); // return 14.142135623730951;\n     */\n    len (): number {\n        let x = this.x,\n          y = this.y,\n          z = this.z,\n          w = this.w;\n        return Math.sqrt(x * x + y * y + z * z + w * w);\n    }\n\n    /**\n     * !#en Returns the squared length of this vector.\n     * !#zh 返回该向量的长度平方。\n     * @method lengthSqr\n     * @return {number} the result\n     */\n    lengthSqr (): number {\n        let x = this.x,\n          y = this.y,\n          z = this.z,\n          w = this.w;\n        return x * x + y * y + z * z + w * w;\n    }\n\n    /**\n     * !#en Make the length of this vector to 1.\n     * !#zh 向量归一化，让这个向量的长度为 1。\n     * @method normalizeSelf\n     * @return {Vec4} returns this\n     * @chainable\n     */\n    normalizeSelf () {\n        this.normalize(this);\n        return this;\n    }\n\n    /**\n     * !#en\n     * Returns this vector with a magnitude of 1.<br/>\n     * <br/>\n     * Note that the current vector is unchanged and a new normalized vector is returned. If you want to normalize the current vector, use normalizeSelf function.\n     * !#zh\n     * 返回归一化后的向量。<br/>\n     * <br/>\n     * 注意，当前向量不变，并返回一个新的归一化向量。如果你想来归一化当前向量，可使用 normalizeSelf 函数。\n     * @method normalize\n     * @param {Vec4} [out] - optional, the receiving vector, you can pass the same vec4 to save result to itself, if not provided, a new vec4 will be created\n     * @return {Vec4} result\n     */\n    normalize (out?: Vec4): Vec4 {\n        out = out || new Vec4();\n        _x = this.x;\n        _y = this.y;\n        _z = this.z;\n        _w = this.w;\n        let len = _x * _x + _y * _y + _z * _z + _w * _w;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n            out.x = _x * len;\n            out.y = _y * len;\n            out.z = _z * len;\n            out.w = _w * len;\n        }\n        return out;\n    }\n\n    /**\n     * Transforms the vec4 with a mat4. 4th vector component is implicitly '1'\n     * @method transformMat4\n     * @param {Mat4} m matrix to transform with\n     * @param {Vec4} [out] the receiving vector, you can pass the same vec4 to save result to itself, if not provided, a new vec4 will be created\n     * @returns {Vec4} out\n     */\n    transformMat4 (matrix: Mat4, out: Vec4): Vec4 {\n        out = out || new Vec4();\n        _x = this.x;\n        _y = this.y;\n        _z = this.z;\n        _w = this.w;\n        let m = matrix.m;\n        out.x = m[0] * _x + m[4] * _y + m[8]  * _z + m[12] * _w;\n        out.y = m[1] * _x + m[5] * _y + m[9]  * _z + m[13] * _w;\n        out.z = m[2] * _x + m[6] * _y + m[10] * _z + m[14] * _w;\n        out.w = m[3] * _x + m[7] * _y + m[11] * _z + m[15] * _w;\n        return out;\n    }\n\n    /**\n     * Returns the maximum value in x, y, z, w.\n     * @method maxAxis\n     * @returns {number}\n     */\n    maxAxis (): number {\n        return Math.max(this.x, this.y, this.z, this.w);\n    }\n}\n\nCCClass.fastDefine('cc.Vec4', Vec4, { x: 0, y: 0, z: 0, w: 0 });\n\nexport function v4 (other: Vec4): Vec4;\nexport function v4 (x?: number, y?: number, z?: number, w?: number): Vec4;\n\nexport function v4 (x?: number | Vec4, y?: number, z?: number, w?: number) {\n    return new Vec4(x as any, y, z, w);\n}\n\ncc.v4 = v4;\ncc.Vec4 = Vec4;\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n\nvar js = cc.js;\n\nif (CC_DEBUG) {\n\n    function deprecateEnum (obj, oldPath, newPath, hasTypePrefixBefore) {\n        if (!CC_SUPPORT_JIT) {\n            return;\n        }\n        hasTypePrefixBefore = hasTypePrefixBefore !== false;\n        var enumDef = Function('return ' + newPath)();\n        var entries = cc.Enum.getList(enumDef);\n        var delimiter = hasTypePrefixBefore ? '_' : '.';\n        for (var i = 0; i < entries.length; i++) {\n            var entry = entries[i].name;\n            var oldPropName;\n            if (hasTypePrefixBefore) {\n                var oldTypeName = oldPath.split('.').slice(-1)[0];\n                oldPropName = oldTypeName + '_' + entry;\n            }\n            else {\n                oldPropName = entry;\n            }\n            js.get(obj, oldPropName, function (entry) {\n                cc.errorID(1400, oldPath + delimiter + entry, newPath + '.' + entry);\n                return enumDef[entry];\n            }.bind(null, entry));\n        }\n    }\n\n    function markAsRemoved (ownerCtor, removedProps, ownerName) {\n        if (!ownerCtor) {\n            // 可能被裁剪了\n            return;\n        }\n        ownerName = ownerName || js.getClassName(ownerCtor);\n        removedProps.forEach(function (prop) {\n            function error () {\n                cc.errorID(1406, ownerName, prop);\n            }\n            js.getset(ownerCtor.prototype, prop, error, error);\n        });\n    }\n\n    function markAsDeprecated (ownerCtor, deprecatedProps, ownerName) {\n        if (!ownerCtor) {\n            return;\n        }\n        ownerName = ownerName || js.getClassName(ownerCtor);\n        let descriptors = Object.getOwnPropertyDescriptors(ownerCtor.prototype);\n        deprecatedProps.forEach(function (prop) {\n            let deprecatedProp = prop[0];\n            let newProp = prop[1];\n            let descriptor = descriptors[deprecatedProp];\n            js.getset(ownerCtor.prototype, deprecatedProp, function () {\n                cc.warnID(1400, `${ownerName}.${deprecatedProp}`, `${ownerName}.${newProp}`);\n                return descriptor.get.call(this);\n            }, function (v) {\n                cc.warnID(1400, `${ownerName}.${deprecatedProp}`, `${ownerName}.${newProp}`);\n                descriptor.set.call(this, v);\n            });\n        })\n    }\n\n    function markAsRemovedInObject (ownerObj, removedProps, ownerName) {\n        if (!ownerObj) {\n            // 可能被裁剪了\n            return;\n        }\n        removedProps.forEach(function (prop) {\n            function error () {\n                cc.errorID(1406, ownerName, prop);\n            }\n            js.getset(ownerObj, prop, error);\n        });\n    }\n\n    function provideClearError (owner, obj, ownerName) {\n        if (!owner) {\n            // 可能被裁剪了\n            return;\n        }\n        var className = ownerName || cc.js.getClassName(owner);\n        var Info = 'Sorry, ' + className + '.%s is removed, please use %s instead.';\n        for (var prop in obj) {\n            function define (prop, getset) {\n                function accessor (newProp) {\n                    cc.error(Info, prop, newProp);\n                }\n                if (!Array.isArray(getset)) {\n                    getset = getset.split(',')\n                        .map(function (x) {\n                            return x.trim();\n                        });\n                }\n                try {\n                    js.getset(owner, prop, accessor.bind(null, getset[0]), getset[1] && accessor.bind(null, getset[1]));\n                }\n                catch (e) {}\n            }\n            var getset = obj[prop];\n            if (prop[0] === '*') {\n                // get set\n                var etProp = prop.slice(1);\n                define('g' + etProp, getset);\n                define('s' + etProp, getset);\n            }\n            else {\n                prop.split(',')\n                    .map(function (x) {\n                        return x.trim();\n                    })\n                    .forEach(function (x) {\n                        define(x, getset);\n                    });\n            }\n        }\n    }\n\n    function markFunctionWarning (ownerCtor, obj, ownerName) {\n        if (!ownerCtor) {\n            // 可能被裁剪了\n            return;\n        }\n        ownerName = ownerName || js.getClassName(ownerCtor);\n        for (var prop in obj) {\n            (function(){\n                var propName = prop;\n                var originFunc = ownerCtor[propName];\n                if (!originFunc) return;\n\n                function warn () {\n                    cc.warn('Sorry, %s.%s is deprecated. Please use %s instead', ownerName, propName, obj[propName]);\n                    return originFunc.apply(this, arguments);\n                }\n\n                ownerCtor[propName] = warn;\n            })();\n        }\n    }\n    // remove cc.info\n    js.get(cc, 'info', function () {\n        cc.warnID(1400, 'cc.info', 'cc.log');\n        return cc.log;\n    });\n    // cc.spriteFrameCache\n    js.get(cc, \"spriteFrameCache\", function () {\n        cc.errorID(1404);\n    });\n\n    // cc.vmath\n    js.get(cc, 'vmath', function () {\n        cc.warnID(1400, 'cc.vmath', 'cc.math');\n        return cc.math;\n    });\n    js.get(cc.math, 'vec2', function () {\n        cc.warnID(1400, 'cc.vmath.vec2', 'cc.Vec2');\n        return cc.Vec2;\n    })\n    js.get(cc.math, 'vec3', function () {\n        cc.warnID(1400, 'cc.vmath.vec3', 'cc.Vec3');\n        return cc.Vec3;\n    })\n    js.get(cc.math, 'vec4', function () {\n        cc.warnID(1400, 'cc.vmath.vec4', 'cc.Vec4');\n        return cc.Vec4;\n    })\n    js.get(cc.math, 'mat4', function () {\n        cc.warnID(1400, 'cc.vmath.mat4', 'cc.Mat4');\n        return cc.Mat4;\n    })\n    js.get(cc.math, 'mat3', function () {\n        cc.warnID(1400, 'cc.vmath.mat3', 'cc.Mat3');\n        return cc.Mat3;\n    })\n    js.get(cc.math, 'quat', function () {\n        cc.warnID(1400, 'cc.vmath.quat', 'cc.Quat');\n        return cc.Quat;\n    })\n\n    // SpriteFrame\n    js.get(cc.SpriteFrame.prototype, '_textureLoaded', function () {\n        cc.errorID(1400, 'spriteFrame._textureLoaded', 'spriteFrame.textureLoaded()');\n        return this.textureLoaded();\n    });\n    markAsRemoved(cc.SpriteFrame, [\n        'addLoadedEventListener'\n    ]);\n    markFunctionWarning(cc.Sprite.prototype, {\n        setState: 'cc.Sprite.setMaterial',\n        getState: 'cc.Sprite.getMaterial'\n    }, 'cc.Sprite');\n\n    js.get(cc.SpriteFrame.prototype, 'clearTexture', function () {\n        cc.warnID(1406, 'cc.SpriteFrame', 'clearTexture');\n        return function () {};\n    });\n\n    // cc.textureCache\n    js.get(cc, 'textureCache', function () {\n        cc.errorID(1406, 'cc', 'textureCache');\n    });\n\n    // Texture\n    let Texture2D = cc.Texture2D;\n    js.obsolete(Texture2D.prototype, 'texture.releaseTexture', 'texture.destroy');\n\n    js.get(Texture2D.prototype, 'getName', function () {\n        cc.warnID(1400, 'texture.getName()', 'texture._glID');\n        return function () {\n            return this._glID || null;\n        };\n    });\n\n    js.get(Texture2D.prototype, 'isLoaded', function () {\n        cc.errorID(1400, 'texture.isLoaded function', 'texture.loaded property');\n        return (function () {\n            return this.loaded;\n        });\n    });\n\n    js.get(Texture2D.prototype, 'setAntiAliasTexParameters', function () {\n        cc.warnID(1400, 'texture.setAntiAliasTexParameters()', 'texture.setFilters(cc.Texture2D.Filter.LINEAR, cc.Texture2D.Filter.LINEAR)');\n        return function () {\n            this.setFilters(Texture2D.Filter.LINEAR, Texture2D.Filter.LINEAR);\n        };\n    });\n\n    js.get(Texture2D.prototype, 'setAliasTexParameters', function () {\n        cc.warnID(1400, 'texture.setAntiAliasTexParameters()', 'texture.setFilters(cc.Texture2D.Filter.NEAREST, cc.Texture2D.Filter.NEAREST)');\n        return function () {\n            this.setFilters(Texture2D.Filter.NEAREST, Texture2D.Filter.NEAREST);\n        };\n    });\n\n    // cc.macro\n    markAsRemovedInObject(cc.macro, [\n        'ENABLE_GL_STATE_CACHE',\n        'FIX_ARTIFACTS_BY_STRECHING_TEXEL',\n    ], 'cc.macro');\n\n    provideClearError(cc.macro, {\n        PI: 'Math.PI',\n        PI2: 'Math.PI*2',\n        FLT_MAX: 'Number.MAX_VALUE',\n        FLT_MIN: 'Number.MIN_VALUE',\n        UINT_MAX: 'Number.MAX_SAFE_INTEGER'\n    }, 'cc.macro');\n\n    // cc.game\n    markAsRemovedInObject(cc.game, [\n        'CONFIG_KEY',\n    ], 'cc.game');\n\n    // cc.sys\n    markAsRemovedInObject(cc.sys, [\n        'dumpRoot',\n        'cleanScript',\n    ], 'cc.sys');\n\n    // cc.Director\n    provideClearError(cc.Director, {\n        EVENT_PROJECTION_CHANGED: '',\n        EVENT_BEFORE_VISIT: 'EVENT_AFTER_UPDATE',\n        EVENT_AFTER_VISIT: 'EVENT_BEFORE_DRAW',\n    }, 'cc.Director');\n    markFunctionWarning(cc.Director.prototype, {\n        convertToGL: 'cc.view.convertToLocationInView',\n        convertToUI: '',\n        getWinSize: 'cc.winSize',\n        getWinSizeInPixels: 'cc.winSize',\n        getVisibleSize: 'cc.view.getVisibleSize',\n        getVisibleOrigin: 'cc.view.getVisibleOrigin',\n        purgeCachedData: 'cc.loader.releaseAll',\n        setDepthTest: 'cc.Camera.main.depth',\n        setClearColor: 'cc.Camera.main.backgroundColor',\n        getRunningScene: 'cc.director.getScene',\n        getAnimationInterval: 'cc.game.getFrameRate',\n        setAnimationInterval: 'cc.game.setFrameRate',\n        isDisplayStats: 'cc.debug.isDisplayStats',\n        setDisplayStats: 'cc.debug.setDisplayStats',\n        stopAnimation: 'cc.game.pause',\n        startAnimation: 'cc.game.resume',\n    }, 'cc.Director');\n    markAsRemoved(cc.Director, [\n        'pushScene',\n        'popScene',\n        'popToRootScene',\n        'popToSceneStackLevel',\n        'setProjection',\n        'getProjection',\n    ], 'cc.Director');\n\n    // Scheduler\n    provideClearError(cc.Scheduler, {\n        scheduleCallbackForTarget: 'schedule',\n        scheduleUpdateForTarget: 'scheduleUpdate',\n        unscheduleCallbackForTarget: 'unschedule',\n        unscheduleUpdateForTarget: 'unscheduleUpdate',\n        unscheduleAllCallbacksForTarget: 'unscheduleAllForTarget',\n        unscheduleAllCallbacks: 'unscheduleAll',\n        unscheduleAllCallbacksWithMinPriority: 'unscheduleAllWithMinPriority'\n    }, 'cc.Scheduler');\n\n    // cc.view\n    provideClearError(cc.view, {\n        adjustViewPort: 'adjustViewportMeta',\n        setViewPortInPoints: 'setViewportInPoints',\n        getViewPortRect: 'getViewportRect'\n    }, 'cc.view');\n    markAsRemovedInObject(cc.view, [\n        'isViewReady',\n        'setTargetDensityDPI',\n        'getTargetDensityDPI',\n        'setFrameZoomFactor',\n        'canSetContentScaleFactor',\n        'setContentTranslateLeftTop',\n        'getContentTranslateLeftTop',\n        'setViewName',\n        'getViewName'\n    ], 'cc.view');\n\n    // Loader\n    markAsRemoved(cc.Pipeline, [\n        'flowInDeps',\n        'getItems'\n    ], 'cc.loader');\n\n    // cc.PhysicsManager\n    markAsRemoved(cc.PhysicsManager, [\n        'attachDebugDrawToCamera',\n        'detachDebugDrawFromCamera',\n    ]);\n\n    // cc.CollisionManager\n    markAsRemoved(cc.CollisionManager, [\n        'attachDebugDrawToCamera',\n        'detachDebugDrawFromCamera',\n    ]);\n\n    // cc.Node\n    provideClearError(cc._BaseNode.prototype, {\n        'tag': 'name',\n        'getTag': 'name',\n        'setTag': 'name',\n        'getChildByTag': 'getChildByName',\n        'removeChildByTag': 'getChildByName(name).destroy()'\n    });\n\n    markAsRemoved(cc.Node, [\n        '_cascadeColorEnabled',\n        'cascadeColor',\n        'isCascadeColorEnabled',\n        'setCascadeColorEnabled',\n        '_cascadeOpacityEnabled',\n        'cascadeOpacity',\n        'isCascadeOpacityEnabled',\n        'setCascadeOpacityEnabled',\n        'opacityModifyRGB',\n        'isOpacityModifyRGB',\n        'setOpacityModifyRGB',\n        'ignoreAnchor',\n        'isIgnoreAnchorPointForPosition',\n        'ignoreAnchorPointForPosition',\n        'isRunning',\n        '_sgNode',\n    ]);\n\n    markFunctionWarning(cc.Node.prototype, {\n        getNodeToParentTransform: 'getLocalMatrix',\n        getNodeToParentTransformAR: 'getLocalMatrix',\n        getNodeToWorldTransform: 'getWorldMatrix',\n        getNodeToWorldTransformAR: 'getWorldMatrix',\n        getParentToNodeTransform: 'getLocalMatrix',\n        getWorldToNodeTransform: 'getWorldMatrix',\n        convertTouchToNodeSpace: 'convertToNodeSpaceAR',\n        convertTouchToNodeSpaceAR: 'convertToNodeSpaceAR',\n        convertToWorldSpace: 'convertToWorldSpaceAR',\n        convertToNodeSpace: 'convertToNodeSpaceAR'\n    });\n\n    provideClearError(cc.Node.prototype, {\n        getRotationX: 'rotationX',\n        setRotationX: 'rotationX',\n        getRotationY: 'rotationY',\n        setRotationY: 'rotationY',\n        getPositionX: 'x',\n        setPositionX: 'x',\n        getPositionY: 'y',\n        setPositionY: 'y',\n        getSkewX: 'skewX',\n        setSkewX: 'skewX',\n        getSkewY: 'skewY',\n        setSkewY: 'skewY',\n        getScaleX: 'scaleX',\n        setScaleX: 'scaleX',\n        getScaleY: 'scaleY',\n        setScaleY: 'scaleY',\n        getOpacity: 'opacity',\n        setOpacity: 'opacity',\n        getColor: 'color',\n        setColor: 'color',\n        getLocalZOrder: 'zIndex',\n        setLocalZOrder: 'zIndex',\n    });\n\n    // cc.Component\n    markAsRemoved(cc.Component, [\n        'isRunning',\n    ]);\n\n    provideClearError(cc.Sprite.prototype, {\n        setInsetLeft: 'cc.SpriteFrame insetLeft',\n        setInsetRight: 'cc.SpriteFrame insetRight',\n        setInsetTop: 'cc.SpriteFrame insetTop',\n        setInsetBottom: 'cc.SpriteFrame insetBottom',\n    });\n\n    // cc.Material\n    cc.Material.getInstantiatedBuiltinMaterial = cc.MaterialVariant.createWithBuiltin;\n    cc.Material.getInstantiatedMaterial = cc.MaterialVariant.create;\n    markFunctionWarning(cc.Material, {\n        getInstantiatedBuiltinMaterial: 'cc.MaterialVariant.createWithBuiltin',\n        getInstantiatedMaterial: 'cc.MaterialVariant.create'\n    })\n\n    // cc.RenderComponent\n    cc.js.getset(cc.RenderComponent.prototype, 'sharedMaterials', function () {\n        cc.warnID(1400, 'sharedMaterials', 'getMaterials');\n        return this.materials;\n    }, function (v) {\n        cc.warnID(1400, 'sharedMaterials', 'setMaterial');\n        this.materials = v;\n    })\n\n    // cc.Camera\n    markFunctionWarning(cc.Camera.prototype, {\n        getNodeToCameraTransform: 'getWorldToScreenMatrix2D',\n        getCameraToWorldPoint: 'getScreenToWorldPoint',\n        getWorldToCameraPoint: 'getWorldToScreenPoint',\n        getCameraToWorldMatrix: 'getScreenToWorldMatrix2D',\n        getWorldToCameraMatrix: 'getWorldToScreenMatrix2D'\n    });\n\n    markAsRemoved(cc.Camera, [\n        'addTarget',\n        'removeTarget',\n        'getTargets'\n    ]);\n\n    // SCENE\n    var ERR = '\"%s\" is not defined in the Scene, it is only defined in normal nodes.';\n    CC_EDITOR || Object.defineProperties(cc.Scene.prototype, {\n        active: {\n            get: function () {\n                cc.error(ERR, 'active');\n                return true;\n            },\n            set: function () {\n                cc.error(ERR, 'active');\n            }\n        },\n        activeInHierarchy: {\n            get: function () {\n                cc.error(ERR, 'activeInHierarchy');\n                return true;\n            },\n        },\n        getComponent: {\n            get: function () {\n                cc.error(ERR, 'getComponent');\n                return function () {\n                    return null;\n                };\n            }\n        },\n        addComponent: {\n            get: function () {\n                cc.error(ERR, 'addComponent');\n                return function () {\n                    return null;\n                };\n            }\n        },\n    });\n\n    // cc.dynamicAtlasManager\n    markAsRemovedInObject(cc.dynamicAtlasManager, [\n        'minFrameSize'\n    ], 'cc.dynamicAtlasManager')\n\n    // Value types\n    provideClearError(cc, {\n        // AffineTransform\n        affineTransformMake: 'cc.AffineTransform.create',\n        affineTransformMakeIdentity: 'cc.AffineTransform.identity',\n        affineTransformClone: 'cc.AffineTransform.clone',\n        affineTransformConcat: 'cc.AffineTransform.concat',\n        affineTransformConcatIn: 'cc.AffineTransform.concat',\n        affineTransformInvert: 'cc.AffineTransform.invert',\n        affineTransformInvertIn: 'cc.AffineTransform.invert',\n        affineTransformInvertOut: 'cc.AffineTransform.invert',\n        affineTransformEqualToTransform: 'cc.AffineTransform.equal',\n        pointApplyAffineTransform: 'cc.AffineTransform.transformVec2',\n        sizeApplyAffineTransform: 'cc.AffineTransform.transformSize',\n        rectApplyAffineTransform: 'cc.AffineTransform.transformRect',\n        obbApplyAffineTransform: 'cc.AffineTransform.transformObb',\n\n        // Vec2\n        pointEqualToPoint: 'cc.Vec2 equals',\n\n        // Size\n        sizeEqualToSize: 'cc.Size equals',\n\n        // Rect\n        rectEqualToRect: 'rectA.equals(rectB)',\n        rectContainsRect: 'rectA.containsRect(rectB)',\n        rectContainsPoint: 'rect.contains(vec2)',\n        rectOverlapsRect: 'rectA.intersects(rectB)',\n        rectIntersectsRect: 'rectA.intersects(rectB)',\n        rectIntersection: 'rectA.intersection(intersection, rectB)',\n        rectUnion: 'rectA.union(union, rectB)',\n        rectGetMaxX: 'rect.xMax',\n        rectGetMidX: 'rect.center.x',\n        rectGetMinX: 'rect.xMin',\n        rectGetMaxY: 'rect.yMax',\n        rectGetMidY: 'rect.center.y',\n        rectGetMinY: 'rect.yMin',\n\n        // Color\n        colorEqual: 'colorA.equals(colorB)',\n        hexToColor: 'color.fromHEX(hexColor)',\n        colorToHex: 'color.toHEX()',\n\n        // Enums\n        TextAlignment: 'cc.macro.TextAlignment',\n        VerticalTextAlignment: 'cc.macro.VerticalTextAlignment',\n\n        // Point Extensions\n        pNeg: 'p.neg()',\n        pAdd: 'p1.add(p2)',\n        pSub: 'p1.sub(p2)',\n        pMult: 'p.mul(factor)',\n        pMidpoint: 'p1.add(p2).mul(0.5)',\n        pDot: 'p1.dot(p2)',\n        pCross: 'p1.cross(p2)',\n        pPerp: 'p.rotate(-90 * Math.PI / 180)',\n        pRPerp: 'p.rotate(90 * Math.PI / 180)',\n        pProject: 'p1.project(p2)',\n        pLengthSQ: 'p.magSqr()',\n        pDistanceSQ: 'p1.sub(p2).magSqr()',\n        pLength: 'p.mag()',\n        pDistance: 'p1.sub(p2).mag()',\n        pNormalize: 'p.normalize()',\n        pForAngle: 'cc.v2(Math.cos(a), Math.sin(a))',\n        pToAngle: 'Math.atan2(v.y, v.x)',\n        pZeroIn: 'p.x = p.y = 0',\n        pIn: 'p1.set(p2)',\n        pMultIn: 'p.mulSelf(factor)',\n        pSubIn: 'p1.subSelf(p2)',\n        pAddIn: 'p1.addSelf(p2)',\n        pNormalizeIn: 'p.normalizeSelf()',\n        pSameAs: 'p1.equals(p2)',\n        pAngle: 'v1.angle(v2)',\n        pAngleSigned: 'v1.signAngle(v2)',\n        pRotateByAngle: 'p.rotate(radians)',\n        pCompMult: 'v1.dot(v2)',\n        pFuzzyEqual: 'v1.fuzzyEquals(v2, tolerance)',\n        pLerp: 'p.lerp(endPoint, ratio)',\n        pClamp: 'p.clampf(min_inclusive, max_inclusive)',\n\n        rand: 'Math.random() * 0xffffff',\n        randomMinus1To1: '(Math.random() - 0.5) * 2',\n\n        container: 'cc.game.container',\n        _canvas: 'cc.game.canvas',\n        _renderType: 'cc.game.renderType',\n\n        _getError: 'cc.debug.getError',\n        _initDebugSetting: 'cc.debug._resetDebugSetting',\n        DebugMode: 'cc.debug.DebugMode',\n    }, 'cc');\n    markAsRemovedInObject(cc, [\n        'blendFuncDisable',\n\n        'pFromSize',\n        'pCompOp',\n        'pIntersectPoint',\n        'pSegmentIntersect',\n        'pLineIntersect',\n\n        'obbApplyMatrix',\n\n        'getImageFormatByData',\n\n        'initEngine',\n    ], 'cc');\n    markFunctionWarning(cc, {\n        // cc.p\n        p: 'cc.v2'\n    }, 'cc');\n    // cc.Rect\n    provideClearError(cc.Rect, {\n        contain: 'rectA.contains(rectB)',\n        transformMat4: 'rect.transformMat4(out, mat4)'\n    });\n    // cc.Color\n    provideClearError(cc.Color, {\n        rgb2hsv: 'color.toHSV()',\n        hsv2rgb: 'color.fromHSV(h, s, v)'\n    });\n\n    // macro functions\n    js.get(cc, 'lerp', function () {\n        cc.warnID(1400, 'cc.lerp', 'cc.misc.lerp');\n        return cc.misc.lerp;\n    });\n    js.get(cc, 'random0To1', function () {\n        cc.warnID(1400, 'cc.random0To1', 'Math.random');\n        return Math.random;\n    });\n    js.get(cc, 'degreesToRadians', function () {\n        cc.warnID(1400, 'cc.degreesToRadians', 'cc.misc.degreesToRadians');\n        return cc.misc.degreesToRadians;\n    });\n    js.get(cc, 'radiansToDegrees', function () {\n        cc.warnID(1400, 'cc.radiansToDegrees', 'cc.misc.radiansToDegrees');\n        return cc.misc.radiansToDegrees;\n    });\n    js.get(cc, 'clampf', function () {\n        cc.warnID(1400, 'cc.clampf', 'cc.misc.clampf');\n        return cc.misc.clampf;\n    });\n    js.get(cc, 'clamp01', function () {\n        cc.warnID(1400, 'cc.clamp01', 'cc.misc.clamp01');\n        return cc.misc.clamp01;\n    });\n    js.get(cc, 'ImageFormat', function () {\n        cc.warnID(1400, 'cc.ImageFormat', 'cc.macro.ImageFormat');\n        return cc.macro.ImageFormat;\n    });\n    js.get(cc, 'KEY', function () {\n        cc.warnID(1400, 'cc.KEY', 'cc.macro.KEY');\n        return cc.macro.KEY;\n    });\n    js.get(cc, 'Easing', function () {\n        cc.warnID(1400, 'cc.Easing', 'cc.easing');\n        return cc.easing;\n    });\n\n    // cc.isChildClassOf\n    js.get(cc, 'isChildClassOf', function () {\n        cc.errorID(1400, 'cc.isChildClassOf', 'cc.js.isChildClassOf');\n        return cc.js.isChildClassOf;\n    });\n\n    // dragon bones\n    if (typeof dragonBones !== 'undefined') {\n        js.obsolete(dragonBones.CCFactory, 'dragonBones.CCFactory.getFactory', 'getInstance');\n    }\n\n    // renderEngine\n    cc.renderer.renderEngine = {\n        get gfx () {\n            cc.warnID(1400, 'cc.renderer.renderEngine.gfx', 'cc.gfx');\n            return cc.gfx;\n        },\n        get math () {\n            cc.warnID(1400, 'cc.renderer.renderEngine.math', 'cc.math');\n            return cc.vmath;\n        },\n        get InputAssembler () {\n            cc.warnID(1400, 'cc.renderer.renderEngine.InputAssembler', 'cc.renderer.InputAssembler');\n            return cc.renderer.InputAssembler;\n        }\n    };\n    \n}\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('./core/CCGame');\n\n// ensure modular-cocos2d can determine whether action module is included\nrequire('./actions');","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nconst Asset = require('../core/assets/CCAsset');\nconst CCSpriteFrame = require('../core/assets/CCSpriteFrame');\n\n/**\n * Class for particle asset handling.\n * @class ParticleAsset\n * @extends Asset\n */\nvar ParticleAsset = cc.Class({\n    name: 'cc.ParticleAsset',\n    extends: Asset,\n\n    properties: {\n        spriteFrame: {\n            default: null,\n            type: CCSpriteFrame\n        }\n    }\n});\n\ncc.ParticleAsset = module.exports = ParticleAsset;\n","'use strict';\n\n/**\n * enums\n */\nconst enums = {\n  // buffer usage\n  USAGE_STATIC: 35044,  // gl.STATIC_DRAW\n  USAGE_DYNAMIC: 35048, // gl.DYNAMIC_DRAW\n  USAGE_STREAM: 35040,  // gl.STREAM_DRAW\n\n  // index buffer format\n  INDEX_FMT_UINT8: 5121,  // gl.UNSIGNED_BYTE\n  INDEX_FMT_UINT16: 5123, // gl.UNSIGNED_SHORT\n  INDEX_FMT_UINT32: 5125, // gl.UNSIGNED_INT (OES_element_index_uint)\n\n  // vertex attribute semantic\n  ATTR_POSITION: 'a_position',\n  ATTR_NORMAL: 'a_normal',\n  ATTR_TANGENT: 'a_tangent',\n  ATTR_BITANGENT: 'a_bitangent',\n  ATTR_WEIGHTS: 'a_weights',\n  ATTR_JOINTS: 'a_joints',\n  ATTR_COLOR: 'a_color',\n  ATTR_COLOR0: 'a_color0',\n  ATTR_COLOR1: 'a_color1',\n  ATTR_UV: 'a_uv',\n  ATTR_UV0: 'a_uv0',\n  ATTR_UV1: 'a_uv1',\n  ATTR_UV2: 'a_uv2',\n  ATTR_UV3: 'a_uv3',\n  ATTR_UV4: 'a_uv4',\n  ATTR_UV5: 'a_uv5',\n  ATTR_UV6: 'a_uv6',\n  ATTR_UV7: 'a_uv7',\n\n  // vertex attribute type\n  ATTR_TYPE_INT8: 5120,    // gl.BYTE\n  ATTR_TYPE_UINT8: 5121,   // gl.UNSIGNED_BYTE\n  ATTR_TYPE_INT16: 5122,   // gl.SHORT\n  ATTR_TYPE_UINT16: 5123,  // gl.UNSIGNED_SHORT\n  ATTR_TYPE_INT32: 5124,   // gl.INT\n  ATTR_TYPE_UINT32: 5125,  // gl.UNSIGNED_INT\n  ATTR_TYPE_FLOAT32: 5126, // gl.FLOAT\n\n  // texture filter\n  FILTER_NEAREST: 0,\n  FILTER_LINEAR: 1,\n\n  // texture wrap mode\n  WRAP_REPEAT: 10497, // gl.REPEAT\n  WRAP_CLAMP: 33071,  // gl.CLAMP_TO_EDGE\n  WRAP_MIRROR: 33648, // gl.MIRRORED_REPEAT\n\n  // texture format\n  // compress formats\n  TEXTURE_FMT_RGB_DXT1: 0,\n  TEXTURE_FMT_RGBA_DXT1: 1,\n  TEXTURE_FMT_RGBA_DXT3: 2,\n  TEXTURE_FMT_RGBA_DXT5: 3,\n  TEXTURE_FMT_RGB_ETC1: 4,\n  TEXTURE_FMT_RGB_PVRTC_2BPPV1: 5,\n  TEXTURE_FMT_RGBA_PVRTC_2BPPV1: 6,\n  TEXTURE_FMT_RGB_PVRTC_4BPPV1: 7,\n  TEXTURE_FMT_RGBA_PVRTC_4BPPV1: 8,\n\n  // normal formats\n  TEXTURE_FMT_A8: 9,\n  TEXTURE_FMT_L8: 10,\n  TEXTURE_FMT_L8_A8: 11,\n  TEXTURE_FMT_R5_G6_B5: 12,\n  TEXTURE_FMT_R5_G5_B5_A1: 13,\n  TEXTURE_FMT_R4_G4_B4_A4: 14,\n  TEXTURE_FMT_RGB8: 15,\n  TEXTURE_FMT_RGBA8: 16,\n  TEXTURE_FMT_RGB16F: 17,\n  TEXTURE_FMT_RGBA16F: 18,\n  TEXTURE_FMT_RGB32F: 19,\n  TEXTURE_FMT_RGBA32F: 20,\n  TEXTURE_FMT_R32F: 21,\n  TEXTURE_FMT_111110F: 22,\n  TEXTURE_FMT_SRGB: 23,\n  TEXTURE_FMT_SRGBA: 24,\n\n  // depth formats\n  TEXTURE_FMT_D16: 25,\n  TEXTURE_FMT_D32: 26,\n  TEXTURE_FMT_D24S8: 27,\n\n  // etc2 format\n  TEXTURE_FMT_RGB_ETC2: 28,\n  TEXTURE_FMT_RGBA_ETC2: 29,\n\n  // depth and stencil function\n  DS_FUNC_NEVER: 512,    // gl.NEVER\n  DS_FUNC_LESS: 513,     // gl.LESS\n  DS_FUNC_EQUAL: 514,    // gl.EQUAL\n  DS_FUNC_LEQUAL: 515,   // gl.LEQUAL\n  DS_FUNC_GREATER: 516,  // gl.GREATER\n  DS_FUNC_NOTEQUAL: 517, // gl.NOTEQUAL\n  DS_FUNC_GEQUAL: 518,   // gl.GEQUAL\n  DS_FUNC_ALWAYS: 519,   // gl.ALWAYS\n\n  // render-buffer format\n  RB_FMT_RGBA4: 32854,    // gl.RGBA4\n  RB_FMT_RGB5_A1: 32855,  // gl.RGB5_A1\n  RB_FMT_RGB565: 36194,   // gl.RGB565\n  RB_FMT_D16: 33189,      // gl.DEPTH_COMPONENT16\n  RB_FMT_S8: 36168,       // gl.STENCIL_INDEX8\n  RB_FMT_D24S8: 34041,    // gl.DEPTH_STENCIL\n\n  // blend-equation\n  BLEND_FUNC_ADD: 32774,              // gl.FUNC_ADD\n  BLEND_FUNC_SUBTRACT: 32778,         // gl.FUNC_SUBTRACT\n  BLEND_FUNC_REVERSE_SUBTRACT: 32779, // gl.FUNC_REVERSE_SUBTRACT\n\n  // blend\n  BLEND_ZERO: 0,                          // gl.ZERO\n  BLEND_ONE: 1,                           // gl.ONE\n  BLEND_SRC_COLOR: 768,                   // gl.SRC_COLOR\n  BLEND_ONE_MINUS_SRC_COLOR: 769,         // gl.ONE_MINUS_SRC_COLOR\n  BLEND_DST_COLOR: 774,                   // gl.DST_COLOR\n  BLEND_ONE_MINUS_DST_COLOR: 775,         // gl.ONE_MINUS_DST_COLOR\n  BLEND_SRC_ALPHA: 770,                   // gl.SRC_ALPHA\n  BLEND_ONE_MINUS_SRC_ALPHA: 771,         // gl.ONE_MINUS_SRC_ALPHA\n  BLEND_DST_ALPHA: 772,                   // gl.DST_ALPHA\n  BLEND_ONE_MINUS_DST_ALPHA: 773,         // gl.ONE_MINUS_DST_ALPHA\n  BLEND_CONSTANT_COLOR: 32769,            // gl.CONSTANT_COLOR\n  BLEND_ONE_MINUS_CONSTANT_COLOR: 32770,  // gl.ONE_MINUS_CONSTANT_COLOR\n  BLEND_CONSTANT_ALPHA: 32771,            // gl.CONSTANT_ALPHA\n  BLEND_ONE_MINUS_CONSTANT_ALPHA: 32772,  // gl.ONE_MINUS_CONSTANT_ALPHA\n  BLEND_SRC_ALPHA_SATURATE: 776,          // gl.SRC_ALPHA_SATURATE\n\n  // stencil operation\n  STENCIL_DISABLE: 0,             // disable stencil\n  STENCIL_ENABLE: 1,              // enable stencil\n  STENCIL_INHERIT: 2,             // inherit stencil states\n\n  STENCIL_OP_KEEP: 7680,          // gl.KEEP\n  STENCIL_OP_ZERO: 0,             // gl.ZERO\n  STENCIL_OP_REPLACE: 7681,       // gl.REPLACE\n  STENCIL_OP_INCR: 7682,          // gl.INCR\n  STENCIL_OP_INCR_WRAP: 34055,    // gl.INCR_WRAP\n  STENCIL_OP_DECR: 7683,          // gl.DECR\n  STENCIL_OP_DECR_WRAP: 34056,    // gl.DECR_WRAP\n  STENCIL_OP_INVERT: 5386,        // gl.INVERT\n\n  // cull\n  CULL_NONE: 0,\n  CULL_FRONT: 1028,\n  CULL_BACK: 1029,\n  CULL_FRONT_AND_BACK: 1032,\n\n  // primitive type\n  PT_POINTS: 0,         // gl.POINTS\n  PT_LINES: 1,          // gl.LINES\n  PT_LINE_LOOP: 2,      // gl.LINE_LOOP\n  PT_LINE_STRIP: 3,     // gl.LINE_STRIP\n  PT_TRIANGLES: 4,      // gl.TRIANGLES\n  PT_TRIANGLE_STRIP: 5, // gl.TRIANGLE_STRIP\n  PT_TRIANGLE_FAN: 6,   // gl.TRIANGLE_FAN\n};\n\nlet RenderQueue = {\n    OPAQUE: 0,\n    TRANSPARENT: 1,\n    OVERLAY: 2\n};\n\n/**\n * JS Implementation of MurmurHash2\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} str ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash\n */\n\nfunction murmurhash2_32_gc(str, seed) {\n  var\n    l = str.length,\n    h = seed ^ l,\n    i = 0,\n    k;\n  \n  while (l >= 4) {\n  \tk = \n  \t  ((str.charCodeAt(i) & 0xff)) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 8) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 16) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 24);\n    \n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n    k ^= k >>> 24;\n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n\n\th = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16)) ^ k;\n\n    l -= 4;\n    ++i;\n  }\n  \n  switch (l) {\n  case 3: h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n  case 2: h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n  case 1: h ^= (str.charCodeAt(i) & 0xff);\n          h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  }\n\n  h ^= h >>> 13;\n  h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  h ^= h >>> 15;\n\n  return h >>> 0;\n}\n\n// Extensions\nvar WebGLEXT;\n(function (WebGLEXT) {\n    WebGLEXT[WebGLEXT[\"COMPRESSED_RGB_S3TC_DXT1_EXT\"] = 33776] = \"COMPRESSED_RGB_S3TC_DXT1_EXT\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_RGBA_S3TC_DXT1_EXT\"] = 33777] = \"COMPRESSED_RGBA_S3TC_DXT1_EXT\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_RGBA_S3TC_DXT3_EXT\"] = 33778] = \"COMPRESSED_RGBA_S3TC_DXT3_EXT\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_RGBA_S3TC_DXT5_EXT\"] = 33779] = \"COMPRESSED_RGBA_S3TC_DXT5_EXT\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_SRGB_S3TC_DXT1_EXT\"] = 35916] = \"COMPRESSED_SRGB_S3TC_DXT1_EXT\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT\"] = 35917] = \"COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT\"] = 35918] = \"COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT\"] = 35919] = \"COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_RGB_PVRTC_4BPPV1_IMG\"] = 35840] = \"COMPRESSED_RGB_PVRTC_4BPPV1_IMG\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_RGB_PVRTC_2BPPV1_IMG\"] = 35841] = \"COMPRESSED_RGB_PVRTC_2BPPV1_IMG\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_RGBA_PVRTC_4BPPV1_IMG\"] = 35842] = \"COMPRESSED_RGBA_PVRTC_4BPPV1_IMG\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_RGBA_PVRTC_2BPPV1_IMG\"] = 35843] = \"COMPRESSED_RGBA_PVRTC_2BPPV1_IMG\";\n    WebGLEXT[WebGLEXT[\"COMPRESSED_RGB_ETC1_WEBGL\"] = 36196] = \"COMPRESSED_RGB_ETC1_WEBGL\";\n})(WebGLEXT || (WebGLEXT = {}));\nvar GFXObjectType;\n(function (GFXObjectType) {\n    GFXObjectType[GFXObjectType[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n    GFXObjectType[GFXObjectType[\"BUFFER\"] = 1] = \"BUFFER\";\n    GFXObjectType[GFXObjectType[\"TEXTURE\"] = 2] = \"TEXTURE\";\n    GFXObjectType[GFXObjectType[\"TEXTURE_VIEW\"] = 3] = \"TEXTURE_VIEW\";\n    GFXObjectType[GFXObjectType[\"RENDER_PASS\"] = 4] = \"RENDER_PASS\";\n    GFXObjectType[GFXObjectType[\"FRAMEBUFFER\"] = 5] = \"FRAMEBUFFER\";\n    GFXObjectType[GFXObjectType[\"SAMPLER\"] = 6] = \"SAMPLER\";\n    GFXObjectType[GFXObjectType[\"SHADER\"] = 7] = \"SHADER\";\n    GFXObjectType[GFXObjectType[\"PIPELINE_LAYOUT\"] = 8] = \"PIPELINE_LAYOUT\";\n    GFXObjectType[GFXObjectType[\"PIPELINE_STATE\"] = 9] = \"PIPELINE_STATE\";\n    GFXObjectType[GFXObjectType[\"BINDING_LAYOUT\"] = 10] = \"BINDING_LAYOUT\";\n    GFXObjectType[GFXObjectType[\"INPUT_ASSEMBLER\"] = 11] = \"INPUT_ASSEMBLER\";\n    GFXObjectType[GFXObjectType[\"COMMAND_ALLOCATOR\"] = 12] = \"COMMAND_ALLOCATOR\";\n    GFXObjectType[GFXObjectType[\"COMMAND_BUFFER\"] = 13] = \"COMMAND_BUFFER\";\n    GFXObjectType[GFXObjectType[\"QUEUE\"] = 14] = \"QUEUE\";\n    GFXObjectType[GFXObjectType[\"WINDOW\"] = 15] = \"WINDOW\";\n})(GFXObjectType || (GFXObjectType = {}));\nvar GFXStatus;\n(function (GFXStatus) {\n    GFXStatus[GFXStatus[\"UNREADY\"] = 0] = \"UNREADY\";\n    GFXStatus[GFXStatus[\"FAILED\"] = 1] = \"FAILED\";\n    GFXStatus[GFXStatus[\"SUCCESS\"] = 2] = \"SUCCESS\";\n})(GFXStatus || (GFXStatus = {}));\nvar GFXObject = /** @class */ (function () {\n    function GFXObject(gfxType) {\n        this._gfxType = GFXObjectType.UNKNOWN;\n        this._status = GFXStatus.UNREADY;\n        this._gfxType = gfxType;\n    }\n    Object.defineProperty(GFXObject.prototype, \"gfxType\", {\n        get: function () {\n            return this._gfxType;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(GFXObject.prototype, \"status\", {\n        get: function () {\n            return this._status;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return GFXObject;\n}());\nvar GFXAttributeName;\n(function (GFXAttributeName) {\n    GFXAttributeName[\"ATTR_POSITION\"] = \"a_position\";\n    GFXAttributeName[\"ATTR_NORMAL\"] = \"a_normal\";\n    GFXAttributeName[\"ATTR_TANGENT\"] = \"a_tangent\";\n    GFXAttributeName[\"ATTR_BITANGENT\"] = \"a_bitangent\";\n    GFXAttributeName[\"ATTR_WEIGHTS\"] = \"a_weights\";\n    GFXAttributeName[\"ATTR_JOINTS\"] = \"a_joints\";\n    GFXAttributeName[\"ATTR_COLOR\"] = \"a_color\";\n    GFXAttributeName[\"ATTR_COLOR1\"] = \"a_color1\";\n    GFXAttributeName[\"ATTR_COLOR2\"] = \"a_color2\";\n    GFXAttributeName[\"ATTR_TEX_COORD\"] = \"a_texCoord\";\n    GFXAttributeName[\"ATTR_TEX_COORD1\"] = \"a_texCoord1\";\n    GFXAttributeName[\"ATTR_TEX_COORD2\"] = \"a_texCoord2\";\n    GFXAttributeName[\"ATTR_TEX_COORD3\"] = \"a_texCoord3\";\n    GFXAttributeName[\"ATTR_TEX_COORD4\"] = \"a_texCoord4\";\n    GFXAttributeName[\"ATTR_TEX_COORD5\"] = \"a_texCoord5\";\n    GFXAttributeName[\"ATTR_TEX_COORD6\"] = \"a_texCoord6\";\n    GFXAttributeName[\"ATTR_TEX_COORD7\"] = \"a_texCoord7\";\n    GFXAttributeName[\"ATTR_TEX_COORD8\"] = \"a_texCoord8\";\n})(GFXAttributeName || (GFXAttributeName = {}));\nvar GFXType;\n(function (GFXType) {\n    GFXType[GFXType[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n    GFXType[GFXType[\"BOOL\"] = 1] = \"BOOL\";\n    GFXType[GFXType[\"BOOL2\"] = 2] = \"BOOL2\";\n    GFXType[GFXType[\"BOOL3\"] = 3] = \"BOOL3\";\n    GFXType[GFXType[\"BOOL4\"] = 4] = \"BOOL4\";\n    GFXType[GFXType[\"INT\"] = 5] = \"INT\";\n    GFXType[GFXType[\"INT2\"] = 6] = \"INT2\";\n    GFXType[GFXType[\"INT3\"] = 7] = \"INT3\";\n    GFXType[GFXType[\"INT4\"] = 8] = \"INT4\";\n    GFXType[GFXType[\"UINT\"] = 9] = \"UINT\";\n    GFXType[GFXType[\"UINT2\"] = 10] = \"UINT2\";\n    GFXType[GFXType[\"UINT3\"] = 11] = \"UINT3\";\n    GFXType[GFXType[\"UINT4\"] = 12] = \"UINT4\";\n    GFXType[GFXType[\"FLOAT\"] = 13] = \"FLOAT\";\n    GFXType[GFXType[\"FLOAT2\"] = 14] = \"FLOAT2\";\n    GFXType[GFXType[\"FLOAT3\"] = 15] = \"FLOAT3\";\n    GFXType[GFXType[\"FLOAT4\"] = 16] = \"FLOAT4\";\n    GFXType[GFXType[\"COLOR4\"] = 17] = \"COLOR4\";\n    GFXType[GFXType[\"MAT2\"] = 18] = \"MAT2\";\n    GFXType[GFXType[\"MAT2X3\"] = 19] = \"MAT2X3\";\n    GFXType[GFXType[\"MAT2X4\"] = 20] = \"MAT2X4\";\n    GFXType[GFXType[\"MAT3X2\"] = 21] = \"MAT3X2\";\n    GFXType[GFXType[\"MAT3\"] = 22] = \"MAT3\";\n    GFXType[GFXType[\"MAT3X4\"] = 23] = \"MAT3X4\";\n    GFXType[GFXType[\"MAT4X2\"] = 24] = \"MAT4X2\";\n    GFXType[GFXType[\"MAT4X3\"] = 25] = \"MAT4X3\";\n    GFXType[GFXType[\"MAT4\"] = 26] = \"MAT4\";\n    GFXType[GFXType[\"SAMPLER1D\"] = 27] = \"SAMPLER1D\";\n    GFXType[GFXType[\"SAMPLER1D_ARRAY\"] = 28] = \"SAMPLER1D_ARRAY\";\n    GFXType[GFXType[\"SAMPLER2D\"] = 29] = \"SAMPLER2D\";\n    GFXType[GFXType[\"SAMPLER2D_ARRAY\"] = 30] = \"SAMPLER2D_ARRAY\";\n    GFXType[GFXType[\"SAMPLER3D\"] = 31] = \"SAMPLER3D\";\n    GFXType[GFXType[\"SAMPLER_CUBE\"] = 32] = \"SAMPLER_CUBE\";\n    GFXType[GFXType[\"COUNT\"] = 33] = \"COUNT\";\n})(GFXType || (GFXType = {}));\nvar GFXFormat;\n(function (GFXFormat) {\n    GFXFormat[GFXFormat[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n    GFXFormat[GFXFormat[\"A8\"] = 1] = \"A8\";\n    GFXFormat[GFXFormat[\"L8\"] = 2] = \"L8\";\n    GFXFormat[GFXFormat[\"LA8\"] = 3] = \"LA8\";\n    GFXFormat[GFXFormat[\"R8\"] = 4] = \"R8\";\n    GFXFormat[GFXFormat[\"R8SN\"] = 5] = \"R8SN\";\n    GFXFormat[GFXFormat[\"R8UI\"] = 6] = \"R8UI\";\n    GFXFormat[GFXFormat[\"R8I\"] = 7] = \"R8I\";\n    GFXFormat[GFXFormat[\"R16F\"] = 8] = \"R16F\";\n    GFXFormat[GFXFormat[\"R16UI\"] = 9] = \"R16UI\";\n    GFXFormat[GFXFormat[\"R16I\"] = 10] = \"R16I\";\n    GFXFormat[GFXFormat[\"R32F\"] = 11] = \"R32F\";\n    GFXFormat[GFXFormat[\"R32UI\"] = 12] = \"R32UI\";\n    GFXFormat[GFXFormat[\"R32I\"] = 13] = \"R32I\";\n    GFXFormat[GFXFormat[\"RG8\"] = 14] = \"RG8\";\n    GFXFormat[GFXFormat[\"RG8SN\"] = 15] = \"RG8SN\";\n    GFXFormat[GFXFormat[\"RG8UI\"] = 16] = \"RG8UI\";\n    GFXFormat[GFXFormat[\"RG8I\"] = 17] = \"RG8I\";\n    GFXFormat[GFXFormat[\"RG16F\"] = 18] = \"RG16F\";\n    GFXFormat[GFXFormat[\"RG16UI\"] = 19] = \"RG16UI\";\n    GFXFormat[GFXFormat[\"RG16I\"] = 20] = \"RG16I\";\n    GFXFormat[GFXFormat[\"RG32F\"] = 21] = \"RG32F\";\n    GFXFormat[GFXFormat[\"RG32UI\"] = 22] = \"RG32UI\";\n    GFXFormat[GFXFormat[\"RG32I\"] = 23] = \"RG32I\";\n    GFXFormat[GFXFormat[\"RGB8\"] = 24] = \"RGB8\";\n    GFXFormat[GFXFormat[\"SRGB8\"] = 25] = \"SRGB8\";\n    GFXFormat[GFXFormat[\"RGB8SN\"] = 26] = \"RGB8SN\";\n    GFXFormat[GFXFormat[\"RGB8UI\"] = 27] = \"RGB8UI\";\n    GFXFormat[GFXFormat[\"RGB8I\"] = 28] = \"RGB8I\";\n    GFXFormat[GFXFormat[\"RGB16F\"] = 29] = \"RGB16F\";\n    GFXFormat[GFXFormat[\"RGB16UI\"] = 30] = \"RGB16UI\";\n    GFXFormat[GFXFormat[\"RGB16I\"] = 31] = \"RGB16I\";\n    GFXFormat[GFXFormat[\"RGB32F\"] = 32] = \"RGB32F\";\n    GFXFormat[GFXFormat[\"RGB32UI\"] = 33] = \"RGB32UI\";\n    GFXFormat[GFXFormat[\"RGB32I\"] = 34] = \"RGB32I\";\n    GFXFormat[GFXFormat[\"RGBA8\"] = 35] = \"RGBA8\";\n    GFXFormat[GFXFormat[\"SRGB8_A8\"] = 36] = \"SRGB8_A8\";\n    GFXFormat[GFXFormat[\"RGBA8SN\"] = 37] = \"RGBA8SN\";\n    GFXFormat[GFXFormat[\"RGBA8UI\"] = 38] = \"RGBA8UI\";\n    GFXFormat[GFXFormat[\"RGBA8I\"] = 39] = \"RGBA8I\";\n    GFXFormat[GFXFormat[\"RGBA16F\"] = 40] = \"RGBA16F\";\n    GFXFormat[GFXFormat[\"RGBA16UI\"] = 41] = \"RGBA16UI\";\n    GFXFormat[GFXFormat[\"RGBA16I\"] = 42] = \"RGBA16I\";\n    GFXFormat[GFXFormat[\"RGBA32F\"] = 43] = \"RGBA32F\";\n    GFXFormat[GFXFormat[\"RGBA32UI\"] = 44] = \"RGBA32UI\";\n    GFXFormat[GFXFormat[\"RGBA32I\"] = 45] = \"RGBA32I\";\n    // Special Format\n    GFXFormat[GFXFormat[\"R5G6B5\"] = 46] = \"R5G6B5\";\n    GFXFormat[GFXFormat[\"R11G11B10F\"] = 47] = \"R11G11B10F\";\n    GFXFormat[GFXFormat[\"RGB5A1\"] = 48] = \"RGB5A1\";\n    GFXFormat[GFXFormat[\"RGBA4\"] = 49] = \"RGBA4\";\n    GFXFormat[GFXFormat[\"RGB10A2\"] = 50] = \"RGB10A2\";\n    GFXFormat[GFXFormat[\"RGB10A2UI\"] = 51] = \"RGB10A2UI\";\n    GFXFormat[GFXFormat[\"RGB9E5\"] = 52] = \"RGB9E5\";\n    // Depth-Stencil Format\n    GFXFormat[GFXFormat[\"D16\"] = 53] = \"D16\";\n    GFXFormat[GFXFormat[\"D16S8\"] = 54] = \"D16S8\";\n    GFXFormat[GFXFormat[\"D24\"] = 55] = \"D24\";\n    GFXFormat[GFXFormat[\"D24S8\"] = 56] = \"D24S8\";\n    GFXFormat[GFXFormat[\"D32F\"] = 57] = \"D32F\";\n    GFXFormat[GFXFormat[\"D32F_S8\"] = 58] = \"D32F_S8\";\n    // Compressed Format\n    // Block Compression Format, DDS (DirectDraw Surface)\n    // DXT1: 3 channels (5:6:5), 1/8 origianl size, with 0 or 1 bit of alpha\n    GFXFormat[GFXFormat[\"BC1\"] = 59] = \"BC1\";\n    GFXFormat[GFXFormat[\"BC1_ALPHA\"] = 60] = \"BC1_ALPHA\";\n    GFXFormat[GFXFormat[\"BC1_SRGB\"] = 61] = \"BC1_SRGB\";\n    GFXFormat[GFXFormat[\"BC1_SRGB_ALPHA\"] = 62] = \"BC1_SRGB_ALPHA\";\n    // DXT3: 4 channels (5:6:5), 1/4 origianl size, with 4 bits of alpha\n    GFXFormat[GFXFormat[\"BC2\"] = 63] = \"BC2\";\n    GFXFormat[GFXFormat[\"BC2_SRGB\"] = 64] = \"BC2_SRGB\";\n    // DXT5: 4 channels (5:6:5), 1/4 origianl size, with 8 bits of alpha\n    GFXFormat[GFXFormat[\"BC3\"] = 65] = \"BC3\";\n    GFXFormat[GFXFormat[\"BC3_SRGB\"] = 66] = \"BC3_SRGB\";\n    // 1 channel (8), 1/4 origianl size\n    GFXFormat[GFXFormat[\"BC4\"] = 67] = \"BC4\";\n    GFXFormat[GFXFormat[\"BC4_SNORM\"] = 68] = \"BC4_SNORM\";\n    // 2 channels (8:8), 1/2 origianl size\n    GFXFormat[GFXFormat[\"BC5\"] = 69] = \"BC5\";\n    GFXFormat[GFXFormat[\"BC5_SNORM\"] = 70] = \"BC5_SNORM\";\n    // 3 channels (16:16:16), half-floating point, 1/6 origianl size\n    // UF16: unsigned float, 5 exponent bits + 11 mantissa bits\n    // SF16: signed float, 1 signed bit + 5 exponent bits + 10 mantissa bits\n    GFXFormat[GFXFormat[\"BC6H_UF16\"] = 71] = \"BC6H_UF16\";\n    GFXFormat[GFXFormat[\"BC6H_SF16\"] = 72] = \"BC6H_SF16\";\n    // 4 channels (4~7 bits per channel) with 0 to 8 bits of alpha, 1/3 original size\n    GFXFormat[GFXFormat[\"BC7\"] = 73] = \"BC7\";\n    GFXFormat[GFXFormat[\"BC7_SRGB\"] = 74] = \"BC7_SRGB\";\n    // Ericsson Texture Compression Format\n    GFXFormat[GFXFormat[\"ETC_RGB8\"] = 75] = \"ETC_RGB8\";\n    GFXFormat[GFXFormat[\"ETC2_RGB8\"] = 76] = \"ETC2_RGB8\";\n    GFXFormat[GFXFormat[\"ETC2_SRGB8\"] = 77] = \"ETC2_SRGB8\";\n    GFXFormat[GFXFormat[\"ETC2_RGB8_A1\"] = 78] = \"ETC2_RGB8_A1\";\n    GFXFormat[GFXFormat[\"ETC2_SRGB8_A1\"] = 79] = \"ETC2_SRGB8_A1\";\n    GFXFormat[GFXFormat[\"ETC2_RGBA8\"] = 80] = \"ETC2_RGBA8\";\n    GFXFormat[GFXFormat[\"ETC2_SRGB8_A8\"] = 81] = \"ETC2_SRGB8_A8\";\n    GFXFormat[GFXFormat[\"EAC_R11\"] = 82] = \"EAC_R11\";\n    GFXFormat[GFXFormat[\"EAC_R11SN\"] = 83] = \"EAC_R11SN\";\n    GFXFormat[GFXFormat[\"EAC_RG11\"] = 84] = \"EAC_RG11\";\n    GFXFormat[GFXFormat[\"EAC_RG11SN\"] = 85] = \"EAC_RG11SN\";\n    // PVRTC (PowerVR)\n    GFXFormat[GFXFormat[\"PVRTC_RGB2\"] = 86] = \"PVRTC_RGB2\";\n    GFXFormat[GFXFormat[\"PVRTC_RGBA2\"] = 87] = \"PVRTC_RGBA2\";\n    GFXFormat[GFXFormat[\"PVRTC_RGB4\"] = 88] = \"PVRTC_RGB4\";\n    GFXFormat[GFXFormat[\"PVRTC_RGBA4\"] = 89] = \"PVRTC_RGBA4\";\n    GFXFormat[GFXFormat[\"PVRTC2_2BPP\"] = 90] = \"PVRTC2_2BPP\";\n    GFXFormat[GFXFormat[\"PVRTC2_4BPP\"] = 91] = \"PVRTC2_4BPP\";\n})(GFXFormat || (GFXFormat = {}));\nvar GFXBufferUsageBit;\n(function (GFXBufferUsageBit) {\n    GFXBufferUsageBit[GFXBufferUsageBit[\"NONE\"] = 0] = \"NONE\";\n    GFXBufferUsageBit[GFXBufferUsageBit[\"TRANSFER_SRC\"] = 1] = \"TRANSFER_SRC\";\n    GFXBufferUsageBit[GFXBufferUsageBit[\"TRANSFER_DST\"] = 2] = \"TRANSFER_DST\";\n    GFXBufferUsageBit[GFXBufferUsageBit[\"INDEX\"] = 4] = \"INDEX\";\n    GFXBufferUsageBit[GFXBufferUsageBit[\"VERTEX\"] = 8] = \"VERTEX\";\n    GFXBufferUsageBit[GFXBufferUsageBit[\"UNIFORM\"] = 16] = \"UNIFORM\";\n    GFXBufferUsageBit[GFXBufferUsageBit[\"STORAGE\"] = 32] = \"STORAGE\";\n    GFXBufferUsageBit[GFXBufferUsageBit[\"INDIRECT\"] = 64] = \"INDIRECT\";\n})(GFXBufferUsageBit || (GFXBufferUsageBit = {}));\nvar GFXMemoryUsageBit;\n(function (GFXMemoryUsageBit) {\n    GFXMemoryUsageBit[GFXMemoryUsageBit[\"NONE\"] = 0] = \"NONE\";\n    GFXMemoryUsageBit[GFXMemoryUsageBit[\"DEVICE\"] = 1] = \"DEVICE\";\n    GFXMemoryUsageBit[GFXMemoryUsageBit[\"HOST\"] = 2] = \"HOST\";\n})(GFXMemoryUsageBit || (GFXMemoryUsageBit = {}));\nvar GFXBufferAccessBit;\n(function (GFXBufferAccessBit) {\n    GFXBufferAccessBit[GFXBufferAccessBit[\"NONE\"] = 0] = \"NONE\";\n    GFXBufferAccessBit[GFXBufferAccessBit[\"READ\"] = 1] = \"READ\";\n    GFXBufferAccessBit[GFXBufferAccessBit[\"WRITE\"] = 2] = \"WRITE\";\n})(GFXBufferAccessBit || (GFXBufferAccessBit = {}));\nvar GFXPrimitiveMode;\n(function (GFXPrimitiveMode) {\n    GFXPrimitiveMode[GFXPrimitiveMode[\"POINT_LIST\"] = 0] = \"POINT_LIST\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"LINE_LIST\"] = 1] = \"LINE_LIST\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"LINE_STRIP\"] = 2] = \"LINE_STRIP\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"LINE_LOOP\"] = 3] = \"LINE_LOOP\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"LINE_LIST_ADJACENCY\"] = 4] = \"LINE_LIST_ADJACENCY\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"LINE_STRIP_ADJACENCY\"] = 5] = \"LINE_STRIP_ADJACENCY\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"ISO_LINE_LIST\"] = 6] = \"ISO_LINE_LIST\";\n    // raycast detectable:\n    GFXPrimitiveMode[GFXPrimitiveMode[\"TRIANGLE_LIST\"] = 7] = \"TRIANGLE_LIST\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"TRIANGLE_STRIP\"] = 8] = \"TRIANGLE_STRIP\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"TRIANGLE_FAN\"] = 9] = \"TRIANGLE_FAN\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"TRIANGLE_LIST_ADJACENCY\"] = 10] = \"TRIANGLE_LIST_ADJACENCY\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"TRIANGLE_STRIP_ADJACENCY\"] = 11] = \"TRIANGLE_STRIP_ADJACENCY\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"TRIANGLE_PATCH_ADJACENCY\"] = 12] = \"TRIANGLE_PATCH_ADJACENCY\";\n    GFXPrimitiveMode[GFXPrimitiveMode[\"QUAD_PATCH_LIST\"] = 13] = \"QUAD_PATCH_LIST\";\n})(GFXPrimitiveMode || (GFXPrimitiveMode = {}));\nvar GFXPolygonMode;\n(function (GFXPolygonMode) {\n    GFXPolygonMode[GFXPolygonMode[\"FILL\"] = 0] = \"FILL\";\n    GFXPolygonMode[GFXPolygonMode[\"POINT\"] = 1] = \"POINT\";\n    GFXPolygonMode[GFXPolygonMode[\"LINE\"] = 2] = \"LINE\";\n})(GFXPolygonMode || (GFXPolygonMode = {}));\nvar GFXShadeModel;\n(function (GFXShadeModel) {\n    GFXShadeModel[GFXShadeModel[\"GOURAND\"] = 0] = \"GOURAND\";\n    GFXShadeModel[GFXShadeModel[\"FLAT\"] = 1] = \"FLAT\";\n})(GFXShadeModel || (GFXShadeModel = {}));\nvar GFXCullMode;\n(function (GFXCullMode) {\n    GFXCullMode[GFXCullMode[\"NONE\"] = 0] = \"NONE\";\n    GFXCullMode[GFXCullMode[\"FRONT\"] = 1] = \"FRONT\";\n    GFXCullMode[GFXCullMode[\"BACK\"] = 2] = \"BACK\";\n})(GFXCullMode || (GFXCullMode = {}));\nvar GFXComparisonFunc;\n(function (GFXComparisonFunc) {\n    GFXComparisonFunc[GFXComparisonFunc[\"NEVER\"] = 0] = \"NEVER\";\n    GFXComparisonFunc[GFXComparisonFunc[\"LESS\"] = 1] = \"LESS\";\n    GFXComparisonFunc[GFXComparisonFunc[\"EQUAL\"] = 2] = \"EQUAL\";\n    GFXComparisonFunc[GFXComparisonFunc[\"LESS_EQUAL\"] = 3] = \"LESS_EQUAL\";\n    GFXComparisonFunc[GFXComparisonFunc[\"GREATER\"] = 4] = \"GREATER\";\n    GFXComparisonFunc[GFXComparisonFunc[\"NOT_EQUAL\"] = 5] = \"NOT_EQUAL\";\n    GFXComparisonFunc[GFXComparisonFunc[\"GREATER_EQUAL\"] = 6] = \"GREATER_EQUAL\";\n    GFXComparisonFunc[GFXComparisonFunc[\"ALWAYS\"] = 7] = \"ALWAYS\";\n})(GFXComparisonFunc || (GFXComparisonFunc = {}));\nvar GFXStencilOp;\n(function (GFXStencilOp) {\n    GFXStencilOp[GFXStencilOp[\"ZERO\"] = 0] = \"ZERO\";\n    GFXStencilOp[GFXStencilOp[\"KEEP\"] = 1] = \"KEEP\";\n    GFXStencilOp[GFXStencilOp[\"REPLACE\"] = 2] = \"REPLACE\";\n    GFXStencilOp[GFXStencilOp[\"INCR\"] = 3] = \"INCR\";\n    GFXStencilOp[GFXStencilOp[\"DECR\"] = 4] = \"DECR\";\n    GFXStencilOp[GFXStencilOp[\"INVERT\"] = 5] = \"INVERT\";\n    GFXStencilOp[GFXStencilOp[\"INCR_WRAP\"] = 6] = \"INCR_WRAP\";\n    GFXStencilOp[GFXStencilOp[\"DECR_WRAP\"] = 7] = \"DECR_WRAP\";\n})(GFXStencilOp || (GFXStencilOp = {}));\nvar GFXBlendOp;\n(function (GFXBlendOp) {\n    GFXBlendOp[GFXBlendOp[\"ADD\"] = 0] = \"ADD\";\n    GFXBlendOp[GFXBlendOp[\"SUB\"] = 1] = \"SUB\";\n    GFXBlendOp[GFXBlendOp[\"REV_SUB\"] = 2] = \"REV_SUB\";\n    GFXBlendOp[GFXBlendOp[\"MIN\"] = 3] = \"MIN\";\n    GFXBlendOp[GFXBlendOp[\"MAX\"] = 4] = \"MAX\";\n})(GFXBlendOp || (GFXBlendOp = {}));\nvar GFXBlendFactor;\n(function (GFXBlendFactor) {\n    GFXBlendFactor[GFXBlendFactor[\"ZERO\"] = 0] = \"ZERO\";\n    GFXBlendFactor[GFXBlendFactor[\"ONE\"] = 1] = \"ONE\";\n    GFXBlendFactor[GFXBlendFactor[\"SRC_ALPHA\"] = 2] = \"SRC_ALPHA\";\n    GFXBlendFactor[GFXBlendFactor[\"DST_ALPHA\"] = 3] = \"DST_ALPHA\";\n    GFXBlendFactor[GFXBlendFactor[\"ONE_MINUS_SRC_ALPHA\"] = 4] = \"ONE_MINUS_SRC_ALPHA\";\n    GFXBlendFactor[GFXBlendFactor[\"ONE_MINUS_DST_ALPHA\"] = 5] = \"ONE_MINUS_DST_ALPHA\";\n    GFXBlendFactor[GFXBlendFactor[\"SRC_COLOR\"] = 6] = \"SRC_COLOR\";\n    GFXBlendFactor[GFXBlendFactor[\"DST_COLOR\"] = 7] = \"DST_COLOR\";\n    GFXBlendFactor[GFXBlendFactor[\"ONE_MINUS_SRC_COLOR\"] = 8] = \"ONE_MINUS_SRC_COLOR\";\n    GFXBlendFactor[GFXBlendFactor[\"ONE_MINUS_DST_COLOR\"] = 9] = \"ONE_MINUS_DST_COLOR\";\n    GFXBlendFactor[GFXBlendFactor[\"SRC_ALPHA_SATURATE\"] = 10] = \"SRC_ALPHA_SATURATE\";\n    GFXBlendFactor[GFXBlendFactor[\"CONSTANT_COLOR\"] = 11] = \"CONSTANT_COLOR\";\n    GFXBlendFactor[GFXBlendFactor[\"ONE_MINUS_CONSTANT_COLOR\"] = 12] = \"ONE_MINUS_CONSTANT_COLOR\";\n    GFXBlendFactor[GFXBlendFactor[\"CONSTANT_ALPHA\"] = 13] = \"CONSTANT_ALPHA\";\n    GFXBlendFactor[GFXBlendFactor[\"ONE_MINUS_CONSTANT_ALPHA\"] = 14] = \"ONE_MINUS_CONSTANT_ALPHA\";\n})(GFXBlendFactor || (GFXBlendFactor = {}));\nvar GFXColorMask;\n(function (GFXColorMask) {\n    GFXColorMask[GFXColorMask[\"NONE\"] = 0] = \"NONE\";\n    GFXColorMask[GFXColorMask[\"R\"] = 1] = \"R\";\n    GFXColorMask[GFXColorMask[\"G\"] = 2] = \"G\";\n    GFXColorMask[GFXColorMask[\"B\"] = 4] = \"B\";\n    GFXColorMask[GFXColorMask[\"A\"] = 8] = \"A\";\n    GFXColorMask[GFXColorMask[\"ALL\"] = 15] = \"ALL\";\n})(GFXColorMask || (GFXColorMask = {}));\nvar GFXFilter;\n(function (GFXFilter) {\n    GFXFilter[GFXFilter[\"NONE\"] = 0] = \"NONE\";\n    GFXFilter[GFXFilter[\"POINT\"] = 1] = \"POINT\";\n    GFXFilter[GFXFilter[\"LINEAR\"] = 2] = \"LINEAR\";\n    GFXFilter[GFXFilter[\"ANISOTROPIC\"] = 3] = \"ANISOTROPIC\";\n})(GFXFilter || (GFXFilter = {}));\nvar GFXAddress;\n(function (GFXAddress) {\n    GFXAddress[GFXAddress[\"WRAP\"] = 0] = \"WRAP\";\n    GFXAddress[GFXAddress[\"MIRROR\"] = 1] = \"MIRROR\";\n    GFXAddress[GFXAddress[\"CLAMP\"] = 2] = \"CLAMP\";\n    GFXAddress[GFXAddress[\"BORDER\"] = 3] = \"BORDER\";\n})(GFXAddress || (GFXAddress = {}));\nvar GFXTextureType;\n(function (GFXTextureType) {\n    GFXTextureType[GFXTextureType[\"TEX1D\"] = 0] = \"TEX1D\";\n    GFXTextureType[GFXTextureType[\"TEX2D\"] = 1] = \"TEX2D\";\n    GFXTextureType[GFXTextureType[\"TEX3D\"] = 2] = \"TEX3D\";\n})(GFXTextureType || (GFXTextureType = {}));\nvar GFXTextureUsageBit;\n(function (GFXTextureUsageBit) {\n    GFXTextureUsageBit[GFXTextureUsageBit[\"NONE\"] = 0] = \"NONE\";\n    GFXTextureUsageBit[GFXTextureUsageBit[\"TRANSFER_SRC\"] = 1] = \"TRANSFER_SRC\";\n    GFXTextureUsageBit[GFXTextureUsageBit[\"TRANSFER_DST\"] = 2] = \"TRANSFER_DST\";\n    GFXTextureUsageBit[GFXTextureUsageBit[\"SAMPLED\"] = 4] = \"SAMPLED\";\n    GFXTextureUsageBit[GFXTextureUsageBit[\"STORAGE\"] = 8] = \"STORAGE\";\n    GFXTextureUsageBit[GFXTextureUsageBit[\"COLOR_ATTACHMENT\"] = 16] = \"COLOR_ATTACHMENT\";\n    GFXTextureUsageBit[GFXTextureUsageBit[\"DEPTH_STENCIL_ATTACHMENT\"] = 32] = \"DEPTH_STENCIL_ATTACHMENT\";\n    GFXTextureUsageBit[GFXTextureUsageBit[\"TRANSIENT_ATTACHMENT\"] = 64] = \"TRANSIENT_ATTACHMENT\";\n    GFXTextureUsageBit[GFXTextureUsageBit[\"INPUT_ATTACHMENT\"] = 128] = \"INPUT_ATTACHMENT\";\n})(GFXTextureUsageBit || (GFXTextureUsageBit = {}));\nvar GFXSampleCount;\n(function (GFXSampleCount) {\n    GFXSampleCount[GFXSampleCount[\"X1\"] = 0] = \"X1\";\n    GFXSampleCount[GFXSampleCount[\"X2\"] = 1] = \"X2\";\n    GFXSampleCount[GFXSampleCount[\"X4\"] = 2] = \"X4\";\n    GFXSampleCount[GFXSampleCount[\"X8\"] = 3] = \"X8\";\n    GFXSampleCount[GFXSampleCount[\"X16\"] = 4] = \"X16\";\n    GFXSampleCount[GFXSampleCount[\"X32\"] = 5] = \"X32\";\n    GFXSampleCount[GFXSampleCount[\"X64\"] = 6] = \"X64\";\n})(GFXSampleCount || (GFXSampleCount = {}));\nvar GFXTextureFlagBit;\n(function (GFXTextureFlagBit) {\n    GFXTextureFlagBit[GFXTextureFlagBit[\"NONE\"] = 0] = \"NONE\";\n    GFXTextureFlagBit[GFXTextureFlagBit[\"GEN_MIPMAP\"] = 1] = \"GEN_MIPMAP\";\n    GFXTextureFlagBit[GFXTextureFlagBit[\"CUBEMAP\"] = 2] = \"CUBEMAP\";\n    GFXTextureFlagBit[GFXTextureFlagBit[\"BAKUP_BUFFER\"] = 4] = \"BAKUP_BUFFER\";\n})(GFXTextureFlagBit || (GFXTextureFlagBit = {}));\nvar GFXTextureViewType;\n(function (GFXTextureViewType) {\n    GFXTextureViewType[GFXTextureViewType[\"TV1D\"] = 0] = \"TV1D\";\n    GFXTextureViewType[GFXTextureViewType[\"TV2D\"] = 1] = \"TV2D\";\n    GFXTextureViewType[GFXTextureViewType[\"TV3D\"] = 2] = \"TV3D\";\n    GFXTextureViewType[GFXTextureViewType[\"CUBE\"] = 3] = \"CUBE\";\n    GFXTextureViewType[GFXTextureViewType[\"TV1D_ARRAY\"] = 4] = \"TV1D_ARRAY\";\n    GFXTextureViewType[GFXTextureViewType[\"TV2D_ARRAY\"] = 5] = \"TV2D_ARRAY\";\n})(GFXTextureViewType || (GFXTextureViewType = {}));\nvar GFXShaderType;\n(function (GFXShaderType) {\n    GFXShaderType[GFXShaderType[\"VERTEX\"] = 0] = \"VERTEX\";\n    GFXShaderType[GFXShaderType[\"HULL\"] = 1] = \"HULL\";\n    GFXShaderType[GFXShaderType[\"DOMAIN\"] = 2] = \"DOMAIN\";\n    GFXShaderType[GFXShaderType[\"GEOMETRY\"] = 3] = \"GEOMETRY\";\n    GFXShaderType[GFXShaderType[\"FRAGMENT\"] = 4] = \"FRAGMENT\";\n    GFXShaderType[GFXShaderType[\"COMPUTE\"] = 5] = \"COMPUTE\";\n    GFXShaderType[GFXShaderType[\"COUNT\"] = 6] = \"COUNT\";\n})(GFXShaderType || (GFXShaderType = {}));\nvar GFXBindingType;\n(function (GFXBindingType) {\n    GFXBindingType[GFXBindingType[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n    GFXBindingType[GFXBindingType[\"UNIFORM_BUFFER\"] = 1] = \"UNIFORM_BUFFER\";\n    GFXBindingType[GFXBindingType[\"SAMPLER\"] = 2] = \"SAMPLER\";\n    GFXBindingType[GFXBindingType[\"STORAGE_BUFFER\"] = 3] = \"STORAGE_BUFFER\";\n})(GFXBindingType || (GFXBindingType = {}));\nvar GFXCommandBufferType;\n(function (GFXCommandBufferType) {\n    GFXCommandBufferType[GFXCommandBufferType[\"PRIMARY\"] = 0] = \"PRIMARY\";\n    GFXCommandBufferType[GFXCommandBufferType[\"SECONDARY\"] = 1] = \"SECONDARY\";\n})(GFXCommandBufferType || (GFXCommandBufferType = {}));\n// Enumeration all possible values of operations to be performed on initially Loading a Framebuffer Object.\nvar GFXLoadOp;\n(function (GFXLoadOp) {\n    GFXLoadOp[GFXLoadOp[\"LOAD\"] = 0] = \"LOAD\";\n    GFXLoadOp[GFXLoadOp[\"CLEAR\"] = 1] = \"CLEAR\";\n    GFXLoadOp[GFXLoadOp[\"DISCARD\"] = 2] = \"DISCARD\";\n})(GFXLoadOp || (GFXLoadOp = {}));\n// Enumerates all possible values of operations to be performed when Storing to a Framebuffer Object.\nvar GFXStoreOp;\n(function (GFXStoreOp) {\n    GFXStoreOp[GFXStoreOp[\"STORE\"] = 0] = \"STORE\";\n    GFXStoreOp[GFXStoreOp[\"DISCARD\"] = 1] = \"DISCARD\";\n})(GFXStoreOp || (GFXStoreOp = {}));\nvar GFXTextureLayout;\n(function (GFXTextureLayout) {\n    GFXTextureLayout[GFXTextureLayout[\"UNDEFINED\"] = 0] = \"UNDEFINED\";\n    GFXTextureLayout[GFXTextureLayout[\"GENERAL\"] = 1] = \"GENERAL\";\n    GFXTextureLayout[GFXTextureLayout[\"COLOR_ATTACHMENT_OPTIMAL\"] = 2] = \"COLOR_ATTACHMENT_OPTIMAL\";\n    GFXTextureLayout[GFXTextureLayout[\"DEPTH_STENCIL_ATTACHMENT_OPTIMAL\"] = 3] = \"DEPTH_STENCIL_ATTACHMENT_OPTIMAL\";\n    GFXTextureLayout[GFXTextureLayout[\"DEPTH_STENCIL_READONLY_OPTIMAL\"] = 4] = \"DEPTH_STENCIL_READONLY_OPTIMAL\";\n    GFXTextureLayout[GFXTextureLayout[\"SHADER_READONLY_OPTIMAL\"] = 5] = \"SHADER_READONLY_OPTIMAL\";\n    GFXTextureLayout[GFXTextureLayout[\"TRANSFER_SRC_OPTIMAL\"] = 6] = \"TRANSFER_SRC_OPTIMAL\";\n    GFXTextureLayout[GFXTextureLayout[\"TRANSFER_DST_OPTIMAL\"] = 7] = \"TRANSFER_DST_OPTIMAL\";\n    GFXTextureLayout[GFXTextureLayout[\"PREINITIALIZED\"] = 8] = \"PREINITIALIZED\";\n    GFXTextureLayout[GFXTextureLayout[\"PRESENT_SRC\"] = 9] = \"PRESENT_SRC\";\n})(GFXTextureLayout || (GFXTextureLayout = {}));\nvar GFXPipelineBindPoint;\n(function (GFXPipelineBindPoint) {\n    GFXPipelineBindPoint[GFXPipelineBindPoint[\"GRAPHICS\"] = 0] = \"GRAPHICS\";\n    GFXPipelineBindPoint[GFXPipelineBindPoint[\"COMPUTE\"] = 1] = \"COMPUTE\";\n    GFXPipelineBindPoint[GFXPipelineBindPoint[\"RAY_TRACING\"] = 2] = \"RAY_TRACING\";\n})(GFXPipelineBindPoint || (GFXPipelineBindPoint = {}));\nvar GFXDynamicState;\n(function (GFXDynamicState) {\n    GFXDynamicState[GFXDynamicState[\"VIEWPORT\"] = 0] = \"VIEWPORT\";\n    GFXDynamicState[GFXDynamicState[\"SCISSOR\"] = 1] = \"SCISSOR\";\n    GFXDynamicState[GFXDynamicState[\"LINE_WIDTH\"] = 2] = \"LINE_WIDTH\";\n    GFXDynamicState[GFXDynamicState[\"DEPTH_BIAS\"] = 3] = \"DEPTH_BIAS\";\n    GFXDynamicState[GFXDynamicState[\"BLEND_CONSTANTS\"] = 4] = \"BLEND_CONSTANTS\";\n    GFXDynamicState[GFXDynamicState[\"DEPTH_BOUNDS\"] = 5] = \"DEPTH_BOUNDS\";\n    GFXDynamicState[GFXDynamicState[\"STENCIL_WRITE_MASK\"] = 6] = \"STENCIL_WRITE_MASK\";\n    GFXDynamicState[GFXDynamicState[\"STENCIL_COMPARE_MASK\"] = 7] = \"STENCIL_COMPARE_MASK\";\n})(GFXDynamicState || (GFXDynamicState = {}));\nvar GFXStencilFace;\n(function (GFXStencilFace) {\n    GFXStencilFace[GFXStencilFace[\"FRONT\"] = 0] = \"FRONT\";\n    GFXStencilFace[GFXStencilFace[\"BACK\"] = 1] = \"BACK\";\n    GFXStencilFace[GFXStencilFace[\"ALL\"] = 2] = \"ALL\";\n})(GFXStencilFace || (GFXStencilFace = {}));\nvar GFXQueueType;\n(function (GFXQueueType) {\n    GFXQueueType[GFXQueueType[\"GRAPHICS\"] = 0] = \"GRAPHICS\";\n    GFXQueueType[GFXQueueType[\"COMPUTE\"] = 1] = \"COMPUTE\";\n    GFXQueueType[GFXQueueType[\"TRANSFER\"] = 2] = \"TRANSFER\";\n})(GFXQueueType || (GFXQueueType = {}));\nvar GFXClearFlag;\n(function (GFXClearFlag) {\n    GFXClearFlag[GFXClearFlag[\"NONE\"] = 0] = \"NONE\";\n    GFXClearFlag[GFXClearFlag[\"COLOR\"] = 1] = \"COLOR\";\n    GFXClearFlag[GFXClearFlag[\"DEPTH\"] = 2] = \"DEPTH\";\n    GFXClearFlag[GFXClearFlag[\"STENCIL\"] = 4] = \"STENCIL\";\n    GFXClearFlag[GFXClearFlag[\"DEPTH_STENCIL\"] = 6] = \"DEPTH_STENCIL\";\n    GFXClearFlag[GFXClearFlag[\"ALL\"] = 7] = \"ALL\";\n})(GFXClearFlag || (GFXClearFlag = {}));\nfunction GFXGetTypeSize(type) {\n    switch (type) {\n        case GFXType.BOOL:\n        case GFXType.INT:\n        case GFXType.UINT:\n        case GFXType.FLOAT: return 4;\n        case GFXType.BOOL2:\n        case GFXType.INT2:\n        case GFXType.UINT2:\n        case GFXType.FLOAT2: return 8;\n        case GFXType.BOOL3:\n        case GFXType.INT3:\n        case GFXType.UINT3:\n        case GFXType.FLOAT3: return 12;\n        case GFXType.BOOL4:\n        case GFXType.INT4:\n        case GFXType.UINT4:\n        case GFXType.FLOAT4:\n        case GFXType.MAT2: return 16;\n        case GFXType.MAT2X3: return 24;\n        case GFXType.MAT2X4: return 32;\n        case GFXType.MAT3X2: return 24;\n        case GFXType.MAT3: return 36;\n        case GFXType.MAT3X4: return 48;\n        case GFXType.MAT4X2: return 32;\n        case GFXType.MAT4X2: return 32;\n        case GFXType.MAT4: return 64;\n        case GFXType.SAMPLER1D:\n        case GFXType.SAMPLER1D_ARRAY:\n        case GFXType.SAMPLER2D:\n        case GFXType.SAMPLER2D_ARRAY:\n        case GFXType.SAMPLER3D:\n        case GFXType.SAMPLER_CUBE: return 4;\n        default: {\n            return 0;\n        }\n    }\n}\n\n// import { GFXBuffer } from '../gfx/buffer';\nvar RenderPassStage;\n(function (RenderPassStage) {\n    RenderPassStage[RenderPassStage[\"DEFAULT\"] = 100] = \"DEFAULT\";\n})(RenderPassStage || (RenderPassStage = {}));\nvar RenderPriority;\n(function (RenderPriority) {\n    RenderPriority[RenderPriority[\"MIN\"] = 0] = \"MIN\";\n    RenderPriority[RenderPriority[\"MAX\"] = 255] = \"MAX\";\n    RenderPriority[RenderPriority[\"DEFAULT\"] = 128] = \"DEFAULT\";\n})(RenderPriority || (RenderPriority = {}));\nvar MAX_BINDING_SUPPORTED = 24; // from WebGL 2 spec\nvar UniformBinding;\n(function (UniformBinding) {\n    // UBOs\n    UniformBinding[UniformBinding[\"UBO_GLOBAL\"] = MAX_BINDING_SUPPORTED - 1] = \"UBO_GLOBAL\";\n    UniformBinding[UniformBinding[\"UBO_SHADOW\"] = MAX_BINDING_SUPPORTED - 2] = \"UBO_SHADOW\";\n    UniformBinding[UniformBinding[\"UBO_LOCAL\"] = MAX_BINDING_SUPPORTED - 3] = \"UBO_LOCAL\";\n    UniformBinding[UniformBinding[\"UBO_FORWARD_LIGHTS\"] = MAX_BINDING_SUPPORTED - 4] = \"UBO_FORWARD_LIGHTS\";\n    UniformBinding[UniformBinding[\"UBO_SKINNING\"] = MAX_BINDING_SUPPORTED - 5] = \"UBO_SKINNING\";\n    UniformBinding[UniformBinding[\"UBO_SKINNING_TEXTURE\"] = MAX_BINDING_SUPPORTED - 6] = \"UBO_SKINNING_TEXTURE\";\n    UniformBinding[UniformBinding[\"UBO_UI\"] = MAX_BINDING_SUPPORTED - 7] = \"UBO_UI\";\n    // samplers\n    UniformBinding[UniformBinding[\"SAMPLER_JOINTS\"] = MAX_BINDING_SUPPORTED + 1] = \"SAMPLER_JOINTS\";\n    UniformBinding[UniformBinding[\"SAMPLER_ENVIRONMENT\"] = MAX_BINDING_SUPPORTED + 2] = \"SAMPLER_ENVIRONMENT\";\n    // rooms left for custom bindings\n    // effect importer prepares bindings according to this\n    UniformBinding[UniformBinding[\"CUSTUM_UBO_BINDING_END_POINT\"] = MAX_BINDING_SUPPORTED - 7] = \"CUSTUM_UBO_BINDING_END_POINT\";\n    UniformBinding[UniformBinding[\"CUSTOM_SAMPLER_BINDING_START_POINT\"] = MAX_BINDING_SUPPORTED + 6] = \"CUSTOM_SAMPLER_BINDING_START_POINT\";\n})(UniformBinding || (UniformBinding = {}));\n// export class UBOGlobal {\n//     public static TIME_OFFSET: number = 0;\n//     public static SCREEN_SIZE_OFFSET: number = UBOGlobal.TIME_OFFSET + 4;\n//     public static SCREEN_SCALE_OFFSET: number = UBOGlobal.SCREEN_SIZE_OFFSET + 4;\n//     public static NATIVE_SIZE_OFFSET: number = UBOGlobal.SCREEN_SCALE_OFFSET + 4;\n//     public static MAT_VIEW_OFFSET: number = UBOGlobal.NATIVE_SIZE_OFFSET + 4;\n//     public static MAT_VIEW_INV_OFFSET: number = UBOGlobal.MAT_VIEW_OFFSET + 16;\n//     public static MAT_PROJ_OFFSET: number = UBOGlobal.MAT_VIEW_INV_OFFSET + 16;\n//     public static MAT_PROJ_INV_OFFSET: number = UBOGlobal.MAT_PROJ_OFFSET + 16;\n//     public static MAT_VIEW_PROJ_OFFSET: number = UBOGlobal.MAT_PROJ_INV_OFFSET + 16;\n//     public static MAT_VIEW_PROJ_INV_OFFSET: number = UBOGlobal.MAT_VIEW_PROJ_OFFSET + 16;\n//     public static CAMERA_POS_OFFSET: number = UBOGlobal.MAT_VIEW_PROJ_INV_OFFSET + 16;\n//     public static EXPOSURE_OFFSET: number = UBOGlobal.CAMERA_POS_OFFSET + 4;\n//     public static MAIN_LIT_DIR_OFFSET: number = UBOGlobal.EXPOSURE_OFFSET + 4;\n//     public static MAIN_LIT_COLOR_OFFSET: number = UBOGlobal.MAIN_LIT_DIR_OFFSET + 4;\n//     public static AMBIENT_SKY_OFFSET: number = UBOGlobal.MAIN_LIT_COLOR_OFFSET + 4;\n//     public static AMBIENT_GROUND_OFFSET: number = UBOGlobal.AMBIENT_SKY_OFFSET + 4;\n//     public static COUNT: number = UBOGlobal.AMBIENT_GROUND_OFFSET + 4;\n//     public static SIZE: number = UBOGlobal.COUNT * 4;\n//     public static BLOCK: GFXUniformBlock = {\n//         binding: UniformBinding.UBO_GLOBAL, name: 'CCGlobal', members: [\n//             { name: 'cc_time', type: GFXType.FLOAT4, count: 1 },\n//             { name: 'cc_screenSize', type: GFXType.FLOAT4, count: 1 },\n//             { name: 'cc_screenScale', type: GFXType.FLOAT4, count: 1 },\n//             { name: 'cc_nativeSize', type: GFXType.FLOAT4, count: 1 },\n//             { name: 'cc_matView', type: GFXType.MAT4, count: 1 },\n//             { name: 'cc_matViewInv', type: GFXType.MAT4, count: 1 },\n//             { name: 'cc_matProj', type: GFXType.MAT4, count: 1 },\n//             { name: 'cc_matProjInv', type: GFXType.MAT4, count: 1 },\n//             { name: 'cc_matViewProj', type: GFXType.MAT4, count: 1 },\n//             { name: 'cc_matViewProjInv', type: GFXType.MAT4, count: 1 },\n//             { name: 'cc_cameraPos', type: GFXType.FLOAT4, count: 1 },\n//             { name: 'cc_exposure', type: GFXType.FLOAT4, count: 1 },\n//             { name: 'cc_mainLitDir', type: GFXType.FLOAT4, count: 1 },\n//             { name: 'cc_mainLitColor', type: GFXType.FLOAT4, count: 1 },\n//             { name: 'cc_ambientSky', type: GFXType.FLOAT4, count: 1 },\n//             { name: 'cc_ambientGround', type: GFXType.FLOAT4, count: 1 },\n//         ],\n//     };\n//     public view: Float32Array = new Float32Array(UBOGlobal.COUNT);\n// }\n// export class UBOShadow {\n//     public static MAT_LIGHT_PLANE_PROJ_OFFSET: number = 0;\n//     public static SHADOW_COLOR_OFFSET: number = UBOShadow.MAT_LIGHT_PLANE_PROJ_OFFSET + 16;\n//     public static COUNT: number = UBOShadow.SHADOW_COLOR_OFFSET + 4;\n//     public static SIZE: number = UBOShadow.COUNT * 4;\n//     public static BLOCK: GFXUniformBlock = {\n//         binding: UniformBinding.UBO_SHADOW, name: 'CCShadow', members: [\n//             { name: 'cc_matLightPlaneProj', type: GFXType.MAT4, count: 1 },\n//             { name: 'cc_shadowColor', type: GFXType.FLOAT4, count: 1 },\n//         ],\n//     };\n//     public view: Float32Array = new Float32Array(UBOShadow.COUNT);\n// }\n// export const localBindingsDesc: Map<string, IInternalBindingDesc> = new Map<string, IInternalBindingDesc>();\n// export class UBOLocal {\n//     public static MAT_WORLD_OFFSET: number = 0;\n//     public static MAT_WORLD_IT_OFFSET: number = UBOLocal.MAT_WORLD_OFFSET + 16;\n//     public static COUNT: number = UBOLocal.MAT_WORLD_IT_OFFSET + 16;\n//     public static SIZE: number = UBOLocal.COUNT * 4;\n//     public static BLOCK: GFXUniformBlock = {\n//         binding: UniformBinding.UBO_LOCAL, name: 'CCLocal', members: [\n//             { name: 'cc_matWorld', type: GFXType.MAT4, count: 1 },\n//             { name: 'cc_matWorldIT', type: GFXType.MAT4, count: 1 },\n//         ],\n//     };\n//     public view: Float32Array = new Float32Array(UBOLocal.COUNT);\n// }\n// localBindingsDesc.set(UBOLocal.BLOCK.name, {\n//     type: GFXBindingType.UNIFORM_BUFFER,\n//     blockInfo: UBOLocal.BLOCK,\n// });\n// export class UBOForwardLight {\n//     public static MAX_SPHERE_LIGHTS = 2;\n//     public static MAX_SPOT_LIGHTS = 2;\n//     public static SPHERE_LIGHT_POS_OFFSET: number = 0;\n//     public static SPHERE_LIGHT_SIZE_RANGE_OFFSET: number = UBOForwardLight.SPHERE_LIGHT_POS_OFFSET + UBOForwardLight.MAX_SPHERE_LIGHTS * 4;\n//     public static SPHERE_LIGHT_COLOR_OFFSET: number = UBOForwardLight.SPHERE_LIGHT_SIZE_RANGE_OFFSET + UBOForwardLight.MAX_SPHERE_LIGHTS * 4;\n//     public static SPOT_LIGHT_POS_OFFSET: number = UBOForwardLight.SPHERE_LIGHT_COLOR_OFFSET + UBOForwardLight.MAX_SPOT_LIGHTS * 4;\n//     public static SPOT_LIGHT_SIZE_RANGE_ANGLE_OFFSET: number = UBOForwardLight.SPOT_LIGHT_POS_OFFSET + UBOForwardLight.MAX_SPOT_LIGHTS * 4;\n//     public static SPOT_LIGHT_DIR_OFFSET: number = UBOForwardLight.SPOT_LIGHT_SIZE_RANGE_ANGLE_OFFSET + UBOForwardLight.MAX_SPOT_LIGHTS * 4;\n//     public static SPOT_LIGHT_COLOR_OFFSET: number = UBOForwardLight.SPOT_LIGHT_DIR_OFFSET + UBOForwardLight.MAX_SPOT_LIGHTS * 4;\n//     public static COUNT: number = UBOForwardLight.SPOT_LIGHT_COLOR_OFFSET + UBOForwardLight.MAX_SPOT_LIGHTS * 4;\n//     public static SIZE: number = UBOForwardLight.COUNT * 4;\n//     public static BLOCK: GFXUniformBlock = {\n//         binding: UniformBinding.UBO_FORWARD_LIGHTS, name: 'CCForwardLight', members: [\n//             { name: 'cc_sphereLitPos', type: GFXType.FLOAT4, count: UBOForwardLight.MAX_SPHERE_LIGHTS },\n//             { name: 'cc_sphereLitSizeRange', type: GFXType.FLOAT4, count: UBOForwardLight.MAX_SPHERE_LIGHTS },\n//             { name: 'cc_sphereLitColor', type: GFXType.FLOAT4, count: UBOForwardLight.MAX_SPHERE_LIGHTS },\n//             { name: 'cc_spotLitPos', type: GFXType.FLOAT4, count: UBOForwardLight.MAX_SPOT_LIGHTS },\n//             { name: 'cc_spotLitSizeRangeAngle', type: GFXType.FLOAT4, count: UBOForwardLight.MAX_SPOT_LIGHTS },\n//             { name: 'cc_spotLitDir', type: GFXType.FLOAT4, count: UBOForwardLight.MAX_SPOT_LIGHTS },\n//             { name: 'cc_spotLitColor', type: GFXType.FLOAT4, count: UBOForwardLight.MAX_SPOT_LIGHTS },\n//         ],\n//     };\n//     public view: Float32Array = new Float32Array(UBOForwardLight.COUNT);\n// }\n// localBindingsDesc.set(UBOForwardLight.BLOCK.name, {\n//     type: GFXBindingType.UNIFORM_BUFFER,\n//     blockInfo: UBOForwardLight.BLOCK,\n// });\n// export class UBOSkinning {\n//     public static MAT_JOINT_OFFSET: number = 0;\n//     public static JOINTS_TEXTURE_SIZE_OFFSET: number = UBOSkinning.MAT_JOINT_OFFSET + 128 * 16;\n//     public static COUNT: number = UBOSkinning.JOINTS_TEXTURE_SIZE_OFFSET + 4;\n//     public static SIZE: number = UBOSkinning.COUNT * 4;\n//     public static BLOCK: GFXUniformBlock = {\n//         binding: UniformBinding.UBO_SKINNING, name: 'CCSkinning', members: [\n//             { name: 'cc_matJoint', type: GFXType.MAT4, count: 128 },\n//             { name: 'cc_jointsTextureSize', type: GFXType.FLOAT4, count: 1 },\n//         ],\n//     };\n// }\n// localBindingsDesc.set(UBOSkinning.BLOCK.name, {\n//     type: GFXBindingType.UNIFORM_BUFFER,\n//     blockInfo: UBOSkinning.BLOCK,\n// });\n// export const UNIFORM_JOINTS_TEXTURE: GFXUniformSampler = {\n//     binding: UniformBinding.SAMPLER_JOINTS, name: 'cc_jointsTexture', type: GFXType.SAMPLER2D, count: 1,\n// };\n// localBindingsDesc.set(UNIFORM_JOINTS_TEXTURE.name, {\n//     type: GFXBindingType.SAMPLER,\n//     samplerInfo: UNIFORM_JOINTS_TEXTURE,\n// });\n// export interface IInternalBindingDesc {\n//     type: GFXBindingType;\n//     blockInfo?: GFXUniformBlock;\n//     samplerInfo?: GFXUniformSampler;\n// }\n// export interface IInternalBindingInst extends IInternalBindingDesc {\n//     buffer?: GFXBuffer;\n//     sampler?: GFXSampler;\n//     textureView?: GFXTextureView;\n// }\n\n// this file is used for offline effect building.\nvar _a, _b;\nvar SamplerInfoIndex;\n(function (SamplerInfoIndex) {\n    SamplerInfoIndex[SamplerInfoIndex[\"minFilter\"] = 0] = \"minFilter\";\n    SamplerInfoIndex[SamplerInfoIndex[\"magFilter\"] = 1] = \"magFilter\";\n    SamplerInfoIndex[SamplerInfoIndex[\"mipFilter\"] = 2] = \"mipFilter\";\n    SamplerInfoIndex[SamplerInfoIndex[\"addressU\"] = 3] = \"addressU\";\n    SamplerInfoIndex[SamplerInfoIndex[\"addressV\"] = 4] = \"addressV\";\n    SamplerInfoIndex[SamplerInfoIndex[\"addressW\"] = 5] = \"addressW\";\n    SamplerInfoIndex[SamplerInfoIndex[\"maxAnisotropy\"] = 6] = \"maxAnisotropy\";\n    SamplerInfoIndex[SamplerInfoIndex[\"cmpFunc\"] = 7] = \"cmpFunc\";\n    SamplerInfoIndex[SamplerInfoIndex[\"minLOD\"] = 8] = \"minLOD\";\n    SamplerInfoIndex[SamplerInfoIndex[\"maxLOD\"] = 9] = \"maxLOD\";\n    SamplerInfoIndex[SamplerInfoIndex[\"mipLODBias\"] = 10] = \"mipLODBias\";\n    SamplerInfoIndex[SamplerInfoIndex[\"borderColor\"] = 11] = \"borderColor\";\n    SamplerInfoIndex[SamplerInfoIndex[\"total\"] = 15] = \"total\";\n})(SamplerInfoIndex || (SamplerInfoIndex = {}));\nvar typeMap = {};\ntypeMap[typeMap['bool'] = GFXType.BOOL] = 'bool';\ntypeMap[typeMap['int'] = GFXType.INT] = 'int';\ntypeMap[typeMap['ivec2'] = GFXType.INT2] = 'ivec2invTypeParams';\ntypeMap[typeMap['ivec3'] = GFXType.INT3] = 'ivec3';\ntypeMap[typeMap['ivec4'] = GFXType.INT4] = 'ivec4';\ntypeMap[typeMap['float'] = GFXType.FLOAT] = 'float';\ntypeMap[typeMap['vec2'] = GFXType.FLOAT2] = 'vec2';\ntypeMap[typeMap['vec3'] = GFXType.FLOAT3] = 'vec3';\ntypeMap[typeMap['vec4'] = GFXType.FLOAT4] = 'vec4';\ntypeMap[typeMap['mat2'] = GFXType.MAT2] = 'mat2';\ntypeMap[typeMap['mat3'] = GFXType.MAT3] = 'mat3';\ntypeMap[typeMap['mat4'] = GFXType.MAT4] = 'mat4';\ntypeMap[typeMap['sampler2D'] = GFXType.SAMPLER2D] = 'sampler2D';\ntypeMap[typeMap['samplerCube'] = GFXType.SAMPLER_CUBE] = 'samplerCube';\nvar sizeMap = (_a = {},\n    _a[GFXType.BOOL] = 4,\n    _a[GFXType.INT] = 4,\n    _a[GFXType.INT2] = 8,\n    _a[GFXType.INT3] = 12,\n    _a[GFXType.INT4] = 16,\n    _a[GFXType.FLOAT] = 4,\n    _a[GFXType.FLOAT2] = 8,\n    _a[GFXType.FLOAT3] = 12,\n    _a[GFXType.FLOAT4] = 16,\n    _a[GFXType.MAT2] = 16,\n    _a[GFXType.MAT3] = 36,\n    _a[GFXType.MAT4] = 64,\n    _a[GFXType.SAMPLER2D] = 4,\n    _a[GFXType.SAMPLER_CUBE] = 4,\n    _a);\nvar formatMap = (_b = {},\n    _b[GFXType.BOOL] = GFXFormat.R32I,\n    _b[GFXType.INT] = GFXFormat.R32I,\n    _b[GFXType.INT2] = GFXFormat.RG32I,\n    _b[GFXType.INT3] = GFXFormat.RGB32I,\n    _b[GFXType.INT4] = GFXFormat.RGBA32I,\n    _b[GFXType.FLOAT] = GFXFormat.R32F,\n    _b[GFXType.FLOAT2] = GFXFormat.RG32F,\n    _b[GFXType.FLOAT3] = GFXFormat.RGB32F,\n    _b[GFXType.FLOAT4] = GFXFormat.RGBA32F,\n    _b);\n// const passParams = {\n//   // color mask\n//   NONE: gfx.GFXColorMask.NONE,\n//   R: gfx.GFXColorMask.R,\n//   G: gfx.GFXColorMask.G,\n//   B: gfx.GFXColorMask.B,\n//   A: gfx.GFXColorMask.A,\n//   RG: gfx.GFXColorMask.R | gfx.GFXColorMask.G,\n//   RB: gfx.GFXColorMask.R | gfx.GFXColorMask.B,\n//   RA: gfx.GFXColorMask.R | gfx.GFXColorMask.A,\n//   GB: gfx.GFXColorMask.G | gfx.GFXColorMask.B,\n//   GA: gfx.GFXColorMask.G | gfx.GFXColorMask.A,\n//   BA: gfx.GFXColorMask.B | gfx.GFXColorMask.A,\n//   RGB: gfx.GFXColorMask.R | gfx.GFXColorMask.G | gfx.GFXColorMask.B,\n//   RGA: gfx.GFXColorMask.R | gfx.GFXColorMask.G | gfx.GFXColorMask.A,\n//   RBA: gfx.GFXColorMask.R | gfx.GFXColorMask.B | gfx.GFXColorMask.A,\n//   GBA: gfx.GFXColorMask.G | gfx.GFXColorMask.B | gfx.GFXColorMask.A,\n//   ALL: gfx.GFXColorMask.ALL,\n//   // blend operation\n//   ADD: gfx.GFXBlendOp.ADD,\n//   SUB: gfx.GFXBlendOp.SUB,\n//   REV_SUB: gfx.GFXBlendOp.REV_SUB,\n//   MIN: gfx.GFXBlendOp.MIN,\n//   MAX: gfx.GFXBlendOp.MAX,\n//   // blend factor\n//   ZERO: gfx.GFXBlendFactor.ZERO,\n//   ONE: gfx.GFXBlendFactor.ONE,\n//   SRC_ALPHA: gfx.GFXBlendFactor.SRC_ALPHA,\n//   DST_ALPHA: gfx.GFXBlendFactor.DST_ALPHA,\n//   ONE_MINUS_SRC_ALPHA: gfx.GFXBlendFactor.ONE_MINUS_SRC_ALPHA,\n//   ONE_MINUS_DST_ALPHA: gfx.GFXBlendFactor.ONE_MINUS_DST_ALPHA,\n//   SRC_COLOR: gfx.GFXBlendFactor.SRC_COLOR,\n//   DST_COLOR: gfx.GFXBlendFactor.DST_COLOR,\n//   ONE_MINUS_SRC_COLOR: gfx.GFXBlendFactor.ONE_MINUS_SRC_COLOR,\n//   ONE_MINUS_DST_COLOR: gfx.GFXBlendFactor.ONE_MINUS_DST_COLOR,\n//   SRC_ALPHA_SATURATE: gfx.GFXBlendFactor.SRC_ALPHA_SATURATE,\n//   CONSTANT_COLOR: gfx.GFXBlendFactor.CONSTANT_COLOR,\n//   ONE_MINUS_CONSTANT_COLOR: gfx.GFXBlendFactor.ONE_MINUS_CONSTANT_COLOR,\n//   CONSTANT_ALPHA: gfx.GFXBlendFactor.CONSTANT_ALPHA,\n//   ONE_MINUS_CONSTANT_ALPHA: gfx.GFXBlendFactor.ONE_MINUS_CONSTANT_ALPHA,\n//   // stencil operation\n//   // ZERO: GFXStencilOp.ZERO, // duplicate, safely removed because enum value is(and always will be) the same\n//   KEEP: gfx.GFXStencilOp.KEEP,\n//   REPLACE: gfx.GFXStencilOp.REPLACE,\n//   INCR: gfx.GFXStencilOp.INCR,\n//   DECR: gfx.GFXStencilOp.DECR,\n//   INVERT: gfx.GFXStencilOp.INVERT,\n//   INCR_WRAP: gfx.GFXStencilOp.INCR_WRAP,\n//   DECR_WRAP: gfx.GFXStencilOp.DECR_WRAP,\n//     // comparison function\n//   NEVER: gfx.GFXComparisonFunc.NEVER,\n//   LESS: gfx.GFXComparisonFunc.LESS,\n//   EQUAL: gfx.GFXComparisonFunc.EQUAL,\n//   LESS_EQUAL: gfx.GFXComparisonFunc.LESS_EQUAL,\n//   GREATER: gfx.GFXComparisonFunc.GREATER,\n//   NOT_EQUAL: gfx.GFXComparisonFunc.NOT_EQUAL,\n//   GREATER_EQUAL: gfx.GFXComparisonFunc.GREATER_EQUAL,\n//   ALWAYS: gfx.GFXComparisonFunc.ALWAYS,\n//   // cull mode\n//   // NONE: GFXCullMode.NONE, // duplicate, safely removed because enum value is(and always will be) the same\n//   FRONT: gfx.GFXCullMode.FRONT,\n//   BACK: gfx.GFXCullMode.BACK,\n//   // shade mode\n//   GOURAND: gfx.GFXShadeModel.GOURAND,\n//   FLAT: gfx.GFXShadeModel.FLAT,\n//   // polygon mode\n//   FILL: gfx.GFXPolygonMode.FILL,\n//   LINE: gfx.GFXPolygonMode.LINE,\n//   POINT: gfx.GFXPolygonMode.POINT,\n//   // primitive mode\n//   POINT_LIST: gfx.GFXPrimitiveMode.POINT_LIST,\n//   LINE_LIST: gfx.GFXPrimitiveMode.LINE_LIST,\n//   LINE_STRIP: gfx.GFXPrimitiveMode.LINE_STRIP,\n//   LINE_LOOP: gfx.GFXPrimitiveMode.LINE_LOOP,\n//   TRIANGLE_LIST: gfx.GFXPrimitiveMode.TRIANGLE_LIST,\n//   TRIANGLE_STRIP: gfx.GFXPrimitiveMode.TRIANGLE_STRIP,\n//   TRIANGLE_FAN: gfx.GFXPrimitiveMode.TRIANGLE_FAN,\n//   LINE_LIST_ADJACENCY: gfx.GFXPrimitiveMode.LINE_LIST_ADJACENCY,\n//   LINE_STRIP_ADJACENCY: gfx.GFXPrimitiveMode.LINE_STRIP_ADJACENCY,\n//   TRIANGLE_LIST_ADJACENCY: gfx.GFXPrimitiveMode.TRIANGLE_LIST_ADJACENCY,\n//   TRIANGLE_STRIP_ADJACENCY: gfx.GFXPrimitiveMode.TRIANGLE_STRIP_ADJACENCY,\n//   TRIANGLE_PATCH_ADJACENCY: gfx.GFXPrimitiveMode.TRIANGLE_PATCH_ADJACENCY,\n//   QUAD_PATCH_LIST: gfx.GFXPrimitiveMode.QUAD_PATCH_LIST,\n//   ISO_LINE_LIST: gfx.GFXPrimitiveMode.ISO_LINE_LIST,\n//   // POINT: gfx.GFXFilter.POINT, // duplicate, safely removed because enum value is(and always will be) the same\n//   LINEAR: gfx.GFXFilter.LINEAR,\n//   ANISOTROPIC: gfx.GFXFilter.ANISOTROPIC,\n//   WRAP: gfx.GFXAddress.WRAP,\n//   MIRROR: gfx.GFXAddress.MIRROR,\n//   CLAMP: gfx.GFXAddress.CLAMP,\n//   BORDER: gfx.GFXAddress.BORDER,\n//   VIEWPORT: gfx.GFXDynamicState.VIEWPORT,\n//   SCISSOR: gfx.GFXDynamicState.SCISSOR,\n//   LINE_WIDTH: gfx.GFXDynamicState.LINE_WIDTH,\n//   DEPTH_BIAS: gfx.GFXDynamicState.DEPTH_BIAS,\n//   BLEND_CONSTANTS: gfx.GFXDynamicState.BLEND_CONSTANTS,\n//   DEPTH_BOUNDS: gfx.GFXDynamicState.DEPTH_BOUNDS,\n//   STENCIL_WRITE_MASK: gfx.GFXDynamicState.STENCIL_WRITE_MASK,\n//   STENCIL_COMPARE_MASK: gfx.GFXDynamicState.STENCIL_COMPARE_MASK,\n//   TRUE: true,\n//   FALSE: false\n// };\nvar passParams = {\n    BACK: enums.CULL_BACK,\n    FRONT: enums.CULL_FRONT,\n    NONE: enums.CULL_NONE,\n    ADD: enums.BLEND_FUNC_ADD,\n    SUB: enums.BLEND_FUNC_SUBTRACT,\n    REV_SUB: enums.BLEND_FUNC_REVERSE_SUBTRACT,\n    ZERO: enums.BLEND_ZERO,\n    ONE: enums.BLEND_ONE,\n    SRC_COLOR: enums.BLEND_SRC_COLOR,\n    ONE_MINUS_SRC_COLOR: enums.BLEND_ONE_MINUS_SRC_COLOR,\n    DST_COLOR: enums.BLEND_DST_COLOR,\n    ONE_MINUS_DST_COLOR: enums.BLEND_ONE_MINUS_DST_COLOR,\n    SRC_ALPHA: enums.BLEND_SRC_ALPHA,\n    ONE_MINUS_SRC_ALPHA: enums.BLEND_ONE_MINUS_SRC_ALPHA,\n    DST_ALPHA: enums.BLEND_DST_ALPHA,\n    ONE_MINUS_DST_ALPHA: enums.BLEND_ONE_MINUS_DST_ALPHA,\n    CONSTANT_COLOR: enums.BLEND_CONSTANT_COLOR,\n    ONE_MINUS_CONSTANT_COLOR: enums.BLEND_ONE_MINUS_CONSTANT_COLOR,\n    CONSTANT_ALPHA: enums.BLEND_CONSTANT_ALPHA,\n    ONE_MINUS_CONSTANT_ALPHA: enums.BLEND_ONE_MINUS_CONSTANT_ALPHA,\n    SRC_ALPHA_SATURATE: enums.BLEND_SRC_ALPHA_SATURATE,\n    NEVER: enums.DS_FUNC_NEVER,\n    LESS: enums.DS_FUNC_LESS,\n    EQUAL: enums.DS_FUNC_EQUAL,\n    LEQUAL: enums.DS_FUNC_LEQUAL,\n    GREATER: enums.DS_FUNC_GREATER,\n    NOTEQUAL: enums.DS_FUNC_NOTEQUAL,\n    GEQUAL: enums.DS_FUNC_GEQUAL,\n    ALWAYS: enums.DS_FUNC_ALWAYS,\n    KEEP: enums.STENCIL_OP_KEEP,\n    REPLACE: enums.STENCIL_OP_REPLACE,\n    INCR: enums.STENCIL_OP_INCR,\n    INCR_WRAP: enums.STENCIL_OP_INCR_WRAP,\n    DECR: enums.STENCIL_OP_DECR,\n    DECR_WRAP: enums.STENCIL_OP_DECR_WRAP,\n    INVERT: enums.STENCIL_OP_INVERT\n};\nObject.assign(passParams, RenderPassStage);\n// for structural type checking\n// an 'any' key will check against all elements defined in that object\n// a key start with '$' means its essential, and can't be undefined\nvar effectStructure = {\n    $techniques: [\n        {\n            $passes: [\n                {\n                    depthStencilState: {},\n                    rasterizerState: {},\n                    blendState: { targets: [{}] },\n                    properties: { any: { sampler: {}, inspector: {} } }\n                }\n            ]\n        }\n    ]\n};\nvar mappings = {\n    murmurhash2_32_gc: murmurhash2_32_gc,\n    SamplerInfoIndex: SamplerInfoIndex,\n    effectStructure: effectStructure,\n    typeMap: typeMap,\n    sizeMap: sizeMap,\n    formatMap: formatMap,\n    passParams: passParams,\n    RenderQueue: RenderQueue,\n    RenderPriority: RenderPriority,\n    GFXGetTypeSize: GFXGetTypeSize,\n    UniformBinding: UniformBinding\n};\n\nmodule.exports = mappings;\n","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd. \n\nimport { RecyclePool } from '../memop';\nimport enums from '../enums';\nimport { Vec2, Vec4, Mat3, Mat4, Color, Vec3 } from '../../core/value-types';\nimport ProgramLib from './program-lib';\nimport View from './view';\nimport gfx from '../gfx';\n\nlet _m4_tmp = new Mat4();\n\nlet _stageInfos = new RecyclePool(() => {\n  return {\n    stage: null,\n    items: null,\n  };\n}, 8);\n\nlet _float2_pool = new RecyclePool(() => {\n  return new Float32Array(2);\n}, 8);\n\nlet _float3_pool = new RecyclePool(() => {\n  return new Float32Array(3);\n}, 8);\n\nlet _float4_pool = new RecyclePool(() => {\n  return new Float32Array(4);\n}, 8);\n\nlet _float9_pool = new RecyclePool(() => {\n  return new Float32Array(9);\n}, 8);\n\nlet _float16_pool = new RecyclePool(() => {\n  return new Float32Array(16);\n}, 8);\n\nlet _float64_pool = new RecyclePool(() => {\n  return new Float32Array(64);\n}, 8);\n\nlet _int2_pool = new RecyclePool(() => {\n  return new Int32Array(2);\n}, 8);\n\nlet _int3_pool = new RecyclePool(() => {\n  return new Int32Array(3);\n}, 8);\n\nlet _int4_pool = new RecyclePool(() => {\n  return new Int32Array(4);\n}, 8);\n\nlet _int64_pool = new RecyclePool(() => {\n  return new Int32Array(64);\n}, 8);\n\nexport default class Base {\n  /**\n   * @param {gfx.Device} device\n   * @param {Object} opts\n   * @param {gfx.Texture2D} opts.defaultTexture\n   * @param {gfx.TextureCube} opts.defaultTextureCube\n   */\n  constructor (device, opts) {\n    this._device = device;\n    this._programLib = new ProgramLib(device);\n    this._opts = opts;\n    this._type2defaultValue = {\n      [enums.PARAM_INT]: 0,\n      [enums.PARAM_INT2]: new Vec2(0, 0),\n      [enums.PARAM_INT3]: new Vec3(0, 0, 0),\n      [enums.PARAM_INT4]: new Vec4(0, 0, 0, 0),\n      [enums.PARAM_FLOAT]: 0.0,\n      [enums.PARAM_FLOAT2]: new Vec2(0, 0),\n      [enums.PARAM_FLOAT3]: new Vec3(0, 0, 0),\n      [enums.PARAM_FLOAT4]: new Vec4(0, 0, 0, 0),\n      [enums.PARAM_COLOR4]: new Color(0, 0, 0, 1),\n      [enums.PARAM_MAT3]: new Mat3(),\n      [enums.PARAM_MAT4]: new Mat4(),\n      [enums.PARAM_TEXTURE_2D]: opts.defaultTexture,\n      [enums.PARAM_TEXTURE_CUBE]: opts.defaultTextureCube,\n    };\n    this._stage2fn = {};\n    this._usedTextureUnits = 0;\n\n    this._viewPools = new RecyclePool(() => {\n      return new View();\n    }, 8);\n\n    this._drawItemsPools = new RecyclePool(() => {\n      return {\n        model: null,\n        node: null,\n        ia: null,\n        effect: null,\n        defines: null,\n        uniforms: null\n      };\n    }, 100);\n\n    this._stageItemsPools = new RecyclePool(() => {\n      return new RecyclePool(() => {\n        return {\n          model: null,\n          node: null,\n          ia: null,\n          effect: null,\n          defines: null,\n          passes: [],\n          sortKey: -1,\n          uniforms: null\n        };\n      }, 100);\n    }, 16);\n  }\n\n  _resetTextuerUnit () {\n    this._usedTextureUnits = 0;\n  }\n\n  _allocTextureUnit () {\n    const device = this._device;\n\n    let unit = this._usedTextureUnits;\n    if (unit >= device._caps.maxTextureUnits) {\n      console.warn(`Trying to use ${unit} texture units while this GPU supports only ${device._caps.maxTextureUnits}`);\n    }\n\n    this._usedTextureUnits += 1;\n    return unit;\n  }\n\n  _registerStage (name, fn) {\n    this._stage2fn[name] = fn;\n  }\n\n  clear () {\n    this._programLib.clear();\n    this.reset();\n  }\n\n  reset () {\n    this._viewPools.reset();\n    this._stageItemsPools.reset();\n  }\n\n  _requestView () {\n    return this._viewPools.add();\n  }\n\n  _render (view, scene) {\n    const device = this._device;\n\n    // setup framebuffer\n    device.setFrameBuffer(view._framebuffer);\n\n    // setup viewport\n    device.setViewport(\n      view._rect.x,\n      view._rect.y,\n      view._rect.w,\n      view._rect.h\n    );\n\n    // setup clear\n    let clearOpts = {};\n    if (view._clearFlags & enums.CLEAR_COLOR) {\n      clearOpts.color = Vec4.toArray([], view._color);\n    }\n    if (view._clearFlags & enums.CLEAR_DEPTH) {\n      clearOpts.depth = view._depth;\n    }\n    if (view._clearFlags & enums.CLEAR_STENCIL) {\n      clearOpts.stencil = view._stencil;\n    }\n    device.clear(clearOpts);\n\n    // get all draw items\n    this._drawItemsPools.reset();\n\n    for (let i = 0; i < scene._models.length; ++i) {\n      let model = scene._models.data[i];\n\n      // filter model by view\n      if ((model._cullingMask & view._cullingMask) === 0) {\n        continue;\n      }\n\n      let drawItem = this._drawItemsPools.add();\n      model.extractDrawItem(drawItem);\n    }\n\n    // dispatch draw items to different stage\n    _stageInfos.reset();\n\n    for (let i = 0; i < view._stages.length; ++i) {\n      let stage = view._stages[i];\n      let stageItems = this._stageItemsPools.add();\n      stageItems.reset();\n\n      for (let j = 0; j < this._drawItemsPools.length; ++j) {\n        let drawItem = this._drawItemsPools.data[j];\n        let passes = drawItem.effect.stagePasses[stage];\n        if (!passes || passes.length === 0) continue;\n\n        let stageItem = stageItems.add();\n        stageItem.passes = passes;\n        stageItem.model = drawItem.model;\n        stageItem.node = drawItem.node;\n        stageItem.ia = drawItem.ia;\n        stageItem.effect = drawItem.effect;\n        stageItem.defines = drawItem.defines;\n        stageItem.sortKey = -1;\n        stageItem.uniforms = drawItem.uniforms;\n      }\n\n      let stageInfo = _stageInfos.add();\n      stageInfo.stage = stage;\n      stageInfo.items = stageItems;\n    }\n\n    // render stages\n    for (let i = 0; i < _stageInfos.length; ++i) {\n      let info = _stageInfos.data[i];\n      let fn = this._stage2fn[info.stage];\n      fn(view, info.items);\n    }\n  }\n\n  _setProperty (prop) {\n    const device = this._device;\n    let param = prop.value;\n\n    if (param === undefined) {\n      param = prop.val;\n    }\n\n    if (param === undefined) {\n      param = this._type2defaultValue[prop.type];\n    }\n\n    if (param === undefined) {\n      console.warn(`Failed to set technique property ${prop.name}, value not found.`);\n      return;\n    }\n\n    if (\n      prop.type === enums.PARAM_TEXTURE_2D ||\n      prop.type === enums.PARAM_TEXTURE_CUBE\n    ) {\n      if (Array.isArray(param)) {\n        if (param.length > prop.count) {\n          console.error(`Failed to set property [${prop.name}] : The length of texture array [${param.length}] is bigger than [${prop.count}].`);\n          return;\n        }\n        let slots = _int64_pool.add();\n        for (let index = 0; index < param.length; ++index) {\n          slots[index] = this._allocTextureUnit();\n        }\n        device.setTextureArray(prop.name, param, slots);\n      } else {\n        device.setTexture(prop.name, param, this._allocTextureUnit());\n      }\n    } else {\n      if (prop.directly) {\n        device.setUniformDirectly(prop.name, param);\n      }\n      else {\n        device.setUniform(prop.name, param);\n      }\n    }\n  }\n\n  _draw (item) {\n    const device = this._device;\n    const programLib = this._programLib;\n    const { node, ia, passes, effect } = item;\n\n    // reset the pool\n    // NOTE: we can use drawCounter optimize this\n    // TODO: should be configurable\n    _float2_pool.reset();\n    _float3_pool.reset();\n    _float4_pool.reset();\n    _float9_pool.reset();\n    _float16_pool.reset();\n    _float64_pool.reset();\n    _int2_pool.reset();\n    _int3_pool.reset();\n    _int4_pool.reset();\n    _int64_pool.reset();\n\n    // set common uniforms\n    // TODO: try commit this depends on effect\n    // {\n    node.getWorldMatrix(_m4_tmp);\n    device.setUniform('cc_matWorld', Mat4.toArray(_float16_pool.add(), _m4_tmp));\n\n    // let wq = node.getWorldRotation(cc.quat());\n    Mat4.invert(_m4_tmp, _m4_tmp);\n    Mat4.transpose(_m4_tmp, _m4_tmp);\n    device.setUniform('cc_matWorldIT', Mat4.toArray(_float16_pool.add(), _m4_tmp));\n    // }\n\n    let defines = this._defines;\n\n    // for each pass\n    for (let i = 0; i < passes.length; ++i) {\n      let pass = passes[i];\n      let count = ia.count;\n\n      // set vertex buffer\n      if (ia._vertexBuffer) {\n        device.setVertexBuffer(0, ia._vertexBuffer);\n      }\n\n      // set index buffer\n      if (ia._indexBuffer) {\n        device.setIndexBuffer(ia._indexBuffer);\n      }\n\n      // set primitive type\n      device.setPrimitiveType(ia._primitiveType);\n\n      // set program\n      Object.setPrototypeOf(defines, pass._defines);\n\n      let program = programLib.getProgram(pass._programName, defines, effect.name);\n      device.setProgram(program);\n\n      let uniforms = program._uniforms;\n      let variants = pass._properties;\n      for (let j = 0; j < uniforms.length; j++) {\n        let prop = variants[uniforms[j].name];\n        if (prop !== undefined)\n        this._setProperty(prop);\n      }\n\n\n      // cull mode\n      device.setCullMode(pass._cullMode);\n\n      // blend\n      if (pass._blend) {\n        device.enableBlend();\n        device.setBlendFuncSep(\n          pass._blendSrc,\n          pass._blendDst,\n          pass._blendSrcAlpha,\n          pass._blendDstAlpha\n        );\n        device.setBlendEqSep(\n          pass._blendEq,\n          pass._blendAlphaEq\n        );\n        device.setBlendColor32(pass._blendColor);\n      }\n\n      // depth test & write\n      if (pass._depthTest) {\n        device.enableDepthTest();\n        device.setDepthFunc(pass._depthFunc);\n      }\n      if (pass._depthWrite) {\n        device.enableDepthWrite();\n      }\n\n      // stencil\n      device.setStencilTest(pass._stencilTest);\n      if (pass._stencilTest === gfx.STENCIL_ENABLE) {\n        // front\n        device.setStencilFuncFront(\n          pass._stencilFuncFront,\n          pass._stencilRefFront,\n          pass._stencilMaskFront\n        );\n        device.setStencilOpFront(\n          pass._stencilFailOpFront,\n          pass._stencilZFailOpFront,\n          pass._stencilZPassOpFront,\n          pass._stencilWriteMaskFront\n        );\n\n        // back\n        device.setStencilFuncBack(\n          pass._stencilFuncBack,\n          pass._stencilRefBack,\n          pass._stencilMaskBack\n        );\n        device.setStencilOpBack(\n          pass._stencilFailOpBack,\n          pass._stencilZFailOpBack,\n          pass._stencilZPassOpBack,\n          pass._stencilWriteMaskBack\n        );\n      }\n\n      // draw pass\n      device.draw(ia._start, count);\n\n      this._resetTextuerUnit();\n    }\n  }\n}","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\nimport gfx from '../gfx';\n\nexport default class InputAssembler {\n  constructor(vb, ib, pt = gfx.PT_TRIANGLES) {\n    this._vertexBuffer = vb;\n    this._indexBuffer = ib;\n    this._primitiveType = pt;\n    this._start = 0;\n    this._count = -1;\n\n    // TODO: instancing data\n    // this._stream = 0;\n  }\n\n  /**\n   * @property {Number} count The number of indices or vertices to dispatch in the draw call.\n   */\n  get count() {\n    if (this._count !== -1) {\n      return this._count;\n    }\n\n    if (this._indexBuffer) {\n      return this._indexBuffer.count;\n    }\n\n    if (this._vertexBuffer) {\n      return this._vertexBuffer.count;\n    }\n\n    return 0;\n  }\n}","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\nimport gfx from '../gfx';\nimport enums from '../enums';\nimport ValueType from '../../core/value-types/value-type';\n\nexport default class Pass {\n    constructor (name, detailName, programName, stage, properties = {}, defines = {}) {\n        this._name = name;\n        this._detailName = detailName;\n        this._programName = programName;\n        this._stage = stage;\n        this._properties = properties;\n        this._defines = defines;\n\n        // cullmode\n        this._cullMode = gfx.CULL_BACK;\n\n        // blending\n        this._blend = false;\n        this._blendEq = gfx.BLEND_FUNC_ADD;\n        this._blendAlphaEq = gfx.BLEND_FUNC_ADD;\n        this._blendSrc = gfx.BLEND_SRC_ALPHA;\n        this._blendDst = gfx.BLEND_ONE_MINUS_SRC_ALPHA;\n        this._blendSrcAlpha = gfx.BLEND_SRC_ALPHA;\n        this._blendDstAlpha = gfx.BLEND_ONE_MINUS_SRC_ALPHA;\n        this._blendColor = 0xffffffff;\n\n        // depth\n        this._depthTest = false;\n        this._depthWrite = false;\n        this._depthFunc = gfx.DS_FUNC_LESS,\n\n        // stencil\n        this._stencilTest = gfx.STENCIL_INHERIT;\n        \n        // front\n        this._stencilFuncFront = gfx.DS_FUNC_ALWAYS;\n        this._stencilRefFront = 0;\n        this._stencilMaskFront = 0xff;\n        this._stencilFailOpFront = gfx.STENCIL_OP_KEEP;\n        this._stencilZFailOpFront = gfx.STENCIL_OP_KEEP;\n        this._stencilZPassOpFront = gfx.STENCIL_OP_KEEP;\n        this._stencilWriteMaskFront = 0xff;\n        // back\n        this._stencilFuncBack = gfx.DS_FUNC_ALWAYS;\n        this._stencilRefBack = 0;\n        this._stencilMaskBack = 0xff;\n        this._stencilFailOpBack = gfx.STENCIL_OP_KEEP;\n        this._stencilZFailOpBack = gfx.STENCIL_OP_KEEP;\n        this._stencilZPassOpBack = gfx.STENCIL_OP_KEEP;\n        this._stencilWriteMaskBack = 0xff;\n    }\n\n    setCullMode (cullMode = gfx.CULL_BACK) {\n        this._cullMode = cullMode;\n    }\n\n    setBlend (\n        enabled = false,\n        blendEq = gfx.BLEND_FUNC_ADD,\n        blendSrc = gfx.BLEND_SRC_ALPHA,\n        blendDst = gfx.BLEND_ONE_MINUS_SRC_ALPHA,\n        blendAlphaEq = gfx.BLEND_FUNC_ADD,\n        blendSrcAlpha = gfx.BLEND_SRC_ALPHA,\n        blendDstAlpha = gfx.BLEND_ONE_MINUS_SRC_ALPHA,\n        blendColor = 0xffffffff\n    ) {\n        this._blend = enabled;\n        this._blendEq = blendEq;\n        this._blendSrc = blendSrc;\n        this._blendDst = blendDst;\n        this._blendAlphaEq = blendAlphaEq;\n        this._blendSrcAlpha = blendSrcAlpha;\n        this._blendDstAlpha = blendDstAlpha;\n        this._blendColor = blendColor;\n    }\n\n    setDepth (\n        depthTest = false,\n        depthWrite = false,\n        depthFunc = gfx.DS_FUNC_LESS\n    ) {\n        this._depthTest = depthTest;\n        this._depthWrite = depthWrite;\n        this._depthFunc = depthFunc;\n    }\n\n    setStencilFront (\n        enabled = gfx.STENCIL_INHERIT,\n        stencilFunc = gfx.DS_FUNC_ALWAYS,\n        stencilRef = 0,\n        stencilMask = 0xff,\n        stencilFailOp = gfx.STENCIL_OP_KEEP,\n        stencilZFailOp = gfx.STENCIL_OP_KEEP,\n        stencilZPassOp = gfx.STENCIL_OP_KEEP,\n        stencilWriteMask = 0xff\n    ) {\n        this._stencilTest = enabled;\n        this._stencilFuncFront = stencilFunc;\n        this._stencilRefFront = stencilRef;\n        this._stencilMaskFront = stencilMask;\n        this._stencilFailOpFront = stencilFailOp;\n        this._stencilZFailOpFront = stencilZFailOp;\n        this._stencilZPassOpFront = stencilZPassOp;\n        this._stencilWriteMaskFront = stencilWriteMask;\n    }\n\n    setStencilEnabled (stencilTest = gfx.STENCIL_INHERIT) {\n        this._stencilTest = stencilTest;\n    }\n\n    setStencilBack (\n        stencilTest = gfx.STENCIL_INHERIT,\n        stencilFunc = gfx.DS_FUNC_ALWAYS,\n        stencilRef = 0,\n        stencilMask = 0xff,\n        stencilFailOp = gfx.STENCIL_OP_KEEP,\n        stencilZFailOp = gfx.STENCIL_OP_KEEP,\n        stencilZPassOp = gfx.STENCIL_OP_KEEP,\n        stencilWriteMask = 0xff\n    ) {\n        this._stencilTest = stencilTest;\n        this._stencilFuncBack = stencilFunc;\n        this._stencilRefBack = stencilRef;\n        this._stencilMaskBack = stencilMask;\n        this._stencilFailOpBack = stencilFailOp;\n        this._stencilZFailOpBack = stencilZFailOp;\n        this._stencilZPassOpBack = stencilZPassOp;\n        this._stencilWriteMaskBack = stencilWriteMask;\n    }\n\n    setStage (stage) {\n        this._stage = stage;\n    }\n\n    setProperties (properties) {\n        this._properties = properties;\n    }\n\n    getProperty (name) {\n        if (!this._properties[name]) {\n            return;\n        }\n        return this._properties[name].value;\n    }\n\n    setProperty (name, value, directly) {\n        let prop = this._properties[name];\n        if (!prop) {\n            return false;\n        }\n\n        prop.directly = directly;\n\n        if (Array.isArray(value)) {\n            let array = prop.value;\n            if (array.length !== value.length) {\n                cc.warnID(9105, this._name, name);\n                return;\n            }\n            for (let i = 0; i < value.length; i++) {\n                array[i] = value[i];\n            }\n        }\n        else {\n            if (value && !ArrayBuffer.isView(value)) {\n                if (prop.type === enums.PARAM_TEXTURE_2D) {\n                    prop.value = value.getImpl();\n                }\n                else if (value instanceof ValueType) {\n                    value.constructor.toArray(prop.value, value);\n                }\n                else {\n                    if (typeof value === 'object') {\n                        cc.warnID(9106, this._name, name);\n                    }\n                    prop.value = value;\n                }\n            }\n            else {\n                prop.value = value;\n            }\n        }\n\n        return true;\n    }\n\n    getDefine (name) {\n        return this._defines[name];\n    }\n\n    define (name, value, force) {\n        if (!force) {\n            let def = this._defines[name];\n            if (def === undefined) {\n                return false;\n            }\n        }\n\n        this._defines[name] = value;\n\n        return true;\n    }\n\n    clone () {\n        let pass = new Pass(this._programName);\n        Object.assign(pass, this);\n\n        let newProperties = {};\n        let properties = this._properties;\n        for (let name in properties) {\n            let prop = properties[name];\n            let newProp = newProperties[name] = {};\n\n            let value = prop.value;\n            if (Array.isArray(value)) {\n                newProp.value = value.concat();\n            }\n            else if (ArrayBuffer.isView(value)) {\n                newProp.value = new value.__proto__.constructor(value);\n            }\n            else {\n                newProp.value = value;\n            }\n\n            for (let name in prop) {\n                if (name === 'value') continue;\n                newProp[name] = prop[name];\n            }\n        }\n\n        pass._properties = newProperties;\n        pass._defines = Object.assign({}, this._defines);\n\n        return pass;\n    }\n}","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\nimport gfx from '../gfx';\n\nlet _shdID = 0;\n\nfunction _generateDefines(tmpDefines, defines) {\n  let results = [];\n  for (let i = 0; i < tmpDefines.length; i++) {\n    let name = tmpDefines[i].name;\n    let value = defines[name];\n    if (typeof value !== 'number') {\n      value = value ? 1 : 0;\n    }\n    results.push(`#define ${name} ${value}`);\n  }\n  return results.join('\\n') + '\\n';\n}\n\nfunction _replaceMacroNums(string, tmpDefines, defines) {\n  let tmp = string;\n\n  for (let i = 0; i < tmpDefines.length; i++) {\n    let name = tmpDefines[i].name;\n    let value = defines[name];\n    if (Number.isInteger(value)) {\n      let reg = new RegExp(name, 'g');\n      tmp = tmp.replace(reg, value);\n    }\n  }\n  return tmp;\n}\n\nfunction _unrollLoops(string) {\n  let pattern = /#pragma for (\\w+) in range\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)([\\s\\S]+?)#pragma endFor/g;\n  function replace(match, index, begin, end, snippet) {\n    let unroll = '';\n    let parsedBegin = parseInt(begin);\n    let parsedEnd = parseInt(end);\n    if (parsedBegin.isNaN || parsedEnd.isNaN) {\n      console.error('Unroll For Loops Error: begin and end of range must be an int num.');\n    }\n    for (let i = parsedBegin; i < parsedEnd; ++i) {\n      unroll += snippet.replace(new RegExp(`{${index}}`, 'g'), i);\n    }\n    return unroll;\n  }\n  return string.replace(pattern, replace);\n}\n\nfunction _replaceHighp(string) {\n  return string.replace(/\\bhighp\\b/g, 'mediump');\n}\n\nexport default class ProgramLib {\n  /**\n   * @param {gfx.Device} device\n   */\n  constructor(device) {\n    this._device = device;\n\n    // register templates\n    this._templates = {};\n    this._cache = {};\n\n    this._checkPrecision();\n  }\n\n  clear () {\n    this._templates = {};\n    this._cache = {};\n  }\n\n  /**\n   * @param {string} name\n   * @param {string} vert\n   * @param {string} frag\n   * @param {Object[]} defines\n   *\n   * @example:\n   *   // this object is auto-generated from your actual shaders\n   *   let program = {\n   *     name: 'foobar',\n   *     vert: vertTmpl,\n   *     frag: fragTmpl,\n   *     defines: [\n   *       { name: 'shadow', type: 'boolean' },\n   *       { name: 'lightCount', type: 'number', min: 1, max: 4 }\n   *     ],\n   *     attributes: [{ name: 'a_position', type: 'vec3' }],\n   *     uniforms: [{ name: 'color', type: 'vec4' }],\n   *     extensions: ['GL_OES_standard_derivatives'],\n   *   };\n   *   programLib.define(program);\n   */\n  define(prog) {\n    let { name, defines, glsl1 } = prog;\n    let { vert, frag } = glsl1 || prog;\n    if (this._templates[name]) {\n      // console.warn(`Failed to define shader ${name}: already exists.`);\n      return;\n    }\n\n    let id = ++_shdID;\n\n    // calculate option mask offset\n    let offset = 0;\n    for (let i = 0; i < defines.length; ++i) {\n      let def = defines[i];\n      let cnt = 1;\n\n      if (def.type === 'number') {\n        let range = def.range || [];\n        def.min = range[0] || 0;\n        def.max = range[1] || 4;\n        cnt = Math.ceil(Math.log2(def.max - def.min));\n\n        def._map = function (value) {\n          return (value - this.min) << this._offset;\n        }.bind(def);\n      } else { // boolean\n        def._map = function (value) {\n          if (value) {\n            return 1 << this._offset;\n          }\n          return 0;\n        }.bind(def);\n      }\n\n      def._offset = offset;\n      offset += cnt;\n    }\n\n    let uniforms = prog.uniforms || [];\n\n    if (prog.samplers) {\n      for (let i = 0; i < prog.samplers.length; i++) {\n        uniforms.push(prog.samplers[i])\n      }\n    }\n    if (prog.blocks) {\n      for (let i = 0; i < prog.blocks.length; i++) {\n        let defines = prog.blocks[i].defines;\n        let members = prog.blocks[i].members;\n        for (let j = 0; j < members.length; j++) {\n          uniforms.push({\n            defines,\n            name: members[j].name,\n            type: members[j].type,\n          })\n        }\n      }\n    }\n\n    // store it\n    this._templates[name] = {\n      id,\n      name,\n      vert,\n      frag,\n      defines,\n      attributes: prog.attributes,\n      uniforms,\n      extensions: prog.extensions\n    };\n  }\n\n  getTemplate(name) {\n    return this._templates[name];\n  }\n\n  /**\n   * Does this library has the specified program?\n   * @param {string} name\n   * @returns {boolean}\n   */\n  hasProgram(name) {\n    return this._templates[name] !== undefined;\n  }\n\n  getKey(name, defines) {\n    let tmpl = this._templates[name];\n    let key = 0;\n    for (let i = 0; i < tmpl.defines.length; ++i) {\n      let tmplDefs = tmpl.defines[i];\n      \n      let value = defines[tmplDefs.name];\n      if (value === undefined) {\n        continue;\n      }\n\n      key |= tmplDefs._map(value);\n    }\n\n    // return key << 8 | tmpl.id;\n    // key number maybe bigger than 32 bit, need use string to store value.\n    return tmpl.id + ':' + key;\n  }\n\n  getProgram(name, defines, errPrefix) {\n    let key = this.getKey(name, defines);\n    let program = this._cache[key];\n    if (program) {\n      return program;\n    }\n\n    // get template\n    let tmpl = this._templates[name];\n    let customDef = _generateDefines(tmpl.defines, defines);\n    let vert = _replaceMacroNums(tmpl.vert, tmpl.defines, defines);\n    vert = customDef + _unrollLoops(vert);\n    if (!this._highpSupported) {\n      vert = _replaceHighp(vert);\n    }\n\n    let frag = _replaceMacroNums(tmpl.frag, tmpl.defines, defines);\n    frag = customDef + _unrollLoops(frag);\n    if (!this._highpSupported) {\n      frag = _replaceHighp(frag);\n    }\n\n    program = new gfx.Program(this._device, {\n      vert,\n      frag\n    });\n    let errors = program.link();\n    if (errors) {\n      let vertLines = vert.split('\\n');\n      let fragLines = frag.split('\\n');\n      let defineLength = tmpl.defines.length;\n      errors.forEach(err => {\n        let line = err.line - 1;\n        let originLine = err.line - defineLength;\n\n        let lines = err.type === 'vs' ? vertLines : fragLines;\n        // let source = ` ${lines[line-1]}\\n>${lines[line]}\\n ${lines[line+1]}`;\n        let source = lines[line];\n\n        let info = err.info || `Failed to compile ${err.type} ${err.fileID} (ln ${originLine}): \\n ${err.message}: \\n  ${source}`;\n        cc.error(`${errPrefix} : ${info}`);\n      })\n    }\n    this._cache[key] = program;\n\n    return program;\n  }\n\n  _checkPrecision () {\n    let gl = this._device._gl;\n    let highpSupported = false;\n    if (gl.getShaderPrecisionFormat) {\n        let vertHighp = gl.getShaderPrecisionFormat(gl.VERTEX_SHADER, gl.HIGH_FLOAT);\n        let fragHighp = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);\n        highpSupported = (vertHighp && vertHighp.precision > 0) &&\n          (fragHighp && fragHighp.precision > 0);\n    }\n    if (!highpSupported) {\n      cc.warnID(9102);\n    }\n    this._highpSupported = highpSupported;\n  }\n}\n","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\nexport default class Technique {\n  constructor(name, passes) {\n    this._name = name;\n    this._passes = passes;\n  }\n\n  get name () {\n    return this._name;\n  }\n\n  get passes() {\n    return this._passes;\n  }\n\n  clone () {\n    let passes = [];\n    for (let i = 0; i < this._passes.length; i++) {\n      passes.push(this._passes[i].clone());\n    }\n    return new Technique(this._name, passes);\n  }\n}","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\nimport { Vec3, Mat4, Vec4 } from '../../core/value-types';\nimport enums from '../enums';\n\nlet _m4_tmp = new Mat4();\nlet _genID = 0;\n\n/**\n * A representation of a single camera view\n */\nexport default class View {\n  /**\n   * Setup a default view\n   */\n  constructor() {\n    this._id = _genID++;\n\n    // priority. the smaller one will be rendered first\n    this._priority = 0;\n\n    // viewport\n    this._rect = {\n      x: 0, y: 0, w: 1, h: 1\n    };\n\n    // TODO:\n    // this._scissor = {\n    //   x: 0, y: 0, w: 1, h: 1\n    // };\n\n    // clear options\n    this._color = new Vec4(0.3, 0.3, 0.3, 1);\n    this._depth = 1;\n    this._stencil = 0;\n    this._clearFlags = enums.CLEAR_COLOR | enums.CLEAR_DEPTH;\n    this._clearModel = null;\n\n    // matrix\n    this._matView = cc.mat4();\n    this._matViewInv = cc.mat4();\n    this._matProj = cc.mat4();\n    this._matViewProj = cc.mat4();\n    this._matInvViewProj = cc.mat4();\n\n    // stages & framebuffer\n    this._stages = [];\n    this._cullingByID = false;\n    this._framebuffer = null;\n\n    this._shadowLight = null; // TODO: should not refer light in view.\n\n    this._cullingMask = 0xffffffff;\n  }\n\n  /**\n   * Get the view's forward direction\n   * @param {Vec3} out the receiving vector\n   * @returns {Vec3} the receiving vector\n   */\n  getForward(out) {\n    let m = this._matView.m;\n    return Vec3.set(\n      out,\n      -m[2],\n      -m[6],\n      -m[10]\n    );\n  }\n\n  /**\n   * Get the view's observing location\n   * @param {Vec3} out the receiving vector\n   * @returns {Vec3} the receiving vector\n   */\n  getPosition(out) {\n    Mat4.invert(_m4_tmp, this._matView);\n    return Mat4.getTranslation(out, _m4_tmp);\n  }\n}\n","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\nimport { typeMap } from './build/mappings'\n\nexport default {\n  // projection\n  PROJ_PERSPECTIVE: 0,\n  PROJ_ORTHO: 1,\n\n  // lights\n  LIGHT_DIRECTIONAL: 0,\n  LIGHT_POINT: 1,\n  LIGHT_SPOT: 2,\n  LIGHT_AMBIENT: 3,\n\n  // shadows\n  SHADOW_NONE: 0,\n  SHADOW_HARD: 1,\n  SHADOW_SOFT: 2,\n\n  // parameter type\n  PARAM_INT:             typeMap.int,\n  PARAM_INT2:            typeMap.ivec2,\n  PARAM_INT3:            typeMap.ivec3,\n  PARAM_INT4:            typeMap.ivec4,\n  PARAM_FLOAT:           typeMap.float,\n  PARAM_FLOAT2:          typeMap.vec2,\n  PARAM_FLOAT3:          typeMap.vec3,\n  PARAM_FLOAT4:          typeMap.vec4,\n  PARAM_MAT2:            typeMap.mat2,\n  PARAM_MAT3:            typeMap.mat3,\n  PARAM_MAT4:            typeMap.mat4,\n  PARAM_TEXTURE_2D:      typeMap.sampler2D,\n  PARAM_TEXTURE_CUBE:    typeMap.samplerCube,\n\n  // clear flags\n  CLEAR_COLOR: 1,\n  CLEAR_DEPTH: 2,\n  CLEAR_STENCIL: 4,\n  CLEAR_SKYBOX: 8,\n\n  //\n  BUFFER_VIEW_INT8: 0,\n  BUFFER_VIEW_UINT8: 1,\n  BUFFER_VIEW_INT16: 2,\n  BUFFER_VIEW_UINT16: 3,\n  BUFFER_VIEW_INT32: 4,\n  BUFFER_VIEW_UINT32: 5,\n  BUFFER_VIEW_FLOAT32: 6,\n};\n","import State from './state';\nimport { enums } from './enums';\n\nimport Texture2D from './texture-2d';\nimport TextureCube from './texture-cube';\n\nconst GL_INT = 5124;\nconst GL_FLOAT = 5126;\nconst GL_FLOAT_VEC2 = 35664;\nconst GL_FLOAT_VEC3 = 35665;\nconst GL_FLOAT_VEC4 = 35666;\nconst GL_INT_VEC2 = 35667;\nconst GL_INT_VEC3 = 35668;\nconst GL_INT_VEC4 = 35669;\nconst GL_BOOL = 35670;\nconst GL_BOOL_VEC2 = 35671;\nconst GL_BOOL_VEC3 = 35672;\nconst GL_BOOL_VEC4 = 35673;\nconst GL_FLOAT_MAT2 = 35674;\nconst GL_FLOAT_MAT3 = 35675;\nconst GL_FLOAT_MAT4 = 35676;\nconst GL_SAMPLER_2D = 35678;\nconst GL_SAMPLER_CUBE = 35680;\n\n/**\n * _type2uniformCommit\n */\nlet _type2uniformCommit = {\n  [GL_INT]: function (gl, id, value) {\n    gl.uniform1i(id, value);\n  },\n\n  [GL_FLOAT]: function (gl, id, value) {\n    gl.uniform1f(id, value);\n  },\n\n  [GL_FLOAT_VEC2]: function (gl, id, value) {\n    gl.uniform2fv(id, value);\n  },\n\n  [GL_FLOAT_VEC3]: function (gl, id, value) {\n    gl.uniform3fv(id, value);\n  },\n\n  [GL_FLOAT_VEC4]: function (gl, id, value) {\n    gl.uniform4fv(id, value);\n  },\n\n  [GL_INT_VEC2]: function (gl, id, value) {\n    gl.uniform2iv(id, value);\n  },\n\n  [GL_INT_VEC3]: function (gl, id, value) {\n    gl.uniform3iv(id, value);\n  },\n\n  [GL_INT_VEC4]: function (gl, id, value) {\n    gl.uniform4iv(id, value);\n  },\n\n  [GL_BOOL]: function (gl, id, value) {\n    gl.uniform1i(id, value);\n  },\n\n  [GL_BOOL_VEC2]: function (gl, id, value) {\n    gl.uniform2iv(id, value);\n  },\n\n  [GL_BOOL_VEC3]: function (gl, id, value) {\n    gl.uniform3iv(id, value);\n  },\n\n  [GL_BOOL_VEC4]: function (gl, id, value) {\n    gl.uniform4iv(id, value);\n  },\n\n  [GL_FLOAT_MAT2]: function (gl, id, value) {\n    gl.uniformMatrix2fv(id, false, value);\n  },\n\n  [GL_FLOAT_MAT3]: function (gl, id, value) {\n    gl.uniformMatrix3fv(id, false, value);\n  },\n\n  [GL_FLOAT_MAT4]: function (gl, id, value) {\n    gl.uniformMatrix4fv(id, false, value);\n  },\n\n  [GL_SAMPLER_2D]: function (gl, id, value) {\n    gl.uniform1i(id, value);\n  },\n\n  [GL_SAMPLER_CUBE]: function (gl, id, value) {\n    gl.uniform1i(id, value);\n  },\n};\n\n/**\n * _type2uniformArrayCommit\n */\nlet _type2uniformArrayCommit = {\n  [GL_INT]: function (gl, id, value) {\n    gl.uniform1iv(id, value);\n  },\n\n  [GL_FLOAT]: function (gl, id, value) {\n    gl.uniform1fv(id, value);\n  },\n\n  [GL_FLOAT_VEC2]: function (gl, id, value) {\n    gl.uniform2fv(id, value);\n  },\n\n  [GL_FLOAT_VEC3]: function (gl, id, value) {\n    gl.uniform3fv(id, value);\n  },\n\n  [GL_FLOAT_VEC4]: function (gl, id, value) {\n    gl.uniform4fv(id, value);\n  },\n\n  [GL_INT_VEC2]: function (gl, id, value) {\n    gl.uniform2iv(id, value);\n  },\n\n  [GL_INT_VEC3]: function (gl, id, value) {\n    gl.uniform3iv(id, value);\n  },\n\n  [GL_INT_VEC4]: function (gl, id, value) {\n    gl.uniform4iv(id, value);\n  },\n\n  [GL_BOOL]: function (gl, id, value) {\n    gl.uniform1iv(id, value);\n  },\n\n  [GL_BOOL_VEC2]: function (gl, id, value) {\n    gl.uniform2iv(id, value);\n  },\n\n  [GL_BOOL_VEC3]: function (gl, id, value) {\n    gl.uniform3iv(id, value);\n  },\n\n  [GL_BOOL_VEC4]: function (gl, id, value) {\n    gl.uniform4iv(id, value);\n  },\n\n  [GL_FLOAT_MAT2]: function (gl, id, value) {\n    gl.uniformMatrix2fv(id, false, value);\n  },\n\n  [GL_FLOAT_MAT3]: function (gl, id, value) {\n    gl.uniformMatrix3fv(id, false, value);\n  },\n\n  [GL_FLOAT_MAT4]: function (gl, id, value) {\n    gl.uniformMatrix4fv(id, false, value);\n  },\n\n  [GL_SAMPLER_2D]: function (gl, id, value) {\n    gl.uniform1iv(id, value);\n  },\n\n  [GL_SAMPLER_CUBE]: function (gl, id, value) {\n    gl.uniform1iv(id, value);\n  },\n};\n\n/**\n * _commitBlendStates\n */\nfunction _commitBlendStates(gl, cur, next) {\n  // enable/disable blend\n  if (cur.blend !== next.blend) {\n    if (!next.blend) {\n      gl.disable(gl.BLEND);\n      return;\n    }\n\n    gl.enable(gl.BLEND);\n\n    if (\n      next.blendSrc === enums.BLEND_CONSTANT_COLOR ||\n      next.blendSrc === enums.BLEND_ONE_MINUS_CONSTANT_COLOR ||\n      next.blendDst === enums.BLEND_CONSTANT_COLOR ||\n      next.blendDst === enums.BLEND_ONE_MINUS_CONSTANT_COLOR\n    ) {\n      gl.blendColor(\n        (next.blendColor >> 24) / 255,\n        (next.blendColor >> 16 & 0xff) / 255,\n        (next.blendColor >> 8 & 0xff) / 255,\n        (next.blendColor & 0xff) / 255\n      );\n    }\n\n    if (next.blendSep) {\n      gl.blendFuncSeparate(next.blendSrc, next.blendDst, next.blendSrcAlpha, next.blendDstAlpha);\n      gl.blendEquationSeparate(next.blendEq, next.blendAlphaEq);\n    } else {\n      gl.blendFunc(next.blendSrc, next.blendDst);\n      gl.blendEquation(next.blendEq);\n    }\n\n    return;\n  }\n\n  // nothing to update\n  if (next.blend === false) {\n    return;\n  }\n\n  // blend-color\n  if (cur.blendColor !== next.blendColor) {\n    gl.blendColor(\n      (next.blendColor >> 24) / 255,\n      (next.blendColor >> 16 & 0xff) / 255,\n      (next.blendColor >> 8 & 0xff) / 255,\n      (next.blendColor & 0xff) / 255\n    );\n  }\n\n  // separate diff, reset all\n  if (cur.blendSep !== next.blendSep) {\n    if (next.blendSep) {\n      gl.blendFuncSeparate(next.blendSrc, next.blendDst, next.blendSrcAlpha, next.blendDstAlpha);\n      gl.blendEquationSeparate(next.blendEq, next.blendAlphaEq);\n    } else {\n      gl.blendFunc(next.blendSrc, next.blendDst);\n      gl.blendEquation(next.blendEq);\n    }\n\n    return;\n  }\n\n  if (next.blendSep) {\n    // blend-func-separate\n    if (\n      cur.blendSrc !== next.blendSrc ||\n      cur.blendDst !== next.blendDst ||\n      cur.blendSrcAlpha !== next.blendSrcAlpha ||\n      cur.blendDstAlpha !== next.blendDstAlpha\n    ) {\n      gl.blendFuncSeparate(next.blendSrc, next.blendDst, next.blendSrcAlpha, next.blendDstAlpha);\n    }\n\n    // blend-equation-separate\n    if (\n      cur.blendEq !== next.blendEq ||\n      cur.blendAlphaEq !== next.blendAlphaEq\n    ) {\n      gl.blendEquationSeparate(next.blendEq, next.blendAlphaEq);\n    }\n  } else {\n    // blend-func\n    if (\n      cur.blendSrc !== next.blendSrc ||\n      cur.blendDst !== next.blendDst\n    ) {\n      gl.blendFunc(next.blendSrc, next.blendDst);\n    }\n\n    // blend-equation\n    if (cur.blendEq !== next.blendEq) {\n      gl.blendEquation(next.blendEq);\n    }\n  }\n}\n\n/**\n * _commitDepthStates\n */\nfunction _commitDepthStates(gl, cur, next) {\n  // enable/disable depth-test\n  if (cur.depthTest !== next.depthTest) {\n    if (!next.depthTest) {\n      gl.disable(gl.DEPTH_TEST);\n      return;\n    }\n\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthFunc(next.depthFunc);\n    gl.depthMask(next.depthWrite);\n\n    return;\n  }\n\n  // commit depth-write\n  if (cur.depthWrite !== next.depthWrite) {\n    gl.depthMask(next.depthWrite);\n  }\n\n  // check if depth-write enabled\n  if (next.depthTest === false) {\n    if (next.depthWrite) {\n      next.depthTest = true;\n      next.depthFunc = enums.DS_FUNC_ALWAYS;\n\n      gl.enable(gl.DEPTH_TEST);\n      gl.depthFunc(next.depthFunc);\n    }\n\n    return;\n  }\n\n  // depth-func\n  if (cur.depthFunc !== next.depthFunc) {\n    gl.depthFunc(next.depthFunc);\n  }\n}\n\n/**\n * _commitStencilStates\n */\nfunction _commitStencilStates(gl, cur, next) {\n  // inherit stencil states\n  if (next.stencilTest === enums.STENCIL_INHERIT) {\n    return;\n  }\n\n  if (next.stencilTest !== cur.stencilTest) {\n    if (next.stencilTest === enums.STENCIL_DISABLE) {\n      gl.disable(gl.STENCIL_TEST);\n      return;\n    }\n\n    gl.enable(gl.STENCIL_TEST);\n\n    if (next.stencilSep) {\n      gl.stencilFuncSeparate(gl.FRONT, next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n      gl.stencilMaskSeparate(gl.FRONT, next.stencilWriteMaskFront);\n      gl.stencilOpSeparate(gl.FRONT, next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n      gl.stencilFuncSeparate(gl.BACK, next.stencilFuncBack, next.stencilRefBack, next.stencilMaskBack);\n      gl.stencilMaskSeparate(gl.BACK, next.stencilWriteMaskBack);\n      gl.stencilOpSeparate(gl.BACK, next.stencilFailOpBack, next.stencilZFailOpBack, next.stencilZPassOpBack);\n    } else {\n      gl.stencilFunc(next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n      gl.stencilMask(next.stencilWriteMaskFront);\n      gl.stencilOp(next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n    }\n\n    return;\n  }\n\n  // fast return\n  if (next.stencilTest === enums.STENCIL_DISABLE) {\n    return;\n  }\n\n  if (cur.stencilSep !== next.stencilSep) {\n    if (next.stencilSep) {\n      gl.stencilFuncSeparate(gl.FRONT, next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n      gl.stencilMaskSeparate(gl.FRONT, next.stencilWriteMaskFront);\n      gl.stencilOpSeparate(gl.FRONT, next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n      gl.stencilFuncSeparate(gl.BACK, next.stencilFuncBack, next.stencilRefBack, next.stencilMaskBack);\n      gl.stencilMaskSeparate(gl.BACK, next.stencilWriteMaskBack);\n      gl.stencilOpSeparate(gl.BACK, next.stencilFailOpBack, next.stencilZFailOpBack, next.stencilZPassOpBack);\n    } else {\n      gl.stencilFunc(next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n      gl.stencilMask(next.stencilWriteMaskFront);\n      gl.stencilOp(next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n    }\n    return;\n  }\n\n  if (next.stencilSep) {\n    // front\n    if (\n      cur.stencilFuncFront !== next.stencilFuncFront ||\n      cur.stencilRefFront !== next.stencilRefFront ||\n      cur.stencilMaskFront !== next.stencilMaskFront\n    ) {\n      gl.stencilFuncSeparate(gl.FRONT, next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n    }\n    if (cur.stencilWriteMaskFront !== next.stencilWriteMaskFront) {\n      gl.stencilMaskSeparate(gl.FRONT, next.stencilWriteMaskFront);\n    }\n    if (\n      cur.stencilFailOpFront !== next.stencilFailOpFront ||\n      cur.stencilZFailOpFront !== next.stencilZFailOpFront ||\n      cur.stencilZPassOpFront !== next.stencilZPassOpFront\n    ) {\n      gl.stencilOpSeparate(gl.FRONT, next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n    }\n\n    // back\n    if (\n      cur.stencilFuncBack !== next.stencilFuncBack ||\n      cur.stencilRefBack !== next.stencilRefBack ||\n      cur.stencilMaskBack !== next.stencilMaskBack\n    ) {\n      gl.stencilFuncSeparate(gl.BACK, next.stencilFuncBack, next.stencilRefBack, next.stencilMaskBack);\n    }\n    if (cur.stencilWriteMaskBack !== next.stencilWriteMaskBack) {\n      gl.stencilMaskSeparate(gl.BACK, next.stencilWriteMaskBack);\n    }\n    if (\n      cur.stencilFailOpBack !== next.stencilFailOpBack ||\n      cur.stencilZFailOpBack !== next.stencilZFailOpBack ||\n      cur.stencilZPassOpBack !== next.stencilZPassOpBack\n    ) {\n      gl.stencilOpSeparate(gl.BACK, next.stencilFailOpBack, next.stencilZFailOpBack, next.stencilZPassOpBack);\n    }\n  } else {\n    if (\n      cur.stencilFuncFront !== next.stencilFuncFront ||\n      cur.stencilRefFront !== next.stencilRefFront ||\n      cur.stencilMaskFront !== next.stencilMaskFront\n    ) {\n      gl.stencilFunc(next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n    }\n    if (cur.stencilWriteMaskFront !== next.stencilWriteMaskFront) {\n      gl.stencilMask(next.stencilWriteMaskFront);\n    }\n    if (\n      cur.stencilFailOpFront !== next.stencilFailOpFront ||\n      cur.stencilZFailOpFront !== next.stencilZFailOpFront ||\n      cur.stencilZPassOpFront !== next.stencilZPassOpFront\n    ) {\n      gl.stencilOp(next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n    }\n  }\n\n}\n\n/**\n * _commitCullMode\n */\nfunction _commitCullMode(gl, cur, next) {\n  if (cur.cullMode === next.cullMode) {\n    return;\n  }\n\n  if (next.cullMode === enums.CULL_NONE) {\n    gl.disable(gl.CULL_FACE);\n    return;\n  }\n\n  gl.enable(gl.CULL_FACE);\n  gl.cullFace(next.cullMode);\n}\n\n/**\n * _commitVertexBuffers\n */\nfunction _commitVertexBuffers(device, gl, cur, next) {\n  let attrsDirty = false;\n\n  // nothing changed for vertex buffer\n  if (next.maxStream === -1) {\n    return;\n  }\n\n  if (cur.maxStream !== next.maxStream) {\n    attrsDirty = true;\n  } else if (cur.program !== next.program) {\n    attrsDirty = true;\n  } else {\n    for (let i = 0; i < next.maxStream + 1; ++i) {\n      if (\n        cur.vertexBuffers[i] !== next.vertexBuffers[i] ||\n        cur.vertexBufferOffsets[i] !== next.vertexBufferOffsets[i]\n      ) {\n        attrsDirty = true;\n        break;\n      }\n    }\n  }\n\n  if (attrsDirty) {\n    for (let i = 0; i < device._caps.maxVertexAttribs; ++i) {\n      device._newAttributes[i] = 0;\n    }\n\n    for (let i = 0; i < next.maxStream + 1; ++i) {\n      let vb = next.vertexBuffers[i];\n      let vbOffset = next.vertexBufferOffsets[i];\n      if (!vb || vb._glID === -1) {\n        continue;\n      }\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, vb._glID);\n\n      for (let j = 0; j < next.program._attributes.length; ++j) {\n        let attr = next.program._attributes[j];\n\n        let el = vb._format.element(attr.name);\n        if (!el) {\n          console.warn(`Can not find vertex attribute: ${attr.name}`);\n          continue;\n        }\n\n        if (device._enabledAttributes[attr.location] === 0) {\n          gl.enableVertexAttribArray(attr.location);\n          device._enabledAttributes[attr.location] = 1;\n        }\n        device._newAttributes[attr.location] = 1;\n\n        gl.vertexAttribPointer(\n          attr.location,\n          el.num,\n          el.type,\n          el.normalize,\n          el.stride,\n          el.offset + vbOffset * el.stride\n        );\n      }\n    }\n\n    // disable unused attributes\n    for (let i = 0; i < device._caps.maxVertexAttribs; ++i) {\n      if (device._enabledAttributes[i] !== device._newAttributes[i]) {\n        gl.disableVertexAttribArray(i);\n        device._enabledAttributes[i] = 0;\n      }\n    }\n  }\n}\n\n/**\n * _commitTextures\n */\nfunction _commitTextures(gl, cur, next) {\n  for (let i = 0; i < next.maxTextureSlot + 1; ++i) {\n    if (cur.textureUnits[i] !== next.textureUnits[i]) {\n      let texture = next.textureUnits[i];\n      if (texture && texture._glID !== -1) {\n        gl.activeTexture(gl.TEXTURE0 + i);\n        gl.bindTexture(texture._target, texture._glID);\n      }\n    }\n  }\n}\n\n/**\n * _attach\n */\nfunction _attach(gl, location, attachment, face = 0) {\n  if (attachment instanceof Texture2D) {\n    gl.framebufferTexture2D(\n      gl.FRAMEBUFFER,\n      location,\n      gl.TEXTURE_2D,\n      attachment._glID,\n      0\n    );\n  } else if (attachment instanceof TextureCube) {\n    gl.framebufferTexture2D(\n      gl.FRAMEBUFFER,\n      location,\n      gl.TEXTURE_CUBE_MAP_POSITIVE_X + face,\n      attachment._glID,\n      0\n    );\n  } else {\n    gl.framebufferRenderbuffer(\n      gl.FRAMEBUFFER,\n      location,\n      gl.RENDERBUFFER,\n      attachment._glID\n    );\n  }\n}\n\nexport default class Device {\n  /**\n   * @property caps\n   */\n  get caps() {\n    return this._caps;\n  }\n\n  /**\n   * @param {HTMLElement} canvasEL\n   * @param {object} opts\n   */\n  constructor(canvasEL, opts) {\n    let gl;\n\n    // default options\n    opts = opts || {};\n    if (opts.alpha === undefined) {\n      opts.alpha = false;\n    }\n    if (opts.stencil === undefined) {\n      opts.stencil = true;\n    }\n    if (opts.depth === undefined) {\n      opts.depth = true;\n    }\n    if (opts.antialias === undefined) {\n      opts.antialias = false;\n    }\n    // NOTE: it is said the performance improved in mobile device with this flag off.\n    if (opts.preserveDrawingBuffer === undefined) {\n      opts.preserveDrawingBuffer = false;\n    }\n\n    try {\n      gl = canvasEL.getContext('webgl', opts)\n        || canvasEL.getContext('experimental-webgl', opts)\n        || canvasEL.getContext('webkit-3d', opts)\n        || canvasEL.getContext('moz-webgl', opts);\n    } catch (err) {\n      console.error(err);\n      return;\n    }\n\n    // No errors are thrown using try catch\n    // Tested through ios baidu browser 4.14.1\n    if (!gl) {\n      console.error('This device does not support webgl');\n    }\n\n    // statics\n    /**\n     * @type {WebGLRenderingContext}\n     */\n    this._gl = gl;\n    this._extensions = {};\n    this._caps = {}; // capability\n    this._stats = {\n      texture: 0,\n      vb: 0,\n      ib: 0,\n      drawcalls: 0,\n    };\n\n    // https://developer.mozilla.org/zh-CN/docs/Web/API/WebGL_API/Using_Extensions\n    this._initExtensions([\n      'EXT_texture_filter_anisotropic',\n      'EXT_shader_texture_lod',\n      'OES_standard_derivatives',\n      'OES_texture_float',\n      'OES_texture_float_linear',\n      'OES_texture_half_float',\n      'OES_texture_half_float_linear',\n      'OES_vertex_array_object',\n      'WEBGL_compressed_texture_atc',\n      'WEBGL_compressed_texture_etc',\n      'WEBGL_compressed_texture_etc1',\n      'WEBGL_compressed_texture_pvrtc',\n      'WEBGL_compressed_texture_s3tc',\n      'WEBGL_depth_texture',\n      'WEBGL_draw_buffers',\n    ]);\n    this._initCaps();\n    this._initStates();\n\n    // runtime\n    State.initDefault(this);\n    this._current = new State(this);\n    this._next = new State(this);\n    this._uniforms = {}; // name: { value, num, dirty }\n    this._vx = this._vy = this._vw = this._vh = 0;\n    this._sx = this._sy = this._sw = this._sh = 0;\n    this._framebuffer = null;\n\n    //\n    this._enabledAttributes = new Array(this._caps.maxVertexAttribs);\n    this._newAttributes = new Array(this._caps.maxVertexAttribs);\n\n    for (let i = 0; i < this._caps.maxVertexAttribs; ++i) {\n      this._enabledAttributes[i] = 0;\n      this._newAttributes[i] = 0;\n    }\n  }\n\n  _initExtensions(extensions) {\n    const gl = this._gl;\n\n    for (let i = 0; i < extensions.length; ++i) {\n      let name = extensions[i];\n      let vendorPrefixes = [\"\", \"WEBKIT_\", \"MOZ_\"];\n\n      for (var j = 0; j < vendorPrefixes.length; j++) {\n        try {\n          let ext = gl.getExtension(vendorPrefixes[j] + name);\n          if (ext) {\n            this._extensions[name] = ext;\n            break;\n          }\n        } catch (e) {\n          console.error(e);\n        }\n      }\n    }\n  }\n\n  _initCaps() {\n    const gl = this._gl;\n    const extDrawBuffers = this.ext('WEBGL_draw_buffers');\n\n    this._caps.maxVertexStreams = 4;\n    this._caps.maxVertexTextures = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);\n    this._caps.maxFragUniforms = gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS);\n    this._caps.maxTextureUnits = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\n    this._caps.maxVertexAttribs = gl.getParameter(gl.MAX_VERTEX_ATTRIBS);\n    this._caps.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n\n    this._caps.maxDrawBuffers = extDrawBuffers ? gl.getParameter(extDrawBuffers.MAX_DRAW_BUFFERS_WEBGL) : 1;\n    this._caps.maxColorAttachments = extDrawBuffers ? gl.getParameter(extDrawBuffers.MAX_COLOR_ATTACHMENTS_WEBGL) : 1;\n  }\n\n  _initStates() {\n    const gl = this._gl;\n\n    // gl.frontFace(gl.CCW);\n    gl.disable(gl.BLEND);\n    gl.blendFunc(gl.ONE, gl.ZERO);\n    gl.blendEquation(gl.FUNC_ADD);\n    gl.blendColor(1,1,1,1);\n\n    gl.colorMask(true, true, true, true);\n\n    gl.enable(gl.CULL_FACE);\n    gl.cullFace(gl.BACK);\n\n    gl.disable(gl.DEPTH_TEST);\n    gl.depthFunc(gl.LESS);\n    gl.depthMask(false);\n    gl.disable(gl.POLYGON_OFFSET_FILL);\n    gl.depthRange(0,1);\n\n    gl.disable(gl.STENCIL_TEST);\n    gl.stencilFunc(gl.ALWAYS, 0, 0xFF);\n    gl.stencilMask(0xFF);\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n\n    // TODO:\n    // this.setAlphaToCoverage(false);\n    // this.setTransformFeedbackBuffer(null);\n    // this.setRaster(true);\n    // this.setDepthBias(false);\n\n    gl.clearDepth(1);\n    gl.clearColor(0, 0, 0, 0);\n    gl.clearStencil(0);\n\n    gl.disable(gl.SCISSOR_TEST);\n  }\n\n  _restoreTexture(unit) {\n    const gl = this._gl;\n\n    let texture = this._current.textureUnits[unit];\n    if (texture && texture._glID !== -1) {\n      gl.bindTexture(texture._target, texture._glID);\n    } else {\n      gl.bindTexture(gl.TEXTURE_2D, null);\n    }\n  }\n\n  _restoreIndexBuffer () {\n    const gl = this._gl;\n\n    let ib = this._current.indexBuffer;\n    if (ib && ib._glID !== -1) {\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ib._glID);\n    }\n    else {\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n    }\n  }\n\n  /**\n   * @method ext\n   * @param {string} name\n   */\n  ext(name) {\n    return this._extensions[name];\n  }\n\n  allowFloatTexture() {\n    return this.ext(\"OES_texture_float\") != null;\n  }\n\n  // ===============================\n  // Immediate Settings\n  // ===============================\n\n  /**\n   * @method setFrameBuffer\n   * @param {FrameBuffer} fb - null means use the backbuffer\n   */\n  setFrameBuffer(fb) {\n    if (this._framebuffer === fb) {\n      return;\n    }\n\n    this._framebuffer = fb;\n    const gl = this._gl;\n\n    if (!fb) {\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n      return;\n    }\n\n    gl.bindFramebuffer(gl.FRAMEBUFFER, fb._glID);\n\n    let numColors = fb._colors.length;\n    for (let i = 0; i < numColors; ++i) {\n      let colorBuffer = fb._colors[i];\n      _attach(gl, gl.COLOR_ATTACHMENT0 + i, colorBuffer);\n\n      // TODO: what about cubemap face??? should be the target parameter for colorBuffer\n    }\n    for (let i = numColors; i < this._caps.maxColorAttachments; ++i) {\n      gl.framebufferTexture2D(\n        gl.FRAMEBUFFER,\n        gl.COLOR_ATTACHMENT0 + i,\n        gl.TEXTURE_2D,\n        null,\n        0\n      );\n    }\n\n    if (fb._depth) {\n      _attach(gl, gl.DEPTH_ATTACHMENT, fb._depth);\n    }\n\n    if (fb._stencil) {\n      _attach(gl, gl.STENCIL_ATTACHMENT, fb._stencil);\n    }\n\n    if (fb._depthStencil) {\n      _attach(gl, gl.DEPTH_STENCIL_ATTACHMENT, fb._depthStencil);\n    }\n  }\n\n  /**\n   * @method setViewport\n   * @param {Number} x\n   * @param {Number} y\n   * @param {Number} w\n   * @param {Number} h\n   */\n  setViewport(x, y, w, h) {\n    if (\n      this._vx !== x ||\n      this._vy !== y ||\n      this._vw !== w ||\n      this._vh !== h\n    ) {\n      this._gl.viewport(x, y, w, h);\n      this._vx = x;\n      this._vy = y;\n      this._vw = w;\n      this._vh = h;\n    }\n  }\n\n  /**\n   * @method setScissor\n   * @param {Number} x\n   * @param {Number} y\n   * @param {Number} w\n   * @param {Number} h\n   */\n  setScissor(x, y, w, h) {\n    if (\n      this._sx !== x ||\n      this._sy !== y ||\n      this._sw !== w ||\n      this._sh !== h\n    ) {\n      this._gl.scissor(x, y, w, h);\n      this._sx = x;\n      this._sy = y;\n      this._sw = w;\n      this._sh = h;\n    }\n  }\n\n  /**\n   * @method clear\n   * @param {Object} opts\n   * @param {Array} opts.color\n   * @param {Number} opts.depth\n   * @param {Number} opts.stencil\n   */\n  clear(opts) {\n    if (opts.color === undefined && opts.depth === undefined && opts.stencil === undefined) {\n        return;\n    }\n    const gl = this._gl;\n    let flags = 0;\n\n    if (opts.color !== undefined) {\n      flags |= gl.COLOR_BUFFER_BIT;\n      gl.clearColor(opts.color[0], opts.color[1], opts.color[2], opts.color[3]);\n    }\n\n    if (opts.depth !== undefined) {\n      flags |= gl.DEPTH_BUFFER_BIT;\n      gl.clearDepth(opts.depth);\n\n      gl.enable(gl.DEPTH_TEST);\n      gl.depthMask(true);\n      gl.depthFunc(gl.ALWAYS);\n    }\n\n    if (opts.stencil !== undefined) {\n      flags |= gl.STENCIL_BUFFER_BIT;\n      gl.clearStencil(opts.stencil);\n    }\n\n    gl.clear(flags);\n\n    // restore depth-write\n    if (opts.depth !== undefined) {\n      if (this._current.depthTest === false) {\n        gl.disable(gl.DEPTH_TEST);\n      } else {\n        if (this._current.depthWrite === false) {\n          gl.depthMask(false);\n        }\n        if (this._current.depthFunc !== enums.DS_FUNC_ALWAYS) {\n          gl.depthFunc(this._current.depthFunc);\n        }\n      }\n    }\n  }\n\n  // ===============================\n  // Deferred States\n  // ===============================\n\n  /**\n   * @method enableBlend\n   */\n  enableBlend() {\n    this._next.blend = true;\n  }\n\n  /**\n   * @method enableDepthTest\n   */\n  enableDepthTest() {\n    this._next.depthTest = true;\n  }\n\n  /**\n   * @method enableDepthWrite\n   */\n  enableDepthWrite() {\n    this._next.depthWrite = true;\n  }\n\n  /**\n   * @method enableStencilTest\n   * @param {Number} stencilTest\n   */\n  setStencilTest(stencilTest) {\n    this._next.stencilTest = stencilTest;\n  }\n\n  /**\n   * @method setStencilFunc\n   * @param {DS_FUNC_*} func\n   * @param {Number} ref\n   * @param {Number} mask\n   */\n  setStencilFunc(func, ref, mask) {\n    this._next.stencilSep = false;\n    this._next.stencilFuncFront = this._next.stencilFuncBack = func;\n    this._next.stencilRefFront = this._next.stencilRefBack = ref;\n    this._next.stencilMaskFront = this._next.stencilMaskBack = mask;\n  }\n\n  /**\n   * @method setStencilFuncFront\n   * @param {DS_FUNC_*} func\n   * @param {Number} ref\n   * @param {Number} mask\n   */\n  setStencilFuncFront(func, ref, mask) {\n    this._next.stencilSep = true;\n    this._next.stencilFuncFront = func;\n    this._next.stencilRefFront = ref;\n    this._next.stencilMaskFront = mask;\n  }\n\n  /**\n   * @method setStencilFuncBack\n   * @param {DS_FUNC_*} func\n   * @param {Number} ref\n   * @param {Number} mask\n   */\n  setStencilFuncBack(func, ref, mask) {\n    this._next.stencilSep = true;\n    this._next.stencilFuncBack = func;\n    this._next.stencilRefBack = ref;\n    this._next.stencilMaskBack = mask;\n  }\n\n  /**\n   * @method setStencilOp\n   * @param {STENCIL_OP_*} failOp\n   * @param {STENCIL_OP_*} zFailOp\n   * @param {STENCIL_OP_*} zPassOp\n   * @param {Number} writeMask\n   */\n  setStencilOp(failOp, zFailOp, zPassOp, writeMask) {\n    this._next.stencilFailOpFront = this._next.stencilFailOpBack = failOp;\n    this._next.stencilZFailOpFront = this._next.stencilZFailOpBack = zFailOp;\n    this._next.stencilZPassOpFront = this._next.stencilZPassOpBack = zPassOp;\n    this._next.stencilWriteMaskFront = this._next.stencilWriteMaskBack = writeMask;\n  }\n\n  /**\n   * @method setStencilOpFront\n   * @param {STENCIL_OP_*} failOp\n   * @param {STENCIL_OP_*} zFailOp\n   * @param {STENCIL_OP_*} zPassOp\n   * @param {Number} writeMask\n   */\n  setStencilOpFront(failOp, zFailOp, zPassOp, writeMask) {\n    this._next.stencilSep = true;\n    this._next.stencilFailOpFront = failOp;\n    this._next.stencilZFailOpFront = zFailOp;\n    this._next.stencilZPassOpFront = zPassOp;\n    this._next.stencilWriteMaskFront = writeMask;\n  }\n\n  /**\n   * @method setStencilOpBack\n   * @param {STENCIL_OP_*} failOp\n   * @param {STENCIL_OP_*} zFailOp\n   * @param {STENCIL_OP_*} zPassOp\n   * @param {Number} writeMask\n   */\n  setStencilOpBack(failOp, zFailOp, zPassOp, writeMask) {\n    this._next.stencilSep = true;\n    this._next.stencilFailOpBack = failOp;\n    this._next.stencilZFailOpBack = zFailOp;\n    this._next.stencilZPassOpBack = zPassOp;\n    this._next.stencilWriteMaskBack = writeMask;\n  }\n\n  /**\n   * @method setDepthFunc\n   * @param {DS_FUNC_*} depthFunc\n   */\n  setDepthFunc(depthFunc) {\n    this._next.depthFunc = depthFunc;\n  }\n\n  /**\n   * @method setBlendColor32\n   * @param {Number} rgba\n   */\n  setBlendColor32(rgba) {\n    this._next.blendColor = rgba;\n  }\n\n  /**\n   * @method setBlendColor\n   * @param {Number} r\n   * @param {Number} g\n   * @param {Number} b\n   * @param {Number} a\n   */\n  setBlendColor(r, g, b, a) {\n    this._next.blendColor = ((r * 255) << 24 | (g * 255) << 16 | (b * 255) << 8 | a * 255) >>> 0;\n  }\n\n  /**\n   * @method setBlendFunc\n   * @param {BELND_*} src\n   * @param {BELND_*} dst\n   */\n  setBlendFunc(src, dst) {\n    this._next.blendSep = false;\n    this._next.blendSrc = src;\n    this._next.blendDst = dst;\n  }\n\n  /**\n   * @method setBlendFuncSep\n   * @param {BELND_*} src\n   * @param {BELND_*} dst\n   * @param {BELND_*} srcAlpha\n   * @param {BELND_*} dstAlpha\n   */\n  setBlendFuncSep(src, dst, srcAlpha, dstAlpha) {\n    this._next.blendSep = true;\n    this._next.blendSrc = src;\n    this._next.blendDst = dst;\n    this._next.blendSrcAlpha = srcAlpha;\n    this._next.blendDstAlpha = dstAlpha;\n  }\n\n  /**\n   * @method setBlendEq\n   * @param {BELND_FUNC_*} eq\n   */\n  setBlendEq(eq) {\n    this._next.blendSep = false;\n    this._next.blendEq = eq;\n  }\n\n  /**\n   * @method setBlendEqSep\n   * @param {BELND_FUNC_*} eq\n   * @param {BELND_FUNC_*} alphaEq\n   */\n  setBlendEqSep(eq, alphaEq) {\n    this._next.blendSep = true;\n    this._next.blendEq = eq;\n    this._next.blendAlphaEq = alphaEq;\n  }\n\n  /**\n   * @method setCullMode\n   * @param {CULL_*} mode\n   */\n  setCullMode(mode) {\n    this._next.cullMode = mode;\n  }\n\n  /**\n   * @method setVertexBuffer\n   * @param {Number} stream\n   * @param {VertexBuffer} buffer\n   * @param {Number} start - start vertex\n   */\n  setVertexBuffer(stream, buffer, start = 0) {\n    this._next.vertexBuffers[stream] = buffer;\n    this._next.vertexBufferOffsets[stream] = start;\n    if (this._next.maxStream < stream) {\n      this._next.maxStream = stream;\n    }\n  }\n\n  /**\n   * @method setIndexBuffer\n   * @param {IndexBuffer} buffer\n   */\n  setIndexBuffer(buffer) {\n    this._next.indexBuffer = buffer;\n  }\n\n  /**\n   * @method setProgram\n   * @param {Program} program\n   */\n  setProgram(program) {\n    this._next.program = program;\n  }\n\n  /**\n   * @method setTexture\n   * @param {String} name\n   * @param {Texture} texture\n   * @param {Number} slot\n   */\n  setTexture(name, texture, slot) {\n    if (slot >= this._caps.maxTextureUnits) {\n      console.warn(`Can not set texture ${name} at stage ${slot}, max texture exceed: ${this._caps.maxTextureUnits}`);\n      return;\n    }\n\n    this._next.textureUnits[slot] = texture;\n    this.setUniform(name, slot);\n\n    if (this._next.maxTextureSlot < slot) {\n      this._next.maxTextureSlot = slot;\n    }\n  }\n\n  /**\n   * @method setTextureArray\n   * @param {String} name\n   * @param {Array} textures\n   * @param {Int32Array} slots\n   */\n  setTextureArray(name, textures, slots) {\n    let len = textures.length;\n    if (len >= this._caps.maxTextureUnits) {\n      console.warn(`Can not set ${len} textures for ${name}, max texture exceed: ${this._caps.maxTextureUnits}`);\n      return;\n    }\n    for (let i = 0; i < len; ++i) {\n      let slot = slots[i];\n      this._next.textureUnits[slot] = textures[i];\n\n      if (this._next.maxTextureSlot < slot) {\n        this._next.maxTextureSlot = slot;\n      }\n    }\n    this.setUniform(name, slots);\n  }\n\n  /**\n   * @method setUniform\n   * @param {String} name\n   * @param {*} value\n   */\n  setUniform(name, value) {\n    let uniform = this._uniforms[name];\n\n    let sameType = false;\n    let isArray = false, isFloat32Array = false, isInt32Array = false;\n    do {\n      if (!uniform) {\n        break;\n      }\n\n      isFloat32Array = Array.isArray(value) || value instanceof Float32Array;\n      isInt32Array = value instanceof Int32Array;\n      isArray = isFloat32Array || isInt32Array;\n      if (uniform.isArray !== isArray) {\n        break;\n      }\n\n      if (uniform.isArray && uniform.value.length !== value.length) {\n        break;\n      }\n\n      sameType = true;\n    } while (false);\n\n    if (!sameType) {\n      let newValue = value;\n      if (isFloat32Array) {\n        newValue = new Float32Array(value);\n      }\n      else if (isInt32Array) {\n        newValue = new Int32Array(value);\n      }\n\n      uniform = {\n        dirty: true,\n        value: newValue,\n        isArray: isArray\n      };\n    } else {\n      let oldValue = uniform.value;\n      let dirty = false;\n      if (uniform.isArray) {\n        for (let i = 0, l = oldValue.length; i < l; i++) {\n          if (oldValue[i] !== value[i]) {\n            dirty = true;\n            oldValue[i] = value[i];\n          }\n        }\n      }\n      else {\n        if (oldValue !== value) {\n          dirty = true;\n          uniform.value = value;\n        }\n      }\n\n      if (dirty) {\n        uniform.dirty = true;\n      }\n    }\n    this._uniforms[name] = uniform;\n  }\n\n  setUniformDirectly(name, value) {\n    let uniform = this._uniforms[name];\n    if (!uniform) {\n      this._uniforms[name] = uniform = {};\n    }\n    uniform.dirty = true;\n    uniform.value = value;\n  }\n\n  /**\n   * @method setPrimitiveType\n   * @param {PT_*} type\n   */\n  setPrimitiveType(type) {\n    this._next.primitiveType = type;\n  }\n\n  /**\n   * @method resetDrawCalls\n   */\n  resetDrawCalls () {\n    this._stats.drawcalls = 0;\n  }\n  \n  /**\n   * @method getDrawCalls\n   */\n  getDrawCalls () {\n    return this._stats.drawcalls;\n  }\n\n  /**\n   * @method draw\n   * @param {Number} base\n   * @param {Number} count\n   */\n  draw(base, count) {\n    const gl = this._gl;\n    let cur = this._current;\n    let next = this._next;\n\n    // commit blend\n    _commitBlendStates(gl, cur, next);\n\n    // commit depth\n    _commitDepthStates(gl, cur, next);\n\n    // commit stencil\n    _commitStencilStates(gl, cur, next);\n\n    // commit cull\n    _commitCullMode(gl, cur, next);\n\n    // commit vertex-buffer\n    _commitVertexBuffers(this, gl, cur, next);\n\n    // commit index-buffer\n    if (cur.indexBuffer !== next.indexBuffer) {\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, next.indexBuffer && next.indexBuffer._glID !== -1 ? next.indexBuffer._glID : null);\n    }\n\n    // commit program\n    let programDirty = false;\n    if (cur.program !== next.program) {\n      if (next.program._linked) {\n        gl.useProgram(next.program._glID);\n      } else {\n        console.warn('Failed to use program: has not linked yet.');\n      }\n      programDirty = true;\n    }\n\n    // commit texture/sampler\n    _commitTextures(gl, cur, next);\n\n    // commit uniforms\n    for (let i = 0; i < next.program._uniforms.length; ++i) {\n      let uniformInfo = next.program._uniforms[i];\n      let uniform = this._uniforms[uniformInfo.name];\n      if (!uniform) {\n        // console.warn(`Can not find uniform ${uniformInfo.name}`);\n        continue;\n      }\n\n      if (!programDirty && !uniform.dirty) {\n        continue;\n      }\n\n      uniform.dirty = false;\n\n      // TODO: please consider array uniform: uniformInfo.size > 0\n\n      let commitFunc = (uniformInfo.size === undefined) ? _type2uniformCommit[uniformInfo.type] : _type2uniformArrayCommit[uniformInfo.type];\n      if (!commitFunc) {\n        console.warn(`Can not find commit function for uniform ${uniformInfo.name}`);\n        continue;\n      }\n\n      commitFunc(gl, uniformInfo.location, uniform.value);\n    }\n\n    if (count) {\n      // drawPrimitives\n      if (next.indexBuffer) {\n        gl.drawElements(\n          this._next.primitiveType,\n          count,\n          next.indexBuffer._format,\n          base * next.indexBuffer._bytesPerIndex\n        );\n      } else {\n        gl.drawArrays(\n          this._next.primitiveType,\n          base,\n          count\n        );\n      }\n\n      // update stats\n      this._stats.drawcalls++;\n    }\n\n    // TODO: autogen mipmap for color buffer\n    // if (this._framebuffer && this._framebuffer.colors[0].mipmap) {\n    //   gl.bindTexture(this._framebuffer.colors[i]._target, colors[i]._glID);\n    //   gl.generateMipmap(this._framebuffer.colors[i]._target);\n    // }\n\n    // reset states\n    cur.set(next);\n    next.reset();\n  }\n}","const GL_NEAREST = 9728;                // gl.NEAREST\nconst GL_LINEAR = 9729;                 // gl.LINEAR\nconst GL_NEAREST_MIPMAP_NEAREST = 9984; // gl.NEAREST_MIPMAP_NEAREST\nconst GL_LINEAR_MIPMAP_NEAREST = 9985;  // gl.LINEAR_MIPMAP_NEAREST\nconst GL_NEAREST_MIPMAP_LINEAR = 9986;  // gl.NEAREST_MIPMAP_LINEAR\nconst GL_LINEAR_MIPMAP_LINEAR = 9987;   // gl.LINEAR_MIPMAP_LINEAR\n\n// const GL_BYTE = 5120;                  // gl.BYTE\nconst GL_UNSIGNED_BYTE = 5121;            // gl.UNSIGNED_BYTE\n// const GL_SHORT = 5122;                 // gl.SHORT\nconst GL_UNSIGNED_SHORT = 5123;           // gl.UNSIGNED_SHORT\nconst GL_UNSIGNED_INT = 5125;             // gl.UNSIGNED_INT\nconst GL_FLOAT = 5126;                    // gl.FLOAT\nconst GL_UNSIGNED_SHORT_5_6_5 = 33635;    // gl.UNSIGNED_SHORT_5_6_5\nconst GL_UNSIGNED_SHORT_4_4_4_4 = 32819;  // gl.UNSIGNED_SHORT_4_4_4_4\nconst GL_UNSIGNED_SHORT_5_5_5_1 = 32820;  // gl.UNSIGNED_SHORT_5_5_5_1\nconst GL_HALF_FLOAT_OES = 36193;          // gl.HALF_FLOAT_OES\n\nconst GL_DEPTH_COMPONENT = 6402; // gl.DEPTH_COMPONENT\n\nconst GL_ALPHA = 6406;            // gl.ALPHA\nconst GL_RGB = 6407;              // gl.RGB\nconst GL_RGBA = 6408;             // gl.RGBA\nconst GL_LUMINANCE = 6409;        // gl.LUMINANCE\nconst GL_LUMINANCE_ALPHA = 6410;  // gl.LUMINANCE_ALPHA\n\nconst GL_COMPRESSED_RGB_S3TC_DXT1_EXT = 0x83F0;   // ext.COMPRESSED_RGB_S3TC_DXT1_EXT\nconst GL_COMPRESSED_RGBA_S3TC_DXT1_EXT = 0x83F1;  // ext.COMPRESSED_RGBA_S3TC_DXT1_EXT\nconst GL_COMPRESSED_RGBA_S3TC_DXT3_EXT = 0x83F2;  // ext.COMPRESSED_RGBA_S3TC_DXT3_EXT\nconst GL_COMPRESSED_RGBA_S3TC_DXT5_EXT = 0x83F3;  // ext.COMPRESSED_RGBA_S3TC_DXT5_EXT\n\nconst GL_COMPRESSED_RGB_PVRTC_4BPPV1_IMG = 0x8C00;  // ext.COMPRESSED_RGB_PVRTC_4BPPV1_IMG\nconst GL_COMPRESSED_RGB_PVRTC_2BPPV1_IMG = 0x8C01;  // ext.COMPRESSED_RGB_PVRTC_2BPPV1_IMG\nconst GL_COMPRESSED_RGBA_PVRTC_4BPPV1_IMG = 0x8C02; // ext.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG\nconst GL_COMPRESSED_RGBA_PVRTC_2BPPV1_IMG = 0x8C03; // ext.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG\n\nconst GL_COMPRESSED_RGB_ETC1_WEBGL = 0x8D64; // ext.COMPRESSED_RGB_ETC1_WEBGL\n\nconst GL_COMPRESSED_RGB8_ETC2 = 0x9274;       // ext.COMPRESSED_RGB8_ETC2\nconst GL_COMPRESSED_RGBA8_ETC2_EAC = 0x9278;  // ext.COMPRESSED_RGBA8_ETC2_EAC\n\nconst _filterGL = [\n  [ GL_NEAREST,  GL_NEAREST_MIPMAP_NEAREST, GL_NEAREST_MIPMAP_LINEAR ],\n  [ GL_LINEAR,  GL_LINEAR_MIPMAP_NEAREST, GL_LINEAR_MIPMAP_LINEAR ],\n];\n\nconst _textureFmtGL = [\n  // TEXTURE_FMT_RGB_DXT1: 0\n  { format: GL_RGB, internalFormat: GL_COMPRESSED_RGB_S3TC_DXT1_EXT, pixelType: null },\n\n  // TEXTURE_FMT_RGBA_DXT1: 1\n  { format: GL_RGBA, internalFormat: GL_COMPRESSED_RGBA_S3TC_DXT1_EXT, pixelType: null },\n\n  // TEXTURE_FMT_RGBA_DXT3: 2\n  { format: GL_RGBA, internalFormat: GL_COMPRESSED_RGBA_S3TC_DXT3_EXT, pixelType: null },\n\n  // TEXTURE_FMT_RGBA_DXT5: 3\n  { format: GL_RGBA, internalFormat: GL_COMPRESSED_RGBA_S3TC_DXT5_EXT, pixelType: null },\n\n  // TEXTURE_FMT_RGB_ETC1: 4\n  { format: GL_RGB, internalFormat: GL_COMPRESSED_RGB_ETC1_WEBGL, pixelType: null },\n\n  // TEXTURE_FMT_RGB_PVRTC_2BPPV1: 5\n  { format: GL_RGB, internalFormat: GL_COMPRESSED_RGB_PVRTC_2BPPV1_IMG, pixelType: null },\n\n  // TEXTURE_FMT_RGBA_PVRTC_2BPPV1: 6\n  { format: GL_RGBA, internalFormat: GL_COMPRESSED_RGBA_PVRTC_2BPPV1_IMG, pixelType: null },\n\n  // TEXTURE_FMT_RGB_PVRTC_4BPPV1: 7\n  { format: GL_RGB, internalFormat: GL_COMPRESSED_RGB_PVRTC_4BPPV1_IMG, pixelType: null },\n\n  // TEXTURE_FMT_RGBA_PVRTC_4BPPV1: 8\n  { format: GL_RGBA, internalFormat: GL_COMPRESSED_RGBA_PVRTC_4BPPV1_IMG, pixelType: null },\n\n  // TEXTURE_FMT_A8: 9\n  { format: GL_ALPHA, internalFormat: GL_ALPHA, pixelType: GL_UNSIGNED_BYTE },\n\n  // TEXTURE_FMT_L8: 10\n  { format: GL_LUMINANCE, internalFormat: GL_LUMINANCE, pixelType: GL_UNSIGNED_BYTE },\n\n  // TEXTURE_FMT_L8_A8: 11\n  { format: GL_LUMINANCE_ALPHA, internalFormat: GL_LUMINANCE_ALPHA, pixelType: GL_UNSIGNED_BYTE },\n\n  // TEXTURE_FMT_R5_G6_B5: 12\n  { format: GL_RGB, internalFormat: GL_RGB, pixelType: GL_UNSIGNED_SHORT_5_6_5 },\n\n  // TEXTURE_FMT_R5_G5_B5_A1: 13\n  { format: GL_RGBA, internalFormat: GL_RGBA, pixelType: GL_UNSIGNED_SHORT_5_5_5_1 },\n\n  // TEXTURE_FMT_R4_G4_B4_A4: 14\n  { format: GL_RGBA, internalFormat: GL_RGBA, pixelType: GL_UNSIGNED_SHORT_4_4_4_4 },\n\n  // TEXTURE_FMT_RGB8: 15\n  { format: GL_RGB, internalFormat: GL_RGB, pixelType: GL_UNSIGNED_BYTE },\n\n  // TEXTURE_FMT_RGBA8: 16\n  { format: GL_RGBA, internalFormat: GL_RGBA, pixelType: GL_UNSIGNED_BYTE },\n\n  // TEXTURE_FMT_RGB16F: 17\n  { format: GL_RGB, internalFormat: GL_RGB, pixelType: GL_HALF_FLOAT_OES },\n\n  // TEXTURE_FMT_RGBA16F: 18\n  { format: GL_RGBA, internalFormat: GL_RGBA, pixelType: GL_HALF_FLOAT_OES },\n\n  // TEXTURE_FMT_RGB32F: 19\n  { format: GL_RGB, internalFormat: GL_RGB, pixelType: GL_FLOAT },\n\n  // TEXTURE_FMT_RGBA32F: 20\n  { format: GL_RGBA, internalFormat: GL_RGBA, pixelType: GL_FLOAT },\n\n  // TEXTURE_FMT_R32F: 21\n  { format: null, internalFormat: null, pixelType: null },\n\n  // TEXTURE_FMT_111110F: 22\n  { format: null, internalFormat: null, pixelType: null },\n\n  // TEXTURE_FMT_SRGB: 23\n  { format: null, internalFormat: null, pixelType: null },\n\n  // TEXTURE_FMT_SRGBA: 24\n  { format: null, internalFormat: null, pixelType: null },\n\n  // TEXTURE_FMT_D16: 25\n  { format: GL_DEPTH_COMPONENT, internalFormat: GL_DEPTH_COMPONENT, pixelType: GL_UNSIGNED_SHORT },\n\n  // TEXTURE_FMT_D32: 26\n  { format: GL_DEPTH_COMPONENT, internalFormat: GL_DEPTH_COMPONENT, pixelType: GL_UNSIGNED_INT },\n\n  // TEXTURE_FMT_D24S8: 27\n  { format: GL_DEPTH_COMPONENT, internalFormat: GL_DEPTH_COMPONENT, pixelType: GL_UNSIGNED_INT },\n\n  // TEXTURE_FMT_RGB_ETC2: 28\n  { format: GL_RGB, internalFormat: GL_COMPRESSED_RGB8_ETC2, pixelType: null },\n\n  // TEXTURE_FMT_RGBA_ETC2: 29\n  { format: GL_RGBA, internalFormat: GL_COMPRESSED_RGBA8_ETC2_EAC, pixelType: null },\n];\n\n/**\n * enums\n */\nexport const enums = {\n  // buffer usage\n  USAGE_STATIC: 35044,  // gl.STATIC_DRAW\n  USAGE_DYNAMIC: 35048, // gl.DYNAMIC_DRAW\n  USAGE_STREAM: 35040,  // gl.STREAM_DRAW\n\n  // index buffer format\n  INDEX_FMT_UINT8: 5121,  // gl.UNSIGNED_BYTE\n  INDEX_FMT_UINT16: 5123, // gl.UNSIGNED_SHORT\n  INDEX_FMT_UINT32: 5125, // gl.UNSIGNED_INT (OES_element_index_uint)\n\n  // vertex attribute semantic\n  ATTR_POSITION: 'a_position',\n  ATTR_NORMAL: 'a_normal',\n  ATTR_TANGENT: 'a_tangent',\n  ATTR_BITANGENT: 'a_bitangent',\n  ATTR_WEIGHTS: 'a_weights',\n  ATTR_JOINTS: 'a_joints',\n  ATTR_COLOR: 'a_color',\n  ATTR_COLOR0: 'a_color0',\n  ATTR_COLOR1: 'a_color1',\n  ATTR_UV: 'a_uv',\n  ATTR_UV0: 'a_uv0',\n  ATTR_UV1: 'a_uv1',\n  ATTR_UV2: 'a_uv2',\n  ATTR_UV3: 'a_uv3',\n  ATTR_UV4: 'a_uv4',\n  ATTR_UV5: 'a_uv5',\n  ATTR_UV6: 'a_uv6',\n  ATTR_UV7: 'a_uv7',\n  ATTR_TEX_COORD: 'a_texCoord',\n  ATTR_TEX_COORD1: 'a_texCoord1',\n  ATTR_TEX_COORD2: 'a_texCoord2',\n  ATTR_TEX_COORD3: 'a_texCoord3',\n  ATTR_TEX_COORD4: 'a_texCoord4',\n  ATTR_TEX_COORD5: 'a_texCoord5',\n  ATTR_TEX_COORD6: 'a_texCoord6',\n  ATTR_TEX_COORD7: 'a_texCoord7',\n  ATTR_TEX_COORD8: 'a_texCoord8',\n\n\n  // vertex attribute type\n  ATTR_TYPE_INT8: 5120,    // gl.BYTE\n  ATTR_TYPE_UINT8: 5121,   // gl.UNSIGNED_BYTE\n  ATTR_TYPE_INT16: 5122,   // gl.SHORT\n  ATTR_TYPE_UINT16: 5123,  // gl.UNSIGNED_SHORT\n  ATTR_TYPE_INT32: 5124,   // gl.INT\n  ATTR_TYPE_UINT32: 5125,  // gl.UNSIGNED_INT\n  ATTR_TYPE_FLOAT32: 5126, // gl.FLOAT\n\n  // texture filter\n  FILTER_NEAREST: 0,\n  FILTER_LINEAR: 1,\n\n  // texture wrap mode\n  WRAP_REPEAT: 10497, // gl.REPEAT\n  WRAP_CLAMP: 33071,  // gl.CLAMP_TO_EDGE\n  WRAP_MIRROR: 33648, // gl.MIRRORED_REPEAT\n\n  // texture format\n  // compress formats\n  TEXTURE_FMT_RGB_DXT1: 0,\n  TEXTURE_FMT_RGBA_DXT1: 1,\n  TEXTURE_FMT_RGBA_DXT3: 2,\n  TEXTURE_FMT_RGBA_DXT5: 3,\n  TEXTURE_FMT_RGB_ETC1: 4,\n  TEXTURE_FMT_RGB_PVRTC_2BPPV1: 5,\n  TEXTURE_FMT_RGBA_PVRTC_2BPPV1: 6,\n  TEXTURE_FMT_RGB_PVRTC_4BPPV1: 7,\n  TEXTURE_FMT_RGBA_PVRTC_4BPPV1: 8,\n\n  // normal formats\n  TEXTURE_FMT_A8: 9,\n  TEXTURE_FMT_L8: 10,\n  TEXTURE_FMT_L8_A8: 11,\n  TEXTURE_FMT_R5_G6_B5: 12,\n  TEXTURE_FMT_R5_G5_B5_A1: 13,\n  TEXTURE_FMT_R4_G4_B4_A4: 14,\n  TEXTURE_FMT_RGB8: 15,\n  TEXTURE_FMT_RGBA8: 16,\n  TEXTURE_FMT_RGB16F: 17,\n  TEXTURE_FMT_RGBA16F: 18,\n  TEXTURE_FMT_RGB32F: 19,\n  TEXTURE_FMT_RGBA32F: 20,\n  TEXTURE_FMT_R32F: 21,\n  TEXTURE_FMT_111110F: 22,\n  TEXTURE_FMT_SRGB: 23,\n  TEXTURE_FMT_SRGBA: 24,\n\n  // depth formats\n  TEXTURE_FMT_D16: 25,\n  TEXTURE_FMT_D32: 26,\n  TEXTURE_FMT_D24S8: 27,\n\n  // etc2 format\n  TEXTURE_FMT_RGB_ETC2: 28,\n  TEXTURE_FMT_RGBA_ETC2: 29,\n\n  // depth and stencil function\n  DS_FUNC_NEVER: 512,    // gl.NEVER\n  DS_FUNC_LESS: 513,     // gl.LESS\n  DS_FUNC_EQUAL: 514,    // gl.EQUAL\n  DS_FUNC_LEQUAL: 515,   // gl.LEQUAL\n  DS_FUNC_GREATER: 516,  // gl.GREATER\n  DS_FUNC_NOTEQUAL: 517, // gl.NOTEQUAL\n  DS_FUNC_GEQUAL: 518,   // gl.GEQUAL\n  DS_FUNC_ALWAYS: 519,   // gl.ALWAYS\n\n  // render-buffer format\n  RB_FMT_RGBA4: 32854,    // gl.RGBA4\n  RB_FMT_RGB5_A1: 32855,  // gl.RGB5_A1\n  RB_FMT_RGB565: 36194,   // gl.RGB565\n  RB_FMT_D16: 33189,      // gl.DEPTH_COMPONENT16\n  RB_FMT_S8: 36168,       // gl.STENCIL_INDEX8\n  RB_FMT_D24S8: 34041,    // gl.DEPTH_STENCIL\n\n  // blend-equation\n  BLEND_FUNC_ADD: 32774,              // gl.FUNC_ADD\n  BLEND_FUNC_SUBTRACT: 32778,         // gl.FUNC_SUBTRACT\n  BLEND_FUNC_REVERSE_SUBTRACT: 32779, // gl.FUNC_REVERSE_SUBTRACT\n\n  // blend\n  BLEND_ZERO: 0,                          // gl.ZERO\n  BLEND_ONE: 1,                           // gl.ONE\n  BLEND_SRC_COLOR: 768,                   // gl.SRC_COLOR\n  BLEND_ONE_MINUS_SRC_COLOR: 769,         // gl.ONE_MINUS_SRC_COLOR\n  BLEND_DST_COLOR: 774,                   // gl.DST_COLOR\n  BLEND_ONE_MINUS_DST_COLOR: 775,         // gl.ONE_MINUS_DST_COLOR\n  BLEND_SRC_ALPHA: 770,                   // gl.SRC_ALPHA\n  BLEND_ONE_MINUS_SRC_ALPHA: 771,         // gl.ONE_MINUS_SRC_ALPHA\n  BLEND_DST_ALPHA: 772,                   // gl.DST_ALPHA\n  BLEND_ONE_MINUS_DST_ALPHA: 773,         // gl.ONE_MINUS_DST_ALPHA\n  BLEND_CONSTANT_COLOR: 32769,            // gl.CONSTANT_COLOR\n  BLEND_ONE_MINUS_CONSTANT_COLOR: 32770,  // gl.ONE_MINUS_CONSTANT_COLOR\n  BLEND_CONSTANT_ALPHA: 32771,            // gl.CONSTANT_ALPHA\n  BLEND_ONE_MINUS_CONSTANT_ALPHA: 32772,  // gl.ONE_MINUS_CONSTANT_ALPHA\n  BLEND_SRC_ALPHA_SATURATE: 776,          // gl.SRC_ALPHA_SATURATE\n\n  // stencil operation\n  STENCIL_DISABLE: 0,             // disable stencil\n  STENCIL_ENABLE: 1,              // enable stencil\n  STENCIL_INHERIT: 2,             // inherit stencil states\n\n  STENCIL_OP_KEEP: 7680,          // gl.KEEP\n  STENCIL_OP_ZERO: 0,             // gl.ZERO\n  STENCIL_OP_REPLACE: 7681,       // gl.REPLACE\n  STENCIL_OP_INCR: 7682,          // gl.INCR\n  STENCIL_OP_INCR_WRAP: 34055,    // gl.INCR_WRAP\n  STENCIL_OP_DECR: 7683,          // gl.DECR\n  STENCIL_OP_DECR_WRAP: 34056,    // gl.DECR_WRAP\n  STENCIL_OP_INVERT: 5386,        // gl.INVERT\n\n  // cull\n  CULL_NONE: 0,\n  CULL_FRONT: 1028,\n  CULL_BACK: 1029,\n  CULL_FRONT_AND_BACK: 1032,\n\n  // primitive type\n  PT_POINTS: 0,         // gl.POINTS\n  PT_LINES: 1,          // gl.LINES\n  PT_LINE_LOOP: 2,      // gl.LINE_LOOP\n  PT_LINE_STRIP: 3,     // gl.LINE_STRIP\n  PT_TRIANGLES: 4,      // gl.TRIANGLES\n  PT_TRIANGLE_STRIP: 5, // gl.TRIANGLE_STRIP\n  PT_TRIANGLE_FAN: 6,   // gl.TRIANGLE_FAN\n};\n\n/**\n * @method attrTypeBytes\n * @param {ATTR_TYPE_*} attrType\n */\nexport function attrTypeBytes(attrType) {\n  if (attrType === enums.ATTR_TYPE_INT8) {\n    return 1;\n  } else if (attrType === enums.ATTR_TYPE_UINT8) {\n    return 1;\n  } else if (attrType === enums.ATTR_TYPE_INT16) {\n    return 2;\n  } else if (attrType === enums.ATTR_TYPE_UINT16) {\n    return 2;\n  } else if (attrType === enums.ATTR_TYPE_INT32) {\n    return 4;\n  } else if (attrType === enums.ATTR_TYPE_UINT32) {\n    return 4;\n  } else if (attrType === enums.ATTR_TYPE_FLOAT32) {\n    return 4;\n  }\n\n  console.warn(`Unknown ATTR_TYPE: ${attrType}`);\n  return 0;\n}\n\n/**\n * @method glFilter\n * @param {WebGLContext} gl\n * @param {FILTER_*} filter\n * @param {FILTER_*} mipFilter\n */\nexport function glFilter(gl, filter, mipFilter = -1) {\n  let result = _filterGL[filter][mipFilter+1];\n  if (result === undefined) {\n    console.warn(`Unknown FILTER: ${filter}`);\n    return mipFilter === -1 ? gl.LINEAR : gl.LINEAR_MIPMAP_LINEAR;\n  }\n\n  return result;\n}\n\n/**\n * @method glTextureFmt\n * @param {TEXTURE_FMT_*} fmt\n */\nexport function glTextureFmt(fmt) {\n  let result = _textureFmtGL[fmt];\n  if (result === undefined) {\n    console.warn(`Unknown TEXTURE_FMT: ${fmt}`);\n    return _textureFmtGL[enums.TEXTURE_FMT_RGBA8];\n  }\n\n  return result;\n}","export default class FrameBuffer {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {Number} width\n   * @param {Number} height\n   * @param {Object} options\n   * @param {Array} options.colors\n   * @param {RenderBuffer|Texture2D|TextureCube} options.depth\n   * @param {RenderBuffer|Texture2D|TextureCube} options.stencil\n   * @param {RenderBuffer|Texture2D|TextureCube} options.depthStencil\n   */\n  constructor(device, width, height, options) {\n    this._device = device;\n    this._width = width;\n    this._height = height;\n\n    this._colors = options.colors || [];\n    this._depth = options.depth || null;\n    this._stencil = options.stencil || null;\n    this._depthStencil = options.depthStencil || null;\n\n    this._glID = device._gl.createFramebuffer();\n  }\n\n  /**\n   * @method destroy\n   */\n  destroy() {\n    if (this._glID === null) {\n      console.error('The frame-buffer already destroyed');\n      return;\n    }\n\n    const gl = this._device._gl;\n\n    gl.deleteFramebuffer(this._glID);\n\n    this._glID = null;\n  }\n\n  getHandle() {\n    return this._glID;\n  }\n}","import { enums } from './enums';\n\nconst BYTES_PER_INDEX = {\n  [enums.INDEX_FMT_UINT8]: 1,\n  [enums.INDEX_FMT_UINT16]: 2,\n  [enums.INDEX_FMT_UINT32]: 4,\n}\n\nclass IndexBuffer {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {INDEX_FMT_*} format\n   * @param {USAGE_*} usage\n   * @param {ArrayBuffer | Uint8Array} data\n   */\n  constructor(device, format, usage, data) {\n    this._device = device;\n    this._format = format;\n    this._usage = usage;\n    this._bytesPerIndex = BYTES_PER_INDEX[format];\n    this._bytes = data.byteLength;\n    this._numIndices = this._bytes / this._bytesPerIndex;\n\n    this._needExpandDataStore = true;\n\n    // update\n    this._glID = device._gl.createBuffer();\n    this.update(0, data);\n\n    // stats\n    device._stats.ib += this._bytes;\n  }\n\n  /**\n   * @method destroy\n   */\n  destroy() {\n    if (this._glID === -1) {\n      console.error('The buffer already destroyed');\n      return;\n    }\n\n    let gl = this._device._gl;\n    gl.deleteBuffer(this._glID);\n    this._device._stats.ib -= this.bytes;\n\n    this._glID = -1;\n  }\n\n  /**\n   * @method update\n   * @param {Number} byteOffset\n   * @param {ArrayBuffer} data\n   */\n  update(byteOffset, data) {\n    if (this._glID === -1) {\n      console.error('The buffer is destroyed');\n      return;\n    }\n\n    if (data.byteLength === 0) return;\n\n    // Need to create new buffer object when bytes exceed\n    if (byteOffset + data.byteLength > this._bytes) {\n      if (byteOffset) {\n        // Lost data between [0, byteOffset] which is need for new buffer\n        console.error('Failed to update data, bytes exceed.');\n        return;\n      }\n      else {\n        this._needExpandDataStore = true;\n        this._bytes = byteOffset + data.byteLength;\n        this._numIndices = this._bytes / this._bytesPerIndex;\n      }\n    }\n\n    /** @type{WebGLRenderingContext} */\n    let gl = this._device._gl;\n    let glUsage = this._usage;\n\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._glID);\n    if (this._needExpandDataStore) {\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, data, glUsage);\n      this._needExpandDataStore = false;\n    }\n    else {\n      gl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER, byteOffset, data);\n    }\n    this._device._restoreIndexBuffer();\n  }\n\n  get count () {\n    return this._numIndices;\n  }\n\n  setUsage (usage) {\n    this._usage = usage;\n  }\n}\n\nIndexBuffer.BYTES_PER_INDEX = BYTES_PER_INDEX;\n\nexport default IndexBuffer;\n","import {\n    enums,\n    attrTypeBytes,\n    glFilter,\n    glTextureFmt,\n} from './enums';\n\nlet gfx = null;\n\nif (CC_JSB && CC_NATIVERENDERER) {\n    gfx = window.gfx;\n} else {\n    let VertexFormat = require('./vertex-format');\n    let IndexBuffer = require('./index-buffer');\n    let VertexBuffer = require('./vertex-buffer');\n    let Program = require('./program');\n    let Texture = require('./texture');\n    let Texture2D = require('./texture-2d');\n    let TextureCube = require('./texture-cube');\n    let RenderBuffer = require('./render-buffer');\n    let FrameBuffer = require('./frame-buffer');\n    let Device = require('./device');\n\n    gfx = {\n        // classes\n        VertexFormat,\n        IndexBuffer,\n        VertexBuffer,\n        Program,\n        Texture,\n        Texture2D,\n        TextureCube,\n        RenderBuffer,\n        FrameBuffer,\n        Device,\n\n        // functions\n        attrTypeBytes,\n        glFilter,\n        glTextureFmt,\n    };\n    Object.assign(gfx, enums);\n}\n\nexport default gfx;\ncc.gfx = gfx;\n","export function isPow2(v) {\n  return !(v & (v - 1)) && (!!v);\n}","let _genID = 0;\n\nfunction _parseError(out, type, errorLog) {\n  errorLog.split('\\n').forEach(msg => {\n    if (msg.length < 5) {\n      return;\n    }\n\n    let parts = /^ERROR:\\s+(\\d+):(\\d+):\\s*(.*)$/.exec(msg);\n    if (parts) {\n      out.push({\n        type: type,\n        fileID: parts[1] | 0,\n        line: parts[2] | 0,\n        message: parts[3].trim()\n      })\n    } else if (msg.length > 0) {\n      out.push({\n        type: type,\n        fileID: -1,\n        line: 0,\n        message: msg\n      });\n    }\n  });\n}\n\nexport default class Program {\n  /**\n   * @param {ef.GraphicsDevice} device - graphic device\n   * @param {object} options - shader definition\n   * @param {string} options.vert - vertex shader source code\n   * @param {string} options.frag - fragment shader shader source code\n   * @example\n   * let prog = new Program(device, {\n   *   vert: `\n   *     attribute vec3 a_position;\n   *     void main() {\n   *       gl_Position = vec4( a_position, 1.0 );\n   *     }\n   *   `,\n   *   frag: `\n   *     precision mediump float;\n   *     void main() {\n   *       gl_FragColor = vec4( 1.0, 1.0, 1.0, 1.0 );\n   *     }\n   *   `\n   * });\n   */\n  constructor(device, options) {\n    this._device = device;\n\n    // stores gl information: { location, type }\n    this._attributes = [];\n    this._uniforms = [];\n    this._samplers = [];\n    this._errors = [];\n    this._linked = false;\n    this._vertSource = options.vert;\n    this._fragSource = options.frag;\n    this._glID = null;\n    this._id = _genID++;\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  link() {\n    if (this._linked) {\n      return;\n    }\n\n    let gl = this._device._gl;\n\n    let vertShader = _createShader(gl, gl.VERTEX_SHADER, this._vertSource);\n    let fragShader = _createShader(gl, gl.FRAGMENT_SHADER, this._fragSource);\n\n    let program = gl.createProgram();\n    gl.attachShader(program, vertShader);\n    gl.attachShader(program, fragShader);\n    gl.linkProgram(program);\n\n    let failed = false;\n    let errors = this._errors;\n\n    if (!gl.getShaderParameter(vertShader, gl.COMPILE_STATUS)) {\n      _parseError(errors, 'vs', gl.getShaderInfoLog(vertShader));\n      failed = true;\n    }\n\n    if (!gl.getShaderParameter(fragShader, gl.COMPILE_STATUS)) {\n      _parseError(errors, 'fs', gl.getShaderInfoLog(fragShader));\n      failed = true;\n    }\n\n    gl.deleteShader(vertShader);\n    gl.deleteShader(fragShader);\n\n    if (failed) {\n      return errors;\n    }\n\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      errors.push({info: `Failed to link shader program: ${gl.getProgramInfoLog(program)}`});\n      return errors;\n    }\n\n    this._glID = program;\n\n    // parse attribute\n    let numAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n    for (let i = 0; i < numAttributes; ++i) {\n      let info = gl.getActiveAttrib(program, i);\n      let location = gl.getAttribLocation(program, info.name);\n\n      this._attributes.push({\n        name: info.name,\n        location: location,\n        type: info.type,\n      });\n    }\n\n    // parse uniform\n    let numUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n    for (let i = 0; i < numUniforms; ++i) {\n      let info = gl.getActiveUniform(program, i);\n      let name = info.name;\n      let location = gl.getUniformLocation(program, name);\n      let isArray = name.substr(name.length - 3) === '[0]';\n      if (isArray) {\n        name = name.substr(0, name.length - 3);\n      }\n\n      let uniform = {\n        name: name,\n        location: location,\n        type: info.type,\n        size: isArray ? info.size : undefined, // used when uniform is an array\n      };\n      this._uniforms.push(uniform);\n    }\n\n    this._linked = true;\n  }\n\n  destroy() {\n    let gl = this._device._gl;\n    gl.deleteProgram(this._glID);\n\n    this._linked = false;\n    this._glID = null;\n    this._attributes = [];\n    this._uniforms = [];\n    this._samplers = [];\n  }\n}\n\n// ====================\n// internal\n// ====================\n\nfunction _createShader(gl, type, src) {\n  let shader = gl.createShader(type);\n  gl.shaderSource(shader, src);\n  gl.compileShader(shader);\n\n  return shader;\n}","export default class RenderBuffer {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {RB_FMT_*} format\n   * @param {Number} width\n   * @param {Number} height\n   */\n  constructor(device, format, width, height) {\n    this._device = device;\n    this._format = format;\n    \n    this._glID = device._gl.createRenderbuffer();\n    this.update(width, height);\n  }\n\n  update (width, height) {\n    this._width = width;\n    this._height = height;\n\n    const gl = this._device._gl;\n    gl.bindRenderbuffer(gl.RENDERBUFFER, this._glID);\n    gl.renderbufferStorage(gl.RENDERBUFFER, this._format, width, height);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n  }\n\n  /**\n   * @method destroy\n   */\n  destroy() {\n    if (this._glID === null) {\n      console.error('The render-buffer already destroyed');\n      return;\n    }\n\n    const gl = this._device._gl;\n\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n    gl.deleteRenderbuffer(this._glID);\n\n    this._glID = null;\n  }\n}","import { enums } from './enums';\n\nconst _default = {\n  // blend\n  blend: false,\n  blendSep: false,\n  blendColor: 0xffffffff,\n  blendEq: enums.BLEND_FUNC_ADD,\n  blendAlphaEq: enums.BLEND_FUNC_ADD,\n  blendSrc: enums.BLEND_ONE,\n  blendDst: enums.BLEND_ZERO,\n  blendSrcAlpha: enums.BLEND_ONE,\n  blendDstAlpha: enums.BLEND_ZERO,\n\n  // depth\n  depthTest: false,\n  depthWrite: false,\n  depthFunc: enums.DS_FUNC_LESS,\n\n  // stencil\n  stencilTest: false,\n  stencilSep: false,\n  stencilFuncFront: enums.DS_FUNC_ALWAYS,\n  stencilRefFront: 0,\n  stencilMaskFront: 0xff,\n  stencilFailOpFront: enums.STENCIL_OP_KEEP,\n  stencilZFailOpFront: enums.STENCIL_OP_KEEP,\n  stencilZPassOpFront: enums.STENCIL_OP_KEEP,\n  stencilWriteMaskFront: 0xff,\n  stencilFuncBack: enums.DS_FUNC_ALWAYS,\n  stencilRefBack: 0,\n  stencilMaskBack: 0xff,\n  stencilFailOpBack: enums.STENCIL_OP_KEEP,\n  stencilZFailOpBack: enums.STENCIL_OP_KEEP,\n  stencilZPassOpBack: enums.STENCIL_OP_KEEP,\n  stencilWriteMaskBack: 0xff,\n\n  // cull-mode\n  cullMode: enums.CULL_BACK,\n\n  // primitive-type\n  primitiveType: enums.PT_TRIANGLES,\n\n  // bindings\n  maxStream: -1,\n  vertexBuffers: [],\n  vertexBufferOffsets: [],\n  indexBuffer: null,\n  maxTextureSlot: -1,\n  textureUnits: [],\n  program: null,\n};\n\nexport default class State {\n  constructor(device) {\n    // bindings\n    this.vertexBuffers = new Array(device._caps.maxVertexStreams);\n    this.vertexBufferOffsets = new Array(device._caps.maxVertexStreams);\n    this.textureUnits = new Array(device._caps.maxTextureUnits);\n\n    this.set(_default);\n  }\n\n  static initDefault(device) {\n    _default.vertexBuffers = new Array(device._caps.maxVertexStreams);\n    _default.vertexBufferOffsets = new Array(device._caps.maxVertexStreams);\n    _default.textureUnits = new Array(device._caps.maxTextureUnits);\n  }\n\n  reset () {\n    this.set(_default);\n  }\n\n  set (cpy) {\n    // blending\n    this.blend = cpy.blend;\n    this.blendSep = cpy.blendSep;\n    this.blendColor = cpy.blendColor;\n    this.blendEq = cpy.blendEq;\n    this.blendAlphaEq = cpy.blendAlphaEq;\n    this.blendSrc = cpy.blendSrc;\n    this.blendDst = cpy.blendDst;\n    this.blendSrcAlpha = cpy.blendSrcAlpha;\n    this.blendDstAlpha = cpy.blendDstAlpha;\n\n    // depth\n    this.depthTest = cpy.depthTest;\n    this.depthWrite = cpy.depthWrite;\n    this.depthFunc = cpy.depthFunc;\n\n    // stencil\n    this.stencilTest = cpy.stencilTest;\n    this.stencilSep = cpy.stencilSep;\n    this.stencilFuncFront = cpy.stencilFuncFront;\n    this.stencilRefFront = cpy.stencilRefFront;\n    this.stencilMaskFront = cpy.stencilMaskFront;\n    this.stencilFailOpFront = cpy.stencilFailOpFront;\n    this.stencilZFailOpFront = cpy.stencilZFailOpFront;\n    this.stencilZPassOpFront = cpy.stencilZPassOpFront;\n    this.stencilWriteMaskFront = cpy.stencilWriteMaskFront;\n    this.stencilFuncBack = cpy.stencilFuncBack;\n    this.stencilRefBack = cpy.stencilRefBack;\n    this.stencilMaskBack = cpy.stencilMaskBack;\n    this.stencilFailOpBack = cpy.stencilFailOpBack;\n    this.stencilZFailOpBack = cpy.stencilZFailOpBack;\n    this.stencilZPassOpBack = cpy.stencilZPassOpBack;\n    this.stencilWriteMaskBack = cpy.stencilWriteMaskBack;\n\n    // cull-mode\n    this.cullMode = cpy.cullMode;\n\n    // primitive-type\n    this.primitiveType = cpy.primitiveType;\n\n    // buffer bindings\n    this.maxStream = cpy.maxStream;\n    for (let i = 0; i < cpy.vertexBuffers.length; ++i) {\n      this.vertexBuffers[i] = cpy.vertexBuffers[i];\n    }\n    for (let i = 0; i < cpy.vertexBufferOffsets.length; ++i) {\n      this.vertexBufferOffsets[i] = cpy.vertexBufferOffsets[i];\n    }\n    this.indexBuffer = cpy.indexBuffer;\n\n    // texture bindings\n    this.maxTextureSlot = cpy.maxTextureSlot;\n    for (let i = 0; i < cpy.textureUnits.length; ++i) {\n      this.textureUnits[i] = cpy.textureUnits[i];\n    }\n\n    this.program = cpy.program;\n  }\n}","// @ts-check\nimport Texture from './texture';\nimport { enums, glFilter, glTextureFmt } from './enums';\nimport { isPow2 } from './misc';\n\n/**\n * @typedef {HTMLImageElement | HTMLCanvasElement} HTMLImageSource\n * @typedef {HTMLImageSource | ArrayBufferView} ImageSource\n * @typedef {{width?: number, height?: number, minFilter?: number, magFilter?: number, mipFilter?: number, wrapS?: number, wrapT?: number, format?: number, genMipmaps?: boolean, images?: ImageSource[], image?: ImageSource, flipY?: boolean, premultiplyAlpha?: boolean, anisotropy?: number}} TextureUpdateOpts\n * @typedef {import(\"../gfx/device\").default} Device\n */\n\nexport default class Texture2D extends Texture {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {TextureUpdateOpts} options\n   */\n  constructor(device, options) {\n    super(device);\n\n    let gl = this._device._gl;\n    this._target = gl.TEXTURE_2D;\n    this._glID = gl.createTexture();\n\n    // always alloc texture in GPU when we create it.\n    options.images = options.images || [null];\n    this.update(options);\n  }\n\n  /**\n   * @method update\n   * @param {TextureUpdateOpts} options\n   */\n  update(options) {\n    let gl = this._device._gl;\n    let genMipmaps = this._genMipmap;\n\n    if (options) {\n      if (options.width !== undefined) {\n        this._width = options.width;\n      }\n      if (options.height !== undefined) {\n        this._height = options.height;\n      }\n      if (options.anisotropy !== undefined) {\n        this._anisotropy = options.anisotropy;\n      }\n      if (options.minFilter !== undefined) {\n        this._minFilter = options.minFilter;\n      }\n      if (options.magFilter !== undefined) {\n        this._magFilter = options.magFilter;\n      }\n      if (options.mipFilter !== undefined) {\n        this._mipFilter = options.mipFilter;\n      }\n      if (options.wrapS !== undefined) {\n        this._wrapS = options.wrapS;\n      }\n      if (options.wrapT !== undefined) {\n        this._wrapT = options.wrapT;\n      }\n      if (options.format !== undefined) {\n        this._format = options.format;\n        this._compressed = \n          (this._format >= enums.TEXTURE_FMT_RGB_DXT1 && this._format <= enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1) || \n          (this._format >= enums.TEXTURE_FMT_RGB_ETC2 && this._format <= enums.TEXTURE_FMT_RGBA_ETC2)\n        ;\n      }\n\n      // check if generate mipmap\n      if (options.genMipmaps !== undefined) {\n        this._genMipmap = options.genMipmaps;\n        genMipmaps = options.genMipmaps;\n      }\n\n      let maxSize = this._device.caps.maxTextureSize || Number.MAX_VALUE;\n      let textureMaxSize = Math.max(options.width || 0, options.height || 0);\n      if (maxSize < textureMaxSize)\n        console.warn(`The current texture size ${textureMaxSize} exceeds the maximum size [${maxSize}] supported on the device.`);\n\n      if (options.images !== undefined) {\n        if (options.images.length > 1) {\n          genMipmaps = false;\n          let maxLength = options.width > options.height ? options.width : options.height;\n          if (maxLength >> (options.images.length - 1) !== 1) {\n            console.error('texture-2d mipmap is invalid, should have a 1x1 mipmap.');\n          }\n        }\n      }\n    }\n\n    // NOTE: get pot after this._width, this._height has been assigned.\n    let pot = isPow2(this._width) && isPow2(this._height);\n    if (!pot) {\n      genMipmaps = false;\n    }\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this._glID);\n    if (options.images !== undefined && options.images.length > 0) {\n      this._setMipmap(options.images, options.flipY, options.premultiplyAlpha);\n      if (options.images.length > 1) this._genMipmap = true;\n    }\n    if (genMipmaps) {\n      gl.hint(gl.GENERATE_MIPMAP_HINT, gl.NICEST);\n      gl.generateMipmap(gl.TEXTURE_2D);\n      this._genMipmap = true;\n    }\n\n    this._setTexInfo();\n    this._device._restoreTexture(0);\n  }\n\n  /**\n   * @method updateSubImage\n   * @param {Object} options\n   * @param {Number} options.x\n   * @param {Number} options.y\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {Number} options.level\n   * @param {HTMLCanvasElement | HTMLImageElement | HTMLVideoElement | ArrayBufferView} options.image\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  updateSubImage(options) {\n    let gl = this._device._gl;\n    let glFmt = glTextureFmt(this._format);\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this._glID);\n    this._setSubImage(glFmt, options);\n    this._device._restoreTexture(0);\n  }\n\n  /**\n   * @method updateImage\n   * @param {Object} options\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {Number} options.level\n   * @param {HTMLCanvasElement | HTMLImageElement | HTMLVideoElement | ArrayBufferView} options.image\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  updateImage(options) {\n    let gl = this._device._gl;\n    let glFmt = glTextureFmt(this._format);\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this._glID);\n    this._setImage(glFmt, options);\n    this._device._restoreTexture(0);\n  }\n\n  _setSubImage(glFmt, options) {\n    let gl = this._device._gl;\n    let flipY = options.flipY;\n    let premultiplyAlpha = options.premultiplyAlpha;\n    let img = options.image;\n\n    if (img && !ArrayBuffer.isView(img) && !(img instanceof ArrayBuffer)) {\n      if (flipY === undefined) {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n      } else {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n      }\n\n      if (premultiplyAlpha === undefined) {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n      }\n\n      gl.texSubImage2D(gl.TEXTURE_2D, options.level, options.x, options.y, glFmt.format, glFmt.pixelType, img);\n    } else {\n      if (flipY === undefined) {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n      }\n\n      if (premultiplyAlpha === undefined) {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n      }\n\n      if (this._compressed) {\n        gl.compressedTexSubImage2D(gl.TEXTURE_2D,\n          options.level,\n          options.x,\n          options.y,\n          options.width,\n          options.height,\n          glFmt.format,\n          img\n        );\n      } else {\n        gl.texSubImage2D(\n          gl.TEXTURE_2D,\n          options.level,\n          options.x,\n          options.y,\n          options.width,\n          options.height,\n          glFmt.format,\n          glFmt.pixelType,\n          img\n        );\n      }\n    }\n  }\n\n  _setImage(glFmt, options) {\n    let gl = this._device._gl;\n    let flipY = options.flipY;\n    let premultiplyAlpha = options.premultiplyAlpha;\n    let img = options.image;\n\n    if (img && !ArrayBuffer.isView(img) && !(img instanceof ArrayBuffer)) {\n      if (flipY === undefined) {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n      } else {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n      }\n\n      if (premultiplyAlpha === undefined) {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n      }\n\n      gl.texImage2D(\n        gl.TEXTURE_2D,\n        options.level,\n        glFmt.internalFormat,\n        glFmt.format,\n        glFmt.pixelType,\n        img\n      );\n    } else {\n      if (flipY === undefined) {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n      }\n\n      if (premultiplyAlpha === undefined) {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n      }\n\n      if (this._compressed) {\n        gl.compressedTexImage2D(\n          gl.TEXTURE_2D,\n          options.level,\n          glFmt.internalFormat,\n          options.width,\n          options.height,\n          0,\n          img\n        );\n      } else {\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          options.level,\n          glFmt.internalFormat,\n          options.width,\n          options.height,\n          0,\n          glFmt.format,\n          glFmt.pixelType,\n          img\n        );\n      }\n    }\n  }\n\n  _setMipmap(images, flipY, premultiplyAlpha) {\n    let glFmt = glTextureFmt(this._format);\n    let options = {\n      width: this._width,\n      height: this._height,\n      flipY: flipY,\n      premultiplyAlpha: premultiplyAlpha,\n      level: 0,\n      image: null\n    };\n\n    for (let i = 0; i < images.length; ++i) {\n      options.level = i;\n      options.width = this._width >> i;\n      options.height = this._height >> i;\n      options.image = images[i];\n      this._setImage(glFmt, options);\n    }\n  }\n\n  _setTexInfo() {\n    let gl = this._device._gl;\n    let pot = isPow2(this._width) && isPow2(this._height);\n\n    // WebGL1 doesn't support all wrap modes with NPOT textures\n    if (!pot && (this._wrapS !== enums.WRAP_CLAMP || this._wrapT !== enums.WRAP_CLAMP)) {\n      console.warn('WebGL1 doesn\\'t support all wrap modes with NPOT textures');\n      this._wrapS = enums.WRAP_CLAMP;\n      this._wrapT = enums.WRAP_CLAMP;\n    }\n\n    let mipFilter = this._genMipmap ? this._mipFilter : -1;\n    if (!pot && mipFilter !== -1) {\n      console.warn('NPOT textures do not support mipmap filter');\n      mipFilter = -1;\n    }\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, glFilter(gl, this._minFilter, mipFilter));\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, glFilter(gl, this._magFilter, -1));\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, this._wrapS);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, this._wrapT);\n\n    let ext = this._device.ext('EXT_texture_filter_anisotropic');\n    if (ext) {\n      gl.texParameteri(gl.TEXTURE_2D, ext.TEXTURE_MAX_ANISOTROPY_EXT, this._anisotropy);\n    }\n  }\n}","import Texture from './texture';\nimport { enums, glFilter, glTextureFmt } from './enums';\nimport { isPow2 } from './misc';\n\nexport default class TextureCube extends Texture {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {Object} options\n   * @param {Array} options.images\n   * @param {Boolean} options.mipmap\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {TEXTURE_FMT_*} options.format\n   * @param {Number} options.anisotropy\n   * @param {FILTER_*} options.minFilter\n   * @param {FILTER_*} options.magFilter\n   * @param {FILTER_*} options.mipFilter\n   * @param {WRAP_*} options.wrapS\n   * @param {WRAP_*} options.wrapT\n   * @param {WRAP_*} options.wrapR\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  constructor(device, options) {\n    super(device);\n    let gl = this._device._gl;\n    this._target = gl.TEXTURE_CUBE_MAP;\n    this._glID = gl.createTexture();\n    this.update(options);\n  }\n\n  /**\n   * @method update\n   * @param {Object} options\n   * @param {Array} options.images\n   * @param {Boolean} options.genMipmaps\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {TEXTURE_FMT_*} options.format\n   * @param {Number} options.anisotropy\n   * @param {FILTER_*} options.minFilter\n   * @param {FILTER_*} options.magFilter\n   * @param {FILTER_*} options.mipFilter\n   * @param {WRAP_*} options.wrapS\n   * @param {WRAP_*} options.wrapT\n   * @param {WRAP_*} options.wrapR\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  update(options) {\n    let gl = this._device._gl;\n    let genMipmaps = this._genMipmaps;\n\n    if (options) {\n      if (options.width !== undefined) {\n        this._width = options.width;\n      }\n      if (options.height !== undefined) {\n        this._height = options.height;\n      }\n      if (options.anisotropy !== undefined) {\n        this._anisotropy = options.anisotropy;\n      }\n      if (options.minFilter !== undefined) {\n        this._minFilter = options.minFilter;\n      }\n      if (options.magFilter !== undefined) {\n        this._magFilter = options.magFilter;\n      }\n      if (options.mipFilter !== undefined) {\n        this._mipFilter = options.mipFilter;\n      }\n      if (options.wrapS !== undefined) {\n        this._wrapS = options.wrapS;\n      }\n      if (options.wrapT !== undefined) {\n        this._wrapT = options.wrapT;\n      }\n      // wrapR available in webgl2\n      // if (options.wrapR !== undefined) {\n      //   this._wrapR = options.wrapR;\n      // }\n      if (options.format !== undefined) {\n        this._format = options.format;\n        this._compressed = \n          (this._format >= enums.TEXTURE_FMT_RGB_DXT1 && this._format <= enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1) || \n          (this._format >= enums.TEXTURE_FMT_RGB_ETC2 && this._format <= enums.TEXTURE_FMT_RGBA_ETC2)\n        ;\n      }\n\n      // check if generate mipmap\n      if (options.genMipmaps !== undefined) {\n        this._genMipmaps = options.genMipmaps;\n        genMipmaps = options.genMipmaps;\n      }\n\n      if (options.images !== undefined) {\n        if (options.images.length > 1) {\n          genMipmaps = false;\n          if (options.width !== options.height) {\n            console.warn('texture-cube width and height should be identical.');\n          }\n          if (options.width >> (options.images.length - 1) !== 1) {\n            console.error('texture-cube mipmap is invalid. please set mipmap as 1x1, 2x2, 4x4 ... nxn');\n          }\n        }\n      }\n    }\n\n    // NOTE: get pot after this._width, this._height has been assigned.\n    let pot = isPow2(this._width) && isPow2(this._height);\n    if (!pot) {\n      genMipmaps = false;\n    }\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, this._glID);\n    if (options.images !== undefined && options.images.length > 0) {\n      this._setMipmap(options.images, options.flipY, options.premultiplyAlpha);\n      if (options.images.length > 1) this._genMipmaps = true;\n    }\n    if (genMipmaps) {\n      gl.hint(gl.GENERATE_MIPMAP_HINT, gl.NICEST);\n      gl.generateMipmap(gl.TEXTURE_CUBE_MAP);\n      this._genMipmaps = true;\n    }\n\n    this._setTexInfo();\n\n    this._device._restoreTexture(0);\n  }\n\n  /**\n   * @method updateSubImage\n   * @param {Object} options\n   * @param {Number} options.x\n   * @param {Number} options.y\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {Number} options.level\n   * @param {Number} options.faceIndex\n   * @param {HTMLCanvasElement | HTMLImageElement | HTMLVideoElement | ArrayBufferView} options.image\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  updateSubImage(options) {\n    let gl = this._device._gl;\n    let glFmt = glTextureFmt(this._format);\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, this._glID);\n    this._setSubImage(glFmt, options);\n\n    this._device._restoreTexture(0);\n  }\n\n  /**\n   * @method updateImage\n   * @param {Object} options\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {Number} options.level\n   * @param {Number} options.faceIndex\n   * @param {HTMLCanvasElement | HTMLImageElement | HTMLVideoElement | ArrayBufferView} options.image\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  updateImage(options) {\n    let gl = this._device._gl;\n    let glFmt = glTextureFmt(this._format);\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, this._glID);\n    this._setImage(glFmt, options);\n    this._device._restoreTexture(0);\n  }\n\n  _setSubImage(glFmt, options) {\n    let gl = this._device._gl;\n    let flipY = options.flipY;\n    let premultiplyAlpha = options.premultiplyAlpha;\n    let faceIndex = options.faceIndex;\n    let img = options.image;\n\n    if (flipY === undefined) {\n      gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n    } else {\n      gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n    }\n\n    if (premultiplyAlpha === undefined) {\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n    } else {\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n    }\n\n    if (img && !ArrayBuffer.isView(img) && !(img instanceof ArrayBuffer)) {\n      gl.texSubImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex, options.level, options.x, options.y, glFmt.format, glFmt.pixelType, img);\n    } else {\n      if (this._compressed) {\n        gl.compressedTexSubImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex,\n          options.level,\n          options.x,\n          options.y,\n          options.width,\n          options.height,\n          glFmt.format,\n          img\n        );\n      } else {\n        gl.texSubImage2D(\n          gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex,\n          options.level,\n          options.x,\n          options.y,\n          options.width,\n          options.height,\n          glFmt.format,\n          glFmt.pixelType,\n          img\n        );\n      }\n    }\n  }\n\n  _setImage(glFmt, options) {\n    let gl = this._device._gl;\n    let flipY = options.flipY;\n    let premultiplyAlpha = options.premultiplyAlpha;\n    let faceIndex = options.faceIndex;\n    let img = options.image;\n\n    if (flipY === undefined) {\n      gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n    } else {\n      gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n    }\n\n    if (premultiplyAlpha === undefined) {\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n    } else {\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n    }\n    if (img && !ArrayBuffer.isView(img) && !(img instanceof ArrayBuffer)) {\n      gl.texImage2D(\n        gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex,\n        options.level,\n        glFmt.internalFormat,\n        glFmt.format,\n        glFmt.pixelType,\n        img\n      );\n    } else {\n      if (this._compressed) {\n        gl.compressedTexImage2D(\n          gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex,\n          options.level,\n          glFmt.internalFormat,\n          options.width,\n          options.height,\n          0,\n          img\n        );\n      } else {\n        gl.texImage2D(\n          gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex,\n          options.level,\n          glFmt.internalFormat,\n          options.width,\n          options.height,\n          0,\n          glFmt.format,\n          glFmt.pixelType,\n          img\n        );\n      }\n    }\n  }\n\n  // levelImages = [imagePosX, imageNegX, imagePosY, imageNegY, imagePosZ, imageNegz]\n  // images = [levelImages0, levelImages1, ...]\n  _setMipmap(images, flipY, premultiplyAlpha) {\n    let glFmt = glTextureFmt(this._format);\n    let options = {\n      width: this._width,\n      height: this._height,\n      faceIndex: 0,\n      flipY: flipY,\n      premultiplyAlpha: premultiplyAlpha,\n      level: 0,\n      image: null\n    };\n\n    for (let i = 0; i < images.length; ++i) {\n      let levelImages = images[i];\n      options.level = i;\n      options.width = this._width >> i;\n      options.height = this._height >> i;\n\n      for (let face = 0; face < 6; ++face) {\n        options.faceIndex = face;\n        options.image = levelImages[face];\n        this._setImage(glFmt, options);\n      }\n    }\n  }\n\n  _setTexInfo() {\n    let gl = this._device._gl;\n    let pot = isPow2(this._width) && isPow2(this._height);\n\n    // WebGL1 doesn't support all wrap modes with NPOT textures\n    if (!pot && (this._wrapS !== enums.WRAP_CLAMP || this._wrapT !== enums.WRAP_CLAMP)) {\n      console.warn('WebGL1 doesn\\'t support all wrap modes with NPOT textures');\n      this._wrapS = enums.WRAP_CLAMP;\n      this._wrapT = enums.WRAP_CLAMP;\n    }\n\n    let mipFilter = this._genMipmaps ? this._mipFilter : -1;\n    if (!pot && mipFilter !== -1) {\n      console.warn('NPOT textures do not support mipmap filter');\n      mipFilter = -1;\n    }\n\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, glFilter(gl, this._minFilter, mipFilter));\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MAG_FILTER, glFilter(gl, this._magFilter, -1));\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_S, this._wrapS);\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_T, this._wrapT);\n    // wrapR available in webgl2\n    // gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_R, this._wrapR);\n\n    let ext = this._device.ext('EXT_texture_filter_anisotropic');\n    if (ext) {\n      gl.texParameteri(gl.TEXTURE_CUBE_MAP, ext.TEXTURE_MAX_ANISOTROPY_EXT, this._anisotropy);\n    }\n  }\n}\n","import { enums } from './enums';\n\n/**\n * @type {WebGLTexture}\n */\nconst _nullWebGLTexture = null;\n\nlet _textureID = 0;\n\n/**\n * @typedef {import(\"../gfx/device\").default} Device\n */\n\nexport default class Texture {\n  /**\n   * @param {Device} device\n   */\n  constructor(device) {\n    this._device = device;\n\n    this._width = 4;\n    this._height = 4;\n    this._genMipmaps = false;\n    this._compressed = false;\n\n    this._anisotropy = 1;\n    this._minFilter = enums.FILTER_LINEAR;\n    this._magFilter = enums.FILTER_LINEAR;\n    this._mipFilter = enums.FILTER_LINEAR;\n    this._wrapS = enums.WRAP_REPEAT;\n    this._wrapT = enums.WRAP_REPEAT;\n    // wrapR available in webgl2\n    // this._wrapR = enums.WRAP_REPEAT;\n    this._format = enums.TEXTURE_FMT_RGBA8;\n\n    this._target = -1;\n    \n    this._id = _textureID++;\n  }\n\n  /**\n   * @method destroy\n   */\n  destroy() {\n    if (this._glID === _nullWebGLTexture) {\n      console.error('The texture already destroyed');\n      return;\n    }\n\n    let gl = this._device._gl;\n    gl.deleteTexture(this._glID);\n\n    this._device._stats.tex -= this.bytes;\n    this._glID = _nullWebGLTexture;\n  }\n}","import { enums } from './enums';\n\nclass VertexBuffer {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {VertexFormat} format\n   * @param {USAGE_*} usage\n   * @param {ArrayBuffer | Uint8Array} data\n   */\n  constructor(device, format, usage, data) {\n    this._device = device;\n    this._format = format;\n    this._usage = usage;\n    this._bytesPerVertex = this._format._bytes;\n    this._bytes = data.byteLength;\n    this._numVertices = this._bytes / this._bytesPerVertex;\n\n    this._needExpandDataStore = true;\n\n    // update\n    this._glID = device._gl.createBuffer();\n    this.update(0, data);\n\n    // stats\n    device._stats.vb += this._bytes;\n  }\n\n  /**\n   * @method destroy\n   */\n  destroy() {\n    if (this._glID === -1) {\n      console.error('The buffer already destroyed');\n      return;\n    }\n\n    let gl = this._device._gl;\n    gl.deleteBuffer(this._glID);\n    this._device._stats.vb -= this.bytes;\n\n    this._glID = -1;\n  }\n\n  /**\n   * @method update\n   * @param {Number} byteOffset\n   * @param {ArrayBuffer} data\n   */\n  update(byteOffset, data) {\n    if (this._glID === -1) {\n      console.error('The buffer is destroyed');\n      return;\n    }\n\n    if (data.byteLength === 0) return;\n\n    // Need to create new buffer object when bytes exceed\n    if (byteOffset + data.byteLength > this._bytes) {\n      if (byteOffset) {\n        // Lost data between [0, byteOffset] which is need for new buffer\n        console.error('Failed to update data, bytes exceed.');\n        return;\n      }\n      else {\n        this._needExpandDataStore = true;\n        this._bytes = byteOffset + data.byteLength;\n        this._numVertices = this._bytes / this._bytesPerVertex;\n      }\n    }\n\n    let gl = this._device._gl;\n    let glUsage = this._usage;\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this._glID);\n    if (this._needExpandDataStore) {\n      gl.bufferData(gl.ARRAY_BUFFER, data, glUsage);\n      this._needExpandDataStore = false;\n    }\n    else {\n      gl.bufferSubData(gl.ARRAY_BUFFER, byteOffset, data);\n    }\n    gl.bindBuffer(gl.ARRAY_BUFFER, null);\n  }\n\n  get count () {\n    return this._numVertices;\n  }\n\n  getFormat (name) {\n    return this._format.element(name);\n  }\n\n  setUsage (usage) {\n    this._usage = usage;\n  }\n}\n\nexport default VertexBuffer;\n","import { attrTypeBytes } from './enums';\nimport murmurhash2 from '../murmurhash2_gc';\n\n// ====================\n// exports\n// ====================\n\nexport default class VertexFormat {\n  /**\n   * @constructor\n   * @param {Array} infos\n   *\n   * @example\n   * let vertexFmt = new VertexFormat([\n   *   { name: gfx.ATTR_POSITION, type: gfx.ATTR_TYPE_FLOAT32, num: 3 },\n   *   { name: gfx.ATTR_UV0, type: gfx.ATTR_TYPE_FLOAT32, num: 2 },\n   *   { name: gfx.ATTR_COLOR, type: gfx.ATTR_TYPE_FLOAT32, num: 4, normalize: true },\n   * ])\n   */\n  constructor(infos) {\n    this._attr2el = {};\n    this._elements = [];\n    this._bytes = 0;\n\n    let hash = \"\";\n\n    for (let i = 0, len = infos.length; i < len; ++i) {\n      let info = infos[i];\n      let el = {\n        name: info.name,\n        offset: this._bytes,\n        stride: 0,\n        stream: -1,\n        type: info.type,\n        num: info.num,\n        normalize: (info.normalize === undefined) ? false : info.normalize,\n        bytes: info.num * attrTypeBytes(info.type),\n      };\n\n      this._attr2el[el.name] = el;\n      this._elements.push(el);\n\n      this._bytes += el.bytes;\n\n      hash += `${el.name}:${el.num}:${el.type}:${el.normalize}`;\n    }\n\n    for (let i = 0, len = this._elements.length; i < len; ++i) {\n      let el = this._elements[i];\n      el.stride = this._bytes;\n    }\n\n    this._hash = murmurhash2(hash, 666);\n  }\n\n  /**\n   * @method element\n   * @param {string} attrName\n   */\n  element(attrName) {\n    return this._attr2el[attrName];\n  }\n\n  /**\n   * @method getHash\n   */\n  getHash () {\n    return this._hash;\n  }\n}","export default class CircularPool {\n  constructor(fn, size) {\n    this._cursor = 0;\n    this._data = new Array(size);\n\n    for (let i = 0; i < size; ++i) {\n      this._data[i] = fn();\n    }\n  }\n\n  request() {\n    let item = this._data[this._cursor];\n    this._cursor = (this._cursor + 1) % this._data.length;\n\n    return item;\n  }\n}","import sort from './timsort';\n\nexport default class FixedArray {\n  constructor(size) {\n    this._count = 0;\n    this._data = new Array(size);\n  }\n\n  _resize(size) {\n    if (size > this._data.length) {\n      for (let i = this._data.length; i < size; ++i) {\n        this._data[i] = undefined;\n      }\n    }\n  }\n\n  get length() {\n    return this._count;\n  }\n\n  get data() {\n    return this._data;\n  }\n\n  reset() {\n    for (let i = 0; i < this._count; ++i) {\n      this._data[i] = undefined;\n    }\n\n    this._count = 0;\n  }\n\n  push(val) {\n    if (this._count >= this._data.length) {\n      this._resize(this._data.length * 2);\n    }\n\n    this._data[this._count] = val;\n    ++this._count;\n  }\n\n  pop() {\n    --this._count;\n\n    if (this._count < 0) {\n      this._count = 0;\n    }\n\n    let ret = this._data[this._count];\n    this._data[this._count] = undefined;\n\n    return ret;\n  }\n\n  fastRemove(idx) {\n    if (idx >= this._count || idx < 0) {\n      return;\n    }\n\n    let last = this._count - 1;\n    this._data[idx] = this._data[last];\n    this._data[last] = undefined;\n    this._count -= 1;\n  }\n\n  indexOf(val) {\n    return this._data.indexOf(val);\n  }\n\n  sort(cmp) {\n    return sort(this._data, 0, this._count, cmp);\n  }\n}","export { default as CircularPool } from './circular-pool';\nexport { default as FixedArray } from './fixed-array';\nexport { default as LinkedArray } from './linked-array';\nexport { default as Pool } from './pool';\nexport { default as RecyclePool } from './recycle-pool';\nexport { default as TypedArrayPool } from './typed-array-pool';","import Pool from './pool';\n\n// NOTE: you must have `_prev` and `_next` field in the object returns by `fn`\n\nexport default class LinkedArray {\n  constructor(fn, size) {\n    this._fn = fn;\n    this._count = 0;\n    this._head = null;\n    this._tail = null;\n\n    this._pool = new Pool(fn, size);\n  }\n\n  get head() {\n    return this._head;\n  }\n\n  get tail() {\n    return this._tail;\n  }\n\n  get length() {\n    return this._count;\n  }\n\n  add() {\n    let node = this._pool.alloc();\n\n    if (!this._tail) {\n      this._head = node;\n    } else {\n      this._tail._next = node;\n      node._prev = this._tail;\n    }\n    this._tail = node;\n    this._count += 1;\n\n    return node;\n  }\n\n  remove(node) {\n    if (node._prev) {\n      node._prev._next = node._next;\n    } else {\n      this._head = node._next;\n    }\n\n    if (node._next) {\n      node._next._prev = node._prev;\n    } else {\n      this._tail = node._prev;\n    }\n\n    node._next = null;\n    node._prev = null;\n    this._pool.free(node);\n    this._count -= 1;\n  }\n\n  forEach(fn, binder) {\n    let cursor = this._head;\n    if (!cursor) {\n      return;\n    }\n\n    if (binder) {\n      fn = fn.bind(binder);\n    }\n\n    let idx = 0;\n    let next = cursor;\n\n    while (cursor) {\n      next = cursor._next;\n      fn(cursor, idx, this);\n\n      cursor = next;\n      ++idx;\n    }\n  }\n}","export default class Pool {\n  constructor(fn, size) {\n    this._fn = fn;\n    this._idx = size - 1;\n    this._frees = new Array(size);\n\n    for (let i = 0; i < size; ++i) {\n      this._frees[i] = fn();\n    }\n  }\n\n  _expand(size) {\n    let old = this._frees;\n    this._frees = new Array(size);\n\n    let len = size - old.length;\n    for (let i = 0; i < len; ++i) {\n      this._frees[i] = this._fn();\n    }\n\n    for (let i = len, j = 0; i < size; ++i, ++j) {\n      this._frees[i] = old[j];\n    }\n\n    this._idx += len;\n  }\n\n  alloc() {\n    // create some more space (expand by 20%, minimum 1)\n    if (this._idx < 0) {\n      this._expand(Math.round(this._frees.length * 1.2) + 1);\n    }\n\n    let ret = this._frees[this._idx];\n    this._frees[this._idx] = null;\n    --this._idx;\n\n    return ret;\n  }\n\n  free(obj) {\n    ++this._idx;\n    this._frees[this._idx] = obj;\n  }\n\n  /**\n   * 清除对象池。\n   * @param fn 清除回调，对每个释放的对象调用一次。\n   */\n  clear (fn) {\n    for (let i = 0; i <= this._idx; i++) {\n        if (fn) {\n            fn(this._frees[i]);\n        }\n    }\n    this._frees.length = 0;\n    this._idx = -1;\n  }\n}","import sort from './timsort';\n\n/**\n * Recycle Pool\n * @class RecyclePool\n */\nexport default class RecyclePool {\n  constructor(fn, size) {\n    this._fn = fn;\n    this._count = 0;\n    this._data = new Array(size);\n\n    for (let i = 0; i < size; ++i) {\n      this._data[i] = fn();\n    }\n  }\n\n  get length() {\n    return this._count;\n  }\n\n  get data() {\n    return this._data;\n  }\n\n  reset() {\n    this._count = 0;\n  }\n\n  resize(size) {\n    if (size > this._data.length) {\n      for (let i = this._data.length; i < size; ++i) {\n        this._data[i] = this._fn();\n      }\n    }\n  }\n\n  add() {\n    if (this._count >= this._data.length) {\n      this.resize(this._data.length * 2);\n    }\n\n    return this._data[this._count++];\n  }\n\n  remove(idx) {\n    if (idx >= this._count) {\n      return;\n    }\n\n    let last = this._count - 1;\n    let tmp = this._data[idx];\n    this._data[idx] = this._data[last];\n    this._data[last] = tmp;\n    this._count -= 1;\n  }\n\n  sort(cmp) {\n    return sort(this._data, 0, this._count, cmp);\n  }\n}\n\ncc.RecyclePool = RecyclePool;","// reference: https://github.com/mziccard/node-timsort\n\n/**\n * Default minimum size of a run.\n */\nconst DEFAULT_MIN_MERGE = 32;\n\n/**\n * Minimum ordered subsequece required to do galloping.\n */\nconst DEFAULT_MIN_GALLOPING = 7;\n\n/**\n * Default tmp storage length. Can increase depending on the size of the\n * smallest run to merge.\n */\nconst DEFAULT_TMP_STORAGE_LENGTH = 256;\n\n/**\n * Pre-computed powers of 10 for efficient lexicographic comparison of\n * small integers.\n */\nconst POWERS_OF_TEN = [1e0, 1e1, 1e2, 1e3, 1e4, 1e5, 1e6, 1e7, 1e8, 1e9]\n\n/**\n * Estimate the logarithm base 10 of a small integer.\n *\n * @param {number} x - The integer to estimate the logarithm of.\n * @return {number} - The estimated logarithm of the integer.\n */\nfunction log10(x) {\n  if (x < 1e5) {\n    if (x < 1e2) {\n      return x < 1e1 ? 0 : 1;\n    }\n\n    if (x < 1e4) {\n      return x < 1e3 ? 2 : 3;\n    }\n\n    return 4;\n  }\n\n  if (x < 1e7) {\n    return x < 1e6 ? 5 : 6;\n  }\n\n  if (x < 1e9) {\n    return x < 1e8 ? 7 : 8;\n  }\n\n  return 9;\n}\n\n/**\n * Default alphabetical comparison of items.\n *\n * @param {string|object|number} a - First element to compare.\n * @param {string|object|number} b - Second element to compare.\n * @return {number} - A positive number if a.toString() > b.toString(), a\n * negative number if .toString() < b.toString(), 0 otherwise.\n */\nfunction alphabeticalCompare(a, b) {\n  if (a === b) {\n    return 0;\n  }\n\n  if (~~a === a && ~~b === b) {\n    if (a === 0 || b === 0) {\n      return a < b ? -1 : 1;\n    }\n\n    if (a < 0 || b < 0) {\n      if (b >= 0) {\n        return -1;\n      }\n\n      if (a >= 0) {\n        return 1;\n      }\n\n      a = -a;\n      b = -b;\n    }\n\n    const al = log10(a);\n    const bl = log10(b);\n\n    let t = 0;\n\n    if (al < bl) {\n      a *= POWERS_OF_TEN[bl - al - 1];\n      b /= 10;\n      t = -1;\n    } else if (al > bl) {\n      b *= POWERS_OF_TEN[al - bl - 1];\n      a /= 10;\n      t = 1;\n    }\n\n    if (a === b) {\n      return t;\n    }\n\n    return a < b ? -1 : 1;\n  }\n\n  let aStr = String(a);\n  let bStr = String(b);\n\n  if (aStr === bStr) {\n    return 0;\n  }\n\n  return aStr < bStr ? -1 : 1;\n}\n\n/**\n * Compute minimum run length for TimSort\n *\n * @param {number} n - The size of the array to sort.\n */\nfunction minRunLength(n) {\n  let r = 0;\n\n  while (n >= DEFAULT_MIN_MERGE) {\n    r |= (n & 1);\n    n >>= 1;\n  }\n\n  return n + r;\n}\n\n/**\n * Counts the length of a monotonically ascending or strictly monotonically\n * descending sequence (run) starting at array[lo] in the range [lo, hi). If\n * the run is descending it is made ascending.\n *\n * @param {array} array - The array to reverse.\n * @param {number} lo - First element in the range (inclusive).\n * @param {number} hi - Last element in the range.\n * @param {function} compare - Item comparison function.\n * @return {number} - The length of the run.\n */\nfunction makeAscendingRun(array, lo, hi, compare) {\n  let runHi = lo + 1;\n\n  if (runHi === hi) {\n    return 1;\n  }\n\n  // Descending\n  if (compare(array[runHi++], array[lo]) < 0) {\n    while (runHi < hi && compare(array[runHi], array[runHi - 1]) < 0) {\n      runHi++;\n    }\n\n    reverseRun(array, lo, runHi);\n    // Ascending\n  } else {\n    while (runHi < hi && compare(array[runHi], array[runHi - 1]) >= 0) {\n      runHi++;\n    }\n  }\n\n  return runHi - lo;\n}\n\n/**\n * Reverse an array in the range [lo, hi).\n *\n * @param {array} array - The array to reverse.\n * @param {number} lo - First element in the range (inclusive).\n * @param {number} hi - Last element in the range.\n */\nfunction reverseRun(array, lo, hi) {\n  hi--;\n\n  while (lo < hi) {\n    let t = array[lo];\n    array[lo++] = array[hi];\n    array[hi--] = t;\n  }\n}\n\n/**\n * Perform the binary sort of the array in the range [lo, hi) where start is\n * the first element possibly out of order.\n *\n * @param {array} array - The array to sort.\n * @param {number} lo - First element in the range (inclusive).\n * @param {number} hi - Last element in the range.\n * @param {number} start - First element possibly out of order.\n * @param {function} compare - Item comparison function.\n */\nfunction binaryInsertionSort(array, lo, hi, start, compare) {\n  if (start === lo) {\n    start++;\n  }\n\n  for (; start < hi; start++) {\n    let pivot = array[start];\n\n    // Ranges of the array where pivot belongs\n    let left = lo;\n    let right = start;\n\n    /*\n     *   pivot >= array[i] for i in [lo, left)\n     *   pivot <  array[i] for i in  in [right, start)\n     */\n    while (left < right) {\n      let mid = (left + right) >>> 1;\n\n      if (compare(pivot, array[mid]) < 0) {\n        right = mid;\n      } else {\n        left = mid + 1;\n      }\n    }\n\n    /*\n     * Move elements right to make room for the pivot. If there are elements\n     * equal to pivot, left points to the first slot after them: this is also\n     * a reason for which TimSort is stable\n     */\n    let n = start - left;\n    // Switch is just an optimization for small arrays\n    switch (n) {\n      case 3:\n        array[left + 3] = array[left + 2];\n      /* falls through */\n      case 2:\n        array[left + 2] = array[left + 1];\n      /* falls through */\n      case 1:\n        array[left + 1] = array[left];\n        break;\n      default:\n        while (n > 0) {\n          array[left + n] = array[left + n - 1];\n          n--;\n        }\n    }\n\n    array[left] = pivot;\n  }\n}\n\n/**\n * Find the position at which to insert a value in a sorted range. If the range\n * contains elements equal to the value the leftmost element index is returned\n * (for stability).\n *\n * @param {number} value - Value to insert.\n * @param {array} array - The array in which to insert value.\n * @param {number} start - First element in the range.\n * @param {number} length - Length of the range.\n * @param {number} hint - The index at which to begin the search.\n * @param {function} compare - Item comparison function.\n * @return {number} - The index where to insert value.\n */\nfunction gallopLeft(value, array, start, length, hint, compare) {\n  let lastOffset = 0;\n  let maxOffset = 0;\n  let offset = 1;\n\n  if (compare(value, array[start + hint]) > 0) {\n    maxOffset = length - hint;\n\n    while (offset < maxOffset && compare(value, array[start + hint + offset]) > 0) {\n      lastOffset = offset;\n      offset = (offset << 1) + 1;\n\n      if (offset <= 0) {\n        offset = maxOffset;\n      }\n    }\n\n    if (offset > maxOffset) {\n      offset = maxOffset;\n    }\n\n    // Make offsets relative to start\n    lastOffset += hint;\n    offset += hint;\n\n    // value <= array[start + hint]\n  } else {\n    maxOffset = hint + 1;\n    while (offset < maxOffset && compare(value, array[start + hint - offset]) <= 0) {\n      lastOffset = offset;\n      offset = (offset << 1) + 1;\n\n      if (offset <= 0) {\n        offset = maxOffset;\n      }\n    }\n    if (offset > maxOffset) {\n      offset = maxOffset;\n    }\n\n    // Make offsets relative to start\n    let tmp = lastOffset;\n    lastOffset = hint - offset;\n    offset = hint - tmp;\n  }\n\n  /*\n   * Now array[start+lastOffset] < value <= array[start+offset], so value\n   * belongs somewhere in the range (start + lastOffset, start + offset]. Do a\n   * binary search, with invariant array[start + lastOffset - 1] < value <=\n   * array[start + offset].\n   */\n  lastOffset++;\n  while (lastOffset < offset) {\n    let m = lastOffset + ((offset - lastOffset) >>> 1);\n\n    if (compare(value, array[start + m]) > 0) {\n      lastOffset = m + 1;\n\n    } else {\n      offset = m;\n    }\n  }\n  return offset;\n}\n\n/**\n * Find the position at which to insert a value in a sorted range. If the range\n * contains elements equal to the value the rightmost element index is returned\n * (for stability).\n *\n * @param {number} value - Value to insert.\n * @param {array} array - The array in which to insert value.\n * @param {number} start - First element in the range.\n * @param {number} length - Length of the range.\n * @param {number} hint - The index at which to begin the search.\n * @param {function} compare - Item comparison function.\n * @return {number} - The index where to insert value.\n */\nfunction gallopRight(value, array, start, length, hint, compare) {\n  let lastOffset = 0;\n  let maxOffset = 0;\n  let offset = 1;\n\n  if (compare(value, array[start + hint]) < 0) {\n    maxOffset = hint + 1;\n\n    while (offset < maxOffset && compare(value, array[start + hint - offset]) < 0) {\n      lastOffset = offset;\n      offset = (offset << 1) + 1;\n\n      if (offset <= 0) {\n        offset = maxOffset;\n      }\n    }\n\n    if (offset > maxOffset) {\n      offset = maxOffset;\n    }\n\n    // Make offsets relative to start\n    let tmp = lastOffset;\n    lastOffset = hint - offset;\n    offset = hint - tmp;\n\n    // value >= array[start + hint]\n  } else {\n    maxOffset = length - hint;\n\n    while (offset < maxOffset && compare(value, array[start + hint + offset]) >= 0) {\n      lastOffset = offset;\n      offset = (offset << 1) + 1;\n\n      if (offset <= 0) {\n        offset = maxOffset;\n      }\n    }\n\n    if (offset > maxOffset) {\n      offset = maxOffset;\n    }\n\n    // Make offsets relative to start\n    lastOffset += hint;\n    offset += hint;\n  }\n\n  /*\n   * Now array[start+lastOffset] < value <= array[start+offset], so value\n   * belongs somewhere in the range (start + lastOffset, start + offset]. Do a\n   * binary search, with invariant array[start + lastOffset - 1] < value <=\n   * array[start + offset].\n   */\n  lastOffset++;\n\n  while (lastOffset < offset) {\n    let m = lastOffset + ((offset - lastOffset) >>> 1);\n\n    if (compare(value, array[start + m]) < 0) {\n      offset = m;\n\n    } else {\n      lastOffset = m + 1;\n    }\n  }\n\n  return offset;\n}\n\nclass TimSort {\n\n  constructor(array, compare) {\n    this.array = array;\n    this.compare = compare;\n    this.minGallop = DEFAULT_MIN_GALLOPING;\n    this.length = array.length;\n\n    this.tmpStorageLength = DEFAULT_TMP_STORAGE_LENGTH;\n    if (this.length < 2 * DEFAULT_TMP_STORAGE_LENGTH) {\n      this.tmpStorageLength = this.length >>> 1;\n    }\n\n    this.tmp = new Array(this.tmpStorageLength);\n\n    this.stackLength =\n      (this.length < 120 ? 5 :\n        this.length < 1542 ? 10 :\n          this.length < 119151 ? 19 : 40);\n\n    this.runStart = new Array(this.stackLength);\n    this.runLength = new Array(this.stackLength);\n    this.stackSize = 0;\n  }\n\n  /**\n   * Push a new run on TimSort's stack.\n   *\n   * @param {number} runStart - Start index of the run in the original array.\n   * @param {number} runLength - Length of the run;\n   */\n  pushRun(runStart, runLength) {\n    this.runStart[this.stackSize] = runStart;\n    this.runLength[this.stackSize] = runLength;\n    this.stackSize += 1;\n  }\n\n  /**\n   * Merge runs on TimSort's stack so that the following holds for all i:\n   * 1) runLength[i - 3] > runLength[i - 2] + runLength[i - 1]\n   * 2) runLength[i - 2] > runLength[i - 1]\n   */\n  mergeRuns() {\n    while (this.stackSize > 1) {\n      let n = this.stackSize - 2;\n\n      if ((n >= 1 &&\n        this.runLength[n - 1] <= this.runLength[n] + this.runLength[n + 1]) ||\n        (n >= 2 &&\n        this.runLength[n - 2] <= this.runLength[n] + this.runLength[n - 1])) {\n\n        if (this.runLength[n - 1] < this.runLength[n + 1]) {\n          n--;\n        }\n\n      } else if (this.runLength[n] > this.runLength[n + 1]) {\n        break;\n      }\n      this.mergeAt(n);\n    }\n  }\n\n  /**\n   * Merge all runs on TimSort's stack until only one remains.\n   */\n  forceMergeRuns() {\n    while (this.stackSize > 1) {\n      let n = this.stackSize - 2;\n\n      if (n > 0 && this.runLength[n - 1] < this.runLength[n + 1]) {\n        n--;\n      }\n\n      this.mergeAt(n);\n    }\n  }\n\n  /**\n   * Merge the runs on the stack at positions i and i+1. Must be always be called\n   * with i=stackSize-2 or i=stackSize-3 (that is, we merge on top of the stack).\n   *\n   * @param {number} i - Index of the run to merge in TimSort's stack.\n   */\n  mergeAt(i) {\n    let compare = this.compare;\n    let array = this.array;\n\n    let start1 = this.runStart[i];\n    let length1 = this.runLength[i];\n    let start2 = this.runStart[i + 1];\n    let length2 = this.runLength[i + 1];\n\n    this.runLength[i] = length1 + length2;\n\n    if (i === this.stackSize - 3) {\n      this.runStart[i + 1] = this.runStart[i + 2];\n      this.runLength[i + 1] = this.runLength[i + 2];\n    }\n\n    this.stackSize--;\n\n    /*\n     * Find where the first element in the second run goes in run1. Previous\n     * elements in run1 are already in place\n     */\n    let k = gallopRight(array[start2], array, start1, length1, 0, compare);\n    start1 += k;\n    length1 -= k;\n\n    if (length1 === 0) {\n      return;\n    }\n\n    /*\n     * Find where the last element in the first run goes in run2. Next elements\n     * in run2 are already in place\n     */\n    length2 = gallopLeft(array[start1 + length1 - 1], array, start2, length2, length2 - 1, compare);\n\n    if (length2 === 0) {\n      return;\n    }\n\n    /*\n     * Merge remaining runs. A tmp array with length = min(length1, length2) is\n     * used\n     */\n    if (length1 <= length2) {\n      this.mergeLow(start1, length1, start2, length2);\n\n    } else {\n      this.mergeHigh(start1, length1, start2, length2);\n    }\n  }\n\n  /**\n   * Merge two adjacent runs in a stable way. The runs must be such that the\n   * first element of run1 is bigger than the first element in run2 and the\n   * last element of run1 is greater than all the elements in run2.\n   * The method should be called when run1.length <= run2.length as it uses\n   * TimSort temporary array to store run1. Use mergeHigh if run1.length >\n   * run2.length.\n   *\n   * @param {number} start1 - First element in run1.\n   * @param {number} length1 - Length of run1.\n   * @param {number} start2 - First element in run2.\n   * @param {number} length2 - Length of run2.\n   */\n  mergeLow(start1, length1, start2, length2) {\n\n    let compare = this.compare;\n    let array = this.array;\n    let tmp = this.tmp;\n    let i = 0;\n\n    for (i = 0; i < length1; i++) {\n      tmp[i] = array[start1 + i];\n    }\n\n    let cursor1 = 0;\n    let cursor2 = start2;\n    let dest = start1;\n\n    array[dest++] = array[cursor2++];\n\n    if (--length2 === 0) {\n      for (i = 0; i < length1; i++) {\n        array[dest + i] = tmp[cursor1 + i];\n      }\n      return;\n    }\n\n    if (length1 === 1) {\n      for (i = 0; i < length2; i++) {\n        array[dest + i] = array[cursor2 + i];\n      }\n      array[dest + length2] = tmp[cursor1];\n      return;\n    }\n\n    let minGallop = this.minGallop;\n\n    while (true) {\n      let count1 = 0;\n      let count2 = 0;\n      let exit = false;\n\n      do {\n        if (compare(array[cursor2], tmp[cursor1]) < 0) {\n          array[dest++] = array[cursor2++];\n          count2++;\n          count1 = 0;\n\n          if (--length2 === 0) {\n            exit = true;\n            break;\n          }\n\n        } else {\n          array[dest++] = tmp[cursor1++];\n          count1++;\n          count2 = 0;\n          if (--length1 === 1) {\n            exit = true;\n            break;\n          }\n        }\n      } while ((count1 | count2) < minGallop);\n\n      if (exit) {\n        break;\n      }\n\n      do {\n        count1 = gallopRight(array[cursor2], tmp, cursor1, length1, 0, compare);\n\n        if (count1 !== 0) {\n          for (i = 0; i < count1; i++) {\n            array[dest + i] = tmp[cursor1 + i];\n          }\n\n          dest += count1;\n          cursor1 += count1;\n          length1 -= count1;\n          if (length1 <= 1) {\n            exit = true;\n            break;\n          }\n        }\n\n        array[dest++] = array[cursor2++];\n\n        if (--length2 === 0) {\n          exit = true;\n          break;\n        }\n\n        count2 = gallopLeft(tmp[cursor1], array, cursor2, length2, 0, compare);\n\n        if (count2 !== 0) {\n          for (i = 0; i < count2; i++) {\n            array[dest + i] = array[cursor2 + i];\n          }\n\n          dest += count2;\n          cursor2 += count2;\n          length2 -= count2;\n\n          if (length2 === 0) {\n            exit = true;\n            break;\n          }\n        }\n        array[dest++] = tmp[cursor1++];\n\n        if (--length1 === 1) {\n          exit = true;\n          break;\n        }\n\n        minGallop--;\n\n      } while (count1 >= DEFAULT_MIN_GALLOPING || count2 >= DEFAULT_MIN_GALLOPING);\n\n      if (exit) {\n        break;\n      }\n\n      if (minGallop < 0) {\n        minGallop = 0;\n      }\n\n      minGallop += 2;\n    }\n\n    this.minGallop = minGallop;\n\n    if (minGallop < 1) {\n      this.minGallop = 1;\n    }\n\n    if (length1 === 1) {\n      for (i = 0; i < length2; i++) {\n        array[dest + i] = array[cursor2 + i];\n      }\n      array[dest + length2] = tmp[cursor1];\n\n    } else if (length1 === 0) {\n      throw new Error('mergeLow preconditions were not respected');\n\n    } else {\n      for (i = 0; i < length1; i++) {\n        array[dest + i] = tmp[cursor1 + i];\n      }\n    }\n  }\n\n  /**\n   * Merge two adjacent runs in a stable way. The runs must be such that the\n   * first element of run1 is bigger than the first element in run2 and the\n   * last element of run1 is greater than all the elements in run2.\n   * The method should be called when run1.length > run2.length as it uses\n   * TimSort temporary array to store run2. Use mergeLow if run1.length <=\n   * run2.length.\n   *\n   * @param {number} start1 - First element in run1.\n   * @param {number} length1 - Length of run1.\n   * @param {number} start2 - First element in run2.\n   * @param {number} length2 - Length of run2.\n   */\n  mergeHigh(start1, length1, start2, length2) {\n    let compare = this.compare;\n    let array = this.array;\n    let tmp = this.tmp;\n    let i = 0;\n\n    for (i = 0; i < length2; i++) {\n      tmp[i] = array[start2 + i];\n    }\n\n    let cursor1 = start1 + length1 - 1;\n    let cursor2 = length2 - 1;\n    let dest = start2 + length2 - 1;\n    let customCursor = 0;\n    let customDest = 0;\n\n    array[dest--] = array[cursor1--];\n\n    if (--length1 === 0) {\n      customCursor = dest - (length2 - 1);\n\n      for (i = 0; i < length2; i++) {\n        array[customCursor + i] = tmp[i];\n      }\n\n      return;\n    }\n\n    if (length2 === 1) {\n      dest -= length1;\n      cursor1 -= length1;\n      customDest = dest + 1;\n      customCursor = cursor1 + 1;\n\n      for (i = length1 - 1; i >= 0; i--) {\n        array[customDest + i] = array[customCursor + i];\n      }\n\n      array[dest] = tmp[cursor2];\n      return;\n    }\n\n    let minGallop = this.minGallop;\n\n    while (true) {\n      let count1 = 0;\n      let count2 = 0;\n      let exit = false;\n\n      do {\n        if (compare(tmp[cursor2], array[cursor1]) < 0) {\n          array[dest--] = array[cursor1--];\n          count1++;\n          count2 = 0;\n          if (--length1 === 0) {\n            exit = true;\n            break;\n          }\n\n        } else {\n          array[dest--] = tmp[cursor2--];\n          count2++;\n          count1 = 0;\n          if (--length2 === 1) {\n            exit = true;\n            break;\n          }\n        }\n\n      } while ((count1 | count2) < minGallop);\n\n      if (exit) {\n        break;\n      }\n\n      do {\n        count1 = length1 - gallopRight(tmp[cursor2], array, start1, length1, length1 - 1, compare);\n\n        if (count1 !== 0) {\n          dest -= count1;\n          cursor1 -= count1;\n          length1 -= count1;\n          customDest = dest + 1;\n          customCursor = cursor1 + 1;\n\n          for (i = count1 - 1; i >= 0; i--) {\n            array[customDest + i] = array[customCursor + i];\n          }\n\n          if (length1 === 0) {\n            exit = true;\n            break;\n          }\n        }\n\n        array[dest--] = tmp[cursor2--];\n\n        if (--length2 === 1) {\n          exit = true;\n          break;\n        }\n\n        count2 = length2 - gallopLeft(array[cursor1], tmp, 0, length2, length2 - 1, compare);\n\n        if (count2 !== 0) {\n          dest -= count2;\n          cursor2 -= count2;\n          length2 -= count2;\n          customDest = dest + 1;\n          customCursor = cursor2 + 1;\n\n          for (i = 0; i < count2; i++) {\n            array[customDest + i] = tmp[customCursor + i];\n          }\n\n          if (length2 <= 1) {\n            exit = true;\n            break;\n          }\n        }\n\n        array[dest--] = array[cursor1--];\n\n        if (--length1 === 0) {\n          exit = true;\n          break;\n        }\n\n        minGallop--;\n\n      } while (count1 >= DEFAULT_MIN_GALLOPING || count2 >= DEFAULT_MIN_GALLOPING);\n\n      if (exit) {\n        break;\n      }\n\n      if (minGallop < 0) {\n        minGallop = 0;\n      }\n\n      minGallop += 2;\n    }\n\n    this.minGallop = minGallop;\n\n    if (minGallop < 1) {\n      this.minGallop = 1;\n    }\n\n    if (length2 === 1) {\n      dest -= length1;\n      cursor1 -= length1;\n      customDest = dest + 1;\n      customCursor = cursor1 + 1;\n\n      for (i = length1 - 1; i >= 0; i--) {\n        array[customDest + i] = array[customCursor + i];\n      }\n\n      array[dest] = tmp[cursor2];\n\n    } else if (length2 === 0) {\n      throw new Error('mergeHigh preconditions were not respected');\n\n    } else {\n      customCursor = dest - (length2 - 1);\n      for (i = 0; i < length2; i++) {\n        array[customCursor + i] = tmp[i];\n      }\n    }\n  }\n}\n\n/**\n * Sort an array in the range [lo, hi) using TimSort.\n *\n * @param {array} array - The array to sort.\n * @param {number} lo - First element in the range (inclusive).\n * @param {number} hi - Last element in the range.\n * @param {function=} compare - Item comparison function. Default is alphabetical.\n */\nexport default function (array, lo, hi, compare) {\n  if (!Array.isArray(array)) {\n    throw new TypeError('Can only sort arrays');\n  }\n\n  /*\n   * Handle the case where a comparison function is not provided. We do\n   * lexicographic sorting\n   */\n\n  if (lo === undefined) {\n    lo = 0;\n  }\n\n  if (hi === undefined) {\n    hi = array.length;\n  }\n\n  if (compare === undefined) {\n    compare = alphabeticalCompare;\n  }\n\n  let remaining = hi - lo;\n\n  // The array is already sorted\n  if (remaining < 2) {\n    return;\n  }\n\n  let runLength = 0;\n  // On small arrays binary sort can be used directly\n  if (remaining < DEFAULT_MIN_MERGE) {\n    runLength = makeAscendingRun(array, lo, hi, compare);\n    binaryInsertionSort(array, lo, hi, lo + runLength, compare);\n    return;\n  }\n\n  let ts = new TimSort(array, compare);\n\n  let minRun = minRunLength(remaining);\n\n  do {\n    runLength = makeAscendingRun(array, lo, hi, compare);\n    if (runLength < minRun) {\n      let force = remaining;\n      if (force > minRun) {\n        force = minRun;\n      }\n\n      binaryInsertionSort(array, lo, lo + force, lo + runLength, compare);\n      runLength = force;\n    }\n    // Push new run and merge if necessary\n    ts.pushRun(lo, runLength);\n    ts.mergeRuns();\n\n    // Go find next run\n    remaining -= runLength;\n    lo += runLength;\n\n  } while (remaining !== 0);\n\n  // Force merging of remaining runs\n  ts.forceMergeRuns();\n}","let _bufferPools = Array(8);\nfor (let i = 0; i < 8; ++i) {\n  _bufferPools[i] = [];\n}\n\nfunction _nextPow16(v) {\n  for (let i = 16; i <= (1 << 28); i *= 16) {\n    if (v <= i) {\n      return i;\n    }\n  }\n  return 0;\n}\n\nfunction _log2(v) {\n  let r, shift;\n  r = (v > 0xFFFF) << 4; v >>>= r;\n  shift = (v > 0xFF) << 3; v >>>= shift; r |= shift;\n  shift = (v > 0xF) << 2; v >>>= shift; r |= shift;\n  shift = (v > 0x3) << 1; v >>>= shift; r |= shift;\n  return r | (v >> 1);\n}\n\nfunction _alloc(n) {\n  let sz = _nextPow16(n);\n  let bin = _bufferPools[_log2(sz) >> 2];\n  if (bin.length > 0) {\n    return bin.pop();\n  }\n  return new ArrayBuffer(sz);\n}\n\nfunction _free(buf) {\n  _bufferPools[_log2(buf.byteLength) >> 2].push(buf);\n}\n\nexport default {\n  alloc_int8(n) {\n    let result = new Int8Array(_alloc(n), 0, n);\n    if (result.length !== n) {\n      return result.subarray(0, n);\n    }\n\n    return result;\n  },\n\n  alloc_uint8(n) {\n    let result = new Uint8Array(_alloc(n), 0, n);\n    if (result.length !== n) {\n      return result.subarray(0, n);\n    }\n\n    return result;\n  },\n\n  alloc_int16(n) {\n    let result = new Int16Array(_alloc(2 * n), 0, n);\n    if (result.length !== n) {\n      return result.subarray(0, n);\n    }\n\n    return result;\n  },\n\n  alloc_uint16(n) {\n    let result = new Uint16Array(_alloc(2 * n), 0, n);\n    if (result.length !== n) {\n      return result.subarray(0, n);\n    }\n\n    return result;\n  },\n\n  alloc_int32(n) {\n    let result = new Int32Array(_alloc(4 * n), 0, n);\n    if (result.length !== n) {\n      return result.subarray(0, n);\n    }\n\n    return result;\n  },\n\n  alloc_uint32(n) {\n    let result = new Uint32Array(_alloc(4 * n), 0, n);\n    if (result.length !== n) {\n      return result.subarray(0, n);\n    }\n\n    return result;\n  },\n\n  alloc_float32(n) {\n    let result = new Float32Array(_alloc(4 * n), 0, n);\n    if (result.length !== n) {\n      return result.subarray(0, n);\n    }\n\n    return result;\n  },\n\n  alloc_float64(n) {\n    let result = new Float64Array(_alloc(8 * n), 0, n);\n    if (result.length !== n) {\n      return result.subarray(0, n);\n    }\n\n    return result;\n  },\n\n  alloc_dataview(n) {\n    let result = new DataView(_alloc(n), 0, n);\n    if (result.length !== n) {\n      return result.subarray(0, n);\n    }\n\n    return result;\n  },\n\n  free(array) {\n    _free(array.buffer);\n  },\n\n  reset() {\n    let _bufferPools = Array(8);\n    for (let i = 0; i < 8; ++i) {\n      _bufferPools[i] = [];\n    }\n  },\n};","/**\n * JS Implementation of MurmurHash2\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} str ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash\n */\n\nexport default function murmurhash2_32_gc(str, seed) {\n  var\n    l = str.length,\n    h = seed ^ l,\n    i = 0,\n    k;\n  \n  while (l >= 4) {\n  \tk = \n  \t  ((str.charCodeAt(i) & 0xff)) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 8) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 16) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 24);\n    \n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n    k ^= k >>> 24;\n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n\n\th = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16)) ^ k;\n\n    l -= 4;\n    ++i;\n  }\n  \n  switch (l) {\n  case 3: h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n  case 2: h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n  case 1: h ^= (str.charCodeAt(i) & 0xff);\n          h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  }\n\n  h ^= h >>> 13;\n  h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  h ^= h >>> 15;\n\n  return h >>> 0;\n}","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.  \n\nimport { Vec3, Vec4, Mat4 } from '../../core/value-types';\nimport BaseRenderer from '../core/base-renderer';\nimport enums from '../enums';\nimport { RecyclePool } from '../memop';\n\nlet _a16_view = new Float32Array(16);\nlet _a16_view_inv = new Float32Array(16);\nlet _a16_proj = new Float32Array(16);\nlet _a16_viewProj = new Float32Array(16);\nlet _a4_camPos = new Float32Array(4);\n\nlet _a64_shadow_lightViewProj = new Float32Array(64);\nlet _a16_shadow_lightViewProjs = [];\nlet _a4_shadow_info = new Float32Array(4);\n\nlet _camPos = new Vec4(0, 0, 0, 0);\nlet _camFwd = new Vec3(0, 0, 0);\nlet _v3_tmp1 = new Vec3(0, 0, 0);\n\nconst CC_MAX_LIGHTS = 4;\nconst CC_MAX_SHADOW_LIGHTS = 2;\n\nlet _float16_pool = new RecyclePool(() => {\n  return new Float32Array(16);\n}, 8);\n\nexport default class ForwardRenderer extends BaseRenderer {\n  constructor(device, builtin) {\n    super(device, builtin);\n\n    this._time = new Float32Array(4);\n\n    this._directionalLights = [];\n    this._pointLights = [];\n    this._spotLights = [];\n    this._shadowLights = [];\n    this._ambientLights = [];\n\n    this._numLights = 0;\n\n    this._defines = {};\n\n    this._registerStage('shadowcast', this._shadowStage.bind(this));\n    this._registerStage('opaque', this._opaqueStage.bind(this));\n    this._registerStage('transparent', this._transparentStage.bind(this));\n  }\n\n  reset () {\n    _float16_pool.reset();\n    super.reset();\n  }\n\n  render (scene, dt) {\n    this.reset();\n\n    if (!CC_EDITOR) {\n      this._time[0] += dt;\n      this._device.setUniform('cc_time', this._time);\n    }\n\n    this._updateLights(scene);\n\n    const canvas = this._device._gl.canvas;\n    for (let i = 0; i < scene._cameras.length; ++i) {\n      let view = this._requestView();\n      let width = canvas.width;\n      let height = canvas.height;\n      let camera = scene._cameras.data[i];\n      camera.extractView(view, width, height);\n    }\n\n    // render by cameras\n    this._viewPools.sort((a, b) => {\n      return (a._priority - b._priority);\n    });\n\n    for (let i = 0; i < this._viewPools.length; ++i) {\n      let view = this._viewPools.data[i];\n      this._render(view, scene);\n    }\n  }\n\n  // direct render a single camera\n  renderCamera (camera, scene) {\n    this.reset();\n    \n    const canvas = this._device._gl.canvas;\n    let width = canvas.width;\n    let height = canvas.height;\n\n    let view = this._requestView();\n    camera.extractView(view, width, height);\n    \n    this._render(view, scene);\n  }\n\n  _updateLights (scene) {\n    this._directionalLights.length = 0;\n    this._pointLights.length = 0;\n    this._spotLights.length = 0;\n    this._shadowLights.length = 0;\n    this._ambientLights.length = 0;\n\n    let lights = scene._lights;\n    for (let i = 0; i < lights.length; ++i) {\n      let light = lights.data[i];\n      light.update(this._device);\n      if (light.shadowType !== enums.SHADOW_NONE) {\n        if (this._shadowLights.length < CC_MAX_SHADOW_LIGHTS) {\n          this._shadowLights.push(light);\n        }\n        let view = this._requestView();\n        light.extractView(view, ['shadowcast']);\n      }\n      if (light._type === enums.LIGHT_DIRECTIONAL) {\n        this._directionalLights.push(light);\n      }\n      else if (light._type === enums.LIGHT_POINT) {\n        this._pointLights.push(light);\n      }\n      else if (light._type === enums.LIGHT_SPOT) {\n        this._spotLights.push(light);\n      }\n      else {\n        this._ambientLights.push(light);\n      }\n    }\n\n    this._updateDefines();\n\n    this._numLights = lights._count;\n  }\n\n  _updateDefines () {\n    let defines = this._defines;\n    defines.CC_NUM_DIR_LIGHTS = Math.min(CC_MAX_LIGHTS, this._directionalLights.length);\n    defines.CC_NUM_POINT_LIGHTS = Math.min(CC_MAX_LIGHTS, this._pointLights.length);\n    defines.CC_NUM_SPOT_LIGHTS = Math.min(CC_MAX_LIGHTS, this._spotLights.length);\n    defines.CC_NUM_AMBIENT_LIGHTS = Math.min(CC_MAX_LIGHTS, this._ambientLights.length);\n\n    defines.CC_NUM_SHADOW_LIGHTS = Math.min(CC_MAX_LIGHTS, this._shadowLights.length);\n  }\n\n  _submitLightsUniforms () {\n    let device = this._device;\n\n    if (this._directionalLights.length > 0) {\n      let directions = _float16_pool.add();\n      let colors = _float16_pool.add();\n      let lightNum = Math.min(CC_MAX_LIGHTS, this._directionalLights.length);\n      for (let i = 0; i < lightNum; ++i) {\n        let light = this._directionalLights[i];\n        let index = i * 4;\n        directions.set(light._directionUniform, index);\n        colors.set(light._colorUniform, index);\n      }\n\n      device.setUniform('cc_dirLightDirection', directions);\n      device.setUniform('cc_dirLightColor', colors);\n    }\n\n    if (this._pointLights.length > 0) {\n      let positionAndRanges = _float16_pool.add();\n      let colors = _float16_pool.add();\n      let lightNum = Math.min(CC_MAX_LIGHTS, this._pointLights.length);\n      for (let i = 0; i < lightNum; ++i) {\n        let light = this._pointLights[i];\n        let index = i * 4;\n        positionAndRanges.set(light._positionUniform, index);\n        positionAndRanges[index+3] = light._range;\n        colors.set(light._colorUniform, index);\n      }\n\n      device.setUniform('cc_pointLightPositionAndRange', positionAndRanges);\n      device.setUniform('cc_pointLightColor', colors);\n    }\n\n    if (this._spotLights.length > 0) {\n      let positionAndRanges = _float16_pool.add();\n      let directions = _float16_pool.add();\n      let colors = _float16_pool.add();\n      let lightNum = Math.min(CC_MAX_LIGHTS, this._spotLights.length);\n      for (let i = 0; i < lightNum; ++i) {\n        let light = this._spotLights[i];\n        let index = i * 4;\n        \n        positionAndRanges.set(light._positionUniform, index);\n        positionAndRanges[index+3] = light._range;\n\n        directions.set(light._directionUniform, index);\n        directions[index+3] = light._spotUniform[0];\n\n        colors.set(light._colorUniform, index);\n        colors[index+3] = light._spotUniform[1];\n      }\n\n      device.setUniform('cc_spotLightPositionAndRange', positionAndRanges);\n      device.setUniform('cc_spotLightDirection', directions);\n      device.setUniform('cc_spotLightColor', colors);\n    }\n\n    if (this._ambientLights.length > 0) {\n      let colors = _float16_pool.add();\n      let lightNum = Math.min(CC_MAX_LIGHTS, this._ambientLights.length);\n      for (let i = 0; i < lightNum; ++i) {\n        let light = this._ambientLights[i];\n        let index = i * 4;\n        colors.set(light._colorUniform, index);\n      }\n\n      device.setUniform('cc_ambientColor', colors);\n    }\n  }\n\n  _submitShadowStageUniforms(view) {\n\n    let light = view._shadowLight;\n\n    let shadowInfo = _a4_shadow_info;\n    shadowInfo[0] = light.shadowMinDepth;\n    shadowInfo[1] = light.shadowMaxDepth;\n    shadowInfo[2] = light.shadowDepthScale;\n    shadowInfo[3] = light.shadowDarkness;\n\n    this._device.setUniform('cc_shadow_map_lightViewProjMatrix', Mat4.toArray(_a16_viewProj, view._matViewProj));\n    this._device.setUniform('cc_shadow_map_info', shadowInfo);\n    this._device.setUniform('cc_shadow_map_bias', light.shadowBias);\n  }\n\n  _submitOtherStagesUniforms() {\n    let shadowInfo = _float16_pool.add();\n    \n    for (let i = 0; i < this._shadowLights.length; ++i) {\n      let light = this._shadowLights[i];\n      let view = _a16_shadow_lightViewProjs[i];\n      if (!view) {\n        view = _a16_shadow_lightViewProjs[i] = new Float32Array(_a64_shadow_lightViewProj.buffer, i * 64, 16);\n      }\n      Mat4.toArray(view, light.viewProjMatrix);\n      \n      let infoIndex = i*4;\n      shadowInfo[infoIndex] = light.shadowMinDepth;\n      shadowInfo[infoIndex+1] = light.shadowMaxDepth;\n      shadowInfo[infoIndex+2] = light.shadowDepthScale;\n      shadowInfo[infoIndex+3] = light.shadowDarkness;\n    }\n\n    this._device.setUniform(`cc_shadow_lightViewProjMatrix`, _a64_shadow_lightViewProj);\n    this._device.setUniform(`cc_shadow_info`, shadowInfo);\n    // this._device.setUniform(`cc_frustumEdgeFalloff_${index}`, light.frustumEdgeFalloff);\n  }\n\n  _sortItems (items) {\n    // sort items\n    items.sort((a, b) => {\n      // if (a.layer !== b.layer) {\n      //   return a.layer - b.layer;\n      // }\n\n      if (a.passes.length !== b.passes.length) {\n        return a.passes.length - b.passes.length;\n      }\n\n      return a.sortKey - b.sortKey;\n    });\n  }\n\n  _shadowStage (view, items) {\n    // update rendering\n    this._submitShadowStageUniforms(view);\n\n    // this._sortItems(items);\n\n    // draw it\n    for (let i = 0; i < items.length; ++i) {\n      let item = items.data[i];\n      if (item.effect.getDefine('CC_CASTING_SHADOW')) {\n        this._draw(item);\n      }\n    }\n  }\n\n  _drawItems (view, items) {\n    let shadowLights = this._shadowLights;\n    if (shadowLights.length === 0 && this._numLights === 0) {\n      for (let i = 0; i < items.length; ++i) {\n        let item = items.data[i];\n        this._draw(item);\n      }\n    }\n    else {\n      for (let i = 0; i < items.length; ++i) {\n        let item = items.data[i];\n\n        for (let shadowIdx = 0; shadowIdx < shadowLights.length; ++shadowIdx) {\n          this._device.setTexture('cc_shadow_map_'+shadowIdx, shadowLights[shadowIdx].shadowMap, this._allocTextureUnit());  \n        }\n\n        this._draw(item);\n      }\n    }\n  }\n\n  _opaqueStage (view, items) {\n    view.getPosition(_camPos);\n\n    // update uniforms\n    this._device.setUniform('cc_matView', Mat4.toArray(_a16_view, view._matView));\n    this._device.setUniform('cc_matViewInv', Mat4.toArray(_a16_view_inv, view._matViewInv));\n    this._device.setUniform('cc_matpProj', Mat4.toArray(_a16_proj, view._matProj));\n    this._device.setUniform('cc_matViewProj', Mat4.toArray(_a16_viewProj, view._matViewProj));\n    this._device.setUniform('cc_cameraPos', Vec4.toArray(_a4_camPos, _camPos));\n\n    // update rendering\n    this._submitLightsUniforms();\n    this._submitOtherStagesUniforms();\n\n    this._drawItems(view, items);\n  }\n\n  _transparentStage (view, items) {\n    view.getPosition(_camPos);\n    view.getForward(_camFwd);\n\n    // update uniforms\n    this._device.setUniform('cc_matView', Mat4.toArray(_a16_view, view._matView));\n    this._device.setUniform('cc_matViewInv', Mat4.toArray(_a16_view_inv, view._matViewInv));\n    this._device.setUniform('cc_matpProj', Mat4.toArray(_a16_proj, view._matProj));\n    this._device.setUniform('cc_matViewProj', Mat4.toArray(_a16_viewProj, view._matViewProj));\n    this._device.setUniform('cc_cameraPos', Vec4.toArray(_a4_camPos, _camPos));\n\n    this._submitLightsUniforms();\n    this._submitOtherStagesUniforms();\n\n    // calculate zdist\n    for (let i = 0; i < items.length; ++i) {\n      let item = items.data[i];\n\n      // TODO: we should use mesh center instead!\n      item.node.getWorldPosition(_v3_tmp1);\n\n      Vec3.sub(_v3_tmp1, _v3_tmp1, _camPos);\n      item.sortKey = -Vec3.dot(_v3_tmp1, _camFwd);\n    }\n\n    this._sortItems(items);\n    this._drawItems(view, items);\n  }\n}\n","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\nimport { Vec3, Mat4, lerp, Vec4 } from '../../core/value-types';\nimport { Ray } from '../../core/geom-utils';\nimport enums from '../enums';\n\nlet _tmp_mat4 = new Mat4();\n\nlet _matView = new Mat4();\nlet _matViewInv = new Mat4();\nlet _matProj = new Mat4();\nlet _matViewProj = new Mat4();\nlet _matInvViewProj = new Mat4();\nlet _tmp_v3 = new Vec3();\nlet _tmp2_v3 = new Vec3();\n\n/**\n * A representation of a camera instance\n */\nexport default class Camera {\n  _poolID = -1;\n  _node = null;\n  _projection = enums.PROJ_PERSPECTIVE;\n\n  // priority. the smaller one will be rendered first\n  _priority = 0;\n\n  // clear options\n  _color = new Vec4(0.2, 0.3, 0.47, 1);\n  _depth = 1;\n  _stencil = 0;\n  _clearFlags = enums.CLEAR_COLOR | enums.CLEAR_DEPTH;\n  _clearModel = null;\n\n  // stages & framebuffer\n  _stages = [];\n  _framebuffer = null;\n\n  // projection properties\n  _near = 0.01;\n  _far = 1000.0;\n  _fov = Math.PI / 4.0; // vertical fov\n  _rect = {\n    x: 0, y: 0, w: 1, h: 1\n  };\n\n  // ortho properties\n  _orthoHeight = 10;\n\n  _cullingMask = 0xffffffff;\n\n\n  // culling mask\n  get cullingMask () {\n    return this._cullingMask;\n  }\n\n  set cullingMask (mask) {\n    this._cullingMask = mask;\n  }\n\n  setCullingMask (mask) {\n    this._cullingMask = mask;\n  }\n\n  /**\n   * Get the hosting node of this camera\n   * @returns {Node} the hosting node\n   */\n  getNode () {\n    return this._node;\n  }\n\n  /**\n   * Set the hosting node of this camera\n   * @param {Node} node the hosting node\n   */\n  setNode (node) {\n    this._node = node;\n  }\n\n  /**\n   * Get the projection type of the camera\n   * @returns {number} camera projection type\n   */\n  getType () {\n    return this._projection;\n  }\n\n  /**\n   * Set the projection type of the camera\n   * @param {number} type camera projection type\n   */\n  setType (type) {\n    this._projection = type;\n  }\n\n  /**\n   * Get the priority of the camera\n   * @returns {number} camera priority\n   */\n  getPriority () {\n    return this._priority;\n  }\n\n  /**\n   * Set the priority of the camera\n   * @param {number} priority camera priority\n   */\n  setPriority (priority) {\n    this._priority = priority;\n  }\n\n  /**\n   * Get the orthogonal height of the camera\n   * @returns {number} camera height\n   */\n  getOrthoHeight () {\n    return this._orthoHeight;\n  }\n\n  /**\n   * Set the orthogonal height of the camera\n   * @param {number} val camera height\n   */\n  setOrthoHeight (val) {\n    this._orthoHeight = val;\n  }\n\n  /**\n   * Get the field of view of the camera\n   * @returns {number} camera field of view\n   */\n  getFov () {\n    return this._fov;\n  }\n\n  /**\n   * Set the field of view of the camera\n   * @param {number} fov camera field of view\n   */\n  setFov (fov) {\n    this._fov = fov;\n  }\n\n  /**\n   * Get the near clipping distance of the camera\n   * @returns {number} camera near clipping distance\n   */\n  getNear () {\n    return this._near;\n  }\n\n  /**\n   * Set the near clipping distance of the camera\n   * @param {number} near camera near clipping distance\n   */\n  setNear (near) {\n    this._near = near;\n  }\n\n  /**\n   * Get the far clipping distance of the camera\n   * @returns {number} camera far clipping distance\n   */\n  getFar () {\n    return this._far;\n  }\n\n  /**\n   * Set the far clipping distance of the camera\n   * @param {number} far camera far clipping distance\n   */\n  setFar (far) {\n    this._far = far;\n  }\n\n  /**\n   * Get the clear color of the camera\n   * @returns {Vec4} out the receiving color vector\n   */\n  getColor (out) {\n    return Vec4.copy(out, this._color);\n  }\n\n  /**\n   * Set the clear color of the camera\n   * @param {number} r red channel of camera clear color\n   * @param {number} g green channel of camera clear color\n   * @param {number} b blue channel of camera clear color\n   * @param {number} a alpha channel of camera clear color\n   */\n  setColor (r, g, b, a) {\n    Vec4.set(this._color, r, g, b, a);\n  }\n\n  /**\n   * Get the clear depth of the camera\n   * @returns {number} camera clear depth\n   */\n  getDepth () {\n    return this._depth;\n  }\n\n  /**\n   * Set the clear depth of the camera\n   * @param {number} depth camera clear depth\n   */\n  setDepth (depth) {\n    this._depth = depth;\n  }\n\n  /**\n   * Get the clearing stencil value of the camera\n   * @returns {number} camera clearing stencil value\n   */\n  getStencil () {\n    return this._stencil;\n  }\n\n  /**\n   * Set the clearing stencil value of the camera\n   * @param {number} stencil camera clearing stencil value\n   */\n  setStencil (stencil) {\n    this._stencil = stencil;\n  }\n\n  /**\n   * Get the clearing flags of the camera\n   * @returns {number} camera clearing flags\n   */\n  getClearFlags () {\n    return this._clearFlags;\n  }\n\n  /**\n   * Set the clearing flags of the camera\n   * @param {number} flags camera clearing flags\n   */\n  setClearFlags (flags) {\n    this._clearFlags = flags;\n  }\n\n  /**\n   * Get the rect of the camera\n   * @param {Object} out the receiving object\n   * @returns {Object} camera rect\n   */\n  getRect (out) {\n    out.x = this._rect.x;\n    out.y = this._rect.y;\n    out.w = this._rect.w;\n    out.h = this._rect.h;\n\n    return out;\n  }\n\n  /**\n   * Set the rect of the camera\n   * @param {Number} x - [0,1]\n   * @param {Number} y - [0,1]\n   * @param {Number} w - [0,1]\n   * @param {Number} h - [0,1]\n   */\n  setRect (x, y, w, h) {\n    this._rect.x = x;\n    this._rect.y = y;\n    this._rect.w = w;\n    this._rect.h = h;\n  }\n\n  /**\n   * Get the stages of the camera\n   * @returns {string[]} camera stages\n   */\n  getStages () {\n    return this._stages;\n  }\n\n  /**\n   * Set the stages of the camera\n   * @param {string[]} stages camera stages\n   */\n  setStages (stages) {\n    this._stages = stages;\n  }\n\n  /**\n   * Get the framebuffer of the camera\n   * @returns {FrameBuffer} camera framebuffer\n   */\n  getFramebuffer () {\n    return this._framebuffer;\n  }\n\n  /**\n   * Set the framebuffer of the camera\n   * @param {FrameBuffer} framebuffer camera framebuffer\n   */\n  setFrameBuffer (framebuffer) {\n    this._framebuffer = framebuffer;\n  }\n\n  _calcMatrices (width, height) {\n    // view matrix\n    this._node.getWorldRT(_matViewInv);\n    Mat4.invert(_matView, _matViewInv);\n\n    // projection matrix\n    let aspect = width / height;\n    if (this._projection === enums.PROJ_PERSPECTIVE) {\n      Mat4.perspective(_matProj,\n        this._fov,\n        aspect,\n        this._near,\n        this._far\n      );\n    } else {\n      let x = this._orthoHeight * aspect;\n      let y = this._orthoHeight;\n      Mat4.ortho(_matProj,\n        -x, x, -y, y, this._near, this._far\n      );\n    }\n\n    // view-projection\n    Mat4.mul(_matViewProj, _matProj, _matView);\n    // inv view-projection\n    Mat4.invert(_matInvViewProj, _matViewProj);\n  }\n\n  /**\n   * extract a view of this camera\n   * @param {View} out the receiving view\n   * @param {number} width framebuffer width\n   * @param {number} height framebuffer height\n   */\n  extractView (out, width, height) {\n    if (this._framebuffer) {\n      width = this._framebuffer._width;\n      height = this._framebuffer._height;\n    }\n\n    // priority\n    out._priority = this._priority;\n\n    // rect\n    out._rect.x = this._rect.x * width;\n    out._rect.y = this._rect.y * height;\n    out._rect.w = this._rect.w * width;\n    out._rect.h = this._rect.h * height;\n\n    // clear opts\n    this.getColor(out._color);\n    out._depth = this._depth;\n    out._stencil = this._stencil;\n    out._clearFlags = this._clearFlags;\n    out._clearModel = this._clearModel;\n\n    // stages & framebuffer\n    out._stages = this._stages;\n    out._framebuffer = this._framebuffer;\n\n    this._calcMatrices(width, height);\n    Mat4.copy(out._matView, _matView);\n    Mat4.copy(out._matViewInv, _matViewInv);\n    Mat4.copy(out._matProj, _matProj);\n    Mat4.copy(out._matViewProj, _matViewProj);\n    Mat4.copy(out._matInvViewProj, _matInvViewProj);\n\n    out._cullingMask = this._cullingMask;\n  }\n\n  /**\n   * transform a screen position to a world space ray\n   * @param {number} x the screen x position to be transformed\n   * @param {number} y the screen y position to be transformed\n   * @param {number} width framebuffer width\n   * @param {number} height framebuffer height\n   * @param {Ray} out the resulting ray\n   * @returns {Ray} the resulting ray\n   */\n  screenPointToRay (x, y, width, height, out) {\n    if (!cc.geomUtils) return out;\n\n    out = out || new Ray();\n    this._calcMatrices(width, height);\n\n    let cx = this._rect.x * width;\n    let cy = this._rect.y * height;\n    let cw = this._rect.w * width;\n    let ch = this._rect.h * height;\n\n    // far plane intersection\n    Vec3.set(_tmp2_v3, (x - cx) / cw * 2 - 1, (y - cy) / ch * 2 - 1, 1);\n    Vec3.transformMat4(_tmp2_v3, _tmp2_v3, _matInvViewProj);\n\n    if (this._projection === enums.PROJ_PERSPECTIVE) {\n      // camera origin\n      this._node.getWorldPosition(_tmp_v3);\n    } else {\n      // near plane intersection\n      Vec3.set(_tmp_v3, (x - cx) / cw * 2 - 1, (y - cy) / ch * 2 - 1, -1);\n      Vec3.transformMat4(_tmp_v3, _tmp_v3, _matInvViewProj);\n    }\n\n    return Ray.fromPoints(out, _tmp_v3, _tmp2_v3);\n  }\n\n  /**\n   * transform a screen position to world space\n   * @param {Vec3} out the resulting vector\n   * @param {Vec3} screenPos the screen position to be transformed\n   * @param {number} width framebuffer width\n   * @param {number} height framebuffer height\n   * @returns {Vec3} the resulting vector\n   */\n  screenToWorld (out, screenPos, width, height) {\n    this._calcMatrices(width, height);\n\n    let cx = this._rect.x * width;\n    let cy = this._rect.y * height;\n    let cw = this._rect.w * width;\n    let ch = this._rect.h * height;\n\n    if (this._projection === enums.PROJ_PERSPECTIVE) {\n      // calculate screen pos in far clip plane\n      Vec3.set(out,\n        (screenPos.x - cx) / cw * 2 - 1,\n        (screenPos.y - cy) / ch * 2 - 1,\n        0.9999\n      );\n\n      // transform to world\n      Vec3.transformMat4(out, out, _matInvViewProj);\n\n      // lerp to depth z\n      this._node.getWorldPosition(_tmp_v3);\n\n      Vec3.lerp(out, _tmp_v3, out, lerp(this._near / this._far, 1, screenPos.z));\n    } else {\n      Vec3.set(out,\n        (screenPos.x - cx) / cw * 2 - 1,\n        (screenPos.y - cy) / ch * 2 - 1,\n        screenPos.z * 2 - 1\n      );\n\n      // transform to world\n      Vec3.transformMat4(out, out, _matInvViewProj);\n    }\n\n    return out;\n  }\n\n  /**\n   * transform a world space position to screen space\n   * @param {Vec3} out the resulting vector\n   * @param {Vec3} worldPos the world space position to be transformed\n   * @param {number} width framebuffer width\n   * @param {number} height framebuffer height\n   * @returns {Vec3} the resulting vector\n   */\n  worldToScreen (out, worldPos, width, height) {\n    this._calcMatrices(width, height);\n\n    let cx = this._rect.x * width;\n    let cy = this._rect.y * height;\n    let cw = this._rect.w * width;\n    let ch = this._rect.h * height;\n\n    Vec3.transformMat4(out, worldPos, _matViewProj);\n    out.x = cx + (out.x + 1) * 0.5 * cw;\n    out.y = cy + (out.y + 1) * 0.5 * ch;\n    out.z = out.z * 0.5 + 0.5;\n\n    return out;\n  }\n\n  /**\n   * transform a world space matrix to screen space\n   * @param {Mat4} out the resulting vector\n   * @param {Mat4} worldMatrix the world space matrix to be transformed\n   * @param {number} width framebuffer width\n   * @param {number} height framebuffer height\n   * @returns {Mat4} the resulting vector\n   */\n  worldMatrixToScreen (out, worldMatrix, width, height) {\n    this._calcMatrices(width, height);\n\n    Mat4.mul(out, _matViewProj, worldMatrix);\n\n    let halfWidth = width / 2;\n    let halfHeight = height / 2;\n    Mat4.identity(_tmp_mat4);\n    Mat4.transform(_tmp_mat4, _tmp_mat4, Vec3.set(_tmp_v3, halfWidth, halfHeight, 0));\n    Mat4.scale(_tmp_mat4, _tmp_mat4, Vec3.set(_tmp_v3, halfWidth, halfHeight, 1));\n\n    Mat4.mul(out, _tmp_mat4, out);\n\n    return out;\n  }\n}\n","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n/**\n * A representation of a model\n */\nexport default class Model {\n  /**\n   * Setup a default empty model\n   */\n  constructor() {\n    this._type = 'default';\n    this._poolID = -1;\n    this._node = null;\n    this._inputAssembler = null;\n    this._effect = null;\n    this._viewID = -1;\n    this._cameraID = -1;\n    this._userKey = -1;\n    this._castShadow = false;\n    this._boundingShape = null;\n  }\n\n  /**\n   * Set the hosting node of this model\n   * @param {Node} node the hosting node\n   */\n  setNode(node) {\n    this._node = node;\n  }\n\n  /**\n   * Set the input assembler\n   * @param {InputAssembler} ia\n   */\n  setInputAssembler(ia) {\n    this._inputAssembler = ia;\n  }\n\n  /**\n   * Set the model effect\n   * @param {?Effect} effect the effect to use\n   */\n  setEffect(effect) {\n    this._effect = effect;\n  }\n\n  /**\n   * Set the user key\n   * @param {number} key\n   */\n  setUserKey(key) {\n    this._userKey = key;\n  }\n\n  /**\n   * Extract a drawing item\n   * @param {Object} out the receiving item\n   */\n  extractDrawItem(out) {\n    out.model = this;\n    out.node = this._node;\n    out.ia = this._inputAssembler;\n    out.effect = this._effect;\n  }\n}\n","// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\nimport { FixedArray } from '../memop';\n\n/**\n * A representation of the scene\n */\nclass Scene {\n  /**\n   * Setup a default empty scene\n   */\n  constructor(app) {\n    this._lights = new FixedArray(16);\n    this._models = new FixedArray(16);\n    this._cameras = new FixedArray(16);\n    this._debugCamera = null;\n    this._app = app;\n\n    // NOTE: we don't use pool for views (because it's less changed and it doesn't have poolID)\n    this._views = [];\n  }\n\n  _add(pool, item) {\n    if (item._poolID !== -1) {\n      return;\n    }\n\n    pool.push(item);\n    item._poolID = pool.length - 1;\n  }\n\n  _remove(pool, item) {\n    if (item._poolID === -1) {\n      return;\n    }\n\n    pool.data[pool.length-1]._poolID = item._poolID;\n    pool.fastRemove(item._poolID);\n    item._poolID = -1;\n  }\n\n  /**\n   * reset the model viewIDs\n   */\n  reset() {\n    for (let i = 0; i < this._models.length; ++i) {\n      let model = this._models.data[i];\n      model._viewID = -1;\n    }\n  }\n\n  /**\n   * Set the debug camera\n   * @param {Camera} cam the debug camera\n   */\n  setDebugCamera(cam) {\n    this._debugCamera = cam;\n  }\n\n  /**\n   * Get the count of registered cameras\n   * @returns {number} camera count\n   */\n  getCameraCount() {\n    return this._cameras.length;\n  }\n\n  /**\n   * Get the specified camera\n   * @param {number} idx camera index\n   * @returns {Camera} the specified camera\n   */\n  getCamera(idx) {\n    return this._cameras.data[idx];\n  }\n\n  /**\n   * register a camera\n   * @param {Camera} camera the new camera\n   */\n  addCamera(camera) {\n    this._add(this._cameras, camera);\n  }\n\n  /**\n   * remove a camera\n   * @param {Camera} camera the camera to be removed\n   */\n  removeCamera(camera) {\n    this._remove(this._cameras, camera);\n  }\n\n  /**\n   * Get the count of registered model\n   * @returns {number} model count\n   */\n  getModelCount() {\n    return this._models.length;\n  }\n\n  /**\n   * Get the specified model\n   * @param {number} idx model index\n   * @returns {Model} the specified model\n   */\n  getModel(idx) {\n    return this._models.data[idx];\n  }\n\n  /**\n   * register a model\n   * @param {Model} model the new model\n   */\n  addModel(model) {\n    this._add(this._models, model);\n  }\n\n  /**\n   * remove a model\n   * @param {Model} model the model to be removed\n   */\n  removeModel(model) {\n    this._remove(this._models, model);\n  }\n\n  /**\n   * Get the count of registered light\n   * @returns {number} light count\n   */\n  getLightCount() {\n    return this._lights.length;\n  }\n\n  /**\n   * Get the specified light\n   * @param {number} idx light index\n   * @returns {Light} the specified light\n   */\n  getLight(idx) {\n    return this._lights.data[idx];\n  }\n\n  /**\n   * register a light\n   * @param {Light} light the new light\n   */\n  addLight(light) {\n    this._add(this._lights, light);\n  }\n\n  /**\n   * remove a light\n   * @param {Light} light the light to be removed\n   */\n  removeLight(light) {\n    this._remove(this._lights, light);\n  }\n\n  /**\n   * register a view\n   * @param {View} view the new view\n   */\n  addView(view) {\n    if (this._views.indexOf(view) === -1) {\n      this._views.push(view);\n    }\n  }\n\n  /**\n   * remove a view\n   * @param {View} view the view to be removed\n   */\n  removeView(view) {\n    let idx = this._views.indexOf(view);\n    if (idx !== -1) {\n      this._views.splice(idx, 1);\n    }\n  }\n}\n\nexport default Scene;\n","import enums from './enums';\nimport { Vec2, Vec3, Vec4, Color, Mat4 } from '../core/value-types';\nimport Texture2D from '../core/assets/CCTexture2D';\n\nlet gfxTexture2D = null, gfxTextureCube = null;\nif (CC_JSB && CC_NATIVERENDERER) {\n    gfxTexture2D = gfx.Texture2D;\n} else {\n    gfxTexture2D = require('./gfx/texture-2d');\n}\n\nconst CCObject = cc.Object;\n\nlet ctor2default = {\n    [Boolean]: v => v || false,\n    [Number]: v => v ? (ArrayBuffer.isView(v) ? v[0] : v) : 0,\n    [Vec2]: v => v ? cc.v2(v[0], v[1]) : cc.v2(),\n    [Vec3]: v => v ? cc.v3(v[0], v[1], v[2]) : cc.v3(),\n    [Vec4]: v => v ? cc.v4(v[0], v[1], v[2], v[3]) : cc.v4(),\n    [Color]: v => v ? cc.color(v[0] * 255, v[1] * 255, v[2] * 255,\n        (v[3] || 1) * 255) : cc.color(),\n    [Mat4]: v => v ? cc.mat4(\n        v[0], v[1], v[2], v[3],\n        v[4], v[5], v[6], v[7],\n        v[8], v[9], v[10], v[11],\n        v[12], v[13], v[14], v[15],\n    ) : cc.mat4(),\n    [Texture2D]: () => null,\n    [CCObject]: () => null\n};\n\n\nlet enums2ctor = {\n    [enums.PARAM_INT]: Number,\n    [enums.PARAM_INT2]: Vec2,\n    [enums.PARAM_INT3]: Vec3,\n    [enums.PARAM_INT4]: Vec4,\n    [enums.PARAM_FLOAT]: Number,\n    [enums.PARAM_FLOAT2]: Vec2,\n    [enums.PARAM_FLOAT3]: Vec3,\n    [enums.PARAM_FLOAT4]: Vec4,\n    [enums.PARAM_MAT4]: Mat4,\n    [enums.PARAM_TEXTURE_2D]: Texture2D,\n    \n    color: Color,\n    number: Number,\n    boolean: Boolean,\n    default: CCObject\n};\n\nexport let ctor2enums = {\n    [Number]: enums.PARAM_FLOAT,\n    [Vec2]: enums.PARAM_FLOAT2,\n    [Vec3]: enums.PARAM_FLOAT3,\n    [Vec4]: enums.PARAM_FLOAT4,\n    [Color]: enums.PARAM_COLOR3,\n    [Color]: enums.PARAM_COLOR4,\n    [Mat4]: enums.PARAM_MAT4,\n    [Texture2D]: enums.PARAM_TEXTURE_2D,\n    [gfxTexture2D]: enums.PARAM_TEXTURE_2D,\n};\n\nexport let enums2default = {\n    [enums.PARAM_INT]: new Uint32Array([0]),\n    [enums.PARAM_INT2]: new Uint32Array([0, 0]),\n    [enums.PARAM_INT3]: new Uint32Array([0, 0, 0]),\n    [enums.PARAM_INT4]: new Uint32Array([0, 0, 0, 0]),\n    [enums.PARAM_FLOAT]: new Float32Array([0]),\n    [enums.PARAM_FLOAT2]: new Float32Array([0, 0]),\n    [enums.PARAM_FLOAT3]: new Float32Array([0, 0, 0]),\n    [enums.PARAM_FLOAT4]: new Float32Array([0, 0, 0, 0]),\n    [enums.PARAM_MAT4]: cc.mat4().m,\n    [enums.PARAM_TEXTURE_2D]: null,\n    \n    number: 0,\n    boolean: false,\n}\n\nexport let getInstanceType = function (t) {\n    return enums2ctor[t] || enums2ctor.default;\n};\nexport let getInstanceCtor = function (t) {\n    return ctor2default[getInstanceType(t)];\n};\nexport let getClassName = function (t) {\n    return cc.js.getClassName(getInstanceType(t));\n};\n\nlet className2InspectorName = {\n    Number: 'number',\n    Boolean: 'boolean'\n};\nexport function getInspectorProps (prop) {\n    let editor = {\n        type: prop.type\n    };\n\n    Object.assign(editor, prop.editor || prop.inspector);\n    \n    editor.defines = prop.defines;\n    editor.value = getInstanceCtor(editor.type)(prop.value);\n\n    let className = getClassName(editor.type);\n    editor.typeName = className2InspectorName[className] || className;\n    \n    editor.valueCtor = enums2ctor[editor.type];\n\n    if (editor.typeName == 'cc.Texture2D') {\n        editor.typeName = 'cc.Asset';\n        editor.assetType = 'cc.Texture2D';\n    }\n\n    return editor;\n};","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n/**\n * Class for tiled map asset handling.\n * @class TiledMapAsset\n * @extends Asset\n *\n */\nlet TiledMapAsset = cc.Class({\n    name: 'cc.TiledMapAsset',\n    extends: cc.Asset,\n\n    properties: {\n        tmxXmlStr: '',\n\n        /**\n         * @property {Texture2D[]} textures\n         */\n        textures: {\n            default: [],\n            type: [cc.Texture2D]\n        },\n\n        /**\n         * @property {String[]} textureNames\n         */\n        textureNames: [cc.String],\n\n        /**\n         * @property {Size[]} textureSizes\n         */\n        textureSizes: {\n            default: [],\n            type: [cc.Size]\n        },\n\n        /**\n         * @property {Texture2D[]} imageLayerTextures\n         */\n        imageLayerTextures: {\n            default: [],\n            type: [cc.Texture2D]\n        },\n\n        /**\n         * @property {String[]} imageLayerTextureNames\n         */\n        imageLayerTextureNames: [cc.String],\n\n        tsxFiles: [cc.TextAsset],\n        tsxFileNames: [cc.String],\n    },\n\n    statics: {\n        preventDeferredLoadDependents: true\n    },\n\n    createNode: CC_EDITOR && function (callback) {\n        let node = new cc.Node(this.name);\n        let tiledMap = node.addComponent(cc.TiledMap);\n        tiledMap.tmxAsset = this;\n\n        return callback(null, node);\n    }\n});\n\ncc.TiledMapAsset = TiledMapAsset;\nmodule.exports = TiledMapAsset;\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\nrequire('./cocos2d/core');\nrequire('./cocos2d/animation');\n\nif (CC_EDITOR && Editor.isMainProcess) {\n    require('./cocos2d/particle/CCParticleAsset');\n    require('./cocos2d/tilemap/CCTiledMapAsset');\n}\nelse {\n    require('./cocos2d/particle');\n    require('./cocos2d/tilemap');\n    require('./cocos2d/videoplayer/CCVideoPlayer');\n    require('./cocos2d/webview/CCWebView');\n    require('./cocos2d/core/components/CCStudioComponent');\n    require('./extensions/ccpool/CCNodePool');\n    require('./cocos2d/actions');\n}\n\nrequire('./extensions/spine');\nrequire('./extensions/dragonbones');\n\nif (!CC_EDITOR || !Editor.isMainProcess) {\n    require('./cocos2d/deprecated');\n}\n","/****************************************************************************\n Copyright (c) 2013-2016 Chukong Technologies Inc.\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n  worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n  not use Cocos Creator software for developing other software or tools that's\n  used for developing games. You are not granted to publish, distribute,\n  sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n// PREDEFINE\n\n// window may be undefined when first load engine from editor\nvar _global = typeof window === 'undefined' ? global : window;\n\n/**\n * !#en\n * The main namespace of Cocos2d-JS, all engine core classes, functions, properties and constants are defined in this namespace.\n * !#zh\n * Cocos 引擎的主要命名空间，引擎代码中所有的类，函数，属性和常量都在这个命名空间中定义。\n * @module cc\n * @main cc\n */\n_global.cc = _global.cc || {};\n\n// For internal usage\ncc.internal = cc.internal || {};\n\nrequire('./predefine');\n\n// polyfills\nrequire('./polyfill/string');\nrequire('./polyfill/misc');\nrequire('./polyfill/array');\nrequire('./polyfill/object');\nrequire('./polyfill/array-buffer');\nrequire('./polyfill/number');\nif (!(CC_EDITOR && Editor.isMainProcess)) {\n    require('./polyfill/typescript');\n}\n\nrequire('./cocos2d/core/predefine');\n\n// LOAD COCOS2D ENGINE CODE\n\nif (!(CC_EDITOR && Editor.isMainProcess)) {\n    require('./cocos2d');\n}\n\n// LOAD EXTENDS\n\nrequire('./extends');\n\nif (CC_EDITOR) {\n    if (Editor.isMainProcess) {\n        Editor.versions['cocos2d'] = require('./package').version;\n    }\n}\n\nmodule.exports = _global.cc;","if (!ArrayBuffer.isView) {\n    const TypedArray = Object.getPrototypeOf(Int8Array);\n    ArrayBuffer.isView = (typeof TypedArray === 'function') ? function (obj) {\n        return obj instanceof TypedArray;\n    } : function (obj) {\n        // old JSC, phantom, QtWebview\n        if (typeof obj !== 'object') {\n            return false;\n        }\n        let ctor = obj.constructor;\n        return ctor === Float32Array || ctor === Uint8Array || ctor === Uint32Array || ctor === Int8Array;\n    };\n}","if (!Array.isArray) {\n    Array.isArray = function (arg) {\n        return Object.prototype.toString.call(arg) === '[object Array]';\n    };\n}\n\nif (!Array.prototype.find) {\n    Array.prototype.find = function (callback) {\n        var length = this.length;\n        for (var i = 0; i < length; i++) {\n            var element = this[i];\n            if (callback.call(this, element, i, this)) {\n                return element;\n            }\n        }\n\n        return undefined;\n    };\n}\n\n// for ie 11\nif (!Array.prototype.includes) {\n    Array.prototype.includes = function (value) {\n        return this.indexOf(value) !== -1;\n    };\n}\n","if (!Math.sign) {\n    Math.sign = function (x) {\n        x = +x; // convert to a number\n        if (x === 0 || isNaN(x)) {\n            return x;\n        }\n        return x > 0 ? 1 : -1;\n    };\n}\n\nif (!Math.log2) {\n    Math.log2 = function (x) {\n        return Math.log(x) * Math.LOG2E;\n    };\n}\n\nif (!Number.isInteger) {\n    Number.isInteger = function (value) {\n        return typeof value === 'number' && isFinite(value) && Math.floor(value) === value;\n    };\n}\n\nif (CC_JSB || CC_RUNTIME || !console.time) {\n    var Timer = window.performance || Date;\n    var _timerTable = Object.create(null);\n    console.time = function (label) {\n        _timerTable[label] = Timer.now();\n    };\n    console.timeEnd = function (label) {\n        var startTime = _timerTable[label];\n        var duration = Timer.now() - startTime;\n        console.log(`${label}: ${duration}ms`);\n    };\n}\n","\nNumber.parseFloat = Number.parseFloat || parseFloat;\nNumber.parseInt = Number.parseInt || parseInt;\n","\n// for IE11\nif (!Object.assign) {\n    Object.assign = function (target, source) {\n        return cc.js.mixin(target, source);\n    }\n}\n\n// for Baidu browser\n// Implementation reference to: \n// http://2ality.com/2016/02/object-getownpropertydescriptors.html\n// http://docs.w3cub.com/javascript/global_objects/reflect/ownkeys/\nif (!Object.getOwnPropertyDescriptors) {\n    Object.getOwnPropertyDescriptors = function (obj) {\n        let descriptors = {};\n        let ownKeys = Object.getOwnPropertyNames(obj);\n        if (Object.getOwnPropertySymbols) { // for IE 11\n            ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(obj));\n        }\n        for(let i = 0; i < ownKeys.length; ++i){\n            let key = ownKeys[i];\n            descriptors[key] = Object.getOwnPropertyDescriptor(obj, key);\n        }\n        return descriptors;\n    }\n}","if (!String.prototype.startsWith) {\n    String.prototype.startsWith = function (searchString, position) {\n        position = position || 0;\n        return this.lastIndexOf(searchString, position) === position;\n    };\n}\n\nif (!String.prototype.endsWith) {\n    String.prototype.endsWith = function (searchString, position) {\n        if (typeof position === 'undefined' || position > this.length) {\n            position = this.length;\n        }\n        position -= searchString.length;\n        var lastIndex = this.indexOf(searchString, position);\n        return lastIndex !== -1 && lastIndex === position;\n    };\n}\n\nif (!String.prototype.trimLeft) {\n    String.prototype.trimLeft = function () {\n        return this.replace(/^\\s+/, '');\n    };\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global global, define, System, Reflect, Promise */\r\n\r\n// tslib 1.9.3\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nwindow.__extends = function (d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n};\r\n\r\nwindow.__assign = Object.assign || function (t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n};\r\n\r\nwindow.__rest = function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n};\r\n\r\nwindow.__decorate = function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\nwindow.__param = function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\n\r\nwindow.__metadata = function (metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n};\r\n\r\nwindow.__awaiter = function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\nwindow.__generator = function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\n\r\nwindow.__exportStar = function (m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n};\r\n\r\nwindow.__values = function (o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n};\r\n\r\nwindow.__read = function (o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n};\r\n\r\nwindow.__spread = function () {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n};\r\n\r\nwindow.__await = function (v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n};\r\n\r\nwindow.__asyncGenerator = function (thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n};\r\n\r\nwindow.__asyncDelegator = function (o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n};\r\n\r\nwindow.__asyncValues = function (o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n};\r\n\r\nwindow.__makeTemplateObject = function (cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nwindow.__importStar = function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result[\"default\"] = mod;\r\n    return result;\r\n};\r\n\r\nwindow.__importDefault = function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\n","/****************************************************************************\n Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.\n\n https://www.cocos.com/\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated engine source code (the \"Software\"), a limited,\n worldwide, royalty-free, non-assignable, revocable and non-exclusive license\n to use Cocos Creator solely to develop games on your target platforms. You shall\n not use Cocos Creator software for developing other software or tools that's\n used for developing games. You are not granted to publish, distribute,\n sublicense, and/or sell copies of Cocos Creator.\n\n The software or tools in this License Agreement are licensed, not sold.\n Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n THE SOFTWARE.\n ****************************************************************************/\n\n// MACROS\n\n/**\n * !#zh\n * 这里是一些用来判断执行环境的宏，这些宏都是全局变量，直接访问即可。<br>\n * 在项目构建时，这些宏将会被预处理并根据构建的平台剔除不需要的代码，例如\n *\n *     if (CC_DEBUG) {\n *         cc.log('debug');\n *     }\n *     else {\n *         cc.log('release');\n *     }\n *\n * 在构建后会只剩下\n *\n *     cc.log('release');\n *\n * <br>\n * 如需判断脚本是否运行于指定平台，可以用如下表达式：\n *\n *     {\n *         \"编辑器\":  CC_EDITOR,\n *         \"编辑器 或 预览\":  CC_DEV,\n *         \"编辑器 或 预览 或 构建调试\":  CC_DEBUG,\n *         \"网页预览\":  CC_PREVIEW && !CC_JSB,\n *         \"模拟器预览\":  CC_PREVIEW && CC_JSB,\n *         \"构建调试\":  CC_BUILD && CC_DEBUG,\n *         \"构建发行\":  CC_BUILD && !CC_DEBUG,\n *     }\n *\n * !#en\n * Here are some of the macro used to determine the execution environment, these macros are global variables, can be accessed directly.<br>\n * When the project is built, these macros will be preprocessed and discard unreachable code based on the built platform, for example:\n *\n *     if (CC_DEBUG) {\n *         cc.log('debug');\n *     }\n *     else {\n *         cc.log('release');\n *     }\n *\n * After build will become:\n *\n *     cc.log('release');\n *\n * <br>\n * To determine whether the script is running on the specified platform, you can use the following expression:\n *\n *     {\n *         \"editor\":  CC_EDITOR,\n *         \"editor or preview\":  CC_DEV,\n *         \"editor or preview or build in debug mode\":  CC_DEBUG,\n *         \"web preview\":  CC_PREVIEW && !CC_JSB,\n *         \"simulator preview\":  CC_PREVIEW && CC_JSB,\n *         \"build in debug mode\":  CC_BUILD && CC_DEBUG,\n *         \"build in release mode\":  CC_BUILD && !CC_DEBUG,\n *     }\n *\n * @module GLOBAL-MACROS\n */\n/**\n * @property {Boolean} CC_EDITOR - Running in the editor.\n */\n/**\n * @property {Boolean} CC_PREVIEW - Preview in browser or simulator.\n */\n/**\n * @property {Boolean} CC_DEV - Running in the editor or preview.\n */\n/**\n * @property {Boolean} CC_DEBUG - Running in the editor or preview, or build in debug mode.\n */\n/**\n * @property {Boolean} CC_BUILD - Running in published project.\n */\n/**\n * @property {Boolean} CC_JSB - Running in native platform (mobile app, desktop app, or simulator).\n */\n/**\n * @property {Boolean} CC_TEST - Running in the engine's unit test.\n */\n/**\n * @property {Boolean} CC_RUNTIME - Running in runtime environments.\n */\n\n// window may be undefined when first load engine from editor\nvar _global = typeof window === 'undefined' ? global : window;\n\n/*\n * @param defaultValue - The default value is only used in the editor or preview.\n */\nfunction defineMacro (name, defaultValue) {\n    // if \"global_defs\" not preprocessed by uglify, just declare them globally,\n    // this may happened in release version's preview page.\n    if (typeof _global[name] === 'undefined') {\n        _global[name] = defaultValue;\n    }\n}\n\nfunction defineDeprecatedMacroGetter (name, defaultValue) {\n    if (typeof _global[name] === 'undefined') {\n        Object.defineProperty(_global, name, {\n            get: function () {\n                let recommandedUsage;\n                if (name === 'CC_WECHATGAMESUB') {\n                    recommandedUsage = 'cc.sys.platform === cc.sys.WECHAT_GAME_SUB';\n                }\n                else if (name === 'CC_WECHATGAME') {\n                    recommandedUsage = 'cc.sys.platform === cc.sys.WECHAT_GAME';                    \n                }\n                else if (name === 'CC_QQPLAY') {\n                    recommandedUsage = 'cc.sys.platform === cc.sys.QQ_PLAY';\n                }\n                cc.warnID(1400, name, recommandedUsage);\n                return defaultValue;\n            }\n        });\n    }\n}\n\nfunction defined (name) {\n    return typeof _global[name] === 'object';\n}\n\n// ensure CC_BUILD is defined\n// should not use window.CC_BUILD because we need get global_defs defined in uglify\ndefineMacro('CC_BUILD', false);\n\n// These default values can only be defined after building\n// If you need to modify them\n// please modify the `global_defs` in the option returned by `gulp/util/utils.js: getUglifyOptions`.\nif (CC_BUILD) {\n    _global.CC_BUILD = CC_BUILD;\n    _global.CC_DEV = CC_DEV;\n    _global.CC_DEBUG = CC_DEBUG;\n    _global.CC_JSB = CC_JSB;\n    _global.CC_NATIVERENDERER = CC_NATIVERENDERER;\n    _global.CC_SUPPORT_JIT = CC_SUPPORT_JIT;\n    _global.CC_PHYSICS_BUILTIN = CC_PHYSICS_BUILTIN;\n    _global.CC_PHYSICS_CANNON = CC_PHYSICS_CANNON;\n    _global.CC_EDITOR = CC_EDITOR;\n    _global.CC_PREVIEW = CC_PREVIEW;\n    _global.CC_TEST = CC_TEST;\n    _global.CC_RUNTIME = CC_RUNTIME;\n    _global.CC_JSB = CC_JSB;\n}\nelse {\n    defineMacro('CC_DEV', true);    // (CC_EDITOR && !CC_BUILD) || CC_PREVIEW || CC_TEST\n    defineMacro('CC_DEBUG', true);  // CC_DEV || Debug Build\n    defineMacro('CC_JSB', defined('jsb'));\n    defineMacro('CC_NATIVERENDERER', defined('jsb'));\n    defineMacro('CC_SUPPORT_JIT', true);\n    defineMacro('CC_PHYSICS_BUILTIN', false);\n    defineMacro('CC_PHYSICS_CANNON', true);\n    defineMacro('CC_EDITOR', defined('Editor') && defined('process') && ('electron' in process.versions));\n    defineMacro('CC_PREVIEW', !CC_EDITOR);\n    defineMacro('CC_TEST', defined('tap') || defined('QUnit'));\n    defineMacro('CC_RUNTIME', 'function' === typeof loadRuntime);\n    defineMacro('CC_JSB', defined('jsb') && !CC_RUNTIME);\n}\n\n// deprecated \nconst WECHATGAMESUB = !!(defined('wx') && wx.getSharedCanvas);\nconst WECHATGAME = !!(defined('wx') && (wx.getSystemInfoSync || wx.getSharedCanvas));\nconst QQPLAY = defined('bk');\ndefineDeprecatedMacroGetter('CC_WECHATGAMESUB', WECHATGAMESUB);\ndefineDeprecatedMacroGetter('CC_WECHATGAME', WECHATGAME);\ndefineDeprecatedMacroGetter('CC_QQPLAY', QQPLAY);\n\nif (CC_DEV) {\n    /**\n     * contains internal apis for unit tests\n     * @expose\n     */\n    cc._Test = {};\n}\n\n/**\n * @module cc\n */\n\n/**\n * The current version of Cocos2d being used.<br/>\n * Please DO NOT remove this String, it is an important flag for bug tracking.<br/>\n * If you post a bug to forum, please attach this flag.\n * @property {String} ENGINE_VERSION\n */\nconst engineVersion = '2.3.2';\n_global['CocosEngine'] = cc.ENGINE_VERSION = engineVersion;\n"],"sourceRoot":"./"}