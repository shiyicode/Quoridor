{"version":3,"sources":["RoomView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../../assets/script/view/component","sourcesContent":["import AppFacade from \"../../AppFacade\";\nimport RoomViewMediator from \"../RoomViewMediator\";\nimport { RoomVO } from \"../../model/vo/RoomVO\";\nimport Util from \"../../util/Util\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class RoomView extends cc.Component {\n\n    @property(cc.Node)\n    playersNode: cc.Node = null;\n\n    @property(cc.Node)\n    barNode: cc.Node = null;\n\n    @property(cc.Button)\n    readyButton: cc.Button = null;\n\n    @property(cc.Button)\n    cancelButton: cc.Button = null;\n\n    start() {\n        AppFacade.getInstance().registerMediator(new RoomViewMediator(this));\n    }\n\n    public onDestroy() {\n        AppFacade.getInstance().removeMediator(RoomViewMediator.NAME);\n    }\n\n    update(dt) {\n\n    }\n\n    updateRoom(room: RoomVO) {\n        let playerNodeArray: Array<cc.Node> = [];\n        let playerCnt = Util.getPlayerCntByType(room.gameType);\n        if (playerCnt == 2) {\n            playerNodeArray.push(this.playersNode.getChildByName(\"player0\"));\n            playerNodeArray.push(this.playersNode.getChildByName(\"player2\"));\n            this.playersNode.getChildByName(\"player1\").active = false;\n            this.playersNode.getChildByName(\"player3\").active = false;\n        } else {\n            for (let i = 0; i < 4; i++) {\n                let node = this.playersNode.getChildByName('player' + i.toString());\n                playerNodeArray.push(node);\n            }\n        }\n\n        for (let i = 0; i < playerCnt; i++) {\n            this.setPlayerInfo(playerNodeArray[i], room.playersInfo[i].avatarUrl,\n                room.playersInfo[i].nickName, room.playersInfo[i].isReady);\n        }\n        if(room.playersInfo[0].isReady != undefined) {\n            this.readyButton.node.active = !room.playersInfo[0].isReady;\n            this.cancelButton.node.active = room.playersInfo[0].isReady;\n        }\n    }\n\n    public setPlayerInfo(playerNode: cc.Node, avatarUrl: string, nickName: string, isReady: boolean) {\n        if (avatarUrl) {\n            let head = playerNode.getChildByName('mask').getChildByName('head')\n            let headBG = head.getComponent(cc.Sprite);\n\n            cc.loader.load({\n                url: avatarUrl,\n                type: 'jpg'\n            }, function (err, texture) {\n                console.log(\"加载头像\", err);\n                if (err == null) {\n                    headBG.spriteFrame = new cc.SpriteFrame(texture);\n                }            });\n\n            head.active = true;\n        }\n        if (nickName) {\n            nickName = Util.cutstr(nickName, 5);\n            let name = playerNode.getChildByName('name').getComponent(cc.Label);\n            name.string = nickName;\n        }\n        if(isReady != undefined) {\n            playerNode.getChildByName('ready_tag').active = isReady;\n        }\n    }\n\n    readyButtonClick(event, data) { }\n\n    cancelButtonClick(event, data) { }\n\n    inviteButtonClick(event, data) { }\n\n    leaveButtonClick(event, data) { }\n\n    chatButtonClick(event, data) { }\n}\n"]}